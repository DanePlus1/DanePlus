(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[9414],{1749:(te,R,e)=>{"use strict";e.d(R,{P:()=>x});var n=e(75816),a=e(10378),s=e(43173);const i=()=>s.$.namespace,r=(v,m)=>`/apis/${v}/${m}/namespaces/${i()}`,u=(v,m)=>`${v}/${m}`,o="v0alpha1",l="notifications.alerting.grafana.app",g=r(l,o),f=u(l,o),p=(0,n.xP)({reducerPath:f,baseQuery:(0,a.cw)({baseUrl:new URL(g,globalThis.location.origin).href}),endpoints:()=>({})}),c=["API Discovery","Receiver","RoutingTree","TemplateGroup","TimeInterval"],x=p.enhanceEndpoints({addTagTypes:c}).injectEndpoints({endpoints:v=>({getApiResources:v.query({query:()=>({url:"/apis/notifications.alerting.grafana.app/v0alpha1/"}),providesTags:["API Discovery"]}),listReceiver:v.query({query:m=>({url:"/receivers",params:{pretty:m.pretty,allowWatchBookmarks:m.allowWatchBookmarks,continue:m.continue,fieldSelector:m.fieldSelector,labelSelector:m.labelSelector,limit:m.limit,resourceVersion:m.resourceVersion,resourceVersionMatch:m.resourceVersionMatch,sendInitialEvents:m.sendInitialEvents,timeoutSeconds:m.timeoutSeconds,watch:m.watch}}),providesTags:["Receiver"]}),createReceiver:v.mutation({query:m=>({url:"/receivers",method:"POST",body:m.receiver,params:{pretty:m.pretty,dryRun:m.dryRun,fieldManager:m.fieldManager,fieldValidation:m.fieldValidation}}),invalidatesTags:["Receiver"]}),deletecollectionReceiver:v.mutation({query:m=>({url:"/receivers",method:"DELETE",params:{pretty:m.pretty,continue:m.continue,dryRun:m.dryRun,fieldSelector:m.fieldSelector,gracePeriodSeconds:m.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:m.ignoreStoreReadErrorWithClusterBreakingPotential,labelSelector:m.labelSelector,limit:m.limit,orphanDependents:m.orphanDependents,propagationPolicy:m.propagationPolicy,resourceVersion:m.resourceVersion,resourceVersionMatch:m.resourceVersionMatch,sendInitialEvents:m.sendInitialEvents,timeoutSeconds:m.timeoutSeconds}}),invalidatesTags:["Receiver"]}),getReceiver:v.query({query:m=>({url:`/receivers/${m.name}`,params:{pretty:m.pretty}}),providesTags:["Receiver"]}),replaceReceiver:v.mutation({query:m=>({url:`/receivers/${m.name}`,method:"PUT",body:m.receiver,params:{pretty:m.pretty,dryRun:m.dryRun,fieldManager:m.fieldManager,fieldValidation:m.fieldValidation}}),invalidatesTags:["Receiver"]}),deleteReceiver:v.mutation({query:m=>({url:`/receivers/${m.name}`,method:"DELETE",params:{pretty:m.pretty,dryRun:m.dryRun,gracePeriodSeconds:m.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:m.ignoreStoreReadErrorWithClusterBreakingPotential,orphanDependents:m.orphanDependents,propagationPolicy:m.propagationPolicy}}),invalidatesTags:["Receiver"]}),updateReceiver:v.mutation({query:m=>({url:`/receivers/${m.name}`,method:"PATCH",body:m.patch,params:{pretty:m.pretty,dryRun:m.dryRun,fieldManager:m.fieldManager,fieldValidation:m.fieldValidation,force:m.force}}),invalidatesTags:["Receiver"]}),listRoutingTree:v.query({query:m=>({url:"/routingtrees",params:{pretty:m.pretty,allowWatchBookmarks:m.allowWatchBookmarks,continue:m.continue,fieldSelector:m.fieldSelector,labelSelector:m.labelSelector,limit:m.limit,resourceVersion:m.resourceVersion,resourceVersionMatch:m.resourceVersionMatch,sendInitialEvents:m.sendInitialEvents,timeoutSeconds:m.timeoutSeconds,watch:m.watch}}),providesTags:["RoutingTree"]}),createRoutingTree:v.mutation({query:m=>({url:"/routingtrees",method:"POST",body:m.routingTree,params:{pretty:m.pretty,dryRun:m.dryRun,fieldManager:m.fieldManager,fieldValidation:m.fieldValidation}}),invalidatesTags:["RoutingTree"]}),deletecollectionRoutingTree:v.mutation({query:m=>({url:"/routingtrees",method:"DELETE",params:{pretty:m.pretty,continue:m.continue,dryRun:m.dryRun,fieldSelector:m.fieldSelector,gracePeriodSeconds:m.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:m.ignoreStoreReadErrorWithClusterBreakingPotential,labelSelector:m.labelSelector,limit:m.limit,orphanDependents:m.orphanDependents,propagationPolicy:m.propagationPolicy,resourceVersion:m.resourceVersion,resourceVersionMatch:m.resourceVersionMatch,sendInitialEvents:m.sendInitialEvents,timeoutSeconds:m.timeoutSeconds}}),invalidatesTags:["RoutingTree"]}),getRoutingTree:v.query({query:m=>({url:`/routingtrees/${m.name}`,params:{pretty:m.pretty}}),providesTags:["RoutingTree"]}),replaceRoutingTree:v.mutation({query:m=>({url:`/routingtrees/${m.name}`,method:"PUT",body:m.routingTree,params:{pretty:m.pretty,dryRun:m.dryRun,fieldManager:m.fieldManager,fieldValidation:m.fieldValidation}}),invalidatesTags:["RoutingTree"]}),deleteRoutingTree:v.mutation({query:m=>({url:`/routingtrees/${m.name}`,method:"DELETE",params:{pretty:m.pretty,dryRun:m.dryRun,gracePeriodSeconds:m.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:m.ignoreStoreReadErrorWithClusterBreakingPotential,orphanDependents:m.orphanDependents,propagationPolicy:m.propagationPolicy}}),invalidatesTags:["RoutingTree"]}),updateRoutingTree:v.mutation({query:m=>({url:`/routingtrees/${m.name}`,method:"PATCH",body:m.patch,params:{pretty:m.pretty,dryRun:m.dryRun,fieldManager:m.fieldManager,fieldValidation:m.fieldValidation,force:m.force}}),invalidatesTags:["RoutingTree"]}),listTemplateGroup:v.query({query:m=>({url:"/templategroups",params:{pretty:m.pretty,allowWatchBookmarks:m.allowWatchBookmarks,continue:m.continue,fieldSelector:m.fieldSelector,labelSelector:m.labelSelector,limit:m.limit,resourceVersion:m.resourceVersion,resourceVersionMatch:m.resourceVersionMatch,sendInitialEvents:m.sendInitialEvents,timeoutSeconds:m.timeoutSeconds,watch:m.watch}}),providesTags:["TemplateGroup"]}),createTemplateGroup:v.mutation({query:m=>({url:"/templategroups",method:"POST",body:m.templateGroup,params:{pretty:m.pretty,dryRun:m.dryRun,fieldManager:m.fieldManager,fieldValidation:m.fieldValidation}}),invalidatesTags:["TemplateGroup"]}),deletecollectionTemplateGroup:v.mutation({query:m=>({url:"/templategroups",method:"DELETE",params:{pretty:m.pretty,continue:m.continue,dryRun:m.dryRun,fieldSelector:m.fieldSelector,gracePeriodSeconds:m.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:m.ignoreStoreReadErrorWithClusterBreakingPotential,labelSelector:m.labelSelector,limit:m.limit,orphanDependents:m.orphanDependents,propagationPolicy:m.propagationPolicy,resourceVersion:m.resourceVersion,resourceVersionMatch:m.resourceVersionMatch,sendInitialEvents:m.sendInitialEvents,timeoutSeconds:m.timeoutSeconds}}),invalidatesTags:["TemplateGroup"]}),getTemplateGroup:v.query({query:m=>({url:`/templategroups/${m.name}`,params:{pretty:m.pretty}}),providesTags:["TemplateGroup"]}),replaceTemplateGroup:v.mutation({query:m=>({url:`/templategroups/${m.name}`,method:"PUT",body:m.templateGroup,params:{pretty:m.pretty,dryRun:m.dryRun,fieldManager:m.fieldManager,fieldValidation:m.fieldValidation}}),invalidatesTags:["TemplateGroup"]}),deleteTemplateGroup:v.mutation({query:m=>({url:`/templategroups/${m.name}`,method:"DELETE",params:{pretty:m.pretty,dryRun:m.dryRun,gracePeriodSeconds:m.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:m.ignoreStoreReadErrorWithClusterBreakingPotential,orphanDependents:m.orphanDependents,propagationPolicy:m.propagationPolicy}}),invalidatesTags:["TemplateGroup"]}),updateTemplateGroup:v.mutation({query:m=>({url:`/templategroups/${m.name}`,method:"PATCH",body:m.patch,params:{pretty:m.pretty,dryRun:m.dryRun,fieldManager:m.fieldManager,fieldValidation:m.fieldValidation,force:m.force}}),invalidatesTags:["TemplateGroup"]}),listTimeInterval:v.query({query:m=>({url:"/timeintervals",params:{pretty:m.pretty,allowWatchBookmarks:m.allowWatchBookmarks,continue:m.continue,fieldSelector:m.fieldSelector,labelSelector:m.labelSelector,limit:m.limit,resourceVersion:m.resourceVersion,resourceVersionMatch:m.resourceVersionMatch,sendInitialEvents:m.sendInitialEvents,timeoutSeconds:m.timeoutSeconds,watch:m.watch}}),providesTags:["TimeInterval"]}),createTimeInterval:v.mutation({query:m=>({url:"/timeintervals",method:"POST",body:m.timeInterval,params:{pretty:m.pretty,dryRun:m.dryRun,fieldManager:m.fieldManager,fieldValidation:m.fieldValidation}}),invalidatesTags:["TimeInterval"]}),deletecollectionTimeInterval:v.mutation({query:m=>({url:"/timeintervals",method:"DELETE",params:{pretty:m.pretty,continue:m.continue,dryRun:m.dryRun,fieldSelector:m.fieldSelector,gracePeriodSeconds:m.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:m.ignoreStoreReadErrorWithClusterBreakingPotential,labelSelector:m.labelSelector,limit:m.limit,orphanDependents:m.orphanDependents,propagationPolicy:m.propagationPolicy,resourceVersion:m.resourceVersion,resourceVersionMatch:m.resourceVersionMatch,sendInitialEvents:m.sendInitialEvents,timeoutSeconds:m.timeoutSeconds}}),invalidatesTags:["TimeInterval"]}),getTimeInterval:v.query({query:m=>({url:`/timeintervals/${m.name}`,params:{pretty:m.pretty}}),providesTags:["TimeInterval"]}),replaceTimeInterval:v.mutation({query:m=>({url:`/timeintervals/${m.name}`,method:"PUT",body:m.timeInterval,params:{pretty:m.pretty,dryRun:m.dryRun,fieldManager:m.fieldManager,fieldValidation:m.fieldValidation}}),invalidatesTags:["TimeInterval"]}),deleteTimeInterval:v.mutation({query:m=>({url:`/timeintervals/${m.name}`,method:"DELETE",params:{pretty:m.pretty,dryRun:m.dryRun,gracePeriodSeconds:m.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:m.ignoreStoreReadErrorWithClusterBreakingPotential,orphanDependents:m.orphanDependents,propagationPolicy:m.propagationPolicy}}),invalidatesTags:["TimeInterval"]}),updateTimeInterval:v.mutation({query:m=>({url:`/timeintervals/${m.name}`,method:"PATCH",body:m.patch,params:{pretty:m.pretty,dryRun:m.dryRun,fieldManager:m.fieldManager,fieldValidation:m.fieldValidation,force:m.force}}),invalidatesTags:["TimeInterval"]})}),overrideExisting:!1})},62392:(te,R,e)=>{"use strict";e.d(R,{p:()=>i});var n=e(74848),a=e(96540),s=e(79450);function i(r){const{children:u,instanceSettings:o}=r,l=(0,a.useMemo)(()=>({instanceSettings:o,meta:o.meta}),[o]);return(0,n.jsx)(s.b.Provider,{value:l,children:u})}},79450:(te,R,e)=>{"use strict";e.d(R,{b:()=>a});var n=e(96540);const a=(0,n.createContext)(void 0)},20877:(te,R,e)=>{"use strict";e.d(R,{a:()=>s});var n=e(74848),a=e(79450);function s(i){const{children:r,...u}=i;return(0,n.jsx)(a.b.Provider,{value:u,children:r})}},17564:(te,R,e)=>{"use strict";e.d(R,{S:()=>n});function n(a){return"instanceSettings"in a&&"meta"in a}},31595:(te,R,e)=>{"use strict";e.d(R,{Q:()=>s});var n=e(96540),a=e(79450);function s(){const i=(0,n.useContext)(a.b);return i||null}},27359:(te,R,e)=>{"use strict";e.d(R,{I:()=>i,f:()=>s});var n=e(95004),a=e(41119);class s{constructor(l,g){return this.fields=[],this.length=0,i(l,g)}}function i(o,l){const g={fields:[],length:o.length};if(!o?.length)return g;if(l){if(!u(o))throw new Error("source is not an array of objects");for(const p of l)g.fields.push(r(p,o.map(c=>c&&c[p])));return g}if(o.find(p=>p)===null)return g;if(u(o)){const p=o.find(c=>c);g.fields=Object.keys(p||{}).map(c=>r(c,o.map(x=>x&&x[c])))}else g.fields.push(r(n.Bc,o));return g}function r(o,l){const g={name:o,config:{},values:l,type:n.PU.other};return g.type=(0,a.dF)(g)??n.PU.other,g}function u(o){const l=o.find(g=>g);return o.length>0&&typeof l=="object"}},35479:(te,R,e)=>{"use strict";e.d(R,{x:()=>s});var n=e(94777),a=e(18700);class s extends a.k{constructor(r){super(void 0,u=>new n.$({...r,buffer:u}))}}},77154:(te,R,e)=>{"use strict";e.d(R,{EL:()=>r,Nw:()=>l,or:()=>o,t:()=>i});var n=e(95004),a=e(41119);const s={Inf:1/0,NegInf:-1/0,Undef:void 0,NaN:NaN};function i(g,f){let p;for(p in g){const c=s[p];for(const x of g[p])x<f.length&&(f[x]=c)}}function r(g,f){for(let p=0;p<f.length;p++)f[p]=g[Number(f[p])]}function u(g,f){for(const p of f)if(p!=null)return(0,a.by)(g,p);return n.PU.other}function o(g){const{schema:f,data:p}=g;if(!f||!f.fields)throw new Error("JSON needs a fields definition");const c=p?p.values.reduce((v,m)=>Math.max(v,m.length),0):0,x=f.fields.map((v,m)=>{let y=p?p.values[m]:[],h=y.length,d=v.type;h!==c&&(y.length=c,y.fill(void 0,h));let E=p?.entities?.[m];E&&i(E,y);let b=p?.enums?.[m];b&&(r(b,y),d=n.PU.string);const D=p?.nanos?.[m],C={...v,type:d??u(v.name,y),config:v.config??{},values:y,entities:E??{}};return D!=null&&(C.nanos=D),C});return{...f,fields:x,length:c}}function l(g){const f={values:[]},p=[];let c=!1;const x={refId:g.refId,meta:g.meta,name:g.name,fields:g.fields.map(v=>{const{values:m,nanos:y,state:h,display:d,...E}=v;return"entities"in E&&delete E.entities,f.values.push(m),y!=null?(p.push(y),c=!0):p.push(null),E})};return c&&(f.nanos=p),{schema:x,data:f}}},88673:(te,R,e)=>{"use strict";e.d(R,{R:()=>a});var n=e(96453);class a extends n.F{constructor(i){super(),this.data=i,this.index=0;const r={},u={};for(let o=0;o<i.fields.length;o++){const l=i.fields[o];if(!l.name)continue;u[l.name]=l;const g=()=>l.values.get(this.index);r.hasOwnProperty(l.name)||Object.defineProperty(r,l.name,{enumerable:!0,get:g}),r.hasOwnProperty(o.toString())||Object.defineProperty(r,o,{enumerable:!1,get:g})}this.obj=r,this.fields=u}get dataFrame(){return this.data}get length(){return this.data.length}getFieldDisplayProcessor(i){if(!this.dataFrame||!this.dataFrame.fields)return;const r=this.dataFrame.fields[i];if(!(!r||!r.display))return r.display}get(i){return this.index=i,this.obj}toArray(){return new Array(this.data.length).fill(0).map((i,r)=>({...this.get(r)}))}}},10279:(te,R,e)=>{"use strict";e.d(R,{L:()=>s});var n=e(95004),a=e(41119);class s{constructor(r){this.fields=[],this.fieldByName={},this.fieldByType={},this.fields=r.fields.map((u,o)=>({...u,index:o}));for(let u=0;u<r.fields.length;u++){const o=r.fields[u];if(o.type===n.PU.other){const l=(0,a.dF)(o);l&&(o.type=l)}this.fieldByType[o.type]||(this.fieldByType[o.type]=[]),this.fieldByType[o.type].push({...o,index:u}),this.fieldByName[o.name]?console.warn("Duplicate field names in DataFrame: ",o.name):this.fieldByName[o.name]={...o,index:u}}}getFields(r){if(!r)return[...this.fields];const u=this.fieldByType[r];return u?[...u]:[]}hasFieldOfType(r){const u=this.fieldByType[r];return u&&u.length>0}getFirstFieldOfType(r,u=!1){return this.fieldByType[r]?.find(g=>u||!g.config.custom?.hidden)}hasFieldNamed(r){return!!this.fieldByName[r]}hasFieldWithNameAndType(r,u){return!!this.fieldByName[r]&&this.fieldByType[u].filter(o=>o.name===r).length>0}getFieldByName(r){return this.fieldByName[r]}getFieldsByLabel(r,u){return Object.values(this.fieldByName).filter(o=>o.labels&&o.labels[r]===u)}}},18700:(te,R,e)=>{"use strict";e.d(R,{p:()=>u,k:()=>o});var n=e(2543),a=e(95004),s=e(41119);function i(l,g){return g.type||(g.name==="time"||g.name==="Time"?g.type=a.PU.time:g.type=(0,s.HW)(l)),g.type===a.PU.number?f=>parseFloat(f):g.type===a.PU.boolean?f=>!(f[0]==="F"||f[0]==="f"||f[0]==="0"):f=>f}var r=e(96453);const u=void 0;class o extends r.F{constructor(g,f){if(super(),this.fields=[],this.first=[],this.parsers=void 0,this.creator=f||(p=>p??[]),g){const{name:p,refId:c,meta:x,fields:v}=g;if(p&&(this.name=p),c&&(this.refId=c),x&&(this.meta=x),v)for(const m of v)this.addField(m)}Object.defineProperty(this,"length",{enumerable:!0,get:()=>this.first.length})}get length(){return this.first.length}addFieldFor(g,f){return this.addField({name:f||"",type:(0,s.HW)(g)})}addField(g,f){let p;g.values&&(p=g.values);let c=g.type;!c&&(g.name==="time"||g.name==="Time")?c=a.PU.time:(!c&&p&&p.length&&(c=(0,s.HW)(p[0])),c||(c=a.PU.other));let x=g.name;x||(x=`Field ${this.fields.length+1}`);const v={...g,name:x,type:c,config:g.config||{},values:this.creator(p)};if(c===a.PU.other&&(c=(0,s.dF)(v),c&&(v.type=c)),this.fields.push(v),this.first=this.fields[0].values,f)for(;v.values.length<f;)v.values.push(u);else this.validate();return v}validate(){const g=this.fields.reduce((f,p)=>Math.max(f,p.values.length),0);for(const f of this.fields)for(;f.values.length!==g;)f.values.push(u)}setParser(g,f){return this.parsers||(this.parsers=new Map),this.parsers.set(g,f),f}parseValue(g,f){let p=this.parsers?.get(g);return p||(p=this.setParser(g,i(f,g))),p(f)}appendRow(g){for(let f=this.fields.length;f<g.length;f++)this.addField({name:`Field ${f+1}`,type:(0,s.HW)(g[f])});if(this.length<1)for(let f=0;f<this.fields.length;f++){const p=this.fields[f];(!p.type||p.type===a.PU.other)&&(p.type=(0,s.HW)(g[f]))}for(let f=0;f<this.fields.length;f++){const p=this.fields[f];let c=g[f];p.type!==a.PU.string&&(0,n.isString)(c)&&(c=this.parseValue(p,c)),p.values.push(c)}}push(...g){for(const f of g)this.add(f);return this.length}reverse(){for(const g of this.fields)g.values.reverse();return this}add(g){const f=g;for(const p of this.fields){let c=f[p.name];p.type!==a.PU.string&&(0,n.isString)(c)&&(c=this.parseValue(p,c)),c===void 0&&(c=u),p.values.push(c)}}set(g,f){if(g>this.length)throw new Error("Unable to set value beyond current length");const p=f||{};for(const c of this.fields)c.values[g]=p[c.name]}get(g){const f={};for(const p of this.fields)f[p.name]=p.values[g];return f}toJSON(){return(0,s.Kl)(this)}}},51388:(te,R,e)=>{"use strict";e.d(R,{Kh:()=>o,Ls:()=>x,k9:()=>f,m8:()=>p});var n=e(8721),a=e(95004),s=e(71642),i=e(428),r=e(77154),u=e(41119),o=(b=>(b.Append="append",b.Replace="replace",b))(o||{});const l="__name__";var g=(b=>(b[b.wide=0]="wide",b[b.labels=1]="labels",b))(g||{});class f{constructor(D){this.options=D,this.meta={},this.fields=[],this.length=0,this.schemaFields=[],this.timeFieldIndex=-1,this.pushMode=0,this.labels=new Set,this.packetInfo={schemaChanged:!0,number:0,action:"replace",length:0},this.serialize=(C,P,M)=>{const O=P?Object.assign({},{...this.options,...P}):this.options,j=(0,u.By)(this,C),U=d(j.fields.map(B=>B.values??[]),typeof M?.maxLength=="number"?Math.min(M.maxLength,O.maxLength):O.maxLength,this.timeFieldIndex,O.maxDelta);j.fields=j.fields.map(B=>({...B,values:B.values?.slice(U)}));const W=j.fields[0]?.values?.length??0;return{...j,labels:this.labels,schemaFields:this.schemaFields,name:this.name,refId:this.refId,meta:this.meta,length:W,timeFieldIndex:this.timeFieldIndex,pushMode:this.pushMode,packetInfo:this.packetInfo,options:O}},this.initFromSerialized=C=>{this.name=C.name,this.refId=C.refId,this.meta=C.meta,this.length=C.length,this.labels=C.labels,this.schemaFields=C.schemaFields,this.timeFieldIndex=C.timeFieldIndex,this.pushMode=C.pushMode,this.packetInfo.length=C.packetInfo.length,this.packetInfo.number=C.packetInfo.number,this.packetInfo.action="replace",this.packetInfo.schemaChanged=!0,this.fields=C.fields.map(P=>({...P,type:P.type??a.PU.other,config:P.config??{},values:P.values??[]})),h(this.fields.map(P=>P.values),this.options.maxLength,this.timeFieldIndex,this.options.maxDelta)},this.needsResizing=({maxLength:C,maxDelta:P})=>{const M=C&&this.options.maxLength<C,O=P&&this.options.maxDelta<P,j=P&&this.options.maxDelta===1/0;return!!(M||O||j)},this.resize=({maxLength:C,maxDelta:P})=>{P&&(this.options.maxDelta===1/0?this.options.maxDelta=P:this.options.maxDelta=Math.max(P,this.options.maxDelta)),this.options.maxLength=Math.max(this.options.maxLength,C??0)},this.pushNewValues=C=>{if(!C?.length)return;this.packetInfo.action=this.options.action,this.packetInfo.number++,this.packetInfo.length=C[0].length,this.packetInfo.schemaChanged=!1,this.options.action==="append"?y(this.fields.map(M=>M.values),C,this.options.maxLength,this.timeFieldIndex,this.options.maxDelta):(C.forEach((M,O)=>{this.fields[O]&&(this.fields[O].values=M)}),h(this.fields.map(M=>M.values),this.options.maxLength,this.timeFieldIndex,this.options.maxDelta));const P=this.fields?.[0]?.values.length;P!==void 0&&(this.length=P)},this.resetStateCalculations=()=>{this.fields.forEach(C=>{C.state={...C.state??{},calcs:void 0,range:void 0}})},this.getMatchingFieldIndexes=C=>this.fields.map((P,M)=>C(P)?M:void 0).filter(P=>P!==void 0),this.getValuesFromLastPacket=()=>this.fields.map(C=>{const P=C.values;return P.slice(Math.max(P.length-this.packetInfo.length))}),this.hasAtLeastOnePacket=()=>!!this.packetInfo.length,this.getOptions=()=>this.options,Object.defineProperty(this,"length",{enumerable:!0}),Object.defineProperty(this,"fields",{enumerable:!0})}static{this.deserialize=D=>{const C=new f(D.options);return C.initFromSerialized(D),C}}static{this.empty=D=>new f(p(D))}static{this.fromDataFrameJSON=(D,C)=>{const P=new f(p(C));return P.push(D),P}}get alwaysReplace(){return this.options.action==="replace"}push(D){const{schema:C,data:P}=D;if(this.packetInfo.number++,this.packetInfo.length=0,this.packetInfo.schemaChanged=!1,C){this.pushMode=0,this.timeFieldIndex=C.fields.findIndex(U=>U.type===a.PU.time);const M=C.fields[0];this.timeFieldIndex===1&&M.type===a.PU.string&&(M.name==="labels"||M.name==="Labels")&&(this.pushMode=1,this.timeFieldIndex=0);const O=this.pushMode===1?C.fields.slice(1):C.fields;this.refId=C.refId,C.meta&&(this.meta={...C.meta});const{displayNameFormat:j}=this.options;if(E(this.schemaFields,O)){const U=O.length;this.fields.forEach((W,B)=>{const S=O[B%U];W.config=S.config??{},W.labels=S.labels}),j&&this.fields.forEach(W=>{const B={[l]:W.name,...W.labels};W.config.displayNameFromDS=(0,i.j)(j,B)})}else{this.packetInfo.schemaChanged=!0;const U=this.pushMode===0;this.fields=O.map(W=>{const B=W.config??{};if(j){const S={[l]:W.name,...W.labels};B.displayNameFromDS=(0,i.j)(j,S)}return{config:B,name:W.name,labels:W.labels,type:W.type??a.PU.other,values:U?this.fields.find(S=>S.name===W.name&&W.type===S.type)?.values??Array(this.length).fill(void 0):[]}})}this.schemaFields=O}if(P&&P.values.length&&P.values[0].length){let{values:M,entities:O}=P;if(O&&O.forEach((U,W)=>{U&&(0,r.t)(U,M[W])}),this.pushMode===1){const U=c(M);for(const S of U.keys())this.labels.has(S)||(this.packetInfo.schemaChanged=!0,this.addLabel(S));let W=Array(this.schemaFields.length).fill([]),B=[];this.labels.forEach(S=>{B.push(U.get(S)??W)}),M=(0,n.fj)(B)}if(M.length!==this.fields.length){if(this.fields.length)throw new Error(`push message mismatch.  Expected: ${this.fields.length}, received: ${M.length} (labels=${this.pushMode===1})`);this.fields=M.map((U,W)=>{let B=`Field ${W}`,S=(0,u.HW)(U[0]);return W===0&&S===a.PU.number&&U[0]>1600016688632&&(S=a.PU.time,B="Time"),{name:B,type:S,config:{},values:[]}})}let j=M;this.packetInfo.length=M[0].length,this.alwaysReplace||!this.length?this.packetInfo.action="replace":(this.packetInfo.action="append",j=this.fields.map(U=>U.values),y(j,M,this.options.maxLength,this.timeFieldIndex,this.options.maxDelta)),j.forEach((U,W)=>{const B=this.fields[W],{state:S}=B;B.values=U,S&&(S.calcs=void 0)}),this.length=j[0].length}return{...this.packetInfo}}addLabel(D){const{displayNameFormat:C}=this.options,P=this.labels.size,M=v(D);if(P===0)this.fields.forEach((O,j)=>{if(j>0&&(O.labels=M,C)){const U={[l]:O.name,...M};O.config.displayNameFromDS=(0,i.j)(C,U)}});else for(let O=1;O<this.schemaFields.length;O++){let j=this.schemaFields[O];const U=j.config??{};if(C){const W={[l]:j.name,...M};U.displayNameFromDS=(0,i.j)(C,W)}this.fields.push({...j,config:U,labels:M,values:Array(this.length).fill(void 0)})}this.labels.add(D)}}function p(b){return{maxLength:b?.maxLength??1e3,maxDelta:b?.maxDelta??1/0,action:b?.action??"append",displayNameFormat:b?.displayNameFormat}}function c(b){let D=new Set(b[0]),C=new Map;D.forEach(P=>{let M=Array(b.length-1).fill(null).map(()=>[]);C.set(P,M)});for(let P=0;P<b[0].length;P++){let M=C.get(b[0][P]);for(let O=1;O<b.length;O++)M[O-1].push(b[O][P])}return C}function x(b,D,C,P){let M;C=C||0,P=P||D.length-1;let O=P<=2147483647;for(;P-C>1;)M=O?C+P>>1:Math.floor((C+P)/2),D[M]<b?C=M:P=M;return b-D[C]<=D[P]-b?C:P}function v(b){if(!b.length)return{};if(b.charAt(0)==="{")return(0,s.Xy)(b);const D={};return b.split(",").forEach(C=>{const[P,M]=C.trim().split("=");D[P]=M}),D}function m(b){if(b instanceof f)return b.packetInfo.action}function y(b,D,C=1/0,P=0,M=1/0){for(let O=0;O<b.length;O++)for(let j=0;j<D[O].length;j++)b[O].push(D[O][j]);return h(b,C,P,M)}function h(b,D=1/0,C=0,P=1/0){const M=d(b,D,C,P);if(M)for(let O=0;O<b.length;O++)b[O].splice(0,M);return M}function d(b,D=1/0,C=0,P=1/0){if(!b[0]?.length)return 0;const M=b[0].length;let O=0;if(M>D&&(O=M-D),P!==1/0&&C>=0){const j=b[C],U=j[O],W=j[M-1];W-U>P&&(O=x(W-P,j,O))}return O}function E(b,D){if(b?.length!==D.length)return!1;for(let C=0;C<b.length;C++){const P=b[C],M=D[C];if(P.name!==M.name||P.type!==M.type)return!1}return!0}},76732:(te,R,e)=>{"use strict";e.d(R,{J3:()=>i,ab:()=>u,bW:()=>s});var n=e(2543),a=e.n(n);function s(o,l,g){if(o===l)return!0;if(o?.fields?.length!==l?.fields?.length||o.name!==l.name)return!1;for(let f=0;f<o.fields.length;f++){const p=o.fields[f],c=l.fields[f];if(p.type!==c.type||p.name!==c.name)return!1;if(g)continue;if(p.labels&&c.labels&&!u(p.labels,c.labels))return!1;const x=p.config,v=c.config;if(Object.keys(x).length!==Object.keys(v).length)return!1;let m;for(m in x){if(!(m in v))return!1;if(m!=="interval"&&!(0,n.isEqual)(x[m],v[m]))return!1}}return!0}function i(o,l,g){if(o===l)return!0;if(o?.length!==l?.length)return!1;for(let f=0;f<o.length;f++)if(!g(o[f],l[f]))return!1;return!0}const r=(o,l)=>o===l;function u(o,l,g=r){if(o===l)return!0;if(Object.keys(o).length!==Object.keys(l).length)return!1;let f;for(f in o)if(!g(o[f],l[f]))return!1;return!0}},41119:(te,R,e)=>{"use strict";e.d(R,{Bt:()=>K,By:()=>B,EI:()=>L,ES:()=>O,HW:()=>h,KR:()=>S,Kl:()=>W,LI:()=>C,N$:()=>T,Vc:()=>P,XQ:()=>E,Yn:()=>U,by:()=>m,ci:()=>D,dF:()=>d,oE:()=>y,pH:()=>b,q7:()=>j,w3:()=>M});var n=e(2543),a=e.n(n),s=e(25229),i=e(92446),r=e(16515),u=e(28105),o=e(95004),l=e(27359),g=e(77154);function f(A){const N=A.columns.map(V=>{const{text:z,type:w,...H}=V,Q=[];return{name:z?.length?z:V,config:H||{},values:Q,type:w&&Object.values(o.PU).includes(w)?w:o.PU.other}});if(!(0,n.isArray)(A.rows))throw new Error(`Expected table rows to be array, got ${typeof A.rows}.`);for(const V of A.rows)for(let z=0;z<N.length;z++)N[z].values.push(V[z]);for(const V of N)if(V.type===o.PU.other){const z=d(V);z&&(V.type=z)}return{fields:N,refId:A.refId,meta:A.meta,name:A.name,length:A.rows.length}}function p(A){const N=[],V=[],z=A.datapoints||A.points;for(const H of z)V.push(H[0]),N.push(H[1]);const w=[{name:o.LE,type:o.PU.time,config:{},values:N},{name:o.Bc,type:o.PU.number,config:{unit:A.unit},values:V,labels:A.tags}];return A.title&&(w[1].config.displayNameFromDS=A.title),{name:A.target||A.name,refId:A.refId,meta:A.meta,fields:w,length:V.length}}function c(A){const N=[],V=[];for(let z=0;z<A.data.length;z++){const w=A.data[z];N.push(w[1]),V.push(w[0])}return{name:A.label,fields:[{name:A.label||o.Bc,type:o.PU.number,config:{},values:N},{name:o.LE,type:o.PU.time,config:{unit:"dateTimeAsIso"},values:V}],length:N.length}}function x(A){const N=[{name:A.target,type:o.PU.other,labels:A.tags,config:{unit:A.unit,filterable:A.filterable},values:[]}];for(const V of A.datapoints)N[0].values.push(V);return{name:A.target,refId:A.target,meta:{json:!0},fields:N,length:A.datapoints.length}}const v=/^\s*(-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?|NAN)\s*$/i;function m(A,N){return A&&(A=A.toLowerCase(),A==="date"||A==="time")?o.PU.time:h(N)}function y(A){return A instanceof Date||(0,s.Ar)(A)?o.PU.time:(0,n.isNumber)(A)?o.PU.number:(0,n.isString)(A)?o.PU.string:(0,n.isBoolean)(A)?o.PU.boolean:o.PU.other}function h(A){return A instanceof Date||(0,s.Ar)(A)?o.PU.time:(0,n.isNumber)(A)?o.PU.number:(0,n.isString)(A)?v.test(A)?o.PU.number:A==="true"||A==="TRUE"||A==="True"||A==="false"||A==="FALSE"||A==="False"?o.PU.boolean:o.PU.string:(0,n.isBoolean)(A)?o.PU.boolean:o.PU.other}function d(A){if(A.name){const N=A.name.toLowerCase();if(N==="date"||N==="time")return o.PU.time}for(let N=0;N<A.values.length;N++){const V=A.values[N];if(V!=null)return h(V)}}const E=(A,N=!1)=>{for(const V of A.fields)if(!V.type||V.type===o.PU.other||N)return{...A,fields:A.fields.map(z=>z.type&&z.type!==o.PU.other&&!N?z:{...z,type:d(z)||o.PU.other})};return A},b=A=>!!(A&&A.hasOwnProperty("columns")),D=A=>!!(A&&A.hasOwnProperty("fields")),C=A=>!!(D(A)&&A.hasOwnProperty("value"));function P(A){if("fields"in A)return"length"in A&&A.fields[0]?.values?.get?A:L(A);if(A.hasOwnProperty("type")&&A.type==="docs")return x(A);if(A.hasOwnProperty("datapoints")||A.hasOwnProperty("points"))return p(A);if(A.hasOwnProperty("data"))return A.hasOwnProperty("schema")?(0,g.or)(A):c(A);if(A.hasOwnProperty("columns"))return f(A);if(Array.isArray(A))return(0,l.I)(A);throw console.warn("Can not convert",A),new Error("Unsupported data format")}const M=A=>{const{fields:N}=A,V=A.length,z=[];if(N.length===2){const{timeField:w,timeIndex:H}=S(A);if(w){const Z=N[H===0?1:0],Y=N[H];for(let X=0;X<V;X++)z.push([Z.values[X],Y.values[X]]);return{alias:A.name,target:(0,r.Ct)(Z,A),datapoints:z,unit:N[0].config?N[0].config.unit:void 0,refId:A.refId,meta:A.meta}}}for(let w=0;w<V;w++){const H=[];for(let Q=0;Q<N.length;Q++)H.push(N[Q].values[w]);z.push(H)}return A.meta&&A.meta.json?{alias:N[0].name||A.name,target:N[0].name||A.name,datapoints:N[0].values,filterable:N[0].config?N[0].config.filterable:void 0,type:"docs"}:{columns:N.map(w=>{const{name:H,config:Q}=w;if(Q){const{...Z}=Q;return Z.text=H,Z}return{text:H}}),type:"table",refId:A.refId,meta:A.meta,rows:z}};function O(A,N,V=!1){const z=A.fields[N];if(!z)return A;const w=[];for(let Q=0;Q<A.length;Q++)w.push(Q);const H=(0,i.i)(z,V);return w.sort(H),{...A,fields:A.fields.map(Q=>{const Z={...Q,values:Q.values.map((X,I)=>Q.values[w[I]])},{nanos:Y}=Q;return Y!==void 0&&(Z.nanos=Y.map((X,I)=>Y[w[I]])),Z})}}function j(A){return{...A,fields:A.fields.map(N=>{const V=[...N.values];V.reverse();const z={...N,values:V},{nanos:w}=N;if(w!==void 0){const H=[...w];H.reverse(),z.nanos=H}return z})}}function U(A,N){const V=[];for(const z of A.fields)V.push(z.values[N]);return V}function W(A){return B(A)}function B(A,N){return{fields:(N?A.fields.filter(N):A.fields).map(w=>{let H=w.values;return{name:w.name,type:w.type,config:w.config,values:H,labels:w.labels}}),refId:A.refId,meta:A.meta,name:A.name}}const S=A=>{for(let N=0;N<A.fields.length;N++)if(A.fields[N].type===o.PU.time)return{timeField:A.fields[N],timeIndex:N};return{}};function _(A){const N=E(P(A));if(N.fields&&N.fields.length)for(const V of N.fields)V.state=null;return N}function K(A){return!A||!(0,n.isArray)(A)?[]:A.map(N=>_(N))}function T(A,N){const{series:V,annotations:z}=A;if(A.state===u.Gu.Loading&&V.length===0)return N||(N=A),{...N,state:u.Gu.Loading,request:A.request};const w=performance.now(),H=V.map(Y=>_(Y)),Q=K(z),Z=performance.now();return{...A,series:H,annotations:Q,timings:{dataProcessingTime:Z-w}}}function L(A){let N=0;const V=A.fields.map((z,w)=>{const{state:H,...Q}=z;return Q.name||(Q.name=`Field ${w+1}`),Q.config||(Q.config={}),Q.values?Q.values.length>N&&(N=Q.values.length):Q.values=new Array(N),Q.type||(Q.type=d(Q)??o.PU.other),Q});return{...A,fields:V,length:N}}},17503:(te,R,e)=>{"use strict";e.d(R,{S1:()=>l,aH:()=>i,hF:()=>u,jq:()=>r,t9:()=>g,tP:()=>o,uY:()=>f});var n=e(95004),a=e(41119);const s=100;function i(p){if(p.fields.length<2)return!1;const c=p.fields.find(v=>v.type===n.PU.number);let x=!1;for(const v of p.fields)if(u(v)){x=!0;break}return x&&c!==void 0}function r(p){return!p.find(c=>!i(c))}function u(p){if(p.type!==n.PU.time)return!1;let c=null,x=p.values.length>s?s:p.values.length;for(let v=0;v<x;v++){const m=p.values[v];if(c===null||m!==null&&m>c)c=m;else return!1}return!0}function o(p){for(let c=0;c<p.length;c++){const x=(0,a.KR)(p[c]);if(x.timeField!==void 0&&x.timeIndex!==void 0)return!0}return!1}function l(p){return p.fields.some(c=>c.type===n.PU.time)}function g(p,c){if(p.meta?.uniqueRowIdFields!==void 0)return p.meta.uniqueRowIdFields.map(x=>p.fields[x].values[c]).join("-")}function f(p,c){if(c instanceof Array)for(let x=0;x<c.length;x++)p.fields[x].values.push(c[x]);else for(const x of p.fields)x.values.push(c[x.name]);try{p.length++}catch{}}},74529:(te,R,e)=>{"use strict";e.d(R,{E9:()=>o,Q7:()=>u,Ri:()=>l,V3:()=>x,WT:()=>g,dU:()=>r,di:()=>p,pp:()=>c,vd:()=>f});var n=e(47402),a=e(60365),s=e(66907);const i={years:["y","Y","years"],months:["M","months"],weeks:["w","W","weeks"],days:["d","D","days"],hours:["h","H","hours"],minutes:["m","minutes"],seconds:["s","S","seconds"]};function r(m,y=!0){if((0,n.d)(m.start,m.end))return"";const h=(0,a.F)(m);return u(h,y)}function u(m,y){return Object.entries(m).reduce((h,[d,E])=>E&&E!==0&&!(d==="seconds"&&!y&&h)?h+`${h!==""?" ":""}${E}${i[d][0]}`:h,"")}function o(m){return m.split(" ").reduce((y,h)=>{const d=h.match(/(\d+)(.+)/),E=d?.[1],b=d?.[2];if(!(E&&b))return y;const D=Object.entries(i).find(([P,M])=>M?.includes(d[2])),C=parseInt(E,10);return D?{...y,[D[0]]:C}:y},{})}function l(m,y){return(0,s.W)(m,y)}function g(m){const y=new Date;return l(y,m).getTime()-y.getTime()}function f(m){return!isNaN(Date.parse(m))}function p(m){for(const y of m.trim().split(" ")){const h=y.match(/(\d+)(.+)/);if(h===null||h.length!==3||!Object.entries(i).find(([E,b])=>b?.includes(h[2]))?.[0])return!1}return!0}function c(m){return v(m,["h","m","s","ms","us","\xB5s","ns"])}function x(m){return v(m,["y","M","w","d","h","m","s","ms","us","\xB5s","ns"])}function v(m,y){for(const h of m.trim().split(" ")){const d=h.match(/([0-9]*[.]?[0-9]+)(.+)/);if(d===null||d.length!==3||!y.includes(d[2]))return!1}return!0}},62717:(te,R,e)=>{"use strict";e.d(R,{HD:()=>l,P3:()=>f,QZ:()=>g,U3:()=>p,g$:()=>u,le:()=>o});var n=e(2543),a=e.n(n),s=e(84743),i=e.n(s),r=e(60188),u=(h=>(h.default="",h.localBrowserTime="browser",h.utc="utc",h))(u||{});const o=h=>{switch((0,r.O)({timeZone:h})){case"browser":return"Local browser time";case"utc":return"UTC";default:return h}},l=h=>i().tz.zone(h),g=(h,d)=>{const E=c(h,d);return E||v(h,d)},f=(0,n.memoize)((h=!1)=>{const d=[];return h===!0?d.push("","browser","utc"):h&&d.push(...h),i().tz.names().reduce((E,b)=>{const D=y[b];return!Array.isArray(D)||D.length===0||E.push(b),E},d)}),p=(0,n.memoize)((h=!1)=>{const E=f(h).reduce((b,D)=>{const C=D.indexOf("/");if(C===-1){const M="";return b[M]=b[M]??[],b[M].push(D),b}const P=D.slice(0,C);return b[P]=b[P]??[],b[P].push(D),b},{});return Object.keys(E).map(b=>({name:b,zones:E[b]}))}),c=(h,d)=>{switch(h){case"utc":return{name:"Coordinated Universal Time",ianaName:"UTC",zone:h,countries:[],abbreviation:"UTC, GMT",offsetInMins:0};case"":{const E=(0,r.O)(),D=E==="browser"||E==="utc"?c(E,d):v(E,d);return{countries:y[E]??[],abbreviation:"",offsetInMins:0,...D,ianaName:D?.ianaName??"",name:"Default",zone:h}}case"browser":{const E=i().tz.guess(!0),b=v(E,d);return{countries:y[E]??[],abbreviation:"Your local time",offsetInMins:new Date().getTimezoneOffset(),...b,name:"Browser Time",ianaName:b?.ianaName??"",zone:h}}default:return}},x=h=>/^(\+|\-).+/.test(h)?"":h,v=(h,d)=>{const E=i().tz.zone(h);if(E)return{name:h,ianaName:E.name,zone:h,countries:y[h]??[],abbreviation:x(E.abbr(d)),offsetInMins:E.utcOffset(d)}},m={AF:"Afghanistan",AX:"Aland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua And Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia And Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, Democratic Republic",CK:"Cook Islands",CR:"Costa Rica",CI:"Cote D'Ivoire",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island & Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran (Islamic Republic Of)",IQ:"Iraq",IE:"Ireland",IM:"Isle Of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KR:"Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia (Federated States Of)",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestine, State of",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthelemy",SH:"Saint Helena",KN:"Saint Kitts And Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre And Miquelon",VC:"Saint Vincent And Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome And Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia And Sandwich Isl.",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard And Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad And Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks And Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis And Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},y=i().tz.countries().reduce((h,d)=>i().tz.zonesForCountry(d).reduce((b,D)=>{b[D]||(b[D]=[]);const C=m[d];return!C||d==="AQ"&&!D.startsWith("Antarctica/")||b[D].push({code:d,name:C}),b},h),{})},57852:(te,R,e)=>{"use strict";e.d(R,{LL:()=>g,LO:()=>i,NI:()=>l,Tp:()=>f,We:()=>r,b_:()=>a,gc:()=>u,ql:()=>s,wE:()=>o});var n=e(68388);class a extends n.x{static{this.type="data-hover"}}class s extends n.a{static{this.type="data-hover-clear"}}class i extends n.x{static{this.type="data-select"}}class r extends n.x{static{this.type="annotation-event"}}class u extends n.x{static{this.type="dashboard-loaded"}}class o extends n.a{static{this.type="datasource-updated-successfully"}}class l extends n.a{static{this.type="datasource-test-succeeded"}}class g extends n.a{static{this.type="datasource-test-failed"}}class f extends n.x{static{this.type="set-panel-attention"}}},36819:(te,R,e)=>{"use strict";e.d(R,{R:()=>a});const n=new Set;function a(s){if(n.has(s))throw new Error(`There is already an event defined with type '${s}'`);return n.add(s),{name:s}}},76803:(te,R,e)=>{"use strict";e.d(R,{K:()=>a});var n=e(42954);class a extends n.O{}},11576:(te,R,e)=>{"use strict";e.d(R,{H:()=>v,J:()=>c});var n=e(2543),a=e.n(n),s=e(41119),i=e(25229),r=e(44922),u=e(95004),o=e(13227),l=e(35987),g=e(55386),f=e(79118);const p={dateTimeAsIso:!0,dateTimeAsIsoNoDateIfToday:!0,dateTimeAsUS:!0,dateTimeAsUSNoDateIfToday:!0,dateTimeAsLocal:!0,dateTimeAsLocalNoDateIfToday:!0,dateTimeFromNow:!0};function c(y){if(!y||(0,n.isEmpty)(y)||!y.field)return x;const h=y.field,d=h.config??{},{palette:E}=y.theme.visualization;let b=d.unit,D=b&&(p[b]||b.startsWith("time:")),C=!1;if(h.type===u.PU.time&&!D){if(b="dateTimeAsSystem",D=!0,h.values&&h.values.length>1){let S=h.values[0],_=h.values[h.values.length-1];typeof S=="string"?(S=(0,r.b)(S).unix(),_=(0,r.b)(_).unix()):(S/=1e3,_/=1e3),C=Math.abs(_-S)<60}}else h.type===u.PU.boolean?(0,g.j9)(b)||(b="bool"):!b&&h.type===u.PU.string&&(b="string");const P=b?.startsWith("currency"),M=(0,g.j9)(b),O=h.type===u.PU.number,U=!D&&!P&&!M&&!(b==="locale")&&O&&d.decimals==null,W=(0,g.j_)(b||"none"),B=(0,f.jc)(h,y.theme);return(S,_)=>{const{mappings:K}=d,T=b==="string";D&&typeof S=="string"&&(S=(0,i.yT)(S).valueOf());let L=T?NaN:(0,o.t)(S),A,N,V,z,w,H;if(K&&K.length>0){const Z=(0,l.Zz)(K,S);Z&&(Z.text!=null&&(A=Z.text),Z.color!=null&&(z=y.theme.visualization.getColorByName(Z.color)),Z.icon!=null&&(w=Z.icon))}else if(h.type===u.PU.enum){if(S==null)return{text:"",numeric:NaN};const Z=+S;if(d&&d.type&&d.type.enum){const{text:Y,color:X}=d.type.enum;if(A=Y?Y[Z]:`${S}`,z=X?X[Z]:void 0,z==null){const I=E[Z%E.length];z=y.theme.visualization.getColorByName(I)}}}if(!Number.isNaN(L)){if(A==null&&!(0,n.isBoolean)(S)){let Z;U&&_!=null?(Z=W(L,_,null,y.timeZone,C),Z.text=+Z.text+""):Z=W(L,d.decimals,null,y.timeZone,C),A=Z.text,V=Z.suffix,N=Z.prefix}if(z==null){const Z=B(L);z=Z.color,H=Z.percent}}if(A==null&&(0,n.isArray)(S)&&(A=(0,n.join)(S,", ")),A==null&&(A=(0,n.toString)(S),A||(d.noValue?A=d.noValue:A="")),!z){const Z=B(-1/0);z=Z.color,H=Z.percent}const Q={text:A,numeric:L,prefix:N,suffix:V,color:z};return w!=null&&(Q.icon=w),H!=null&&(Q.percent=H),Q}}function x(y){return{text:(0,n.toString)(y),numeric:(0,o.t)(y)}}function v(){return y=>({text:(0,s.oE)(y)==="other"?`${JSON.stringify(y,m())}`:`${y}`,numeric:null})}const m=()=>{const y=new WeakSet;return(h,d)=>{if(typeof d=="object"&&d!==null){if(y.has(d))return;y.add(d)}return d}}},76637:(te,R,e)=>{"use strict";e.d(R,{Hs:()=>v,Qi:()=>x,lz:()=>m,uf:()=>p});var n=e(21197),a=e(55459),s=e.n(a),i=e(84140),r=e(6773),u=e(46644),o=e(64394),l=e(42954),g=e(79118),f=e(36394);const p=new l.O(()=>[{id:o.Y.Fixed,name:"Single color",description:"Set a specific color",getCalculator:y},{id:o.Y.Shades,name:"Shades of a color",description:"Select shades of a specific color",getCalculator:h},{id:o.Y.Thresholds,name:"From thresholds",isByValue:!0,description:"Derive colors from thresholds",getCalculator:(d,E)=>(b,D,C)=>{const P=C??f.QS;return E.visualization.getColorByName(P.color)}},new c({id:o.Y.PaletteClassic,name:"Classic palette",isContinuous:!1,isByValue:!1,getColors:d=>d.visualization.palette}),new c({id:o.Y.PaletteClassicByName,name:"Classic palette (by series name)",isContinuous:!1,isByValue:!1,useSeriesName:!0,getColors:d=>d.visualization.palette.filter(E=>(0,r.eM)(d.visualization.getColorByName(E),d.colors.background.primary)>=d.colors.contrastThreshold)}),new c({id:o.Y.ContinuousGrYlRd,name:"Green-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:d=>["green","yellow","red"]}),new c({id:o.Y.ContinuousRdYlGr,name:"Red-Yellow-Green",isContinuous:!0,isByValue:!0,getColors:d=>["red","yellow","green"]}),new c({id:o.Y.ContinuousBlYlRd,name:"Blue-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:d=>["dark-blue","super-light-yellow","dark-red"]}),new c({id:o.Y.ContinuousYlRd,name:"Yellow-Red",isContinuous:!0,isByValue:!0,getColors:d=>["super-light-yellow","dark-red"]}),new c({id:o.Y.ContinuousBlPu,name:"Blue-Purple",isContinuous:!0,isByValue:!0,getColors:d=>["blue","purple"]}),new c({id:o.Y.ContinuousYlBl,name:"Yellow-Blue",isContinuous:!0,isByValue:!0,getColors:d=>["super-light-yellow","dark-blue"]}),new c({id:o.Y.ContinuousBlues,name:"Blues",isContinuous:!0,isByValue:!0,getColors:d=>["panel-bg","dark-blue"]}),new c({id:o.Y.ContinuousReds,name:"Reds",isContinuous:!0,isByValue:!0,getColors:d=>["panel-bg","dark-red"]}),new c({id:o.Y.ContinuousGreens,name:"Greens",isContinuous:!0,isByValue:!0,getColors:d=>["panel-bg","dark-green"]}),new c({id:o.Y.ContinuousPurples,name:"Purples",isContinuous:!0,isByValue:!0,getColors:d=>["panel-bg","dark-purple"]})]);class c{constructor(E){this.id=E.id,this.name=E.name,this.description=E.description,this.getNamedColors=E.getColors,this.isContinuous=E.isContinuous,this.isByValue=E.isByValue,this.useSeriesName=E.useSeriesName}getColors(E){return this.getNamedColors?this.colorCache&&this.colorCacheTheme===E?this.colorCache:(this.colorCache=this.getNamedColors(E).map(E.visualization.getColorByName),this.colorCacheTheme=E,this.colorCache):[]}getInterpolator(){return this.interpolator||(this.interpolator=(0,n.Ik)(this.colorCache)),this.interpolator}getCalculator(E,b){const D=this.getColors(b);return this.isByValue?this.isContinuous?(C,P,M)=>this.getInterpolator()(P):(C,P,M)=>D[P*(D.length-1)]:this.useSeriesName?(C,P,M)=>D[Math.abs(s()(E.state?.displayName??E.name))%D.length]:(C,P,M)=>{const O=E.state?.seriesIndex??0;return D[O%D.length]}}}function x(d){return p.get(d.config.color?.mode??o.Y.Thresholds)}function v(d){return p.get(d??o.Y.Thresholds)}function m(d,E){const b=x(d);if(!b.isByValue)return{color:b.getCalculator(d,E)(0,0),threshold:f.QS,percent:1};const D=(0,g.jc)(d,E),C=d.config.color?.seriesBy??"last",M=(0,u.Nw)({field:d,reducers:[C]})[C]??0;return D(M)}function y(d,E){return()=>E.visualization.getColorByName(d.config.color?.fixedColor??o.F)}function h(d,E){return()=>{const b=E.visualization.getColorByName(d.config.color?.fixedColor??o.F),D=[b],C=6,P=10,M=35,O=35;for(let U=1;U<C;U++)D.push((0,i.A)(b).spin(U/C*P).brighten(U/C*M).toHexString()),D.push((0,i.A)(b).spin(-(U/C)*P).darken(U/C*O).toHexString());const j=d.state?.seriesIndex??0;return D[j%D.length]}}},92446:(te,R,e)=>{"use strict";e.d(R,{i:()=>r});var n=e(2543),a=e.n(n),s=e(25229),i=e(95004);const r=(d,E=!1)=>{const b=d.values;switch(d.type){case i.PU.number:return m(b,E);case i.PU.string:return y(b,E);case i.PU.boolean:return v(b,E);case i.PU.time:return typeof d.values[0]=="number"?c(b,E):x(b,E);default:return h(E)}},u=(d,E)=>{if(!d||!E)return p(d,E);if((0,n.isNumber)(d)&&(0,n.isNumber)(E))return o(d,E);if((0,s.u8)(d)&&(0,s.u8)(E)){if((0,s.KQ)(d).isBefore(E))return-1;if((0,s.KQ)(E).isBefore(d))return 1}return 0},o=(d,E)=>d-E,l=new Intl.Collator("en",{sensitivity:"base"}).compare,g=(d,E)=>!d||!E?p(d,E):l(String(d),String(E)),f=(d,E)=>p(d,E),p=(d,E)=>!d&&E?1:d&&!E?-1:0,c=(d,E)=>{let b=E?-1:1;return(D,C)=>b*(d[D]-d[C])},x=(d,E)=>(b,D)=>{const C=d[b],P=d[D];return E?u(P,C):u(C,P)},v=(d,E)=>(b,D)=>{const C=d[b],P=d[D];return E?f(P,C):f(C,P)},m=(d,E)=>(b,D)=>{const C=d[b],P=d[D];return E?o(P,C):o(C,P)},y=(d,E)=>(b,D)=>{const C=d[b],P=d[D];return E?g(P,C):g(C,P)},h=d=>(E,b)=>d?o(b,E):o(E,b)},44232:(te,R,e)=>{"use strict";e.d(R,{PI:()=>h,Pm:()=>y,XS:()=>C,Zo:()=>O,a_:()=>m,eG:()=>D,k3:()=>p,k_:()=>v,nF:()=>x,py:()=>c});var n=e(2543),a=e.n(n),s=e(88673),i=e(41119),r=e(46644),u=e(36638),o=e(57866),l=e(95004),g=e(11576),f=e(16515);const p="__series.name",c="__field.displayName",x="__field.labels",v="__calc",m="__cell_",y=25,h=U=>{const{replaceVariables:W,reduceOptions:B,timeZone:S,theme:_}=U,K=B.calcs.length?B.calcs:[r.gy.last],T=[],L=(0,u.NS)(B.fields?{id:o.Ct.byRegexp,options:B.fields}:{id:o.Ct.numeric}),A=U.data??[],N=B.limit?B.limit:y;let V=!1;for(let z=0;z<A.length&&!V;z++){const w=A[z],{timeField:H}=(0,i.KR)(w),Q=new s.R(w);for(let Z=0;Z<w.fields.length&&!V;Z++){const Y=w.fields[Z],X=Y.getLinks;if(!L(Y,w,A))continue;let I=Y.config;Y.state?.range&&(I={...I,...Y.state?.range});let J=Y.config.displayName??"";const ee=Y.display??(0,g.J)({field:Y,theme:U.theme,timeZone:S});if(B.values)for(let q=0;q<Y.values.length;q++){Y.state=E(Y,T.length);const ne=j(Y,q),se=ee(Y.values[q]),oe=d(w,Y,q,W,ne),de=b(oe,U.fieldConfig,_);if(T.push({name:"",field:I,display:{...se,title:oe,color:de??se.color},view:Q,colIndex:Z,rowIndex:q,getLinks:X?()=>X({valueRowIndex:q}):()=>[],hasLinks:D(Y)}),T.length>=N){V=!0;break}}else{const q=(0,r.Nw)({field:Y,reducers:K});for(const ne of K){const se=Y.state?.scopedVars??{};se[v]={value:ne,text:ne};const oe=ee(q[ne]);J!==""?oe.title=W(J,se):oe.title=(0,f.Ct)(Y,w,A),oe.percentChange=U.percentChange?(0,r.Nw)({field:Y,reducers:[r.gy.diffperc]}).diffperc:void 0;let de;U.sparkline&&(de={y:w.fields[Z],x:H},ne===r.gy.last?de.highlightIndex=de.y.values.length-1:ne===r.gy.first&&(de.highlightIndex=0));const fe=w.length===1?0:void 0;T.push({name:ne,field:I,display:oe,sparkline:de,view:Q,colIndex:Z,getLinks:X?()=>X({calculatedValue:oe,valueRowIndex:fe}):()=>[],hasLinks:D(Y)})}}}}return T.length===0&&T.push(P(U)),T};function d(U,W,B,S,_){const K=W.config.displayName;if(K)return K.indexOf(m)?S(O(K),_):S(K,_);let T=[],L=0;for(const A of U.fields)if(A!==W)if(A.type===l.PU.string){const N=A.values[B]??"",V=A.display?A.display(N).text:N;V.length>0&&T.push(V)}else A.type===l.PU.number&&L++;return(L||T.length===0)&&T.push((0,f.Ct)(W,U)),T.join(" ")}function E(U,W){return{...U.state,seriesIndex:W}}function b(U,W,B){for(const S of W.overrides)if(S.matcher.id==="byName"&&S.matcher.options===U){for(const _ of S.properties)if(_.id==="color"&&_.value)return B.visualization.getColorByName(_.value.fixedColor)}return null}function D(U){return U.config?.links?.length?U.config.links.length>0:!1}function C(U){let W="",B="",S="",_="";for(let K=0;K<U.length;K++){const T=U[K].display;T.text&&T.text.length>B.length&&(B=T.text),T.title&&T.title.length>W.length&&(W=T.title),T.prefix&&T.prefix.length>S.length&&(S=T.prefix),T.suffix&&T.suffix.length>_.length&&(_=T.suffix)}return{text:B,title:W,suffix:_,prefix:S}}function P(U){const W="No data",{fieldConfig:B,timeZone:S}=U,{defaults:_}=B,T=(0,g.J)({field:{name:"",type:l.PU.other,config:_},theme:U.theme,timeZone:S})(null),L=M(T,W);return{name:W,field:{..._,max:_.max??0,min:_.min??0},display:{text:L,numeric:0,color:T.color},hasLinks:!1}}function M(U,W){return!U||(0,n.isEmpty)(U.text)?W:U.text}function O(U){return U.replace(/\${__cell_(\d+)(.*?)}|\[\[__cell_(\d+)(.*?)\]\]|\$__cell_(\d+)(\S*)/g,(W,B,S,_,K,T,L)=>`\${__data.fields[${B??_??T}]${S??K??L}}`)}function j(U,W){return U.state?.scopedVars?.__dataContext?{...U.state?.scopedVars,__dataContext:{value:{...U.state?.scopedVars?.__dataContext.value,rowIndex:W}}}:U.state?.scopedVars}},60519:(te,R,e)=>{"use strict";e.d(R,{BF:()=>j,K3:()=>B,_M:()=>W,nJ:()=>E,rJ:()=>S,vd:()=>_,we:()=>b});var n=e(2543),a=e.n(n),s=e(96540),i=e(84596),r=e(21275),u=e(739),o=e(76732),l=e(41119),g=e(6773),f=e(46644),p=e(36638),c=e(95004),x=e(64394),v=e(38036),m=e(92138),y=e(11576),h=e(79118),d=e(53543);function E(K){let T=null,L=null;const A=[f.gy.min,f.gy.max];for(const N of K)for(const V of N.fields)if(V.type===c.PU.number){const z=(0,f.Nw)({field:V,reducers:A}),w=z[f.gy.min],H=z[f.gy.max];(T===null||w<T)&&(T=w),(L===null||H>L)&&(L=H)}return{min:T,max:L,delta:(L??0)-(T??0)}}function b(K){if(!K.data)return[];const T=K.fieldConfig;if(!T)return K.data;const L=K.fieldConfigRegistry??d.G;let A=0,N;const V=[];if(T.overrides)for(const z of T.overrides){const w=p.sJ.get(z.matcher.id);w&&V.push({match:w.get(z.matcher.options),properties:z.properties})}return K.data.map((z,w)=>{const H={...z};H.fields=H.fields.map(Q=>({...Q,config:(0,n.cloneDeep)(Q.config),state:{...Q.state}}));for(const Q of H.fields){const Z=Q.config;Q.state.scopedVars={__dataContext:{value:{data:K.data,frame:H,frameIndex:w,field:Q}}};const Y={field:Q,data:K.data,dataFrameIndex:w,replaceVariables:K.replaceVariables,fieldConfigRegistry:L};M(Z,T.defaults,Y);for(const ee of V)if(ee.match(Q,H,K.data))for(const q of ee.properties)P(Z,q,Y);let X=Q.type;if(!X||X===c.PU.other){const ee=(0,l.dF)(Q);ee&&(X=ee)}const{range:I,newGlobalRange:J}=D(Z,Q,N,K.data);if(N=J,Q.state.displayName=null,Q.state.seriesIndex=A,Q.state.range=I,Q.type=X,Q.type!==c.PU.time&&A++,Q.display=(0,y.J)({field:Q,theme:K.theme,timeZone:K.timeZone}),Q.config.unit!=="dateTimeFromNow"&&(Q.display=C(Q.display,2500)),Q.getLinks=W(H,Q,Q.state.scopedVars,Y.replaceVariables,K.timeZone,K.dataLinkPostProcessor),Q.type===c.PU.nestedFrames)for(const ee of Q.values)for(let q=0;q<ee.length;q++)for(const ne of ee[q].fields)ne.display=(0,y.J)({field:ne,theme:K.theme,timeZone:K.timeZone}),ne.state={scopedVars:{__dataContext:{value:{data:ee,frame:ee[q],frameIndex:q,field:ne}}}},ne.getLinks=W(ee[q],ne,ne.state.scopedVars,Y.replaceVariables,K.timeZone,K.dataLinkPostProcessor)}return H})}function D(K,T,L,A){if(T.type!==c.PU.number||(0,n.isNumber)(K.min)&&(0,n.isNumber)(K.max))return{newGlobalRange:L};if(K.fieldMinMax){const w=(0,h.AP)(T),H=K.min??w.min,Q=K.max??w.max;return{range:{min:H,max:Q,delta:Q-H},newGlobalRange:L}}const N=L??E(A),V=K.min??N.min,z=K.max??N.max;return{range:{min:V,max:z,delta:z-V},newGlobalRange:N}}function C(K,T=2500){const L=new Map;for(let A=-1;A<=15;A++)L.set(A,new Map);return(A,N)=>{let V=L.get(N??-1),z=V.get(A);return z||(V.size===T&&V.clear(),z=K(A,N),z.color&&(z.color=(0,g.ze)(z.color)),V.set(A,z)),z}}function P(K,T,L){const N=L.fieldConfigRegistry.getIfExists(T.id);if(!N)return;const V=N.process(T.value,L,N.settings);V==null?N.isCustom&&K.custom?(0,n.unset)(K.custom,N.path):(0,n.unset)(K,N.path):N.isCustom?(K.custom||(K.custom={}),(0,n.set)(K.custom,N.path,V)):(0,n.set)(K,N.path,V)}function M(K,T,L){K.links&&T.links&&(K.links=[...K.links,...T.links]);const A=T?.thresholds?.mode===r.Ol.Absolute&&T.thresholds?.steps.find(N=>N.value===-1/0);K.thresholds?.mode===r.Ol.Absolute&&!K.thresholds.steps.some(N=>N.value===-1/0)&&A&&(K.thresholds.steps=[A,...K.thresholds.steps]);for(const N of L.fieldConfigRegistry.list())N.isCustom&&!K.custom&&(K.custom={}),O(N.isCustom?K.custom:K,N.isCustom?T.custom:T,N,L);j(K)}function O(K,T,L,A){const N=(0,n.get)(K,L.path);if(N==null){const V=A.fieldConfigRegistry.getIfExists(L.id);if(!V)return;if(V&&V.shouldApply(A.field)){const z=V.process((0,n.get)(T,V.path),A,V.settings);z!=null&&(0,n.set)(K,V.path,z)}}}function j(K){const{thresholds:T}=K;if(K.color?K.color.mode||delete K.color:T&&(K.color={mode:x.Y.Thresholds}),K.hasOwnProperty("min")&&K.hasOwnProperty("max")&&K.min>K.max){const L=K.max;K.max=K.min,K.min=L}}const U=K=>{const{link:T,linkModel:L,dataLinkScopedVars:A,field:N,replaceVariables:V}=K;return T.internal?(0,v.u)({link:T,internalLink:T.internal,scopedVars:A,field:N,range:T.internal.range,replaceVariables:V}):L},W=(K,T,L,A,N,V)=>z=>!T.config.links||T.config.links.length===0?[]:T.config.links.map(H=>{const Q=_(K,T,L),Z={...L,__dataContext:Q},Y=(J,ee,q)=>A(J,{...Z,...ee},q);z.valueRowIndex!==void 0&&!isNaN(z.valueRowIndex)?Q.value.rowIndex=z.valueRowIndex:Q.value.calculatedValue=z.calculatedValue;let X,I=H.onClick||!H.onBuildUrl?H.url:H.onBuildUrl({origin:T,replaceVariables:Y});return I&&(I=m.I.assureBaseUrl(I.replace(/\n/g,"")),I=A(I,Z,u.$m.UriEncode),I?.length>0&&(I=m.I.processUrl(I))),H.onClick?X={href:I,title:A(H.title||"",Z),target:H.targetBlank?"_blank":void 0,onClick:(J,ee)=>{H.onClick({origin:ee??T,e:J,replaceVariables:Y})},origin:T,oneClick:H.oneClick??!1}:X={href:I,title:A(H.title||"",Z),target:H.targetBlank?"_blank":void 0,origin:T,oneClick:H.oneClick??!1},(V||U)({frame:K,field:T,dataLinkScopedVars:Z,replaceVariables:A,config:z,link:H,linkModel:X})}).filter(H=>!!H);function B(K){if(!K||K.length===0)return[];const T=[...K],L=(0,y.H)();for(let A=0;A<T.length;A++){const N={...T[A]},V=[...N.fields];for(let z=0;z<V.length;z++)V[z]={...V[z],display:L};T[A]={...N,fields:V}}return T}function S(K,T,L,A,N,V,z){const w=K?.fieldConfigRegistry,H=(0,s.useRef)(0),Q=(0,i.A)(L?.series);return(0,s.useMemo)(()=>{if(!w||!T||!L)return;const Z=L?.series;L.structureRev==null&&Z&&Q&&!(0,o.J3)(Z,Q,o.bW)&&H.current++;const Y={structureRev:H.current,...L,series:b({data:Z,fieldConfig:T,fieldConfigRegistry:w,replaceVariables:V,theme:N,timeZone:A,dataLinkPostProcessor:z})};return L.annotations&&L.annotations.length>0&&(Y.annotations=b({data:L.annotations,fieldConfig:{defaults:{},overrides:[]},replaceVariables:V,theme:N,timeZone:A,dataLinkPostProcessor:z})),Y},[w,T,L,Q,A,N,V,z])}function _(K,T,L){return L?.__dataContext?{value:{...L.__dataContext.value}}:{value:{frame:K,field:T,data:[K]}}}},16515:(te,R,e)=>{"use strict";e.d(R,{Ct:()=>o,Fm:()=>r,Ri:()=>i,fk:()=>g,j2:()=>u});var n=e(36638),a=e(95004),s=e(71642);function i(p,c){if(p.name)return p.name;const x=[];for(const v of p.fields)if(v.type!==a.PU.time){if(x.length>1)break;x.push(o(v,p))}return x.length===1?x[0]:c===void 0&&p.fields.length>0?p.fields.filter(v=>v.type!==a.PU.time).map(v=>o(v,p)).join(", "):p.refId?`Series (${p.refId})`:`Series (${c})`}function r(p){p.forEach(c=>{c.fields.forEach(x=>{o(x,c,p)})})}function u(p,c){p.forEach(x=>{x.fields.forEach(v=>{const m={legend:!1,tooltip:!1,viz:!1,...c.defaults.custom?.hideFrom},y=v.config.custom?.hideFrom;c.overrides.forEach(h=>{if("__systemRef"in h)return;if((0,n.NS)(h.matcher)(v,x,p))for(const E of h.properties)E.id==="custom.hideFrom"&&Object.assign(m,E.value)}),v.state={...v.state,hideFrom:{...y}},v.config.custom.hideFrom=m})})}function o(p,c,x){const v=p.state?.displayName,m=!!(x&&x.length>1);if(v&&m===p.state?.multipleFrames)return v;const y=l(p,c,x);return p.state=p.state||{},p.state.displayName=y,p.state.multipleFrames=m,y}function l(p,c,x){const v=p.config?.displayName&&p.config?.displayName.length,m=!!c?.meta?.timeCompare?.isTimeShiftQuery;let y=v?p.config.displayName:p.name;if(v)return m?`${y} (comparison)`:y;if(c&&p.config?.displayNameFromDS)return m?`${p.config.displayNameFromDS} (comparison)`:p.config.displayNameFromDS;if(p.type===a.PU.time&&!p.labels)return y??a.LE;let h=[],d=!1;if(x&&x.length>1){for(let D=1;D<x.length;D++)if(x[D].name!==x[D-1].name){d=!0;break}}let E=!1,b=!1;if(d&&c?.name&&(h.push(c.name),E=!0),p.name&&p.name!==a.Bc&&h.push(p.name),p.labels&&c){let D=f(x??[c]);if(D)p.labels[D]&&(h.push(p.labels[D]),b=!0);else{let C=(0,s.h6)(p.labels);C&&(h.push(C),b=!0)}}return c&&!E&&!b&&p.name===a.Bc&&c.name&&c.name.length>0&&(h.push(c.name),E=!0),h.length?y=h.join(" "):p.name?y=p.name:y=a.Bc,y===p.name&&(y=g(p,c)),m&&(y=`${y} (comparison)`),y}function g(p,c){let x=0,v=!1;if(c)for(let m=0;m<c.fields.length;m++){const y=c.fields[m];if(p===y){if(v=!0,x>0){x++;break}}else if(p.name===y.name&&(x++,v))break}return x?`${p.name} ${x}`:p.name}function f(p){let c=null;for(let x=0;x<p.length;x++){const v=p[x];for(const m of v.fields)if(m.labels){for(const y in m.labels)if(c===null)c=y;else if(y!==c)return null}}return c}},7102:(te,R,e)=>{"use strict";e.d(R,{F:()=>r});var n=e(2543),a=e.n(n),s=e(55386),i=e(11576);function r(u){return new Proxy({},{get:(o,l)=>{let g=u.frame.fields.find(x=>l===x.name);if(!g){const x=(0,n.toNumber)(l);g=u.frame.fields[x]}if(g||(g=u.frame.fields.find(x=>l===x.config.displayName)),g||(g=u.frame.fields.find(x=>x.labels?l===x.labels.name:!1)),!g)return;const f=g.display??(0,i.J)(),p=g.values[u.rowIndex],c=f(p);return c.toString=()=>(0,s.cN)(c),c}})}},38809:(te,R,e)=>{"use strict";e.d(R,{AM:()=>s,Ch:()=>i,FM:()=>p,N7:()=>g,OU:()=>l,X4:()=>c,cz:()=>r,hL:()=>o,hS:()=>n,lG:()=>f,m0:()=>a,xT:()=>u});const n=x=>x,a=(x,v,m)=>{if(x!=null)return parseFloat(String(x))},s=(x,v,m)=>(delete v.field?.state?.displayName,l(x,v,m)),i=(x,v,m)=>x,r=(x,v,m)=>x,u=(x,v,m)=>x,o=(x,v,m)=>x,l=(x,v,m)=>x==null?x:m&&m.expandTemplateVars&&v.replaceVariables&&typeof x=="string"?v.replaceVariables(x,v.field.state.scopedVars):`${x}`,g=(x,v,m)=>x,f=(x,v,m)=>x,p=(x,v,m)=>x;var c=(x=>(x.IncludeAll="all",x.ExcludeBaseNames="exclude",x.OnlyBaseNames="only",x))(c||{})},79118:(te,R,e)=>{"use strict";e.d(R,{AP:()=>g,jc:()=>o,xg:()=>f});var n=e(2543),a=e.n(n),s=e(46644),i=e(95004),r=e(76637),u=e(36394);function o(p,c){if(p.type===i.PU.boolean)return l(p,c);const v=(0,r.Qi)(p).getCalculator(p,c),m=p.state?.range??g(p);return y=>{let h=0;y!==-1/0&&(h=(y-m.min)/m.delta,Number.isNaN(h)&&(h=0));const d=(0,u.k5)(p,y,h);return{percent:h,threshold:d,color:v(y,h,d)}}}function l(p,c){const x={color:c.visualization.getColorByName("green"),percent:1,threshold:void 0},v={color:c.visualization.getColorByName("red"),percent:0,threshold:void 0},m=(0,r.Qi)(p);if(m.isContinuous&&m.getColors){const y=m.getColors(c);x.color=y[y.length-1],v.color=y[0]}return y=>y?x:v}function g(p){if(p.type!==i.PU.number)return{min:0,max:100,delta:100};let c=p.config.min,x=p.config.max;if(!(0,n.isNumber)(c)||!(0,n.isNumber)(x))if(p.values&&p.values.length){const v=(0,s.Nw)({field:p,reducers:[s.gy.min,s.gy.max]});(0,n.isNumber)(c)||(c=v[s.gy.min]),(0,n.isNumber)(x)||(x=v[s.gy.max])}else c=0,x=100;return{min:c,max:x,delta:x-c}}function f(p,c){const{config:x}=p;let{min:v,max:m}=x;return(0,n.isNumber)(v)&&(0,n.isNumber)(m)?x:c||!p.state?.range?{...x,...g(p)}:{...x,...p.state.range}}},53543:(te,R,e)=>{"use strict";e.d(R,{D:()=>i,G:()=>s});var n=e(42954),a=e(76803);const s=new a.K,i=new n.O},36394:(te,R,e)=>{"use strict";e.d(R,{QS:()=>s,RU:()=>u,k5:()=>r,yQ:()=>i});var n=e(64394),a=e(33553);const s={value:0,color:n.F};function i(o,l){if(!l||l.length===0)return s;let g=l[0];for(const f of l)if(o>=f.value)g=f;else break;return g}function r(o,l,g){const{thresholds:f}=o.config;return f?.mode===a.O.Percentage?i(g*100,f?.steps):i(l,f?.steps)}function u(o){return o.sort((l,g)=>l.value-g.value)}},16207:(te,R,e)=>{"use strict";e.d(R,{m:()=>l});var n=e(2543),a=e.n(n),s=e(76803),i=e(11594),r=e(52205),u=e(37615),o=e(37297);class l extends i.Ud{constructor(f){super(),this._fieldConfigDefaults={defaults:{},overrides:[]},this._initConfigRegistry=()=>new s.K,this.dataSupport={annotations:!1,alertStates:!1},this.panel=f}get defaults(){let f=this._defaults||{};if(!this._defaults&&this.optionsSupplier){const p=new r.pv;this.optionsSupplier(p,{data:[]});for(const c of p.getItems())c.defaultValue!=null&&(0,n.set)(f,c.path,c.defaultValue)}return f}get fieldConfigDefaults(){const f=this._fieldConfigDefaults.defaults;f.custom={};for(const p of this.fieldConfigRegistry.list())p.defaultValue!==void 0&&(0,n.set)(f,p.id,p.defaultValue);return{defaults:{...f},overrides:this._fieldConfigDefaults.overrides}}setDefaults(f){return(0,u.l)("PanelPlugin","setDefaults","setPanelOptions"),this._defaults=f,this}get fieldConfigRegistry(){return this._fieldConfigRegistry||(this._fieldConfigRegistry=this._initConfigRegistry()),this._fieldConfigRegistry}setEditor(f){return(0,u.l)("PanelPlugin","setEditor","setPanelOptions"),this.editor=f,this}setNoPadding(){return this.noPadding=!0,this}setMigrationHandler(f,p){return this.onPanelMigration=f,this.shouldMigrate=p,this}setPanelChangeHandler(f){return this.onPanelTypeChanged=f,this}setPanelOptions(f){return this.optionsSupplier=f,this}getPanelOptionsSupplier(){return this.optionsSupplier??(()=>{})}setDataSupport(f){return this.dataSupport={...this.dataSupport,...f},this}useFieldConfig(f={}){return this._initConfigRegistry=()=>(0,o.O)(f,this.meta.name),this}setSuggestionsSupplier(f){return this.suggestionsSupplier=f,this}getSuggestionsSupplier(){return this.suggestionsSupplier}hasPluginId(f){return this.meta.id===f}}},69168:(te,R,e)=>{"use strict";e.d(R,{F:()=>o,H9:()=>x,TQ:()=>v,aW:()=>g,nx:()=>m});var n=e(2543),a=e.n(n),s=e(76637),i=e(64394),r=e(83340),u=e(33553);function o({plugin:y,currentOptions:h,currentFieldConfig:d,isAfterPluginChange:E}){const b=(0,n.mergeWith)({},y.defaults,h||{},(P,M)=>{if((0,n.isArray)(M))return M}),D=l(d,y),C=p(y,D,E);return{options:b,fieldConfig:C}}function l(y,h){const d=h.fieldConfigDefaults,E={defaults:(0,n.mergeWith)({},d.defaults,y?y.defaults:{},(b,D)=>{if((0,n.isArray)(D))return D}),overrides:y?.overrides??[]};f(E.defaults,"",h.fieldConfigRegistry),E.defaults.thresholds&&c(E.defaults.thresholds),E.overrides=g(E.overrides,b=>h.fieldConfigRegistry.getIfExists(b.id)!==void 0);for(const b of E.overrides)for(const D of b.properties)D.id==="thresholds"&&c(D.value);return E}function g(y,h){return y.map(d=>{const E=d.properties.filter(h);return{...d,properties:E}})}function f(y,h,d){let E=!1;for(const[b,D]of Object.entries(y)){const C=`${h}${b}`,P=!!d.getIfExists(C);if(P){E=!0;continue}(0,n.isArray)(D)||!(0,n.isObject)(D)?P||(0,n.unset)(y,b):f(D,`${C}.`,d)||(0,n.unset)(y,b)}return E}function p(y,h,d){if(!d)return h;const E=y.fieldConfigRegistry.getIfExists(r.uo.Color);if(E&&E.settings){const b=E.settings,D=s.uf.getIfExists(h.defaults.color?.mode);if(!b.byValueSupport&&(!D||D.isByValue))return h.defaults.color={mode:i.Y.PaletteClassic},h;if(b.byValueSupport&&b.preferThresholdsMode&&D?.id!==i.Y.Fixed&&(!D||!D.isByValue))return h.defaults.color={mode:i.Y.Thresholds},h;if(b.bySeriesSupport&&D?.isByValue)return h.defaults.color={mode:i.Y.PaletteClassic},h}return h}function c(y){y.mode||(y.mode=u.O.Absolute),y.steps?y.steps.length&&(y.steps[0].value=-1/0):y.steps=[]}function x(y,h){const d={defaults:{...y.defaults,custom:h.defaults.custom},overrides:[...y.overrides]};for(const E of h.overrides)for(const b of E.properties)if(v(b)){const D=d.overrides.find(C=>(0,n.isEqual)(C.matcher,E.matcher));D?D!==E&&D.properties.push(b):d.overrides.push(E)}return d}function v(y){return y.id.startsWith("custom.")}function m(y){return!v(y)}},37297:(te,R,e)=>{"use strict";e.d(R,{O:()=>i});var n=e(76803),a=e(53543),s=e(52205);function i(u={},o){const l=new n.K,g=a.G.list(),f={};if(u.useCustomConfig){const p=new s.bk;u.useCustomConfig(p);for(const c of p.getRegistry().list())if(c.isCustom=!0,c.id="custom."+c.id,r(c,g)){const x=f[c.category[0]]??[];x.push(c),f[c.category[0]]=x}else l.register(c)}for(let p of g){const c=p.id;if(!(u.disableStandardOptions&&u.disableStandardOptions.indexOf(c)>-1)){if(u.standardOptions){const x=u.standardOptions[c]?.hideFromDefaults,v=u.standardOptions[c]?.defaultValue,m=u.standardOptions[c]?.settings;x!==void 0&&(p={...p,hideFromDefaults:x}),v&&(p={...p,defaultValue:v}),m&&(p={...p,settings:p.settings?{...p.settings,...m}:m})}if(l.register(p),p.category&&f[p.category[0]])for(let x of f[p.category[0]])l.register(x)}}for(const p of l.list())if(p.path.indexOf("[")>0)throw new Error(`[${o}] Field config paths do not support arrays: ${p.id}`);return l}function r(u,o){return!!o.find(l=>u.category&&l.category&&u.category[0]===l.category[0])}},39796:(te,R,e)=>{"use strict";e.d(R,{M:()=>n});const n=s=>{for(let i=0;;i++){const r=a(i);if(!s.some(u=>u.refId===r))return r}};function a(s){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZ";return s<i.length?i[s]:a(Math.floor(s/i.length)-1)+i[s%i.length]}},15083:(te,R,e)=>{"use strict";e.d(R,{F:()=>s,c:()=>a});var n=e(51388);function a(i,r){let[u]=i,[o]=r,l=u.length,g=u[0],f=u[l-1],p=o.length,c=o[0],x=o[p-1],v;if(l)if(p){if(c>f)v=i.map((m,y)=>i[y].concat(r[y]));else if(x<g)v=r.map((m,y)=>r[y].concat(i[y]));else if(c<=g&&x>=f)v=r;else if(c>g&&x<f){let m=(0,n.Ls)(c,u);m=u[m]<c?m+1:m;let y=(0,n.Ls)(x,u);y=u[y]>x?y-1:y,v=i.map((h,d)=>i[d].slice(0,m).concat(r[d]).concat(i[d].slice(y+1)))}else if(c>=g){let m=(0,n.Ls)(c,u);m=u[m]<c?m-1:m,v=i.map((y,h)=>i[h].slice(0,m).concat(r[h]))}else if(x>=g){let m=(0,n.Ls)(x,u);m=u[m]<x?m:m+1,v=r.map((y,h)=>r[h].concat(i[h].slice(m)))}}else v=i;else p?v=r:v=[[]];return v}function s(i,r,u){let[o,...l]=i,g,f;return o[0]<r&&(g=(0,n.Ls)(r,o),o[g]<r&&g++),o[o.length-1]>u&&(f=(0,n.Ls)(u,o),o[f]>u&&f--),(g!=null||f!=null)&&(o=o.slice(g??0,f),l=l.map(p=>p.slice(g??0,f))),[o,...l]}},67458:(te,R,e)=>{"use strict";e.d(R,{G:()=>u,P:()=>o});var n=e(60023),a=e(33836),s=e(63704);let i=!1;const r={pedantic:!1,gfm:!0,breaks:!1};function u(l,g){i||(n.xI.use((0,a.z)()),n.xI.setOptions({...r}),i=!0);let f;g?.breaks&&(f={...r,breaks:!0});const p=(0,n.xI)(l||"",f);if(typeof p!="string")throw new Error("Failed to process markdown synchronously.");return g?.noSanitize?p:(0,s.G$)(p)}function o(l,g){i||(n.xI.use((0,a.z)()),n.xI.setOptions({...r}),i=!0);const f=(0,n.xI)(l||"");if(typeof f!="string")throw new Error("Failed to process markdown synchronously.");return g?.noSanitize?f:(0,s.G$)(f)}},38388:(te,R,e)=>{"use strict";e.d(R,{Oq:()=>n,bQ:()=>u,bs:()=>s});function n({searchWords:o,textToHighlight:l}){const g=[];for(const f of o)typeof f=="string"&&g.push(...s(l,f));return g}const a=o=>o.replace(/[[{(][\w,.\/:;<=>?:*+]+$/,"");function s(o,l){if(!o||!l)return[];const g=[],{cleaned:f,flags:p}=u(a(l));let c;try{c=new RegExp(`(?:${f})`,p)}catch{return g}return o.replace(c,(x,...v)=>{if(x){const m=v[v.length-2];g.push({text:x,start:m,length:x.length,end:m+x.length})}return""}),g}const i="-",r=/\(\?([ims-]+)\)/g;function u(o){const l=new Set(["g"]);return{cleaned:o.replace(r,(f,p)=>{const c=p.startsWith(i);for(let x=0;x<p.length;++x){const v=p.charAt(x);c||p.charAt(x-1)===i?l.delete(v):v!==i&&l.add(v)}return""}),flags:Array.from(l).join("")}}},46644:(te,R,e)=>{"use strict";e.d(R,{AH:()=>o,AS:()=>f,C6:()=>c,Em:()=>l,H3:()=>x,Nw:()=>g,gy:()=>u});var n=e(2543),a=e.n(n),s=e(28105),i=e(95004),r=e(42954),u=(P=>(P.sum="sum",P.max="max",P.min="min",P.logmin="logmin",P.mean="mean",P.variance="variance",P.stdDev="stdDev",P.last="last",P.median="median",P.first="first",P.count="count",P.range="range",P.diff="diff",P.diffperc="diffperc",P.delta="delta",P.step="step",P.firstNotNull="firstNotNull",P.lastNotNull="lastNotNull",P.changeCount="changeCount",P.distinctCount="distinctCount",P.allIsZero="allIsZero",P.allIsNull="allIsNull",P.allValues="allValues",P.uniqueValues="uniqueValues",P.p1="p1",P.p2="p2",P.p3="p3",P.p4="p4",P.p5="p5",P.p6="p6",P.p7="p7",P.p8="p8",P.p9="p9",P.p10="p10",P.p11="p11",P.p12="p12",P.p13="p13",P.p14="p14",P.p15="p15",P.p16="p16",P.p17="p17",P.p18="p18",P.p19="p19",P.p20="p20",P.p21="p21",P.p22="p22",P.p23="p23",P.p24="p24",P.p25="p25",P.p26="p26",P.p27="p27",P.p28="p28",P.p29="p29",P.p30="p30",P.p31="p31",P.p32="p32",P.p33="p33",P.p34="p34",P.p35="p35",P.p36="p36",P.p37="p37",P.p38="p38",P.p39="p39",P.p40="p40",P.p41="p41",P.p42="p42",P.p43="p43",P.p44="p44",P.p45="p45",P.p46="p46",P.p47="p47",P.p48="p48",P.p49="p49",P.p50="p50",P.p51="p51",P.p52="p52",P.p53="p53",P.p54="p54",P.p55="p55",P.p56="p56",P.p57="p57",P.p58="p58",P.p59="p59",P.p60="p60",P.p61="p61",P.p62="p62",P.p63="p63",P.p64="p64",P.p65="p65",P.p66="p66",P.p67="p67",P.p68="p68",P.p69="p69",P.p70="p70",P.p71="p71",P.p72="p72",P.p73="p73",P.p74="p74",P.p75="p75",P.p76="p76",P.p77="p77",P.p78="p78",P.p79="p79",P.p80="p80",P.p81="p81",P.p82="p82",P.p83="p83",P.p84="p84",P.p85="p85",P.p86="p86",P.p87="p87",P.p88="p88",P.p89="p89",P.p90="p90",P.p91="p91",P.p92="p92",P.p93="p93",P.p94="p94",P.p95="p95",P.p96="p96",P.p97="p97",P.p98="p98",P.p99="p99",P))(u||{});function o(P,M){return P==="count"||P==="distinctCount"||P==="changeCount"?i.PU.number:P==="allIsNull"||P==="allIsZero"?i.PU.boolean:M}function l(P){return Object.keys(u).includes(P)}function g(P){const{field:M,reducers:O}=P;if(!M||!O||O.length<1)return{};if(M.state?.calcs){const K=[];for(const T of O)M.state.calcs.hasOwnProperty(T)||K.push(T);if(K.length<1)return{...M.state.calcs}}M.state||(M.state={});const j=f.list(O),U=M.values;if(U&&U.length<1){const K={...M.state.calcs};for(const T of j)K[T.id]=T.emptyInputResult!==null?T.emptyInputResult:null;return M.state.calcs=K}const{nullValueMode:W=s.UW.Ignore}=M.config,B=W===s.UW.Ignore,S=W===s.UW.AsZero;if(j.length===1&&j[0].reduce){const K=j[0].reduce(M,B,S);return M.state.calcs={...M.state.calcs,...K},K}let _=x(M,B,S);for(const K of j)!_.hasOwnProperty(K.id)&&K.reduce&&(_={..._,...K.reduce(M,B,S)});return M.state.calcs={...M.state.calcs,..._},_}const f=new r.O(()=>[{id:"lastNotNull",name:"Last *",description:"Last non-null value (also excludes NaNs)",standard:!0,aliasIds:["current"],reduce:h,preservesUnits:!0},{id:"last",name:"Last",description:"Last value",standard:!0,reduce:y,preservesUnits:!0},{id:"firstNotNull",name:"First *",description:"First non-null value (also excludes NaNs)",standard:!0,reduce:m,preservesUnits:!0},{id:"first",name:"First",description:"First Value",standard:!0,reduce:v,preservesUnits:!0},{id:"min",name:"Min",description:"Minimum Value",standard:!0,preservesUnits:!0},{id:"max",name:"Max",description:"Maximum Value",standard:!0,preservesUnits:!0},{id:"mean",name:"Mean",description:"Average Value",standard:!0,aliasIds:["avg"],preservesUnits:!0},{id:"median",name:"Median",description:"Median Value",standard:!1,reduce:C,aliasIds:["median"],preservesUnits:!0},{id:"variance",name:"Variance",description:"Variance of all values in a field",standard:!1,reduce:d,preservesUnits:!0},{id:"stdDev",name:"StdDev",description:"Standard deviation of all values in a field",standard:!1,reduce:d,preservesUnits:!0},{id:"sum",name:"Total",description:"The sum of all values",emptyInputResult:0,standard:!0,aliasIds:["total"],preservesUnits:!0},{id:"count",name:"Count",description:"Number of values in response",emptyInputResult:0,standard:!0,preservesUnits:!1},{id:"range",name:"Range",description:"Difference between minimum and maximum values",standard:!0,preservesUnits:!0},{id:"delta",name:"Delta",description:"Cumulative change in value",standard:!0,preservesUnits:!0},{id:"step",name:"Step",description:"Minimum interval between values",standard:!0,preservesUnits:!0},{id:"diff",name:"Difference",description:"Difference between first and last values",standard:!0,preservesUnits:!0},{id:"logmin",name:"Min (above zero)",description:"Used for log min scale",standard:!0,preservesUnits:!0},{id:"allIsZero",name:"All Zeros",description:"All values are zero",emptyInputResult:!1,standard:!0,preservesUnits:!0},{id:"allIsNull",name:"All Nulls",description:"All values are null",emptyInputResult:!0,standard:!0,preservesUnits:!1},{id:"changeCount",name:"Change Count",description:"Number of times the value changes",standard:!1,reduce:E,preservesUnits:!1},{id:"distinctCount",name:"Distinct Count",description:"Number of distinct values",standard:!1,reduce:b,preservesUnits:!1},{id:"diffperc",name:"Difference percent",description:"Percentage difference between first and last values",standard:!0,preservesUnits:!1},{id:"allValues",name:"All values",description:"Returns an array with all values",standard:!1,reduce:P=>({allValues:[...P.values]}),preservesUnits:!1},{id:"uniqueValues",name:"All unique values",description:"Returns an array with all unique values",standard:!1,reduce:P=>({uniqueValues:[...new Set(P.values)]}),preservesUnits:!1},...p()]),p=(P=[...Array.from({length:99},(M,O)=>O+1)])=>{const M=[],O=j=>j>3&&j<21?"th":j%10===1?"st":j%10===2?"nd":j%10===3?"rd":"th";return P.forEach(j=>{const U=j/100,W=`p${j}`,B=`${j}${O(j)} %`,S=`${j}${O(j)} percentile value`;M.push({id:W,name:B,description:S,standard:!1,reduce:(_,K,T)=>({[W]:D(_,U,K,T)}),preservesUnits:!0})}),M},c={sum:0,max:-Number.MAX_VALUE,min:Number.MAX_VALUE,logmin:Number.MAX_VALUE,mean:null,last:null,first:null,lastNotNull:null,firstNotNull:null,count:0,nonNullCount:0,allIsNull:!0,allIsZero:!0,range:null,diff:null,delta:0,step:Number.MAX_VALUE,diffperc:0,previousDeltaUp:!0};function x(P,M,O){const j={...c},U=P.values;if(!U)return j;const W=P.type===i.PU.number||P.type===i.PU.time;for(let B=0;B<U.length;B++){let S=U[B];if(B===0&&(j.first=S),j.last=S,S==null){if(M)continue;O&&(S=0)}if(j.count++,S!=null&&!Number.isNaN(S)){const _=j.firstNotNull===null;if(_&&(j.firstNotNull=S),W){if(j.sum+=S,j.allIsNull=!1,j.nonNullCount++,!_){const K=S-j.lastNotNull;j.step>K&&(j.step=K),j.lastNotNull>S?j.previousDeltaUp=!1:(j.previousDeltaUp&&(j.delta+=K),j.previousDeltaUp=!0)}S>j.max&&(j.max=S),S<j.min&&(j.min=S),S<j.logmin&&S>0&&(j.logmin=S)}S!==0&&(j.allIsZero=!1),j.lastNotNull=S}}return j.max===-Number.MAX_VALUE&&(j.max=null),j.min===Number.MAX_VALUE&&(j.min=null),j.step===Number.MAX_VALUE&&(j.step=null),j.nonNullCount>0&&(j.mean=j.sum/j.nonNullCount),j.allIsNull&&(j.allIsZero=!1),j.max!==null&&j.min!==null&&(j.range=j.max-j.min),(0,n.isNumber)(j.firstNotNull)&&(0,n.isNumber)(j.lastNotNull)&&(j.diff=j.lastNotNull-j.firstNotNull),(0,n.isNumber)(j.firstNotNull)&&(0,n.isNumber)(j.diff)&&(j.diffperc=j.diff/j.firstNotNull*100),j}function v(P,M,O){return{first:P.values[0]}}function m(P,M,O){const j=P.values;for(let U=0;U<j.length;U++){const W=j[U];if(W!=null&&!Number.isNaN(W))return{firstNotNull:W}}return{firstNotNull:null}}function y(P,M,O){const j=P.values;return{last:j[j.length-1]}}function h(P,M,O){const j=P.values;let U=j.length-1;for(;U>=0;){const W=j[U--];if(W!=null&&!Number.isNaN(W))return{lastNotNull:W}}return{lastNotNull:null}}function d(P,M,O){if(!(P.type===i.PU.number||P.type===i.PU.time))return{variance:0,stdDev:0};let j=0,U=0,W=0;const B=P.values;for(let S=0;S<B.length;S++){const _=B[S];if(_!=null){W++;let K=U;U+=(_-K)/W,j+=(_-K)*(_-U)}}if(W>0){const S=j/W;return{variance:S,stdDev:Math.sqrt(S)}}return{variance:0,stdDev:0}}function E(P,M,O){const j=P.values;let U=0,W=!0,B=null;for(let S=0;S<j.length;S++){let _=j[S];if(_===null){if(M)continue;O&&(_=0)}!W&&B!==_&&U++,W=!1,B=_}return{changeCount:U}}function b(P,M,O){const j=P.values,U=new Set;for(let W=0;W<j.length;W++){let B=j[W];if(B===null){if(M)continue;O&&(B=0)}U.add(B)}return{distinctCount:U.size}}function D(P,M,O,j){let U=P.values;O&&(U=U.filter(S=>S!==null)),j&&(U=U.map(S=>S===null?0:S));const W=U.slice().sort((S,_)=>S-_),B=Math.round((W.length-1)*M);return W[B]}function C(P,M,O){const j=[];for(let W=0;W<P.values.length;W++){let B=P.values[W];if(B==null){if(M)continue;O&&(B=0)}j.push(B)}j.sort((W,B)=>W-B);const U=Math.floor(j.length/2);return j.length%2===0?{median:(j[U-1]+j[U])/2}:{median:j[U]}}},36638:(te,R,e)=>{"use strict";e.d(R,{sJ:()=>H,RE:()=>Q,NS:()=>Y,Dq:()=>X,kK:()=>I,hI:()=>Z});var n=e(42954),a=e(95004),s=e(57866);const i={id:s.Ct.byType,name:"Field Type",description:"match based on the field type",defaultOptions:a.PU.number,get:J=>(ee,q,ne)=>J===ee.type,getOptionsDisplayText:J=>`Field type: ${J}`},r={id:s.Ct.byTypes,name:"Field Type",description:"match based on the field types",defaultOptions:new Set,get:J=>(ee,q,ne)=>J.has(ee.type),getOptionsDisplayText:J=>`Field types: ${[...J].join(" | ")}`},u={id:s.Ct.numeric,name:"Numeric Fields",description:"Fields with type number",get:()=>i.get(a.PU.number),getOptionsDisplayText:()=>"Numeric Fields"},o={id:s.Ct.time,name:"Time Fields",description:"Fields with type time",get:()=>i.get(a.PU.time),getOptionsDisplayText:()=>"Time Fields"};function l(){return[i,r,u,o]}var g=e(739),f=e(46644),p=e(53685);function c(J){return J===f.gy.allIsNull||J===f.gy.allIsZero}const x={id:s.Ct.byValue,name:"By value (reducer)",description:"Reduce a field to a single value and test for inclusion",defaultOptions:{reducer:f.gy.allIsZero,op:g.zT.GTE,value:0},get:J=>{if(!J||!J.reducer)return()=>!1;let{reducer:ee,op:q,value:ne}=J;const se=c(ee);return q||(q=g.zT.EQ),(oe,de,fe)=>{const ae=(0,f.Nw)({field:oe,reducers:[ee]})[ee];return se?!!ae:(0,p.c)(ae,q,ne)}},getOptionsDisplayText:J=>`By value (${J.reducer})`};var v=e(4575),m=e(6844),y=e(8934);const h={id:s.jR.byRefId,name:"Query refId",description:"match the refId",defaultOptions:"A",get:J=>{let ee=null;if((0,y.AP)(J))try{ee=(0,y.dO)(J)}catch(q){q instanceof Error&&console.warn(q.message)}else if(J.includes("|")){const q=J.split("|").map(y.jD).join("|");ee=new RegExp(`^(?:${q})$`)}return q=>ee?.test(q.refId||"")??q.refId===J},getOptionsDisplayText:J=>`RefID: ${J}`};function d(){return[h]}const E={id:s.Ct.first,name:"First Field",description:"The first field in the frame",get:J=>(ee,q,ne)=>ee===q.fields[0],getOptionsDisplayText:()=>"First field"},b={id:s.Ct.firstTimeField,name:"First time field",description:"The first field of type time in a frame",get:J=>(ee,q,ne)=>ee.type===a.PU.time&&ee===q.fields.find(se=>se.type===a.PU.time),getOptionsDisplayText:()=>"First time field"};function D(){return[E,b]}const C={id:s.Js.equal,name:"Is equal",description:"Match where value for given field is equal to options value.",get:J=>(ee,q)=>q.values[ee]==J.value,getOptionsDisplayText:()=>"Matches all rows where field is null.",isApplicable:()=>!0,getDefaultOptions:()=>({value:""})},P={id:s.Js.notEqual,name:"Is not equal",description:"Match where value for given field is not equal to options value.",get:J=>(ee,q)=>q.values[ee]!=J.value,getOptionsDisplayText:()=>"Matches all rows where field is not null.",isApplicable:()=>!0,getDefaultOptions:()=>({value:""})},M=()=>[C,P],O={id:s.Js.isNull,name:"Is null",description:"Match where value for given field is null.",get:()=>(J,ee)=>ee.values[J]==null,getOptionsDisplayText:()=>"Matches all rows where field is null.",isApplicable:()=>!0,getDefaultOptions:()=>({})},j={id:s.Js.isNotNull,name:"Is not null",description:"Match where value for given field is not null.",get:()=>(J,ee)=>ee.values[J]!=null,getOptionsDisplayText:()=>"Matches all rows where field is not null.",isApplicable:()=>!0,getDefaultOptions:()=>({})},U=()=>[O,j],W={id:s.Js.greater,name:"Is greater",description:"Match when field value is greater than option.",get:J=>(ee,q)=>{const ne=q.values[ee];return isNaN(ne)?!1:ne>J.value},getOptionsDisplayText:J=>`Matches all rows where field value is greater than: ${J.value}.`,isApplicable:J=>J.type===a.PU.number,getDefaultOptions:()=>({value:0})},B={id:s.Js.greaterOrEqual,name:"Is greater or equal",description:"Match when field value is greater than or equal to option.",get:J=>(ee,q)=>{const ne=q.values[ee];return isNaN(ne)?!1:ne>=J.value},getOptionsDisplayText:J=>`Matches all rows where field value is greater than or equal to: ${J.value}.`,isApplicable:J=>J.type===a.PU.number,getDefaultOptions:()=>({value:0})},S={id:s.Js.lower,name:"Is lower",description:"Match when field value is lower than option.",get:J=>(ee,q)=>{const ne=q.values[ee];return isNaN(ne)?!1:ne<J.value},getOptionsDisplayText:J=>`Matches all rows where field value is lower than: ${J.value}.`,isApplicable:J=>J.type===a.PU.number,getDefaultOptions:()=>({value:0})},_={id:s.Js.lowerOrEqual,name:"Is lower or equal",description:"Match when field value is lower or equal than option.",get:J=>(ee,q)=>{const ne=q.values[ee];return isNaN(ne)?!1:ne<=J.value},getOptionsDisplayText:J=>`Matches all rows where field value is lower or equal than: ${J.value}.`,isApplicable:J=>J.type===a.PU.number,getDefaultOptions:()=>({value:0})},K=()=>[W,B,S,_],T={id:s.Js.between,name:"Is between",description:"Match when field value is between given option values.",get:J=>(ee,q)=>{const ne=q.values[ee];if(isNaN(ne))return!1;const se=typeof J.from!="number"?parseInt(J.from,10):J.from,oe=typeof J.to!="number"?parseInt(J.to,10):J.to;return ne>se&&ne<oe},getOptionsDisplayText:J=>`Matches all rows where field value is between ${J.from} and ${J.to}.`,isApplicable:J=>J.type===a.PU.number||J.type===a.PU.time,getDefaultOptions:J=>J.type===a.PU.time?{from:"$__from",to:"$__to"}:{from:0,to:100}},L=()=>[T],A={id:s.Js.regex,name:"Regex",description:"Match when field value is matching regex.",get:J=>{const ee=new RegExp(J.value);return(q,ne)=>{const se=ne.values[q];return ee.test(se)}},getOptionsDisplayText:J=>`Matches all rows where field value is matching regex: ${J.value}`,isApplicable:()=>!0,getDefaultOptions:()=>({value:".*"})},N=()=>[A],V={id:s.Js.substring,name:"Contains substring",description:"Match where value for given field is a substring to options value.",get:J=>(ee,q)=>{const ne=q.values[ee];return ne&&J.value&&typeof ne=="string"&&ne.toLowerCase().includes(J.value.toLowerCase())||J.value===""},getOptionsDisplayText:()=>"Matches all rows where field is similar to the value.",isApplicable:J=>J.type===a.PU.string,getDefaultOptions:()=>({value:""})},z={id:s.Js.notSubstring,name:"Does not contain substring",description:"Match where value for given field is not a substring to options value.",get:J=>(ee,q)=>{const ne=q.values[ee];return typeof ne=="string"&&J.value&&ne&&J.value!==""&&!ne.toLowerCase().includes(J.value.toLowerCase())},getOptionsDisplayText:()=>"Matches all rows where field is not similar to the value.",isApplicable:J=>J.type===a.PU.string,getDefaultOptions:()=>({value:""})},w=()=>[V,z],H=new n.O(()=>[...(0,m.nz)(),...l(),...(0,v.P7)(),...D(),x]),Q=new n.O(()=>[...(0,m.UM)(),...(0,v.Y7)(),...d()]),Z=new n.O(()=>[...U(),...K(),...M(),...w(),...L(),...N()]);function Y(J){const ee=H.get(J.id);if(!ee)throw new Error("Unknown field matcher: "+J.id);return ee.get(J.options)}function X(J){const ee=Q.get(J.id);if(!ee)throw new Error("Unknown frame matcher: "+J.id);return ee.get(J.options)}function I(J){const ee=Z.get(J.id);if(!ee)throw new Error("Unknown value matcher: "+J.id);return ee.get(J.options)}},53685:(te,R,e)=>{"use strict";e.d(R,{c:()=>a});var n=e(739);function a(s,i,r){switch((s==null||r==null)&&(s==null&&(s="null"),r==null&&(r="null"),(i===n.zT.GTE||i===n.zT.LTE)&&(i=n.zT.EQ)),i){case n.zT.EQ:return`${s}`==`${r}`;case n.zT.NEQ:return`${s}`!=`${r}`;case n.zT.GT:return s>r;case n.zT.GTE:return s>=r;case n.zT.LT:return s<r;case n.zT.LTE:return s<=r;default:return!1}}},57866:(te,R,e)=>{"use strict";e.d(R,{Ct:()=>a,Js:()=>i,cV:()=>n,jR:()=>s});var n=(r=>(r.anyMatch="anyMatch",r.allMatch="allMatch",r.invertMatch="invertMatch",r.alwaysMatch="alwaysMatch",r.neverMatch="neverMatch",r))(n||{}),a=(r=>(r.numeric="numeric",r.time="time",r.first="first",r.firstTimeField="firstTimeField",r.byType="byType",r.byTypes="byTypes",r.byName="byName",r.byNames="byNames",r.byRegexp="byRegexp",r.byRegexpOrNames="byRegexpOrNames",r.byFrameRefID="byFrameRefID",r.byValue="byValue",r))(a||{}),s=(r=>(r.byName="byName",r.byRefId="byRefId",r.byIndex="byIndex",r))(s||{}),i=(r=>(r.regex="regex",r.isNull="isNull",r.isNotNull="isNotNull",r.greater="greater",r.greaterOrEqual="greaterOrEqual",r.lower="lower",r.lowerOrEqual="lowerOrEqual",r.equal="equal",r.notEqual="notEqual",r.substring="substring",r.notSubstring="notSubstring",r.between="between",r))(i||{})},4575:(te,R,e)=>{"use strict";e.d(R,{P7:()=>v,PP:()=>r,Y7:()=>m});var n=e(16515),a=e(8934),s=e(95004),i=e(57866),r=(y=>(y.exclude="exclude",y.include="include",y))(r||{});const u={id:i.Ct.byName,name:"Field Name",description:"match the field name",defaultOptions:"",get:y=>{const d=l(new Set([y]));return(E,b,D)=>y===E.name||y===(0,n.Ct)(E,b,D)||!!(d&&d(E,b,D))},getOptionsDisplayText:y=>`Field name: ${y}`},o={id:i.Ct.byNames,name:"Field Names",description:"match any of the given the field names",defaultOptions:{mode:"include",names:[]},get:y=>{const{names:h,mode:d="include"}=y,E=new Set(h??[]),b=l(E),D=(C,P,M)=>E.has(C.name)||E.has((0,n.Ct)(C,P,M))||!!(b&&b(C,P,M));return d==="exclude"?(C,P,M)=>!D(C,P,M):D},getOptionsDisplayText:y=>{const{names:h,mode:d}=y,E=(h??[]).join(", ");return d==="exclude"?`All except: ${E}`:`All of: ${E}`}};function l(y){let h;return window?.grafanaBootData?.settings?.featureToggles?.dataplaneFrontendFallback&&(y.has(s.Bc)?h=(E,b)=>!!E.labels&&E.labels?.__name__===E.name:(y.has("Time")||y.has("time"))&&(h=(E,b)=>b.meta?.typeVersion==null&&E.type===s.PU.time)),h}const g={id:i.Ct.byRegexp,name:"Field Name by Regexp",description:"match the field name by a given regexp pattern",defaultOptions:"/.*/",get:y=>{const h=c(y);return(d,E,b)=>{const D=(0,n.Ct)(d,E,b);return!!h&&h.test(D)}},getOptionsDisplayText:y=>`Field name by pattern: ${y}`},f={id:i.Ct.byFrameRefID,name:"Fields by frame refId",description:"match all fields returned in data frame with refId.",defaultOptions:"",get:y=>(h,d,E)=>d.refId===y,getOptionsDisplayText:y=>`Math all fields returned by query with reference ID: ${y}`},p={id:i.Ct.byRegexpOrNames,name:"Field Name by Regexp or Names",description:"match the field name by a given regexp pattern or given names",defaultOptions:{pattern:"/.*/",names:[]},get:y=>{const h=g.get(y?.pattern||""),d=o.get({mode:"include",names:y?.names??[]});return(E,b,D)=>d(E,b,D)||h(E,b,D)},getOptionsDisplayText:y=>{const h=y?.pattern??"",d=y?.names?.join(",")??"";return`Field name by pattern: ${h} or names: ${d}`}},c=y=>{if(y)try{return(0,a.dO)(y)}catch(h){console.error(h);return}},x={id:i.jR.byName,name:"Frame Name",description:"match the frame name",defaultOptions:"/.*/",get:y=>{const h=(0,a.dO)(y);return d=>h.test(d.name||"")},getOptionsDisplayText:y=>`Frame name: ${y}`};function v(){return[u,g,o,p,f]}function m(){return[x]}},6844:(te,R,e)=>{"use strict";e.d(R,{UM:()=>b,Yg:()=>f,nz:()=>E,zx:()=>x});var n=e(95004),a=e(36638),s=e(57866);const i={id:s.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:D=>{const C=D.map(P=>(0,a.NS)(P));return(P,M,O)=>{for(const j of C)if(j(P,M,O))return!0;return!1}},getOptionsDisplayText:D=>{let C="";for(const P of D){C.length>0&&(C+=" OR ");const M=a.sJ.get(P.id);C+=M.getOptionsDisplayText?M.getOptionsDisplayText(P):M.name}return C}},r={id:s.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:D=>{const C=D.map(P=>(0,a.Dq)(P));return P=>{for(const M of C)if(M(P))return!0;return!1}},getOptionsDisplayText:D=>{let C="";for(const P of D){C.length>0&&(C+=" OR ");const M=a.RE.get(P.id);C+=M.getOptionsDisplayText?M.getOptionsDisplayText(P):M.name}return C}},u={id:s.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:D=>{const C=D.map(P=>(0,a.NS)(P));return(P,M,O)=>{for(const j of C)if(!j(P,M,O))return!1;return!0}},getOptionsDisplayText:D=>{let C="";for(const P of D){C.length>0&&(C+=" AND ");const M=a.sJ.get(P.id);C+=M.getOptionsDisplayText?M.getOptionsDisplayText(P):M.name}return C}},o={id:s.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:D=>{const C=D.map(P=>(0,a.Dq)(P));return P=>{for(const M of C)if(!M(P))return!1;return!0}},getOptionsDisplayText:D=>{let C="";for(const P of D){C.length>0&&(C+=" AND ");const M=a.RE.get(P.id);C+=M.getOptionsDisplayText?M.getOptionsDisplayText(P):M.name}return C}},l={id:s.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:D=>{const C=(0,a.NS)(D);return(P,M,O)=>!C(P,M,O)},getOptionsDisplayText:D=>{const C=a.sJ.get(D.id);return"NOT "+(C.getOptionsDisplayText?C.getOptionsDisplayText(D.options):C.name)}},g={id:s.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:D=>{const C=(0,a.Dq)(D);return P=>!C(P)},getOptionsDisplayText:D=>{const C=a.RE.get(D.id);return"NOT "+(C.getOptionsDisplayText?C.getOptionsDisplayText(D.options):C.name)}},f=D=>!0,p=D=>!0,c=D=>!1,x=D=>D.type!==n.PU.time,v=D=>!1,m={id:s.cV.alwaysMatch,name:"All Fields",description:"Always Match",get:D=>f,getOptionsDisplayText:D=>"Always"},y={id:s.cV.alwaysMatch,name:"All Frames",description:"Always Match",get:D=>p,getOptionsDisplayText:D=>"Always"},h={id:s.cV.neverMatch,name:"No Fields",description:"Never Match",excludeFromPicker:!0,get:D=>c,getOptionsDisplayText:D=>"Never"},d={id:s.cV.neverMatch,name:"No Frames",description:"Never Match",get:D=>v,getOptionsDisplayText:D=>"Never"};function E(){return[i,u,l,m,h]}function b(){return[r,o,g,y,d]}},8642:(te,R,e)=>{"use strict";e.d(R,{h:()=>s,m:()=>a});var n=e(42954),a=(i=>(i.Combine="combine",i.CalculateNewFields="calculateNewFields",i.CreateNewVisualization="createNewVisualization",i.Filter="filter",i.PerformSpatialOperations="performSpatialOperations",i.Reformat="reformat",i.ReorderAndRename="reorderAndRename",i))(a||{});const s=new n.O},2197:(te,R,e)=>{"use strict";e.d(R,{m:()=>p});var n=e(2543),a=e.n(n),s=e(62467),i=e(69862),r=e(81160),u=e(36638),o=e(8642);const l=(v,m)=>y=>{const h=o.h.get(v.id);if(!h)return y;const E={...h.transformation.defaultOptions??{},...v.options},D=window.__grafanaSceneContext!=null?E:x((0,n.cloneDeep)(E),P=>typeof P=="string"?m.interpolate(P):P),C=v.filter?.options?(0,u.Dq)(v.filter):void 0;return y.pipe((0,i.Z)(P=>(0,s.of)(g(P,C)).pipe(h.transformation.operator(D,m),f(P,h,C))))};function g(v,m){return m?v.filter(y=>m(y)):v}const f=(v,m,y)=>h=>h.pipe((0,r.T)(d=>{if(d===v)return d;if(y){let E=0;const b=v.filter((D,C)=>{const P=!y(D);return P&&!E&&(E=C),P});b.length&&d.splice(E,0,...b)}return d}));function p(v,m,y){const h=(0,s.of)(m);if(!v.length)return h;const d=[],E=y??{interpolate:b=>b};for(let b=0;b<v.length;b++){const D=v[b];if(c(D))d.push(D(E));else{if(D.disabled)continue;d.push(l(D,E))}}return h.pipe.apply(h,d)}function c(v){return typeof v=="function"}function x(v,m){if(Array.isArray(v))return v.map(y=>x(y,m));if(typeof v=="object"){for(const y in v)v[y]=x(v[y],m);return v}else return m(v)??v}},96702:(te,R,e)=>{"use strict";e.d(R,{c:()=>Ee});var n=e(84691),a=e(9287),s=e(406),i=e(882),r=e(49297),u=e(359),o=e(57866),l=e(64761);const g={id:l.F.filterByRefId,name:"Filter data by query refId",description:"select a subset of results",defaultOptions:{},operator:(Re,Oe)=>Se=>{const Te={};return Re.include&&(Te.include={id:o.jR.byRefId,options:Re.include}),Re.exclude&&(Te.exclude={id:o.jR.byRefId,options:Re.exclude}),Se.pipe(r.I.operator(Te,Oe))}};var f=e(68779),p=e(40041),c=e(81160),x=e(16515),v=e(79319);const m={id:l.F.formatTime,name:"Format time",description:"Set the output format of a time field",defaultOptions:{timeField:"",outputFormat:"",useTimezone:!0},isApplicable:Re=>{for(const Oe of Re)for(const Se of Oe.fields)if(Se.type==="time")return v.M.Applicable;return v.M.NotApplicable},isApplicableDescription:"The Format time transformation requires a time field to work. No time field could be found.",operator:(Re,Oe)=>Se=>Se.pipe((0,c.T)(Te=>y(Re,Te,Oe)))},y=({timeField:Re,outputFormat:Oe,timezone:Se},Te,_e)=>!Array.isArray(Te)||Te.length===0?Te:((0,x.Fm)(Te),Oe=_e?.interpolate(Oe)??Oe,Te.map(He=>({...He,fields:He.fields.map(tt=>(tt.state?.displayName===Re&&(tt=(0,s.Xv)(tt,Oe,{timeZone:Se})),tt))})));var h=e(47433),d=e(25260),E=e(36638);const b="Time",D="Time",C="Value",P=v.N.Empty,M=window?.grafanaBootData?.settings?.featureToggles?.dataplaneFrontendFallback,O={id:l.F.groupingToMatrix,name:"Grouping to Matrix",description:"Groups series by field and return a matrix visualisation",defaultOptions:{columnField:b,rowField:D,valueField:C},isApplicable:Re=>{let Oe=0;for(const Se of Re)Oe+=Se.fields.length;return Oe>=3?v.M.Applicable:v.M.NotApplicable},isApplicableDescription:Re=>{let Oe=0;for(const Se of Re)Oe+=Se.fields.length;return`Grouping to matrix requires at least 3 fields to work. Currently there are ${Oe} fields.`},operator:(Re,Oe)=>Se=>Se.pipe((0,c.T)(Te=>{const _e=Re.columnField||b,He=Re.rowField||D,tt=Re.valueField||C,Je=Re.emptyValue||P;if(Te.length!==1)return Te;const Ge=Te[0],je=U(Ge,_e),Fe=U(Ge,He),Be=U(Ge,tt),Ke=`${He}\\${_e}`;if(!je||!Fe||!Be)return Te;const Ue=j(je.values),we=j(Fe.values),Xe={};for(let he=0;he<Be.values.length;he++){const xe=je.values[he],me=Fe.values[he],ye=Be.values[he];Xe[xe]||(Xe[xe]={}),Xe[xe][me]=ye}const nt=[{name:Ke,values:we,type:Fe.type,config:{}}];for(const he of Ue){let xe=[];for(const me of we){const ye=Xe[he][me]??W(Je);xe.push(ye)}M&&typeof he=="number"&&(Be.config={...Be.config,displayNameFromDS:void 0}),delete Be.config.displayName,nt.push({name:he?.toString()??null,values:xe,config:Be.config,type:Be.type})}return[{fields:nt,length:we.length}]}))};function j(Re){const Oe=new Set(Re);return Array.from(Oe)}function U(Re,Oe){for(let Se=0;Se<Re.fields.length;Se++){const Te=Re.fields[Se];let _e;if(M?_e=E.sJ.get(o.Ct.byName).get(Oe)(Te,Re,[Re]):_e=Oe===(0,x.Ct)(Te),_e)return Te}return null}function W(Re){switch(Re){case v.N.False:return!1;case v.N.True:return!0;case v.N.Null:return null;case v.N.Zero:return 0;case v.N.Empty:default:return""}}var B=e(74261),S=e(6684),_=e(79184);const K=10,T={id:l.F.limit,name:"Limit",description:"Limit the number of items to the top N",defaultOptions:{limitField:K},operator:(Re,Oe)=>Se=>Se.pipe((0,c.T)(Te=>{let _e=K;return Re.limitField!==void 0&&(typeof Re.limitField=="string"?_e=parseInt(Re.limitField,10):_e=Re.limitField),Te.map(He=>He.length>_e?{...He,fields:He.fields.map(tt=>({...tt,state:{...tt.state,calcs:void 0},values:_e>=0?tt.values.slice(0,_e):tt.values.slice(tt.values.length+_e,tt.values.length)})),length:Math.abs(_e)}:He)}))};var L=e(33023),A=e(1027),N=e(95575);const V={id:l.F.rename,name:"Rename fields by name",description:"Rename fields based on configuration given by user",defaultOptions:{renameByName:{}},operator:Re=>Oe=>Oe.pipe((0,c.T)(Se=>{const Te=z(Re.renameByName);return!Array.isArray(Se)||Se.length===0?Se:Se.map(_e=>({..._e,fields:Te(_e)}))}))},z=Re=>Oe=>!Re||Object.keys(Re).length===0?Oe.fields:Oe.fields.map(Se=>{const Te=(0,x.Ct)(Se,Oe),_e=Re[Te];return typeof _e!="string"||_e.length===0?Se:{...Se,config:{...Se.config,displayName:_e},state:{...Se.state,displayName:_e}}}),w={id:l.F.organize,name:"Organize fields by name",description:"Order, filter and rename fields based on configuration given by user",defaultOptions:{excludeByName:{},indexByName:{},renameByName:{},includeByName:{}},isApplicable:Re=>Re.length>1?v.M.NotPossible:v.M.Applicable,operator:(Re,Oe)=>Se=>Se.pipe(u.D.operator({include:Re.includeByName?{names:H(Re.includeByName)}:void 0,exclude:{names:H(Re.excludeByName)}},Oe),N.xQ.operator(Re,Oe),V.operator(Re,Oe))},H=Re=>Re?Object.keys(Re).filter(Oe=>Re[Oe]):[];var Q=e(32157),Z=e(8934);const Y={id:l.F.renameByRegex,name:"Rename fields by regex",description:"Rename fields based on regular expression by users.",defaultOptions:{regex:"(.*)",renamePattern:"$1"},operator:Re=>Oe=>Oe.pipe((0,c.T)(Se=>!Array.isArray(Se)||Se.length===0?Se:Se.map(X(Re))))},X=Re=>Oe=>{const Se=(0,Z.dO)(Re.regex),Te=Oe.fields.map(_e=>{const He=(0,x.Ct)(_e,Oe);if(!Se.test(He))return _e;const tt=He.replace(Se,Re.renamePattern);return{..._e,config:{..._e.config,displayName:tt},state:{..._e.state,displayName:tt}}});return{...Oe,fields:Te}};var I=e(2543),J=e(18700),ee=e(41119),q=e(17503),ne=e(95004);const se={id:l.F.seriesToRows,name:"Series to rows",description:"Combines multiple series into a single serie and appends a column with metric name per value.",defaultOptions:{},operator:Re=>Oe=>Oe.pipe((0,c.T)(Se=>{if(!Array.isArray(Se)||Se.length===0||(Se=Se.filter(Je=>Je.length>0),!(0,q.jq)(Se)))return Se;const Te={},_e=new Set,He=new J.k({refId:`${l.F.seriesToRows}-${Se.map(Je=>Je.refId).join("-")}`,fields:[]}),tt={name:ne.aI,values:[],config:{},type:ne.PU.string};for(let Je=0;Je<Se.length;Je++){const Ge=Se[Je];for(let je=0;je<Ge.fields.length;je++){const Fe=Ge.fields[je];if(Fe.type===ne.PU.time){Te[Je]=je,_e.has(ne.LE)||(He.addField(oe(Fe,ne.LE)),He.addField(tt),_e.add(ne.LE));continue}_e.has(ne.Bc)||(He.addField(oe(Fe,ne.Bc)),_e.add(ne.Bc))}}for(let Je=0;Je<Se.length;Je++){const Ge=Se[Je];for(let je=0;je<Ge.length;je++){const Fe=Te[Je],Be=Fe===0?1:0;He.add({[ne.LE]:Ge.fields[Fe].values[je],[ne.aI]:(0,x.Ri)(Ge),[ne.Bc]:Ge.fields[Be].values[je]})}}return[(0,ee.ES)(He,0,!0)]}))},oe=(Re,Oe)=>({...(0,I.omit)(Re,["values","state","labels","config","name"]),name:Oe,values:[],config:{...(0,I.omit)(Re.config,["displayName","displayNameFromDS"])}}),de={id:l.F.sortBy,name:"Sort by",description:"Sort fields in a frame.",defaultOptions:{fields:{}},operator:(Re,Oe)=>Se=>Se.pipe((0,c.T)(Te=>!Array.isArray(Te)||Te.length===0||!Re?.sort?.length?Te:fe(Te,Re.sort,Oe)))};function fe(Re,Oe,Se){return Re.map(Te=>{const _e=ae(Te,Oe,Se);return _e.length&&_e[0].index!=null?(0,ee.ES)(Te,_e[0].index,_e[0].desc):Te})}function ae(Re,Oe,Se){return Oe.map(Te=>Te.index!=null?Te:{...Te,index:Re.fields.findIndex(_e=>Te.field===(0,x.Ct)(_e,Re))})}const ce={id:l.F.transpose,name:"Transpose",description:"Transpose the data frame",defaultOptions:{},operator:Re=>Oe=>Oe.pipe((0,c.T)(Se=>Se.length===0?Se:ie(Re,Se)))};function ie(Re,Oe){return(0,x.Fm)(Oe),Oe.map(Se=>{const Te=Se.fields[0],_e=Re.firstFieldName?Re.firstFieldName:"Field",He=Re.restFieldsName?Re.restFieldsName:"Value",tt=Te.type===ne.PU.string||Te.type===ne.PU.time||Te.type===ne.PU.enum,Je=tt?[_e,...le(Te,Te.values)]:[_e,...Te.values.map((Be,Ke)=>He)],Ge=tt?Se.fields.map(Be=>Be.state?.displayName??Be.name).slice(1):Se.fields.map(Be=>Be.state?.displayName??Be.name),je=ve(tt?Se.fields.map(Be=>Be.type).slice(1):Se.fields.map(Be=>Be.type)),Fe=Je.map((Be,Ke)=>{if(Ke===0)return{name:_e,type:ne.PU.string,config:{},values:Ge};const Ue=Se.fields.map(nt=>je===ne.PU.string?le(nt,[nt.values[Ke-1]])[0]:nt.values[Ke-1]),we=tt?Te.name:"row",Xe=tt?Be:Ke;return{name:tt?He:Be,labels:{[we]:Xe},type:je,config:{},values:tt?Ue.slice(1):Ue}});return{...Se,fields:Fe,length:Math.max(...Fe.map(Be=>Be.values.length)),refId:`${l.F.transpose}-${Se.refId}`}})}function ve(Re){const Oe=new Set(Re);return Oe.size===1?[...Oe][0]:ne.PU.string}function le(Re,Oe){switch(Re.type){case ne.PU.time:case ne.PU.number:case ne.PU.boolean:case ne.PU.string:return Oe.map(Se=>`${Se}`);case ne.PU.enum:return Oe.map(Se=>Re.config.type.enum.text[Se]);default:return Oe.map(Se=>JSON.stringify(Se))}}const Ee={noopTransformer:A.W,filterFieldsTransformer:r.z,filterFieldsByNameTransformer:u.D,filterFramesTransformer:r.I,filterFramesByRefIdTransformer:g,filterByValueTransformer:f.Sv,formatStringTransformer:p.yt,formatTimeTransformer:m,orderFieldsTransformer:N.xQ,organizeFieldsTransformer:w,reduceTransformer:Q.Wj,concatenateTransformer:a.vz,calculateFieldTransformer:n.SC,joinByFieldTransformer:S.L,seriesToColumnsTransformer:S.L,seriesToRowsTransformer:se,renameFieldsTransformer:V,labelsToFieldsTransformer:_.V,ensureColumnsTransformer:i.b,groupByTransformer:h.of,sortByTransformer:de,mergeTransformer:L.o,renameByRegexTransformer:Y,histogramTransformer:B.OA,convertFieldTypeTransformer:s.zM,groupingToMatrixTransformer:O,limitTransformer:T,groupToNestedTable:d._,transposeTransformer:ce}},84691:(te,R,e)=>{"use strict";e.d(R,{Bp:()=>h,SC:()=>P,UY:()=>y,Uj:()=>b,ip:()=>d,pR:()=>T,sw:()=>A});var n=e(2543),a=e.n(n),s=e(81160),i=e(41119),r=e(16515),u=e(28105),o=e(95004),l=e(12823),g=e(48233),f=e(46644),p=e(36638),c=e(57866),x=e(882),v=e(64761),m=e(1027),y=(N=>(N.ReduceRow="reduceRow",N.CumulativeFunctions="cumulativeFunctions",N.WindowFunctions="windowFunctions",N.BinaryOperation="binary",N.UnaryOperation="unary",N.Index="index",N))(y||{}),h=(N=>(N.Percentage="percentage",N.Fixed="fixed",N))(h||{}),d=(N=>(N.Trailing="trailing",N.Centered="centered",N))(d||{});const E={reducer:f.gy.sum},b={reducer:f.gy.mean,windowAlignment:"trailing",windowSizeMode:"percentage",windowSize:.1},D={left:{fixed:""},operator:l.k.Add,right:{fixed:""}},C={operator:g._.Abs,fieldName:""},P={id:v.F.calculateField,name:"Add field from calculation",description:"Use the row values to calculate a new field",defaultOptions:{mode:"reduceRow",reduce:{reducer:f.gy.sum}},operator:(N,V)=>z=>{const w=N.mode??"reduceRow",H=N.timeSeries!==!1,Q=N.binary?.right,Z=typeof Q=="string"?Q:typeof Q=="object"?Q.fixed:void 0,Y=w==="binary"&&!Number.isNaN(Number(Z)),I=H&&!Y?x.b.operator(null,V):m.W.operator({},V);return z.pipe(I,(0,s.T)(J=>{let ee;switch(w){case"reduceRow":ee=S((0,n.defaults)(N.reduce,E),J);break;case"cumulativeFunctions":ee=B((0,n.defaults)(N.cumulative,E),J);break;case"windowFunctions":ee=M((0,n.defaults)(N.window,b),J);break;case"unary":ee=L((0,n.defaults)(N.unary,C),J);break;case"binary":const ne=[];J.map(oe=>{oe.fields.map(de=>{ne.push(de.name)})});const se={left:T(N.binary?.left??"",ne),operator:N.binary?.operator??D.operator,right:T(N.binary?.right??"",ne)};if(N.binary=se,se.left?.matcher?.id&&se.left?.matcher.id===c.Ct.byType){const oe=se.left.matcher.options,de=l.b.getIfExists(se.operator);return J.map(ae=>{const{timeField:ce}=(0,i.KR)(ae),ie=[];let ve=!1;if(ce&&N.timeSeries!==!1&&ie.push(ce),ae.fields.map((le,Ee)=>{if(!N.replaceFields&&!ie.includes(le)&&ie.push(le),le.type===oe){const Re=le.values,Oe=_(ae,se.right??D.right,J,V);if(!Re||!Oe||!de)return;const Se=new Array(Re.length);for(let _e=0;_e<Se.length;_e++)Se[_e]=de.operation(Re[_e],Oe[_e]);const Te={...le,name:`${le.name} ${N.binary?.operator??""} ${N.binary?.right.matcher?.options??N.binary?.right.fixed}`,values:Se};delete Te.state,ie.push(Te),ve=!0}}),!(N.replaceFields&&!ve))return{...ae,fields:ie}}).filter(ae=>ae!=null)}else ee=K((0,n.defaults)(se,D),J,V);break;case"index":return J.map(oe=>{const de=[...Array(oe.length).keys()];if(N.index?.asPercentile)for(let ae=0;ae<de.length;ae++)de[ae]=de[ae]/de.length;const fe={name:N.alias??"Row",type:o.PU.number,values:de,config:N.index?.asPercentile?{unit:"percentunit"}:{}};return{...oe,fields:N.replaceFields?[fe]:[...oe.fields,fe]}})}return ee?J.map(ne=>{const se=ee(ne);if(!se)return N.replaceFields?void 0:ne;const oe={name:A(N),type:o.PU.number,config:{},values:se};N.alias?.length&&(oe.config.displayName=N.alias);let de=[];if(N.replaceFields){const{timeField:fe}=(0,i.KR)(ne);fe&&N.timeSeries!==!1?de=[fe,oe]:de=[oe]}else de=[...ne.fields,oe];return{...ne,fields:de}}).filter(ne=>ne!=null):J}))}};function M(N,V){if(N.windowSize<=0)throw new Error("Add field from calculation transformation - Window size must be larger than 0");let z=(0,p.NS)({id:c.Ct.numeric});return N.field&&(z=(0,p.NS)({id:c.Ct.byNames,options:{names:[N.field]}})),w=>{const H=Math.ceil(N.windowSize*(N.windowSizeMode==="percentage"?w.length:1));let Q=null;for(const Z of w.fields)if(z(Z,w,V)){Q=Z;break}if(Q){if(![f.gy.mean,f.gy.stdDev,f.gy.variance].includes(N.reducer))throw new Error(`Add field from calculation transformation - Unsupported reducer: ${N.reducer}`);return N.windowAlignment==="centered"?j(w,N.reducer,Q,H):O(w,N.reducer,Q,H)}}}function O(N,V,z,w){const H=[];let Q=0,Z=0;for(let Y=0;Y<N.length;Y++)if(V===f.gy.mean){const X=z.values[Y];if(X!=null&&(Z++,Q+=X,Y>w-1)){const I=z.values[Y-w];I!=null&&(Q-=I,Z--)}H.push(Z===0?0:Q/Z)}else if(V===f.gy.variance){const X=Math.max(0,Y-w+1),I=Y+1;H.push(U(z.values.slice(X,I)))}else if(V===f.gy.stdDev){const X=Math.max(0,Y-w+1),I=Y+1;H.push(W(z.values.slice(X,I)))}return H}function j(N,V,z,w){const H=[];let Q=0,Z=0;const Y=Math.ceil(w/2)-1,X=Math.floor(w/2);for(let I=0;I<N.length;I++){const J=I-X,ee=I+Y;if(V===f.gy.mean){if(I===0)for(let q=0;q<Y+1&&q<z.values.length;q++)z.values[q]!=null&&(Q+=z.values[q],Z++);else ee<z.values.length&&z.values[ee]!=null&&(Q+=z.values[ee],Z++),J>0&&z.values[J-1]!=null&&(Q-=z.values[J-1],Z--);H.push(Z===0?0:Q/Z)}else if(V===f.gy.variance){const q=z.values.slice(Math.max(0,J),Math.min(ee+1,z.values.length));H.push(U(q))}else if(V===f.gy.stdDev){const q=z.values.slice(Math.max(0,J),Math.min(ee+1,z.values.length));H.push(W(q))}}return H}function U(N){if(N.length<1)return 0;let V=0,z=0,w=0;for(let Q=0;Q<N.length;Q++){const Z=N[Q];if(Z!=null){w++;let Y=z;z+=(Z-Y)/w,V+=(Z-Y)*(Z-z)}}return w===0?0:V/w}function W(N){return Math.sqrt(U(N))}function B(N,V){let z=(0,p.NS)({id:c.Ct.numeric});if(N.field&&(z=(0,p.NS)({id:c.Ct.byNames,options:{names:[N.field]}})),![f.gy.mean,f.gy.sum].includes(N.reducer))throw new Error(`Add field from calculation transformation - Unsupported reducer: ${N.reducer}`);return w=>{let H=null;for(const Y of w.fields)if(z(Y,w,V)){H=Y;break}if(!H)return;const Q=[];let Z=0;for(let Y=0;Y<w.length;Y++)Z+=H.values[Y]??0,N.reducer===f.gy.sum?Q.push(Z):N.reducer===f.gy.mean&&Q.push(Z/(Y+1));return Q}}function S(N,V){let z=(0,p.NS)({id:c.Ct.numeric});N.include&&N.include.length&&(z=(0,p.NS)({id:c.Ct.byNames,options:{names:N.include}}));const w=f.AS.get(N.reducer);if(!w)throw new Error(`Unknown reducer: ${N.reducer}`);const H=w.reduce??f.H3,Q=N.nullValueMode===u.UW.Ignore,Z=N.nullValueMode===u.UW.AsZero;return Y=>{const X=[];for(const q of Y.fields)z(q,Y,V)&&X.push(q.values);const I=X.length,J={name:"temp",values:new Array(I),type:o.PU.number,config:{}},ee=[];for(let q=0;q<Y.length;q++){for(let ne=0;ne<I;ne++)J.values[ne]=X[ne][q];ee.push(H(J,Q,Z)[N.reducer])}return ee}}function _(N,V,z,w){if(!V)return;if(V.matcher&&V.matcher.id===c.Ct.byName){const Q=V.matcher.options??"";for(const Z of N.fields)if(Q===(0,r.Ct)(Z,N,z))return Z.type===o.PU.boolean?Z.values.map(Y=>Y?1:0):Z.values}const H=parseFloat(V.fixed??V.matcher?.options??"");if(!isNaN(H))return new Array(N.length).fill(H)}function K(N,V,z){const w=l.b.getIfExists(N.operator);return H=>{const Q=_(H,N.left,V,z),Z=_(H,N.right,V,z);if(!Q||!Z||!w)return;const Y=new Array(Q.length);for(let X=0;X<Y.length;X++)Y[X]=w.operation(Q[X],Z[X]);return Y}}function T(N,V){return typeof N=="string"?isNaN(Number(N))?{matcher:{id:c.Ct.byName,options:N}}:V.includes(N)?{matcher:{id:c.Ct.byName,options:N}}:{fixed:N}:N}function L(N,V){const z=g.j.getIfExists(N.operator);return w=>{let H=[];for(const Y of w.fields)N.fieldName===(0,r.Ct)(Y,w,V)&&Y.type===o.PU.number&&(H=Y.values);if(!H.length||!z)return;const Q=new Array(H.length);let Z=0;if(N.operator===g._.Percent)for(let Y=0;Y<H.length;Y++)Number.isFinite(H[Y])&&(Z+=H[Y]);for(let Y=0;Y<Q.length;Y++)Q[Y]=z.operation(H[Y],Z);return Q}}function A(N){if(N.alias?.length)return N.alias;switch(N.mode){case"cumulativeFunctions":{const{cumulative:V}=N;return`cumulative ${V?.reducer??""}${V?.field?`(${V.field})`:""}`}case"windowFunctions":{const{window:V}=N;return`${V?.windowAlignment??""} moving ${V?.reducer??""}${V?.field?`(${V.field})`:""}`}case"unary":{const{unary:V}=N;return`${V?.operator??""}${V?.fieldName?`(${V.fieldName})`:""}`}case"binary":{const{binary:V}=N,z=`${V?.left?.matcher?.options??V?.left?.fixed??""} ${V?.operator??""} ${V?.right?.matcher?.options??V?.right?.fixed??""}`;return/\$/g.test(z)?"":z}case"reduceRow":{const V=f.AS.getIfExists(N.reduce?.reducer);if(V)return V.name}break;case"index":return"Row"}return"math"}},9287:(te,R,e)=>{"use strict";e.d(R,{vz:()=>r,x1:()=>i});var n=e(81160),a=e(95004),s=e(64761),i=(o=>(o.Drop="drop",o.FieldName="field",o.Label="label",o))(i||{});const r={id:s.F.concatenate,name:"Concatenate fields",description:"Combine all fields into a single frame.  Values will be appended with undefined values if not the same length.",defaultOptions:{frameNameMode:"field",frameNameLabel:"frame"},operator:o=>l=>l.pipe((0,n.T)(g=>!Array.isArray(g)||g.length<2?g:[u(g,o)]))};function u(o,l){let g=!0,f=o[0].length;const p=l.frameNameLabel??"frame";let c=[];for(const x of o){f!==x.length&&(g=!1,f=Math.max(f,x.length));for(const v of x.fields){const m={...v};m.state=void 0,x.name&&(l.frameNameMode==="drop"||(l.frameNameMode==="label"?(m.labels={...v.labels},m.labels[p]=x.name):!m.name||m.name===a.Bc?m.name=x.name:m.name=`${x.name} \xB7 ${v.name}`)),c.push(m)}}return g||(c=c.map(x=>{if(x.values.length===f)return x;const v=x.values.slice();return v.length=f,{...x,values:v}})),{fields:c,length:f}}},406:(te,R,e)=>{"use strict";e.d(R,{Xv:()=>v,ks:()=>y,s7:()=>g,zM:()=>o});var n=e(81160),a=e(44922),s=e(95004),i=e(36638),r=e(57866),u=e(64761);const o={id:u.F.convertFieldType,name:"Convert field type",description:"Convert a field to a specified field type.",defaultOptions:{fields:{},conversions:[{targetField:void 0,destinationType:void 0,dateFormat:void 0,timezone:void 0}]},operator:(d,E)=>b=>b.pipe((0,n.T)(D=>o.transformer(d,E)(D))),transformer:d=>E=>!Array.isArray(E)||E.length===0?E:l(d,E)??[]};function l(d,E){if(!d.conversions.length)return E;const b=E.map(D=>({...D}));for(const D of d.conversions){if(!D.targetField)continue;const C=i.sJ.get(r.Ct.byName).get(D.targetField);for(const P of b)P.fields=P.fields.map(M=>C(M,P,b)?g(M,D):M)}return b}function g(d,E){switch(E.destinationType){case s.PU.time:return y(d,E.dateFormat);case s.PU.number:return c(d);case s.PU.string:return v(d,E.dateFormat,{timeZone:E.timezone},E.joinWith);case s.PU.boolean:return x(d);case s.PU.enum:return h(d,E.enumConfig);case s.PU.other:return m(d);default:return d}}const f=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d{3,})?(?:Z|[-+]\d{2}:?\d{2})$/;function p(d,E){let b=E?{format:E}:void 0;const D=d.values.slice();let C=D.find(O=>O!=null);const P=typeof C=="number"&&E==="X",M=typeof C=="string"&&f.test(C);for(let O=0;O<D.length;O++)if(D[O]){let j=M?Date.parse(D[O]):(0,a.b)(D[O],b).valueOf();Number.isFinite(j)?D[O]=P?j*1e3:j:D[O]=null}else D[O]=null;return{...d,type:s.PU.time,values:D}}function c(d){const E=d.values.slice(),b=E.some(D=>typeof D=="string");for(let D=0;D<E.length;D++){let C=E[D];b&&C!=null&&typeof C=="string"&&(C=C.replace(/,/g,""));const P=+C;E[D]=Number.isFinite(P)?P:null}return{...d,type:s.PU.number,values:E}}function x(d){const E=d.values.slice();for(let b=0;b<E.length;b++)E[b]=!!E[b];return{...d,type:s.PU.boolean,values:E}}function v(d,E,b,D){let C=d.values;switch(d.type){case s.PU.time:C=C.map(P=>(0,a.b)(P,b).format(E));break;case s.PU.string:case s.PU.other:C=C.map(P=>D?.length&&Array.isArray(P)?P.join(D):JSON.stringify(P));break;default:C=C.map(P=>`${P}`)}return{...d,type:s.PU.string,values:C}}function m(d){const E=d.values.slice();for(let b=0;b<E.length;b++)try{E[b]=JSON.parse(E[b])}catch{E[b]=null}return{...d,type:s.PU.other,values:E}}function y(d,E){const b=typeof d.values[0]=="number",D=E==="X";return d.type===s.PU.time&&b?d:b&&!D?{...d,type:s.PU.time}:p(d,E)}function h(d,E){const b={...E},D=d.values.slice(),C=new Map;if(b.text&&b.text.length>0)for(let P=0;P<b.text.length;P++)C.set(b.text[P],P);else return d;for(let P=0;P<D.length;P++){const M=D[P];D[P]=C.get(M)}return{...d,config:{...d.config,type:{enum:b}},type:s.PU.enum,values:D}}},882:(te,R,e)=>{"use strict";e.d(R,{b:()=>r});var n=e(81160),a=e(41119),s=e(64761),i=e(6684);const r={id:s.F.ensureColumns,name:"Ensure Columns Transformer",description:"Will check if current data frames is series or columns. If in series it will convert to columns.",operator:(o,l)=>g=>g.pipe((0,n.T)(f=>r.transformer(o,l)(f))),transformer:(o,l)=>g=>{const f=u(g);return g.length>1&&f?i.L.transformer({byField:f},l)(g):g}};function u(o){let l;for(const g of o){const{timeField:f}=(0,a.KR)(g);if(!f)return;if(!l)l=f.name;else if(l!==f.name)return}return l}},49297:(te,R,e)=>{"use strict";e.d(R,{I:()=>u,z:()=>r});var n=e(81160),a=e(36638),s=e(64761),i=e(1027);const r={id:s.F.filterFields,name:"Filter Fields",description:"select a subset of fields",defaultOptions:{},operator:(o,l)=>g=>!o.include&&!o.exclude?g.pipe(i.W.operator({},l)):(typeof o.include?.options=="string"?o.include.options=o.include?.options:typeof o.include?.options?.pattern=="string"&&(o.include.options.pattern=o.include?.options.pattern),typeof o.exclude?.options=="string"?o.exclude.options=o.exclude?.options:typeof o.exclude?.options?.pattern=="string"&&(o.exclude.options.pattern=o.exclude?.options.pattern),g.pipe((0,n.T)(f=>{const p=o.include?(0,a.NS)(o.include):null,c=o.exclude?(0,a.NS)(o.exclude):null,x=[];for(const v of f){const m=[];for(let h=0;h<v.fields.length;h++){const d=v.fields[h];if(c){if(c(d,v,f))continue;p||m.push(d)}p&&p(d,v,f)&&m.push(d)}if(!m.length)continue;const y={...v,fields:m};x.push(y)}return x})))},u={id:s.F.filterFrames,name:"Filter Frames",description:"select a subset of frames",defaultOptions:{},operator:(o,l)=>g=>!o.include&&!o.exclude?g.pipe(i.W.operator({},l)):g.pipe((0,n.T)(f=>{const p=o.include?(0,a.Dq)(o.include):null,c=o.exclude?(0,a.Dq)(o.exclude):null,x=[];for(const v of f){if(c){if(c(v))continue;p||x.push(v)}p&&p(v)&&x.push(v)}return x}))}},359:(te,R,e)=>{"use strict";e.d(R,{D:()=>i,R:()=>r});var n=e(57866),a=e(49297),s=e(64761);const i={id:s.F.filterFieldsByName,name:"Filter fields by name",description:"select a subset of fields",defaultOptions:{},operator:(u,o)=>l=>l.pipe(a.z.operator({include:r(u.include,u.byVariable),exclude:r(u.exclude,u.byVariable)},o))},r=(u,o)=>{if(!u)return;const{names:l,pattern:g,variable:f}=u;if(o&&f){const p=f;if(/^\{.*\}$/.test(p)){const c=p.slice(1).slice(0,-1).split(",");return{id:n.Ct.byNames,options:{names:c}}}return{id:n.Ct.byNames,options:{names:p.split(",")}}}if(!((!Array.isArray(l)||l.length===0)&&!g))return g?!Array.isArray(l)||l.length===0?{id:n.Ct.byRegexp,options:g}:{id:n.Ct.byRegexpOrNames,options:u}:{id:n.Ct.byNames,options:{names:l}}}},68779:(te,R,e)=>{"use strict";e.d(R,{Sm:()=>o,Sv:()=>l,j4:()=>u});var n=e(81160),a=e(16515),s=e(36638),i=e(64761),r=e(1027),u=(p=>(p.exclude="exclude",p.include="include",p))(u||{}),o=(p=>(p.all="all",p.any="any",p))(o||{});const l={id:i.F.filterByValue,name:"Filter data by values",description:"select a subset of results based on values",defaultOptions:{filters:[],type:"include",match:"any"},operator:(p,c)=>x=>{const v=p.filters,m=p.match==="all",y=p.type==="include";return!Array.isArray(v)||v.length===0?x.pipe(r.W.operator({},c)):x.pipe((0,n.T)(h=>{if(h.length===0)return h;const d=[];for(const E of h){const b=new Set,D=f(E,h),C=g(v,D);for(let O=0;O<E.length;O++){if(b.has(O))continue;let j=!0;for(const U of C){const W=U(O,E,h);if(!m&&W){j=!0;break}if(m&&!W){j=!1;break}j=W}j&&b.add(O)}const P=[],M=y?b.size:h[0].length-b.size;for(const O of E.fields){const j=[];for(let U=0;U<E.length;U++){if(y&&b.has(U)){j.push(O.values[U]);continue}if(!y&&!b.has(U)){j.push(O.values[U]);continue}}P.push({...O,values:j,state:{}})}d.push({...E,fields:P,length:M})}return d}))}},g=(p,c)=>{const x=()=>!1;return p.map(v=>{const m=c[v.fieldName]??-1;if(m<0)return console.warn(`[FilterByValue] Could not find index for field name: ${v.fieldName}`),x;const y=(0,s.kK)(v.config);return(h,d,E)=>y(h,d.fields[m],d,E)})},f=(p,c)=>{const x={};return p.fields.forEach((v,m)=>{const y=(0,a.Ct)(v,p,c);x[y]=m}),x}},40041:(te,R,e)=>{"use strict";e.d(R,{gs:()=>o,yt:()=>f});var n=e(81160),a=e(95004),s=e(79319),i=e(36638),r=e(57866),u=e(64761),o=(c=>(c.UpperCase="Upper Case",c.LowerCase="Lower Case",c.SentenceCase="Sentence Case",c.TitleCase="Title Case",c.PascalCase="Pascal Case",c.CamelCase="Camel Case",c.SnakeCase="Snake Case",c.KebabCase="Kebab Case",c.Trim="Trim",c.Substring="Substring",c))(o||{});const l=c=>{const x=c.split(" ");for(let v=0;v<x.length;v++)x[v]=x[v].charAt(0).toUpperCase()+x[v].slice(1).toLowerCase();return x},g=c=>x=>x.values.map(v=>{switch(c.outputFormat){case"Upper Case":return v.toUpperCase();case"Lower Case":return v.toLowerCase();case"Sentence Case":return v.charAt(0).toUpperCase()+v.slice(1);case"Title Case":return l(v).join(" ");case"Pascal Case":return l(v).join("");case"Camel Case":return v=l(v).join(""),v.charAt(0).toLowerCase()+v.slice(1);case"Snake Case":return v.toLowerCase().split(" ").join("_");case"Kebab Case":return v.toLowerCase().split(" ").join("-");case"Trim":return v.trim();case"Substring":return v.substring(c.substringStart,c.substringEnd)}}),f={id:u.F.formatString,name:"Format string",description:"Manipulate string fields formatting",defaultOptions:{stringField:"",outputFormat:"Upper Case"},isApplicable:c=>{for(const x of c)for(const v of x.fields)if(v.type==="string")return s.M.Applicable;return s.M.NotApplicable},operator:c=>x=>x.pipe((0,n.T)(v=>{if(v.length===0)return v;const m=i.sJ.get(r.Ct.byName).get(c.stringField),y=g(c),h=p(m,y);return v.map(d=>({...d,fields:h(d,v)}))}))},p=(c,x)=>(v,m)=>v.fields.map(y=>{if(c(y,v,m)){const h=x(y);return{...y,type:a.PU.string,values:h}}return y})},47433:(te,R,e)=>{"use strict";e.d(R,{Ce:()=>v,R3:()=>f,Y2:()=>x,of:()=>p});var n=e(81160),a=e(16515),s=e(79319),i=e(46644),r=e(36638),u=e(57866),o=e(64761),l=e(91146);const g=2;var f=(m=>(m.aggregate="aggregate",m.groupBy="groupby",m))(f||{});const p={id:o.F.groupBy,name:"Group by",description:"Group the data by a field values then process calculations for each group.",defaultOptions:{fields:{}},isApplicable:m=>(0,l.f)(m)>=g?s.M.Applicable:s.M.NotApplicable,isApplicableDescription:m=>{const y=(0,l.f)(m);return`The Group by transformation requires a series with at least ${g} fields to work. The maximum number of fields found on a series is ${y}`},operator:m=>y=>y.pipe((0,n.T)(h=>{const d=[];for(const[D,C]of Object.entries(m.fields))C.operation==="groupby"&&d.push(D);if(d.length===0)return h;const E=(0,r.NS)({id:u.Ct.byNames,options:{names:d}}),b=[];for(const D of h){const C=D.fields.filter(O=>E(O,D,h));if(C.length===0)continue;const P=x(D,C),M=v(C,P);for(const O of D.fields){if(!c(O,m))continue;const j=(0,a.Ct)(O),U=m.fields[j].aggregations,W={};P.forEach(B=>{const S=B[j],_=(0,i.Nw)({field:S,reducers:U});for(const K of U)Array.isArray(W[K])||(W[K]=[]),W[K].push(_[K])});for(const B of U){const S={name:`${j} (${B})`,values:W[B]??[],type:(0,i.AH)(B,O.type),config:{}};M.push(S)}}b.push({refId:D.refId,fields:M,length:P.size})}return b}))},c=(m,y)=>{const h=(0,a.Ct)(m);return y?.fields[h]?.operation==="aggregate"&&Array.isArray(y?.fields[h].aggregations)&&y?.fields[h].aggregations.length>0};function x(m,y){const h=new Map;for(let d=0;d<m.length;d++){const E=String(y.map(D=>D.values[d])),b=h.get(E)??{};h.has(E)||h.set(E,b);for(let D of m.fields){const C=(0,a.Ct)(D);b[C]||(b[C]={name:C,type:D.type,config:{...D.config},values:[]}),b[C].values.push(D.values[d])}}return h}function v(m,y){const h=[];for(const d of m){const E=[],b=(0,a.Ct)(d);y.forEach(D=>{E.push(D[b].values[0])}),h.push({name:d.name,type:d.type,config:{...d.config},values:E})}return h}},25260:(te,R,e)=>{"use strict";e.d(R,{_:()=>x,l:()=>f});var n=e(81160),a=e(41119),s=e(16515),i=e(95004),r=e(79319),u=e(46644),o=e(47433),l=e(64761),g=e(91146);const f=!0,p=2;var c=(E=>(E.aggregate="aggregate",E.groupBy="groupby",E))(c||{});const x={id:l.F.groupToNestedTable,name:"Group to nested tables",description:"Group data by a field value and create nested tables with the grouped data",defaultOptions:{showSubframeHeaders:f,fields:{}},isApplicable:E=>(0,g.f)(E)>=p?r.M.Applicable:r.M.NotApplicable,isApplicableDescription:E=>{const b=(0,g.f)(E);return`The Group to nested table transformation requires a series with at least ${p} fields to work. The maximum number of fields found on a series is ${b}`},operator:E=>b=>b.pipe((0,n.T)(D=>{if(!Object.keys(E.fields).find(M=>E.fields[M].operation==="groupby"))return D;const P=[];for(const M of D){const O=M.fields.filter(B=>m(B,E));if(O.length===0)continue;const j=(0,o.Y2)(M,O),U=(0,o.Ce)(O,j),W=d(j,E);for(let B=0;B<M.fields.length;B++){const S=M.fields[B];if(!y(S,E))continue;const _=(0,s.Ct)(S),K=E.fields[_].aggregations,T={};j.forEach(L=>{const A=L[_],N=(0,u.Nw)({field:A,reducers:K});for(const V of K)Array.isArray(T[V])||(T[V]=[]),T[V].push(N[V])});for(const L of K){const A={name:`${_} (${L})`,values:T[L],type:i.PU.other,config:{}};A.type=h(L,S,A),U.push(A)}}U.push({config:{},name:"__nestedFrames",type:i.PU.nestedFrames,values:W}),P.push({fields:U,length:j.size})}return P}))};function v(E,b,D){return{meta:{custom:{noHeader:!(D.showSubframeHeaders===void 0?f:D.showSubframeHeaders)}},length:b,fields:E}}const m=(E,b)=>{const D=(0,s.Ct)(E);return b?.fields[D]?.operation==="groupby"},y=(E,b)=>{const D=(0,s.Ct)(E);return b?.fields[D]?.operation==="aggregate"&&Array.isArray(b?.fields[D].aggregations)&&b?.fields[D].aggregations.length>0},h=(E,b,D)=>{switch(E){case u.gy.allIsNull:return i.PU.boolean;case u.gy.last:case u.gy.lastNotNull:case u.gy.first:case u.gy.firstNotNull:return b.type;default:return(0,a.dF)(D)??i.PU.string}};function d(E,b){const D=[];for(const[,C]of E){const P=[];for(const[M,O]of Object.entries(C)){const j=b.fields[M];(j===void 0||j.aggregations===void 0||j.operation==="aggregate"&&j.aggregations.length===0||j.operation===null||j.operation===void 0)&&P.push(O)}P.length>0?D.push([v(P,P[0].values.length,b)]):D.push([v([],0,b)])}return D}},74261:(te,R,e)=>{"use strict";e.d(R,{EO:()=>U,H1:()=>E,NX:()=>h,OA:()=>m,Rt:()=>v,Uh:()=>P,ZU:()=>C,cg:()=>j,d$:()=>y,dA:()=>d,ix:()=>b,p3:()=>D,rW:()=>f,rs:()=>M});var n=e(81160),a=e(8721),s=e(11576),i=e(69884),r=e(95004),u=e(39443),o=e(79243),l=e(64761),g=e(34455);const f=[1e-9,2e-9,25e-10,4e-9,5e-9,1e-8,2e-8,25e-9,4e-8,5e-8,1e-7,2e-7,25e-8,4e-7,5e-7,1e-6,2e-6,25e-7,4e-6,5e-6,1e-5,2e-5,25e-6,4e-5,5e-5,1e-4,2e-4,25e-5,4e-4,5e-4,.001,.002,.0025,.004,.005,.01,.02,.025,.04,.05,.1,.2,.25,.4,.5,1,2,4,5,10,20,25,40,50,100,200,250,400,500,1e3,2e3,2500,4e3,5e3,1e4,2e4,25e3,4e4,5e4,1e5,2e5,25e4,4e5,5e5,1e6,2e6,25e5,4e6,5e6,1e7,2e7,25e6,4e7,5e7,1e8,2e8,25e7,4e8,5e8,1e9,2e9,25e8,4e9,5e9],p=30,c=[],x=(W,B)=>W-B,v={bucketCount:{name:"Bucket count",description:"approx bucket count"},bucketSize:{name:"Bucket size",description:void 0},bucketOffset:{name:"Bucket offset",description:"for non-zero-based buckets"},combine:{name:"Combine series",description:"combine all series into a single histogram"}},m={id:l.F.histogram,name:"Histogram",description:"Calculate a histogram from input data.",defaultOptions:{fields:{}},operator:(W,B)=>S=>S.pipe((0,n.T)(_=>m.transformer(W,B)(_))),transformer:(W,B)=>S=>{if(!Array.isArray(S)||S.length===0)return S;let _,K;W.bucketSize&&(typeof W.bucketSize=="string"?_=parseFloat(W.bucketSize):_=W.bucketSize,isNaN(_)&&(_=void 0)),W.bucketOffset&&(typeof W.bucketOffset=="string"?K=parseFloat(W.bucketOffset):K=W.bucketOffset,isNaN(K)&&(K=void 0));const T={bucketSize:_,bucketOffset:K,combine:W.combine},L=D(S,T);return L==null?[]:[j(L)]}},y="xMin";function h(W){return W===y||W==="BucketMin"}const d="xMax";function E(W){return W===d||W==="BucketMax"}function b(W){if(W.meta?.type===u.m.HeatmapCells){let K=W.fields.find(w=>w.name==="yMin"),T=W.fields.find(w=>w.name==="yMax"),L=W.fields.find(w=>w.name==="count"),A=[...new Set(T.values)].sort((w,H)=>w-H),N=[...new Set(K.values)].sort((w,H)=>w-H),V=new Map;A.forEach(w=>V.set(w,0));for(let w=0;w<T.values.length;w++){let H=T.values[w];V.set(H,V.get(H)+L.values[w])}return{xMin:{...K,name:"xMin",values:N},xMax:{...T,name:"xMax",values:A},counts:[{...L,values:[...V.values()]}]}}else if(W.meta?.type===u.m.HeatmapRows){let K=[],T=[],L=[],A="0";return W.fields.forEach(V=>{if(V.type===r.PU.number){let z=V.values.reduce((w,H)=>w+H,0);L.push(z),K.push(A),T.push(A=V.name)}}),L.push(0),K.push(A),T.push(A),{xMin:{...W.fields[1],name:"xMin",type:r.PU.string,values:K},xMax:{...W.fields[1],name:"xMax",type:r.PU.string,values:T},counts:[{...W.fields[1],name:"count",type:r.PU.number,values:L}]}}let B,S;const _=[];for(const K of W.fields)h(K.name)?B=K:E(K.name)?S=K:K.type===r.PU.number&&_.push(K);if(!S&&B&&B.values.length>1){let K=B.values,T=(0,o.h)(K[1]-K[0],6);S={...B,name:d,values:K.map(L=>L+T)}}if(!B&&S&&S?.values.length>1){let K=S.values,T=(0,o.h)(K[1]-K[0],6);B={...S,name:y,values:K.map(L=>L-T)}}if(B&&S&&_.length)return{xMin:B,xMax:S,counts:_}}function D(W,B,S){let _=B?.bucketSize,K=B?.bucketCount??p,T=B?.bucketOffset??0;if(W=W.map(Z=>({...Z,fields:Z.fields.map(Y=>{if(Y.type===r.PU.number){const X=Number(Y.config.noValue);Number.isNaN(X)?Y={...Y,values:Y.values.filter(I=>I!=null)}:Y=(0,g.A)(Y,X)}return Y})})),!_||_<0){let Z=[];for(const q of W)for(const ne of q.fields)ne.type===r.PU.number&&(Z=Z.concat(ne.values));Z.sort((q,ne)=>q-ne);let Y=1/0;if(Z.length===1)Y=1;else for(let q=1;q<Z.length;q++){let ne=Z[q]-Z[q-1];ne!==0&&(Y=Math.min(Y,ne))}let X=Z[0];const ee=(Z[Z.length-1]-X)/K;for(let q=0;q<f.length;q++){let ne=f[q];if(ee<ne&&ne>=Y){_=ne;break}}}const L=Z=>(0,o.h)(M(Z-T,_)+T,9);let A=((""+_).match(/\.\d+$/)??["."])[0].length-1,N=[],V=[],z;for(const Z of W)for(const Y of Z.fields)if(Y.type===r.PU.number){let X=O(Y.values,L,c,x);N.push(X);const I={...Y,config:{...Y.config,unit:Y.config.unit==="short"?"short":void 0}};I.display=(0,s.J)({field:I,theme:S??(0,i.a)()}),V.push(I),!z&&Y.config.unit&&(z=Y.config)}if(!V.length)return null;let w=(0,a.fj)(N);for(let Z=1;Z<w.length;Z++){let Y=w[Z];for(let X=0;X<Y.length;X++)Y[X]==null&&(Y[X]=0)}const H={name:y,values:w[0],type:r.PU.number,state:void 0,config:A===0?z??{}:{...z,decimals:A}},Q={...H,name:d,values:w[0].map(Z=>Z+_)};if(B?.combine){const Z=new Array(w[0].length).fill(0);for(let Y=1;Y<w.length;Y++)for(let X=0;X<Z.length;X++)Z[X]+=w[Y][X];V=[{...V[0],name:"count",values:Z,type:r.PU.number,state:{...V[0].state,displayName:"Count",multipleFrames:!1,origin:{frameIndex:0,fieldIndex:2}}}]}else V.forEach((Z,Y)=>{Z.values=w[Y+1]});return{xMin:H,xMax:Q,counts:V}}function C(W,B){return Math.round(W/B)*B}function P(W,B){return Math.ceil(W/B)*B}function M(W,B){return Math.floor(W/B)*B}function O(W,B,S,_){let K=new Map;for(let N=0;N<W.length;N++){let V=W[N];V!=null&&(V=B(V));let z=K.get(V);z?z.count++:K.set(V,{value:V,count:1})}S&&S.forEach(N=>K.delete(N));let T=[...K.values()];_&&T.sort((N,V)=>_(N.value,V.value));let L=Array(T.length),A=Array(T.length);for(let N=0;N<T.length;N++)L[N]=T[N].value,A[N]=T[N].count;return[L,A]}function j(W,B){if(!W.xMin.display){const S=(0,s.J)({field:W.xMin,theme:B??(0,i.a)()});W.xMin.display=S,W.xMax.display=S}return{length:W.xMin.values.length,meta:{type:u.m.Histogram},fields:[W.xMin,W.xMax,...W.counts],refId:`${l.F.histogram}`}}function U(W){if(W.length===1)return W[0];let B=(0,a.Fd)({frames:W.map(L=>({length:L.xMax.values.length,fields:[L.xMax,L.xMin,...L.counts]})),joinBy:L=>L.name==="xMax"}),S=null,_=null,K=[];return B.fields.forEach(L=>{if(L.name==="xMax")S=L;else if(L.name==="xMin")if(_==null)_=L;else for(let A=0;A<L.values.length;A++)_.values[A]??=L.values[A];else K.push({...L,values:L.values.map(A=>A??0)})}),{xMin:_,xMax:S,counts:K}}},64761:(te,R,e)=>{"use strict";e.d(R,{F:()=>n});var n=(a=>(a.append="append",a.reduce="reduce",a.order="order",a.organize="organize",a.rename="rename",a.calculateField="calculateField",a.seriesToColumns="seriesToColumns",a.seriesToRows="seriesToRows",a.merge="merge",a.concatenate="concatenate",a.labelsToFields="labelsToFields",a.filterFields="filterFields",a.filterFieldsByName="filterFieldsByName",a.filterFrames="filterFrames",a.filterByRefId="filterByRefId",a.renameByRegex="renameByRegex",a.filterByValue="filterByValue",a.noop="noop",a.ensureColumns="ensureColumns",a.groupBy="groupBy",a.sortBy="sortBy",a.histogram="histogram",a.configFromData="configFromData",a.rowsToFields="rowsToFields",a.prepareTimeSeries="prepareTimeSeries",a.convertFieldType="convertFieldType",a.fieldLookup="fieldLookup",a.heatmap="heatmap",a.spatial="spatial",a.joinByField="joinByField",a.joinByLabels="joinByLabels",a.extractFields="extractFields",a.groupingToMatrix="groupingToMatrix",a.limit="limit",a.partitionByValues="partitionByValues",a.timeSeriesTable="timeSeriesTable",a.transpose="transpose",a.formatTime="formatTime",a.formatString="formatString",a.regression="regression",a.groupToNestedTable="groupToNestedTable",a))(n||{})},6684:(te,R,e)=>{"use strict";e.d(R,{L:()=>o,W:()=>u});var n=e(81160),a=e(36638),s=e(57866),i=e(64761),r=e(8721),u=(l=>(l.outer="outer",l.inner="inner",l.outerTabular="outerTabular",l))(u||{});const o={id:i.F.joinByField,aliasIds:[i.F.seriesToColumns],name:"Join by field",description:"Combine rows from two or more tables, based on a related field between them.  This can be used to outer join multiple time series on the _time_ field to show many time series in one table.",defaultOptions:{byField:void 0,mode:"outer"},operator:(l,g)=>f=>f.pipe((0,n.T)(p=>o.transformer(l,g)(p))),transformer:(l,g)=>{let f;return p=>{if(p.length>1){l.byField&&!f&&(f=a.sJ.get(s.Ct.byName).get(l.byField));const c=(0,r.Fd)({frames:p,joinBy:f,mode:l.mode});if(c)return c.refId=`${i.F.joinByField}-${p.map(x=>x.refId).join("-")}`,[c]}return p}}}},8721:(te,R,e)=>{"use strict";e.d(R,{Fd:()=>g,JI:()=>x,RC:()=>p,WO:()=>c,Yj:()=>l,fj:()=>m,g2:()=>y});var n=e(41119),a=e(95004),s=e(36638),i=e(57866),r=e(6684);function u(h){const{timeField:d}=(0,n.KR)(h[0]);if(d)return s.sJ.get(i.Ct.firstTimeField).get({});let E=[];for(const b of h[0].fields)b.type===a.PU.number&&E.push(b.name);for(let b=1;b<h.length;b++){const D=[];for(const C of h[0].fields)C.type===a.PU.number&&D.push(C.name);E=E.filter(C=>!D.includes(C))}return s.sJ.get(i.Ct.byName).get(E[0])}function o(h){return h.joinBy??u(h.frames)}function l(h,d){if(d>=0){let E=h.fields[d];E.type!==a.PU.string&&!y(E.values)&&(h=(0,n.ES)(h,d))}return h}function g(h){if(!h.frames?.length)return;const d=h.nullMode??(M=>{let O=M.config.custom?.spanNulls;return O===!0?p:O===-1?c:x});if(h.frames.length===1){let M=h.frames[0],O=M;const j=o(h);let U=O.fields.findIndex(W=>j(W,O,h.frames));if(h.keepOriginIndices&&(O={...M,fields:M.fields.map((W,B)=>{const S={...W},_={frameIndex:0,fieldIndex:B};return S.state?S.state.origin=_:S.state={origin:_},S})},U>0)){const W=O.fields[U],B=O.fields.filter((S,_)=>_!==U);B.unshift(W),O.fields=B,U=0}if(U>=0&&(O=l(O,U)),h.keep){let W=O.fields.filter((B,S)=>S===U||h.keep(B,O,h.frames));M!==O?O.fields=W:O={...M,fields:W}}return O}const E=[],b=[],D=[],C=o(h);for(let M=0;M<h.frames.length;M++){const O=h.frames[M];if(!O||!O.fields?.length)continue;const j=[p];let U,W=[];for(let S=0;S<O.fields.length;S++){const _=O.fields[S];if(_.state=_.state||{},!U&&C(_,O,h.frames))U=_;else{if(h.keep&&!h.keep(_,O,h.frames))continue;j.push(d(_));let K=_.labels??{},T=_.name;O.name&&(_.name===a.Bc?T=O.name:K.name==null&&(K={...K,name:O.name})),W.push({..._,name:T,labels:K})}h.keepOriginIndices&&(_.state.origin={frameIndex:M,fieldIndex:S})}if(!U)continue;D.length===0&&D.push(U),E.push(j);const B=[U.values];for(const S of W)B.push(S.values),D.push(S),h.keepDisplayNames||delete S.state?.displayName;b.push(B)}let P=[];return h.mode===r.W.outerTabular?P=f(b,!0):h.mode===r.W.inner?P=f(b):P=m(b,E,h.mode),{length:P[0]?P[0].length:0,fields:D.map((M,O)=>({...M,values:P[O]}))}}function f(h,d=!1){let E=h[0],b=E[0];for(let D=1;D<h.length;D++){let C=h[D],P=C[0],M={};for(let V=0;V<P.length;V++){let z=P[V],w=M[z];w==null&&(w=M[z]=[]),w.push(V)}let O=new Set,j=[],U=[],W=[],B=0;for(let V=0;V<b.length;V++){let z=b[V];if(z!=null){let w=M[z];w!=null?(W.push([V,w]),B+=w.length,d&&O.add(z)):d&&j.push(V)}else d&&j.push(V)}if(B+=j.length,d){for(let V in M)O.has(V)||U.push(...M[V]);B+=U.length}let S=Array.from({length:E.length+C.length-1},()=>`Array(${B})`).join(","),_=E.map((V,z)=>`joined[${z}][rowIdx] = ltable[${z}][lidx]`).join(";"),K=C.slice(1).map((V,z)=>`joined[${E.length+z}][rowIdx] = rtable[${z+1}][ridx]`).join(";"),T=E.map((V,z)=>`joined[${z}][rowIdx] = ${z===0?`rtable[${z}][ridx]`:"null"}`).join(";"),L=C.slice(1).map((V,z)=>`joined[${E.length+z}][rowIdx] = null`);E=new Function("matched","unmatchedLeft","unmatchedRight","ltable","rtable",`
      const joined = [${S}];

      let rowIdx = 0;

      for (let i = 0; i < matched.length; i++) {
        let [lidx, ridxs] = matched[i];

        for (let j = 0; j < ridxs.length; j++, rowIdx++) {
          let ridx = ridxs[j];
          ${_};
          ${K};
        }
      }

      for (let i = 0; i < unmatchedLeft.length; i++, rowIdx++) {
        let lidx = unmatchedLeft[i];
        ${_};
        ${L};
      }

      for (let i = 0; i < unmatchedRight.length; i++, rowIdx++) {
        let ridx = unmatchedRight[i];
        ${T};
        ${K};
      }

      return joined;
      `)(W,j,U,E,C),b=E[0]}return E}const p=0,c=1,x=2;function v(h,d,E){for(let b=0,D,C=-1;b<d.length;b++){let P=d[b];if(P>C){for(D=P-1;D>=0&&h[D]==null;)h[D--]=null;for(D=P+1;D<E&&h[D]==null;)h[C=D++]=null}}}function m(h,d,E=r.W.outer){let b=new Set;for(let M=0;M<h.length;M++){let j=h[M][0],U=j.length;for(let W=0;W<U;W++)b.add(j[W])}let D=[Array.from(b).sort((M,O)=>M-O)],C=D[0].length,P=new Map;for(let M=0;M<C;M++)P.set(D[0][M],M);for(let M=0;M<h.length;M++){let O=h[M],j=O[0];for(let U=1;U<O.length;U++){let W=O[U],B=Array(C).fill(void 0),S=d?d[M][U]:c,_=[];for(let K=0;K<W.length;K++){let T=W[K],L=P.get(j[K]);T===null?S!==p&&(B[L]=T,S===x&&_.push(L)):B[L]=T}v(B,_,C),D.push(B)}}return D}function y(h,d=50){const E=h.length;if(E<=1)return!0;let b=0,D=E-1;for(;b<=D&&h[b]==null;)b++;for(;D>=b&&h[D]==null;)D--;if(D<=b)return!0;const C=Math.max(1,Math.floor((D-b+1)/d));for(let P=h[b],M=b+C;M<=D;M+=C){const O=h[M];if(O!=null&&P!=null){if(O<=P)return!1;P=O}}return!0}},79184:(te,R,e)=>{"use strict";e.d(R,{V:()=>u,n:()=>r});var n=e(81160),a=e(16515),s=e(95004),i=e(64761),r=(l=>(l.Columns="columns",l.Rows="rows",l))(r||{});const u={id:i.F.labelsToFields,name:"Labels to fields",description:"Extract time series labels to fields (columns or rows)",defaultOptions:{},operator:(l,g)=>f=>f.pipe((0,n.T)(p=>u.transformer(l,g)(p))),transformer:l=>g=>{if(l.mode==="rows")return o(g,l.keepLabels);const f=[],p=l.keepLabels?.length?new Set(l.keepLabels):void 0;for(const c of g){const x=[],v={};for(const m of c.fields){if(!m.labels){x.push(m);continue}const y={...m,config:{...m.config,displayName:void 0,displayNameFromDS:void 0},labels:void 0};x.push(y);for(const h of Object.keys(m.labels)){if(p&&!p.has(h))continue;if(l.valueLabel===h){y.name=m.labels[h];continue}(v[h]??(v[h]=new Set)).add(m.labels[h])}}for(const m in v)for(const y of v[m]){const h=new Array(c.length).fill(y);x.push({name:m,type:s.PU.string,values:h,config:{}})}f.push({...c,fields:x,length:c.length})}return f}};function o(l,g){const f=[];for(const p of l)for(const c of p.fields)if(c.labels){const x=[],v=[];if(g)for(const m of g)x.push(m),v.push(c.labels[m]);else for(const[m,y]of Object.entries(c.labels))x.push(m),v.push(y);v.length&&f.push({...p,name:(0,a.Ct)(c,p,l),fields:[{name:"label",type:s.PU.string,config:{},values:x},{name:"value",type:s.PU.string,config:{},values:v}],length:v.length})}return f}},33023:(te,R,e)=>{"use strict";e.d(R,{o:()=>o});var n=e(2543),a=e.n(n),s=e(81160),i=e(18700),r=e(79319),u=e(64761);const o={id:u.F.merge,name:"Merge series/tables",description:"Merges multiple series/tables into a single serie/table",defaultOptions:{},isApplicable:v=>v.length>1?r.M.Applicable:r.M.NotApplicable,isApplicableDescription:v=>`The merge transformation requires at least 2 data series to work. There is currently ${v.length} data series.`,operator:v=>m=>m.pipe((0,s.T)(y=>{if(!Array.isArray(y)||y.length<=1)return y;const h=y.filter(j=>j.fields.length>0);if(h.length===0)return[y[0]];const d=new Set,E={},b=[],D=new i.k({refId:`${u.F.merge}-${h.map(j=>j.refId).join("-")}`,fields:[]});for(let j=0;j<h.length;j++){const U=h[j];for(let W=0;W<U.fields.length;W++){const B=U.fields[W];d.has(B.name)||(D.addField(l(B)),d.add(B.name)),E[B.name]=E[B.name]||{},E[B.name][j]=W,h.length-1===j&&c(E,B,h)&&b.push(B.name)}}if(b.length===0)return y;const C={},P=[],M=g(h,E,b),O=f(h,d,E);for(let j=0;j<h.length;j++){const U=h[j];for(let W=0;W<U.length;W++){const B=M(j,W),S=O(j,W);if(!Array.isArray(C[B])){C[B]=[S],P.push(x(B,C));continue}let _=!1;C[B]=C[B].map(K=>p(K,S)?(_=!0,{...K,...S}):K),_||(C[B].push(S),P.push(x(B,C)))}}for(const j of P){const U=C[j.key][j.index];U&&D.add(U)}return[D]}))},l=v=>({...(0,n.omit)(v,["values","state","labels","config"]),values:[],config:{...(0,n.omit)(v.config,"displayName")}}),g=(v,m,y)=>{const h=y.reduce((d,E)=>Object.keys(m[E]).reduce((b,D)=>(b[D]=b[D]||[],b[D].push(m[E][D]),b),d),{});return(d,E)=>h[d].reduce((b,D)=>b+v[d].fields[D].values[E],"")},f=(v,m,y)=>(h,d)=>{const E={},b=Array.from(m);for(const D of b){const C=y[D];if(!C)continue;const P=C[h];if(typeof P!="number")continue;const M=v[h];if(!M||!M.fields)continue;const O=M.fields[P];!O||!O.values||(E[D]=O.values[d])}return E},p=(v,m)=>{let y=!0;for(const h in m)if(!(typeof v[h]>"u")&&v[h]!==null&&v[h]!==m[h]){y=!1;break}return y},c=(v,m,y)=>Object.keys(v[m.name]).length===y.length,x=(v,m)=>({key:v,index:m[v].length-1})},1027:(te,R,e)=>{"use strict";e.d(R,{W:()=>a});var n=e(64761);const a={id:n.F.noop,name:"noop",description:"No-operation transformer",defaultOptions:{},operator:s=>i=>i,transformer:s=>i=>i}},63409:(te,R,e)=>{"use strict";e.d(R,{M:()=>i});var n=e(95004);const a={threshold:(u,o,l)=>u+l,midpoint:(u,o,l)=>(u+o)/2,plusone:(u,o,l)=>u+1};function s(u,o){return u.fields.find(l=>o!=null?l.name===o:l.type===n.PU.time)}function i(u){if(u.frame.length===0)return u.frame;let o=!0,{frame:l,refFieldName:g,refFieldPseudoMax:f,refFieldPseudoMin:p,insertMode:c}=u;c||(c=a.threshold);const x=s(l,g);if(x==null)return l;x.state={...x.state,nullThresholdApplied:!0};const v=l.fields.map(y=>y.config.custom?.insertNulls||x.config.interval||null),m=new Set(v);if(m.delete(null),m.size===0)return l;if(m.size===1){const y=m.values().next().value;if(!y||y<=0)return l;const h=x.values,d=l.fields.map(b=>b.values),E=r(h,d,y,p,f,c,o);return E===d?l:{...l,length:E[0].length,fields:l.fields.map((b,D)=>({...b,values:E[D]}))}}return l}function r(u,o,l,g=null,f=null,p,c){const x=u.length,v=[];if(g!=null&&g<u[0]){let d=Math.ceil((u[0]-g)/l),E=u[0]-d*l;for(;E<u[0];)v.push(p(E-l,E,l)),E+=l}v.push(u[0]);let m=u[0];for(let d=1;d<x;d++){const E=u[d];for(;E-m>l&&(v.push(p(m,E,l)),m+=l,!!c););v.push(E),m=E}if(f!=null&&f>m)for(;m+l<f;)v.push(p(m,f,l)),m+=l;const y=v.length;if(y===x)return o;const h=[];for(let d of o){let E;if(d!==u){E=Array(y);for(let b=0,D=0;b<y;b++)E[b]=u[D]===v[b]?d[D++]:null}else E=v;h.push(E)}return h}},34455:(te,R,e)=>{"use strict";e.d(R,{A:()=>a,C:()=>n});function n(s){return{...s,fields:s.fields.map(i=>{const r=Number(i.config.noValue);return Number.isNaN(r)?i:a(i,r)})}}function a(s,i){const r=s.values.slice();for(let u=0;u<r.length;u++)r[u]===null&&(r[u]=i);return{...s,values:r}}},95575:(te,R,e)=>{"use strict";e.d(R,{Mq:()=>g,NU:()=>o,Xz:()=>p,pH:()=>l,wx:()=>m,xQ:()=>f});var n=e(2543),a=e.n(n),s=e(81160),i=e(16515),r=e(95004),u=e(64761),o=(y=>(y.Manual="manual",y.Auto="auto",y))(o||{}),l=(y=>(y.Off="off",y.Asc="asc",y.Desc="desc",y))(l||{}),g=(y=>(y.Name="name",y.Label="label",y))(g||{});const f={id:u.F.order,name:"Order fields by name",description:"Order fields based on configuration given by user",defaultOptions:{indexByName:{}},operator:({indexByName:y,orderByMode:h="manual",orderBy:d=[]})=>E=>E.pipe((0,s.T)(b=>{(0,i.Fm)(b);const D=h==="manual"?c(y):m(d);return b.map(C=>({...C,fields:D(C.fields,b,C)}))}))},p=y=>(h,d)=>x(h,y)-x(d,y),c=y=>(h,d,E)=>{const b=p(y);return(0,n.clone)(h).sort((D,C)=>b((0,i.Ct)(D,E,d),(0,i.Ct)(C,E,d)))},x=(y,h)=>Number.isInteger(h[y])?h[y]:Number.MAX_SAFE_INTEGER,v=new Intl.Collator(void 0,{sensitivity:"base",numeric:!0}).compare,m=y=>h=>{const d=h.find(E=>E.type===r.PU.time);return h.slice().sort((E,b)=>{if(E===d)return-1;if(b===d)return 1;for(let D=0;D<y.length;D++){let{type:C,name:P="",desc:M=!1}=y[D],O=C==="name"?E.state?.displayName??E.name:E.labels?.[P]??"",j=C==="name"?b.state?.displayName??b.name:b.labels?.[P]??"",U=v(O,j)*(M?-1:1);if(U!==0)return U}return 0})}},32157:(te,R,e)=>{"use strict";e.d(R,{Wj:()=>f,rV:()=>g});var n=e(81160),a=e(41119),s=e(16515),i=e(95004),r=e(46644),u=e(36638),o=e(6844),l=e(64761),g=(y=>(y.SeriesToRows="seriesToRows",y.ReduceFields="reduceFields",y))(g||{});const f={id:l.F.reduce,name:"Reduce",description:"Reduce all rows or data points to a single value using a function like max, min, mean or last.",defaultOptions:{reducers:[r.gy.max]},operator:y=>h=>h.pipe((0,n.T)(d=>{if(!y?.reducers?.length)return d;const E=y.fields?(0,u.NS)(y.fields):y.includeTimeField&&y.mode==="reduceFields"?o.Yg:o.zx;if(y.mode==="reduceFields")return v(d,E,y.reducers);const b=p(d,E,y.reducers,y.labelsToFields);return b?[{...b,refId:`${l.F.reduce}-${d.map(D=>D.refId).join("-")}`}]:[]}))};function p(y,h,d,E){const b=r.AS.list(d),D=b.map(M=>M.id),C=[],P=E?c(y):[];for(const M of y){const O=M.fields.filter(_=>h(_,M,y)),j=O.length,U=[],W=new Array(j);U.push({name:"Field",type:i.PU.string,values:W,config:{}});const B={};if(E)for(const _ of P)B[_]=new Array(j),U.push({name:_,type:i.PU.string,values:B[_],config:{}});const S={};for(const _ of b)S[_.id]=new Array(j),U.push({name:_.name,type:i.PU.other,values:S[_.id],config:{}});for(let _=0;_<O.length;_++){const K=O[_],T=(0,r.Nw)({field:K,reducers:D});if(E){if(W[_]=K.name,K.labels)for(const L in K.labels)B[L][_]=K.labels[L]}else W[_]=(0,s.Ct)(K,M,y);for(const L of b){const A=T[L.id];A===null?S[L.id][_]=NaN:S[L.id][_]=A}}for(const _ of U)if(_.type===i.PU.other){const K=(0,a.dF)(_);K&&(_.type=K)}C.push({...M,fields:U,length:j})}return x(C)}function c(y){const h=new Set;for(const d of y)for(const E of d.fields)if(E.labels)for(const b of Object.keys(E.labels))h.add(b);return[...h]}function x(y){if(!y?.length)return;const h=y[0];for(let d=1;d<y.length;d++){const E=y[d];for(let b=0;b<h.fields.length;b++){const D=h.fields[b];for(let C=0;C<E.fields.length;C++){const P=E.fields[C],M=b===0&&C===0,O=D.type===P.type&&D.name===P.name;if(M||O){const j=D.values,U=P.values;D.values=j.concat(U)}}}}return h.name=void 0,h.length=h.fields[0].values.length,h}function v(y,h,d){const b=r.AS.list(d).map(C=>C.id),D=[];for(const C of y){const P=[];for(const M of C.fields)if(h(M,C,y)){const O=(0,r.Nw)({field:M,reducers:b});for(const j of b){const U=O[j],W={...M,labels:{...M.labels},type:m(j,M),values:[U],state:void 0};b.length>1&&(W.labels||(W.labels={}),W.labels.reducer=r.AS.get(j).name),P.push(W)}}P.length&&D.push({...C,fields:P,length:1})}return D}function m(y,h){switch(y){case r.gy.allValues:case r.gy.uniqueValues:return i.PU.other;case r.gy.first:case r.gy.firstNotNull:case r.gy.last:case r.gy.lastNotNull:return h.type;default:return i.PU.number}}},91146:(te,R,e)=>{"use strict";e.d(R,{f:()=>n});function n(a){let s=0;for(const i of a)i.fields.length>s&&(s=i.fields.length);return s}},85891:(te,R,e)=>{"use strict";e.d(R,{DO:()=>s,Ur:()=>r,VR:()=>a,X2:()=>n,ki:()=>i,mx:()=>u});var n=(o=>(o.Fetch="fetch",o))(n||{}),a=(o=>(o.String="string",o))(a||{}),s=(o=>(o.POST="POST",o.PUT="PUT",o.GET="GET",o))(s||{});const i=[{label:"POST",value:"POST"},{label:"PUT",value:"PUT"},{label:"GET",value:"GET"}],r=[{label:"application/json",value:"application/json"},{label:"text/plain",value:"text/plain"},{label:"application/xml",value:"application/xml"},{label:"application/x-www-form-urlencoded",value:"application/x-www-form-urlencoded"}],u={type:"fetch",title:"",fetch:{url:"",method:"POST",body:"{}",queryParams:[],headers:[["Content-Type","application/json"]]}}},76190:(te,R,e)=>{"use strict";e.d(R,{O:()=>n});var n=(a=>(a.NoData="no_data",a.Paused="paused",a.Alerting="alerting",a.OK="ok",a.Pending="pending",a.Recovering="recovering",a.Unknown="unknown",a))(n||{})},88907:(te,R,e)=>{"use strict";e.d(R,{V:()=>n});var n=(a=>(a.Field="field",a.Text="text",a.Skip="skip",a))(n||{})},1906:(te,R,e)=>{"use strict";e.d(R,{Ay:()=>r,Jk:()=>s,hX:()=>i});var n=e(78830),a=e(11594),s=(u=>(u.CloudAlerting="cloud-alerting",u.UnifiedAlerting="unified-alerting",u.Dashboard="dashboard",u.Explore="explore",u.Correlations="correlations",u.Unknown="unknown",u.PanelEditor="panel-editor",u.PanelViewer="panel-viewer",u))(s||{});class i extends a.Ud{constructor(){super(...arguments),this._exposedComponentConfigs=[],this._addedComponentConfigs=[],this._addedLinkConfigs=[],this._addedFunctionConfigs=[]}init(o){}setRootPage(o){return this.root=o,this}setComponentsFromLegacyExports(o){if((0,n.M)(o),this.meta&&this.meta.includes){for(const l of this.meta.includes)if(l.type===a.ib.page&&l.component&&!o[l.component]){console.warn("App Page uses unknown component: ",l.component,this.meta);continue}}}get exposedComponentConfigs(){return this._exposedComponentConfigs}get addedComponentConfigs(){return this._addedComponentConfigs}get addedLinkConfigs(){return this._addedLinkConfigs}get addedFunctionConfigs(){return this._addedFunctionConfigs}addLink(o){return this._addedLinkConfigs.push(o),this}addComponent(o){return this._addedComponentConfigs.push(o),this}addFunction(o){return this._addedFunctionConfigs.push(o),this}exposeComponent(o){return this._exposedComponentConfigs.push(o),this}}var r=(u=>(u.alpha="alpha",u.beta="beta",u.experimental="experimental",u.privatePreview="private preview",u.preview="preview",u.new="new",u))(r||{})},41607:(te,R,e)=>{"use strict";e.d(R,{r:()=>n});var n=(a=>(a.OpenSource="Open Source",a.Pro="Pro",a.Enterprise="Enterprise",a))(n||{})},48588:(te,R,e)=>{"use strict";e.d(R,{En:()=>s,d1:()=>a,tw:()=>n});const n=0,a=100,s="SAML"},84229:(te,R,e)=>{"use strict";e.d(R,{y:()=>n});var n=(a=>(a[a.Off=0]="Off",a[a.Crosshair=1]="Crosshair",a[a.Tooltip=2]="Tooltip",a))(n||{})},28105:(te,R,e)=>{"use strict";e.d(R,{Gu:()=>n,Gv:()=>u,Nx:()=>a,UW:()=>s,zz:()=>i});var n=(o=>(o.NotStarted="NotStarted",o.Loading="Loading",o.Streaming="Streaming",o.Done="Done",o.Error="Error",o))(n||{});const a=["graph","table","logs","trace","nodeGraph","flamegraph","rawPrometheus"];var s=(o=>(o.Null="null",o.Ignore="connected",o.AsZero="null as zero",o))(s||{});const i=o=>!!o;function r(o){return o}function u(o){return typeof o=="object"&&o!==null?!0:!1}},39443:(te,R,e)=>{"use strict";e.d(R,{m:()=>n});var n=(a=>(a.TimeSeriesWide="timeseries-wide",a.TimeSeriesLong="timeseries-long",a.TimeSeriesMany="timeseries-many",a.TimeSeriesMulti="timeseries-multi",a.NumericWide="numeric-wide",a.NumericMulti="numeric-multi",a.NumericLong="numeric-long",a.LogLines="log-lines",a.DirectoryListing="directory-listing",a.HeatmapRows="heatmap-rows",a.HeatmapCells="heatmap-cells",a.Histogram="histogram",a))(n||{})},79609:(te,R,e)=>{"use strict";e.d(R,{$0:()=>s,CC:()=>a,uP:()=>i,x0:()=>n,yd:()=>r});var n=(u=>(u.Datasource="Datasource",u.Correlations="Correlations",u.ExploreCorrelationsEditor="CorrelationsEditor",u))(n||{}),a=(u=>(u.Regex="regex",u.Logfmt="logfmt",u))(a||{}),s=(u=>(u.Series="series",u.Field="field",u.Fields="fields",u.Value="value",u.BuiltIn="built-in",u.Template="template",u))(s||{}),i=(u=>(u.Values="values",u))(i||{}),r=(u=>(u.Action="action",u.Link="link",u.Off="off",u))(r||{})},94644:(te,R,e)=>{"use strict";e.d(R,{Is:()=>g,ZF:()=>o,mA:()=>u,tD:()=>r,v2:()=>l});var n=e(37615),a=e(35814),s=e(78830),i=e(11594);class r extends i.Ud{constructor(p){super(),this.DataSourceClass=p,this.components={}}setConfigEditor(p){return this.components.ConfigEditor=p,this}setConfigCtrl(p){return(0,n.l)("DataSourcePlugin","setConfigCtrl"),this.angularConfigCtrl=p,this}setQueryCtrl(p){return(0,n.l)("DataSourcePlugin","setQueryCtrl"),this.components.QueryCtrl=p,this}setAnnotationQueryCtrl(p){return this.components.AnnotationsQueryCtrl=p,this}setQueryEditor(p){return this.components.QueryEditor=p,this}setExploreQueryField(p){return this.components.ExploreQueryField=p,this}setExploreMetricsQueryField(p){return this.components.ExploreMetricsQueryField=p,this}setExploreLogsQueryField(p){return this.components.ExploreLogsQueryField=p,this}setQueryEditorHelp(p){return this.components.QueryEditorHelp=p,this}setExploreStartPage(p){return this.setQueryEditorHelp(p)}setVariableQueryEditor(p){return this.components.VariableQueryEditor=p,this}setMetadataInspector(p){return this.components.MetadataInspector=p,this}setComponentsFromLegacyExports(p){(0,s.M)(p),this.components.QueryCtrl=p.QueryCtrl,this.components.AnnotationsQueryCtrl=p.AnnotationsQueryCtrl,this.components.ExploreQueryField=p.ExploreQueryField,this.components.QueryEditor=p.QueryEditor,this.components.QueryEditorHelp=p.QueryEditorHelp,this.components.VariableQueryEditor=p.VariableQueryEditor}}class u{constructor(p){this.name=p.name,this.id=p.id,this.type=p.type,this.meta=p.meta,this.cachingConfig=p.cachingConfig,this.uid=p.uid,this.apiVersion=p.apiVersion}filterQuery(p){return!0}getRef(){const p={type:this.type,uid:this.uid};return this.apiVersion&&(p.apiVersion=this.apiVersion),p}}var o=(f=>(f.Logs="Logs",f.Metrics="Metrics",f.Tracing="Tracing",f))(o||{}),l=(f=>(f.Cancelled="cancelled",f.Timeout="timeout",f.Unknown="unknown",f))(l||{});class g{}g=(0,a.Y)(g),u=(0,a.Y)(u)},83340:(te,R,e)=>{"use strict";e.d(R,{Ow:()=>a,ZW:()=>n,uo:()=>s});function n(i){return r=>"__systemRef"in r&&r.__systemRef===i}const a=i=>"__systemRef"in i&&typeof i.__systemRef=="string";var s=(i=>(i.Unit="unit",i.Min="min",i.Max="max",i.FieldMinMax="fieldMinMax",i.Decimals="decimals",i.DisplayName="displayName",i.NoValue="noValue",i.Thresholds="thresholds",i.Mappings="mappings",i.Links="links",i.Actions="actions",i.Color="color",i.Filterable="filterable",i))(s||{})},78479:(te,R,e)=>{"use strict";e.d(R,{R:()=>n});var n=(a=>(a.Grid="grid",a.List="list",a))(n||{})},32899:(te,R,e)=>{"use strict";e.d(R,{Tq:()=>u,ee:()=>i,kb:()=>r,r1:()=>s});var n=e(36819),a=e(68388);const s={alertSuccess:(0,n.R)("alert-success"),alertWarning:(0,n.R)("alert-warning"),alertError:(0,n.R)("alert-error"),alertInfo:(0,n.R)("alert-info")},i={refresh:(0,n.R)("refresh"),componentDidMount:(0,n.R)("component-did-mount"),dataReceived:(0,n.R)("data-received"),dataError:(0,n.R)("data-error"),dataFramesReceived:(0,n.R)("data-frames-received"),dataSnapshotLoad:(0,n.R)("data-snapshot-load"),editModeInitialized:(0,n.R)("init-edit-mode"),initPanelActions:(0,n.R)("init-panel-actions"),initialized:(0,n.R)("panel-initialized"),panelTeardown:(0,n.R)("panel-teardown"),render:(0,n.R)("render")};class r extends a.x{static{this.type="graph-hover"}}class u extends a.a{constructor(){super(...arguments),this.payload={point:{}}}static{this.type="graph-hover-clear"}}},38619:(te,R,e)=>{"use strict";e.d(R,{Cz:()=>u,DG:()=>g,Qp:()=>p,Z7:()=>l,ZF:()=>s,aj:()=>f,ew:()=>r,jQ:()=>o,o4:()=>i,os:()=>a,qD:()=>n});var n=(c=>(c.DataSource="ds",c.Plugin="plugin",c.Grafana="grafana",c.Stream="stream",c.Watch="watch",c))(n||{}),a=(c=>(c.DataStream="stream",c.DataFrame="frame",c.JSON="json",c))(a||{}),s=(c=>(c.Pending="pending",c.Connected="connected",c.Connecting="connecting",c.Disconnected="disconnected",c.Shutdown="shutdown",c.Invalid="invalid",c))(s||{}),i=(c=>(c.Status="status",c.Join="join",c.Leave="leave",c.Message="message",c))(i||{});function r(c){return c.type==="status"}function u(c){return c.type==="join"}function o(c){return c.type==="leave"}function l(c){return c.type==="message"}function g(c){if(c?.length){let x=c.trim().split("/");if(x.length>=3)return{scope:x[0],namespace:x[1],path:x.slice(2).join("/")}}}function f(c){return!!(c?.path&&c.namespace&&c.scope)}function p(c){if(!c.scope)return"";let x=c.scope;return!c.namespace||(x+="/"+c.namespace,!c.path)?x:x+"/"+c.path}},67770:(te,R,e)=>{"use strict";e.d(R,{$b:()=>a,Aj:()=>g,Df:()=>v,FP:()=>c,Nc:()=>f,Ol:()=>o,ZF:()=>u,_0:()=>x,_C:()=>r,cF:()=>l,s5:()=>s,tG:()=>i,wj:()=>p});var n=e(68388),a=(m=>(m.emerg="critical",m.fatal="critical",m.alert="critical",m.crit="critical",m.critical="critical",m.warn="warning",m.warning="warning",m.err="error",m.eror="error",m.error="error",m.info="info",m.information="info",m.informational="info",m.notice="info",m.dbug="debug",m.debug="debug",m.trace="trace",m.unknown="unknown",m))(a||{});const s={0:"critical",1:"critical",2:"critical",3:"error",4:"warning",5:"info",6:"info",7:"debug"};var i=(m=>(m[m.Number=0]="Number",m[m.String=1]="String",m[m.LabelsMap=2]="LabelsMap",m[m.Error=3]="Error",m))(i||{}),r=(m=>(m.none="No de-duplication",m.exact="De-duplication of successive lines that are identical, ignoring ISO datetimes.",m.numbers="De-duplication of successive lines that are identical when ignoring numbers, e.g., IP addresses, latencies.",m.signature="De-duplication of successive lines that have identical punctuation and whitespace.",m))(r||{}),u=(m=>(m.Backward="BACKWARD",m.Forward="FORWARD",m))(u||{});const o=m=>!m||typeof m!="object"?!1:"getLogRowContext"in m;var l=(m=>(m.LogsVolume="LogsVolume",m.LogsSample="LogsSample",m))(l||{}),g=(m=>(m.FullRange="FullRange",m.Limited="Limited",m))(g||{});const f=(m,y)=>m?("getDataProvider"in m||"getSupplementaryRequest"in m)&&"getSupplementaryQuery"in m&&"getSupportedSupplementaryQueryTypes"in m&&m.getSupportedSupplementaryQueryTypes().includes(y):!1,p=m=>!m||typeof m!="object"?!1:"getLogRowContextUi"in m,c=m=>m!=null&&typeof m=="object"&&"toggleQueryFilter"in m&&"queryHasFilter"in m,x=m=>m!=null&&typeof m=="object"&&"modifyQuery"in m&&"getSupportedQueryModifications"in m;class v extends n.x{static{this.type="logs-sort-order-change"}}},75683:(te,R,e)=>{"use strict";e.d(R,{k:()=>n});var n=(a=>(a[a.Standard=0]="Standard",a[a.Canvas=1]="Canvas",a[a.Custom=2]="Custom",a))(n||{})},90382:(te,R,e)=>{"use strict";e.d(R,{X:()=>n});var n=(a=>(a.None="None",a.Viewer="Viewer",a.Editor="Editor",a.Admin="Admin",a))(n||{})},38919:(te,R,e)=>{"use strict";e.d(R,{NV:()=>o,nQ:()=>r,v2:()=>u,wV:()=>i});var n=e(2543),a=e.n(n),s=e(95004),i=(l=>(l.Auto="auto",l.Vertical="vertical",l.Horizontal="horizontal",l))(i||{}),r=(l=>(l[l.Best=100]="Best",l[l.Good=70]="Good",l[l.OK=50]="OK",l))(r||{});class u{constructor(g,f){this.list=[],this.data=g,this.panel=f,this.dataSummary=this.computeDataSummary()}getListAppender(g){return new o(this.list,g)}computeDataSummary(){const g=this.data?.series||[];let f=0,p=0,c=0,x=0,v=0,m=0,y;for(const h of g){x+=h.length,h.meta?.preferredVisualisationType&&(y=h.meta.preferredVisualisationType);for(const d of h.fields)switch(m++,d.type){case s.PU.number:f+=1;break;case s.PU.time:p+=1;break;case s.PU.string:c+=1;break}h.length>v&&(v=h.length)}return{numberFieldCount:f,timeFieldCount:p,stringFieldCount:c,rowCountTotal:x,rowCountMax:v,fieldCount:m,preferredVisualisationType:y,frameCount:g.length,hasData:x>0,hasTimeField:p>0,hasNumberField:f>0,hasStringField:c>0}}getList(){return this.list}}class o{constructor(g,f){this.list=g,this.defaults=f}append(g){this.list.push((0,n.defaultsDeep)(g,this.defaults))}}},54092:(te,R,e)=>{"use strict";e.d(R,{S:()=>a,u:()=>n});var n=(s=>(s.link="link",s.component="component",s.function="function",s))(n||{}),a=(s=>(s.AlertInstanceAction="grafana/alerting/instance/action",s.AlertingHomePage="grafana/alerting/home",s.AlertingAlertingRuleAction="grafana/alerting/alertingrule/action",s.AlertingRecordingRuleAction="grafana/alerting/recordingrule/action",s.CommandPalette="grafana/commandpalette/action",s.DashboardPanelMenu="grafana/dashboard/panel/menu",s.DataSourceConfig="grafana/datasources/config",s.ExploreToolbarAction="grafana/explore/toolbar/action",s.UserProfileTab="grafana/user/profile/tab",s.TraceViewDetails="grafana/traceview/details",s.QueryEditorRowAdaptiveTelemetryV1="grafana/query-editor-row/adaptivetelemetry/v1",s.TraceViewResourceAttributes="grafana/traceview/resource-attributes",s.LogsViewResourceAttributes="grafana/logsview/resource-attributes",s.AppChrome="grafana/app/chrome/v1",s))(a||{})},29246:(te,R,e)=>{"use strict";e.d(R,{x:()=>a});var n=e(11594);function a(s){return s&&s!==n.Ac.valid&&s!==n.Ac.internal}},46933:(te,R,e)=>{"use strict";e.d(R,{D_:()=>n,Ee:()=>s,FL:()=>a});var n=(i=>(i.Equal="Equal",i.NotEqual="NotEqual",i.EqualRegEx="EqualRegEx",i.NotEqualRegEx="NotEqualRegEx",i))(n||{});const a=i=>!i||typeof i!="object"?!1:"importFromAbstractQueries"in i,s=i=>!i||typeof i!="object"?!1:"exportToAbstractQueries"in i},27164:(te,R,e)=>{"use strict";e.d(R,{Dv:()=>s,RU:()=>n,n9:()=>a});function n(i){return new Set(["equals","not-equals","one-of","not-one-of"]).has(i)}const a={"=":"equals","!=":"not-equals","=~":"regex-match","!~":"regex-not-match","=|":"one-of","!=|":"not-one-of"},s=Object.fromEntries(Object.entries(a).map(([i,r])=>[r,i]))},7389:(te,R,e)=>{"use strict";e.d(R,{CO:()=>n,ZG:()=>a,zL:()=>s});var n=(i=>(i[i.never=0]="never",i[i.onDashboardLoad=1]="onDashboardLoad",i[i.onTimeRangeChanged=2]="onTimeRangeChanged",i))(n||{}),a=(i=>(i[i.disabled=0]="disabled",i[i.alphabeticalAsc=1]="alphabeticalAsc",i[i.alphabeticalDesc=2]="alphabeticalDesc",i[i.numericalAsc=3]="numericalAsc",i[i.numericalDesc=4]="numericalDesc",i[i.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",i[i.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",i[i.naturalAsc=7]="naturalAsc",i[i.naturalDesc=8]="naturalDesc",i))(a||{}),s=(i=>(i[i.dontHide=0]="dontHide",i[i.hideLabel=1]="hideLabel",i[i.hideVariable=2]="hideVariable",i))(s||{})},33553:(te,R,e)=>{"use strict";e.d(R,{O:()=>n});var n=(a=>(a.Absolute="absolute",a.Percentage="percentage",a))(n||{})},79319:(te,R,e)=>{"use strict";e.d(R,{M:()=>n,N:()=>a});var n=(s=>(s[s.NotPossible=-1]="NotPossible",s[s.NotApplicable=0]="NotApplicable",s[s.Applicable=1]="Applicable",s[s.HighlyApplicable=2]="HighlyApplicable",s))(n||{}),a=(s=>(s.True="true",s.False="false",s.Null="null",s.Empty="empty",s.Zero="zero",s))(a||{})},18600:(te,R,e)=>{"use strict";e.d(R,{W:()=>a,d:()=>n});var n=(s=>(s.ValueToText="value",s.RangeToText="range",s.RegexToText="regex",s.SpecialValue="special",s))(n||{}),a=(s=>(s.True="true",s.False="false",s.Null="null",s.NaN="nan",s.NullAndNaN="null+nan",s.Empty="empty",s))(a||{})},48592:(te,R,e)=>{"use strict";e.d(R,{J$:()=>s,Qz:()=>n,ZV:()=>r,f5:()=>i,xi:()=>a});var n=(u=>(u.Legacy="legacy",u.Standard="standard",u.Custom="custom",u.Datasource="datasource",u))(n||{});class a{}class s extends a{getType(){return"standard"}}class i extends a{getType(){return"custom"}}class r extends a{getType(){return"datasource"}}},52205:(te,R,e)=>{"use strict";e.d(R,{bk:()=>o,pv:()=>f,iF:()=>g});var n=e(2543),a=e(38809),s=e(53543),i=e(42954);class r{constructor(){this.properties=[]}addCustomEditor(c){return this.properties.push(c),this}getRegistry(){return new i.O(()=>this.properties)}getItems(){return this.properties}}var u=e(28105);class o extends r{addNumberInput(c){return this.addCustomEditor({...c,id:c.path,override:s.D.get("number").editor,editor:s.D.get("number").editor,process:a.m0,shouldApply:c.shouldApply??(()=>!0),settings:c.settings||{}})}addSliderInput(c){return this.addCustomEditor({...c,id:c.path,override:s.D.get("slider").editor,editor:s.D.get("slider").editor,process:a.m0,shouldApply:c.shouldApply??(()=>!0),settings:c.settings||{}})}addTextInput(c){return this.addCustomEditor({...c,id:c.path,override:s.D.get("text").editor,editor:s.D.get("text").editor,process:a.OU,shouldApply:c.shouldApply??(()=>!0),settings:c.settings||{}})}addSelect(c){return this.addCustomEditor({...c,id:c.path,override:s.D.get("select").editor,editor:s.D.get("select").editor,process:a.hL,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{options:[]}})}addRadio(c){return this.addCustomEditor({...c,id:c.path,override:s.D.get("radio").editor,editor:s.D.get("radio").editor,process:a.hL,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{options:[]}})}addBooleanSwitch(c){return this.addCustomEditor({...c,id:c.path,editor:s.D.get("boolean").editor,override:s.D.get("boolean").editor,process:a.FM,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{}})}addColorPicker(c){return this.addCustomEditor({...c,id:c.path,editor:s.D.get("color").editor,override:s.D.get("color").editor,process:a.hS,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{}})}addUnitPicker(c){return this.addCustomEditor({...c,id:c.path,editor:s.D.get("unit").editor,override:s.D.get("unit").editor,process:a.lG,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{}})}addFieldNamePicker(c){return this.addCustomEditor({...c,id:c.path,editor:s.D.get("field-name").editor,override:s.D.get("field-name").editor,process:a.hS,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{}})}addGenericEditor(c,x){return this.addCustomEditor({...c,id:c.path,editor:x,override:x,process:a.hS,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{}})}}class l{constructor(c){this.cfg=c,this.path="",this.id="nested-panel-options",this.name="nested",this.editor=()=>null,this.getBuilder=()=>this.cfg.build,this.getNestedValueAccess=x=>{const v=this.cfg.values;return v?v(x):{getValue:m=>x.getValue(`${this.path}.${m}`),onChange:(m,y)=>x.onChange(`${this.path}.${m}`,y)}},this.path=c.path,this.category=c.category,this.defaultValue=this.getDefaultValue(c)}getDefaultValue(c){let x=(0,u.Gv)(c.defaultValue)?(0,n.cloneDeep)(c.defaultValue):{};const v=new f;c.build(v,{data:[]});for(const m of v.getItems())m.defaultValue!=null&&(0,n.set)(x,m.path,m.defaultValue);return x}}function g(p){return(0,u.Gv)(p)&&"id"in p&&p.id==="nested-panel-options"}class f extends r{addNestedOptions(c){const x=new l(c);return this.addCustomEditor(x)}addNumberInput(c){return this.addCustomEditor({...c,id:c.path,editor:s.D.get("number").editor})}addSliderInput(c){return this.addCustomEditor({...c,id:c.path,editor:s.D.get("slider").editor})}addTextInput(c){return this.addCustomEditor({...c,id:c.path,editor:s.D.get("text").editor})}addStringArray(c){return this.addCustomEditor({...c,id:c.path,editor:s.D.get("strings").editor})}addSelect(c){return this.addCustomEditor({...c,id:c.path,editor:s.D.get("select").editor})}addMultiSelect(c){return this.addCustomEditor({...c,id:c.path,editor:s.D.get("multi-select").editor})}addRadio(c){return this.addCustomEditor({...c,id:c.path,editor:s.D.get("radio").editor})}addBooleanSwitch(c){return this.addCustomEditor({...c,id:c.path,editor:s.D.get("boolean").editor})}addColorPicker(c){return this.addCustomEditor({...c,id:c.path,editor:s.D.get("color").editor,settings:c.settings||{}})}addTimeZonePicker(c){return this.addCustomEditor({...c,id:c.path,editor:s.D.get("timezone").editor,settings:c.settings||{}})}addUnitPicker(c){return this.addCustomEditor({...c,id:c.path,editor:s.D.get("unit").editor})}addFieldNamePicker(c){return this.addCustomEditor({...c,id:c.path,editor:s.D.get("field-name").editor})}addDashboardPicker(c){return this.addCustomEditor({...c,id:c.path,editor:s.D.get("dashboard-uid").editor})}}},13227:(te,R,e)=>{"use strict";e.d(R,{t:()=>s});var n=e(2543),a=e.n(n);function s(i){return typeof i=="number"?i:i===""||i===null||i===void 0||Array.isArray(i)?NaN:typeof i=="boolean"?i?1:0:(0,n.toNumber)(i)}},46635:(te,R,e)=>{"use strict";e.r(R),e.d(R,{insertAfterImmutably:()=>i,insertBeforeImmutably:()=>s,moveItemImmutably:()=>a,sortValues:()=>o});var n=e(739);function a(l,g,f){const p=[...l];return Array.prototype.splice.call(p,f,0,Array.prototype.splice.call(p,g,1)[0]),p}function s(l,g,f){if(f<0||f>l.length)throw new Error("Index out of bounds");const p=[...l];return p.splice(f,0,g),p}function i(l,g,f){if(f<0||f>l.length)throw new Error("Index out of bounds");const p=[...l];return p.splice(f+1,0,g),p}const r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),u=(l,g)=>l-g;function o(l){return(g,f)=>{if(g===f)return 0;if(f==null||typeof f=="string"&&f.trim()==="")return-1;if(g==null||typeof g=="string"&&g?.trim()==="")return 1;let p=r.compare;return typeof g=="number"&&typeof f=="number"&&(p=u),l===n.xB.Descending?p(f,g):p(g,f)}}},12823:(te,R,e)=>{"use strict";e.d(R,{b:()=>s,k:()=>a});var n=e(42954),a=(i=>(i.Add="+",i.Subtract="-",i.Divide="/",i.Multiply="*",i))(a||{});const s=new n.O(()=>[{id:"+",name:"Add",operation:(i,r)=>i+r,binaryOperationID:"+"},{id:"-",name:"Subtract",operation:(i,r)=>i-r,binaryOperationID:"-"},{id:"*",name:"Multiply",operation:(i,r)=>i*r,binaryOperationID:"*"},{id:"/",name:"Divide",operation:(i,r)=>i/r,binaryOperationID:"/"}])},68125:(te,R,e)=>{"use strict";e.d(R,{F7:()=>f,Jh:()=>p,_O:()=>d,i8:()=>x});var n=e(2543),a=e.n(n),s=e(44809),i=e.n(s),r=e(18700),u=e(41119),o=e(16515),l=e(95004),g=e(55386),f=(E=>(E[E.full=0]="full",E[E.name=1]="name",E[E.none=2]="none",E))(f||{});function p(E,b){return new x(b).readCSV(E)}var c=(E=>(E[E.Starting=0]="Starting",E[E.InHeader=1]="InHeader",E[E.ReadingRows=2]="ReadingRows",E))(c||{});class x{constructor(b){this.chunk=(D,C)=>{for(let P=0;P<D.data.length;P++){const M=D.data[P];if(M.length<1)continue;const O=M[0];if(O){if(O.startsWith("#")){const j=O.indexOf("#",2);if(j>0){const U=O.slice(1,j),W=U==="name";if(W||{unit:"#"}.hasOwnProperty(U)){this.state===2&&(this.current=new r.k({fields:[]}),this.data.push(this.current));const S=O.slice(j+1);if(W){this.current.addFieldFor(void 0,S);for(let _=1;_<M.length;_++)this.current.addFieldFor(void 0,M[_])}else{const{fields:_}=this.current;for(let K=0;K<_.length;K++){_[K].config||(_[K].config={});const T=_[K].config;T[U]=K===0?S:M[K]}}this.state=1;continue}}else if(this.state===0){this.state=1;continue}continue}if(this.state===0){if((0,u.HW)(O)===l.PU.string){for(const U of M)this.current.addFieldFor(void 0,U);this.state=1;continue}this.state=1}}if(this.state,this.state=2,M.length>this.current.fields.length){const{fields:j}=this.current;for(let U=j.length;U<M.length;U++)this.current.addFieldFor(M[U]);this.callback&&this.callback.onHeader(this.current.fields)}this.current.appendRow(M),this.callback&&this.callback.onRow(M)}},b||(b={}),this.config=b.config||{},this.callback=b.callback,this.current=new r.k({fields:[]}),this.state=0,this.data=[]}readCSV(b){this.current=new r.k({fields:[]}),this.data=[this.current];const D={...this.config,dynamicTyping:!1,skipEmptyLines:!0,comments:!1,chunk:this.chunk};return i().parse(b,D),this.data}}function v(E,b){if(E==null)return"";const D=E.toString();return D.includes('"')?b.quoteChar+D.replace(/"/gi,'""')+b.quoteChar:D.includes(`
`)||b.delimiter&&D.includes(b.delimiter)?b.quoteChar+D+b.quoteChar:D}function m(E,b){return E.display?D=>{const C=E.display(D);return v((0,g.cN)(C),b)}:D=>v(D,b)}function y(E,b,D){const C=E==="name",P=E==="type";for(const M of b){const O=M.config;if(C||P||O&&O.hasOwnProperty(E)){let j="#"+E+"#";for(let U=0;U<b.length;U++){U>0&&(j=j+D.delimiter);let W=b[U].name;P?W=b[U].type:C||(W=b[U].config[E]),W&&(j=j+v(W,D))}return j+D.newline}}return""}function h(){const E=["x","y"];return E.toLocaleString?E.toLocaleString().charAt(1):","}function d(E,b){if(!E)return"";b=(0,n.defaults)(b,{delimiter:h(),newline:`\r
`,quoteChar:'"',encoding:"",headerStyle:1,useExcelHeader:!1});let D=b.useExcelHeader?`sep=${b.delimiter}${b.newline}`:"";for(let C=0;C<E.length;C++){const P=E[C],{fields:M}=P;if(M.length===0)continue;if(b.headerStyle===0)D=D+y("name",M,b)+y("type",M,b)+y("unit",M,b)+y("dateFormat",M,b);else if(b.headerStyle===1){for(let j=0;j<M.length;j++)j>0&&(D+=b.delimiter),D+=`"${(0,o.Ct)(M[j],P).replace(/"/g,'""')}"`;D+=b.newline}const O=M[0].values.length;if(O>0){const j=M.map(U=>m(U,b));for(let U=0;U<O;U++){for(let W=0;W<M.length;W++){W>0&&(D+=b.delimiter);let B=M[W].values[U];B!==null&&(M[W].type===l.PU.frame&&"value"in B&&(B=B.value),D+=j[W](B))}U!==O-1&&(D+=b.newline)}}C!==E.length-1&&(D=D+b.newline)}return D}},38036:(te,R,e)=>{"use strict";e.d(R,{c:()=>s,u:()=>i});var n=e(92138),a=e(83175);const s={keepTime:"__url_time_range",timeRangeFrom:"__from",timeRangeTo:"__to",includeVars:"__all_variables",seriesName:"__series.name",fieldName:"__field.name",valueTime:"__value.time",valueNumeric:"__value.numeric",valueText:"__value.text",valueRaw:"__value.raw",valueCalc:"__value.calc"};function i(l){const{onClickFn:g,replaceVariables:f,link:p,scopedVars:c,range:x,field:v,internalLink:m}=l,y=typeof p.internal?.query=="function"?p.internal.query({replaceVariables:f,scopedVars:c}):m.query,h=u(y,c,f),d=u(p.internal?.panelsState,c,f),E=u(p.meta?.correlationData,c,f),b=p.title?p.title:m.datasourceName;return{title:f(b,c),href:r(m.datasourceUid,h,x,d),onClick:g?D=>{D.preventDefault&&D.preventDefault(),g({datasourceUid:m.datasourceUid,queries:[h],panelsState:d,correlationHelperData:E,range:x})}:void 0,target:p?.targetBlank?"_blank":"_self",origin:v}}function r(l,g,f,p){return n.I.assureBaseUrl(`/explore?left=${encodeURIComponent((0,a.Pp)({...f?.raw?{range:(0,a.sQ)(f.raw)}:{},datasource:l,queries:[g],panelsState:p}))}`)}function u(l,g,f){if(!l)return l;if(typeof l=="string")return f(l,g);const p=JSON.parse(JSON.stringify(l));return o(p,g,f)}function o(l,g,f){for(const p of Object.keys(l))typeof l[p]=="string"?l[p]=f(l[p],g):typeof l[p]=="object"&&l[p]!==null&&(l[p]=o(l[p],g,f));return l}},48480:(te,R,e)=>{"use strict";e.d(R,{BD:()=>g,EX:()=>f,Iz:()=>r,PG:()=>o,QP:()=>y,fN:()=>i,lO:()=>v,mn:()=>l,p$:()=>s,pN:()=>x,wY:()=>p,wp:()=>m,yV:()=>c,zX:()=>u});var n=e(2543),a=e.n(n);function s(h){const d={uid:h.uid,type:h.type};return h.apiVersion&&(d.apiVersion=h.apiVersion),d}function i(h){return typeof h=="object"&&typeof h?.uid=="string"}function r(h){if(i(h))return h.uid;if((0,n.isString)(h))return h}const u=(h,d)=>E=>{x(h,d,E.currentTarget.value)},o=(h,d)=>E=>{v(h,d,E.currentTarget.value)},l=(h,d)=>E=>{m(h,d,E.currentTarget.value)},g=(h,d)=>E=>{v(h,d,E.value)},f=(h,d)=>E=>{v(h,d,E.currentTarget.checked)},p=(h,d)=>E=>{m(h,d,E.value)},c=(h,d)=>E=>{y(h,d)};function x(h,d,E){const b=h.options;h.onOptionsChange({...b,[d]:E})}const v=(h,d,E)=>{const b=h.options;h.onOptionsChange({...b,jsonData:{...b.jsonData,[d]:E}})},m=(h,d,E)=>{const b=h.options;h.onOptionsChange({...b,secureJsonData:{...b.secureJsonData?b.secureJsonData:{},[d]:E}})},y=(h,d)=>{const E=h.options;h.onOptionsChange({...E,secureJsonData:{...E.secureJsonData?E.secureJsonData:{},[d]:""},secureJsonFields:{...E.secureJsonFields,[d]:!1}})}},28882:(te,R,e)=>{"use strict";e.d(R,{f:()=>n});var n=(a=>(a[a.Transformations=0]="Transformations",a[a.FieldConfig=1]="FieldConfig",a[a.FieldConfigOverrides=2]="FieldConfigOverrides",a))(n||{})},99885:(te,R,e)=>{"use strict";e.d(R,{X:()=>f});var n=e(84139),a=e(8934);const s=/[^ -~]/m,i=/^[\x21-\x2F\x3A-\x40\x5B-\x60\x7B-\x7E]+$/m,r=5,u=25,o=5,l=1e4,g=new n.A({intraMode:1});function f(p,c){if(c==="")return p.map((x,v)=>v);if(s.test(c)||i.test(c)||c.length>u||g.split(c).length>o){const x=new RegExp((0,a.$f)(c),"i"),v=[];for(let m=0;m<p.length;m++){let y=p[m];x.test(y)&&v.push(m)}return v}else{const[x,v,m]=g.search(p,c,r,l);if(x?.length)return v&&m?m.map(y=>v.idx[y]):x}return[]}},71642:(te,R,e)=>{"use strict";e.d(R,{Xy:()=>a,_p:()=>r,h6:()=>u,s6:()=>i,yO:()=>s});const n=/\b(\w+)(!?=~?)"([^"\n]*?)"/g;function a(o){const l={};return o.replace(n,(g,f,p,c)=>(l[f]=c,"")),l}function s(o){return o.reduce((l,g)=>{if(!g)throw new Error("Need parsed labels to find common labels.");return Object.keys(g).forEach(f=>{(l[f]===void 0||l[f]!==g[f])&&delete l[f]}),Object.keys(l).forEach(f=>{g[f]===void 0&&delete l[f]}),l},{...o[0]})}function i(o,l){const g={...o};return Object.keys(l).forEach(f=>{delete g[f]}),g}function r(o,l){if(!o)return!0;for(const[g,f]of Object.entries(o))if(!l||l[g]!==f)return!1;return!0}function u(o,l="",g){if(!o||Object.keys(o).length===0)return l;const p=Object.keys(o).sort().map(c=>`${c}="${o[c]}"`).join(", ");return g?p:["{",p,"}"].join("")}},428:(te,R,e)=>{"use strict";e.d(R,{j:()=>n});function n(a,s){const i=/\{\{\s*(.+?)\s*\}\}/g;return a.replace(i,(r,u)=>s[u]?s[u]:u)}},92138:(te,R,e)=>{"use strict";e.d(R,{I:()=>p});var n=e(63704),a=e(83175);let s={appSubUrl:""},i,r;const u=c=>{try{return new URL(c)}catch{return}},o=c=>{const x=u(c);if(x&&x.origin!==window.location.origin)return c;const v=s.appSubUrl??"",m=v.endsWith("/")?1:0,y=c.startsWith("http");let h=v;return(!c.startsWith("/")||y)&&(h=`${window.location.origin}${v}`),c.length>0&&(c.indexOf(h+"/")===0||c===h)?c.slice(h.length-m):c},l=c=>c.startsWith("/")?`${s.appSubUrl}${o(c)}`:c,p={initialize:c=>{s=c.config,i=c.getTimeRangeForUrl,r=c.getVariablesUrlParams},stripBaseFromUrl:o,assureBaseUrl:l,updateSearchParams:(c,x)=>{const v=new URLSearchParams(x);try{const m=new URL(c);return v.forEach((y,h)=>m.searchParams.set(h,y)),m.href}catch{const m=new URLSearchParams(c);return v.forEach((y,h)=>{m.set(h,y)}),"?"+m.toString()}},getTimeRangeUrlParams:()=>i?a.kM.toUrlParams(i()):null,getVariablesUrlParams:c=>{if(!r)return null;const x=r(c);return a.kM.toUrlParams(x)},getUrlForPartial:(c,x)=>{const v=a.kM.parseKeyValue(c.search.startsWith("?")?c.search.substring(1):c.search);for(const m in x)x[m]===null||x[m]===void 0?delete v[m]:v[m]=x[m];return l(a.kM.renderUrl(c.pathname,v))},processUrl:c=>s.disableSanitizeHtml?c:n.sQ.sanitizeUrl(c)}},35814:(te,R,e)=>{"use strict";e.d(R,{Y:()=>n});function n(a){return new Proxy(a,{apply(s,i,r){return(typeof Reflect>"u"||!Reflect.construct)&&alert("Browser is too old"),Reflect.construct(s,r,i.constructor)}})}},8134:(te,R,e)=>{"use strict";e.d(R,{_:()=>n});function n(s,i){return i.id===s?!0:a(s)?a(i.id):i.aliasIDs?i.aliasIDs.includes(s):!1}function a(s){return s==="prometheus"?!0:new RegExp("^grafana-[0-9a-z]+prometheus-datasource$").test(s)}},33985:(te,R,e)=>{"use strict";e.d(R,{t:()=>n});const n=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"]},14613:(te,R,e)=>{"use strict";e.d(R,{u:()=>n});var n=(a=>(a.id="id",a.title="title",a.subTitle="subtitle",a.mainStat="mainstat",a.secondaryStat="secondarystat",a.arc="arc__",a.icon="icon",a.color="color",a.source="source",a.target="target",a.detail="detail__",a.nodeRadius="noderadius",a.thickness="thickness",a.highlighted="highlighted",a.strokeDasharray="strokedasharray",a.fixedX="fixedx",a.fixedY="fixedy",a.isInstrumented="isinstrumented",a))(n||{})},79243:(te,R,e)=>{"use strict";e.d(R,{E:()=>a,h:()=>n});function n(s,i=0){if(Number.isInteger(s))return s;let r=10**i,u=s*r*(1+Number.EPSILON);return Math.round(u)/r}function a(s){return((""+s).split(".")[1]||"").length}},3594:(te,R,e)=>{"use strict";e.d(R,{R:()=>a,w:()=>n});const n=s=>Object.keys(s).reduce((i,r)=>(s[r]!==void 0&&(i[r]=s[r]),i),{}),a=s=>typeof s=="object"&&s!==null&&Object.keys(s).length===0},78012:(te,R,e)=>{"use strict";e.d(R,{M:()=>a,i:()=>n});class n{constructor(){this.subscribers=new Map,window.addEventListener("storage",i=>{i.key&&this.notifySubscribers(i.key)})}notifySubscribers(i){const r=this.subscribers.get(i);r&&r.forEach(u=>u())}subscribe(i,r){return this.subscribers.has(i)||this.subscribers.set(i,new Set),this.subscribers.get(i).add(r),()=>{const u=this.subscribers.get(i);u&&(u.delete(r),u.size===0&&this.subscribers.delete(i))}}get(i){return window.localStorage[i]}set(i,r){window.localStorage[i]=r,this.notifySubscribers(i)}getBool(i,r){return r!==void 0&&!this.exists(i)?r:window.localStorage[i]==="true"}getObject(i,r){let u=r;if(this.exists(i)){const o=window.localStorage[i];try{u=JSON.parse(o)}catch(l){console.error(`Error parsing store object: ${i}. Returning default: ${r}. [${l}]`)}}return u}setObject(i,r){let u;try{u=JSON.stringify(r)}catch(o){throw new Error(`Could not stringify object: ${i}. [${o}]`)}try{this.set(i,u)}catch(o){const l=new Error(`Could not save item in localStorage: ${i}. [${o}]`);throw o instanceof Error&&(l.name=o.name),l}return!0}exists(i){return window.localStorage[i]!==void 0}delete(i){window.localStorage.removeItem(i),this.notifySubscribers(i)}}const a=new n},78830:(te,R,e)=>{"use strict";e.d(R,{M:()=>n});function n(a){const s=a?.angular?.detected??a?.angularDetected??!1,i=a?.angularPanelCtrl??!1,r=a.PanelCtrl??a?.ConfigCtrl??!1;if(s||i||r)throw new Error("Angular plugins are not supported")}},48233:(te,R,e)=>{"use strict";e.d(R,{_:()=>a,j:()=>s});var n=e(42954),a=(i=>(i.Abs="abs",i.Exp="exp",i.Ln="ln",i.Round="round",i.Floor="floor",i.Ceil="ceil",i.Percent="percent",i))(a||{});const s=new n.O(()=>[{id:"abs",name:"Absolute value",operation:i=>Math.abs(i),unaryOperationID:"abs"},{id:"exp",name:"Natural exponent",operation:i=>Math.exp(i),unaryOperationID:"exp"},{id:"ln",name:"Natural logarithm",operation:i=>Math.log(i),unaryOperationID:"ln"},{id:"round",name:"Round",operation:i=>Math.round(i),unaryOperationID:"round"},{id:"floor",name:"Floor",operation:i=>Math.floor(i),unaryOperationID:"floor"},{id:"ceil",name:"Ceiling",operation:i=>Math.ceil(i),unaryOperationID:"ceil"},{id:"percent",name:"Percentage",operation:(i,r=1)=>i/(r||1),unaryOperationID:"percent"}])},83175:(te,R,e)=>{"use strict";e.d(R,{Pp:()=>p,kM:()=>f,sQ:()=>c});var n=e(25229);/**
 * @preserve jquery-param (c) 2015 KNOWLEDGECODE | MIT
 */function a(x,v){return v&&Object.keys(v).length>0&&(x+="?"+i(v)),x}function s(x,v){return encodeURIComponent(x).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,v?"%20":"+").replace(/[!'()*]/g,function(m){return"%"+m.charCodeAt(0).toString(16).toUpperCase()})}function i(x,v=!0){const m=[],y=/\[\]$/,h=v?(D,C)=>s(D,C):(D,C)=>encodeURIComponent(D),d=D=>Object.prototype.toString.call(D)==="[object Array]",E=(D,C)=>{C=typeof C=="function"?C():C===null||C===void 0?"":C,m[m.length]=h(D,!0)+"="+h(C,!0)},b=(D,C)=>{let P,M,O;if(D)if(d(C))for(P=0,M=C.length;P<M;P++)y.test(D)?E(D,C[P]):b(D,C[P]);else if(C&&String(C)==="[object Object]")for(O in C)b(D+"["+O+"]",C[O]);else E(D,C);else if(d(C))for(P=0,M=C.length;P<M;P++)E(C[P].name,C[P].value);else for(O in C)b(O,C[O]);return m};return b("",x).join("&")}function r(x){return i(x,!1)}function u(x,v){if(v!=null&&v!==""){const m=x.indexOf("?");m!==-1?x.length-m>1&&(x+="&"):x+="?",x+=v}return x}function o(){const v=window.location.search.substring(1).split("&"),m={};for(const y of v){const h=y.split("=");if(h.length>1){const d=decodeURIComponent(h[0]),E=decodeURIComponent(h[1]);d in m?m[d]=[...m[d],E]:m[d]=[E]}else if(h.length===1){const d=decodeURIComponent(h[0]);m[d]=!0}}return m}function l(x){const v={},m=(x||"").split("&");for(let y of m){let h,d,E;if(y&&(d=y=y.replace(/\+/g,"%20"),h=y.indexOf("="),h!==-1&&(d=y.substring(0,h),E=y.substring(h+1)),d=g(d),d!==void 0)){E=E!==void 0?g(E):!0;let b;typeof E=="string"&&E!==""?b=E==="true"||E==="false"?E==="true":E:b=E,v.hasOwnProperty(d)?Array.isArray(v[d])?v[d].push(E):v[d]=[v[d],isNaN(b)?E:b]:v[d]=isNaN(b)?E:b}}return v}function g(x){try{return decodeURIComponent(x)}catch{return}}const f={renderUrl:a,toUrlParams:i,appendQueryToUrl:u,getUrlSearchParams:o,parseKeyValue:l,serializeParams:r};function p(x,v){return v!==void 0&&console.warn("`compact` parameter is deprecated and will be removed in a future release"),JSON.stringify(x)}const c=x=>{let v=x.from;(0,n.Ar)(v)&&(v=v.valueOf().toString());let m=x.to;return(0,n.Ar)(m)&&(m=m.valueOf().toString()),{from:v,to:m}}},35987:(te,R,e)=>{"use strict";e.d(R,{An:()=>u,Zz:()=>i,bh:()=>o});var n=e(36394),a=e(8934),s=e(18600);function i(g,f){for(const p of g)switch(p.type){case s.d.ValueToText:if(f==null)continue;const c=p.options[f];if(c)return c;break;case s.d.RangeToText:if(f==null)continue;const x=parseFloat(f);if(isNaN(x))continue;const v=p.options.from??-1/0;if(!isNaN(v)&&x<v)continue;const y=p.options.to??1/0;if(!isNaN(y)&&x>y)continue;return p.options.result;case s.d.RegexToText:if(f==null||typeof f!="string")continue;const d=(0,a.dO)(p.options.pattern);if(f.match(d)){const E={...p.options.result};return E.text!=null&&(E.text=f.replace(d,p.options.result.text||"")),E}case s.d.SpecialValue:switch(p.options.match){case s.W.Null:{if(f==null)return p.options.result;break}case s.W.NaN:{if(typeof f=="number"&&isNaN(f))return p.options.result;break}case s.W.NullAndNaN:{if(typeof f=="number"&&isNaN(f)||f==null)return p.options.result;break}case s.W.True:{if(f===!0||f==="true")return p.options.result;break}case s.W.False:{if(f===!1||f==="false")return p.options.result;break}case s.W.Empty:{if(f==="")return p.options.result;break}}}return null}function r(g){return(typeof g=="number"||typeof g=="string"&&g.trim()!=="")&&!isNaN(g)}var u=(g=>(g[g.ValueToText=1]="ValueToText",g[g.RangeToText=2]="RangeToText",g))(u||{});function o(g,f){const p=[];let c=g.mappingType;if(g.mappingType||(g.valueMaps&&g.valueMaps.length?c=1:g.rangeMaps&&g.rangeMaps.length&&(c=2)),c===1)for(let x=0;x<g.valueMaps.length;x++){const v=g.valueMaps[x];p.push(l({...v,id:x,type:s.d.ValueToText},g.fieldConfig?.defaults?.thresholds||f))}else if(c===2)for(let x=0;x<g.rangeMaps.length;x++){const v=g.rangeMaps[x];p.push(l({...v,id:x,type:s.d.RangeToText},g.fieldConfig?.defaults?.thresholds||f))}return p}function l(g,f){const p={type:s.d.ValueToText,options:{}},c=[];let x;const v=parseFloat(g.text);if(f&&!isNaN(v)){const m=(0,n.yQ)(v,f.steps);m&&m.color&&(x=m.color)}switch(g.type){case 1:case s.d.ValueToText:g.value!=null&&(g.value==="null"?c.push({type:s.d.SpecialValue,options:{match:s.W.Null,result:{text:g.text,color:x}}}):p.options[String(g.value)]={text:g.text,color:x});break;case 2:case s.d.RangeToText:g.from==="null"||g.to==="null"?c.push({type:s.d.SpecialValue,options:{match:s.W.Null,result:{text:g.text,color:x}}}):c.push({type:s.d.RangeToText,options:{from:+g.from,to:+g.to,result:{text:g.text,color:x}}});break}return Object.keys(p.options).length>0&&c.unshift(p),c[0]}},94452:(te,R,e)=>{"use strict";e.d(R,{E:()=>a,c:()=>s});const n="__searchFilter",a=i=>i&&typeof i=="string"?i.indexOf(n)!==-1:!1,s=i=>{const{query:r,wildcardChar:u}=i;if(!a(r))return{};let{options:o}=i;return o=o||{searchFilter:""},{__searchFilter:{value:o.searchFilter?`${o.searchFilter}${u}`:`${u}`,text:""}}}},47520:(te,R,e)=>{"use strict";e.d(R,{k:()=>r});var n=e(44240),a=e(39697),s=e(65961),i=e(67791);function r({whileLoading:u,source:o}){return(0,n.h)((0,a.O)(200).pipe((0,s.u)(u),(0,i.Q)(o)),o)}},94777:(te,R,e)=>{"use strict";e.d(R,{$:()=>a});var n=e(96453);class a extends n.F{constructor(i){return super(),this.buffer=i.buffer||[],this.capacity=this.buffer.length,this.tail=i.append!=="head",this.index=0,this.add=this.getAddFunction(),i.capacity&&this.setCapacity(i.capacity),new Proxy(this,{get(r,u,o){if(typeof u!="symbol"){const l=+u;if(String(l)===u)return r.get(l)}return Reflect.get(r,u,o)},set(r,u,o,l){if(typeof u!="symbol"){const g=+u;if(String(g)===u)return r.set(g,o),!0}return Reflect.set(r,u,o,l)}})}getAddFunction(){return this.capacity>this.buffer.length?this.tail?i=>{this.buffer.push(i),this.buffer.length>=this.capacity&&(this.add=this.getAddFunction())}:i=>{this.buffer.unshift(i),this.buffer.length>=this.capacity&&(this.add=this.getAddFunction())}:this.tail?i=>{this.buffer[this.index]=i,this.index=(this.index+1)%this.buffer.length}:i=>{let r=this.index-1;r<0&&(r=this.buffer.length-1),this.buffer[r]=i,this.index=r}}setCapacity(i){if(this.capacity===i)return;const r=this.toArray();if(i>this.length)this.buffer=r;else if(i<this.capacity){const u=this.length-i;this.tail?this.buffer=r.slice(u,r.length):this.buffer=r.slice(0,r.length-u)}this.capacity=i,this.index=0,this.add=this.getAddFunction()}setAppendMode(i){const r=i!=="head";r!==this.tail&&(this.buffer=this.toArray().reverse(),this.index=0,this.tail=r,this.add=this.getAddFunction())}reverse(){return this.buffer.reverse()}get(i){return this.buffer[(i+this.index)%this.buffer.length]}set(i,r){this.buffer[(i+this.index)%this.buffer.length]=r}get length(){return this.buffer.length}}},96453:(te,R,e)=>{"use strict";e.d(R,{E:()=>r,F:()=>s});var n,a;class s{constructor(){this[n]={}}*iterator(){for(let o=0;o<this.length;o++)yield this.get(o)}set(o,l){throw"unsupported operation"}add(o){throw"unsupported operation"}push(...o){for(const l of o)this.add(l);return this.length}[(a=Symbol.iterator,n=Symbol.unscopables,a)](){return this.iterator()}forEach(o){return r(this).forEach(o)}map(o){return r(this).map(o)}filter(o){return r(this).filter(o)}at(o){return this.get(o)}toArray(){const o=new Array(this.length);for(let l=0;l<this.length;l++)o[l]=this.get(l);return o}join(o){return this.toArray().join(o)}toJSON(){return this.toArray()}pop(){throw new Error("Method not implemented.")}concat(...o){throw new Error("Method not implemented.")}reverse(){throw new Error("Method not implemented.")}shift(){throw new Error("Method not implemented.")}sort(o){throw new Error("Method not implemented.")}splice(o,l,...g){throw new Error("Method not implemented.")}unshift(...o){throw new Error("Method not implemented.")}fill(o,l,g){throw new Error("Method not implemented.")}copyWithin(o,l,g){throw new Error("Method not implemented.")}slice(o,l){return this.toArray().slice(o,l)}indexOf(o,l){return this.toArray().indexOf(o,l)}lastIndexOf(o,l){return this.toArray().lastIndexOf(o,l)}every(o,l){return this.toArray().every(o,l)}some(o,l){return this.toArray().some(o,l)}reduce(o,l){throw new Error("Method not implemented.")}reduceRight(o,l){throw new Error("Method not implemented.")}find(o,l){return this.toArray().find(o,l)}findIndex(o,l){return this.toArray().findIndex(o,l)}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.toArray().values()}includes(o,l){return this.toArray().includes(o,l)}flatMap(o,l){return this.toArray().flatMap(o,l)}flat(o){throw new Error("Method not implemented.")}}const i=[];function r(u){return{*[Symbol.iterator](){for(let o=0;o<u.length;o++)yield u.get(o)},forEach(o){for(let l=0;l<u.length;l++)o(u.get(l),l,i)},map(o){const l=[];for(let g=0;g<u.length;g++)l.push(o(u.get(g),g,i));return l},filter(o){const l=[];let g=0;for(const f of this)o(f,g++,i)&&l.push(f);return l}}}},34734:(te,R,e)=>{"use strict";e.d(R,{B9:()=>r,OP:()=>n,RT:()=>l,SM:()=>c,Sd:()=>o,_N:()=>f,bS:()=>d,fP:()=>x,fo:()=>i,gs:()=>y,h2:()=>h,k1:()=>s,mk:()=>p,o6:()=>a,qb:()=>g,uZ:()=>v,v9:()=>u,vk:()=>m});const n=1e4,a=1e3,s=30,i=25,r="grafana.datasources.prometheus.browser.labels",u=/^$|^\d+(ms|[Mwdhmsy])$/,o=/(\d+)(.+)/,l=/^(0|[1-9]\d*)(\.\d+)?(e\+?\d+)?$/,g="{}",f=4e4,p='{__name__!=""}',c="__name__",x="Value is not valid, you can use number with time unit specifier: y, M, w, d, h, m, s",v="Value is not valid, you can use non-negative integers, including scientific notation",m="Value is not valid, you can use only numbers or leave it empty to use default limit or set 0 to have no limit.",y="-Instant",h=["api/v1/query","api/v1/query_range","api/v1/series","api/v1/labels","suggestions"],d="none"},35748:(te,R,e)=>{"use strict";e.d(R,{AW:()=>u,Ay:()=>g,n6:()=>l});const n=[{label:"$__interval",sortValue:"$__interval"},{label:"$__rate_interval",sortValue:"$__rate_interval"},{label:"$__range",sortValue:"$__range"},{label:"1m",sortValue:"00:01:00"},{label:"5m",sortValue:"00:05:00"},{label:"10m",sortValue:"00:10:00"},{label:"30m",sortValue:"00:30:00"},{label:"1h",sortValue:"01:00:00"},{label:"1d",sortValue:"24:00:00"}],a=["by","group_left","group_right","ignoring","on","offset","without"],s=null,i=[{label:"acos",insertText:"acos",detail:"acos(v instant-vector)",documentation:"calculates the arccosine of all elements in v"},{label:"acosh",insertText:"acosh",detail:"acosh(v instant-vector)",documentation:"calculates the inverse hyperbolic cosine of all elements in v"},{label:"asin",insertText:"asin",detail:"asin(v instant-vector)",documentation:"calculates the arcsine of all elements in v"},{label:"asinh",insertText:"asinh",detail:"asinh(v instant-vector)",documentation:"calculates the inverse hyperbolic sine of all elements in v"},{label:"atan",insertText:"atan",detail:"atan(v instant-vector)",documentation:"calculates the arctangent of all elements in v"},{label:"atanh",insertText:"atanh",detail:"atanh(v instant-vector)",documentation:"calculates the inverse hyperbolic tangent of all elements in v"},{label:"cos",insertText:"cos",detail:"cos(v instant-vector)",documentation:"calculates the cosine of all elements in v"},{label:"cosh",insertText:"cosh",detail:"cosh(v instant-vector)",documentation:"calculates the hyperbolic cosine of all elements in v"},{label:"sin",insertText:"sin",detail:"sin(v instant-vector)",documentation:"calculates the sine of all elements in v"},{label:"sinh",insertText:"sinh",detail:"sinh(v instant-vector)",documentation:"calculates the hyperbolic sine of all elements in v"},{label:"tan",insertText:"tan",detail:"tan(v instant-vector)",documentation:"calculates the tangent of all elements in v"},{label:"tanh",insertText:"tanh",detail:"tanh(v instant-vector)",documentation:"calculates the hyperbolic tangent of all elements in v"}],u=[...[{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"group",insertText:"group",documentation:"All values in the resulting vector are 1"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"count_values",insertText:"count_values",documentation:"Count number of elements with the same value"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"},{label:"quantile",insertText:"quantile",documentation:"Calculate \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) over dimensions"}],...i,{insertText:"abs",label:"abs",detail:"abs(v instant-vector)",documentation:"Returns the input vector with all sample values converted to their absolute value."},{insertText:"absent",label:"absent",detail:"absent(v instant-vector)",documentation:"Returns an empty vector if the vector passed to it has any elements and a 1-element vector with the value 1 if the vector passed to it has no elements. This is useful for alerting on when no time series exist for a given metric name and label combination."},{insertText:"absent_over_time",label:"absent_over_time",detail:"absent(v range-vector)",documentation:"Returns an empty vector if the range vector passed to it has any elements and a 1-element vector with the value 1 if the range vector passed to it has no elements."},{insertText:"ceil",label:"ceil",detail:"ceil(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` up to the nearest integer."},{insertText:"changes",label:"changes",detail:"changes(v range-vector)",documentation:"For each input time series, `changes(v range-vector)` returns the number of times its value has changed within the provided time range as an instant vector."},{insertText:"clamp",label:"clamp",detail:"clamp(v instant-vector, min scalar, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min` and an upper limit of `max`."},{insertText:"clamp_max",label:"clamp_max",detail:"clamp_max(v instant-vector, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have an upper limit of `max`."},{insertText:"clamp_min",label:"clamp_min",detail:"clamp_min(v instant-vector, min scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min`."},{insertText:"count_scalar",label:"count_scalar",detail:"count_scalar(v instant-vector)",documentation:"Returns the number of elements in a time series vector as a scalar. This is in contrast to the `count()` aggregation operator, which always returns a vector (an empty one if the input vector is empty) and allows grouping by labels via a `by` clause."},{insertText:"deg",label:"deg",detail:"deg(v instant-vector)",documentation:"Converts radians to degrees for all elements in v"},{insertText:"day_of_month",label:"day_of_month",detail:"day_of_month(v=vector(time()) instant-vector)",documentation:"Returns the day of the month for each of the given times in UTC. Returned values are from 1 to 31."},{insertText:"day_of_week",label:"day_of_week",detail:"day_of_week(v=vector(time()) instant-vector)",documentation:"Returns the day of the week for each of the given times in UTC. Returned values are from 0 to 6, where 0 means Sunday etc."},{insertText:"day_of_year",label:"day_of_year",detail:"day_of_year(v=vector(time()) instant-vector)",documentation:"Returns the day of the year for each of the given times in UTC. Returned values are from 1 to 365 for non-leap years, and 1 to 366 in leap years."},{insertText:"days_in_month",label:"days_in_month",detail:"days_in_month(v=vector(time()) instant-vector)",documentation:"Returns number of days in the month for each of the given times in UTC. Returned values are from 28 to 31."},{insertText:"delta",label:"delta",detail:"delta(v range-vector)",documentation:"Calculates the difference between the first and last value of each time series element in a range vector `v`, returning an instant vector with the given deltas and equivalent labels. The delta is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if the sample values are all integers."},{insertText:"deriv",label:"deriv",detail:"deriv(v range-vector)",documentation:"Calculates the per-second derivative of the time series in a range vector `v`, using simple linear regression."},{insertText:"double_exponential_smoothing",label:"double_exponential_smoothing",detail:"double_exponential_smoothing(v range-vector, sf scalar, tf scalar)",documentation:"Produces a smoothed value for time series based on the range in `v`. The lower the smoothing factor `sf`, the more importance is given to old data. The higher the trend factor `tf`, the more trends in the data is considered. Both `sf` and `tf` must be between 0 and 1."},{insertText:"drop_common_labels",label:"drop_common_labels",detail:"drop_common_labels(instant-vector)",documentation:"Drops all labels that have the same name and value across all series in the input vector."},{insertText:"exp",label:"exp",detail:"exp(v instant-vector)",documentation:"Calculates the exponential function for all elements in `v`.\nSpecial cases are:\n* `Exp(+Inf) = +Inf` \n* `Exp(NaN) = NaN`"},{insertText:"floor",label:"floor",detail:"floor(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` down to the nearest integer."},{insertText:"histogram_quantile",label:"histogram_quantile",detail:"histogram_quantile(\u03C6 float, b instant-vector)",documentation:"Calculates the \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) from the buckets `b` of a histogram. The samples in `b` are the counts of observations in each bucket. Each sample must have a label `le` where the label value denotes the inclusive upper bound of the bucket. (Samples without such a label are silently ignored.) The histogram metric type automatically provides time series with the `_bucket` suffix and the appropriate labels."},{insertText:"holt_winters",label:"holt_winters",detail:"holt_winters(v range-vector, sf scalar, tf scalar)",documentation:"Renamed as double_exponential_smoothing in prometheus v3.x. For prometheus versions equal and greater than v3.0 please use double_exponential_smoothing. \n\nProduces a smoothed value for time series based on the range in `v`. The lower the smoothing factor `sf`, the more importance is given to old data. The higher the trend factor `tf`, the more trends in the data is considered. Both `sf` and `tf` must be between 0 and 1."},{insertText:"hour",label:"hour",detail:"hour(v=vector(time()) instant-vector)",documentation:"Returns the hour of the day for each of the given times in UTC. Returned values are from 0 to 23."},{insertText:"idelta",label:"idelta",detail:"idelta(v range-vector)",documentation:"Calculates the difference between the last two samples in the range vector `v`, returning an instant vector with the given deltas and equivalent labels."},{insertText:"increase",label:"increase",detail:"increase(v range-vector)",documentation:"Calculates the increase in the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. The increase is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if a counter increases only by integer increments."},{insertText:"info",label:"info",detail:"info(v instant-vector, [data-label-selector instant-vector])",documentation:"Returns latest details and metadata about a group of metrics, such as their labels and current values, without doing any calculations"},{insertText:"irate",label:"irate",detail:"irate(v range-vector)",documentation:"Calculates the per-second instant rate of increase of the time series in the range vector. This is based on the last two data points. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for."},{insertText:"label_join",label:"label_join",detail:"label_join(v instant-vector, dst_label string, separator string, src_label_1 string, src_label_2 string, ...)",documentation:"For each timeseries in `v`, joins all the values of all the `src_labels` using `separator` and returns the timeseries with the label `dst_label` containing the joined value. There can be any number of `src_labels` in this function."},{insertText:"label_replace",label:"label_replace",detail:"label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)",documentation:"For each timeseries in `v`, `label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)`  matches the regular expression `regex` against the label `src_label`.  If it matches, then the timeseries is returned with the label `dst_label` replaced by the expansion of `replacement`. `$1` is replaced with the first matching subgroup, `$2` with the second etc. If the regular expression doesn't match then the timeseries is returned unchanged."},{insertText:"ln",label:"ln",detail:"ln(v instant-vector)",documentation:"Calculates the natural logarithm for all elements in `v`.\nSpecial cases are:\n * `ln(+Inf) = +Inf`\n * `ln(0) = -Inf`\n * `ln(x < 0) = NaN`\n * `ln(NaN) = NaN`"},{insertText:"log2",label:"log2",detail:"log2(v instant-vector)",documentation:"Calculates the binary logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"log10",label:"log10",detail:"log10(v instant-vector)",documentation:"Calculates the decimal logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"minute",label:"minute",detail:"minute(v=vector(time()) instant-vector)",documentation:"Returns the minute of the hour for each of the given times in UTC. Returned values are from 0 to 59."},{insertText:"month",label:"month",detail:"month(v=vector(time()) instant-vector)",documentation:"Returns the month of the year for each of the given times in UTC. Returned values are from 1 to 12, where 1 means January etc."},{insertText:"pi",label:"pi",detail:"pi()",documentation:"Returns pi"},{insertText:"predict_linear",label:"predict_linear",detail:"predict_linear(v range-vector, t scalar)",documentation:"Predicts the value of time series `t` seconds from now, based on the range vector `v`, using simple linear regression."},{insertText:"rad",label:"rad",detail:"rad(v instant-vector)",documentation:"Converts degrees to radians for all elements in v"},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the per-second average rate of increase of the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. Also, the calculation extrapolates to the ends of the time range, allowing for missed scrapes or imperfect alignment of scrape cycles with the range's time period."},{insertText:"resets",label:"resets",detail:"resets(v range-vector)",documentation:"For each input time series, `resets(v range-vector)` returns the number of counter resets within the provided time range as an instant vector. Any decrease in the value between two consecutive samples is interpreted as a counter reset."},{insertText:"round",label:"round",detail:"round(v instant-vector, to_nearest=1 scalar)",documentation:"Rounds the sample values of all elements in `v` to the nearest integer. Ties are resolved by rounding up. The optional `to_nearest` argument allows specifying the nearest multiple to which the sample values should be rounded. This multiple may also be a fraction."},{insertText:"scalar",label:"scalar",detail:"scalar(v instant-vector)",documentation:"Given a single-element input vector, `scalar(v instant-vector)` returns the sample value of that single element as a scalar. If the input vector does not have exactly one element, `scalar` will return `NaN`."},{insertText:"sgn",label:"sgn",detail:"sgn(v instant-vector)",documentation:"Returns a vector with all sample values converted to their sign, defined as this: 1 if v is positive, -1 if v is negative and 0 if v is equal to zero."},{insertText:"sort",label:"sort",detail:"sort(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in ascending order."},{insertText:"sort_desc",label:"sort_desc",detail:"sort_desc(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in descending order."},{insertText:"sqrt",label:"sqrt",detail:"sqrt(v instant-vector)",documentation:"Calculates the square root of all elements in `v`."},{insertText:"time",label:"time",detail:"time()",documentation:"Returns the number of seconds since January 1, 1970 UTC. Note that this does not actually return the current time, but the time at which the expression is to be evaluated."},{insertText:"timestamp",label:"timestamp",detail:"timestamp(v instant-vector)",documentation:"Returns the timestamp of each of the samples of the given vector as the number of seconds since January 1, 1970 UTC."},{insertText:"vector",label:"vector",detail:"vector(s scalar)",documentation:"Returns the scalar `s` as a vector with no labels."},{insertText:"year",label:"year",detail:"year(v=vector(time()) instant-vector)",documentation:"Returns the year for each of the given times in UTC."},{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average value of all points in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum value of all points in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum value of all points in the specified interval."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The most recent point value in specified interval."},{insertText:"present_over_time",label:"present_over_time",detail:"present_over_time(range-vector)",documentation:"The value 1 for any series in the specified interval."},{insertText:"histogram_avg",label:"histogram_avg",detail:"histogram_avg(v instant-vector)",documentation:"Returns the arithmetic average of observed values stored in a native histogram. Samples that are not native histograms are ignored and do not show up in the returned vector."},{insertText:"histogram_count",label:"histogram_count",detail:"histogram_count(v instant-vector)",documentation:"Returns the count of observations stored in a native histogram."},{insertText:"histogram_sum",label:"histogram_sum",detail:"histogram_sum(v instant-vector)",documentation:"Returns the sum of observations stored in a native histogram."},{insertText:"histogram_fraction",label:"histogram_fraction",detail:"histogram_fraction(lower scalar, upper scalar, v instant-vector)",documentation:"Returns the estimated fraction of observations between the provided lower and upper values."},{insertText:"histogram_stddev",label:"histogram_stddev",detail:"histogram_stddev(v instant-vector)",documentation:"Returns the estimated standard deviation of observations in a native histogram, based on the geometric mean of the buckets where the observations lie."},{insertText:"histogram_stdvar",label:"histogram_stdvar",detail:"histogram_stdvar(v instant-vector)",documentation:"Returns the estimated standard variance of observations in a native histogram."}],o=u.map(f=>f.label),l={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((by|without)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},function:new RegExp(`\\b(?:${u.map(f=>f.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],idList:{pattern:/\d+(\|\d+)+/,alias:"number"},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:new RegExp(`/[-+*/=%^~]|&&?|\\|?\\||!=?|<(?:=>?|<|>)?|>[>=]?|\\b(?:${a.join("|")})\\b`,"i"),punctuation:/[{};()`,.]/},g=l},31200:(te,R,e)=>{"use strict";e.d(R,{$H:()=>a,Nc:()=>n,Rq:()=>s,p0:()=>u});const n=o=>o===""||s(o)?o:`"${o}"`,a=o=>{if(s(o))return o;let g="U__";for(let f=0;f<o.length;f++){const p=o[f],c=o.codePointAt(f);p==="_"?g+="__":c!==void 0&&i(p,f)?g+=p:c===void 0||!r(c)?g+="_FFFD_":(g+="_",g+=c.toString(16),g+="_"),c!==void 0&&c>65535&&f++}return g},s=o=>{if(o.length===0)return!1;for(let l=0;l<o.length;l++){const g=o[l];if(!i(g,l))return!1}return!0},i=(o,l)=>{const g=o.codePointAt(0);return g===void 0?!1:g>=97&&g<=122||g>=65&&g<=90||g===95||g===58||g>=48&&g<=57&&l>0},r=o=>o>=0&&o<=1114111,u=o=>{const l=[],g=/(=~|!=|!~|=)/;let f="",p="",c=!1,x="";const v=()=>{const m=x.match(g);if(m){const y=m[0];[f,p]=x.split(y),l.push(`${n(f.trim())}${y}"${p.slice(1,-1)}"`)}};for(const m of o)m==='"'&&x[x.length-1]!=="\\"?(c=!c,x+=m):m===","&&!c?(v(),x=""):x+=m;return x&&v(),l.join(",")}},61190:(te,R,e)=>{"use strict";e.d(R,{L:()=>a,y:()=>s});var n=e(43173);function a(i){return{grafana_version:n.$.buildInfo.version,plugin_type:String(i.type),plugin_version:i.info.version,plugin_id:i.id,plugin_name:i.name}}function s(i){return{...a(i.meta),datasource_uid:i.uid}}},77010:(te,R,e)=>{"use strict";e.d(R,{G:()=>o});var n=e(96540),a=e(31595),s=e(17564),i=e(27489),r=e(61190);const u="grafana_plugin_";function o(){const g=(0,a.Q)();return(0,n.useMemo)(()=>{if(!g)throw new Error("No PluginContext found. The usePluginInteractionReporter() hook can only be used from a plugin.");const f=(0,s.S)(g)?(0,r.y)(g.instanceSettings):(0,r.L)(g.meta);return(p,c)=>{if(!l(p))throw new Error(`Interactions reported in plugins should start with: "${u}".`);return(0,i.rR)(p,{...c,...f})}},[g])}function l(g){return g.startsWith(u)&&g.length>u.length}},33749:(te,R,e)=>{"use strict";e.d(R,{fX:()=>s,nB:()=>a,n_:()=>n,p6:()=>i});var n=(r=>(r.DashboardView="dashboard-view",r.DataRequest="data-request",r))(n||{});const a=r=>!!r.payload.page,s=r=>!!r.payload.interactionName,i=r=>!!r.payload.experimentId},27489:(te,R,e)=>{"use strict";e.d(R,{G$:()=>i,Jy:()=>r,Xp:()=>o,rR:()=>u});var n=e(43173),a=e(36490),s=e(78646);const i=l=>{(0,s.x$)().addEvent({type:s.on.MetaAnalytics,payload:l})},r=()=>{const l=a.Ny.getLocation(),g=`${n.$.appSubUrl??""}${l.pathname}${l.search}${l.hash}`;(0,s.x$)().addEvent({type:s.on.Pageview,payload:{page:g}})},u=(l,g)=>{n.$.reportingStaticContext&&n.$.reportingStaticContext instanceof Object&&(g={...g,...n.$.reportingStaticContext}),(0,s.x$)().addEvent({type:s.on.Interaction,payload:{interactionName:l,properties:g}})},o=(l,g,f)=>{(0,s.x$)().addEvent({type:s.on.ExperimentView,payload:{experimentId:l,experimentGroup:g,experimentVariant:f}})}},80839:(te,R,e)=>{"use strict";e.d(R,{s:()=>p});var n=e(74848),a=e(96540),s=e(48480),i=e(29246),r=e(51898),u=e(18857),o=e(41654),l=e(63509),g=e(78282),f=e(36580);class p extends a.PureComponent{constructor(x){super(x),this.dataSourceSrv=(0,g.l)(),this.state={},this.onChange=(v,m)=>{if(m.action==="clear"&&this.props.onClear){this.props.onClear();return}const y=this.dataSourceSrv.getInstanceSettings(v.value);y&&(this.props.onChange(y),this.setState({error:void 0}))}}static{this.defaultProps={autoFocus:!1,openMenuOnFocus:!1,placeholder:"Select data source"}}componentDidMount(){const{current:x}=this.props;this.dataSourceSrv.getInstanceSettings(x)||this.setState({error:"Could not find data source "+x})}getCurrentValue(){const{current:x,hideTextValue:v,noDefault:m}=this.props;if(!x&&m)return;const y=this.dataSourceSrv.getInstanceSettings(x);if(y)return{label:y.name.slice(0,37),value:y.uid,imgUrl:y.meta.info.logos.small,hideText:v,meta:y.meta};const h=(0,s.Iz)(x);return h===f.dR.uid||h===f.dR.name?{label:h,value:h,hideText:v}:{label:(h??"no name")+" - not found",value:h??void 0,imgUrl:"",hideText:v}}getDataSourceOptions(){const{alerting:x,tracing:v,metrics:m,mixed:y,dashboard:h,variables:d,annotations:E,pluginId:b,type:D,filter:C,logs:P}=this.props;return this.dataSourceSrv.getList({alerting:x,tracing:v,metrics:m,logs:P,dashboard:h,mixed:y,variables:d,annotations:E,pluginId:b,filter:C,type:D}).map(O=>({value:O.name,label:`${O.name}${O.isDefault?" (default)":""}`,imgUrl:O.meta.info.logos.small,meta:O.meta}))}render(){const{autoFocus:x,onBlur:v,onClear:m,openMenuOnFocus:y,placeholder:h,width:d,inputId:E,disabled:b=!1,isLoading:D=!1}=this.props,{error:C}=this.state,P=this.getDataSourceOptions(),M=this.getCurrentValue(),O=typeof m=="function";return(0,n.jsx)("div",{"aria-label":"Data source picker select container","data-testid":r.Tp.components.DataSourcePicker.container,children:(0,n.jsx)(u.l6,{isLoading:D,disabled:b,"aria-label":"Select a data source","data-testid":r.Tp.components.DataSourcePicker.inputV2,inputId:E||"data-source-picker",className:"ds-picker select-container",isMulti:!1,isClearable:O,backspaceRemovesValue:!1,onChange:this.onChange,options:P,autoFocus:x,onBlur:v,width:d,openMenuOnFocus:y,maxMenuHeight:500,placeholder:h,noOptionsMessage:"No datasources found",value:M??null,invalid:!!C||!!this.props.invalid,getOptionLabel:j=>j.meta&&(0,i.x)(j.meta.signature)&&j!==M?(0,n.jsxs)(o.B,{alignItems:"center",justifyContent:"space-between",children:[(0,n.jsx)("span",{children:j.label})," ",(0,n.jsx)(l.B,{status:j.meta.signature})]}):j.label||""})})}}},43122:(te,R,e)=>{"use strict";e.d(R,{f:()=>n,p:()=>a});let n=()=>{throw new Error("EmbeddedDashboard requires runtime initialization")};function a(s){n=s}},47700:(te,R,e)=>{"use strict";e.d(R,{N:()=>s,d:()=>i});var n=e(74848);let a;function s(r){a=r}function i(r){return a?(0,n.jsx)(a,{...r}):null}},14477:(te,R,e)=>{"use strict";e.d(R,{a:()=>a,e:()=>s});var n=e(74848);let a=({message:i})=>(0,n.jsxs)("div",{children:["Unable to render data: ",i,"."]});function s(i){a=i}},60311:(te,R,e)=>{"use strict";e.d(R,{Y:()=>s,m:()=>a});var n=e(74848);let a=()=>(0,n.jsx)("div",{children:"PanelRenderer can only be used after Grafana instance has been started."});function s(i){a=i}},88806:(te,R,e)=>{"use strict";e.d(R,{V:()=>a,l:()=>s});var n=e(74848);let a=({children:i})=>(0,n.jsx)("div",{children:i});function s(i){a=i}},25076:(te,R,e)=>{"use strict";e.d(R,{l:()=>a,r:()=>s});let n;function a(i){n=i}function s(){return n}},78646:(te,R,e)=>{"use strict";e.d(R,{H2:()=>s,c_:()=>u,on:()=>n,pl:()=>r,x$:()=>i});var n=(o=>(o.Performance="performance",o.MetaAnalytics="meta-analytics",o.Pageview="pageview",o.Interaction="interaction",o.ExperimentView="experimentview",o.GrafanaJavascriptAgent="grafana-javascript-agent",o))(n||{});let a;function s(o){if(a instanceof u)for(const l of a.buffer)o.addEvent(l.event,l.meta);a=o}function i(){return a||(a=new u),a}const r=o=>{i().addBackend(o)};class u{constructor(){this.buffer=[]}flush(){this.buffer=[]}addBackend(l){}addEvent(l,g){this.buffer.push({event:l,meta:g})}}},36490:(te,R,e)=>{"use strict";e.d(R,{K9:()=>f,Lc:()=>m,Ny:()=>c,SE:()=>p,_K:()=>d,at:()=>h,vG:()=>x});var n=e(74848),a=e(53554),s=e(96540),i=e(49426),r=e(83175),u=e(37615),o=e(60379),l=e(20720),g=e(43173);class f{constructor(b){this.history=b||a.zR({basename:g.$.appSubUrl??"/"}),this.locationObservable=new i.t(this.history.location),this.history.listen(D=>{this.locationObservable.next(D)}),this.partial=this.partial.bind(this),this.push=this.push.bind(this),this.replace=this.replace.bind(this),this.getSearch=this.getSearch.bind(this),this.getHistory=this.getHistory.bind(this),this.getLocation=this.getLocation.bind(this)}getLocationObservable(){return this.locationObservable.asObservable()}getHistory(){return this.history}getSearch(){return new URLSearchParams(this.history.location.search)}partial(b,D){const C=this.history.location,P=this.getSearchObject();for(const O in b)b[O]===null||b[O]===void 0?delete P[O]:P[O]=b[O];const M=r.kM.renderUrl(C.pathname,P);D?this.history.replace(M,this.history.location.state):this.history.push(M,this.history.location.state)}push(b){this.history.push(b)}replace(b){this.history.replace(b)}reload(){const b=this.history.location.state?.routeReloadCounter;this.history.replace({...this.history.location,state:{routeReloadCounter:b?b+1:1}})}getLocation(){return this.history.location}getSearchObject(){return p(this.history.location.search)}update(b){if((0,u.l)("LocationSrv","update","partial, push or replace"),b.partial&&b.query)this.partial(b.query,b.partial);else{const D={pathname:b.path};b.query&&(D.search=r.kM.toUrlParams(b.query)),b.replace?this.replace(D):this.push(D)}}}function p(E){let b=typeof E=="number"?String(E):E;return b.length>0?b.startsWith("?")?r.kM.parseKeyValue(b.substring(1)):r.kM.parseKeyValue(b):{}}let c=new f;const x=E=>{throw new Error("locationService can be only overriden in test environment")},v=(0,o.h)("Router"),m=v.logger;(0,l.h)("location",c,v);const y=s.createContext(void 0);function h(){const E=(0,s.useContext)(y);if(!E)throw new Error("useLocationService must be used within a LocationServiceProvider");return E}const d=({service:E,children:b})=>(0,n.jsx)(y.Provider,{value:E,children:b})},48072:(te,R,e)=>{"use strict";e.d(R,{T:()=>a,X:()=>s});let n;function a(i){n=i}function s(){return n}},83734:(te,R,e)=>{"use strict";e.d(R,{HC:()=>a,XJ:()=>u,d:()=>s,pC:()=>r});let n;const a=o=>{if(n)throw new Error("Runner should only be set when Grafana is starting.");n=o},s=()=>{if(!n)throw new Error("`createQueryRunner` can only be used after Grafana instance has started.");return n()};let i;function r(o){if(i)throw new Error("runRequest function should only be set once, when Grafana is starting.");i=o}function u(){if(!i)throw new Error("getRunRequest can only be used after Grafana instance has started.");return i}},69896:(te,R,e)=>{"use strict";e.d(R,{b:()=>r,j:()=>i});var n=e(96540),a=e(24120),s=e(88483);const i=(0,n.createContext)(void 0);function r(){const u=(0,n.useContext)(i);return(0,a.A)(u?.stateObservable??new s.c,u?.state),(0,n.useMemo)(()=>u?{state:u.state,stateObservable:u.stateObservable,changeScopes:u.changeScopes,setReadOnly:u.setReadOnly,setEnabled:u.setEnabled}:void 0,[u,u?.state])}},78282:(te,R,e)=>{"use strict";e.d(R,{h:()=>a,l:()=>s});let n;function a(i){n=i}function s(){return n}},33184:(te,R,e)=>{"use strict";e.d(R,{Kh:()=>n.Kh,S8:()=>s,oF:()=>i});var n=e(51388);let a;const s=r=>{a=r},i=()=>a},2874:(te,R,e)=>{"use strict";e.d(R,{h:()=>a,z:()=>s});let n;function a(i){if(n)throw new Error("setGetObservablePluginComponents() function should only be called once, when Grafana is starting.");n=i}function s(i){if(!n)throw new Error("getObservablePluginComponents() can only be used after the Grafana instance has started.");return n(i)}},58873:(te,R,e)=>{"use strict";e.d(R,{C:()=>a,m:()=>s});let n;function a(i){if(n)throw new Error("setGetObservablePluginLinks() function should only be called once, when Grafana is starting.");n=i}function s(i){if(!n)throw new Error("getObservablePluginLinks() can only be used after the Grafana instance has started.");return n(i)}},33005:(te,R,e)=>{"use strict";e.d(R,{A:()=>a,S:()=>s});let n;function a(i){if(n)throw new Error("setPluginComponentHook() function should only be called once, when Grafana is starting.");n=i}function s(i){if(!n)throw new Error("setPluginComponentHook(options) can only be used after the Grafana instance has started.");return n(i)}},33604:(te,R,e)=>{"use strict";e.d(R,{R:()=>a,f:()=>s});let n;function a(i){if(n)throw new Error("setPluginComponentsHook() function should only be called once, when Grafana is starting.");n=i}function s(i){if(!n)throw new Error("setPluginComponentsHook(options) can only be used after the Grafana instance has started.");return n(i)}},33707:(te,R,e)=>{"use strict";e.d(R,{U:()=>a,W:()=>s});let n;function a(i){if(n)throw new Error("setUsePluginFunctionsHook() function should only be called once, when Grafana is starting.");n=i}function s(i){if(!n)throw new Error("usePluginFunctions(options) can only be used after the Grafana instance has started.");return n(i)}},46907:(te,R,e)=>{"use strict";e.d(R,{U:()=>s,q:()=>a});let n;function a(i){if(n)throw new Error("setPluginLinksHook() function should only be called once, when Grafana is starting.");n=i}function s(i){if(!n)throw new Error("setPluginLinksHook(options) can only be used after the Grafana instance has started.");return n(i)}},22099:(te,R,e)=>{"use strict";e.d(R,{CP:()=>u,DG:()=>i,RC:()=>o,aR:()=>r});var n=e(74848),a=e(96540),s=e(54092);function i(l){return l?l.type===s.u.link&&("path"in l||"onClick"in l):!1}function r(l){return l?l.type===s.u.component&&"component"in l:!1}function u({props:l,components:g,limit:f,pluginId:p}){if(!g.length)return null;const c=[];for(const x of g){const{meta:v}=x;if(!(p&&typeof p=="string"&&p!==v.pluginId)&&!(p&&Array.isArray(p)&&!p.includes(v.pluginId))&&!(p instanceof RegExp&&!p.test(v.pluginId))){if(f===void 0){c.push(x);continue}if(a.createElement(x,l)!==null&&c.push(x),c.length>=f)break}}return c}function o({props:l,components:g,limit:f,pluginId:p}){const c=u({props:l,components:g,limit:f,pluginId:p});return c?.length?(0,n.jsx)(n.Fragment,{children:c.map(x=>(0,n.jsx)(x,{...l},x.meta.id))}):null}},2863:(te,R,e)=>{"use strict";e.d(R,{d:()=>a,w:()=>s});let n;const a=i=>{n=i},s=()=>n},6201:(te,R,e)=>{"use strict";e.d(R,{H:()=>s,l:()=>a});let n=null;function a(i){if(n)throw new Error("User should only be set once, when Grafana is starting.");n=i}function s(){if(!n)throw new Error("User can only be used after Grafana instance has started.");return n}},36580:(te,R,e)=>{"use strict";e.d(R,{iy:()=>j,dR:()=>D,b1:()=>P,VQ:()=>M,s9:()=>C});var n=e(62467),a=e(75505),s=e(44240),i=e(63720),r=e(66847),u=e(94644),o=e(48480),l=e(1906),g=e(38619),f=e(77154),p=e(35814),c=e(27489),x=e(43173),v=e(78282),m=e(68143),y=e(33184),h=e(51388),d=e(38866);function E(B){const{intervalMs:S,maxDataPoints:_,requestId:K,panelId:T,queryCachingTTL:L,range:{from:A,to:N}}=B;if(!B.targets.length)return(0,n.of)({data:[]});const V={intervalMs:S,maxDataPoints:_,queryCachingTTL:L,timeRange:{from:A.valueOf().toString(),to:N.valueOf().toString(),timezone:B.timezone}};return(0,m.AI)().fetch({url:`/api/public/dashboards/${x.$.publicDashboardAccessToken}/panels/${T}/query`,method:"POST",data:V,requestId:K}).pipe((0,i.n)(z=>(0,n.of)((0,d.bE)(z,B.targets))),(0,r.W)(z=>(0,n.of)((0,d.bE)(z))))}var b=e(55315);const D=Object.freeze({type:"__expr__",uid:"__expr__",name:"Expression"});function C(B){if(!B)return!1;const S=typeof B=="string"?B:B.type;return S===D.type||S===D.name||S==="-100"}class P extends Error{constructor(S,_){super(S),this.details=_,this.name="HealthCheckError"}}var M=(B=>(B.Unknown="UNKNOWN",B.OK="OK",B.Error="ERROR",B))(M||{}),O=(B=>(B.PluginID="X-Plugin-Id",B.DatasourceUID="X-Datasource-Uid",B.DashboardUID="X-Dashboard-Uid",B.PanelID="X-Panel-Id",B.PanelPluginId="X-Panel-Plugin-Id",B.QueryGroupID="X-Query-Group-Id",B.FromExpression="X-Grafana-From-Expr",B.SkipQueryCache="X-Cache-Skip",B.DashboardTitle="X-Dashboard-Title",B.PanelTitle="X-Panel-Title",B))(O||{});class j extends u.mA{constructor(S){super(S),this.streamOptionsProvider=W,this.userStorage=new b.X(S.type)}query(S){if(x.$.publicDashboardAccessToken)return E(S);const{intervalMs:_,maxDataPoints:K,queryCachingTTL:T,range:L,requestId:A,hideFromInspector:N=!1}=S;let V=S.targets,z=!1;const w=new Set,H=new Set,Q=V.map(I=>{let J=this.getRef(),ee=this.id,q=!0;if(C(I.datasource))return z=!0,{...I,datasource:D};if(I.datasource){const ne=(0,v.l)().getInstanceSettings(I.datasource,S.scopedVars);if(!ne)throw new Error(`Unknown Datasource: ${JSON.stringify(I.datasource)}`);const se=ne.rawRef??(0,o.p$)(ne),oe=ne.id;(se.uid!==J.uid||ee!==oe)&&(J=se,ee=oe,q=!1)}return J.type?.length&&w.add(J.type),J.uid?.length&&H.add(J.uid),{...q?this.applyTemplateVariables(I,S.scopedVars,S.filters):I,datasource:J,datasourceId:ee,intervalMs:_,maxDataPoints:K,queryCachingTTL:T}});if(!Q.length)return(0,n.of)({data:[]});const Z={queries:Q,from:L?.from.valueOf().toString(),to:L?.to.valueOf().toString()},Y=S.headers??{};Y["X-Plugin-Id"]=Array.from(w).join(", "),Y["X-Datasource-Uid"]=Array.from(H).join(", ");let X="/api/ds/query?ds_type="+this.type;if(x.$.featureToggles.queryServiceFromExplore&&S.app===l.Jk.Explore){const I=x.$.featureToggles.queryService,J=x.$.featureToggles.grafanaAPIServerWithExperimentalAPIs;!I&&!J?console.warn("feature toggle queryServiceFromExplore also requires the queryService to be running"):X=`/apis/query.grafana.app/v0alpha1/namespaces/${x.$.namespace}/query?ds_type=${this.type}`}return x.$.featureToggles.queryServiceFromUI&&(x.$.featureToggles.queryService||x.$.featureToggles.grafanaAPIServerWithExperimentalAPIs?X=`/apis/query.grafana.app/v0alpha1/namespaces/${x.$.namespace}/query?ds_type=${this.type}`:console.warn("feature toggle queryServiceFromUI also requires the queryService to be running")),z&&(Y["X-Grafana-From-Expr"]="true",X+="&expression=true"),A&&(X+=`&requestId=${A}`),S.dashboardUID&&(Y["X-Dashboard-Uid"]=S.dashboardUID,S.dashboardTitle&&(Y["X-Dashboard-Title"]=S.dashboardTitle),S.panelId&&(Y["X-Panel-Id"]=`${S.panelId}`),S.panelName&&(Y["X-Panel-Title"]=S.panelName)),S.panelPluginId&&(Y["X-Panel-Plugin-Id"]=`${S.panelPluginId}`),S.queryGroupId&&(Y["X-Query-Group-Id"]=`${S.queryGroupId}`),S.skipQueryCache&&(Y["X-Cache-Skip"]="true"),(0,m.AI)().fetch({url:X,method:"POST",data:Z,requestId:A,hideFromInspector:N,headers:Y}).pipe((0,i.n)(I=>{const J=(0,d.bE)(I,Q);return J.data?.length&&J.data.find(ee=>ee.meta?.channel)?U(J,S,this.streamOptionsProvider):(0,n.of)(J)}),(0,r.W)(I=>(0,n.of)((0,d.bE)(I))))}getRequestHeaders(){const S={};return S["X-Plugin-Id"]=this.type,S["X-Datasource-Uid"]=this.uid,S}interpolateVariablesInQueries(S,_,K){return S.map(T=>this.applyTemplateVariables(T,_,K))}applyTemplateVariables(S,_,K){return S}async getResource(S,_,K){const T=this.getRequestHeaders();return(await(0,a.s)((0,m.AI)().fetch({...K,method:"GET",headers:K?.headers?{...K.headers,...T}:T,params:_??K?.params,url:`/api/datasources/uid/${this.uid}/resources/${S}`}))).data}async postResource(S,_,K){const T=this.getRequestHeaders();return(await(0,a.s)((0,m.AI)().fetch({...K,method:"POST",headers:K?.headers?{...K.headers,...T}:T,data:_??{..._},url:`/api/datasources/uid/${this.uid}/resources/${S}`}))).data}async callHealthCheck(){return(0,a.s)((0,m.AI)().fetch({method:"GET",url:`/api/datasources/uid/${this.uid}/health`,showErrorAlert:!1,headers:this.getRequestHeaders()})).then(S=>S.data).catch(S=>{let _={plugin_id:this.meta?.id||"",plugin_version:this.meta?.info?.version||"",datasource_healthcheck_status:S?.data?.status||"error",datasource_healthcheck_message:S?.data?.message||""};return(0,c.rR)("datasource_health_check_completed",_),S.data})}async testDatasource(){return this.callHealthCheck().then(S=>S.status==="OK"?{status:"success",message:S.message}:Promise.reject({status:"error",message:S.message,error:new P(S.message,S.details)}))}}function U(B,S,_){const K=(0,y.oF)();if(!K)return(0,n.of)(B);const T=[],L=[];for(const A of B.data){const N=(0,g.DG)(A.meta?.channel);if(N){const V=A;L.push(K.getDataStream({addr:N,buffer:_(S,V),frame:(0,f.Nw)(A)}))}else T.push(A)}return T.length&&L.push((0,n.of)({...B,data:T})),L.length===1?L[0]:(0,s.h)(...L)}const W=(B,S)=>{const _={maxLength:B.maxDataPoints??500,action:h.Kh.Append};return B.rangeRaw?.to==="now"&&(_.maxDelta=B.range.to.valueOf()-B.range.from.valueOf()),_};j=(0,p.Y)(j)},92293:(te,R,e)=>{"use strict";e.d(R,{_:()=>a,k:()=>s});let n;const a=i=>{n=i},s=()=>(n||console.error("useChromeHeaderHeight hook not found"),n?.())},25992:(te,R,e)=>{"use strict";e.d(R,{DW:()=>g,FF:()=>r,MD:()=>u,fH:()=>i,l$:()=>l,vV:()=>o});var n=e(32631),a=e(37930),s=e(43173);function i(f,p){s.$.grafanaJavascriptAgent.enabled&&n.P.api.pushLog([f],{level:a.$b.INFO,context:p})}function r(f,p){s.$.grafanaJavascriptAgent.enabled&&n.P.api.pushLog([f],{level:a.$b.WARN,context:p})}function u(f,p){s.$.grafanaJavascriptAgent.enabled&&n.P.api.pushLog([f],{level:a.$b.DEBUG,context:p})}function o(f,p){s.$.grafanaJavascriptAgent.enabled&&n.P.api.pushError(f,{context:p})}function l(f,p,c){s.$.grafanaJavascriptAgent.enabled&&n.P.api.pushMeasurement({type:f,values:p},{context:c})}function g(f,p){const c=x=>({source:f,...p,...x});return{logDebug:(x,v)=>u(x,c(v)),logInfo:(x,v)=>i(x,c(v)),logWarning:(x,v)=>r(x,c(v)),logError:(x,v)=>o(x,c(v)),logMeasurement:(x,v,m)=>l(x,v,c(m))}}},38353:(te,R,e)=>{"use strict";e.d(R,{LZ:()=>i,aX:()=>u,xt:()=>o});var n=e(43173),a=e(68143),s=e(36580);function i(l){return l instanceof s.iy&&"hasBackendMigration"in l&&"shouldMigrate"in l}async function r(l){if(!(n.$.featureToggles.grafanaAPIServerWithExperimentalAPIs||n.$.featureToggles.datasourceAPIServers))return console.warn("migrateQuery is only available with the experimental API server"),l;const c=`/apis/${`${l[0].datasource?.type?.replace(/^(grafana-)?(.*?)(-datasource)?$/,"$2")}.datasource.grafana.app`}/v0alpha1/namespaces/${n.$.namespace}/queryconvert`,x={queries:l.map(m=>({...m,JSON:m}))};return(await(0,a.AI)().post(c,x)).queries.map(m=>m.JSON)}async function u(l,g){return!l.hasBackendMigration||!l.shouldMigrate(g)?g:(await r([g]))[0]}async function o(l,g){if(!l.hasBackendMigration||!g.targets.some(p=>l.shouldMigrate(p)))return g;const f=await r(g.targets);return{...g,targets:f}}},39698:(te,R,e)=>{"use strict";e.d(R,{PL:()=>a,o:()=>r,se:()=>i});var n=e(43173);async function a(u){try{const o=n.$.bootData.user.theme==="light"?u.light:u.dark;return window.System.import(o)}catch(o){console.error(o)}}let s;function i(u){if(s)throw new Error("pluginImportUtils should only be set once, when Grafana is starting.");s=u}function r(){if(!s)throw new Error("pluginImportUtils can only be used after Grafana instance has started.");return s}},38866:(te,R,e)=>{"use strict";e.d(R,{$h:()=>p,bE:()=>o});var n=e(28105),a=e(77154),s=e(41119),i=e(95004),r=e(97534);const u={severity:"info",text:"Cached response"};function o(c,x){const v={data:[],state:n.Gu.Done},m="traceId"in c?c.traceId:void 0;m!=null&&(v.traceIds=[m]);const y=c;if(y.data?.results){const h=y.data.results,d=x?.length?x.map(D=>D.refId):Object.keys(h),E=l(y),b=[];for(const D of d){const C=h[D];C&&(C.refId=D,b.push(C))}for(const D of b){if(D.error){const C={refId:D.refId,message:D.error,status:D.status};m!=null&&(C.traceId=m),v.error||(v.error={...C}),v.errors?v.errors.push({...C}):v.errors=[{...C}],v.state=n.Gu.Error}if(D.frames?.length){for(let C of D.frames){E&&(C=g(C));const P=(0,a.or)(C);P.refId||(P.refId=D.refId),v.data.push(P)}continue}if(D.series?.length)for(const C of D.series)C.refId||(C.refId=D.refId),v.data.push((0,s.Vc)(C));if(D.tables?.length)for(const C of D.tables)C.refId||(C.refId=D.refId),v.data.push((0,s.Vc)(C))}}return y.status&&y.status!==200&&(v.state!==n.Gu.Error&&(v.state=n.Gu.Error),v.error||(v.error=(0,r.u)(c))),v}function l(c){const x=c?.headers;return!x||!x.get?!1:x.get("X-Cache")==="HIT"}function g(c){return{...c,schema:{...c.schema,fields:[...c.schema?.fields??[]],meta:{...c.schema?.meta,notices:[...c.schema?.meta?.notices??[],u],isCachedResponse:!0}}}}function f(c){const x=o(c);if(x.error?.data?.message)return{status:"error",message:x.error.data.message,details:x.error?.data?.error?{message:x.error.data.error}:void 0};if(x.error?.refId&&x.error?.message)return{status:"error",message:x.error.message};throw c}function p(c){if(!c||!c.length)return[];const x=[];let v=c.fields.find(m=>m.type===i.PU.string);if(v||(v=c.fields.find(m=>m.type!==i.PU.time)),v)for(let m=0;m<v.values.length;m++)x.push({text:""+v.values[m]});return x}},41071:(te,R,e)=>{"use strict";e.d(R,{_:()=>a,i:()=>s});let n;const a=i=>{n=i},s=()=>n?n():()=>console.error("ReturnToPrevious hook not found")},97534:(te,R,e)=>{"use strict";e.d(R,{u:()=>n});function n(a){const s=a||{};if(!s.message){if(typeof a=="string")return{message:a};let i="Query error";s.message?i=s.message:s.data&&s.data.message&&s.data?.message!=="Query data error"?i=s.data.message:s?.data?.message==="Query data error"&&s?.data?.error||s.data&&s.data.error?i=s.data.error:s.status&&(i=`Query error: ${s.status} ${s.statusText}`),s.message=i}return s}},55315:(te,R,e)=>{"use strict";e.d(R,{D:()=>f,X:()=>g});var n=e(2543),a=e.n(n),s=e(75505),i=e(31595),r=e(43173),u=e(68143);const o=`/apis/userstorage.grafana.app/v0alpha1/namespaces/${r.$.namespace}/user-storage`;async function l(p){try{const{data:c,...x}=await(0,s.s)((0,u.AI)().fetch({...p,url:o+p.url,data:p.body,showErrorAlert:!1}));return{data:c,meta:x}}catch(c){return p.manageError?p.manageError(c):{error:c}}}class g{constructor(c){this.service=c,this.userUID=r.$.bootData.user.uid===""?r.$.bootData.user.id.toString():r.$.bootData.user.uid,this.resourceName=`${c}:${this.userUID}`,this.canUseUserStorage=r.$.bootData.user.isSignedIn}async init(){if(this.storageSpec!==void 0)return;const c=await l({url:`/${this.resourceName}`,method:"GET",manageError:x=>(0,n.get)(x,"status")===404?(this.storageSpec=null,{error:null}):{error:x}});if("error"in c)return c.error;this.storageSpec=c.data.spec}async getItem(c){return this.canUseUserStorage?(await this.init(),this.storageSpec?this.storageSpec.data[c]:localStorage.getItem(`${this.resourceName}:${c}`)):localStorage.getItem(`${this.resourceName}:${c}`)}async setItem(c,x){if(!this.canUseUserStorage){localStorage.setItem(`${this.resourceName}:${c}`,x);return}const v={data:{[c]:x}};if(await this.init()){localStorage.setItem(`${this.resourceName}:${c}`,x);return}if(!this.storageSpec){await l({url:"/",method:"POST",body:{metadata:{name:this.resourceName,labels:{user:this.userUID,service:this.service}},spec:v},manageError:y=>(localStorage.setItem(`${this.resourceName}:${c}`,x),{error:y})}),this.storageSpec=v;return}this.storageSpec.data[c]=x,await l({headers:{"Content-Type":"application/merge-patch+json"},url:`/${this.resourceName}`,method:"PATCH",body:{spec:v},manageError:y=>(localStorage.setItem(`${this.resourceName}:${c}`,x),{error:y})})}}function f(){const p=(0,i.Q)();if(!p)throw new Error("No PluginContext found. The usePluginUserStorage() hook can only be used from a plugin.");return new g(p?.meta.id)}},97474:(te,R,e)=>{"use strict";e.d(R,{KQ:()=>s,QB:()=>i});var n=e(739);const a="12.1.0-pre",s={barRadius:0,barWidth:.97,fullHighlight:!1,groupWidth:.7,orientation:n.wV.Auto,showValue:n.yL.Auto,stacking:n.gs.None,xTickLabelRotation:0,xTickLabelSpacing:0},i={fillOpacity:80,gradientMode:n.on.None,lineWidth:1}},48390:(te,R,e)=>{"use strict";e.d(R,{K:()=>s});var n=e(739);const a="12.1.0-pre",s={displayMode:n.eX.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:n.TZ.Auto,showUnfilled:!0,sizing:n.T6.Auto,valueMode:n.$l.Color}},53478:(te,R,e)=>{"use strict";e.d(R,{K:()=>a});const n="12.1.0-pre",a={selectedSeries:0}},74194:(te,R,e)=>{"use strict";e.d(R,{K:()=>s});var n=e(739);const a="12.1.0-pre",s={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:n.T6.Auto}},48850:(te,R,e)=>{"use strict";e.d(R,{KQ:()=>a});const n="12.1.0-pre",a={layers:[]},s={allLayers:!0,id:"zero",lat:0,lon:0,zoom:1};var i=(u=>(u.Details="details",u.None="none",u))(i||{}),r=(u=>(u.Coords="coords",u.Fit="fit",u.Zero="zero",u))(r||{})},97644:(te,R,e)=>{"use strict";e.d(R,{KQ:()=>u});var n=e(739);const a="12.1.0-pre";var s=(o=>(o.Opacity="opacity",o.Scheme="scheme",o))(s||{}),i=(o=>(o.Exponential="exponential",o.Linear="linear",o))(i||{}),r=(o=>(o.X="x",o.Xy="xy",o.Y="y",o))(r||{});const u={calculate:!1,cellGap:1,cellValues:{},color:{scheme:"Oranges",fill:"dark-orange",reverse:!1,exponent:.5,steps:64},exemplars:{color:"rgba(255,0,255,0.7)"},filterValues:{le:1e-9},legend:{show:!0},selectionMode:"x",showValue:n.yL.Auto,tooltip:{mode:n.$N.Single,yHistogram:!1,showColorScale:!1}}},55448:(te,R,e)=>{"use strict";e.d(R,{KQ:()=>s,QB:()=>i});var n=e(739);const a="12.1.0-pre",s={bucketCount:30,bucketOffset:0},i={fillOpacity:80,gradientMode:n.on.None,lineWidth:1}},25346:(te,R,e)=>{"use strict";e.d(R,{K:()=>a});const n="12.1.0-pre",a={showImage:!0}},23130:(te,R,e)=>{"use strict";e.d(R,{KQ:()=>u});const n="12.1.0-pre";var a=(o=>(o.Donut="donut",o.Pie="pie",o))(a||{}),s=(o=>(o.Name="name",o.Percent="percent",o.Value="value",o))(s||{}),i=(o=>(o.Percent="percent",o.Value="value",o))(i||{});const r={values:[]},u={displayLabels:[]}},7698:(te,R,e)=>{"use strict";e.d(R,{K:()=>s});var n=e(739);const a="12.1.0-pre",s={colorMode:n.yp.Value,graphMode:n.$p.Area,justifyMode:n.F8.Auto,percentChangeColorMode:n.CD.Standard,showPercentChange:!1,textMode:n.SV.Auto,wideLayout:!0}},16880:(te,R,e)=>{"use strict";e.d(R,{KQ:()=>s,QB:()=>i});var n=e(739);const a="12.1.0-pre",s={alignValue:"left",mergeValues:!0,perPage:20,rowHeight:.9,showValue:n.yL.Auto},i={fillOpacity:70,lineWidth:0}},93384:(te,R,e)=>{"use strict";e.d(R,{KQ:()=>s,QB:()=>i});var n=e(739);const a="12.1.0-pre",s={colWidth:.9,perPage:20,rowHeight:.9,showValue:n.yL.Auto},i={fillOpacity:70,lineWidth:1}},59740:(te,R,e)=>{"use strict";e.d(R,{K:()=>s});var n=e(739);const a="12.1.0-pre",s={cellHeight:n.qM.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]}},51250:(te,R,e)=>{"use strict";e.d(R,{KQ:()=>u});const n="12.1.0-pre";var a=(o=>(o.Code="code",o.HTML="html",o.Markdown="markdown",o))(a||{}),s=(o=>(o.Go="go",o.Html="html",o.Json="json",o.Markdown="markdown",o.Plaintext="plaintext",o.Sql="sql",o.Typescript="typescript",o.Xml="xml",o.Yaml="yaml",o))(s||{});const i="plaintext",r={language:"plaintext",showLineNumbers:!1,showMiniMap:!1},u={content:`# Title

For markdown syntax help: [commonmark.org/help](https://commonmark.org/help/)`,mode:"markdown"}},81166:(te,R,e)=>{"use strict";e.d(R,{KQ:()=>o,QB:()=>u});const n="12.1.0-pre";var a=(l=>(l.Circle="circle",l.Square="square",l))(a||{}),s=(l=>(l.Auto="auto",l.Manual="manual",l))(s||{}),i=(l=>(l.Lines="lines",l.Points="points",l.PointsAndLines="points+lines",l))(i||{});const r={id:""},u={fillOpacity:50,show:"points"},o={series:[]}},21275:(te,R,e)=>{"use strict";e.d(R,{$C:()=>d,CO:()=>u,GW:()=>P,OA:()=>E,Ol:()=>c,QB:()=>C,WL:()=>m,Yb:()=>f,Ye:()=>M,ZG:()=>l,aD:()=>s,bf:()=>i,bt:()=>b,dM:()=>v,lt:()=>y,rw:()=>r,ss:()=>D,yV:()=>h});const n={tags:[]},a={exclude:!1,ids:[]},s={list:[]},i={builtIn:0,enable:!0,hide:!1},r={allowCustomValue:!0,includeAll:!1,multi:!1,options:[],skipUrlSync:!1};var u=(O=>(O[O.never=0]="never",O[O.onDashboardLoad=1]="onDashboardLoad",O[O.onTimeRangeChanged=2]="onTimeRangeChanged",O))(u||{}),o=(O=>(O[O.dontHide=0]="dontHide",O[O.hideLabel=1]="hideLabel",O[O.hideVariable=2]="hideVariable",O))(o||{}),l=(O=>(O[O.alphabeticalAsc=1]="alphabeticalAsc",O[O.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",O[O.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",O[O.alphabeticalDesc=2]="alphabeticalDesc",O[O.disabled=0]="disabled",O[O.naturalAsc=7]="naturalAsc",O[O.naturalDesc=8]="naturalDesc",O[O.numericalAsc=3]="numericalAsc",O[O.numericalDesc=4]="numericalDesc",O))(l||{});const g={asDropdown:!1,includeVars:!1,keepTime:!1,tags:[],targetBlank:!1};var f=(O=>(O.ContinuousBlPu="continuous-BlPu",O.ContinuousBlYlRd="continuous-BlYlRd",O.ContinuousBlues="continuous-blues",O.ContinuousGrYlRd="continuous-GrYlRd",O.ContinuousGreens="continuous-greens",O.ContinuousPurples="continuous-purples",O.ContinuousRdYlGr="continuous-RdYlGr",O.ContinuousReds="continuous-reds",O.ContinuousYlBl="continuous-YlBl",O.ContinuousYlRd="continuous-YlRd",O.Fixed="fixed",O.PaletteClassic="palette-classic",O.PaletteClassicByName="palette-classic-by-name",O.Shades="shades",O.Thresholds="thresholds",O))(f||{});const p={h:9,w:12,x:0,y:0};var c=(O=>(O.Absolute="absolute",O.Percentage="percentage",O))(c||{});const x={steps:[]};var v=(O=>(O.RangeToText="range",O.RegexToText="regex",O.SpecialValue="special",O.ValueToText="value",O))(v||{}),m=(O=>(O.Empty="empty",O.False="false",O.NaN="nan",O.Null="null",O.NullAndNan="null+nan",O.True="true",O))(m||{});const y={hidden:!1,quick_ranges:[],refresh_intervals:["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"]};var h=(O=>(O[O.Crosshair=1]="Crosshair",O[O.Off=0]="Off",O[O.Tooltip=2]="Tooltip",O))(h||{});const d=0,E={links:[],repeatDirection:"h",targets:[],transformations:[],transparent:!1},b={overrides:[]},D={id:""},C={links:[],mappings:[]},P={collapsed:!1,panels:[]},M={editable:!0,fiscalYearStartMonth:0,graphTooltip:0,links:[],panels:[],schemaVersion:41,tags:[],timezone:"browser"}},78947:(te,R,e)=>{"use strict";e.d(R,{Bj:()=>Dt,ET:()=>Ze,FM:()=>De,G9:()=>Le,IP:()=>mt,SR:()=>ye,X1:()=>$e,bt:()=>C,ft:()=>we,kH:()=>Te,l_:()=>Ye,m6:()=>he,ns:()=>Et,pK:()=>ct,t1:()=>Ve,uB:()=>Pt,xE:()=>En});const n=()=>({kind:"AnnotationQuery",spec:a()}),a=()=>({enable:!1,hide:!1,iconColor:"",name:"",builtIn:!1}),s=()=>({}),i=()=>({kind:"",spec:{}}),r=()=>({exclude:!1,ids:[]}),u=()=>"Off",o=()=>l(),l=()=>({kind:"Panel",spec:g()}),g=()=>({id:0,title:"",description:"",links:[],data:p(),vizConfig:b()}),f=()=>({title:"",url:""}),p=()=>({kind:"QueryGroup",spec:c()}),c=()=>({queries:[],transformations:[],queryOptions:E()}),x=()=>({kind:"PanelQuery",spec:v()}),v=()=>({query:i(),refId:"",hidden:!1}),m=()=>({kind:"",spec:y()}),y=()=>({id:"",options:{}}),h=()=>({id:""}),d=()=>"series",E=()=>({}),b=()=>({kind:"",spec:D()}),D=()=>({pluginVersion:"",options:{},fieldConfig:C()}),C=()=>({defaults:P(),overrides:[]}),P=()=>({}),M=()=>O(),O=()=>({type:"value",options:{}}),j=()=>"value",U=()=>({}),W=()=>({type:"range",options:{from:0,to:0,result:U()}}),B=()=>({type:"regex",options:{pattern:"",result:U()}}),S=()=>({type:"special",options:{match:"true",result:U()}}),_=()=>"true",K=()=>({mode:"absolute",steps:[]}),T=()=>"absolute",L=()=>({value:0,color:""}),A=()=>({mode:"thresholds"}),N=()=>"thresholds",V=()=>"min",z=()=>({id:""}),w=()=>({kind:"LibraryPanel",spec:H()}),H=()=>({id:0,title:"",libraryPanel:Q()}),Q=()=>({name:"",uid:""}),Z=()=>({kind:"GridLayout",spec:Y()}),Y=()=>({items:[]}),X=()=>({kind:"GridLayoutItem",spec:I()}),I=()=>({x:0,y:0,width:0,height:0,element:J()}),J=()=>({kind:"ElementReference",name:""}),ee=()=>({mode:q,value:""}),q="variable",ne=()=>({kind:"RowsLayout",spec:se()}),se=()=>({rows:[]}),oe=()=>({kind:"RowsLayoutRow",spec:de()}),de=()=>({layout:Z()}),fe=()=>({kind:"ConditionalRenderingGroup",spec:ae()}),ae=()=>({visibility:"show",condition:"and",items:[]}),ce=()=>({kind:"ConditionalRenderingVariable",spec:ie()}),ie=()=>({variable:"",operator:"equals",value:""}),ve=()=>({kind:"ConditionalRenderingData",spec:le()}),le=()=>({value:!1}),Ee=()=>({kind:"ConditionalRenderingTimeRangeSize",spec:Re()}),Re=()=>({value:""}),Oe=()=>({mode:q,value:""}),Se=()=>({kind:"AutoGridLayout",spec:Te()}),Te=()=>({maxColumnCount:3,columnWidthMode:"standard",rowHeightMode:"standard",fillScreen:!1,items:[]}),_e=()=>({kind:"AutoGridLayoutItem",spec:He()}),He=()=>({element:J()}),tt=()=>({mode:q,value:""}),Je=()=>({kind:"TabsLayout",spec:Ge()}),Ge=()=>({tabs:[]}),je=()=>({kind:"TabsLayoutTab",spec:Fe()}),Fe=()=>({layout:Z()}),Be=()=>({mode:q,value:""}),Ke=()=>({title:"",type:"link",icon:"",tooltip:"",tags:[],asDropdown:!1,targetBlank:!1,includeVars:!1,keepTime:!1}),Ue=()=>"link",we=()=>({timezone:"browser",from:"now-6h",to:"now",autoRefresh:"",autoRefreshIntervals:["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],hideTimepicker:!1,fiscalYearStartMonth:0}),Xe=()=>({display:"Last 6 hours",from:"now-6h",to:"now"}),nt=()=>he(),he=()=>({kind:"QueryVariable",spec:xe()}),xe=()=>({name:"",current:{text:"",value:""},hide:"dontHide",refresh:"never",skipUrlSync:!1,query:i(),regex:"",sort:"disabled",options:[],multi:!1,includeAll:!1,allowCustomValue:!0}),me=()=>({text:"",value:""}),ye=()=>"dontHide",De=()=>"never",Le=()=>"disabled",Ve=()=>({kind:"TextVariable",spec:ze()}),ze=()=>({name:"",current:{text:"",value:""},query:"",hide:"dontHide",skipUrlSync:!1}),Ze=()=>({kind:"ConstantVariable",spec:Me()}),Me=()=>({name:"",query:"",current:{text:"",value:""},hide:"dontHide",skipUrlSync:!1}),$e=()=>({kind:"DatasourceVariable",spec:at()}),at=()=>({name:"",pluginId:"",refresh:"never",regex:"",current:{text:"",value:""},options:[],multi:!1,includeAll:!1,hide:"dontHide",skipUrlSync:!1,allowCustomValue:!0}),ct=()=>({kind:"IntervalVariable",spec:ft()}),ft=()=>({name:"",query:"",current:{text:"",value:""},options:[],auto:!1,auto_min:"",auto_count:0,refresh:"never",hide:"dontHide",skipUrlSync:!1}),Et=()=>({kind:"CustomVariable",spec:St()}),St=()=>({name:"",query:"",current:me(),options:[],multi:!1,includeAll:!1,hide:"dontHide",skipUrlSync:!1,allowCustomValue:!0}),Pt=()=>({kind:"GroupByVariable",spec:Dt()}),Dt=()=>({name:"",current:{text:"",value:""},options:[],multi:!1,hide:"dontHide",skipUrlSync:!1}),Ye=()=>({kind:"AdhocVariable",spec:mt()}),mt=()=>({name:"",baseFilters:[],filters:[],defaultKeys:[],hide:"dontHide",skipUrlSync:!1,allowCustomValue:!0}),zt=()=>({key:"",operator:"",value:""}),Jt="dashboard",Xt=()=>({text:""}),En=()=>({annotations:[],cursorSync:"Off",editable:!0,elements:{},layout:Z(),links:[],preload:!1,tags:[],timeSettings:we(),title:"",variables:[]})},31114:(te,R,e)=>{"use strict";e.d(R,{Gu:()=>s,gB:()=>a});var n=e(739);const a={align:"auto",inspect:!1,wrapHeaderText:!1,cellOptions:{type:n.ob.Auto}};var s=(i=>(i.NotStarted="NotStarted",i.Loading="Loading",i.Streaming="Streaming",i.Done="Done",i.Error="Error",i))(s||{})},59857:(te,R,e)=>{"use strict";e.d(R,{Ye:()=>s,lt:()=>r,rw:()=>i,zL:()=>a});var n=e(21275),a=(x=>(x[x.dontHide=0]="dontHide",x[x.hideLabel=1]="hideLabel",x[x.hideVariable=2]="hideVariable",x))(a||{});const s=n.Ye,i={...n.rw},r=n.lt,u=n.OA,o=n.GW,l=n.QB,g=n.bt,f=n.ss,p=n.bf,c=n.aD},27074:(te,R,e)=>{"use strict";e.d(R,{l:()=>p});var n=e(74848),a=e(22803),s=e(73287),i=e(92745),r=e(27489),u=e(63142),o=e(76319),l=e(37386),g=e(50992),f=e(52308);function p({rawSql:x,datasourceType:v}){const[m,y]=(0,s.A)(),h=(0,u.of)(c),d=b=>{y(b),(0,r.rR)("grafana_sql_preview_copied",{datasource:v})},E=(0,n.jsxs)("div",{className:h.labelWrapper,children:[(0,n.jsx)("span",{className:h.label,children:(0,n.jsx)(i.x6,{i18nKey:"grafana-sql.components.preview.label-element.preview",children:"Preview"})}),(0,n.jsx)(o.K,{tooltip:(0,i.t)("grafana-sql.components.preview.label-element.tooltip-copy-to-clipboard","Copy to clipboard"),onClick:()=>d(x),name:"copy"})]});return(0,n.jsx)(l.D,{label:E,className:h.grow,children:(0,n.jsx)(g.B,{language:"sql",height:80,value:(0,f.s)(x),monacoOptions:{scrollbar:{vertical:"hidden"},scrollBeyondLastLine:!1},readOnly:!0,showMiniMap:!1})})}function c(x){return{grow:(0,a.css)({flexGrow:1}),label:(0,a.css)({fontSize:12,fontWeight:x.typography.fontWeightMedium}),labelWrapper:(0,a.css)({display:"flex",justifyContent:"space-between",paddingBottom:x.spacing(.5)})}}},52308:(te,R,e)=>{"use strict";e.d(R,{s:()=>a});var n=e(27633);function a(s){return n.Ay.format(s).replace(/(\$ \{ .* \})|(\$ __)|(\$ \w+)/g,i=>i.replace(/\s/g,""))}},8779:(te,R,e)=>{"use strict";e.d(R,{r:()=>v});var n=e(74848),a=e(96540),s=e(92745),i=e(63142),r=e(45861),u=e(71599),o=e(22803),l=e(37386),g=e(16780),f=e(63527),p=e(22787);function c({action:m,onDismiss:y,onShowConfirm:h,variables:d,setVariables:E}){const b=(0,i.of)(x),D=()=>{y(),h()};return(0,n.jsxs)(p.a,{isOpen:!0,title:(0,s.t)("grafana-ui.action-editor.button.action-variables-title","Action variables"),onDismiss:y,className:b.variablesModal,children:[(0,n.jsx)(g.n,{children:m.variables.map(C=>(0,n.jsx)(l.D,{label:C.name,children:(0,n.jsx)(f.p,{type:"text",value:d[C.key]??"",onChange:P=>{E({...d,[C.key]:P.currentTarget.value})},placeholder:(0,s.t)("grafana-ui.action-editor.button.variable-value-placeholder","Value"),width:20})},C.name))}),(0,n.jsxs)(p.a.ButtonRow,{children:[(0,n.jsx)(r.$n,{variant:"secondary",onClick:y,children:(0,s.t)("grafana-ui.action-editor.close","Close")}),(0,n.jsx)(r.$n,{variant:"primary",onClick:D,children:(0,s.t)("grafana-ui.action-editor.continue","Continue")})]})]})}const x=()=>({variablesModal:(0,o.css)({zIndex:1e4})});function v({action:m,...y}){const h=(0,i.$j)(),d=m.style.backgroundColor||h.colors.secondary.main,E=h.colors.getContrastText(d),[b,D]=(0,a.useState)(!1),[C,P]=(0,a.useState)(!1),[M,O]=(0,a.useState)({}),j=m.variables&&m.variables.length>0,U=()=>{j?P(!0):D(!0)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.$n,{variant:"primary",size:"sm",onClick:U,...y,style:{width:"fit-content",backgroundColor:d,color:E},children:m.title}),j&&C&&(0,n.jsx)(c,{onDismiss:()=>P(!1),action:m,onShowConfirm:()=>D(!0),variables:M,setVariables:O}),b&&(0,n.jsx)(u.u,{isOpen:!0,title:(0,s.t)("grafana-ui.action-editor.button.confirm-action","Confirm action"),body:m.confirmation(M),confirmText:(0,s.t)("grafana-ui.action-editor.button.confirm","Confirm"),confirmButtonVariant:"primary",onConfirm:()=>{D(!1),m.onClick(new MouseEvent("click"),null,M)},onDismiss:()=>{D(!1)}})]})}},34999:(te,R,e)=>{"use strict";e.d(R,{F:()=>p});var n=e(74848),a=e(22803),s=e(96540),i=e(51898),r=e(92745),u=e(63142),o=e(45861),l=e(30703),g=e(31286),f=e(66404);const p=s.forwardRef(({title:v,onRemove:m,children:y,buttonContent:h,elevated:d,bottomSpacing:E,topSpacing:b,className:D,severity:C="error",...P},M)=>{const O=(0,u.$j)(),U=x(O,C,!!v,d,E,b),W={error:"alert",warning:"alert",info:"status",success:"status"},B=P.role||W[C],S=P["aria-label"]||v,_=(0,r.t)("grafana-ui.alert.close-button","Close alert");return(0,n.jsx)("div",{ref:M,className:(0,a.cx)(U.wrapper,D),role:B,"aria-label":S,...P,children:(0,n.jsxs)(g.a,{"data-testid":i.Tp.components.Alert.alertV2(C),display:"flex",backgroundColor:C,borderRadius:"default",paddingY:1,paddingX:2,borderStyle:"solid",borderColor:C,alignItems:"stretch",boxShadow:d?"z3":void 0,children:[(0,n.jsx)(g.a,{paddingTop:1,paddingRight:2,children:(0,n.jsx)("div",{className:U.icon,children:(0,n.jsx)(l.I,{size:"xl",name:c(C)})})}),(0,n.jsxs)(g.a,{paddingY:1,grow:1,children:[(0,n.jsx)(f.E,{color:"primary",weight:"medium",children:v}),y&&(0,n.jsx)("div",{className:U.content,children:y})]}),m&&!h&&(0,n.jsx)("div",{className:U.close,children:(0,n.jsx)(o.$n,{"aria-label":_,icon:"times",onClick:m,type:"button",fill:"text",variant:"secondary"})}),m&&h&&(0,n.jsx)(g.a,{marginLeft:1,display:"flex",alignItems:"center",children:(0,n.jsx)(o.$n,{"aria-label":_,variant:"secondary",onClick:m,type:"button",children:h})})]})})});p.displayName="Alert";const c=v=>{switch(v){case"error":return"exclamation-circle";case"warning":return"exclamation-triangle";case"info":return"info-circle";case"success":return"check"}},x=(v,m,y,h,d,E)=>{const b=v.colors[m];return{wrapper:(0,a.css)({flexGrow:1,marginBottom:v.spacing(d??2),marginTop:v.spacing(E??0),position:"relative","&:before":{content:'""',position:"absolute",top:0,left:0,bottom:0,right:0,background:v.colors.background.primary,zIndex:-1}}),icon:(0,a.css)({color:b.text,position:"relative",top:"-1px"}),content:(0,a.css)({color:v.colors.text.primary,paddingTop:y?v.spacing(.5):0,maxHeight:"50vh",overflowY:"auto"}),close:(0,a.css)({position:"relative",color:v.colors.text.secondary,background:"none",display:"flex",top:"-6px",right:"-14px"})}}},99887:(te,R,e)=>{"use strict";e.d(R,{E:()=>c});var n=e(74848),a=e(22803),s=e(96540),i=e(70255),r=e(84140),u=e(63142),o=e(21348),l=e(30703),g=e(45967);const f=s.memo(({icon:m,color:y,text:h,tooltip:d,className:E,...b})=>{const D=(0,u.of)(v,y),C=(0,n.jsxs)("div",{className:(0,a.cx)(D.wrapper,E),...b,children:[m&&(0,n.jsx)(l.I,{name:m,size:"sm"}),h]});return d?(0,n.jsx)(g.m,{content:d,placement:"auto",children:C}):C});f.displayName="Badge";const p=({rootProps:m})=>{const y=(0,u.of)(x);return(0,n.jsx)(i.A,{width:60,height:22,containerClassName:y.container,...m})},c=(0,o.j)(f,p),x=()=>({container:(0,a.css)({lineHeight:1})}),v=(m,y)=>{let h=m.visualization.getColorByName(y),d="",E="",b="";return m.isDark?(E=(0,r.A)(h).setAlpha(.15).toString(),d=(0,r.A)(h).setAlpha(.25).toString(),b=(0,r.A)(h).lighten(15).toString()):(E=(0,r.A)(h).setAlpha(.15).toString(),d=(0,r.A)(h).setAlpha(.25).toString(),b=(0,r.A)(h).darken(20).toString()),y==="brand"&&(E=m.colors.gradients.brandHorizontal,d="transparent",b=m.colors.primary.contrastText),{wrapper:(0,a.css)({display:"inline-flex",padding:"1px 4px",borderRadius:m.shape.radius.default,background:E,border:`1px solid ${d}`,color:b,fontWeight:m.typography.fontWeightRegular,gap:m.spacing(.5),fontSize:m.typography.bodySmall.fontSize,lineHeight:m.typography.bodySmall.lineHeight,alignItems:"center"})}}},98005:(te,R,e)=>{"use strict";e.d(R,{xE:()=>P});var n=e(74848),a=e(22803),s=e(96540),i=e(84140),r=e(38919),u=e(33553),o=e(48588),l=e(55386),g=e(64394),f=e(76637),p=e(51898),c=e(739),x=e(53568),v=e(45861),m=e(21539);const y=18,h=50,d=150,E=1.5,b=1,D=10,C=15;class P extends s.PureComponent{static{this.defaultProps={lcdCellWidth:12,value:{text:"100",numeric:100},displayMode:c.eX.Gradient,orientation:r.wV.Horizontal,field:{min:0,max:100,thresholds:{mode:u.O.Absolute,steps:[]}},itemSpacing:8,showUnfilled:!0,isOverflow:!1}}render(){const{onClick:A,className:N,theme:V}=this.props,{title:z}=this.props.value,w=j(this.props);return A?(0,n.jsxs)("button",{type:"button",style:w.wrapper,onClick:A,className:(0,a.cx)((0,v.my)(V),N),children:[(0,n.jsx)("div",{style:w.title,children:z}),this.renderBarAndValue()]}):(0,n.jsxs)("div",{style:w.wrapper,className:N,children:[z&&(0,n.jsx)("div",{style:w.title,children:z}),this.renderBarAndValue()]})}renderBarAndValue(){switch(this.props.displayMode){case"lcd":return this.renderRetroBars();case"basic":case"gradient":default:return this.renderBasicAndGradientBars()}}renderBasicAndGradientBars(){const{value:A,showUnfilled:N,valueDisplayMode:V}=this.props,z=S(this.props);return(0,n.jsxs)("div",{style:z.wrapper,children:[V!==c.$l.Hidden&&(0,n.jsx)(m.i,{"data-testid":p.Tp.components.Panels.Visualization.BarGauge.valueV2,value:A,style:z.value}),N&&(0,n.jsx)("div",{style:z.emptyBar}),(0,n.jsx)("div",{style:z.bar})]})}renderRetroBars(){const{display:A,field:N,value:V,itemSpacing:z,alignmentFactors:w,orientation:H,lcdCellWidth:Q,text:Z,valueDisplayMode:Y,theme:X,isOverflow:I}=this.props,{valueHeight:J,valueWidth:ee,maxBarHeight:q,maxBarWidth:ne,wrapperWidth:se,wrapperHeight:oe}=U(this.props),de=N.min??o.tw,fe=N.max??o.d1,ae=M(H),ce=fe-de,ie=ae?q:ne,ve=z,le=Math.floor(ie/Q),Ee=Math.floor((ie-ve*le)/le),Re=K(this.props),Se=T(w||V,Re,ee,J,H,I,Z),Te={width:`${se}px`,height:`${oe}px`,display:"flex"};ae?(Te.flexDirection="column-reverse",Te.alignItems="center"):(Te.flexDirection="row",Te.alignItems="center",Se.justifyContent="flex-end");const _e=[];for(let He=0;He<le;He++){const tt=de+ce/le*He,Je=W(tt,V,A),Ge={borderRadius:X.shape.radius.default};Je.isLit?Ge.backgroundImage=`radial-gradient(${Je.background} 10%, ${Je.backgroundShade})`:Ge.backgroundColor=Je.background,ae?(Ge.height=`${Ee}px`,Ge.width=`${ne}px`,Ge.marginTop=`${ve}px`):(Ge.width=`${Ee}px`,Ge.height=`${q}px`,Ge.marginRight=`${ve}px`),_e.push((0,n.jsx)("div",{style:Ge},He.toString()))}return(0,n.jsxs)("div",{style:Te,children:[_e,Y!==c.$l.Hidden&&(0,n.jsx)(m.i,{"data-testid":p.Tp.components.Panels.Visualization.BarGauge.valueV2,value:V,style:Se})]})}}function M(L){return L===r.wV.Vertical}function O(L){const{height:A,width:N,alignmentFactors:V,orientation:z,text:w,namePlacement:H}=L,Q=V?V.title:L.value.title;if(!Q)return{fontSize:0,width:0,height:0,placement:"above"};if(H===c.TZ.Hidden)return{fontSize:0,width:0,height:0,placement:c.TZ.Hidden};if(M(z)){const q=w?.titleSize??14;return{fontSize:q,width:N,height:q*E,placement:"below"}}if(A>40&&H===c.TZ.Auto||H===c.TZ.Top){if(w?.titleSize)return{fontSize:w?.titleSize,width:0,height:w.titleSize*E,placement:"above"};const ne=Math.max(Math.min(A*.45,h),17);return{fontSize:ne/E,width:0,height:ne,placement:"above"}}const I=Math.max(A*.6,y)/E,J=(0,x.kD)(Q,I),ee=Math.min(J.width+15,N*.4);return{fontSize:w?.titleSize??I,height:0,width:ee,placement:"left"}}function j(L){const A={display:"flex",overflow:"hidden",width:"100%"},N=O(L),V={fontSize:`${N.fontSize}px`,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"100%",alignItems:"center",alignSelf:"center"};return N.placement==="hidden"?V.display="none":M(L.orientation)?(A.flexDirection="column-reverse",V.textAlign="center"):N.placement==="above"?A.flexDirection="column":(A.flexDirection="row",V.width=`${N.width}px`,V.textAlign="right",V.paddingRight="10px"),{wrapper:A,title:V}}function U(L){const{height:A,width:N,orientation:V,text:z,alignmentFactors:w,valueDisplayMode:H}=L,Q=O(L),Z=w??L.value,Y=(0,l.cN)(Z);let X=0,I=0,J=0,ee=0,q=0,ne=0;const se=z?.valueSize??Math.max(Q.fontSize,12),de=(0,x.kD)(Y,se).width+D*2;return M(V)?(z?.valueSize?J=z.valueSize*b:J=Math.min(Math.max(A*.1,y),h),ee=N,H===c.$l.Hidden&&(J=0,ee=0),X=A-(Q.height+J),I=N,q=N,ne=A-Q.height):(H===c.$l.Hidden?(J=0,ee=0):(J=A-Q.height,ee=Math.max(Math.min(N*.2,d),de)),X=A-Q.height,I=N-ee-Q.width,Q.placement==="above"?(q=N,ne=A-Q.height):(q=N-Q.width,ne=A)),{valueWidth:ee,valueHeight:J,maxBarWidth:I,maxBarHeight:X,wrapperHeight:ne,wrapperWidth:q}}function W(L,A,N){if(L===null)return{background:g.F,border:g.F};const V=N?N(L).color:null;return V?A===null||isNaN(A.numeric)||L!==null&&L>A.numeric?{background:(0,i.A)(V).setAlpha(.18).toRgbString(),border:"transparent",isLit:!1}:{background:(0,i.A)(V).setAlpha(.95).toRgbString(),backgroundShade:(0,i.A)(V).setAlpha(.55).toRgbString(),border:(0,i.A)(V).setAlpha(.9).toRgbString(),isLit:!0}:{background:g.F,border:g.F}}function B(L,A,N){const V=Math.min((L-A)/(N-A),1);return isNaN(V)?0:V}function S(L){const{displayMode:A,field:N,value:V,alignmentFactors:z,orientation:w,theme:H,text:Q,isOverflow:Z}=L,{valueWidth:Y,valueHeight:X,maxBarHeight:I,maxBarWidth:J}=U(L),ee=N.min??o.tw,q=N.max??o.d1,ne=B(V.numeric,ee,q),se=K(L),oe=V.color??g.F,fe=T(z||V,se,Y,X,w,Z,Q),ae=A==="basic",ce={display:"flex",flexGrow:1},ie={borderRadius:H.shape.radius.default,position:"relative"},ve={background:H.colors.background.secondary,flexGrow:1,display:"flex",borderRadius:H.shape.radius.default,position:"relative"};if(M(w)){const le=Math.max(ne*I,1);ce.flexDirection="column",ce.justifyContent="flex-end",ie.transition="height 1s",ie.height=`${le}px`,ie.width=`${J}px`,ve.bottom="-3px",ve.width=`${Y}px`,ae?(ie.background=`${(0,i.A)(oe).setAlpha(.35).toRgbString()}`,ie.borderTop=`2px solid ${oe}`):ie.background=_(L,I)}else{const le=Math.max(ne*J,1);ce.flexDirection="row-reverse",ce.justifyContent="flex-end",ce.alignItems="stretch",ie.transition="width 1s",ie.height=`${I}px`,ie.width=`${le}px`,ve.left="-3px",ve.height=`${X}px`,ae?(ie.background=`${(0,i.A)(oe).setAlpha(.35).toRgbString()}`,ie.borderRight=`2px solid ${oe}`):ie.background=_(L,J)}return{wrapper:ce,bar:ie,value:fe,emptyBar:ve}}function _(L,A){const{field:N,value:V,orientation:z,theme:w}=L,H=M(z)?"0deg":"90deg",Q=N.min,Z=N.max;let Y="",X=0,I=(0,f.Hs)(N.color?.mode);if(I.id===g.Y.Thresholds){const J=N.thresholds;for(let ee=0;ee<J.steps.length;ee++){const q=J.steps[ee],ne=L.theme.visualization.getColorByName(q.color),se=J.mode===u.O.Percentage?q.value/100:B(q.value,Q,Z),oe=se*A,de=Math.round(oe-(oe-X)/2),fe=J.mode===u.O.Percentage?Q+(Z-Q)*se:q.value;if(Y==="")Y=`linear-gradient(${H}, ${ne}, ${ne}`;else{if(V.numeric<fe)break;X=oe,Y+=` ${de}px, ${ne}`}}return Y+")"}if(I.isContinuous&&I.getColors){const J=I.getColors(w);for(let ee=0;ee<J.length;ee++){const q=J[ee];if(Y==="")Y=`linear-gradient(${H}, ${q} 0px`;else{const se=ee/(J.length-1)*A;Y+=`, ${q} ${se}px`}}return Y+")"}return V.color??g.F}function K(L){if(L.valueDisplayMode==="text")return L.theme.colors.text.primary;const{value:A}=L;return A.color?A.color:g.F}function T(L,A,N,V,z,w,H){const Q={color:A,height:`${V}px`,maxWidth:`${N}px`,display:"flex",alignItems:"center",textWrap:"nowrap",lineHeight:b};let Z=N;const Y=(0,l.cN)(L);return M(z)?(Q.fontSize=H?.valueSize??(0,x.Vr)(Y,Z,V,b),Q.justifyContent="center"):(Q.fontSize=H?.valueSize??(0,x.Vr)(Y,Z-D*2,V,b),Q.justifyContent="flex-end",Q.paddingLeft=`${D}px`,Q.paddingRight=`${D+(w?C:0)}px`,Z-=D),Q}},97611:(te,R,e)=>{"use strict";e.d(R,{yV:()=>K,yp:()=>W,$p:()=>B,F8:()=>S,SV:()=>_});var n=e(74848),a=e(22803),s=e(96540),i=e(45861),r=e(21539),u=e(84140),o=e(95004),l=e(55386),g=e(739),f=e(8255),p=e(53568),c=e(53431),x=e(30703);const v=({percentChange:T,styles:L})=>{let A;return T>0?A="arrow-up":T<0&&(A="arrow-down"),(0,n.jsxs)("div",{style:L.containerStyles,children:[A&&(0,n.jsx)(x.I,{name:A,height:L.iconSize,width:L.iconSize,viewBox:"6 6 12 12"}),m(T)]})},m=T=>(T/100).toLocaleString(void 0,{style:"percent",maximumSignificantDigits:3}),y=1.2,h=30,d=500;class E{constructor(L){this.props=L;const{width:A,height:N,value:V,text:z}=L;this.valueColor=V.color??"gray",this.panelPadding=N>100?12:8,this.textValues=j(L),this.justifyCenter=O(L.justifyMode,this.textValues.title),this.valueToAlignTo=this.textValues.valueToAlignTo,this.titleToAlignTo=this.textValues.titleToAlignTo,this.titleFontSize=0,this.valueFontSize=0,this.percentFontSize=0,this.chartHeight=0,this.chartWidth=0,this.maxTextWidth=A-this.panelPadding*2,this.maxTextHeight=N-this.panelPadding*2,z&&(z.titleSize&&(this.titleFontSize=z.titleSize,this.titleToAlignTo=void 0),z.valueSize&&(this.valueFontSize=z.valueSize,this.valueToAlignTo=""),z.percentSize&&(this.percentFontSize=z.percentSize))}getTitleStyles(){const L={fontSize:`${this.titleFontSize}px`,lineHeight:y};return(this.props.colorMode===W.Background||this.props.colorMode===W.BackgroundSolid)&&(L.color=(0,f.mZ)(this.valueColor,this.props.theme.isDark)),L}getValueStyles(){const L={fontSize:this.valueFontSize,fontWeight:d,lineHeight:y,position:"relative",zIndex:1};switch(this.justifyCenter&&(L.textAlign="center"),this.props.colorMode){case W.Value:L.color=this.valueColor;break;case W.Background:case W.BackgroundSolid:L.color=(0,f.mZ)(this.valueColor,this.props.theme.isDark);break;case W.None:L.color=this.props.theme.colors.text.primary;break}return L}getPercentChangeStyles(L,A,N){const z=this.getValueAndTitleContainerStyles(),w=this.percentFontSize||Math.max(this.valueFontSize/2.5,12);let H=this.percentFontSize?this.percentFontSize-3:Math.max(this.valueFontSize/3,10);const Q=this.props.theme.visualization,Z=U(L,A,N,Q),Y={fontSize:w,fontWeight:d,lineHeight:y,position:"relative",display:"flex",alignItems:"center",gap:Math.max(w/3,4),zIndex:1,color:Z};switch(this.justifyCenter&&(Y.textAlign="center"),z.flexDirection==="column"&&w>12&&(Y.marginTop=-(w/4)),z.flexDirection==="row"&&(Y.alignItems="baseline",Y.lineHeight=y*2.5),this.props.colorMode){case W.Background:case W.BackgroundSolid:Y.color=(0,f.mZ)(this.valueColor,this.props.theme.isDark);break}return this.props.textMode===_.None&&(Y.fontSize=(0,p.Vr)(m(L),this.maxTextWidth*.8,this.maxTextHeight*.8,y,void 0,d),H=Y.fontSize*.8),{containerStyles:Y,iconSize:H}}getValueAndTitleContainerStyles(){const L={display:"flex",flexWrap:"wrap"};return this.justifyCenter&&(L.alignItems="center",L.justifyContent="center",L.flexGrow=1,L.gap="0.75ch"),L}getPanelStyles(){const{width:L,height:A,theme:N,colorMode:V,textMode:z}=this.props,w={width:`${L}px`,height:`${A}px`,padding:`${z===_.None?2:this.panelPadding}px`,borderRadius:N.shape.radius.default,position:"relative",display:"flex"},H=N.isDark?1:-.7;switch(V){case W.Background:const Q=(0,u.A)(this.valueColor).darken(15*H).spin(8).toRgbString(),Z=(0,u.A)(this.valueColor).darken(5*H).spin(-8).toRgbString();w.background=`linear-gradient(120deg, ${Q}, ${Z})`;break;case W.BackgroundSolid:w.background=(0,u.A)(this.valueColor).toString();break;case W.Value:w.background="transparent";break}return this.justifyCenter&&(w.alignItems="center",w.flexDirection="row"),w}renderChart(){const{sparkline:L,colorMode:A}=this.props;if(!L||L.y?.type!==o.PU.number)return null;let N,V;switch(A){case W.Background:case W.BackgroundSolid:N="rgba(255,255,255,0.4)",V=(0,u.A)(this.valueColor).brighten(40).toRgbString();break;case W.None:case W.Value:default:V=this.valueColor,N=(0,u.A)(this.valueColor).setAlpha(.2).toRgbString();break}const z={custom:{drawStyle:g.GR.Line,lineWidth:1,fillColor:N,lineColor:V}};return(0,n.jsx)("div",{style:this.getChartStyles(),children:(0,n.jsx)(c.O,{height:this.chartHeight,width:this.chartWidth,sparkline:L,config:z,theme:this.props.theme})})}getChartStyles(){return{position:"absolute",right:0,bottom:0}}}class b extends E{constructor(L){super(L);const A=this.titleToAlignTo?.length?.3:1;this.valueToAlignTo.length&&(this.valueFontSize=(0,p.Vr)(this.valueToAlignTo,this.maxTextWidth*A,this.maxTextHeight,y,void 0,d)),this.titleToAlignTo?.length&&(this.titleFontSize=(0,p.Vr)(this.titleToAlignTo,this.maxTextWidth*.6,this.maxTextHeight,y,h),this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize))}getValueAndTitleContainerStyles(){const L=super.getValueAndTitleContainerStyles();return L.flexDirection="row",L.alignItems="center",L.flexGrow=1,this.justifyCenter||(L.justifyContent="space-between"),L}renderChart(){return null}getPanelStyles(){const L=super.getPanelStyles();return L.alignItems="center",L}}class D extends E{constructor(L){super(L);const{width:A,height:N}=L,V=.5,z=.6,w=1-z,H=.4;this.chartWidth=A,this.chartHeight=N*V,this.titleToAlignTo?.length&&(this.titleFontSize=(0,p.Vr)(this.titleToAlignTo,this.maxTextWidth*z,this.maxTextHeight*H,y,h)),this.valueToAlignTo.length&&(this.valueFontSize=(0,p.Vr)(this.valueToAlignTo,this.maxTextWidth*w,this.maxTextHeight*V,y,void 0,d))}getValueAndTitleContainerStyles(){const L=super.getValueAndTitleContainerStyles();return L.flexDirection="row",L.flexGrow=1,this.justifyCenter||(L.justifyContent="space-between"),L}getPanelStyles(){const L=super.getPanelStyles();return L.flexDirection="row",L.justifyContent="space-between",L}}class C extends E{constructor(L){super(L);const{width:A,height:N}=L,V=.15,z=.25;let w=0;this.chartHeight=N*z,this.chartWidth=A,this.titleToAlignTo?.length&&(this.titleFontSize=(0,p.Vr)(this.titleToAlignTo,this.maxTextWidth,N*V,y,h),w=this.titleFontSize*y),this.valueToAlignTo.length&&(this.valueFontSize=(0,p.Vr)(this.valueToAlignTo,this.maxTextWidth,this.maxTextHeight-this.chartHeight-w,y,void 0,d)),this.titleToAlignTo?.length&&(this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize)),this.chartHeight=N-this.titleFontSize*y-this.valueFontSize*y}getValueAndTitleContainerStyles(){const L=super.getValueAndTitleContainerStyles();return L.flexDirection="column",L.justifyContent="center",L}getPanelStyles(){const L=super.getPanelStyles();return L.flexDirection="column",L}}class P extends E{constructor(L){super(L);const{height:A}=L,N=.15;let V=0;this.titleToAlignTo?.length&&(this.titleFontSize=(0,p.Vr)(this.titleToAlignTo,this.maxTextWidth,A*N,y,h),V=this.titleFontSize*y),this.valueToAlignTo.length&&(this.valueFontSize=(0,p.Vr)(this.valueToAlignTo,this.maxTextWidth,this.maxTextHeight-V,y,void 0,d)),this.titleToAlignTo?.length&&(this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize))}getValueAndTitleContainerStyles(){const L=super.getValueAndTitleContainerStyles();return L.flexDirection="column",L.flexGrow=1,L}renderChart(){return null}getPanelStyles(){const L=super.getPanelStyles();return L.alignItems="center",L}}function M(T){const{width:L,height:A,sparkline:N}=T;return L/A>2.5&&!T.disableWideLayout?A>50&&N&&N.y.values.length>1?new D(T):new b(T):A>100&&N&&N.y.values.length>1?new C(T):new P(T)}function O(T,L){return T===S.Center?!0:(L??"").length===0}function j(T){const{value:L,alignmentFactors:A,count:N}=T;let{textMode:V}=T;const z=A?A.title:L.title,w=(0,l.cN)(A||L);switch(V===_.Auto&&(N??1)===1&&(V=_.Value),V){case _.Name:return{...L,title:void 0,prefix:void 0,suffix:void 0,text:L.title||"",titleToAlignTo:void 0,valueToAlignTo:z??"",tooltip:(0,l.cN)(L)};case _.Value:return{...L,title:void 0,titleToAlignTo:void 0,valueToAlignTo:w,tooltip:L.title};case _.None:return{numeric:L.numeric,color:L.color,title:void 0,text:"",titleToAlignTo:void 0,valueToAlignTo:"1",tooltip:`Name: ${L.title}
Value: ${(0,l.cN)(L)}`};case _.ValueAndName:default:return{...L,titleToAlignTo:z,valueToAlignTo:w}}}function U(T,L,A,N){return L===g.CD.SameAsValue?A.color:T*(L===g.CD.Inverted?-1:1)>0?N.getColorByName("green"):N.getColorByName("red")}var W=(T=>(T.Background="background",T.BackgroundSolid="background_solid",T.None="none",T.Value="value",T))(W||{}),B=(T=>(T.None="none",T.Line="line",T.Area="area",T))(B||{}),S=(T=>(T.Auto="auto",T.Center="center",T))(S||{}),_=(T=>(T.Auto="auto",T.Value="value",T.ValueAndName="value_and_name",T.Name="name",T.None="none",T))(_||{});class K extends s.PureComponent{static{this.defaultProps={justifyMode:"auto"}}render(){const{onClick:L,className:A,hasLinks:N,theme:V}=this.props,z=M(this.props),w=z.getPanelStyles(),H=z.getValueAndTitleContainerStyles(),Q=z.getValueStyles(),Z=z.getTitleStyles(),Y=z.textValues,X=this.props.value.percentChange,I=this.props.percentChangeColorMode,J=X!=null&&!Number.isNaN(X),ee=N?void 0:Y.tooltip;return L?(0,n.jsxs)("button",{type:"button",className:(0,a.cx)((0,i.my)(V),A),style:w,onClick:L,title:ee,children:[(0,n.jsxs)("div",{style:H,children:[Y.title&&(0,n.jsx)("div",{style:Z,children:Y.title}),(0,n.jsx)(r.i,{value:Y,style:Q})]}),z.renderChart()]}):(0,n.jsxs)("div",{className:A,style:w,title:ee,children:[(0,n.jsxs)("div",{style:H,children:[Y.title&&(0,n.jsx)("div",{style:Z,children:Y.title}),(0,n.jsx)(r.i,{value:Y,style:Q}),J&&(0,n.jsx)(v,{percentChange:X,styles:z.getPercentChangeStyles(X,I,Q)})]}),z.renderChart()]})}}},88977:(te,R,e)=>{"use strict";e.d(R,{J:()=>l});var n=e(74848),a=e(22803),s=e(96540),i=e(23257),r=e.n(i),u=e(63142),o=e(20662);const l=(0,s.forwardRef)(({name:f,value:p,hidden:c,facets:x,onClick:v,className:m,loading:y,searchTerm:h,active:d,style:E,title:b,highlightParts:D,...C},P)=>{const M=(0,u.$j)(),O=g(M),j=h?[h]:[],U=(0,s.useCallback)(B=>{v&&!c&&v(f,p,B)},[v,f,c,p]);let W=p||f;return x&&(W=`${W} (${x})`),(0,n.jsx)("button",{ref:P,onClick:U,style:E,title:b||W,type:"button",role:"option","aria-selected":!!d,className:(0,a.cx)(O.base,d&&O.active,y&&O.loading,c&&O.hidden,m,v&&!c&&O.hover),...C,children:D!==void 0?(0,n.jsx)(o.z,{text:W,highlightClassName:O.matchHighLight,highlightParts:D}):(0,n.jsx)(r(),{textToHighlight:W,searchWords:j,autoEscape:!0,highlightClassName:O.matchHighLight})},W)});l.displayName="Label";const g=f=>({base:(0,a.css)({display:"inline-block",cursor:"pointer",fontSize:f.typography.size.sm,lineHeight:f.typography.bodySmall.lineHeight,backgroundColor:f.colors.background.secondary,color:f.colors.text.primary,whiteSpace:"nowrap",textShadow:"none",padding:f.spacing(.5),borderRadius:f.shape.radius.default,border:"none",marginRight:f.spacing(1),marginBottom:f.spacing(.5)}),loading:(0,a.css)({fontWeight:f.typography.fontWeightMedium,backgroundColor:f.colors.primary.shade,color:f.colors.text.primary,[f.transitions.handleMotion("no-preference","reduce")]:{animation:"pulse 3s ease-out 0s infinite normal forwards"},"@keyframes pulse":{"0%":{color:f.colors.text.primary},"50%":{color:f.colors.text.secondary},"100%":{color:f.colors.text.disabled}}}),active:(0,a.css)({fontWeight:f.typography.fontWeightMedium,backgroundColor:f.colors.primary.main,color:f.colors.primary.contrastText}),matchHighLight:(0,a.css)({background:"inherit",color:f.components.textHighlight.text,backgroundColor:f.components.textHighlight.background}),hidden:(0,a.css)({opacity:.6,cursor:"default",border:"1px solid transparent"}),hover:(0,a.css)({"&:hover":{opacity:.85,cursor:"pointer"}})})},93256:(te,R,e)=>{"use strict";e.d(R,{e:()=>r});var n=e(74848),a=e(22803),s=e(96540),i=e(63142);const r=(0,s.forwardRef)(({className:o,children:l,...g},f)=>{const p=(0,i.of)(u);return(0,n.jsx)("div",{ref:f,className:(0,a.cx)("button-group",p.wrapper,o),...g,children:l})});r.displayName="ButtonGroup";const u=o=>({wrapper:(0,a.css)({display:"flex",borderRadius:o.shape.radius.default,"> .button-group:not(:first-child) > button, > button:not(:first-child)":{borderTopLeftRadius:"unset",borderBottomLeftRadius:"unset",borderLeft:"1px solid rgba(255, 255, 255, 0.12)"},"> .button-group:not(:last-child) > button, > button:not(:last-child)":{borderTopRightRadius:"unset",borderBottomRightRadius:"unset",borderRight:"1px solid rgba(0, 0, 0, 0.12)"}})})},43951:(te,R,e)=>{"use strict";e.d(R,{c:()=>i});var n=e(74848),a=e(22803),s=e(63142);const i=({message:u,callToActionElement:o,footer:l,className:g})=>{const f=(0,s.of)(r);return(0,n.jsxs)("div",{className:(0,a.cx)([f.wrapper,g]),children:[u&&(0,n.jsx)("div",{className:f.message,children:u}),o,l&&(0,n.jsx)("div",{className:f.footer,children:l})]})},r=u=>({wrapper:(0,a.css)({label:"call-to-action-card",background:u.colors.background.secondary,borderRadius:u.shape.radius.default,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexGrow:1,padding:u.spacing(3),[u.breakpoints.down("sm")]:{padding:u.spacing(3,1)}}),message:(0,a.css)({marginBottom:u.spacing(3),fontStyle:"italic"}),footer:(0,a.css)({marginTop:u.spacing(3)})})},8073:(te,R,e)=>{"use strict";e.d(R,{H:()=>M,Z:()=>g});var n=e(74848),a=e(22803),s=e(96540),i=e(92745),r=e(63142),u=e(35484),o=e(43856);const l=s.createContext(null),g=({disabled:O,href:j,onClick:U,children:W,isSelected:B,isCompact:S,className:_,noMargin:K,...T})=>{const L=(0,s.useMemo)(()=>s.Children.toArray(W).some(z=>s.isValidElement(z)&&z.type===f),[W]),A=O||!U&&!j,N=U&&!O?U:void 0,V=(0,r.of)(o.i,O,A,B,S,K);return(0,n.jsx)(o.Q,{disableEvents:O,disableHover:A,isSelected:B,className:(0,a.cx)(V.container,_),noMargin:K,...T,children:(0,n.jsxs)(l.Provider,{value:{href:j,onClick:N,disabled:O,isSelected:B},children:[!L&&(0,n.jsx)(f,{}),W]})})};g.displayName="Card";const f=({children:O,className:j,"aria-label":U})=>{const W=(0,s.useContext)(l),B=(0,r.of)(p),{href:S,onClick:_,isSelected:K}=W??{href:void 0,onClick:void 0,isSelected:void 0},T=(0,i.t)("grafana-ui.card.option","option");return(0,n.jsxs)("h2",{className:(0,a.cx)(B.heading,j),children:[S?(0,n.jsx)("a",{href:S,className:B.linkHack,"aria-label":U,onClick:_,children:O}):_?(0,n.jsx)("button",{onClick:_,className:B.linkHack,"aria-label":U,type:"button",children:O}):(0,n.jsx)(n.Fragment,{children:O}),K!==void 0&&(0,n.jsx)("input",{"aria-label":T,type:"radio",checked:K,readOnly:!0})]})};f.displayName="Heading";const p=O=>({heading:(0,a.css)({gridArea:"Heading",justifySelf:"start",display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:0,fontSize:O.typography.size.md,letterSpacing:"inherit",lineHeight:O.typography.body.lineHeight,color:O.colors.text.primary,fontWeight:O.typography.fontWeightMedium,"& input[readonly]":{cursor:"inherit"}}),linkHack:(0,a.css)({all:"unset","&::after":{position:"absolute",content:'""',top:0,bottom:0,left:0,right:0,borderRadius:O.shape.radius.default},"&:focus-visible":{outline:"none",outlineOffset:0,boxShadow:"none","&::after":{...(0,u.getFocusStyles)(O),zIndex:1}}})}),c=({children:O,className:j})=>{const U=(0,r.of)(x);return(0,n.jsx)("div",{className:(0,a.cx)(U.tagList,j),children:O})};c.displayName="Tags";const x=O=>({tagList:(0,a.css)({position:"relative",gridArea:"Tags",alignSelf:"center"})}),v=({children:O,className:j})=>{const U=(0,r.of)(m),W=typeof O=="string"?"p":"div";return(0,n.jsx)(W,{className:(0,a.cx)(U.description,j),children:O})};v.displayName="Description";const m=O=>({description:(0,a.css)({width:"100%",gridArea:"Description",margin:O.spacing(1,0,0),color:O.colors.text.secondary,lineHeight:O.typography.body.lineHeight})}),y=({children:O,align:j="start",className:U})=>{const W=(0,r.of)(h);return(0,n.jsx)("div",{className:(0,a.cx)(W.media,U,(0,a.css)({alignSelf:j})),children:O})};y.displayName="Figure";const h=O=>({media:(0,a.css)({position:"relative",gridArea:"Figure",marginRight:O.spacing(2),width:"40px","> img":{width:"100%"},"&:empty":{display:"none"}})}),d=(0,s.memo)(({children:O,className:j,separator:U="|"})=>{const W=(0,r.of)(E);let B=O;const S=s.Children.toArray(O).filter(Boolean);return S.length?(B=S.map((_,K)=>(0,n.jsx)("div",{className:W.metadataItem,children:_},`element_${K}`)),S.length>1&&U&&(B=S.reduce((_,K,T)=>[_,(0,n.jsx)("span",{className:W.separator,children:U},`separator_${T}`),K])),(0,n.jsx)("div",{className:(0,a.cx)(W.metadata,j),children:B})):null});d.displayName="Meta";const E=O=>({metadata:(0,a.css)({gridArea:"Meta",display:"flex",alignItems:"center",width:"100%",fontSize:O.typography.size.sm,color:O.colors.text.secondary,margin:O.spacing(.5,0,0),lineHeight:O.typography.bodySmall.lineHeight,overflowWrap:"anywhere"}),metadataItem:(0,a.css)({zIndex:0}),separator:(0,a.css)({margin:`0 ${O.spacing(1)}`})}),b=({children:O,disabled:j,variant:U,className:W})=>{const B=(0,r.of)(D),_=(0,s.useContext)(l)?.disabled||j,K=U==="primary"?B.actions:B.secondaryActions;return(0,n.jsx)("div",{className:(0,a.cx)(K,W),children:s.Children.map(O,T=>s.isValidElement(T)?(0,s.cloneElement)(T,{disabled:_,...T.props}):null)})},D=O=>({actions:(0,a.css)({display:"flex",flexDirection:"row",flexWrap:"wrap",gap:O.spacing(1),gridArea:"Actions",marginTop:O.spacing(2)}),secondaryActions:(0,a.css)({alignSelf:"center",color:O.colors.text.secondary,display:"flex",flexDirection:"row",flexWrap:"wrap",gap:O.spacing(1),gridArea:"Secondary",marginTop:O.spacing(2)})}),C=({children:O,disabled:j,className:U})=>(0,n.jsx)(b,{variant:"primary",disabled:j,className:U,children:O});C.displayName="Actions";const P=({children:O,disabled:j,className:U})=>(0,n.jsx)(b,{variant:"secondary",disabled:j,className:U,children:O});P.displayName="SecondaryActions";const M=O=>({inner:(0,a.css)({display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",flexWrap:"wrap"}),...p(O),...E(O),...m(O),...h(O),...D(O),...x(O)});g.Heading=f,g.Tags=c,g.Figure=y,g.Meta=d,g.Actions=C,g.SecondaryActions=P,g.Description=v},43856:(te,R,e)=>{"use strict";e.d(R,{Q:()=>o,i:()=>l});var n=e(74848),a=e(22803),s=e(63142),i=e(35484);const r=({children:g,href:f})=>{const{inner:p}=(0,s.of)(u);return f?(0,n.jsx)("a",{className:p,href:f,children:g}):(0,n.jsx)(n.Fragment,{children:g})},u=g=>({inner:(0,a.css)({display:"flex",width:"100%",padding:g.spacing(2)})}),o=({children:g,disableEvents:f,disableHover:p,isSelected:c,className:x,href:v,noMargin:m,...y})=>{const{oldContainer:h}=(0,s.of)(l,f,p,c,void 0,m);return(0,n.jsx)("div",{...y,className:(0,a.cx)(h,x),children:(0,n.jsx)(r,{href:v,children:g})})},l=(g,f=!1,p=!1,c,x,v=!1)=>{const m=c!==void 0;return{container:(0,a.css)({display:"grid",position:"relative",gridTemplateColumns:"auto 1fr auto",gridTemplateRows:"1fr auto auto auto",gridAutoColumns:"1fr",gridAutoFlow:"row",gridTemplateAreas:`
        "Figure Heading Tags"
        "Figure Meta Tags"
        "Figure Description Tags"
        "Figure Actions Secondary"`,width:"100%",padding:g.spacing(x?1:2),background:g.colors.background.secondary,borderRadius:g.shape.radius.default,marginBottom:g.spacing(v?0:1),pointerEvents:f?"none":"auto",[g.transitions.handleMotion("no-preference","reduce")]:{transition:g.transitions.create(["background-color","box-shadow","border-color","color"],{duration:g.transitions.duration.short})},...!p&&{"&:hover":{background:g.colors.emphasize(g.colors.background.secondary,.03),cursor:"pointer",zIndex:1},"&:focus":(0,i.getFocusStyles)(g)},...m&&{cursor:"pointer"},...c&&{outline:`solid 2px ${g.colors.primary.border}`}}),oldContainer:(0,a.css)({display:"flex",width:"100%",background:g.colors.background.secondary,borderRadius:g.shape.radius.default,position:"relative",pointerEvents:f?"none":"auto",marginBottom:g.spacing(v?0:1),[g.transitions.handleMotion("no-preference","reduce")]:{transition:g.transitions.create(["background-color","box-shadow","border-color","color"],{duration:g.transitions.duration.short})},...!p&&{"&:hover":{background:g.colors.emphasize(g.colors.background.secondary,.03),cursor:"pointer",zIndex:1},"&:focus":(0,i.getFocusStyles)(g)}})}}},56873:(te,R,e)=>{"use strict";e.d(R,{F:()=>x});var n=e(74848),a=e(22803),s=e(18828),i=e(42211),r=e(93225),u=e(51182),o=e(96540),l=e(92745),g=e(63142),f=e(34999),p=e(45861),c=e(76319);const x=({images:m})=>{const[y,h]=(0,o.useState)(null),[d,E]=(0,o.useState)({}),[b,D]=(0,o.useState)(m),C=(0,g.of)(v),P=(0,g.of)(p.my),M=L=>{E(A=>({...A,[L]:!0}))};(0,o.useEffect)(()=>{const L=m.filter(A=>!d[A.path]);D(L)},[d,m]);const O=L=>{h(L)},j=()=>{h(null)},U=()=>{y!==null&&b.length>0&&h((y+1)%b.length)},W=()=>{y!==null&&b.length>0&&h((y-1+b.length)%b.length)},B=L=>{if(y!==null)switch(L.key){case"ArrowRight":U();break;case"ArrowLeft":W();break;case"Escape":j();break;default:break}},S=(0,o.useRef)(null),{overlayProps:_,underlayProps:K}=(0,r.e)({isOpen:y!==null,onClose:j},S),{dialogProps:T}=(0,s.s)({},S);return b.length===0?(0,n.jsx)(f.F,{title:(0,l.t)("carousel.error","Something went wrong loading images"),severity:"warning","data-testid":"alert-warning"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:(0,a.cx)(C.imageGrid),children:b.map((L,A)=>(0,n.jsxs)("button",{type:"button",onClick:()=>O(A),className:(0,a.cx)(P,C.imageButton),children:[(0,n.jsx)("img",{src:L.path,alt:L.name,onError:()=>M(L.path)}),(0,n.jsx)("p",{children:L.name})]},L.path))}),y!==null&&(0,n.jsxs)(u.Sf,{children:[(0,n.jsx)("div",{role:"presentation",className:C.underlay,onClick:j,...K}),(0,n.jsx)(i.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsxs)("div",{"data-testid":"carousel-full-screen",ref:S,..._,...T,onKeyDown:B,className:C.overlay,children:[(0,n.jsx)(c.K,{name:"times","aria-label":(0,l.t)("carousel.close","Close"),size:"xl",onClick:j,className:(0,a.cx)(C.closeButton)}),(0,n.jsx)(c.K,{size:"xl",name:"angle-left","aria-label":(0,l.t)("carousel.previous","Previous"),onClick:W,"data-testid":"previous-button"}),(0,n.jsx)("div",{className:C.imageContainer,"data-testid":"carousel-full-image",children:(0,n.jsx)("img",{className:C.imagePreview,src:b[y].path,alt:b[y].name,onError:()=>M(b[y].path)})}),(0,n.jsx)(c.K,{size:"xl",name:"angle-right","aria-label":(0,l.t)("carousel.next","Next"),onClick:U,"data-testid":"next-button"})]})})]})]})},v=m=>({imageButton:(0,a.css)({textAlign:"left"}),imageContainer:(0,a.css)({display:"flex",justifyContent:"center",flex:1}),imagePreview:(0,a.css)({maxWidth:"100%",maxHeight:"80vh",objectFit:"contain"}),imageGrid:(0,a.css)({display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:m.spacing(2),marginBottom:"20px","& img":{width:"100%",height:"150px",objectFit:"cover",border:m.colors.border.strong,borderRadius:m.shape.radius.default,boxShadow:m.shadows.z1},"& p":{margin:m.spacing(.5,0),fontWeight:m.typography.fontWeightMedium,color:m.colors.text.primary}}),underlay:(0,a.css)({position:"fixed",zIndex:m.zIndex.modalBackdrop,inset:0,backgroundColor:m.components.overlay.background}),overlay:(0,a.css)({alignItems:"center",display:"flex",gap:m.spacing(1),height:"fit-content",marginBottom:"auto",marginTop:"auto",padding:m.spacing(2),position:"fixed",inset:0,zIndex:m.zIndex.modal}),closeButton:(0,a.css)({color:m.colors.text.primary,position:"fixed",top:m.spacing(2),right:m.spacing(2)})})},64913:(te,R,e)=>{"use strict";e.d(R,{v:()=>E});var n=e(74848),a=e(22803),s=e(47078),i=e.n(s),r=e(38092),u=e(96540),o=e(92745),l=e(63142),g=e(30703),f=e(76319),p=e(63527),c=e(41654),x=e(18857),v=e(78121),m=e(21133);const y=(0,a.css)({"&:focus":{outline:"none"}}),h=" / ";class d extends u.PureComponent{constructor(D){super(D),this.flattenOptions=(O,j=[])=>{let U=[];for(const W of O){const B=[...j];B.push(W),!W.items||W.items.length===0?U.push({singleLabel:B[B.length-1].label,label:B.map(S=>S.label).join(this.props.separator||h),value:B.map(S=>S.value)}):U=[...U,...this.flattenOptions(W.items,B)]}return U},this.getSearchableOptions=i()(O=>this.flattenOptions(O)),this.onChange=(O,j)=>{const U=this.props.hideActiveLevelLabel?"":this.props.displayAllSelectedLevels?j.map(B=>B.label).join(this.props.separator||h):j[j.length-1].label,W={rcValue:{value:O,label:U},focusCascade:!0,activeLabel:U,isSearching:!1,inputValue:U};this.setState(W),this.props.onSelect(j[j.length-1].value)},this.onSelect=O=>{const j=O.value||[],U=this.props.displayAllSelectedLevels?O.label:O.singleLabel||"",W={activeLabel:U,inputValue:U,rcValue:{value:j,label:U},isSearching:!1,focusCascade:!1};this.setState(W),this.props.onSelect(j[j.length-1])},this.onCreateOption=O=>{this.setState({activeLabel:O,inputValue:O,rcValue:[],isSearching:!1}),this.props.onSelect(O)},this.onBlur=()=>{this.setState({isSearching:!1,focusCascade:!1}),this.state.activeLabel===""&&this.setState({rcValue:[]}),this.props.onBlur?.()},this.onBlurCascade=()=>{this.setState({focusCascade:!1}),this.props.onBlur?.()},this.onInputKeyDown=O=>{if(["ArrowDown","ArrowUp","Enter","ArrowLeft","ArrowRight"].includes(O.key))return;const{activeLabel:j}=this.state;this.setState({focusCascade:!1,isSearching:!0,inputValue:j})},this.onSelectInputChange=O=>{this.setState({inputValue:O})};const C=this.getSearchableOptions(D.options),{rcValue:P,activeLabel:M}=this.setInitialValue(C,D.initialValue);this.state={isSearching:!1,focusCascade:!1,rcValue:P,activeLabel:M,inputValue:""}}static{this.defaultProps={changeOnSelect:!0}}setInitialValue(D,C){if(!C)return{rcValue:[],activeLabel:""};for(const P of D){const M=P.value||[];if(M[M.length-1]===C)return{rcValue:M,activeLabel:this.props.displayAllSelectedLevels?P.label:P.singleLabel||""}}return this.props.allowCustomValue?{rcValue:[],activeLabel:C}:{rcValue:[],activeLabel:""}}render(){const{allowCustomValue:D,formatCreateLabel:C,placeholder:P,width:M,changeOnSelect:O,options:j,disabled:U,id:W,isClearable:B,theme:S}=this.props,{focusCascade:_,isSearching:K,rcValue:T,activeLabel:L,inputValue:A}=this.state,N=this.getSearchableOptions(j),V=(0,m.T)(S);return(0,n.jsx)("div",{children:K?(0,n.jsx)(x.l6,{allowCustomValue:D,placeholder:P,autoFocus:!_,onChange:this.onSelect,onBlur:this.onBlur,options:N,onCreateOption:this.onCreateOption,formatCreateLabel:C,width:M,onInputChange:this.onSelectInputChange,disabled:U,inputValue:A,inputId:W}):(0,n.jsx)(r.A,{onChange:(0,v.k)(this.onChange),options:j,changeOnSelect:O,value:T.value,fieldNames:{label:"label",value:"value",children:"items"},expandIcon:null,open:this.props.alwaysOpen,disabled:U,dropdownClassName:V.dropdown,children:(0,n.jsx)("div",{className:y,children:(0,n.jsx)(p.p,{autoFocus:this.props.autoFocus,width:M,placeholder:P,onBlur:this.onBlurCascade,value:L,onKeyDown:this.onInputKeyDown,onChange:()=>{},suffix:(0,n.jsxs)(c.B,{gap:.5,children:[B&&L!==""&&(0,n.jsx)(f.K,{name:"times","aria-label":(0,o.t)("grafana-ui.cascader.clear-button","Clear selection"),onClick:z=>{z.preventDefault(),z.stopPropagation(),this.setState({rcValue:[],activeLabel:"",inputValue:""}),this.props.onSelect("")}}),(0,n.jsx)(g.I,{name:_?"angle-up":"angle-down"})]}),disabled:U,id:W})})})})}}const E=(0,l.cV)(d)},78121:(te,R,e)=>{"use strict";e.d(R,{W:()=>a,k:()=>n});const n=r=>(u,o)=>{r&&r(u.map(l=>String(l)),s(o))},a=r=>u=>{r&&r(s(u))},s=r=>r.map(i),i=r=>{const u=r.value?String(r.value):"";return{value:u,label:typeof r.label=="string"?r.label:u}}},21133:(te,R,e)=>{"use strict";e.d(R,{T:()=>o});var n=e(22803),a=e(58851);const s=(0,n.keyframes)({"0%":{opacity:0,transformOrigin:"0% 0%",transform:"scaleY(0.8)"},"100%":{opacity:1,transformOrigin:"0% 0%",transform:"scaleY(1)"}}),i=(0,n.keyframes)({"0%":{opacity:1,transformOrigin:"0% 0%",transform:"scaleY(1)"},"100%":{opacity:0,transformOrigin:"0% 0%",transform:"scaleY(0.8)"}}),r=(0,n.keyframes)({"0%":{opacity:0,transformOrigin:"0% 100%",transform:"scaleY(0.8)"},"100%":{opacity:1,transformOrigin:"0% 100%",transform:"scaleY(1)"}}),u=(0,n.keyframes)({"0%":{opacity:1,transformOrigin:"0% 100%",transform:"scaleY(1)"},"100%":{opacity:0,transformOrigin:"0% 100%",transform:"scaleY(0.8)"}}),o=l=>{const g=(0,a.hO)("angle-right");return{dropdown:(0,n.css)({"&.rc-cascader-dropdown":{position:"absolute",zIndex:9999,"&-hidden":{display:"none"}},".rc-cascader":{"&-menus":{overflow:"hidden",background:l.colors.background.elevated,border:"none",borderRadius:l.shape.radius.default,boxShadow:l.shadows.z3,whiteSpace:"nowrap","&.slide-up-enter, &.slide-up-appear":{animationDuration:"0.3s",animationFillMode:"both",transformOrigin:"0 0",opacity:0,animationTimingFunction:"cubic-bezier(0.08, 0.82, 0.17, 1)",animationPlayState:"paused"},"&.slide-up-enter.slide-up-enter-active.rc-cascader-menus-placement, &.slide-up-appear.slide-up-appear-active.rc-cascader-menus-placement":{"&-bottomLeft":{animationName:s,animationPlayState:"running"},"&-topLeft":{animationName:r,animationPlayState:"running"}},"&.slide-up-leave":{animationDuration:"0.3s",animationFillMode:"both",transformOrigin:"0 0",opacity:1,animationTimingFunction:"cubic-bezier(0.6, 0.04, 0.98, 0.34)",animationPlayState:"paused","&.slide-up-leave-active.rc-cascader-menus-placement":{"&-bottomLeft":{animationName:i,animationPlayState:"running"},"&-topLeft":{animationName:u,animationPlayState:"running"}}}},"&-menu":{display:"inline-block",maxWidth:"50vw",height:"192px",listStyle:"none",margin:0,padding:l.spacing(.5),borderRight:`1px solid ${l.colors.border.weak}`,overflow:"auto","&:last-child":{borderRight:0},"&-item":{height:l.spacing(4),lineHeight:l.spacing(4),padding:l.spacing(0,4,0,2),borderRadius:l.shape.radius.default,cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",transition:"all 0.3s ease",position:"relative","&:hover":{background:l.colors.action.hover},"&-disabled":{cursor:"not-allowed",color:l.colors.text.disabled,"&:hover":{background:"transparent"},"&:after":{position:"absolute",right:"12px",content:"'loading'",color:l.colors.text.disabled,fontStyle:"italic"}},"&-active":{color:l.colors.text.maxContrast,background:l.colors.background.secondary,"&:hover":{background:l.colors.action.hover}},"&-expand":{position:"relative","&:after":{background:l.colors.text.primary,content:"''",height:l.spacing(3),mask:`url(${g})`,maskType:"luminance",position:"absolute",right:0,top:l.spacing(.5),width:l.spacing(3)}}}}}})}}},8135:(te,R,e)=>{"use strict";e.d(R,{N:()=>s});var n=e(74848),a=e(96540);class s extends a.PureComponent{constructor(){super(...arguments),this.myRef=(0,a.createRef)(),this.state={hasEventListener:!1},this.onOutsideClick=r=>{const u=this.myRef.current;(!u||r.target instanceof Node&&!u.contains(r.target))&&this.props.onClick()}}static{this.defaultProps={includeButtonPress:!0,parent:typeof window<"u"?window:void 0,useCapture:!1}}componentDidMount(){this.props.parent.addEventListener("click",this.onOutsideClick,this.props.useCapture),this.props.includeButtonPress&&this.props.parent.addEventListener("keyup",this.onOutsideClick,this.props.useCapture)}componentWillUnmount(){this.props.parent.removeEventListener("click",this.onOutsideClick,this.props.useCapture),this.props.includeButtonPress&&this.props.parent.removeEventListener("keyup",this.onOutsideClick,this.props.useCapture)}render(){return(0,n.jsx)("div",{ref:this.myRef,children:this.props.children})}}},47931:(te,R,e)=>{"use strict";e.d(R,{b:()=>f});var n=e(74848),a=e(22803),s=e(96540),i=e(92745),r=e(63142),u=e(45861),o=e(30703),l=e(53371);const g=2*1e3;function f({onClipboardCopy:x,onClipboardError:v,children:m,getText:y,icon:h,variant:d,...E}){const b=(0,r.of)(c),[D,C]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let j;return D&&(j=setTimeout(()=>{C(!1)},g)),()=>{window.clearTimeout(j)}},[D]);const P=(0,s.useRef)(null),M=(0,s.useCallback)(async()=>{const j=y();try{await p(j,P),C(!0),x?.(j)}catch(U){v?.(j,U)}},[y,x,v]),O=(0,i.t)("clipboard-button.inline-toast.success","Copied");return(0,n.jsxs)(n.Fragment,{children:[D&&(0,n.jsx)(l.r,{placement:"top",referenceElement:P.current,children:O}),(0,n.jsxs)(u.$n,{onClick:M,icon:h,variant:D?"success":d,"aria-label":D?O:void 0,...E,className:(0,a.cx)(b.button,D&&b.successButton,E.className),ref:P,children:[m,D&&(0,n.jsx)("div",{className:b.successOverlay,children:(0,n.jsx)(o.I,{name:"check"})})]})]})}const p=async(x,v)=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(x);{const m=document.createElement("textarea");v.current?.appendChild(m),m.value=x,m.focus(),m.select(),document.execCommand("copy"),m.remove()}},c=x=>({button:(0,a.css)({position:"relative"}),successButton:(0,a.css)({"> *":(0,a.css)({visibility:"hidden"})}),successOverlay:(0,a.css)({position:"absolute",top:0,bottom:0,right:0,left:0,visibility:"visible"})})},74475:(te,R,e)=>{"use strict";e.d(R,{M:()=>f});var n=e(74848),a=e(22803),s=e(2543),i=e.n(s),r=e(96540),u=e(63142),o=e(35484),l=e(30703),g=e(68079);const f=({label:c,isOpen:x,onToggle:v,className:m,contentClassName:y,children:h,labelId:d,loading:E=!1,headerDataTestId:b,contentDataTestId:D,unmountContentWhenClosed:C=!0})=>{const[P,M]=(0,r.useState)(x),O=(0,u.of)(p),j=x!==void 0&&v!==void 0,U=j?x:P,W=K=>{K.target instanceof HTMLElement&&K.target.tagName==="A"||(K.preventDefault(),K.stopPropagation(),v?.(!x),j||M(!P))},{current:B}=(0,r.useRef)((0,s.uniqueId)()),S=d??`collapse-label-${B}`,_=(0,n.jsx)("div",{id:`collapse-content-${B}`,className:(0,a.cx)(O.content,y,{[O.contentHidden]:!C&&!U}),"data-testid":D,children:h});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{onClick:W,className:(0,a.cx)(O.header,m),children:[(0,n.jsx)("button",{type:"button",id:`collapse-button-${B}`,className:O.button,onClick:W,"aria-expanded":U&&!E,"aria-controls":`collapse-content-${B}`,"aria-labelledby":S,children:E?(0,n.jsx)(g.y,{className:O.spinner}):(0,n.jsx)(l.I,{name:U?"angle-up":"angle-down",className:O.icon})}),(0,n.jsx)("div",{className:O.label,id:`collapse-label-${B}`,"data-testid":b,children:c})]}),C?U&&_:_]})},p=c=>({header:(0,a.css)({display:"flex",cursor:"pointer",boxSizing:"border-box",flexDirection:"row-reverse",position:"relative",justifyContent:"space-between",fontSize:c.typography.size.lg,padding:`${c.spacing(.5)} 0`,"&:focus-within":(0,o.getFocusStyles)(c)}),button:(0,a.css)({all:"unset","&:focus-visible":{outline:"none",outlineOffset:"unset",transition:"none",boxShadow:"none"}}),icon:(0,a.css)({color:c.colors.text.secondary}),content:(0,a.css)({padding:`${c.spacing(2)} 0`}),contentHidden:(0,a.css)({display:"none"}),spinner:(0,a.css)({display:"flex",alignItems:"center",width:c.spacing(2)}),label:(0,a.css)({display:"flex",fontWeight:c.typography.fontWeightMedium,color:c.colors.text.maxContrast})})},89599:(te,R,e)=>{"use strict";e.d(R,{S:()=>g,a:()=>l});var n=e(74848),a=e(22803),s=e(96540),i=e(63142),r=e(45861),u=e(30703);const o=f=>({collapse:(0,a.css)({label:"collapse",marginBottom:f.spacing(1),backgroundColor:f.colors.background.primary,border:`1px solid ${f.colors.border.weak}`,position:"relative",borderRadius:f.shape.radius.default,width:"100%",display:"flex",flexDirection:"column",flex:"1 1 0"}),collapseBody:(0,a.css)({label:"collapse__body",padding:f.spacing(f.components.panel.padding),paddingTop:0,flex:1,overflow:"hidden",display:"flex",flexDirection:"column"}),bodyContentWrapper:(0,a.css)({label:"bodyContentWrapper",flex:1}),loader:(0,a.css)({label:"collapse__loader",height:"2px",position:"relative",overflow:"hidden",background:"none",margin:f.spacing(.5)}),loaderActive:(0,a.css)({label:"collapse__loader_active","&:after":{content:"' '",display:"block",width:"25%",top:0,height:"250%",position:"absolute",animation:"loader 2s cubic-bezier(0.17, 0.67, 0.83, 0.67) 500ms",animationIterationCount:100,left:"-25%",background:f.colors.primary.main},"@keyframes loader":{from:{left:"-25%",opacity:.1},to:{left:"100%",opacity:1}}}),header:(0,a.css)({label:"collapse__header",padding:f.spacing(1,2,1,2),display:"flex"}),headerCollapsed:(0,a.css)({label:"collapse__header--collapsed",padding:f.spacing(1,2,1,2)}),headerLabel:(0,a.css)({label:"collapse__header-label",fontWeight:f.typography.fontWeightMedium,marginRight:f.spacing(1),fontSize:f.typography.size.md,display:"flex",flex:"0 0 100%"}),icon:(0,a.css)({label:"collapse__icon",margin:f.spacing(.25,1,0,-1)})}),l=({isOpen:f,onToggle:p,...c})=>{const[x,v]=(0,s.useState)(f);return(0,n.jsx)(g,{isOpen:x,collapsible:!0,...c,onToggle:()=>{v(!x),p&&p(!x)}})},g=({isOpen:f,label:p,loading:c,collapsible:x,onToggle:v,className:m,children:y})=>{const h=(0,i.of)(r.my),d=(0,i.of)(o),E=()=>{v&&v(!f)},b=(0,a.cx)([d.collapse,m]),D=c?(0,a.cx)([d.loader,d.loaderActive]):(0,a.cx)([d.loader]),C=x?(0,a.cx)([d.header]):(0,a.cx)([d.headerCollapsed]);return(0,n.jsxs)("div",{className:b,children:[(0,n.jsxs)("button",{type:"button",className:(0,a.cx)(h,C),onClick:E,children:[x&&(0,n.jsx)(u.I,{className:d.icon,name:f?"angle-down":"angle-right"}),(0,n.jsx)("div",{className:(0,a.cx)([d.headerLabel]),children:p})]}),f&&(0,n.jsxs)("div",{className:(0,a.cx)([d.collapseBody]),children:[(0,n.jsx)("div",{className:D}),(0,n.jsx)("div",{className:d.bodyContentWrapper,children:y})]})]})};g.displayName="Collapse"},12173:(te,R,e)=>{"use strict";e.d(R,{A:()=>f});var n=e(74848),a=e(22803),s=e(2543),i=e.n(s),r=e(96540),u=e(84140),o=e(63142),l=e(63527);const g=(0,r.forwardRef)(({color:x,onChange:v,isClearable:m=!1,onClick:y,onBlur:h,disabled:d,buttonAriaLabel:E,...b},D)=>{const[C,P]=(0,r.useState)(x),[M,O]=(0,r.useState)(x),j=(0,r.useMemo)(()=>(0,s.debounce)(v,100),[]);(0,r.useEffect)(()=>{const B=(0,u.A)(x);B.isValid()&&x!==M&&(P(B.toString()),O(x))},[x,M]);const U=B=>{const{value:S}=B.currentTarget;if(P(S),S===""&&m){j(S);return}const _=(0,u.A)(S);_.isValid()&&j(_.toString())},W=B=>{(0,u.A)(C).isValid()||P(x),h?.(B)};return(0,n.jsx)(l.p,{...b,value:C,onChange:U,disabled:d,onClick:y,onBlur:W,addonBefore:(0,n.jsx)(p,{onClick:y,ariaLabel:E,disabled:d,color:x}),ref:D})});g.displayName="ColorInput";const f=g,p=({color:x,onClick:v,disabled:m,ariaLabel:y})=>{const h=(0,o.of)(c);return(0,n.jsx)("button",{type:"button",onClick:v,"aria-label":y,disabled:m||!v,className:(0,a.cx)(h,(0,a.css)({backgroundColor:x}))})},c=x=>(0,a.css)({height:"100%",width:`${x.spacing.gridSize*4}px`,borderRadius:`${x.shape.radius.default} 0 0 ${x.shape.radius.default}`,border:`1px solid ${x.colors.border.medium}`})},35427:(te,R,e)=>{"use strict";e.d(R,{Dp:()=>v,sk:()=>x});var n=e(74848),a=e(22803),s=e(96540),i=e(63142),r=e(65240),u=e(14226),o=e(2381),l=e(43533),g=e(89772),f=e(13409),p=e(57339);const c=(y,h="ColorPicker")=>class extends s.Component{constructor(){super(...arguments),this.pickerTriggerRef=(0,s.createRef)()}static{this.displayName=h}render(){const{theme:E,children:b,onChange:D,color:C}=this.props,P=m(E),M=s.createElement(y,{...this.props,children:null,onChange:D});return(0,n.jsx)(l.I,{content:M,hideAfter:300,children:(O,j,U)=>(0,n.jsxs)(n.Fragment,{children:[this.pickerTriggerRef.current&&(0,n.jsx)(o.A,{...U,referenceElement:this.pickerTriggerRef.current,wrapperClassName:P.colorPicker,onMouseLeave:j,onMouseEnter:O,onKeyDown:W=>(0,u.Q)(W,j)}),b?b({ref:this.pickerTriggerRef,showColorPicker:O,hideColorPicker:j}):(0,n.jsx)(f.q,{ref:this.pickerTriggerRef,onClick:O,onMouseLeave:j,color:E.visualization.getColorByName(C||"#000000"),"aria-label":C})]})})}},x=(0,i.cV)(c(g.$,"ColorPicker")),v=(0,i.cV)(c(p.o,"SeriesColorPicker")),m=(0,r.N)(y=>({colorPicker:(0,a.css)({position:"absolute",zIndex:y.zIndex.tooltip,color:y.colors.text.primary,maxWidth:"400px",fontSize:y.typography.size.sm})}))},89772:(te,R,e)=>{"use strict";e.d(R,{$:()=>b});var n=e(74848),a=e(22803),s=e(42211),i=e(96540),r=e(6773),u=e(92745),o=e(63142),l=e(65240),g=e(60208),f=e(54314),p=e(13409),c=e(2543);const v=({hue:C,selectedColor:P,onColorSelect:M,...O})=>{const j=(0,c.upperFirst)(C.name),U=(0,o.of)(m),W=(0,i.useMemo)(()=>[...C.shades].reverse(),[C.shades]);return(0,n.jsxs)("div",{className:U.colorRow,children:[(0,n.jsx)("div",{className:U.colorLabel,children:j}),(0,n.jsx)("div",{...O,className:U.swatchRow,children:W.map(B=>(0,n.jsx)(p.q,{"aria-label":B.name,variant:B.primary?p.h.Large:p.h.Small,isSelected:B.name===P,color:B.color,onClick:()=>M(B.name)},B.name))})]})},m=C=>({colorRow:(0,a.css)({display:"grid",gridTemplateColumns:"25% 1fr",gridColumnGap:C.spacing(2),padding:C.spacing(.5,0),"&:hover":{background:C.colors.background.secondary}}),colorLabel:(0,a.css)({paddingLeft:C.spacing(1),display:"flex",alignItems:"center"}),swatchRow:(0,a.css)({display:"flex",gap:C.spacing(1),alignItems:"center",justifyContent:"space-around",flexDirection:"row"})}),y=({color:C,onChange:P})=>{const M=(0,o.$j)(),O=(0,o.of)(h),j=[];for(const U of M.visualization.hues)j.push((0,n.jsx)(v,{selectedColor:C,hue:U,onColorSelect:P},U.name));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:O.swatches,children:j}),(0,n.jsxs)("div",{className:O.extraColors,children:[(0,n.jsx)(p.q,{isSelected:C==="transparent",color:"rgba(0,0,0,0)",label:(0,u.t)("grafana-ui.named-colors-palette.transparent-swatch","Transparent"),onClick:()=>P("transparent")}),(0,n.jsx)(p.q,{isSelected:C==="text",color:M.colors.text.primary,label:(0,u.t)("grafana-ui.named-colors-palette.text-color-swatch","Text color"),onClick:()=>P("text")})]})]})},h=C=>({container:(0,a.css)({display:"flex",flexDirection:"column"}),extraColors:(0,a.css)({display:"flex",alignItems:"center",justifyContent:"space-around",gap:C.spacing(1),padding:C.spacing(1,0)}),swatches:(0,a.css)({display:"grid",flexGrow:1})});var d=e(32550);class E extends i.Component{constructor(P){super(P),this.handleChange=M=>{const{onChange:O,enableNamedColors:j,theme:U}=this.props;if(j)return O(M);O(r.MV.asHexString(U.visualization.getColorByName(M)))},this.onTabChange=M=>()=>this.setState({activePicker:M}),this.renderPicker=()=>{const{activePicker:M}=this.state,{color:O}=this.props;switch(M){case"spectrum":return(0,n.jsx)(d.A,{color:O,onChange:this.handleChange});case"palette":return(0,n.jsx)(y,{color:O,onChange:this.handleChange});default:return this.renderCustomPicker(M)}},this.renderCustomPicker=M=>{const{customPickers:O,color:j,theme:U}=this.props;return O?i.createElement(O[M].tabComponent,{color:j,theme:U,onChange:this.handleChange}):null},this.renderCustomPickerTabs=()=>{const{customPickers:M}=this.props;return M?(0,n.jsx)(n.Fragment,{children:Object.keys(M).map(O=>(0,n.jsx)(g.o,{label:M[O].name,onChangeTab:this.onTabChange(O)},O))}):null},this.state={activePicker:"palette"}}render(){const{theme:P}=this.props,{activePicker:M}=this.state,O=D(P);return(0,n.jsx)(s.n1,{contain:!0,restoreFocus:!0,autoFocus:!0,children:(0,n.jsxs)("div",{tabIndex:-1,className:O.colorPickerPopover,children:[(0,n.jsxs)(f.U,{children:[(0,n.jsx)(g.o,{label:(0,u.t)("grafana-ui.color-picker-popover.palette-tab","Colors"),onChangeTab:this.onTabChange("palette"),active:M==="palette"}),(0,n.jsx)(g.o,{label:(0,u.t)("grafana-ui.color-picker-popover.spectrum-tab","Custom"),onChangeTab:this.onTabChange("spectrum"),active:M==="spectrum"}),this.renderCustomPickerTabs()]}),(0,n.jsx)("div",{className:O.colorPickerPopoverContent,children:this.renderPicker()})]})})}}const b=(0,o.cV)(E);b.displayName="ColorPickerPopover";const D=(0,l.N)(C=>({colorPickerPopover:(0,a.css)({borderRadius:C.shape.radius.default,boxShadow:C.shadows.z3,background:C.colors.background.elevated,padding:C.spacing(.5),border:`1px solid ${C.colors.border.weak}`}),colorPickerPopoverContent:(0,a.css)({width:"246px",fontSize:C.typography.bodySmall.fontSize,minHeight:"184px",height:"290px",padding:C.spacing(1),display:"flex",flexDirection:"column"}),colorPickerPopoverTabs:(0,a.css)({display:"flex",width:"100%",borderRadius:`${C.shape.radius.default} ${C.shape.radius.default} 0 0`})}))},13409:(te,R,e)=>{"use strict";e.d(R,{h:()=>g,q:()=>f});var n=e(74848),a=e(22803),s=e(95382),i=e(96540),r=e(84140),u=e(51898),o=e(92745),l=e(63142),g=(c=>(c.Small="small",c.Large="large",c))(g||{});const f=i.forwardRef(({color:c,label:x,variant:v="small",isSelected:m,"aria-label":y,...h},d)=>{const E=(0,l.$j)(),{isFocusVisible:b,focusProps:D}=(0,s.o)(),C=p(E,v,c,b,m),P=!!x,M=y||x;return(0,n.jsxs)("div",{ref:d,className:C.wrapper,"data-testid":u.Tp.components.ColorSwatch.name,...h,children:[P&&(0,n.jsx)("span",{className:C.label,children:x}),(0,n.jsx)("button",{className:C.swatch,...D,"aria-label":M?(0,o.t)("grafana-ui.color-swatch.aria-label-selected-color","{{colorLabel}} color",{colorLabel:M}):(0,o.t)("grafana-ui.color-swatch.aria-label-default","Pick a color"),type:"button"})]})}),p=(c,x,v,m,y)=>{const h=(0,r.A)(v),E=x==="small"?"16px":"32px";let b="none";return h.getAlpha()<.1&&(b=`2px solid ${c.colors.border.medium}`),{wrapper:(0,a.css)({display:"flex",alignItems:"center",cursor:"pointer"}),label:(0,a.css)({marginRight:c.spacing(1)}),swatch:(0,a.css)({width:E,height:E,background:`${v}`,border:b,borderRadius:c.shape.radius.circle,outlineOffset:"1px",outline:m?`2px solid  ${c.colors.primary.main}`:"none",boxShadow:y?`inset 0 0 0 2px ${v}, inset 0 0 0 4px ${c.colors.getContrastText(v)}`:"none",[c.transitions.handleMotion("no-preference")]:{transition:c.transitions.create(["transform"],{duration:c.transitions.duration.short})},"&:hover":{transform:"scale(1.1)"},"@media (forced-colors: active)":{forcedColorAdjust:"none"}})}};f.displayName="ColorSwatch"},57339:(te,R,e)=>{"use strict";e.d(R,{o:()=>o,t:()=>l});var n=e(74848),a=e(92745),s=e(63142),i=e(18027),r=e(21285),u=e(89772);const o=g=>{const{yaxis:f,onToggleAxis:p,color:c,...x}=g,v=(0,a.t)("grafana-ui.series-color-picker-popover.y-axis-usage","Use right y-axis"),m=p?{yaxis:{name:"Y-Axis",tabComponent(){return(0,n.jsx)(i.I,{labelWidth:20,label:v,children:(0,n.jsx)(r.K,{value:f===2,label:v,onChange:p})})}}}:void 0;return(0,n.jsx)(u.$,{...x,color:c||"#000000",customPickers:m})},l=(0,s.cV)(o)},32550:(te,R,e)=>{"use strict";e.d(R,{$:()=>p,A:()=>c});var n=e(74848),a=e(22803),s=e(96540),i=e(7612),r=e(65229),u=e(84140),o=e(6773),l=e(63142),g=e(12173);const f=({color:x,onChange:v})=>{const[m,y]=(0,s.useState)(x);(0,r.A)(b=>{v(o.MV.asHexString(h.visualization.getColorByName(b)))},500,[m]);const h=(0,l.$j)(),d=(0,l.of)(p),E=(0,s.useMemo)(()=>m.startsWith("rgba")?m:(0,u.A)(h.visualization.getColorByName(x)).toRgbString(),[m,h,x]);return(0,n.jsxs)("div",{className:d.wrapper,children:[(0,n.jsx)(i.p9,{className:d.root,color:E,onChange:y}),(0,n.jsx)(g.A,{theme:h,color:E,onChange:y,className:d.colorInput})]})},p=x=>({wrapper:(0,a.css)({flexGrow:1}),root:(0,a.css)({"&.react-colorful":{width:"auto"},".react-colorful":{"&__saturation":{borderRadius:`${x.shape.radius.default} ${x.shape.radius.default} 0 0`},"&__alpha":{borderRadius:`0 0 ${x.shape.radius.default} ${x.shape.radius.default}`},"&__alpha, &__hue":{height:x.spacing(2),position:"relative"},"&__pointer":{height:x.spacing(2),width:x.spacing(2)}}}),colorInput:(0,a.css)({marginTop:x.spacing(2)})}),c=f},43243:(te,R,e)=>{"use strict";e.d(R,{G:()=>D});var n=e(74848),a=e(22803),s=e(72181),i=e(31033),r=e(96540),u=e(92745),o=e(63142),l=e(30703),g=e(33033),f=e(63527),p=e(15245),c=e(70733),x=e(92842),v=e(74440),m=e(98869),y=e(75168),h=e(5320),d=e(93521);const E=()=>{},b=4,D=C=>{const{options:P,onChange:M,value:O,placeholder:j,isClearable:U,createCustomValue:W=!1,id:B,width:S,minWidth:_,maxWidth:K,"aria-labelledby":T,"data-testid":L,autoFocus:A,onBlur:N,disabled:V,invalid:z}=C,w=typeof O=="object"?O?.value:O,H=(0,r.useId)().replace(/:/g,"--"),{options:Q,groupStartIndices:Z,updateOptions:Y,asyncLoading:X,asyncError:I}=(0,h.I)(C.options,W),J=typeof P=="function",ee=(0,r.useMemo)(()=>{if(J||O==null)return null;const Be=P.findIndex(Ke=>Ke.value===w);return Be===-1?null:Be},[O,P,w,J]),q=(0,r.useMemo)(()=>O==null?null:ee!==null&&!J?P[ee]:typeof O=="object"?O:{value:O,label:O.toString()},[ee,J,O,P]),ne=`${H}-downshift-menu`,se=`${H}-downshift-label`,oe=(0,o.of)(m.C3),de=(0,r.useCallback)(Be=>{const Ke=Math.max(0,Be.startIndex-Be.overscan),Ue=Math.min(Q.length-1,Be.endIndex+Be.overscan),we=Array.from({length:Ue-Ke+1},(nt,he)=>Ke+he),Xe=Q[we[0]];if(Xe?.group){const nt=Z.get(Xe.group);nt!==void 0&&nt<we[0]&&we.unshift(nt)}return we},[Q,Z]),fe=(0,s.Te)({count:Q.length,getScrollElement:()=>Te.current,estimateSize:Be=>{const Ke=(0,d.S)(Q[Be],Be>0?Q[Be-1]:void 0),Ue="description"in Q[Be],we="group"in Q[Be];let Xe=m.Aj;return Ue&&(Xe=m.pg),Ke&&we&&(Xe+=m.Aj),Xe},overscan:b,rangeExtractor:de}),{isOpen:ae,highlightedIndex:ce,getInputProps:ie,getMenuProps:ve,getItemProps:le,selectItem:Ee}=(0,i.Bp)({menuId:ne,labelId:se,inputId:B,items:Q,itemToString:v.y,selectedItem:q,onSelectedItemChange:({selectedItem:Be})=>{(U||Be!==null)&&M(Be)},defaultHighlightedIndex:ee??0,scrollIntoView:()=>{},onIsOpenChange:({isOpen:Be,inputValue:Ke})=>{Be&&Ke===""&&Y(Ke)},onHighlightedIndexChange:({highlightedIndex:Be,type:Ke})=>{Ke!==i.Bp.stateChangeTypes.MenuMouseLeave&&fe.scrollToIndex(Be)},onStateChange:({inputValue:Be,type:Ke,selectedItem:Ue})=>{switch(Ke){case i.Bp.stateChangeTypes.InputChange:Y(Be??"");break;default:break}},stateReducer(Be,Ke){let{changes:Ue}=Ke;const we=Be.isOpen===!1&&Ue.isOpen===!0,Xe=Be.isOpen===!0&&Ue.isOpen===!1;return we&&Ue.inputValue===Be.inputValue&&(Ue={...Ue,inputValue:""}),Xe&&(Ue.selectedItem?Ue={...Ue,inputValue:(0,v.y)(Ue.selectedItem)}:Ue.inputValue!==""&&(Ue={...Ue,inputValue:""})),Ue}}),{inputRef:Re,floatingRef:Oe,floatStyles:Se,scrollRef:Te}=(0,y.l)(Q,ae),_e=S==="auto",He=_e?g.D:f.p,tt=(ae?(0,v.y)(q):null)||j,Je=C.loading||X,Ge=(0,n.jsxs)(n.Fragment,{children:[w!==void 0&&w===q?.value&&U&&(0,n.jsx)(l.I,{name:"times",className:oe.clear,title:(0,u.t)("combobox.clear.title","Clear value"),tabIndex:0,role:"button",onClick:()=>{Ee(null)},onKeyDown:Be=>{(Be.key==="Enter"||Be.key===" ")&&Ee(null)}}),(0,n.jsx)(x.f,{isLoading:Je||!1,isOpen:ae})]}),{Wrapper:je,wrapperProps:Fe}=_e?{Wrapper:"div",wrapperProps:{className:oe.adaptToParent}}:{Wrapper:r.Fragment};return(0,n.jsxs)(je,{...Fe,children:[(0,n.jsx)(He,{width:_e?void 0:S,..._e?{minWidth:_,maxWidth:K}:{},autoFocus:A,onBlur:N,disabled:V,invalid:z,className:oe.input,suffix:Ge,...ie({ref:Re,onChange:E,"aria-labelledby":T,placeholder:tt,"data-testid":L})}),(0,n.jsx)(p.ZL,{children:(0,n.jsx)("div",{className:(0,a.cx)(oe.menu,!ae&&oe.menuClosed),style:Se,...ve({ref:Oe,"aria-labelledby":T}),children:ae&&(0,n.jsx)(c.e,{options:Q,highlightedIndex:ce,selectedItems:q?[q]:[],scrollRef:Te,getItemProps:le,error:I})})})]})}},70733:(te,R,e)=>{"use strict";e.d(R,{e:()=>b});var n=e(74848),a=e(22803),s=e(72181),i=e(96540),r=e(63142),u=e(32635),o=e(92807),l=e(92745),g=e(30703),f=e(31286),p=e(41654),c=e(66404);const x=()=>(0,n.jsxs)(m,{children:[(0,n.jsx)(c.E,{color:"warning",children:(0,n.jsx)(g.I,{name:"exclamation-triangle",size:"md"})}),(0,n.jsx)(l.x6,{i18nKey:"combobox.async.error",children:"An error occurred while loading options."})]}),v=()=>(0,n.jsx)(m,{children:(0,n.jsx)(l.x6,{i18nKey:"combobox.options.no-found",children:"No options found."})}),m=({children:D})=>(0,n.jsx)(f.a,{padding:2,children:(0,n.jsx)(p.B,{justifyContent:"center",alignItems:"center",direction:"column",children:D})});var y=e(98869),h=e(33605),d=e(93521);const E=4,b=({options:D,highlightedIndex:C,selectedItems:P=[],scrollRef:M,getItemProps:O,enableAllOption:j,isMultiSelect:U=!1,error:W=!1})=>{const B=(0,r.of)(y.C3),S=(0,i.useCallback)(L=>{const A=(0,d.S)(D[L],L>0?D[L-1]:void 0),N="description"in D[L],V="group"in D[L];let z=y.Aj;return N&&(z=y.pg),A&&V&&(z+=y.Aj),z},[D]),_=(0,s.Te)({count:D.length,getScrollElement:()=>M.current,estimateSize:S,overscan:E}),K=(0,i.useCallback)(L=>P.some(A=>A.value===L.value),[P]),T=j&&P.length===D.length-1;return(0,n.jsxs)(o.P,{showScrollIndicators:!0,maxHeight:"inherit",ref:M,padding:.5,children:[(0,n.jsx)("div",{style:{height:_.getTotalSize()},className:B.menuUlContainer,children:_.getVirtualItems().map((L,A,N)=>{const V=D[L.index],z=(0,d.S)(V,D[L.index-1]),w=N.find(Y=>D[Y.index].group===V.group),H=w&&D[w.index],Q=`combobox-option-${V.value}`,Z=H?`combobox-option-group-${H.value}`:void 0;return(0,n.jsxs)("div",{className:B.listItem,style:{height:L.size,transform:`translateY(${L.start}px)`},children:[z&&(0,n.jsx)("div",{role:"presentation","data-testid":"combobox-option-group",id:Z,className:(0,a.cx)(B.optionGroupHeader,V.group&&B.optionGroupLabel,L.index===0&&B.optionFirstGroupHeader),children:V.group}),(0,n.jsxs)("div",{className:(0,a.cx)(B.option,!U&&K(V)&&B.optionSelected,C===L.index&&B.optionFocused),...O({item:V,index:L.index,id:Q,"aria-describedby":Z}),children:[U&&(0,n.jsx)("div",{className:B.optionAccessory,children:(0,n.jsx)(u.S,{value:T||K(V),indeterminate:V.value===h.A&&P.length>0&&!T,"aria-labelledby":Q,onClick:Y=>{Y.stopPropagation()}},Q)}),(0,n.jsxs)("div",{className:B.optionBody,children:[(0,n.jsx)("div",{className:B.optionLabel,children:V.label??V.value}),V.description&&(0,n.jsx)("div",{className:B.optionDescription,children:V.description})]})]})]},V.value)})}),(0,n.jsxs)("div",{"aria-live":"polite",children:[W&&(0,n.jsx)(x,{}),D.length===0&&!W&&(0,n.jsx)(v,{})]})]})}},92842:(te,R,e)=>{"use strict";e.d(R,{f:()=>s});var n=e(74848),a=e(30703);const s=({isLoading:i,isOpen:r})=>{const u=i?"spinner":r?"search":"angle-down";return(0,n.jsx)(a.I,{name:u})}},74440:(te,R,e)=>{"use strict";e.d(R,{o:()=>s,y:()=>a});var n=e(99885);function a(i){return i==null?"":i.label??i.value.toString()}function s(i,r,u){return(0,n.X)(r,u).map(l=>i[l])}},98869:(te,R,e)=>{"use strict";e.d(R,{AK:()=>r,Aj:()=>l,C3:()=>p,pg:()=>g,sh:()=>a,xB:()=>f,zx:()=>i});var n=e(22803);const a=14,s=12,i=500,r=8,u=2,o=1.5,l=u+r*2+a*o,g=l+s*o,f=l*8.5,p=c=>({menuClosed:(0,n.css)({display:"none"}),menu:(0,n.css)({label:"combobox-menu",background:c.components.dropdown.background,boxShadow:c.shadows.z3,zIndex:c.zIndex.dropdown,position:"relative",borderRadius:c.shape.radius.default,overflow:"hidden"}),menuUlContainer:(0,n.css)({label:"combobox-menu-ul-container",listStyle:"none"}),listItem:(0,n.css)({label:"list-item",position:"absolute",width:"100%"}),optionGroupHeader:(0,n.css)({label:"combobox-new-option-group",borderTop:`1px solid ${c.colors.border.weak}`}),optionFirstGroupHeader:(0,n.css)({borderTop:"none"}),optionGroupLabel:(0,n.css)({textOverflow:"ellipsis",overflow:"hidden",letterSpacing:0,color:c.colors.text.secondary,fontSize:c.typography.bodySmall.fontSize,fontWeight:c.typography.fontWeightLight,padding:r}),option:(0,n.css)({label:"combobox-option",position:"relative",display:"flex",width:"100%",gap:c.spacing(1),alignItems:"center",padding:r,marginBottom:u,borderRadius:c.shape.radius.default,fontWeight:c.typography.fontWeightMedium,whiteSpace:"nowrap",overflow:"hidden",cursor:"pointer","&:hover":{background:c.colors.action.hover,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${c.colors.primary.border}`}}}),optionAccessory:(0,n.css)({label:"combobox-option-accessory",height:a*o}),optionBody:(0,n.css)({label:"combobox-option-body",display:"flex",flexDirection:"column",flexGrow:1,overflow:"hidden"}),optionLabel:(0,n.css)({label:"combobox-option-label",fontSize:a,fontWeight:i,lineHeight:o,letterSpacing:0,textOverflow:"ellipsis",overflow:"hidden"}),optionDescription:(0,n.css)({label:"combobox-option-description",color:c.colors.text.secondary,fontSize:s,fontWeight:c.typography.fontWeightRegular,lineHeight:o,letterSpacing:0,textOverflow:"ellipsis",overflow:"hidden"}),optionFocused:(0,n.css)({label:"combobox-option-focused",background:c.colors.action.focus,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${c.colors.primary.border}`}}),optionSelected:(0,n.css)({background:c.colors.action.selected,"&::before":{backgroundImage:c.colors.gradients.brandVertical,borderRadius:c.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",width:c.spacing(.5),left:0,top:0}}),clear:(0,n.css)({label:"combobox-clear",cursor:"pointer",pointerEvents:"auto","&:hover":{color:c.colors.text.primary}}),input:(0,n.css)({label:"combobox-input","> div > div:last-child":{pointerEvents:"none"},"& input":{cursor:"pointer"},"& input:focus":{cursor:"text"}}),adaptToParent:(0,n.css)({label:"combobox-adapt-to-parent",maxWidth:"100%",'[class*="input-wrapper-combobox-input"]':{maxWidth:"100%"}})})},33605:(te,R,e)=>{"use strict";e.d(R,{A:()=>n});const n="__GRAFANA_INTERNAL_MULTICOMBOBOX_ALL_OPTION__"},75168:(te,R,e)=>{"use strict";e.d(R,{l:()=>f});var n=e(34743),a=e(83505),s=e(46885),i=e(96540),r=e(53568),u=e(98869);const o=1e5,l=16,g=8,f=(c,x)=>{const v=(0,i.useRef)(null),m=(0,i.useRef)(null),y=(0,i.useRef)(null),[h,d]=(0,i.useState)({width:0,height:0}),E=(0,i.useMemo)(()=>p(),[]),b=[(0,n.RK)({allowedPlacements:["bottom-start","bottom-end","top-start","top-end"],boundary:document.body,crossAxis:!0}),(0,n.Ej)({apply({availableWidth:O,availableHeight:j}){const U=O-l,W=j-l,B=Math.max(U,0),S=Math.min(Math.max(W,u.Aj*6),u.xB);d({width:B,height:S})}})],D={reference:v.current,floating:m.current},{floatingStyles:C}=(0,a.we)({strategy:"fixed",open:x,placement:"bottom-start",middleware:b,elements:D,whileElementsMounted:s.ll}),P=(0,i.useMemo)(()=>{let O="";const j=Math.min(c.length,o);for(let W=0;W<j;W++){const B=c[W].label??c[W].value.toString();O=B.length>O.length?B:O}return(0,r.kD)(O,u.sh,u.zx).width+g+u.AK*2+E},[c,E]),M={...C,width:P,maxWidth:h.width,minWidth:v.current?.offsetWidth,maxHeight:h.height};return{inputRef:v,floatingRef:m,scrollRef:y,floatStyles:M}};function p(){const c=document.createElement("div");c.style.visibility="hidden",c.style.overflow="scroll",document.body.appendChild(c);const x=document.createElement("div");c.appendChild(x);const v=c.offsetWidth-x.offsetWidth;return c.parentNode?.removeChild(c),v}},5320:(te,R,e)=>{"use strict";e.d(R,{I:()=>l});var n=e(2543),a=e(96540),s=e(92745),i=e(74440);function r(f){const p=(0,a.useRef)(0);return(0,a.useCallback)(x=>{p.current++;const v=p.current;return new Promise((m,y)=>{f(x).then(h=>{v===p.current?m(h):y(new u)}).catch(y)})},[f])}class u extends Error{constructor(){super("This result is stale and is discarded"),this.name="StaleResultError",Object.setPrototypeOf(this,new.target.prototype)}}const o=()=>Promise.resolve([]);function l(f,p){const c=typeof f=="function",x=r(c?f:o),v=(0,a.useMemo)(()=>(0,n.debounce)(B=>x(B).then(S=>{y(S),d(!1),b(!1)}).catch(S=>{S instanceof u||(b(!0),d(!1),S&&console.error("Error loading async options for Combobox",S))}),200),[x]),[m,y]=(0,a.useState)([]),[h,d]=(0,a.useState)(!1),[E,b]=(0,a.useState)(!1),[D,C]=(0,a.useState)(""),P=(0,a.useCallback)(B=>{let S=B;return p&&D&&(B.some(K=>K.value===D)||(S=S.slice(),S.unshift({label:D,value:D,description:(0,s.t)("combobox.custom-value.description","Use custom value")}))),S},[p,D]),M=(0,a.useCallback)(B=>{C(B),c&&(d(!0),v(B))},[v,c]),O=(0,a.useMemo)(()=>c?[]:f.map(i.y),[c,f]),j=(0,a.useMemo)(()=>c?m:(0,i.o)(f,O,D),[m,c,f,O,D]),[U,W]=(0,a.useMemo)(()=>{const{options:B,groupStartIndices:S}=g(j);return[P(B),S]},[j,P]);return{options:U,groupStartIndices:W,updateOptions:M,asyncLoading:h,asyncError:E}}function g(f){const p=new Map,c=new Map;for(const m of f){const y=m.group,h=p.get(y);h?h.push(m):p.set(y,[m])}if(p.size<=1)return f[0]?.group&&c.set(f[0]?.group,0),{options:f,groupStartIndices:c};const x=new Array(f.length);let v=0;for(const[m,y]of p){m&&c.set(m,v);for(const h of y)x[v++]=h}return{options:x,groupStartIndices:c}}},93521:(te,R,e)=>{"use strict";e.d(R,{S:()=>n});const n=(a,s)=>{const i=a.group;return i?s?s.group!==i:!0:!!s?.group}},7075:(te,R,e)=>{"use strict";e.d(R,{Z:()=>o});var n=e(74848),a=e(22803),s=e(96540),i=e(92745),r=e(63142),u=e(45861);const o=({children:g,className:f,closeOnConfirm:p,confirmText:c="Save",confirmVariant:x="primary",disabled:v=!1,onCancel:m,onClick:y,onConfirm:h,size:d="md"})=>{const E=(0,s.useRef)(null),b=(0,s.useRef)(null),[D,C]=(0,s.useState)(!1),[P,M]=(0,s.useState)(!1),O=(0,r.of)(l);(0,s.useEffect)(()=>{D?(b.current?.focus(),M(!0)):P&&(E.current?.focus(),M(!1))},[P,D]);const j=K=>{K&&K.preventDefault(),C(!0),y?.()},U=K=>{K&&K.preventDefault(),C(!1),E.current?.focus(),m?.()},W=K=>{K&&K.preventDefault(),h?.(),p&&C(!1)},B=(0,a.cx)(f,O.mainButton,{[O.mainButtonHide]:D}),S=(0,a.cx)(O.confirmButton,{[O.confirmButtonHide]:!D}),_=(0,a.cx)(O.confirmButtonContainer,{[O.confirmButtonContainerHide]:!D});return(0,n.jsxs)("div",{className:O.container,children:[(0,n.jsx)("span",{className:B,children:typeof g=="string"?(0,n.jsx)(u.$n,{disabled:v,size:d,fill:"text",onClick:j,ref:E,children:g}):s.cloneElement(g,{disabled:v,onClick:j,ref:E})}),(0,n.jsx)("div",{className:_,children:(0,n.jsxs)("span",{className:S,children:[(0,n.jsx)(u.$n,{size:d,variant:x,onClick:W,ref:b,children:c}),(0,n.jsx)(u.$n,{size:d,fill:"text",onClick:U,children:(0,n.jsx)(i.x6,{i18nKey:"grafana-ui.confirm-button.cancel",children:"Cancel"})})]})})]})};o.displayName="ConfirmButton";const l=g=>({container:(0,a.css)({alignItems:"center",display:"flex",justifyContent:"flex-end",position:"relative"}),mainButton:(0,a.css)({opacity:1,[g.transitions.handleMotion("no-preference")]:{transition:g.transitions.create(["opacity"],{duration:g.transitions.duration.shortest,easing:g.transitions.easing.easeOut})},zIndex:2}),mainButtonHide:(0,a.css)({opacity:0,[g.transitions.handleMotion("no-preference")]:{transition:g.transitions.create(["opacity","visibility"],{duration:g.transitions.duration.shortest,easing:g.transitions.easing.easeIn})},visibility:"hidden",zIndex:0}),confirmButtonContainer:(0,a.css)({overflow:"visible",position:"absolute",pointerEvents:"all",right:0}),confirmButtonContainerHide:(0,a.css)({overflow:"hidden",pointerEvents:"none"}),confirmButton:(0,a.css)({alignItems:"flex-start",background:g.colors.background.primary,display:"flex",opacity:1,transform:"translateX(0)",[g.transitions.handleMotion("no-preference")]:{transition:g.transitions.create(["opacity","transform"],{duration:g.transitions.duration.shortest,easing:g.transitions.easing.easeOut})},zIndex:1}),confirmButtonHide:(0,a.css)({opacity:0,transform:"translateX(100%)",[g.transitions.handleMotion("no-preference")]:{transition:g.transitions.create(["opacity","transform","visibility"],{duration:g.transitions.duration.shortest,easing:g.transitions.easing.easeIn})},visibility:"hidden"})})},44458:(te,R,e)=>{"use strict";e.d(R,{e:()=>r});var n=e(74848),a=e(92745),s=e(45861),i=e(7075);const r=({size:u,disabled:o,onConfirm:l,"aria-label":g,closeOnConfirm:f})=>(0,n.jsx)(i.Z,{confirmText:(0,a.t)("grafana-ui.confirm-button.confirmText-delete","Delete"),confirmVariant:"destructive",size:u||"md",disabled:o,onConfirm:l,closeOnConfirm:f,children:(0,n.jsx)(s.$n,{"aria-label":g,variant:"destructive",icon:"times",size:u||"sm"})})},70735:(te,R,e)=>{"use strict";e.d(R,{k:()=>c});var n=e(74848),a=e(22803),s=e(96540),i=e(49785),r=e(51898),u=e(92745),o=e(63142),l=e(45861),g=e(37386),f=e(63527),p=e(41654);const c=({body:v,confirmPromptText:m,confirmButtonLabel:y,confirmButtonVariant:h,dismissButtonVariant:d,dismissButtonLabel:E,onConfirm:b,onDismiss:D,onAlternative:C,alternativeButtonLabel:P,description:M,justifyButtons:O="flex-end",disabled:j})=>{const[U,W]=(0,s.useState)(j),B=(0,o.of)(x),S=(0,s.useRef)(null),_=A=>{W(m?.toLowerCase().localeCompare(A.currentTarget.value.toLowerCase())!==0)};(0,s.useEffect)(()=>{S.current?.focus()},[]),(0,s.useEffect)(()=>{W(j?!0:!!m)},[m,j]);const K=async()=>{j===void 0&&W(!0);try{await b()}finally{j===void 0&&W(!1)}},{handleSubmit:T}=(0,i.mN)(),L=(0,u.t)("grafana-ui.confirm-content.placeholder",'Type "{{confirmPromptText}}" to confirm',{confirmPromptText:m});return(0,n.jsxs)("form",{onSubmit:T(K),children:[(0,n.jsxs)("div",{className:B.text,children:[v,M?(0,n.jsx)("div",{className:B.description,children:M}):null,m?(0,n.jsx)("div",{className:B.confirmationInput,children:(0,n.jsx)(p.B,{alignItems:"flex-start",children:(0,n.jsx)(g.D,{disabled:j,children:(0,n.jsx)(f.p,{placeholder:L,onChange:_})})})}):null]}),(0,n.jsx)("div",{className:B.buttonsContainer,children:(0,n.jsxs)(p.B,{justifyContent:O,gap:2,wrap:"wrap",children:[(0,n.jsx)(l.$n,{variant:d,onClick:D,fill:"outline",children:E}),(0,n.jsx)(l.$n,{type:"submit",variant:h,disabled:U,ref:S,"data-testid":r.Tp.pages.ConfirmModal.delete,children:y}),C?(0,n.jsx)(l.$n,{variant:"primary",onClick:C,children:P}):null]})})]})},x=v=>({text:(0,a.css)({fontSize:v.typography.h5.fontSize,color:v.colors.text.primary}),description:(0,a.css)({fontSize:v.typography.body.fontSize}),confirmationInput:(0,a.css)({paddingTop:v.spacing(1)}),buttonsContainer:(0,a.css)({paddingTop:v.spacing(3)})})},71599:(te,R,e)=>{"use strict";e.d(R,{u:()=>u});var n=e(74848),a=e(22803),s=e(63142),i=e(22787),r=e(70735);const u=({isOpen:l,title:g,body:f,description:p,confirmText:c,confirmVariant:x="destructive",confirmationText:v,dismissText:m="Cancel",dismissVariant:y="secondary",alternativeText:h,modalClass:d,icon:E="exclamation-triangle",onConfirm:b,onDismiss:D,onAlternative:C,confirmButtonVariant:P="destructive",disabled:M})=>{const O=(0,s.of)(o);return(0,n.jsx)(i.a,{className:(0,a.cx)(O.modal,d),title:g,icon:E,isOpen:l,onDismiss:D,children:(0,n.jsx)(r.k,{body:f,description:p,confirmButtonLabel:c,dismissButtonLabel:m,dismissButtonVariant:y,confirmPromptText:v,alternativeButtonLabel:h,confirmButtonVariant:P,onConfirm:b,onDismiss:D,onAlternative:C,disabled:M})})},o=()=>({modal:(0,a.css)({width:"500px"})})},97375:(te,R,e)=>{"use strict";e.d(R,{t:()=>o});var n=e(74848),a=e(96540),s=e(29647),i=e(51898),r=e(87063),u=e(15245);const o=a.memo(({x:l,y:g,onClose:f,focusOnOpen:p=!0,renderMenuItems:c,renderHeader:x})=>{const v=(0,a.useRef)(null),[m,y]=(0,a.useState)({});(0,a.useLayoutEffect)(()=>{const D=v.current;if(D){const C=D.getBoundingClientRect(),P=5,M={right:window.innerWidth<l+C.width,bottom:window.innerHeight<g+C.height+P};y({position:"fixed",left:M.right?l-C.width-P:l-P,top:Math.max(0,M.bottom?g-C.height-P:g+P)})}},[l,g]),(0,s.A)(v,()=>{f?.()});const h=x?.(),d=c?.(),E=D=>{p&&D(0)},b=D=>{D.key==="Escape"&&(D.preventDefault(),D.stopPropagation(),f?.())};return(0,n.jsx)(u.ZL,{children:(0,n.jsx)(r.W,{header:h,ref:v,style:m,ariaLabel:i.Tp.components.Menu.MenuComponent("Context"),onOpen:E,onClick:f,onKeyDown:b,children:d})})});o.displayName="ContextMenu"},41479:(te,R,e)=>{"use strict";e.d(R,{n:()=>i});var n=e(74848),a=e(96540),s=e(97375);const i=({children:r,renderMenuItems:u,focusOnOpen:o=!0})=>{const[l,g]=(0,a.useState)(!1),[f,p]=(0,a.useState)({x:0,y:0});return(0,n.jsxs)(n.Fragment,{children:[r({openMenu:c=>{g(!0),p({x:c.pageX,y:c.pageY-window.scrollY})}}),l&&(0,n.jsx)(s.t,{onClose:()=>g(!1),x:f.x,y:f.y,renderMenuItems:u,focusOnOpen:o})]})}},52718:(te,R,e)=>{"use strict";e.d(R,{E:()=>l,A:()=>g});var n=e(74848),a=e(22803),s=e(96540),i=e(62295),r=e(63142);const u=({children:c})=>{const[x,v]=(0,s.useState)(!1),[m,y]=(0,s.useState)(!1),h=(0,s.useRef)(null),d=(0,s.useRef)(null),E=(0,r.of)(o);return(0,s.useEffect)(()=>{const b=new IntersectionObserver(D=>{D.forEach(C=>{C.target===h.current?v(!C.isIntersecting):C.target===d.current&&y(!C.isIntersecting)})});return[h,d].forEach(D=>{D.current&&b.observe(D.current)}),()=>b.disconnect()},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:(0,a.cx)(E.scrollIndicator,E.scrollTopIndicator,{[E.scrollIndicatorVisible]:x})}),(0,n.jsxs)("div",{className:E.scrollContent,children:[(0,n.jsx)("div",{ref:h}),c,(0,n.jsx)("div",{ref:d})]}),(0,n.jsx)("div",{className:(0,a.cx)(E.scrollIndicator,E.scrollBottomIndicator,{[E.scrollIndicatorVisible]:m})})]})},o=c=>({scrollContent:(0,a.css)({flex:1,position:"relative"}),scrollIndicator:(0,a.css)({height:c.spacing(6),left:0,opacity:0,pointerEvents:"none",position:"absolute",right:0,[c.transitions.handleMotion("no-preference","reduce")]:{transition:c.transitions.create("opacity")},zIndex:1}),scrollTopIndicator:(0,a.css)({background:`linear-gradient(0deg, transparent, ${c.colors.background.canvas})`,top:0}),scrollBottomIndicator:(0,a.css)({background:`linear-gradient(180deg, transparent, ${c.colors.background.canvas})`,bottom:0}),scrollIndicatorVisible:(0,a.css)({opacity:1})}),l=({autoHide:c=!1,autoHideTimeout:x=200,setScrollTop:v,className:m,testId:y,autoHeightMin:h="0",autoHeightMax:d="100%",hideTracksWhenNotNeeded:E=!1,hideHorizontalTrack:b,hideVerticalTrack:D,scrollRefCallback:C,showScrollIndicators:P=!1,updateAfterMountMs:M,scrollTop:O,onScroll:j,children:U,divId:W})=>{const B=(0,s.useRef)(null),S=(0,r.of)(f);(0,s.useEffect)(()=>{B.current&&C&&C(B.current.view)},[B,C]),p(B.current,O),(0,s.useEffect)(()=>{M&&setTimeout(()=>{const z=B.current;z?.update&&z.update()},M)},[M]);function _(z,w,H){return H.style&&w&&(H.style.display="none"),(0,n.jsx)("div",{...H,className:z})}const K=(0,s.useCallback)(z=>_("track-horizontal",b,z),[b]),T=(0,s.useCallback)(z=>_("track-vertical",D,z),[D]),L=(0,s.useCallback)(z=>(0,n.jsx)("div",{...z,className:"thumb-horizontal"}),[]),A=(0,s.useCallback)(z=>(0,n.jsx)("div",{...z,className:"thumb-vertical"}),[]),N=(0,s.useCallback)(z=>(z.style&&z.style.WebkitOverflowScrolling==="touch"&&(z.style.WebkitOverflowScrolling="auto"),(0,n.jsx)("div",{...z,className:"scrollbar-view",id:W})),[W]),V=(0,s.useCallback)(()=>{B.current&&v&&v(B.current.getValues())},[v]);return(0,n.jsx)(i.Ay,{"data-testid":y,ref:B,className:(0,a.cx)(S.customScrollbar,m,{[S.scrollbarWithScrollIndicators]:P}),onScrollStop:V,autoHeight:!0,autoHide:c,autoHideTimeout:x,hideTracksWhenNotNeeded:E,autoHeightMax:d,autoHeightMin:h,renderTrackHorizontal:K,renderTrackVertical:T,renderThumbHorizontal:L,renderThumbVertical:A,renderView:N,onScroll:j,children:P?(0,n.jsx)(u,{children:U}):U})},g=l,f=c=>({customScrollbar:(0,a.css)({display:"flex",flexGrow:1,".scrollbar-view":{display:"flex",flexGrow:1,flexDirection:"column"},".track-vertical":{borderRadius:c.shape.borderRadius(2),width:`${c.spacing(1)} !important`,right:0,bottom:c.spacing(.25),top:c.spacing(.25)},".track-horizontal":{borderRadius:c.shape.borderRadius(2),height:`${c.spacing(1)} !important`,right:c.spacing(.25),bottom:c.spacing(.25),left:c.spacing(.25)},".thumb-vertical":{background:c.colors.action.focus,borderRadius:c.shape.borderRadius(2),opacity:0},".thumb-horizontal":{background:c.colors.action.focus,borderRadius:c.shape.borderRadius(2),opacity:0},"&:hover":{".thumb-vertical, .thumb-horizontal":{opacity:1,transition:"opacity 0.3s ease-in-out"}}}),scrollbarWithScrollIndicators:(0,a.css)({".scrollbar-view":{position:"static !important"}})});function p(c,x){(0,s.useEffect)(()=>{c&&x!=null&&c.scrollTop(x)},[x,c])}},28134:(te,R,e)=>{"use strict";e.d(R,{R:()=>s});var n=e(74848),a=e(45861);function s({link:i,buttonProps:r}){return(0,n.jsx)("a",{href:i.href,target:i.target,rel:"noreferrer",onClick:i.onClick?u=>{!(u.ctrlKey||u.metaKey||u.shiftKey)&&i.onClick&&(u.preventDefault(),i.onClick(u))}:void 0,children:(0,n.jsx)(a.$n,{icon:i.target==="_blank"?"external-link-alt":"link",variant:"primary",size:"sm",...r,children:i.title})})}},81917:(te,R,e)=>{"use strict";e.d(R,{l:()=>j});var n=e(74848),a=e(22803),s=e(34743),i=e(83505),r=e(46885),u=e(28848),o=e.n(u),l=e(96540),g=e(84596),f=e(52845),p=e(29317),c=e(79609),x=e(38036),v=e(56103),m=e(63142),y=e(35458),h=e(63527),d=e(15245),E=e(92807),b=e(81563);class D{getBoundingClientRect(){const B=window.getSelection(),S=B&&B.anchorNode;return S&&S.parentElement?S.parentElement.getBoundingClientRect():{top:0,left:0,bottom:0,right:0,width:0,height:0,x:0,y:0,toJSON:()=>{}}}get clientWidth(){return this.getBoundingClientRect().width}get clientHeight(){return this.getBoundingClientRect().height}}const C=(W,B)=>W-B*Math.floor(W/B),P={builtInVariable:{pattern:/(\${\S+?})/}},M=[(0,v.D)({onlyIn:W=>"type"in W&&W.type==="code_block",getSyntax:()=>"links"},{...o().languages,links:P})],O=W=>({input:(0,h.n)({theme:W,invalid:!1}).input,editor:(0,a.css)({".token.builtInVariable":{color:W.colors.success.text},".token.variable":{color:W.colors.primary.text}}),suggestionsWrapper:(0,a.css)({boxShadow:W.shadows.z2}),wrapperOverrides:(0,a.css)({width:"100%","> .slate-query-field__wrapper":{padding:0,backgroundColor:"transparent",border:"none"}})}),j=(0,l.memo)(({value:W,onChange:B,suggestions:S,placeholder:_="http://your-grafana.com/d/000000010/annotations"})=>{const K=(0,l.useRef)(null),T=(0,m.of)(O),[L,A]=(0,l.useState)(!1),[N,V]=(0,l.useState)(0),[z,w]=(0,l.useState)((0,y.mO)(W)),H=(0,g.A)(z),[Q,Z]=(0,l.useState)(0),Y=(0,l.useRef)(null);(0,l.useEffect)(()=>{Y.current?.scrollTo(0,Q)},[Q]);const X=[(0,s.cY)(({rects:fe})=>({alignmentAxis:fe.reference.width})),(0,s.UU)({fallbackAxisSideDirection:"start",crossAxis:!1,boundary:document.body}),(0,s.BN)()],{refs:I,floatingStyles:J}=(0,i.we)({open:L,placement:"bottom-start",onOpenChange:A,middleware:X,whileElementsMounted:r.ll,strategy:"fixed"}),ee=(0,l.useRef)({showingSuggestions:L,suggestions:S,suggestionsIndex:N,linkUrl:z,onChange:B});ee.current={showingSuggestions:L,suggestions:S,suggestionsIndex:N,linkUrl:z,onChange:B};const q=(0,l.useRef)(null);(0,l.useEffect)(()=>{Z(U(q.current,N))},[N]);const ne=l.useCallback((fe,ae)=>{if(!ee.current.showingSuggestions){if(fe.key==="="||fe.key==="$"||fe.keyCode===32&&fe.ctrlKey){const ce=new D;return I.setReference(ce),A(!0)}return ae()}switch(fe.key){case"Backspace":ee.current.linkUrl.focusText.getText().length===1&&ae();case"Escape":return A(!1),V(0);case"Enter":return fe.preventDefault(),oe(ee.current.suggestions[ee.current.suggestionsIndex]);case"ArrowDown":case"ArrowUp":fe.preventDefault();const ce=fe.key==="ArrowDown"?1:-1;return V(ie=>C(ie+ce,ee.current.suggestions.length));default:return ae()}},[]);(0,l.useEffect)(()=>{H&&H.selection.isFocused&&!z.selection.isFocused&&ee.current.onChange(f.default.serialize(z))},[z,H]);const se=l.useCallback(({value:fe})=>{w(fe)},[]),oe=(fe,ae=K.current)=>{const ie=de()==="$";fe.origin!==c.$0.Template||fe.value===x.c.includeVars?ae.insertText(`${ie?"":"$"}{${fe.value}}`):ae.insertText(`${ie?"":"$"}{${fe.value}:queryparam}`),w(ae.value),A(!1),V(0),ee.current.onChange(f.default.serialize(ae.value))},de=()=>{const fe=document.getElementById("data-link-input");let ae="",ce,ie;return window.getSelection&&(ce=window.getSelection(),ce&&ce.rangeCount>0&&(ie=ce.getRangeAt(0).cloneRange(),ie.collapse(!0),ie.setStart(fe,0),ae=ie.toString().slice(-1))),ae};return(0,n.jsx)("div",{className:T.wrapperOverrides,children:(0,n.jsx)("div",{className:"slate-query-field__wrapper",children:(0,n.jsxs)("div",{id:"data-link-input",className:"slate-query-field",children:[L&&(0,n.jsx)(d.ZL,{children:(0,n.jsx)("div",{ref:I.setFloating,style:J,children:(0,n.jsx)(E.P,{maxHeight:"300px",ref:Y,onScroll:fe=>Z(fe.currentTarget.scrollTop),children:(0,n.jsx)(b.k,{activeRef:q,suggestions:ee.current.suggestions,onSuggestionSelect:oe,onClose:()=>A(!1),activeIndex:N})})})}),(0,n.jsx)(p.Editor,{schema:y.yx,ref:K,placeholder:_,value:ee.current.linkUrl,onChange:se,onKeyDown:(fe,ae,ce)=>ne(fe,ce),plugins:M,className:(0,a.cx)(T.editor,T.input,(0,a.css)({padding:"3px 8px"}))})]})})})});j.displayName="DataLinkInput";function U(W,B){return(W?.clientHeight??0)*B}},81563:(te,R,e)=>{"use strict";e.d(R,{k:()=>f});var n=e(74848),a=e(96540),s=e(22803),i=e(2543),r=e.n(i),u=e(29647),o=e(63142),l=e(5585);const g=c=>({list:(0,s.css)({borderBottom:`1px solid ${c.colors.border.weak}`,"&:last-child":{border:"none"}}),wrapper:(0,s.css)({background:c.colors.background.primary,width:"250px"}),item:(0,s.css)({background:"none",padding:"2px 8px",userSelect:"none",color:c.colors.text.primary,cursor:"pointer","&:hover":{background:c.colors.action.hover}}),label:(0,s.css)({color:c.colors.text.secondary}),activeItem:(0,s.css)({background:c.colors.background.secondary,"&:hover":{background:c.colors.background.secondary}}),itemValue:(0,s.css)({fontFamily:c.typography.fontFamilyMonospace,fontSize:c.typography.size.sm})}),f=({suggestions:c,...x})=>{const v=(0,a.useRef)(null);(0,u.A)(v,()=>{x.onClose&&x.onClose()});const m=(0,a.useMemo)(()=>(0,i.groupBy)(c,h=>h.origin),[c]),y=(0,o.of)(g);return(0,n.jsx)("div",{role:"menu",ref:v,className:y.wrapper,children:Object.keys(m).map((h,d)=>{const E=d===0?0:Object.keys(m).reduce((b,D,C)=>C>=d?b:b+m[D].length,0);return(0,a.createElement)(p,{...x,suggestions:m[h],label:(0,i.capitalize)(h),activeIndex:x.activeIndex,activeIndexOffset:E,key:h})})})};f.displayName="DataLinkSuggestions";const p=a.memo(({activeIndex:c,activeIndexOffset:x,label:v,onClose:m,onSuggestionSelect:y,suggestions:h,activeRef:d})=>{const E=(0,o.of)(g);return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(l.B,{className:E.list,items:h,renderItem:(b,D)=>{const C=D+x===c;return(0,n.jsx)("div",{role:"menuitem",tabIndex:0,className:(0,s.cx)(E.item,C&&E.activeItem),ref:C?d:void 0,onClick:()=>{y(b)},title:b.documentation,children:(0,n.jsxs)("span",{className:E.itemValue,children:[(0,n.jsx)("span",{className:E.label,children:v})," ",b.label]})})}})})});p.displayName="DataLinkSuggestionsList"},6399:(te,R,e)=>{"use strict";e.d(R,{e:()=>g});var n=e(74848),a=e(22803),s=e(51898),i=e(63142),r=e(75254),u=e(41479),o=e(30930),l=e(94535);const g=({children:p,links:c,style:x})=>{const v=(0,i.of)(f),m=[{items:(0,r.J)(c),label:c().length?"Data links":""}],y=m[0].items.length,h=()=>m.map((E,b)=>(0,n.jsx)(o.r,{label:E.label,children:(E.items||[]).map((D,C)=>(0,n.jsx)(l.D,{url:D.url,label:D.label,target:D.target,icon:D.icon,active:D.active,onClick:D.onClick,className:v.itemWrapper},`${E.label}-${b}-${C}}`))},`${E.label}${b}`)),d=(0,a.css)({cursor:"context-menu"});if(y>1)return(0,n.jsx)(u.n,{renderMenuItems:h,children:({openMenu:E})=>p({openMenu:E,targetClassName:d})});{const E=c()[0];return(0,n.jsx)("a",{href:E.href,onClick:E.onClick,target:E.target,title:E.title,style:{...x,overflow:"hidden",display:"flex"},"data-testid":s.Tp.components.DataLinksContextMenu.singleLink,children:p({})})}},f=p=>({itemWrapper:(0,a.css)({fontSize:12})})},96822:(te,R,e)=>{"use strict";e.d(R,{e:()=>y});var n=e(74848),a=e(96540),s=e(92745),i=e(45861),r=e(22787),u=e(22803),o=e(63142),l=e(37386),g=e(63527),f=e(21285),p=e(81917);const c=(0,a.memo)(({index:h,value:d,onChange:E,suggestions:b,isLast:D,showOneClick:C=!1})=>{const P=(0,o.of)(x),M=(W,B)=>{E(h,{...d,url:W},B)},O=W=>{E(h,{...d,title:W.target.value})},j=()=>{E(h,{...d,targetBlank:!d.targetBlank})},U=()=>{E(h,{...d,oneClick:!d.oneClick})};return(0,n.jsxs)("div",{className:P.listItem,children:[(0,n.jsx)(l.D,{label:(0,s.t)("grafana-ui.data-link-editor.title-label","Title"),children:(0,n.jsx)(g.p,{id:"link-title",value:d.title,onChange:O,placeholder:(0,s.t)("grafana-ui.data-link-editor.title-placeholder","Show details")})}),(0,n.jsx)(l.D,{label:(0,s.t)("grafana-ui.data-link-editor.url-label","URL"),children:(0,n.jsx)(p.l,{value:d.url,onChange:M,suggestions:b})}),(0,n.jsx)(l.D,{label:(0,s.t)("grafana-ui.data-link-editor.new-tab-label","Open in new tab"),children:(0,n.jsx)(f.d,{id:"new-tab-toggle",value:d.targetBlank||!1,onChange:j})}),C&&(0,n.jsx)(l.D,{label:(0,s.t)("grafana-ui.data-link-inline-editor.one-click","One click"),description:(0,s.t)("grafana-ui.data-link-editor-modal.one-click-description","Only one link can have one click enabled at a time"),children:(0,n.jsx)(f.d,{id:"one-click-toggle",value:d.oneClick||!1,onChange:U})}),D&&(0,n.jsx)(s.x6,{i18nKey:"grafana-ui.data-link-editor.info",className:P.infoText,children:"With data links you can reference data variables like series name, labels and values. Type CMD+Space, CTRL+Space, or $ to open variable suggestions."})]})});c.displayName="DataLinkEditor";const x=h=>({listItem:(0,u.css)({marginBottom:h.spacing()}),infoText:(0,u.css)({paddingBottom:h.spacing(2),marginLeft:"66px",color:h.colors.text.secondary})}),v=({link:h,index:d,onSave:E,onCancel:b,getSuggestions:D,showOneClick:C})=>{const[P,M]=(0,a.useState)(h);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c,{value:P,index:d,isLast:!1,onChange:(O,j)=>{M(j)},suggestions:D(),showOneClick:C}),(0,n.jsxs)(r.a.ButtonRow,{children:[(0,n.jsx)(i.$n,{variant:"secondary",onClick:()=>b(d),fill:"outline",children:(0,n.jsx)(s.x6,{i18nKey:"grafana-ui.data-link-editor-modal.cancel",children:"Cancel"})}),(0,n.jsx)(i.$n,{onClick:()=>{E(d,P)},disabled:P.title.trim()===""||P.url.trim()==="",children:(0,n.jsx)(s.x6,{i18nKey:"grafana-ui.data-link-editor-modal.save",children:"Save"})})]})]})};var m=e(73628);const y=({links:h,getSuggestions:d,showOneClick:E=!1,...b})=>(0,n.jsx)(m.J,{type:"link",items:h,...b,children:(D,C,P,M)=>(0,n.jsx)(v,{index:C,link:D??{title:"",url:""},data:b.data,onSave:P,onCancel:M,getSuggestions:d,showOneClick:E})})},73628:(te,R,e)=>{"use strict";e.d(R,{J:()=>m});var n=e(74848),a=e(22803),s=e(89332),i=e(2543),r=e(96540),u=e(92745),o=e(63142),l=e(45861),g=e(22787),f=e(99887),p=e(30703),c=e(76319);function x({item:h,onEdit:d,onRemove:E,index:b,itemKey:D}){const C=(0,o.of)(v),{title:P="",oneClick:M=!1}=h,O=h.url??h.fetch?.url??"",j=P.trim()!=="",U=O.trim()!=="";return(0,n.jsx)(s.sx,{draggableId:D,index:b,children:W=>(0,r.createElement)("div",{className:(0,a.cx)(C.wrapper,C.dragRow),ref:W.innerRef,...W.draggableProps,key:b},(0,n.jsxs)("div",{className:C.linkDetails,children:[(0,n.jsx)("div",{className:(0,a.cx)(C.url,!j&&C.notConfigured),children:j?P:(0,u.t)("grafana-ui.data-links-inline-editor.title-not-provided","Title not provided")}),(0,n.jsx)("div",{className:(0,a.cx)(C.url,!U&&C.notConfigured),title:O,children:U?O:(0,u.t)("grafana-ui.data-links-inline-editor.url-not-provided","Data link url not provided")})]}),(0,n.jsxs)("div",{className:C.icons,children:[M&&(0,n.jsx)(f.E,{color:"blue",text:(0,u.t)("grafana-ui.data-links-inline-editor.one-click","One click"),tooltip:(0,u.t)("grafana-ui.data-links-inline-editor.one-click-enabled","One click enabled")}),(0,n.jsx)(c.K,{name:"pen",onClick:d,className:C.icon,tooltip:(0,u.t)("grafana-ui.data-links-inline-editor.tooltip-edit","Edit")}),(0,n.jsx)(c.K,{name:"trash-alt",onClick:E,className:C.icon,tooltip:(0,u.t)("grafana-ui.data-links-inline-editor.tooltip-remove","Remove")}),(0,n.jsx)("div",{className:C.dragIcon,...W.dragHandleProps,children:(0,n.jsx)(p.I,{name:"draggabledots",size:"lg"})})]}))},D)}const v=h=>({wrapper:(0,a.css)({display:"flex",flexGrow:1,alignItems:"center",justifyContent:"space-between",padding:"5px 0 5px 10px",borderRadius:h.shape.radius.default,background:h.colors.background.secondary,gap:8}),linkDetails:(0,a.css)({display:"flex",flexDirection:"column",flexGrow:1,maxWidth:"calc(100% - 100px)"}),errored:(0,a.css)({color:h.colors.error.text,fontStyle:"italic"}),notConfigured:(0,a.css)({fontStyle:"italic"}),title:(0,a.css)({color:h.colors.text.primary,fontSize:h.typography.size.sm,fontWeight:h.typography.fontWeightMedium}),url:(0,a.css)({color:h.colors.text.secondary,fontSize:h.typography.size.sm,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),dragRow:(0,a.css)({position:"relative",margin:"8px"}),icons:(0,a.css)({display:"flex",padding:6,alignItems:"center",gap:8}),dragIcon:(0,a.css)({cursor:"grab",color:h.colors.text.secondary,margin:h.spacing(0,.5)}),icon:(0,a.css)({color:h.colors.text.secondary})});function m({type:h,items:d,onChange:E,data:b,children:D}){const[C,P]=(0,r.useState)(null),[M,O]=(0,r.useState)(!1),[j,U]=(0,r.useState)([]);(0,r.useEffect)(()=>{U(d??[])},[d]);const W=(0,o.of)(y),B=C!==null,S=(N,V)=>{if(M){const w=V.title,H=V.url??V.fetch?.url??"";if(w.trim()===""&&H.trim()===""){O(!1),P(null);return}else P(null),O(!1)}V.oneClick===!0&&j.forEach(w=>{w.oneClick&&(w.oneClick=!1)});const z=(0,i.cloneDeep)(j);z[N]=V,E(z),P(null)},_=N=>{M&&O(!1),P(null)},K=()=>{let N=(0,i.cloneDeep)(j);P(N.length),O(!0)},T=N=>{const V=(0,i.cloneDeep)(j);V.splice(N,1),E(V)},L=N=>{if(d==null||N.destination==null)return;const V=(0,i.cloneDeep)(j),z=V[N.source.index];V.splice(N.source.index,1),V.splice(N.destination.index,0,z),U(V),E(V)},A=N=>{let V="";switch(h){case"link":V=N==="edit"?(0,u.t)("grafana-ui.data-links-inline-editor.edit-link","Edit link"):(0,u.t)("grafana-ui.data-links-inline-editor.add-link","Add link");break;case"action":V=N==="edit"?(0,u.t)("grafana-ui.action-editor.inline.edit-action","Edit action"):(0,u.t)("grafana-ui.action-editor.inline.add-action","Add action");break}return V};return(0,n.jsxs)("div",{className:W.container,children:[(0,n.jsx)(s.JY,{onDragEnd:L,children:(0,n.jsx)(s.gL,{droppableId:"sortable-links",direction:"vertical",children:N=>(0,n.jsxs)("div",{className:W.wrapper,ref:N.innerRef,...N.droppableProps,children:[j.map((V,z)=>{const w=`${V.title}/${z}`;return(0,n.jsx)(x,{index:z,item:V,onChange:S,onEdit:()=>P(z),onRemove:()=>T(z),data:b,itemKey:w},w)}),N.placeholder]})})}),B&&C!==null&&(0,n.jsx)(g.a,{title:A(M?"add":"edit"),isOpen:!0,closeOnBackdropClick:!1,onDismiss:()=>{_(C)},children:D(j[C],C,S,_)}),(0,n.jsx)(l.$n,{size:"sm",icon:"plus",onClick:K,variant:"secondary",className:W.button,children:A("add")})]})}const y=h=>({container:(0,a.css)({position:"relative"}),wrapper:(0,a.css)({marginBottom:h.spacing(2),display:"flex",flexDirection:"column"}),button:(0,a.css)({marginLeft:h.spacing(1)})})},45558:(te,R,e)=>{"use strict";e.d(R,{K:()=>l});var n=e(74848),a=e(92745),s=e(45861),i=e(18027),r=e(97095),u=e(63527),o=e(87105);const l=({hasCert:g,label:f,onChange:p,onClick:c,placeholder:x})=>(0,n.jsxs)(r.C,{children:[(0,n.jsx)(i.I,{label:f,labelWidth:14,disabled:g,children:g?(0,n.jsx)(u.p,{type:"text",value:"configured",width:24}):(0,n.jsx)(o.f,{rows:7,onChange:p,placeholder:x,required:!0})}),g&&(0,n.jsx)(s.$n,{variant:"secondary",onClick:c,style:{marginLeft:4},children:(0,n.jsx)(a.x6,{i18nKey:"grafana-ui.data-source-settings.cert-key-reset",children:"Reset"})})]})},55803:(te,R,e)=>{"use strict";e.d(R,{P:()=>v});var n=e(74848),a=e(22803),s=e(2543),i=e.n(s),r=e(96540),u=e(92745),o=e(63142),l=e(45861),g=e(94959),f=e(30703),p=e(23659);const c=()=>({layout:(0,a.css)({display:"flex",alignItems:"center",marginBottom:"4px","> *":{marginLeft:"4px",marginBottom:0,height:"100%","&:first-child, &:last-child":{marginLeft:0}}})}),x=({header:y,onBlur:h,onChange:d,onRemove:E,onReset:b})=>{const D=(0,o.of)(c);return(0,n.jsxs)("div",{className:D.layout,children:[(0,n.jsx)(g.z,{label:(0,u.t)("grafana-ui.data-source-settings.custom-headers-header","Header"),name:"name",placeholder:"X-Custom-Header",labelWidth:5,value:y.name||"",onChange:C=>d({...y,name:C.target.value}),onBlur:h}),(0,n.jsx)(p.L,{label:(0,u.t)("grafana-ui.data-source-settings.custom-headers-header-value","Value"),"aria-label":(0,u.t)("grafana-ui.data-source-settings.custom-headers-header-value","Value"),name:"value",isConfigured:y.configured,value:y.value,labelWidth:5,inputWidth:y.configured?11:12,placeholder:(0,u.t)("grafana-ui.data-source-settings.custom-headers-header-placeholder","Header Value"),onReset:()=>b(y.id),onChange:C=>d({...y,value:C.target.value}),onBlur:h}),(0,n.jsx)(l.$n,{type:"button","aria-label":(0,u.t)("grafana-ui.data-source-settings.custom-headers-header-remove","Remove header"),variant:"secondary",size:"xs",onClick:C=>E(y.id),children:(0,n.jsx)(f.I,{name:"trash-alt"})})]})};x.displayName="CustomHeaderRow";class v extends r.PureComponent{constructor(h){super(h),this.state={headers:[]},this.updateSettings=()=>{const{headers:D}=this.state,C=Object.fromEntries(Object.entries(this.props.dataSourceConfig.jsonData).filter(([M,O])=>!M.startsWith("httpHeaderName"))),P=Object.fromEntries(Object.entries(this.props.dataSourceConfig.secureJsonData||{}).filter(([M,O])=>!M.startsWith("httpHeaderValue")));for(const[M,O]of D.entries())C[`httpHeaderName${M+1}`]=O.name,O.configured||(P[`httpHeaderValue${M+1}`]=O.value);this.props.onChange({...this.props.dataSourceConfig,jsonData:C,secureJsonData:P})},this.onHeaderAdd=()=>{this.setState(D=>({headers:[...D.headers,{id:(0,s.uniqueId)(),name:"",value:"",configured:!1}]}))},this.onHeaderChange=(D,C)=>{this.setState(({headers:P})=>({headers:P.map((M,O)=>D!==O?M:{...C})}))},this.onHeaderReset=D=>{this.setState(({headers:C})=>({headers:C.map((P,M)=>P.id!==D?P:{...P,value:"",configured:!1})}))},this.onHeaderRemove=D=>{this.setState(({headers:C})=>({headers:C.filter(P=>P.id!==D)}),this.updateSettings)};const{jsonData:d,secureJsonData:E,secureJsonFields:b}=this.props.dataSourceConfig;this.state={headers:Object.keys(d).sort().filter(D=>D.startsWith("httpHeaderName")).map((D,C)=>({id:(0,s.uniqueId)(),name:d[D],value:E!==void 0?E[D]:"",configured:b&&b[`httpHeaderValue${C+1}`]||!1}))}}render(){const{headers:h}=this.state,{dataSourceConfig:d}=this.props;return(0,n.jsxs)("div",{className:"gf-form-group",children:[(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsx)("h6",{children:(0,n.jsx)(u.x6,{i18nKey:"grafana-ui.data-source-settings.custom-headers-title",children:"Custom HTTP Headers"})})}),(0,n.jsx)("div",{children:h.map((E,b)=>(0,n.jsx)(x,{header:E,onChange:D=>{this.onHeaderChange(b,D)},onBlur:this.updateSettings,onRemove:this.onHeaderRemove,onReset:this.onHeaderReset},E.id))}),!d.readOnly&&(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsx)(l.$n,{variant:"secondary",icon:"plus",type:"button",onClick:E=>{this.onHeaderAdd()},children:(0,n.jsx)(u.x6,{i18nKey:"grafana-ui.data-source-settings.custom-headers-add",children:"Add header"})})})]})}}var m=null},96004:(te,R,e)=>{"use strict";e.d(R,{t:()=>S});var n=e(74848),a=e(22803),s=e(96540),i=e(51898),r=e(92745),u=e(63142),o=e(34999),l=e(45861),g=e(37386),f=e(18027),p=e(77824),c=e(30703),x=e(63527),v=e(41654),m=e(21285),y=e(10928),h=e(66404),d=e(94959),E=e(23659);const b=({dataSourceConfig:_,onChange:K})=>{const T=_.secureJsonData?_.secureJsonData.basicAuthPassword:"",L=()=>{K({..._,secureJsonData:{..._.secureJsonData,basicAuthPassword:""},secureJsonFields:{..._.secureJsonFields,basicAuthPassword:!1}})},A=N=>{K({..._,secureJsonData:{..._.secureJsonData,basicAuthPassword:N.currentTarget.value}})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.I,{disabled:_.readOnly,children:(0,n.jsx)(d.z,{label:(0,r.t)("grafana-ui.data-source-basic-auth-settings.user-label","User"),labelWidth:10,inputWidth:18,placeholder:(0,r.t)("grafana-ui.data-source-basic-auth-settings.user-placeholder","user"),value:_.basicAuthUser,onChange:N=>K({..._,basicAuthUser:N.currentTarget.value})})}),(0,n.jsx)(f.I,{disabled:_.readOnly,children:(0,n.jsx)(E.L,{isConfigured:!!(_.secureJsonFields&&_.secureJsonFields.basicAuthPassword),value:T||"",inputWidth:18,labelWidth:10,onReset:L,onChange:A})})]})};var D=e(55803);const C=26,P=({dataSourceConfig:_,onChange:K,showForwardOAuthIdentityOption:T=!0})=>{const L=(0,u.of)(M);return(0,n.jsxs)("div",{className:L,children:[(0,n.jsxs)(v.B,{direction:"row",gap:.5,children:[(0,n.jsx)(f.I,{label:(0,r.t)("grafana-ui.data-source-http-proxy-settings.ts-client-auth-label","TLS Client Auth"),labelWidth:C,disabled:_.readOnly,children:(0,n.jsx)(m.K,{id:"http-settings-tls-client-auth",value:_.jsonData.tlsAuth||!1,onChange:A=>K({..._.jsonData,tlsAuth:A.currentTarget.checked})})}),(0,n.jsx)(f.I,{label:(0,r.t)("grafana-ui.data-source-http-proxy-settings.with-ca-cert-label","With CA Cert"),tooltip:(0,r.t)("grafana-ui.data-source-http-proxy-settings.with-ca-cert-tooltip","Needed for verifying self-signed TLS Certs"),labelWidth:C,disabled:_.readOnly,children:(0,n.jsx)(m.K,{id:"http-settings-ca-cert",value:_.jsonData.tlsAuthWithCACert||!1,onChange:A=>K({..._.jsonData,tlsAuthWithCACert:A.currentTarget.checked})})})]}),(0,n.jsx)(f.I,{label:(0,r.t)("grafana-ui.data-source-http-proxy-settings.skip-tls-verify-label","Skip TLS Verify"),labelWidth:C,disabled:_.readOnly,children:(0,n.jsx)(m.K,{id:"http-settings-skip-tls-verify",value:_.jsonData.tlsSkipVerify||!1,onChange:A=>K({..._.jsonData,tlsSkipVerify:A.currentTarget.checked})})}),T&&(0,n.jsx)(f.I,{label:(0,r.t)("grafana-ui.data-source-http-proxy-settings.oauth-identity-label","Forward OAuth Identity"),tooltip:(0,r.t)("grafana-ui.data-source-http-proxy-settings.oauth-identity-tooltip","Forward the user's upstream OAuth identity to the data source (Their access token gets passed along)."),labelWidth:C,disabled:_.readOnly,children:(0,n.jsx)(m.K,{id:"http-settings-forward-oauth",value:_.jsonData.oauthPassThru||!1,onChange:A=>K({..._.jsonData,oauthPassThru:A.currentTarget.checked})})})]})},M=_=>(0,a.css)({display:"grid",gridTemplateColumns:"auto",gap:0});var O=e(3936),j=e(37235);const U="grafana-http-access-help",W=()=>(0,n.jsxs)(o.F,{severity:"info",title:(0,r.t)("grafana-ui.data-source-http-settings.access-help-title","Access help"),topSpacing:3,id:U,children:[(0,n.jsx)("p",{children:(0,n.jsxs)(r.x6,{i18nKey:"grafana-ui.data-source-http-settings.access-help-details",children:["Access mode controls how requests to the data source will be handled.",(0,n.jsxs)("strong",{children:["\xA0",(0,n.jsx)("i",{children:"Server"})]})," ","should be the preferred way if nothing else is stated."]})}),(0,n.jsx)(r.x6,{i18nKey:"grafana-ui.data-source-http-settings.server-mode-title",children:(0,n.jsx)(h.E,{weight:"medium",children:"Server access mode (Default):"})}),(0,n.jsx)("p",{children:(0,n.jsx)(r.x6,{i18nKey:"grafana-ui.data-source-http-settings.server-mode-description",children:"All requests will be made from the browser to Grafana backend/server which in turn will forward the requests to the data source and by that circumvent possible Cross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the grafana backend/server if you select this access mode."})}),(0,n.jsx)(r.x6,{i18nKey:"grafana-ui.data-source-http-settings.browser-mode-title",children:(0,n.jsx)(h.E,{weight:"medium",children:"Browser access mode:"})}),(0,n.jsx)("p",{children:(0,n.jsx)(r.x6,{i18nKey:"grafana-ui.data-source-http-settings.browser-mode-description",children:"All requests will be made from the browser directly to the data source and may be subject to Cross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the browser if you select this access mode."})})]}),B=26,S=_=>{const{defaultUrl:K,dataSourceConfig:T,onChange:L,showAccessOptions:A,sigV4AuthToggleEnabled:N,showForwardOAuthIdentityOption:V,azureAuthSettings:z,renderSigV4Editor:w,secureSocksDSProxyEnabled:H,urlLabel:Q,urlDocs:Z}=_,Y=(0,s.useMemo)(()=>[{label:(0,r.t)("grafana-ui.data-source-http-settings.server-mode-label","Server (default)"),value:"proxy"},{label:(0,r.t)("grafana-ui.data-source-http-settings.browser-mode-label","Browser"),value:"direct"}],[]),X=(0,s.useMemo)(()=>Y[0],[Y]),[I,J]=(0,s.useState)(!1),[ee,q]=(0,s.useState)(!1),ne=(0,u.$j)();let se;const oe=(0,s.useCallback)(ce=>{const ie=z?.azureAuthSupported&&z.getAzureAuthEnabled(T)||!1;if(q(ie),ie){const ve=T.jsonData.oauthPassThru!==void 0?T.jsonData.oauthPassThru:!1;ce={...ce,jsonData:{...T.jsonData,oauthPassThru:ie?!1:ve}}}L({...T,...ce})},[z,T,L]);switch(T.access){case"direct":se=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r.x6,{i18nKey:"grafana-ui.data-source-http-settings.direct-url-tooltip",children:["Your access method is ",(0,n.jsx)("em",{children:"Browser"}),", this means the URL needs to be accessible from the browser."]}),Z]});break;case"proxy":se=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r.x6,{i18nKey:"grafana-ui.data-source-http-settings.proxy-url-tooltip",children:["Your access method is ",(0,n.jsx)("em",{children:"Server"}),", this means the URL needs to be accessible from the grafana backend/server."]}),Z]});break;default:se=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.x6,{i18nKey:"grafana-ui.data-source-http-settings.default-url-tooltip",children:"Specify a complete HTTP URL (for example http://your_server:8080)"}),Z]})}const de=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/.test(T.url),fe=(0,a.css)({display:"grid",gridTemplateColumns:"auto 1fr",gap:ne.spacing(.5)}),ae=(0,s.useId)();return(0,n.jsxs)(v.B,{direction:"column",gap:5,children:[(0,n.jsxs)("section",{children:[(0,n.jsx)("h3",{className:"page-heading",children:(0,n.jsx)(r.x6,{i18nKey:"grafana-ui.data-source-http-settings.heading",children:"HTTP"})}),(0,n.jsx)(g.D,{label:Q??"URL",description:se,invalid:!de,error:!de&&(0,r.t)("grafana-ui.data-source-http-settings.invalid-url-error","Invalid URL"),disabled:T.readOnly,children:(0,n.jsx)(x.p,{id:ae,width:40,placeholder:K,value:T.url,"data-testid":i.Tp.components.DataSource.DataSourceHttpSettings.urlInput,onChange:ce=>oe({url:ce.currentTarget.value})})}),A&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.D,{label:(0,r.t)("grafana-ui.data-source-http-settings.access-label","Access"),disabled:T.readOnly,children:(0,n.jsxs)(v.B,{direction:"row",gap:.5,children:[(0,n.jsx)(p.z,{"aria-label":(0,r.t)("grafana-ui.data-source-http-settings.access-label","Access"),options:Y,value:Y.find(ce=>ce.value===T.access)?.value||X.value,onChange:ce=>oe({access:ce})}),(0,n.jsx)(l.$n,{type:"button",variant:"secondary",size:"md",fill:"outline",onClick:()=>J(ce=>!ce),"aria-expanded":I,"aria-controls":U,children:(0,n.jsxs)(r.x6,{i18nKey:"grafana-ui.data-source-http-settings.access-help",children:["Help\xA0",(0,n.jsx)(c.I,{name:I?"angle-down":"angle-right"})]})})]})}),I&&(0,n.jsx)(W,{})]}),T.access==="proxy"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.D,{label:(0,r.t)("grafana-ui.data-source-http-settings.allowed-cookies","Allowed cookies"),description:(0,r.t)("grafana-ui.data-source-http-settings.allowed-cookies-description","Grafana proxy deletes forwarded cookies by default. Specify cookies by name that should be forwarded to the data source."),children:(0,n.jsx)(y.u,{tags:T.jsonData.keepCookies,width:40,onChange:ce=>oe({jsonData:{...T.jsonData,keepCookies:ce}}),disabled:T.readOnly})}),(0,n.jsx)(g.D,{label:(0,r.t)("grafana-ui.data-source-http-settings.timeout-label","Timeout"),description:(0,r.t)("grafana-ui.data-source-http-settings.timeout-description","HTTP request timeout in seconds"),disabled:T.readOnly,children:(0,n.jsx)(x.p,{type:"number",width:40,placeholder:(0,r.t)("grafana-ui.data-source-http-settings.timeout-placeholder","Timeout in seconds"),value:T.jsonData.timeout,onChange:ce=>{oe({jsonData:{...T.jsonData,timeout:parseInt(ce.currentTarget.value,10)}})}})})]})]}),(0,n.jsxs)("section",{children:[(0,n.jsx)("h3",{className:"page-heading",children:(0,n.jsx)(r.x6,{i18nKey:"grafana-ui.data-source-http-settings.auth",children:"Auth"})}),(0,n.jsxs)(v.B,{direction:"column",gap:4,children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:fe,children:[(0,n.jsx)(f.I,{label:(0,r.t)("grafana-ui.data-source-http-settings.basic-auth-label","Basic auth"),labelWidth:B,disabled:T.readOnly,children:(0,n.jsx)(m.K,{id:"http-settings-basic-auth",value:T.basicAuth,onChange:ce=>{oe({basicAuth:ce.currentTarget.checked})}})}),(0,n.jsx)(f.I,{label:(0,r.t)("grafana-ui.data-source-http-settings.with-credentials-label","With Credentials"),tooltip:(0,r.t)("grafana-ui.data-source-http-settings.with-credentials-tooltip","Whether credentials such as cookies or auth headers should be sent with cross-site requests."),labelWidth:B,disabled:T.readOnly,children:(0,n.jsx)(m.K,{id:"http-settings-with-credentials",value:T.withCredentials,onChange:ce=>{oe({withCredentials:ce.currentTarget.checked})}})}),z?.azureAuthSupported&&(0,n.jsx)(f.I,{label:(0,r.t)("grafana-ui.data-source-http-settings.azure-auth-label","Azure Authentication"),tooltip:(0,r.t)("grafana-ui.data-source-http-settings.azure-auth-tooltip","Use Azure authentication for Azure endpoint."),labelWidth:B,disabled:T.readOnly,children:(0,n.jsx)(m.K,{id:"http-settings-azure-auth",value:ee,onChange:ce=>{oe(z.setAzureAuthEnabled(T,ce.currentTarget.checked))}})}),N&&(0,n.jsx)(f.I,{label:(0,r.t)("grafana-ui.data-source-http-settings.sigv4-auth-label","SigV4 auth"),labelWidth:B,disabled:T.readOnly,children:(0,n.jsx)(m.K,{id:"http-settings-sigv4-auth",value:T.jsonData.sigV4Auth||!1,onChange:ce=>{oe({jsonData:{...T.jsonData,sigV4Auth:ce.currentTarget.checked}})}})})]}),T.access==="proxy"&&(0,n.jsx)(P,{dataSourceConfig:T,onChange:ce=>oe({jsonData:ce}),showForwardOAuthIdentityOption:ee?!1:V})]}),T.basicAuth&&(0,n.jsxs)("section",{children:[(0,n.jsx)(h.E,{variant:"h6",element:"h4",children:(0,n.jsx)(r.x6,{i18nKey:"grafana-ui.data-source-http-settings.basic-auth",children:"Basic Auth Details"})}),(0,n.jsx)(b,{..._})]}),z?.azureAuthSupported&&ee&&z.azureSettingsUI&&(0,n.jsx)(z.azureSettingsUI,{dataSourceConfig:T,onChange:L}),T.jsonData.sigV4Auth&&N&&w,(T.jsonData.tlsAuth||T.jsonData.tlsAuthWithCACert)&&(0,n.jsx)(j.j,{dataSourceConfig:T,onChange:L}),T.access==="proxy"&&(0,n.jsx)(D.P,{dataSourceConfig:T,onChange:L})]})]}),H&&(0,n.jsx)(O.Y,{options:T,onOptionsChange:L})]})}},3936:(te,R,e)=>{"use strict";e.d(R,{Y:()=>r});var n=e(74848),a=e(92745),s=e(21285),i=e(18027);function r({options:u,onOptionsChange:o}){return(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"page-heading",children:(0,n.jsx)(a.x6,{i18nKey:"grafana-ui.data-source-settings.secure-socks-heading",children:"Secure Socks Proxy"})}),(0,n.jsx)("div",{className:"gf-form-group",children:(0,n.jsx)("div",{className:"gf-form-inline",children:(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsx)(i.I,{labelWidth:26,label:(0,a.t)("grafana-ui.data-source-settings.secure-socks-label","Enabled"),tooltip:(0,a.t)("grafana-ui.data-source-settings.secure-socks-tooltip","Connect to this datasource via the secure socks proxy."),children:(0,n.jsx)(s.K,{value:u.jsonData.enableSecureSocksProxy??!1,onChange:l=>o({...u,jsonData:{...u.jsonData,enableSecureSocksProxy:l.currentTarget.checked}})})})})})})]})}},37235:(te,R,e)=>{"use strict";e.d(R,{j:()=>l});var n=e(74848),a=e(22803),s=e(92745),i=e(94959),r=e(30703),u=e(45967),o=e(45558);const l=({dataSourceConfig:g,onChange:f})=>{const p=g.secureJsonFields&&g.secureJsonFields.tlsCACert,c=g.secureJsonFields&&g.secureJsonFields.tlsClientCert,x=g.secureJsonFields&&g.secureJsonFields.tlsClientKey,v=g.jsonData&&g.jsonData.serverName,m=b=>D=>{D.preventDefault();const C={...g.secureJsonFields};C[b]=!1,f({...g,secureJsonFields:C})},y=b=>D=>{const C={...g.secureJsonData};C[b]=D.currentTarget.value,f({...g,secureJsonData:C})},h=b=>{const D={...g.jsonData,serverName:b.currentTarget.value};f({...g,jsonData:D})},d="-----BEGIN CERTIFICATE-----";return(0,n.jsxs)("div",{className:"gf-form-group",children:[(0,n.jsxs)("div",{className:(0,a.cx)("gf-form",(0,a.css)({alignItems:"baseline"})),children:[(0,n.jsx)("h6",{children:(0,n.jsx)(s.x6,{i18nKey:"grafana-ui.data-source-settings.tls-heading",children:"TLS/SSL Auth Details"})}),(0,n.jsx)(u.m,{placement:"right-end",content:(0,s.t)("grafana-ui.data-source-settings.tls-tooltip","TLS/SSL Certs are encrypted and stored in the Grafana database."),theme:"info",children:(0,n.jsx)(r.I,{name:"info-circle",size:"xs",style:{marginLeft:"10px"}})})]}),(0,n.jsxs)("div",{children:[g.jsonData.tlsAuthWithCACert&&(0,n.jsx)(o.K,{hasCert:!!p,onChange:y("tlsCACert"),placeholder:(0,s.t)("grafana-ui.data-source-settings.tls-certification-placeholder","Begins with {{certificateBeginsWith}}",{certificateBeginsWith:d}),label:(0,s.t)("grafana-ui.data-source-settings.tls-certification-label","CA Cert"),onClick:m("tlsCACert")}),g.jsonData.tlsAuth&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsx)(i.z,{label:(0,s.t)("grafana-ui.data-source-settings.tls-server-name-label","ServerName"),labelWidth:7,inputWidth:30,placeholder:"domain.example.com",value:v&&g.jsonData.serverName,onChange:h})}),(0,n.jsx)(o.K,{hasCert:!!c,label:(0,s.t)("grafana-ui.data-source-settings.tls-client-certification-label","Client Cert"),onChange:y("tlsClientCert"),placeholder:(0,s.t)("grafana-ui.data-source-settings.tls-certification-placeholder","Begins with {{certificateBeginsWith}}",{certificateBeginsWith:d}),onClick:m("tlsClientCert")}),(0,n.jsx)(o.K,{hasCert:!!x,label:(0,s.t)("grafana-ui.data-source-settings.tls-client-key-label","Client Key"),placeholder:(0,s.t)("grafana-ui.data-source-settings.tls-client-key-placeholder","Begins with {{privateKeyBeginsWith}}",{privateKeyBeginsWith:"-----BEGIN RSA PRIVATE KEY-----"}),onChange:y("tlsClientKey"),onClick:m("tlsClientKey")})]})]})]})}},96396:(te,R,e)=>{"use strict";e.d(R,{l:()=>g});var n=e(74848),a=e(22803),s=e(96540),i=e(93581),r=e(63142),u=e(8135),o=e(30703),l=e(66630);const g=(0,s.memo)(c=>{const x=(0,r.of)(p),{isOpen:v,onClose:m}=c;return v?(0,n.jsx)(u.N,{useCapture:!0,includeButtonPress:!1,onClick:m,children:(0,n.jsx)("div",{className:x.modal,"data-testid":"date-picker",children:(0,n.jsx)(f,{...c})})}):null});g.displayName="DatePicker";const f=(0,s.memo)(({value:c,minDate:x,maxDate:v,onChange:m})=>{const y=(0,r.of)(l.h2);return(0,n.jsx)(i.Ay,{className:y.body,tileClassName:y.title,value:c||new Date,minDate:x,maxDate:v,nextLabel:(0,n.jsx)(o.I,{name:"angle-right"}),prevLabel:(0,n.jsx)(o.I,{name:"angle-left"}),onChange:h=>{h&&!Array.isArray(h)&&m(h)},locale:"en"})});f.displayName="Body";const p=c=>({modal:(0,a.css)({zIndex:c.zIndex.modal,boxShadow:c.shadows.z3,backgroundColor:c.colors.background.primary,border:`1px solid ${c.colors.border.weak}`,borderTopLeftRadius:c.shape.radius.default,borderBottomLeftRadius:c.shape.radius.default,"button:disabled":{color:c.colors.text.disabled}})})},43482:(te,R,e)=>{"use strict";e.d(R,{l:()=>c});var n=e(74848),a=e(22803),s=e(34743),i=e(83505),r=e(46885),u=e(96540),o=e(25229),l=e(63142),g=e(63527),f=e(96396);const p=v=>(0,o.KQ)(v).format("L"),c=(0,u.forwardRef)(({value:v,minDate:m,maxDate:y,onChange:h,closeOnSelect:d,placeholder:E="Date",...b},D)=>{const[C,P]=(0,u.useState)(!1),M=(0,l.of)(x),O=[(0,s.UU)({crossAxis:!1,boundary:document.body}),(0,s.BN)()],{context:j,refs:U,floatingStyles:W}=(0,i.we)({open:C,placement:"bottom-start",onOpenChange:P,middleware:O,whileElementsMounted:r.ll,strategy:"fixed"}),B=(0,i.kp)(j),S=(0,i.s9)(j),{getReferenceProps:_,getFloatingProps:K}=(0,i.bv)([S,B]);return(0,u.useImperativeHandle)(D,()=>U.domReference.current,[U.domReference]),(0,n.jsxs)("div",{className:M.container,children:[(0,n.jsx)(g.p,{ref:U.setReference,type:"text",autoComplete:"off",placeholder:E,value:v&&p(v),onChange:T=>{T.target.value===""&&h("")},className:M.input,...b,..._()}),(0,n.jsx)("div",{className:M.popover,ref:U.setFloating,style:W,...K(),children:(0,n.jsx)(f.l,{isOpen:C,value:v&&typeof v!="string"?v:(0,o.KQ)().toDate(),minDate:m,maxDate:y,onChange:T=>{h(T),d&&P(!1)},onClose:()=>P(!1)})})]})});c.displayName="DatePickerWithInput";const x=v=>({container:(0,a.css)({position:"relative"}),input:(0,a.css)({"input[type='date']::-webkit-inner-spin-button, input[type='date']::-webkit-calendar-picker-indicator":{display:"none",WebkitAppearance:"none"}}),popover:(0,a.css)({zIndex:v.zIndex.tooltip})})},27282:(te,R,e)=>{"use strict";e.d(R,{K:()=>B});var n=e(74848),a=e(22803),s=e(34743),i=e(83505),r=e(46885),u=e(18828),o=e(42211),l=e(93225),g=e(96540),f=e(93581),p=e(49045),c=e(80011),x=e(25229),v=e(60188),m=e(51898),y=e(92745),h=e(63142),d=e(45861),E=e(18027),b=e(30703),D=e(63527),C=e(41654),P=e(35621),M=e(15245),O=e(11527),j=e(66630),U=e(62348),W=e(41e3);const B=({date:T,maxDate:L,minDate:A,label:N,onChange:V,disabledHours:z,disabledMinutes:w,disabledSeconds:H,timeZone:Q,showSeconds:Z=!0,clearable:Y=!1})=>{const[X,I]=(0,g.useState)(!1),J=(0,g.useRef)(null),{overlayProps:ee,underlayProps:q}=(0,l.e)({onClose:()=>I(!1),isDismissable:!0,isOpen:X,shouldCloseOnInteractOutside:Ee=>{const Re=document.getElementsByClassName(O.i)[0];return!(Re&&Re.contains(Ee))}},J),{dialogProps:ne}=(0,u.s)({},J),se=(0,h.$j)(),{modalBackdrop:oe}=(0,h.of)(P.o),de=(0,p.A)(`(min-width: ${se.breakpoints.values.lg}px)`),fe=(0,h.of)(K),ae=[(0,s.UU)({crossAxis:!1,boundary:document.body}),(0,s.BN)()],{refs:ce,floatingStyles:ie}=(0,i.we)({open:X,placement:"bottom-start",onOpenChange:I,middleware:ae,whileElementsMounted:r.ll,strategy:"fixed"}),ve=(0,g.useCallback)(Ee=>{I(!1),V(Ee)},[V]),le=(0,g.useCallback)(Ee=>{Ee.preventDefault(),I(!0)},[I]);return(0,n.jsxs)("div",{"data-testid":"date-time-picker",style:{position:"relative"},children:[(0,n.jsx)(S,{date:T,onChange:V,isFullscreen:de,onOpen:le,label:N,ref:ce.setReference,showSeconds:Z,clearable:Y,timeZone:Q}),X?de?(0,n.jsx)(M.ZL,{children:(0,n.jsx)(o.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)("div",{ref:J,...ee,...ne,children:(0,n.jsx)(_,{date:T,onChange:ve,isFullscreen:!0,onClose:()=>I(!1),maxDate:L,minDate:A,ref:ce.setFloating,style:ie,showSeconds:Z,disabledHours:z,disabledMinutes:w,disabledSeconds:H,timeZone:Q})})})}):(0,n.jsxs)(M.ZL,{children:[(0,n.jsx)("div",{className:oe,...q}),(0,n.jsx)(o.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)("div",{ref:J,...ee,...ne,children:(0,n.jsx)("div",{className:fe.modal,children:(0,n.jsx)(_,{date:T,maxDate:L,minDate:A,onChange:ve,isFullscreen:!1,onClose:()=>I(!1),showSeconds:Z,disabledHours:z,disabledMinutes:w,disabledSeconds:H,timeZone:Q})})})})]}):null]})},S=g.forwardRef(({date:T,label:L,onChange:A,onOpen:N,timeZone:V,showSeconds:z=!0,clearable:w=!1},H)=>{const Q=(0,h.of)(K),Z=z?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD HH:mm",[Y,X]=(0,g.useState)(()=>({value:T?(0,c.LE)(T,{timeZone:V}):w?"":(0,c.LE)((0,x.KQ)(),{timeZone:V}),invalid:!1}));(0,g.useEffect)(()=>{if(T){const ne=(0,c.LE)(T,{format:Z,timeZone:V});X({invalid:!(0,U.f)(ne),value:(0,x.Ar)(T)?ne:T})}},[T,Z,V]);const I=(0,g.useCallback)(ne=>{const se=!(0,U.f)(ne.currentTarget.value);X({value:ne.currentTarget.value,invalid:se})},[]),J=(0,g.useCallback)(()=>{if(!Y.invalid&&Y.value){const ne=(0,x.oZ)((0,v.O)({timeZone:V}),Y.value);A(ne)}},[Y,A,V]),ee=(0,g.useCallback)(()=>{X({value:"",invalid:!1}),A()},[A]),q=(0,n.jsx)(d.$n,{"aria-label":(0,y.t)("grafana-ui.date-time-picker.calendar-icon-label","Time picker"),icon:"calendar-alt",variant:"secondary",onClick:N});return(0,n.jsx)(E.I,{label:L,invalid:!!(Y.value&&Y.invalid),className:Q.field,children:(0,n.jsx)(D.p,{onChange:I,addonAfter:q,value:Y.value,onBlur:J,"data-testid":m.XF.DateTimePicker.input,placeholder:(0,y.t)("grafana-ui.date-time-picker.select-placeholder","Select date/time"),ref:H,suffix:w&&Y.value&&(0,n.jsx)(b.I,{name:"times",className:Q.clearIcon,onClick:ee})})})});S.displayName="DateTimeInput";const _=g.forwardRef(({date:T,onClose:L,onChange:A,isFullscreen:N,maxDate:V,minDate:z,style:w,showSeconds:H=!0,disabledHours:Q,disabledMinutes:Z,disabledSeconds:Y,timeZone:X},I)=>{const J=(0,h.of)(j.h2),ee=(0,h.of)(K),[q,ne]=(0,g.useState)(()=>T&&T.isValid()?(0,x.oZ)((0,v.O)({timeZone:X}),T):(0,x.oZ)((0,v.O)({timeZone:X}),new Date)),[se,oe]=(0,g.useState)(()=>T&&T.isValid()?(0,W.Q)(T.toDate(),(0,v.O)({timeZone:X})):(0,W.Q)(new Date,(0,v.O)({timeZone:X}))),de=(0,g.useCallback)(ce=>{ce&&!Array.isArray(ce)&&oe(ce)},[]),fe=(0,g.useCallback)(ce=>{ne(ce)},[]),ae=()=>{const ce=(0,x.KQ)(q);ce.set("date",se.getDate()),ce.set("month",se.getMonth()),ce.set("year",se.getFullYear()),A(ce)};return(0,n.jsxs)("div",{className:(0,a.cx)(ee.container,{[ee.fullScreen]:N}),style:w,ref:I,children:[(0,n.jsx)(f.Ay,{next2Label:null,prev2Label:null,value:se,nextLabel:(0,n.jsx)(b.I,{name:"angle-right"}),nextAriaLabel:(0,y.t)("grafana-ui.date-time-picker.next-label","Next month"),prevLabel:(0,n.jsx)(b.I,{name:"angle-left"}),prevAriaLabel:(0,y.t)("grafana-ui.date-time-picker.previous-label","Previous month"),onChange:de,locale:"en",className:J.body,tileClassName:J.title,maxDate:V,minDate:z}),(0,n.jsx)("div",{className:ee.time,children:(0,n.jsx)(O.R,{showSeconds:H,onChange:fe,value:q,disabledHours:Q,disabledMinutes:Z,disabledSeconds:Y})}),(0,n.jsxs)(C.B,{children:[(0,n.jsx)(d.$n,{type:"button",onClick:ae,children:(0,n.jsx)(y.x6,{i18nKey:"grafana-ui.date-time-picker.apply",children:"Apply"})}),(0,n.jsx)(d.$n,{variant:"secondary",type:"button",onClick:L,children:(0,n.jsx)(y.x6,{i18nKey:"grafana-ui.date-time-picker.cancel",children:"Cancel"})})]})]})});_.displayName="DateTimeCalendar";const K=T=>({container:(0,a.css)({padding:T.spacing(1),border:`1px ${T.colors.border.weak} solid`,borderRadius:T.shape.radius.default,backgroundColor:T.colors.background.primary,zIndex:T.zIndex.modal}),fullScreen:(0,a.css)({position:"absolute"}),time:(0,a.css)({marginBottom:T.spacing(2)}),modal:(0,a.css)({position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:T.zIndex.modal,maxWidth:"280px"}),clearIcon:(0,a.css)({cursor:"pointer"}),field:(0,a.css)({marginBottom:0,width:"100%"})})},90929:(te,R,e)=>{"use strict";e.d(R,{N:()=>S});var n=e(74848),a=e(22803),s=e(34743),i=e(83505),r=e(46885),u=e(18828),o=e(42211),l=e(93225),g=e(96540),f=e(92745),p=e(63142),c=e(45861),x=e(37386),v=e(30703),m=e(63527),y=e(92807),h=e(47087),d=e(44398),E=e(8431);const b=/^now$|^now(\-|\+)(\d{1,10})([wdhms])$/,D=T=>({from:O(T.from),to:O(T.to)}),C=T=>{const L=U(T.from),A=U(T.to);return{from:L,to:A,display:`${L} to ${A}`}},P=(T,L=Date.now())=>M(T)?O(T)>Math.ceil(L/1e3)?{isValid:!1,errorMessage:"Can not enter value prior to January 1, 1970."}:{isValid:!0}:{isValid:!1,errorMessage:"Value not in relative time format."},M=T=>b.test(T),O=T=>{const L=b.exec(T);if(!L||L.length!==4)return 0;const[,A,N,V]=L,z=parseInt(N,10);if(isNaN(z))return 0;const w=z*j[V];return A==="+"?w*-1:w},j={w:604800,d:86400,h:3600,m:60,s:1},U=T=>{if(T===0)return"now";const L=Math.abs(T);return T<0?`now+${W(L)}`:`now-${W(L)}`};function W(T){const L=[{unit:"w",value:604800},{unit:"d",value:86400},{unit:"h",value:3600},{unit:"m",value:60},{unit:"s",value:1}];for(const{unit:N,value:V}of L)if(T%V===0)return`${T/V}${N}`;const A=L[L.length-1];return`${T}${A.unit}`}const B=E.o.filter(T=>M(T.from));function S(T){const{timeRange:L,onChange:A}=T,[N,V]=(0,g.useState)(!1),z=(0,g.useCallback)(()=>V(!1),[]),w=C(L),[H,Q]=(0,g.useState)({value:w.from,validation:P(w.from)}),[Z,Y]=(0,g.useState)({value:w.to,validation:P(w.to)}),X=(0,g.useRef)(null),{overlayProps:I,underlayProps:J}=(0,l.e)({onClose:()=>V(!1),isDismissable:!0,isOpen:N},X),{dialogProps:ee}=(0,u.s)({},X),q=[(0,s.UU)({crossAxis:!1,boundary:document.body}),(0,s.BN)()],{context:ne,refs:se,floatingStyles:oe}=(0,i.we)({open:N,placement:"bottom-start",onOpenChange:V,middleware:q,whileElementsMounted:r.ll,strategy:"fixed"}),de=(0,i.kp)(ne),fe=(0,i.s9)(ne),{getReferenceProps:ae,getFloatingProps:ce}=(0,i.bv)([fe,de]),ie=(0,p.of)(_(H.validation.errorMessage,Z.validation.errorMessage)),ve=Se=>{const Te=D(Se);Te&&(z(),Q({...H,value:Se.from}),Y({...Z,value:Se.to}),A(Te))},le=(0,g.useCallback)(Se=>{Se.stopPropagation(),Se.preventDefault(),V(!N)},[N]),Ee=Se=>{if(Se.preventDefault(),!Z.validation.isValid||!H.validation.isValid)return;const Te=D({from:H.value,to:Z.value,display:""});Te&&(A(Te),V(!1))},{from:Re,to:Oe}=w;return(0,n.jsxs)("div",{className:ie.container,children:[(0,n.jsxs)("button",{ref:se.setReference,className:ie.pickerInput,type:"button",onClick:le,...ae(),children:[(0,n.jsx)("span",{className:ie.clockIcon,children:(0,n.jsx)(v.I,{name:"clock-nine"})}),(0,n.jsx)("span",{children:(0,n.jsxs)(f.x6,{i18nKey:"time-picker.time-range.from-to",children:[{timeOptionFrom:Re}," to ",{timeOptionTo:Oe}]})}),(0,n.jsx)("span",{className:ie.caretIcon,children:(0,n.jsx)(v.I,{name:N?"angle-up":"angle-down",size:"lg"})})]}),N&&(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{role:"presentation",className:ie.backdrop,...J}),(0,n.jsx)(o.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)("div",{ref:X,...I,...ee,children:(0,n.jsx)("div",{className:ie.content,ref:se.setFloating,style:oe,...ce(),children:(0,n.jsxs)("div",{className:ie.body,children:[(0,n.jsx)("div",{className:ie.leftSide,children:(0,n.jsx)(y.P,{showScrollIndicators:!0,children:(0,n.jsx)(d.l,{title:(0,f.t)("time-picker.time-range.example-title","Example time ranges"),options:B,onChange:ve,value:w})})}),(0,n.jsxs)("div",{className:ie.rightSide,children:[(0,n.jsx)("div",{className:ie.title,children:(0,n.jsx)(h.e,{children:(0,n.jsx)(f.x6,{i18nKey:"time-picker.time-range.specify",children:"Specify time range"})})}),(0,n.jsx)(x.D,{label:(0,f.t)("time-picker.time-range.from-label","From"),invalid:!H.validation.isValid,error:H.validation.errorMessage,children:(0,n.jsx)(m.p,{onClick:Se=>Se.stopPropagation(),onBlur:()=>Q({...H,validation:P(H.value)}),onChange:Se=>Q({...H,value:Se.currentTarget.value}),value:H.value})}),(0,n.jsx)(x.D,{label:(0,f.t)("time-picker.time-range.to-label","To"),invalid:!Z.validation.isValid,error:Z.validation.errorMessage,children:(0,n.jsx)(m.p,{onClick:Se=>Se.stopPropagation(),onBlur:()=>Y({...Z,validation:P(Z.value)}),onChange:Se=>Y({...Z,value:Se.currentTarget.value}),value:Z.value})}),(0,n.jsx)(c.$n,{"aria-label":(0,f.t)("time-picker.time-range.submit-button-label","TimePicker submit button"),onClick:Ee,children:(0,n.jsx)(f.x6,{i18nKey:"time-picker.time-range.apply",children:"Apply time range"})})]})]})})})})]})]})}const _=(T,L)=>A=>{const N=(0,m.n)({theme:A,invalid:!1}),z=250+K(A,T)+K(A,L);return{backdrop:(0,a.css)({position:"fixed",zIndex:A.zIndex.modalBackdrop,top:0,right:0,bottom:0,left:0}),container:(0,a.css)({display:"flex",position:"relative"}),pickerInput:(0,a.cx)(N.input,N.wrapper,(0,a.css)({display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",paddingRight:0,paddingLeft:0,lineHeight:`${A.spacing.gridSize*A.components.height.md-2}px`})),caretIcon:(0,a.cx)(N.suffix,(0,a.css)({position:"relative",marginLeft:A.spacing(.5)})),clockIcon:(0,a.cx)(N.prefix,(0,a.css)({position:"relative",marginRight:A.spacing(.5)})),content:(0,a.css)({background:A.colors.background.primary,boxShadow:A.shadows.z3,position:"absolute",zIndex:A.zIndex.modal,width:"500px",top:"100%",borderRadius:A.shape.radius.default,border:`1px solid ${A.colors.border.weak}`,left:0,whiteSpace:"normal"}),body:(0,a.css)({display:"flex",height:`${z}px`}),description:(0,a.css)({color:A.colors.text.secondary,fontSize:A.typography.size.sm}),leftSide:(0,a.css)({width:"50% !important",borderRight:`1px solid ${A.colors.border.medium}`}),rightSide:(0,a.css)({width:"50%",padding:A.spacing(1)}),title:(0,a.css)({marginBottom:A.spacing(1)})}};function K(T,L){return L?L.length>34?T.spacing.gridSize*6.5:T.spacing.gridSize*4:0}},11527:(te,R,e)=>{"use strict";e.d(R,{R:()=>c,i:()=>p});var n=e(74848),a=e(22803),s=e(84783),i=e(34235),r=e(24938),u=e(25229),o=e(63142),l=e(35484),g=e(3343),f=e(30703);const p="time-of-day-picker-panel",c=({minuteStep:y=1,showHour:h=!0,showSeconds:d=!1,value:E,size:b="auto",disabled:D,disabledHours:C,disabledMinutes:P,disabledSeconds:M,placeholder:O,...j})=>{const U=(0,o.of)(m),W=j.allowEmpty??!1;return(0,n.jsx)(s.Ay,{generateConfig:i.A,locale:r.A,allowClear:W&&{clearIcon:(0,n.jsx)(f.I,{name:"times",className:U.clearIcon})},className:(0,a.cx)((0,g.lH)()[b],U.input),classNames:{popup:(0,a.cx)(U.picker,p)},defaultValue:j.allowEmpty?void 0:(0,u.AN)(),disabled:D,disabledTime:()=>({disabledHours:C,disabledMinutes:P,disabledSeconds:M}),format:x(h,d),minuteStep:y,onChange:B=>{if((0,u.u8)(B))return j.allowEmpty?j.onChange(B?(0,u.KQ)(B):void 0):j.onChange((0,u.KQ)(B))},picker:"time",placeholder:O,showNow:!1,needConfirm:!1,suffixIcon:(0,n.jsx)(v,{wrapperStyle:U.caretWrapper}),value:E&&(0,u.AN)(E)})};function x(y=!0,h=!1){const d=y?"HH:":"",E=h?":ss":"";return d+"mm"+E}const v=({wrapperStyle:y=""})=>(0,n.jsx)("div",{className:y,children:(0,n.jsx)(f.I,{name:"angle-down"})}),m=y=>{const h=y.components.input.background,d=y.colors.action.hover,E=y.shape.radius.default,b=y.components.input.borderColor;return{caretWrapper:(0,a.css)({position:"relative",top:"50%",transform:"translateY(-50%)",display:"inline-block",color:y.colors.text.secondary}),clearIcon:(0,a.css)({color:y.colors.text.secondary,"&:hover":{color:y.colors.text.maxContrast}}),picker:(0,a.css)({"&.rc-picker-dropdown":{boxShadow:"none",zIndex:y.zIndex.portal},".rc-picker-time-panel-column":{fontSize:y.typography.htmlFontSize,backgroundColor:h,color:y.colors.text.secondary,padding:"unset",overflowY:"auto",scrollbarWidth:"thin",width:y.spacing(8),li:{paddingRight:y.spacing(2),width:"auto","&.rc-picker-time-panel-cell-selected":{backgroundColor:"inherit",border:`1px solid ${y.colors.action.selectedBorder}`,borderRadius:E,color:y.colors.text.primary},"&:hover":{background:d,color:y.colors.text.primary},"&.rc-picker-time-panel-cell-disabled":{color:y.colors.action.disabledText}},".rc-picker-time-panel-cell-inner":{color:"inherit"},"&:not(:last-of-type)":{borderRight:`1px solid ${b}`}},".rc-picker-panel":{boxShadow:y.shadows.z3,backgroundColor:h,borderColor:b,borderRadius:E,overflow:"hidden"}}),input:(0,a.css)({"&.rc-picker-focused":{border:"none",".rc-picker-input":(0,l.getFocusStyles)(y)},"&.rc-picker-disabled":{".rc-picker-input":{backgroundColor:y.colors.action.disabledBackground,color:y.colors.action.disabledText,border:`1px solid ${y.colors.action.disabledBackground}`,"&:focus":{boxShadow:"none"}}},".rc-picker-input":{backgroundColor:h,borderRadius:E,borderColor:b,borderStyle:"solid",borderWidth:"1px",color:y.colors.text.primary,height:y.spacing(4),padding:y.spacing(0,1),input:{color:"unset",backgroundColor:"unset","&:focus":{outline:"none"},"&::placeholder":{color:y.colors.text.disabled}}},".rc-picker-clear":{alignItems:"center",display:"flex",insetInlineEnd:"unset",position:"relative"}})}}},72296:(te,R,e)=>{"use strict";e.d(R,{A:()=>i,X:()=>r});var n=e(74848),a=e(96540);const s=(0,a.createContext)(void 0);function i({children:u}){const[o,l]=(0,a.useState)(0),[g,f]=(0,a.useState)(),p=(0,a.useMemo)(()=>({sync:c=>f(c),unSync:()=>f(void 0),addPicker:()=>l(c=>c+1),removePicker:()=>{l(c=>{const x=c-1;return x<2&&f(void 0),x})},syncPossible:o>1,synced:!!g,syncedValue:g}),[o,g]);return(0,n.jsx)(s.Provider,{value:p,children:u})}function r(u){const o=(0,a.useContext)(s);return(0,a.useEffect)(()=>o?(o.addPicker(),u&&o.sync(u),()=>{o.removePicker()}):()=>{},[]),(0,a.useMemo)(()=>o&&{sync:o.sync,unSync:o.unSync,syncPossible:o.syncPossible,synced:o.synced,syncedValue:o.syncedValue},[o])}},56265:(te,R,e)=>{"use strict";e.d(R,{b:()=>h});var n=e(74848),a=e(22803),s=e(83505),i=e(42211),r=e(96540),u=e(25229),o=e(22592),l=e(51898),g=e(63142),f=e(30703),p=e(63527),c=e(4364),x=e(83692),v=e(8431),m=e(62348);const y=()=>{},h=({value:E,onChange:b,onChangeTimeZone:D=y,clearable:C,weekStart:P,hideTimeZone:M=!0,timeZone:O="browser",placeholder:j="Select time range",isReversed:U=!0,hideQuickRanges:W=!1,disabled:B=!1,showIcon:S=!1})=>{const[_,K]=(0,r.useState)(!1),T=(0,g.of)(d,B),L=X=>{X.stopPropagation(),X.preventDefault(),!B&&K(!_)},A=()=>{K(!1)},N=X=>{A(),b(X)},V=X=>{X.stopPropagation();const I=(0,u.KQ)(null),J=(0,u.KQ)(null);b({from:I,to:J,raw:{from:I,to:J}})},{refs:z,floatingStyles:w,context:H}=(0,s.we)({open:_,onOpenChange:K,placement:"bottom-start",strategy:"fixed"}),Q=(0,s.s9)(H,{bubbles:{outsidePress:!1}}),{getReferenceProps:Z,getFloatingProps:Y}=(0,s.bv)([Q]);return(0,n.jsxs)("div",{className:T.container,children:[(0,n.jsxs)("button",{type:"button",className:T.pickerInput,"data-testid":l.Tp.components.TimePicker.openButton,onClick:L,ref:z.setReference,...Z(),children:[S&&(0,n.jsx)(f.I,{name:"clock-nine",size:"sm",className:T.icon}),(0,n.jsx)(x.f,{value:E,timeZone:O,placeholder:j}),!B&&(0,n.jsxs)("span",{className:T.caretIcon,children:[(0,m.X)(E)&&C&&(0,n.jsx)(f.I,{className:T.clearIcon,name:"times",size:"lg",onClick:V}),(0,n.jsx)(f.I,{name:_?"angle-up":"angle-down",size:"lg"})]})]}),_&&(0,n.jsx)(i.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)("section",{className:T.content,ref:z.setFloating,style:w,...Y(),children:(0,n.jsx)(c.r,{timeZone:O,value:(0,m.X)(E)?E:(0,o.E2)(),onChange:N,quickOptions:v.o,onChangeTimeZone:D,className:T.content,hideTimeZone:M,isReversed:U,hideQuickRanges:W,weekStart:P})})})]})},d=(E,b=!1)=>{const D=(0,p.n)({theme:E,invalid:!1});return{container:(0,a.css)({display:"flex",position:"relative"}),content:(0,a.css)({marginLeft:0,position:"absolute",top:"116%",zIndex:E.zIndex.modal}),pickerInput:(0,a.cx)(D.input,b&&D.inputDisabled,D.wrapper,(0,a.css)({display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",paddingRight:0,lineHeight:`${E.spacing.gridSize*4-2}px`})),caretIcon:(0,a.cx)(D.suffix,(0,a.css)({position:"relative",top:"-1px",marginLeft:E.spacing(.5)})),clearIcon:(0,a.css)({marginRight:E.spacing(.5),"&:hover":{color:E.colors.text.maxContrast}}),placeholder:(0,a.css)({color:E.colors.text.disabled,opacity:1}),icon:(0,a.css)({marginRight:E.spacing(.5)})}}},91867:(te,R,e)=>{"use strict";e.d(R,{_8:()=>B,xS:()=>W,$6:()=>j});var n=e(74848),a=e(22803),s=e(18828),i=e(42211),r=e(93225),u=e(96540),o=e(62717),l=e(80011),g=e(17548),f=e(33239),p=e(51898),c=e(92745),x=e(63142),v=e(93256),m=e(35621),y=e(15245),h=e(7895),d=e(45967),E=e(4364),b=e(34788),D=e(8431),C=e(84596),P=e(72296);function M(T){const{onClick:L,isSynced:A}=T,N=()=>{const V=A?"Unsync all views":"Sync all views to this time range";return(0,n.jsx)(n.Fragment,{children:V})};return(0,n.jsx)(d.m,{content:N,placement:"bottom",children:(0,n.jsx)(h.I,{icon:"link",variant:A?"active":"canvas","aria-label":A?(0,c.t)("grafana-ui.time-sync-button.aria-label-unsync","Unsync times"):(0,c.t)("grafana-ui.time-sync-button.aria-label-sync","Sync times"),onClick:L})})}function O(T){const{value:L,onChangeProp:A,isSyncedProp:N,initialIsSynced:V,timeSyncButtonProp:z}=T,w=(0,P.X)(V&&L?L:void 0),H=w?.synced,Q=w?.syncedValue,Z=w?.sync,Y=!!(T.isSyncedProp===void 0&&w),X=(0,u.useCallback)(ne=>{A(ne),Y&&H&&Z?.(ne)},[A,Y,Z,H]),I=(0,C.A)(L),J=(0,C.A)(w?.syncedValue);(0,u.useEffect)(()=>{Y&&H&&(L!==I&&L!==Q?Z?.(L):Q&&Q!==J&&Q!==L&&A(Q))},[Y,H,Q,Z,J,L,I,A]);const ee=Y?w?.synced:N,q=Y?w?.syncPossible&&(0,n.jsx)(M,{isSynced:w?.synced,onClick:()=>w?.synced?w.unSync():w.sync(L)}):z;return{onChangeWithSync:X,isSynced:ee,timeSyncButton:q}}function j(T){const[L,A]=(0,u.useState)(!1),{value:N,onMoveBackward:V,onMoveForward:z,onZoom:w,onError:H,timeZone:Q,fiscalYearStartMonth:Z,history:Y,onChangeTimeZone:X,onChangeFiscalYearStartMonth:I,quickRanges:J,hideQuickRanges:ee,widthOverride:q,isOnCanvas:ne,onToolbarTimePickerClick:se,weekStart:oe,initialIsSynced:de}=T,{onChangeWithSync:fe,isSynced:ae,timeSyncButton:ce}=O({initialIsSynced:de,value:N,onChangeProp:T.onChange,isSyncedProp:T.isSynced,timeSyncButtonProp:T.timeSyncButton}),ie=Fe=>{fe(Fe),A(!1)};(0,u.useEffect)(()=>{L&&se&&se()},[L,se]);const ve=()=>{A(Fe=>!Fe)},le=()=>{A(!1)},Ee=(0,u.createRef)(),Re=(0,u.createRef)(),{overlayProps:Oe,underlayProps:Se}=(0,r.e)({onClose:le,isDismissable:!0,isOpen:L,shouldCloseOnInteractOutside:Fe=>{const Be=(0,y.gF)();return!Re.current?.contains(Fe)&&!Be.contains(Fe)}},Ee),{dialogProps:Te}=(0,s.s)({},Ee),_e=(0,x.of)(_),{modalBackdrop:He}=(0,x.of)(m.o),tt=ae?"active":ne?"canvas":"default",Ge=N?.to?.isBefore(N.from)?"exclamation-triangle":"clock-nine",je=S(N,Q,J);return(0,n.jsxs)(v.e,{className:_e.container,children:[(0,n.jsx)(h.I,{"aria-label":(0,c.t)("time-picker.range-picker.backwards-time-aria-label","Move time range backwards"),variant:tt,onClick:V,icon:"angle-left",type:"button",narrow:!0}),(0,n.jsx)(d.m,{ref:Re,content:(0,n.jsx)(W,{timeRange:N,timeZone:Q}),placement:"bottom",interactive:!0,children:(0,n.jsx)(h.I,{"data-testid":p.Tp.components.TimePicker.openButton,"aria-label":(0,c.t)("time-picker.range-picker.current-time-selected","Time range selected: {{currentTimeRange}}",{currentTimeRange:je}),"aria-controls":"TimePickerContent",onClick:ve,icon:Ge,isOpen:L,type:"button",variant:tt,children:(0,n.jsx)(B,{...T})})}),L&&(0,n.jsxs)("div",{"data-testid":p.Tp.components.TimePicker.overlayContent,children:[(0,n.jsx)("div",{role:"presentation",className:(0,a.cx)(He,_e.backdrop),...Se}),(0,n.jsx)(i.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)("section",{className:_e.content,ref:Ee,...Oe,...Te,children:(0,n.jsx)(E.r,{timeZone:Q,fiscalYearStartMonth:Z,value:N,onChange:ie,quickOptions:J||D.o,history:Y,showHistory:!0,widthOverride:q,onChangeTimeZone:X,onChangeFiscalYearStartMonth:I,hideQuickRanges:ee,onError:H,weekStart:oe})})})]}),ce,(0,n.jsx)(h.I,{"aria-label":(0,c.t)("time-picker.range-picker.forwards-time-aria-label","Move time range forwards"),onClick:z,icon:"angle-right",narrow:!0,type:"button",variant:tt}),(0,n.jsx)(d.m,{content:U,placement:"bottom",children:(0,n.jsx)(h.I,{"aria-label":(0,c.t)("time-picker.range-picker.zoom-out-button","Zoom out time range"),onClick:w,icon:"search-minus",type:"button",variant:tt})})]})}j.displayName="TimeRangePicker";const U=()=>(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(c.x6,{i18nKey:"time-picker.range-picker.zoom-out-tooltip",children:["Time range zoom out ",(0,n.jsx)("br",{})," CTRL+Z"]})}),W=({timeRange:T,timeZone:L})=>{const A=(0,x.of)(K),N=Date.now(),V=L?(0,o.QZ)(L,N):void 0;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"text-center",children:[(0,l.LE)(T.from,{timeZone:L}),(0,n.jsx)("div",{className:"text-center",children:(0,n.jsx)(c.x6,{i18nKey:"time-picker.range-picker.to",children:"to"})}),(0,l.LE)(T.to,{timeZone:L})]}),(0,n.jsxs)("div",{className:A.container,children:[(0,n.jsx)("span",{className:A.utc,children:(0,o.le)(L)}),(0,n.jsx)(b.E,{info:V})]})]})},B=(0,u.memo)(({hideText:T,value:L,timeZone:A,quickRanges:N})=>{const V=(0,x.of)(K);return T?null:(0,n.jsxs)("span",{className:V.container,"aria-live":"polite","aria-atomic":"true",children:[(0,n.jsx)("span",{children:S(L,A,N)}),(0,n.jsx)("span",{className:V.utc,children:g.describeTimeRangeAbbreviation(L,A)})]})});B.displayName="TimePickerButtonLabel";const S=(T,L,A)=>{const N={to:f.isMathString(T.raw.to)?T.raw.to:T.to,from:f.isMathString(T.raw.from)?T.raw.from:T.from};return g.describeTimeRange(N,L,A)},_=T=>({container:(0,a.css)({position:"relative",display:"flex",verticalAlign:"middle"}),backdrop:(0,a.css)({display:"none",[T.breakpoints.down("sm")]:{display:"block"}}),content:(0,a.css)({position:"absolute",right:0,top:"116%",zIndex:T.zIndex.dropdown,[T.breakpoints.down("sm")]:{position:"fixed",right:"50%",top:"50%",transform:"translate(50%, -50%)",zIndex:T.zIndex.modal}})}),K=T=>({container:(0,a.css)({display:"flex",alignItems:"center",whiteSpace:"nowrap",columnGap:T.spacing(.5)}),utc:(0,a.css)({color:T.v1.palette.orange,fontSize:T.typography.size.sm,paddingLeft:"6px",lineHeight:"28px",verticalAlign:"bottom",fontWeight:T.typography.fontWeightMedium})})},66630:(te,R,e)=>{"use strict";e.d(R,{h2:()=>y,nB:()=>c});var n=e(74848),a=e(22803),s=e(96540),i=e(93581),r=e(44922),u=e(92745),o=e(63142),l=e(30703),g=e(5857),f=e(41e3);const p={saturday:"islamic",sunday:"gregory",monday:"iso8601"};function c({onChange:h,from:d,to:E,timeZone:b,weekStart:D}){const C=x(d,E,new Date,b),P=v(h,b),M=(0,o.of)(y),O=(0,g.rL)(D);return(0,n.jsx)(i.Ay,{selectRange:!0,next2Label:null,prev2Label:null,className:M.body,tileClassName:M.title,value:C,nextLabel:(0,n.jsx)(l.I,{name:"angle-right"}),nextAriaLabel:(0,u.t)("time-picker.calendar.next-month","Next month"),prevLabel:(0,n.jsx)(l.I,{name:"angle-left"}),prevAriaLabel:(0,u.t)("time-picker.calendar.previous-month","Previous month"),onChange:P,locale:"en",calendarType:p[O]})}c.displayName="Body";function x(h,d,E=new Date,b){let D=h.isValid()?h.toDate():E,C=d.isValid()?d.toDate():E;return b&&(D=(0,f.Q)(D,b),C=(0,f.Q)(C,b)),D>C?[C,D]:[D,C]}function v(h,d){return(0,s.useCallback)(E=>{if(!Array.isArray(E))return console.error("onCalendarChange: should be run in selectRange={true}");if(E[0]&&E[1]){const b=(0,r.b)(m(E[0]),{timeZone:d}),D=(0,r.b)(m(E[1]),{timeZone:d});h(b,D)}},[h,d])}function m(h){return[h.getFullYear(),h.getMonth(),h.getDate(),h.getHours(),h.getMinutes(),h.getSeconds()]}const y=h=>{const d=".react-calendar__tile--hasActive:not(.react-calendar__tile--range)";return{title:(0,a.css)({color:h.colors.text.primary,backgroundColor:h.colors.background.primary,fontSize:h.typography.size.md,border:"1px solid transparent","&:hover, &:focus":{position:"relative"},"&:disabled":{color:h.colors.action.disabledText,cursor:"not-allowed"}}),body:(0,a.css)({zIndex:h.zIndex.modal,backgroundColor:h.colors.background.elevated,width:"268px",".react-calendar__navigation":{display:"flex"},".react-calendar__navigation__label, .react-calendar__navigation__arrow, .react-calendar__navigation":{paddingTop:"4px",backgroundColor:"inherit",color:h.colors.text.primary,border:0,fontWeight:h.typography.fontWeightMedium},".react-calendar__month-view__weekdays":{backgroundColor:"inherit",textAlign:"center",color:h.colors.primary.text,abbr:{border:0,textDecoration:"none",cursor:"default",display:"block",padding:"4px 0 4px 0"}},".react-calendar__month-view__days":{backgroundColor:"inherit"},".react-calendar__tile, .react-calendar__tile--now":{marginBottom:"4px",backgroundColor:"inherit",height:"26px"},".react-calendar__navigation__label, .react-calendar__navigation > button:focus, .time-picker-calendar-tile:focus":{outline:0},".react-calendar__tile--hover":{backgroundColor:h.colors.action.hover,borderRadius:0},".react-calendar__tile--hoverStart":{borderTopLeftRadius:h.shape.radius.pill,borderBottomLeftRadius:h.shape.radius.pill},".react-calendar__tile--hoverEnd":{borderTopRightRadius:h.shape.radius.pill,borderBottomRightRadius:h.shape.radius.pill},".react-calendar__tile:hover:not(.react-calendar__tile--hover):not(.react-calendar__tile--active):not(.react-calendar__tile--hasActive)":{backgroundColor:h.colors.action.hover,borderRadius:h.shape.radius.pill},[`${d}, .react-calendar__tile--rangeStart:not(.react-calendar__tile--hover)`]:{borderTopLeftRadius:h.shape.radius.pill,borderBottomLeftRadius:h.shape.radius.pill},[`${d}, .react-calendar__tile--rangeEnd:not(.react-calendar__tile--hover)`]:{borderTopRightRadius:h.shape.radius.pill,borderBottomRightRadius:h.shape.radius.pill},[`${d}, .react-calendar__tile--active, .react-calendar__tile--rangeEnd, .react-calendar__tile--rangeStart`]:{color:h.colors.primary.contrastText,fontWeight:h.typography.fontWeightMedium,background:h.colors.primary.main,border:"0px"}})}}},4364:(te,R,e)=>{"use strict";e.d(R,{r:()=>Re});var n=e(74848),a=e(22803),s=e(96540),i=e(25229),r=e(17548),u=e(51898),o=e(92745),l=e(63142),g=e(35484),f=e(12737),p=e(30703),c=e(2543),x=e(62717),v=e(45861),m=e(43243),y=e(37386),h=e(60208),d=e(13941),E=e(54314),b=e(59310),D=e(34788),C=e(44229),P=e(27228),M=e(8431);const O=Fe=>{const{timeZone:Be,fiscalYearStartMonth:Ke,timestamp:Ue=Date.now(),onChangeTimeZone:we,onChangeFiscalYearStartMonth:Xe}=Fe,[nt,he]=(0,s.useState)(!1),[xe,me]=(0,s.useState)("tz"),ye=(0,s.useId)(),De=(0,s.useId)(),Le=(0,s.useId)(),Ve=(0,s.useCallback)(Me=>{Me&&Me.stopPropagation(),he(!nt)},[nt,he]),ze=(0,l.of)(j);if(!(0,c.isString)(Be))return null;const Ze=(0,x.QZ)(Be,Ue);return Ze?(0,n.jsxs)("div",{children:[(0,n.jsxs)("section",{"aria-label":(0,o.t)("time-picker.footer.time-zone-selection","Time zone selection"),className:ze.container,children:[(0,n.jsxs)("div",{className:ze.timeZoneContainer,children:[(0,n.jsxs)("div",{className:ze.timeZone,children:[(0,n.jsx)(P.U,{title:Ze.name}),(0,n.jsx)("div",{className:ze.spacer}),(0,n.jsx)(D.E,{info:Ze})]}),(0,n.jsx)(C.X,{timeZone:Be,timestamp:Ue})]}),(0,n.jsx)("div",{className:ze.spacer}),(0,n.jsx)(v.$n,{"data-testid":u.Tp.components.TimeZonePicker.changeTimeSettingsButton,variant:"secondary",onClick:Ve,size:"sm","aria-expanded":nt,"aria-controls":ye,icon:nt?"angle-up":"angle-down",children:(0,n.jsx)(o.x6,{i18nKey:"time-picker.footer.change-settings-button",children:"Change time settings"})})]}),nt?(0,n.jsxs)("div",{className:ze.editContainer,id:ye,children:[(0,n.jsxs)(E.U,{children:[(0,n.jsx)(h.o,{label:(0,o.t)("time-picker.footer.time-zone-option","Time zone"),active:xe==="tz",onChangeTab:()=>{me("tz")},"aria-controls":De}),(0,n.jsx)(h.o,{label:(0,o.t)("time-picker.footer.fiscal-year-option","Fiscal year"),active:xe==="fy",onChangeTab:()=>{me("fy")},"aria-controls":Le})]}),(0,n.jsx)(d.J,{className:ze.noBackground,children:xe==="tz"?(0,n.jsx)("section",{role:"tabpanel","data-testid":u.Tp.components.TimeZonePicker.containerV2,id:De,className:(0,a.cx)(ze.timeZoneContainer,ze.timeSettingContainer),children:(0,n.jsx)(b.U,{includeInternal:!0,onChange:Me=>{Ve(),(0,c.isString)(Me)&&we(Me)},onBlur:Ve,menuShouldPortal:!1})}):(0,n.jsx)("section",{role:"tabpanel","data-testid":u.Tp.components.TimeZonePicker.containerV2,id:Le,className:(0,a.cx)(ze.timeZoneContainer,ze.timeSettingContainer),children:(0,n.jsx)(y.D,{className:ze.fiscalYearField,label:(0,o.t)("time-picker.footer.fiscal-year-start","Fiscal year start month"),children:(0,n.jsx)(m.G,{value:Ke??null,options:M.Z,onChange:Me=>{Xe&&Xe(Me?.value??0)}})})})})]}):null]}):null},j=Fe=>({container:(0,a.css)({borderTop:`1px solid ${Fe.colors.border.weak}`,padding:Fe.spacing(1.5),display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}),editContainer:(0,a.css)({borderTop:`1px solid ${Fe.colors.border.weak}`,padding:Fe.spacing(1.5),paddingTop:0,justifyContent:"space-between",alignItems:"center"}),spacer:(0,a.css)({marginLeft:"7px"}),timeSettingContainer:(0,a.css)({paddingTop:Fe.spacing(1)}),noBackground:(0,a.css)({background:"inherit"}),fiscalYearField:(0,a.css)({marginBottom:0}),timeZoneContainer:(0,a.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",flexGrow:1}),timeZone:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"baseline",flexGrow:1})});var U=e(47087),W=e(44922),B=e(80011),S=e(63527),_=e(45967),K=e(62348),T=e(18828),L=e(42211),A=e(93225),N=e(51182),V=e(35621),z=e(66630),w=e(41654);function H({onClose:Fe,onApply:Be}){return(0,n.jsxs)(w.B,{gap:2,justifyContent:"space-between",children:[(0,n.jsx)(v.$n,{variant:"secondary",onClick:Fe,children:(0,n.jsx)(o.x6,{i18nKey:"time-picker.calendar.cancel-button",children:"Cancel"})}),(0,n.jsx)(v.$n,{onClick:Be,children:(0,n.jsx)(o.x6,{i18nKey:"time-picker.calendar.apply-button",children:"Apply time range"})})]})}H.displayName="Footer";var Q=e(76319);function Z({onClose:Fe}){return(0,n.jsxs)(w.B,{justifyContent:"space-between",children:[(0,n.jsx)(U.e,{children:(0,n.jsx)(o.x6,{i18nKey:"time-picker.calendar.select-time",children:"Select a time range"})}),(0,n.jsx)(Q.K,{"data-testid":u.Tp.components.TimePicker.calendar.closeButton,tooltip:(0,o.t)("time-picker.calendar.close","Close calendar"),name:"times",variant:"secondary",onClick:Fe})]})}Z.displayName="Header";const Y=(Fe,Be=!1)=>({container:(0,a.css)({top:0,position:"absolute",[`${Be?"left":"right"}`]:"546px"}),modalContainer:(0,a.css)({label:"modalContainer",margin:"0 auto"}),calendar:(0,a.css)({display:"flex",flexDirection:"column",gap:Fe.spacing(1),padding:Fe.spacing(1),label:"calendar",boxShadow:Fe.shadows.z3,backgroundColor:Fe.colors.background.elevated,border:`1px solid ${Fe.colors.border.weak}`,borderRadius:Fe.shape.radius.default}),modal:(0,a.css)({label:"modal",boxShadow:Fe.shadows.z3,left:"50%",position:"fixed",top:"50%",transform:"translate(-50%, -50%)",zIndex:Fe.zIndex.modal})});function X(Fe){const Be=(0,l.$j)(),{modalBackdrop:Ke}=(0,l.of)(V.o),Ue=Y(Be,Fe.isReversed),{isOpen:we,isFullscreen:Xe,onClose:nt}=Fe,he=(0,s.createRef)(),{dialogProps:xe}=(0,T.s)({"aria-label":u.Tp.components.TimePicker.calendar.label},he),{overlayProps:me}=(0,A.e)({isDismissable:!0,isOpen:we,onClose:nt},he),ye=!Xe;if(!we)return null;const De=(0,n.jsxs)("section",{className:Ue.calendar,ref:he,...me,...xe,"data-testid":u.Tp.components.TimePicker.calendar.label,children:[(0,n.jsx)(Z,{...Fe}),(0,n.jsx)(z.nB,{...Fe}),ye&&(0,n.jsx)(H,{...Fe})]});return ye?(0,n.jsxs)(N.Sf,{children:[(0,n.jsx)("div",{className:Ke}),(0,n.jsx)(L.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)("div",{className:Ue.modal,children:(0,n.jsx)("div",{className:Ue.modalContainer,children:De})})})]}):(0,n.jsx)(L.n1,{contain:!0,restoreFocus:!0,autoFocus:!0,children:(0,n.jsx)("div",{className:Ue.container,children:De})})}const I=(0,s.memo)(X);X.displayName="TimePickerCalendar";const J={default:()=>(0,o.t)("time-picker.range-content.default-error",'Please enter a past date or "{{now}}"',{now:"now"}),range:()=>(0,o.t)("time-picker.range-content.range-error",`"From" can't be after "To"`)},ee=Fe=>{const{value:Be,isFullscreen:Ke=!1,timeZone:Ue,onApply:we,isReversed:Xe,fiscalYearStartMonth:nt,onError:he,weekStart:xe}=Fe,[me,ye]=ne(Be.raw.from,Be.raw.to,Ue),De=(0,l.of)(oe),[Le,Ve]=(0,s.useState)(me),[ze,Ze]=(0,s.useState)(ye),[Me,$e]=(0,s.useState)(!1),at=(0,s.useId)(),ct=(0,s.useId)();(0,s.useEffect)(()=>{const[Xt,En]=ne(Be.raw.from,Be.raw.to,Ue);Ve(Xt),Ze(En)},[Be.raw.from,Be.raw.to,Ue]);const ft=(0,s.useCallback)(Xt=>{Xt.preventDefault(),$e(!0)},[$e]),Et=(0,s.useCallback)(()=>{if(ze.invalid||Le.invalid)return;const Xt={from:Le.value,to:ze.value},En=r.convertRawToRange(Xt,Ue,nt);we(En)},[Le.invalid,Le.value,we,Ue,ze.invalid,ze.value,nt]),St=(0,s.useCallback)((Xt,En)=>{const[ln,cn]=ne(Xt,En,Ue);Ve(ln),Ze(cn)},[Ue]),Pt=Xt=>{Xt.key==="Enter"&&Et()},Dt=()=>{const Xt={from:Le.value,to:ze.value};navigator.clipboard.writeText(JSON.stringify(Xt))},Ye=async()=>{const Xt=await navigator.clipboard.readText();let En;try{En=JSON.parse(Xt)}catch{he&&he(Xt);return}const[ln,cn]=ne(En.from,En.to,Ue);Ve(ln),Ze(cn)},mt=r.convertRawToRange({from:"now/fy",to:"now/fy"},Ue,nt),zt=(0,n.jsx)("div",{className:De.tooltip,children:r.isFiscal(Be)?(0,n.jsx)(_.m,{content:(0,o.t)("time-picker.range-content.fiscal-year","Fiscal year: {{from}} - {{to}}",{from:mt.from.format("MMM-DD"),to:mt.to.format("MMM-DD")}),children:(0,n.jsx)(p.I,{name:"info-circle"})}):null}),Jt=(0,n.jsx)(v.$n,{"aria-label":(0,o.t)("time-picker.range-content.open-input-calendar","Open calendar"),"data-testid":u.Tp.components.TimePicker.calendar.openButton,icon:"calendar-alt",variant:"secondary",type:"button",onClick:ft});return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:De.fieldContainer,children:[(0,n.jsx)(y.D,{label:(0,o.t)("time-picker.range-content.from-input","From"),invalid:Le.invalid,error:Le.errorMessage,children:(0,n.jsx)(S.p,{id:at,onClick:Xt=>Xt.stopPropagation(),onChange:Xt=>St(Xt.currentTarget.value,ze.value),addonAfter:Jt,onKeyDown:Pt,"data-testid":u.Tp.components.TimePicker.fromField,value:Le.value})}),zt]}),(0,n.jsxs)("div",{className:De.fieldContainer,children:[(0,n.jsx)(y.D,{label:(0,o.t)("time-picker.range-content.to-input","To"),invalid:ze.invalid,error:ze.errorMessage,children:(0,n.jsx)(S.p,{id:ct,onClick:Xt=>Xt.stopPropagation(),onChange:Xt=>St(Le.value,Xt.currentTarget.value),addonAfter:Jt,onKeyDown:Pt,"data-testid":u.Tp.components.TimePicker.toField,value:ze.value})}),zt]}),(0,n.jsxs)("div",{className:De.buttonsContainer,children:[(0,n.jsx)(v.$n,{"data-testid":u.Tp.components.TimePicker.copyTimeRange,icon:"copy",variant:"secondary",tooltip:(0,o.t)("time-picker.copy-paste.tooltip-copy","Copy time range to clipboard"),type:"button",onClick:Dt}),(0,n.jsx)(v.$n,{"data-testid":u.Tp.components.TimePicker.pasteTimeRange,icon:"clipboard-alt",variant:"secondary",tooltip:(0,o.t)("time-picker.copy-paste.tooltip-paste","Paste time range"),type:"button",onClick:Ye}),(0,n.jsx)(v.$n,{"data-testid":u.Tp.components.TimePicker.applyTimeRange,type:"button",onClick:Et,children:(0,n.jsx)(o.x6,{i18nKey:"time-picker.range-content.apply-button",children:"Apply time range"})})]}),(0,n.jsx)(I,{isFullscreen:Ke,isOpen:Me,from:(0,W.b)(Le.value,{timeZone:Ue}),to:(0,W.b)(ze.value,{timeZone:Ue}),onApply:Et,onClose:()=>$e(!1),onChange:St,timeZone:Ue,isReversed:Xe,weekStart:xe})]})};function q(Fe,Be,Ke){const Ue={from:Fe,to:Be},we=r.convertRawToRange(Ue,Ke);return!(we.from.isSame(we.to)||we.from.isBefore(we.to))}function ne(Fe,Be,Ke){const Ue=se(Fe,Ke),we=se(Be,Ke),Xe=!(0,K.f)(Ue,!1,Ke),nt=!(0,K.f)(we,!0,Ke),he=q(Ue,we,Ke)&&!nt;return[{value:Ue,invalid:Xe||he,errorMessage:he&&!Xe?J.range():J.default()},{value:we,invalid:nt,errorMessage:J.default()}]}function se(Fe,Be){if((0,i.Ar)(Fe))return(0,B.LE)(Fe,{timeZone:Be});if(Fe.endsWith("Z")){const Ke=(0,W.b)(Fe);return(0,B.LE)(Ke,{timeZone:Be})}return Fe}function oe(Fe){return{fieldContainer:(0,a.css)({display:"flex"}),buttonsContainer:(0,a.css)({display:"flex",gap:Fe.spacing(.5),marginTop:Fe.spacing(1)}),tooltip:(0,a.css)({paddingLeft:Fe.spacing(1),paddingTop:Fe.spacing(3)})}}var de=e(44398),fe=e(29686),ae=e(27629);const ce=(Fe,Be)=>r.convertRawToRange({from:Fe.from,to:Fe.to},Be),ie={dateStyle:"short",timeStyle:"short"},ve={dateStyle:"short",timeStyle:"medium"},le=(Fe,Be)=>{const Ke=(0,B.LE)(Fe.from,{timeZone:Be}),Ue=(0,B.LE)(Fe.to,{timeZone:Be});let we=`${Ke} to ${Ue}`;if((0,ae.$)("localeFormatPreference")){const Xe=Fe.from.toDate(),nt=Fe.to.toDate(),he=Xe.getSeconds()!==0||nt.getSeconds()!==0;we=(0,fe.tX)(Xe,nt,he?ve:ie)}return{from:Ke,to:Ue,display:we}},Ee=Fe=>{const{quickOptions:Be=[],isReversed:Ke,isFullscreen:Ue,hideQuickRanges:we,timeZone:Xe,fiscalYearStartMonth:nt,value:he,onChange:xe,history:me,showHistory:ye,className:De,hideTimeZone:Le,onChangeTimeZone:Ve,onChangeFiscalYearStartMonth:ze}=Fe,Ze=!me?.length,Me=Ue&&ye||!Ue&&(ye&&!Ze||!we),$e=(0,l.of)(tt,Ke,we,Me,Ue),at=_e(me,Xe),ct=He(he.raw,Be),[ft,Et]=(0,s.useState)(""),St=Be.filter(Dt=>Dt.display.toLowerCase().includes(ft.toLowerCase())),Pt=Dt=>xe(ce(Dt));return(0,n.jsxs)("div",{id:"TimePickerContent",className:(0,a.cx)($e.container,De),children:[(0,n.jsxs)("div",{className:$e.body,children:[(!Ue||!we)&&(0,n.jsxs)("div",{className:$e.rightSide,children:[(0,n.jsx)("div",{className:$e.timeRangeFilter,children:(0,n.jsx)(f.Z,{width:0,value:ft,onChange:Et,placeholder:(0,o.t)("time-picker.content.filter-placeholder","Search quick ranges")})}),(0,n.jsxs)("div",{className:$e.scrollContent,children:[!Ue&&(0,n.jsx)(Oe,{...Fe,historyOptions:at}),!we&&(0,n.jsx)(de.l,{options:St,onChange:Pt,value:ct})]})]}),Ue&&(0,n.jsx)("div",{className:$e.leftSide,children:(0,n.jsx)(Se,{...Fe,historyOptions:at})})]}),!Le&&Ue&&(0,n.jsx)(O,{timeZone:Xe,fiscalYearStartMonth:nt,onChangeTimeZone:Ve,onChangeFiscalYearStartMonth:ze})]})},Re=Fe=>{const{widthOverride:Be}=Fe,Ke=(0,l.$j)(),Ue=(Be||window.innerWidth)>=Ke.breakpoints.values.lg;return(0,n.jsx)(Ee,{...Fe,isFullscreen:Ue})},Oe=Fe=>{const{value:Be,hideQuickRanges:Ke,onChange:Ue,timeZone:we,historyOptions:Xe=[],showHistory:nt,onError:he,weekStart:xe}=Fe,me=(0,l.of)(Je),ye=(0,i.Ar)(Be.raw.from)||(0,i.Ar)(Be.raw.to),[De,Le]=(0,s.useState)(!ye),Ve=Ke?!1:De,ze=Ze=>Ue(ce(Ze,we));return(0,n.jsxs)("fieldset",{children:[(0,n.jsx)("div",{className:me.header,children:(0,n.jsxs)("button",{type:"button",className:me.expandButton,onClick:()=>{Ke||Le(!Ve)},"data-testid":u.Tp.components.TimePicker.absoluteTimeRangeTitle,"aria-expanded":!Ve,"aria-controls":"expanded-timerange",children:[(0,n.jsx)(U.e,{children:(0,n.jsx)(o.x6,{i18nKey:"time-picker.absolute.title",children:"Absolute time range"})}),!Ke&&(0,n.jsx)(p.I,{name:Ve?"angle-down":"angle-up"})]})}),!Ve&&(0,n.jsxs)("div",{className:me.body,id:"expanded-timerange",children:[(0,n.jsx)("div",{className:me.form,children:(0,n.jsx)(ee,{value:Be,onApply:Ue,timeZone:we,isFullscreen:!1,onError:he,weekStart:xe})}),nt&&(0,n.jsx)(de.l,{title:(0,o.t)("time-picker.absolute.recent-title","Recently used absolute ranges"),options:Xe,onChange:ze,placeholderEmpty:null})]})]})},Se=Fe=>{const{onChange:Be,value:Ke,timeZone:Ue,fiscalYearStartMonth:we,isReversed:Xe,historyOptions:nt,onError:he,weekStart:xe}=Fe,me=(0,l.of)(Ge,Fe.hideQuickRanges),ye=De=>Be(ce(De,Ue));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:me.container,children:[(0,n.jsx)("div",{className:me.title,"data-testid":u.Tp.components.TimePicker.absoluteTimeRangeTitle,children:(0,n.jsx)(U.e,{children:(0,n.jsx)(o.x6,{i18nKey:"time-picker.absolute.title",children:"Absolute time range"})})}),(0,n.jsx)(ee,{value:Ke,timeZone:Ue,fiscalYearStartMonth:we,onApply:Be,isFullscreen:!0,isReversed:Xe,onError:he,weekStart:xe})]}),Fe.showHistory&&(0,n.jsx)("div",{className:me.recent,children:(0,n.jsx)(de.l,{title:(0,o.t)("time-picker.absolute.recent-title","Recently used absolute ranges"),options:nt||[],onChange:ye,placeholderEmpty:(0,n.jsx)(Te,{})})})]})},Te=(0,s.memo)(()=>{const Fe=(0,l.of)(je),Be=(0,o.t)("time-picker.content.empty-recent-list-info","It looks like you haven't used this time picker before. As soon as you enter some time intervals, recently used intervals will appear here.");return(0,n.jsxs)("div",{className:Fe.container,children:[(0,n.jsx)("div",{children:(0,n.jsx)("span",{children:Be})}),(0,n.jsx)(o.x6,{i18nKey:"time-picker.content.empty-recent-list-docs",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("a",{className:Fe.link,href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls",target:"_new",children:"Read the documentation"}),(0,n.jsx)("span",{children:" to find out more about how to enter custom time ranges."})]})})]})});function _e(Fe,Be){return!Array.isArray(Fe)||Fe.length===0?[]:Fe.map(Ke=>le(Ke,Be))}Te.displayName="EmptyRecentList";const He=(Fe,Be)=>(0,s.useMemo)(()=>{if(r.isRelativeTimeRange(Fe))return Be.find(Ke=>Ke.from===Fe.from&&Ke.to===Fe.to)},[Fe,Be]),tt=(Fe,Be,Ke,Ue,we)=>({container:(0,a.css)({background:Fe.colors.background.elevated,boxShadow:Fe.shadows.z3,width:`${we?"546px":"262px"}`,borderRadius:Fe.shape.radius.default,border:`1px solid ${Fe.colors.border.weak}`,[`${Be?"left":"right"}`]:0,display:"flex",flexDirection:"column"}),body:(0,a.css)({display:"flex",flexDirection:"row-reverse",height:`${Ue?"381px":"217px"}`,maxHeight:"100vh"}),leftSide:(0,a.css)({display:"flex",flexDirection:"column",borderRight:`${Be?"none":`1px solid ${Fe.colors.border.weak}`}`,width:`${Ke?"100%":"60%"}`,overflow:"auto",scrollbarWidth:"thin",order:Be?1:0}),rightSide:(0,a.css)({width:`${we?"40%":"100%"}; !important`,borderRight:Be?`1px solid ${Fe.colors.border.weak}`:"none",display:"flex",flexDirection:"column"}),timeRangeFilter:(0,a.css)({padding:Fe.spacing(1)}),spacing:(0,a.css)({marginTop:"16px"}),scrollContent:(0,a.css)({overflowY:"auto",scrollbarWidth:"thin"})}),Je=Fe=>({header:(0,a.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderBottom:`1px solid ${Fe.colors.border.weak}`,padding:"7px 9px 7px 9px"}),expandButton:(0,a.css)({backgroundColor:"transparent",border:"none",display:"flex",width:"100%","&:focus-visible":(0,g.getFocusStyles)(Fe)}),body:(0,a.css)({borderBottom:`1px solid ${Fe.colors.border.weak}`}),form:(0,a.css)({padding:"7px 9px 7px 9px"})}),Ge=(Fe,Be)=>({container:(0,a.css)({paddingTop:"9px",paddingLeft:"11px",paddingRight:Be?"11px":"20%"}),title:(0,a.css)({marginBottom:"11px"}),recent:(0,a.css)({flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"flex-end",paddingTop:Fe.spacing(1)})}),je=Fe=>({container:(0,a.css)({padding:"12px",margin:"12px","a, span":{fontSize:"13px"}}),link:(0,a.css)({color:Fe.colors.text.link})})},47087:(te,R,e)=>{"use strict";e.d(R,{e:()=>u});var n=e(74848),a=e(22803),s=e(96540),i=e(63142);const r=o=>({text:(0,a.css)({fontSize:o.typography.size.md,fontWeight:o.typography.fontWeightMedium,color:o.colors.text.primary,margin:0,display:"flex"})}),u=(0,s.memo)(({children:o})=>{const l=(0,i.of)(r);return(0,n.jsx)("h3",{className:l.text,children:o})});u.displayName="TimePickerTitle"},83692:(te,R,e)=>{"use strict";e.d(R,{f:()=>o});var n=e(74848),a=e(22803),s=e(96540),i=e(63142),r=e(91867),u=e(62348);const o=(0,s.memo)(function({hideText:f,value:p,timeZone:c="browser",placeholder:x="No time range selected",className:v}){const m=(0,i.of)(l);return f?null:(0,n.jsx)("span",{className:v,children:(0,u.X)(p)?(0,n.jsx)(r._8,{value:p,timeZone:c}):(0,n.jsx)("span",{className:m.placeholder,children:x})})}),l=g=>({placeholder:(0,a.css)({color:g.colors.text.disabled,opacity:1})})},44398:(te,R,e)=>{"use strict";e.d(R,{l:()=>v});var n=e(74848),a=e(22803),s=e(96540),i=e(92745),r=e(63142),u=e(47087),o=e(24726),l=e(35484);const g=b=>({container:(0,a.css)({display:"flex",alignItems:"center",flexDirection:"row-reverse",justifyContent:"space-between",position:"relative"}),radio:(0,a.css)({opacity:0,width:"0 !important","&:focus-visible + label":(0,l.getFocusStyles)(b)}),label:(0,a.css)({cursor:"pointer",flex:1,padding:b.spacing(1),borderRadius:b.shape.radius.default,"&:hover":{background:b.colors.action.hover,cursor:"pointer"}}),labelSelected:(0,a.css)({background:b.colors.action.selected,"&::before":{backgroundImage:b.colors.gradients.brandVertical,borderRadius:b.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",width:b.spacing(.5),left:0,top:0}})}),f=(0,s.memo)(({value:b,onSelect:D,selected:C=!1,name:P})=>{const M=(0,r.of)(g),O=(0,o.A)();return(0,n.jsxs)("li",{className:M.container,children:[(0,n.jsx)("input",{className:M.radio,checked:C,name:P,type:"checkbox","data-role":"item",tabIndex:-1,id:O,onChange:()=>D(b)}),(0,n.jsx)("label",{className:(0,a.cx)(M.label,C&&M.labelSelected),htmlFor:O,children:b.display})]})});f.displayName="TimeRangeOption";const p=(b,D)=>(b%D+D)%D,c=["ArrowUp","ArrowDown","Home","End","Enter","Tab"],x=({localRef:b,options:D})=>{const[C,P]=(0,s.useState)(0);return(0,s.useEffect)(()=>{const O=b.current?.querySelectorAll('[data-role="item"]')||[],j=Array.from(O).findIndex(W=>W.checked),U=j>=0?j:0;O.forEach((W,B)=>{W.tabIndex=B===U?0:-1}),P(U)},[b,D]),[O=>{const j=b?.current?.querySelectorAll('[data-role="item"]'),U=j?.length??0;c.indexOf(O.key)>-1&&(O.preventDefault(),O.key!=="Tab"&&O.stopPropagation());let W=null;switch(O.key){case"ArrowUp":W=p(C-1,U);break;case"ArrowDown":W=p(C+1,U);break;case"Home":W=0;break;case"End":W=U-1;break;case"Enter":j?.[C]?.click();break;default:break}W!==null&&(P(W),j?.[W]?.focus(),j?.forEach((B,S)=>{B.tabIndex=S===W?0:-1}))}]},v=b=>{const D=(0,r.of)(d),{title:C,options:P,placeholderEmpty:M}=b;return typeof M<"u"&&P.length<=0?(0,n.jsx)(n.Fragment,{children:M}):C?(0,n.jsx)("section",{"aria-label":C,children:(0,n.jsxs)("fieldset",{children:[(0,n.jsx)("div",{className:D.title,children:(0,n.jsx)(u.e,{children:C})}),(0,n.jsx)(m,{...b})]})}):(0,n.jsx)(m,{...b})},m=({options:b,value:D,onChange:C,title:P})=>{const M=(0,r.of)(E),O=(0,s.useRef)(null),[j]=x({localRef:O,options:b});return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("ul",{role:"presentation",onKeyDown:j,ref:O,"aria-roledescription":(0,i.t)("time-picker.time-range.aria-role","Time range selection"),className:M.list,children:b.map((U,W)=>(0,n.jsx)(f,{value:U,selected:h(U,D),onSelect:C,name:P??(0,i.t)("time-picker.time-range.default-title","Time ranges")},y(U,W)))})})};function y(b,D){return`${b.from}-${b.to}-${D}`}function h(b,D){return!D||!b?!1:D.from===b.from&&D.to===b.to}const d=()=>({title:(0,a.css)({display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 16px 5px 9px"})}),E=b=>({list:(0,a.css)({padding:b.spacing(.5)})})},59310:(te,R,e)=>{"use strict";e.d(R,{U:()=>b});var n=e(74848),a=e(2543),s=e(96540),i=e(62717),r=e(92745),u=e(18857),o=e(22803),l=e(63142);const g=j=>{const{children:U,label:W}=j,B=(0,l.of)(f);return W?(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:B.header,children:(0,n.jsx)("span",{className:B.label,children:W})}),U]}):(0,n.jsx)("div",{children:U})},f=j=>({header:(0,o.css)({padding:"7px 10px",width:"100%",borderTop:`1px solid ${j.colors.border.weak}`,textTransform:"capitalize"}),label:(0,o.css)({fontSize:j.typography.size.sm,color:j.colors.text.secondary,fontWeight:j.typography.fontWeightMedium})});var p=e(44229),c=e(51898),x=e(30703),v=e(34788),m=e(27228);const y="tz-utc-offset",h=j=>{const{children:U,innerProps:W,innerRef:B,data:S,isSelected:_,isFocused:K}=j,T=(0,l.of)(E),L=Date.now(),A=(0,o.cx)(T.container,K&&T.containerFocused);if(!(0,a.isString)(S.value))return null;const N=(0,i.QZ)(S.value,L);return(0,n.jsx)("div",{className:A,...W,ref:B,"data-testid":c.Tp.components.Select.option,children:(0,n.jsxs)("div",{className:(0,o.cx)(T.leftColumn,T.row),children:[(0,n.jsxs)("div",{className:(0,o.cx)(T.leftColumn,T.wideRow),children:[(0,n.jsx)(m.U,{title:U}),(0,n.jsx)("div",{className:T.spacer}),(0,n.jsx)(v.E,{info:N})]}),(0,n.jsxs)("div",{className:T.rightColumn,children:[(0,n.jsx)(p.X,{timeZone:N?.ianaName||S.value,timestamp:L,className:y}),_&&(0,n.jsx)("span",{children:(0,n.jsx)(x.I,{name:"check"})})]})]})})},d=j=>{const{children:U,innerProps:W,innerRef:B,data:S,isSelected:_,isFocused:K}=j,T=(0,l.of)(E),L=Date.now(),A=(0,o.cx)(T.container,K&&T.containerFocused);if(!(0,a.isString)(S.value))return null;const N=(0,i.QZ)(S.value,L);return(0,n.jsx)("div",{className:A,...W,ref:B,"data-testid":c.Tp.components.Select.option,children:(0,n.jsxs)("div",{className:T.body,children:[(0,n.jsxs)("div",{className:T.row,children:[(0,n.jsx)("div",{className:T.leftColumn,children:(0,n.jsx)(m.U,{title:U})}),(0,n.jsx)("div",{className:T.rightColumn,children:_&&(0,n.jsx)("span",{children:(0,n.jsx)(x.I,{name:"check"})})})]}),(0,n.jsxs)("div",{className:T.row,children:[(0,n.jsx)("div",{className:T.leftColumn,children:(0,n.jsx)(v.E,{info:N})}),(0,n.jsx)("div",{className:T.rightColumn,children:(0,n.jsx)(p.X,{timestamp:L,timeZone:N?.ianaName||S.value,className:y})})]})]})})},E=j=>({container:(0,o.css)({display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",cursor:"pointer",padding:"6px 8px 4px","&:hover":{background:j.colors.action.hover}}),containerFocused:(0,o.css)({background:j.colors.action.hover}),body:(0,o.css)({display:"flex",fontWeight:j.typography.fontWeightMedium,flexDirection:"column",flexGrow:1}),row:(0,o.css)({display:"flex",flexDirection:"row"}),leftColumn:(0,o.css)({flexGrow:1,textOverflow:"ellipsis"}),rightColumn:(0,o.css)({justifyContent:"flex-end",alignItems:"center"}),wideRow:(0,o.css)({display:"flex",flexDirection:"row",alignItems:"baseline"}),spacer:(0,o.css)({marginLeft:"6px"})}),b=j=>{const{onChange:U,width:W,autoFocus:B=!1,onBlur:S,value:_,includeInternal:K=!1,disabled:T=!1,inputId:L,menuShouldPortal:A=!0,openMenuOnFocus:N=!0}=j,V=D(K),z=C(V,_),w=M(),H=W&&W<=45?d:h,Q=(0,s.useCallback)(Z=>{if(!Z||!(0,a.isString)(Z.value))return U(_);U(Z.value)},[U,_]);return(0,n.jsx)(u.l6,{inputId:L,value:z,placeholder:(0,r.t)("time-picker.zone.select-search-input","Type to search (country, city, abbreviation)"),autoFocus:B,menuShouldPortal:A,openMenuOnFocus:N,width:W,filterOption:w,options:V,onChange:Q,onBlur:S,components:{Option:H,Group:g},disabled:T,"aria-label":(0,r.t)("time-picker.zone.select-aria-label","Time zone picker")})},D=j=>{const U=Date.now();return(0,s.useMemo)(()=>(0,i.U3)(j).map(B=>{const S=B.zones.reduce((_,K)=>{const T=(0,i.QZ)(K,U);if(!T)return _;const L=T.name.replace(/_/g," ");return _.push({label:L,value:T.zone,searchIndex:O(L,T,U)}),_},[]);return{label:B.name,options:S}}),[j,U])},C=(j,U)=>(0,s.useMemo)(()=>{if(U===void 0)return;const W=(0,a.toLower)(U);return j.find(S=>S.label?W.startsWith((0,a.toLower)(S.label)):P(W))?.options.find(S=>(0,a.isEmpty)(W)?S.value===i.g$.default:(0,a.toLower)(S.value)===W)},[j,U]),P=j=>{switch(j){case i.g$.default:case i.g$.localBrowserTime:case i.g$.utc:return!0;default:return!1}},M=()=>(0,s.useCallback)((j,U)=>!U||!j.data||!j.data.searchIndex?!0:j.data.searchIndex.indexOf((0,a.toLower)(U))>-1,[]),O=(j,U,W)=>{const B=[(0,a.toLower)(U.zone),(0,a.toLower)(U.abbreviation),(0,a.toLower)((0,p.t)(W,U.zone))];j!==U.zone&&B.push((0,a.toLower)(j));for(const S of U.countries)B.push((0,a.toLower)(S.name)),B.push((0,a.toLower)(S.code));return B.join("|")}},34788:(te,R,e)=>{"use strict";e.d(R,{E:()=>r});var n=e(74848),a=e(22803),s=e(96540),i=e(63142);const r=({info:l})=>{const g=(0,i.of)(o),f=u(l);return l?(0,n.jsx)("div",{className:g.description,children:f}):null},u=l=>(0,s.useMemo)(()=>{const g=[];if(!l)return"";if(l.name==="Europe/Simferopol")return"Ukraine, EEST";if(l.countries.length>0){const f=l.countries[0];g.push(f.name)}return l.abbreviation&&g.push(l.abbreviation),g.join(", ")},[l]),o=l=>({description:(0,a.css)({fontWeight:"normal",fontSize:l.typography.size.sm,color:l.colors.text.secondary,whiteSpace:"normal",textOverflow:"ellipsis"})})},44229:(te,R,e)=>{"use strict";e.d(R,{X:()=>o,t:()=>l});var n=e(74848),a=e(22803),s=e(2543),i=e.n(s),r=e(80011),u=e(63142);const o=f=>{const{timestamp:p,timeZone:c,className:x}=f,v=(0,u.of)(g);return(0,s.isString)(c)?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("span",{className:(0,a.cx)(v.offset,x),children:l(p,c)})}):null},l=(f,p)=>`UTC${(0,r.LE)(f,{timeZone:p,format:"Z"})}`,g=f=>{const p=(0,a.css)({fontWeight:"normal",fontSize:f.typography.size.sm,color:f.colors.text.secondary,whiteSpace:"normal"});return{offset:(0,a.css)(p,{color:f.colors.text.primary,background:f.colors.background.secondary,padding:"2px 5px",borderRadius:f.shape.radius.default,marginLeft:"4px"})}}},27228:(te,R,e)=>{"use strict";e.d(R,{U:()=>i});var n=e(74848),a=e(22803),s=e(63142);const i=({title:u})=>{const o=(0,s.of)(r);return u?(0,n.jsx)("span",{className:o.title,children:u}):null},r=u=>({title:(0,a.css)({fontWeight:u.typography.fontWeightRegular,textOverflow:"ellipsis"})})},5857:(te,R,e)=>{"use strict";e.d(R,{l6:()=>l,rE:()=>u,rL:()=>o});var n=e(74848),a=e(96540),s=e(51898),i=e(92745),r=e(43243);function u(g){return["saturday","sunday","monday"].includes(g)}function o(g){if(g&&u(g))return g;const f=window?.grafanaBootData?.user?.weekStart;return f&&u(f)?f:"monday"}const l=g=>{const{onChange:f,width:p,autoFocus:c=!1,onBlur:x,value:v,disabled:m=!1,inputId:y}=g,h=(0,a.useMemo)(()=>[{value:"",label:(0,i.t)("grafana-ui.week-start-picker.weekStarts-label-default","Default")},{value:"saturday",label:(0,i.t)("grafana-ui.week-start-picker.weekStarts-label-saturday","Saturday")},{value:"sunday",label:(0,i.t)("grafana-ui.week-start-picker.weekStarts-label-sunday","Sunday")},{value:"monday",label:(0,i.t)("grafana-ui.week-start-picker.weekStarts-label-monday","Monday")}],[]),d=(0,a.useCallback)(b=>{b&&b.value!==void 0&&f(u(b.value)?b.value:void 0)},[f]),E=(0,a.useMemo)(()=>h.find(b=>b.value===v)?.value??"",[v,h]);return(0,n.jsx)(r.G,{id:y,value:E,placeholder:s.Tp.components.WeekStartPicker.placeholder,autoFocus:c,width:p,options:h,onChange:d,onBlur:x,disabled:m})}},8431:(te,R,e)=>{"use strict";e.d(R,{Z:()=>a,o:()=>n});const n=[{from:"now-5m",to:"now",display:"Last 5 minutes"},{from:"now-15m",to:"now",display:"Last 15 minutes"},{from:"now-30m",to:"now",display:"Last 30 minutes"},{from:"now-1h",to:"now",display:"Last 1 hour"},{from:"now-3h",to:"now",display:"Last 3 hours"},{from:"now-6h",to:"now",display:"Last 6 hours"},{from:"now-12h",to:"now",display:"Last 12 hours"},{from:"now-24h",to:"now",display:"Last 24 hours"},{from:"now-2d",to:"now",display:"Last 2 days"},{from:"now-7d",to:"now",display:"Last 7 days"},{from:"now-30d",to:"now",display:"Last 30 days"},{from:"now-90d",to:"now",display:"Last 90 days"},{from:"now-6M",to:"now",display:"Last 6 months"},{from:"now-1y",to:"now",display:"Last 1 year"},{from:"now-2y",to:"now",display:"Last 2 years"},{from:"now-5y",to:"now",display:"Last 5 years"},{from:"now-1d/d",to:"now-1d/d",display:"Yesterday"},{from:"now-2d/d",to:"now-2d/d",display:"Day before yesterday"},{from:"now-7d/d",to:"now-7d/d",display:"This day last week"},{from:"now-1w/w",to:"now-1w/w",display:"Previous week"},{from:"now-1M/M",to:"now-1M/M",display:"Previous month"},{from:"now-1Q/fQ",to:"now-1Q/fQ",display:"Previous fiscal quarter"},{from:"now-1y/y",to:"now-1y/y",display:"Previous year"},{from:"now-1y/fy",to:"now-1y/fy",display:"Previous fiscal year"},{from:"now/d",to:"now/d",display:"Today"},{from:"now/d",to:"now",display:"Today so far"},{from:"now/w",to:"now/w",display:"This week"},{from:"now/w",to:"now",display:"This week so far"},{from:"now/M",to:"now/M",display:"This month"},{from:"now/M",to:"now",display:"This month so far"},{from:"now/y",to:"now/y",display:"This year"},{from:"now/y",to:"now",display:"This year so far"},{from:"now/fQ",to:"now",display:"This fiscal quarter so far"},{from:"now/fQ",to:"now/fQ",display:"This fiscal quarter"},{from:"now/fy",to:"now",display:"This fiscal year so far"},{from:"now/fy",to:"now/fy",display:"This fiscal year"}],a=[{label:"January",value:0},{label:"February",value:1},{label:"March",value:2},{label:"April",value:3},{label:"May",value:4},{label:"June",value:5},{label:"July",value:6},{label:"August",value:7},{label:"September",value:8},{label:"October",value:9},{label:"November",value:10},{label:"December",value:11}]},62348:(te,R,e)=>{"use strict";e.d(R,{X:()=>r,f:()=>i});var n=e(25229),a=e(33239),s=e(44922);function i(u,o,l){return(0,n.Ar)(u)?u.isValid():a.isMathString(u)?a.isValid(u):(0,s.b)(u,{roundUp:o,timeZone:l}).isValid()}function r(u){return a.isValid(u.from)&&a.isValid(u.to)}},41e3:(te,R,e)=>{"use strict";e.d(R,{Q:()=>a});var n=e(62717);function a(s,i){const r=(0,n.HD)(i);if(!r)return s;const u=r.utcOffset(s.getTime()),o=s.getTimezoneOffset(),l=u-o;return new Date(s.getTime()-l*1e3*60)}},3271:(te,R,e)=>{"use strict";e.d(R,{c:()=>i});var n=e(74848),a=e(22803),s=e(63142);const i=({direction:u="horizontal",spacing:o=2})=>{const l=(0,s.of)(r,o);return u==="vertical"?(0,n.jsx)("div",{className:l.verticalDivider}):(0,n.jsx)("hr",{className:l.horizontalDivider})};i.displayName="Divider";const r=(u,o)=>({horizontalDivider:(0,a.css)({borderTop:`1px solid ${u.colors.border.weak}`,margin:u.spacing(o,0),width:"100%"}),verticalDivider:(0,a.css)({borderRight:`1px solid ${u.colors.border.weak}`,margin:u.spacing(0,o),height:"100%"})})},45897:(te,R,e)=>{"use strict";e.d(R,{l:()=>a});var n=e(22803);const a=(s,i)=>{const r=i||"middle",u=s.colors.emphasize(s.colors.background.secondary,.15),o=s.colors.primary.border,l=s.spacing(2),g=4,f=200;let p="50%",c="50%";switch(r){case"start":{p="0%",c="0%";break}case"end":{p="100%",c="100%";break}}const x=(0,n.css)({position:"relative","&:before":{content:'""',position:"absolute",transition:s.transitions.create("border-color"),zIndex:1},"&:after":{background:u,content:'""',position:"absolute",transition:s.transitions.create("background"),transform:"translate(-50%, -50%)",borderRadius:s.shape.radius.pill,zIndex:1},"&:hover":{"&:before":{borderColor:o},"&:after":{background:o}}}),v={borderRight:"1px solid transparent",height:"100%",left:p,transform:"translateX(-50%)"},m={borderTop:"1px solid transparent",top:c,transform:"translateY(-50%)"};return{dragHandleVertical:(0,n.cx)(x,(0,n.css)({cursor:"col-resize",width:l,"&:before":v,"&:after":{left:p,top:"50%",height:f,width:g}})),dragHandleHorizontal:(0,n.cx)(x,(0,n.css)({height:l,cursor:"row-resize","&:before":m,"&:after":{left:"50%",top:c,height:g,width:f}})),dragHandleBaseVertical:(0,n.cx)(x,(0,n.css)({cursor:"col-resize",width:l,"&:before":v})),dragHandleBaseHorizontal:(0,n.cx)(x,(0,n.css)({cursor:"row-resize",height:l,"&:before":m}))}}},8207:(te,R,e)=>{"use strict";e.d(R,{_:()=>y});var n=e(74848),a=e(22803),s=e(18828),i=e(42211),r=e(93225),u=e(8772),o=e(96540),l=e(51898),g=e(92745),f=e(63142),p=e(45897),c=e(76319),x=e(92807),v=e(66404);const m={sm:{width:"25vw",minWidth:384},md:{width:"50vw",minWidth:568},lg:{width:"75vw",minWidth:744}};function y({children:C,onClose:P,closeOnMaskClick:M=!0,scrollableContent:O=!0,title:j,subtitle:U,width:W,size:B="md",tabs:S}){const[_,K,T]=h(),L=(0,f.of)(b),A=(0,f.of)(D,B),N=(0,f.of)(p.l),V=o.useRef(null),{dialogProps:z,titleProps:w}=(0,s.s)({},V),{overlayProps:H}=(0,r.e)({isDismissable:!1,isOpen:!0,onClose:P},V);E();const Q=(0,n.jsx)("div",{className:L.content,children:C}),Z=_??W??m[B].width,Y=m[B].minWidth;return(0,n.jsx)(u.A,{open:!0,onClose:P,placement:"right",getContainer:".main-view",className:L.drawerContent,rootClassName:L.drawer,classNames:{wrapper:A},styles:{wrapper:{width:Z,minWidth:Y}},width:"",motion:{motionAppear:!0,motionName:L.drawerMotion},maskClassName:L.mask,maskClosable:M,maskMotion:{motionAppear:!0,motionName:L.maskMotion},children:(0,n.jsx)(i.n1,{restoreFocus:!0,contain:!0,autoFocus:!0,children:(0,n.jsxs)("div",{"aria-label":typeof j=="string"?l.Tp.components.Drawer.General.title(j):l.Tp.components.Drawer.General.title("no title"),className:L.container,...H,...z,ref:V,children:[(0,n.jsx)("div",{className:(0,a.cx)(N.dragHandleVertical,L.resizer),onMouseDown:K,onTouchStart:T}),(0,n.jsxs)("div",{className:(0,a.cx)(L.header,!!S&&L.headerWithTabs),children:[(0,n.jsx)("div",{className:L.actions,children:(0,n.jsx)(c.K,{name:"times",variant:"secondary",onClick:P,"data-testid":l.Tp.components.Drawer.General.close,tooltip:(0,g.t)("grafana-ui.drawer.close","Close")})}),typeof j=="string"?(0,n.jsxs)("div",{className:L.titleWrapper,children:[(0,n.jsx)(v.E,{element:"h3",...w,children:j}),U&&(0,n.jsx)("div",{className:L.subtitle,"data-testid":l.Tp.components.Drawer.General.subtitle,children:U})]}):j,S&&(0,n.jsx)("div",{className:L.tabsWrapper,children:S})]}),O?(0,n.jsx)(x.P,{showScrollIndicators:!0,children:Q}):Q]})})})}function h(){const[C,P]=(0,o.useState)(void 0),M=(0,o.useCallback)(S=>{P(d(S.clientX))},[]),O=(0,o.useCallback)(S=>{const _=S.touches[0];P(d(_.clientX))},[]),j=(0,o.useCallback)(S=>{document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",j)},[M]),U=(0,o.useCallback)(S=>{document.removeEventListener("touchmove",O),document.removeEventListener("touchend",U)},[O]);function W(S){S.stopPropagation(),S.preventDefault(),document.addEventListener("mousemove",M),document.addEventListener("mouseup",j)}function B(S){S.stopPropagation(),S.preventDefault(),document.addEventListener("touchmove",O),document.addEventListener("touchend",U)}return[C,W,B]}function d(C){let P=document.body.offsetWidth-(C-document.body.offsetLeft);return`${Math.min(P/document.body.clientWidth*100,98).toFixed(2)}vw`}function E(){(0,o.useEffect)(()=>{if(document.body)return document.body.classList.add("body-drawer-open"),()=>{document.body.classList.remove("body-drawer-open")}},[])}const b=C=>({container:(0,a.css)({display:"flex",flexDirection:"column",height:"100%",flex:"1 1 0",minHeight:"100%",position:"relative"}),drawer:(0,a.css)({top:0,".rc-drawer-content-wrapper":{boxShadow:C.shadows.z3}}),drawerContent:(0,a.css)({backgroundColor:`${C.colors.background.primary} !important`,display:"flex",overflow:"unset !important",flexDirection:"column"}),drawerMotion:(0,a.css)({"&-appear":{transform:"translateX(100%)",transition:"none !important","&-active":{transition:`${C.transitions.create("transform")} !important`,transform:"translateX(0)"}}}),mask:(0,a.css)({backgroundColor:"transparent !important",position:"fixed !important","&:before":{backgroundColor:`${C.components.overlay.background} !important`,bottom:0,content:'""',left:0,position:"fixed",right:0,top:0}}),maskMotion:(0,a.css)({"&-appear":{opacity:0,"&-active":{opacity:1,transition:C.transitions.create("opacity")}}}),header:(0,a.css)({label:"drawer-header",flexGrow:0,padding:C.spacing(2,2,3),borderBottom:`1px solid ${C.colors.border.weak}`}),headerWithTabs:(0,a.css)({borderBottom:"none"}),actions:(0,a.css)({position:"absolute",right:C.spacing(1),top:C.spacing(1)}),titleWrapper:(0,a.css)({label:"drawer-title",overflowWrap:"break-word"}),subtitle:(0,a.css)({label:"drawer-subtitle",color:C.colors.text.secondary,paddingTop:C.spacing(1)}),content:(0,a.css)({padding:C.spacing(C.components.drawer?.padding??2),height:"100%",flexGrow:1,minHeight:0}),tabsWrapper:(0,a.css)({label:"drawer-tabs",paddingLeft:C.spacing(2),margin:C.spacing(1,-1,-3,-3)}),resizer:(0,a.css)({top:0,left:C.spacing(-1),bottom:0,position:"absolute",zIndex:C.zIndex.modal})});function D(C,P){return(0,a.css)({label:`drawer-content-wrapper-${P}`,overflow:"unset !important",[C.breakpoints.down("md")]:{width:`calc(100% - ${C.spacing(2)}) !important`,minWidth:"0 !important"}})}},15356:(te,R,e)=>{"use strict";e.d(R,{f:()=>x});var n=e(74848),a=e(22803),s=e(34743),i=e(83505),r=e(46885),u=e(42211),o=e(96540),l=e(63142),g=e(87063),f=e(94535),p=e(7895);const c=m=>{const{className:y,options:h,value:d,onChange:E,narrow:b,variant:D,...C}=m,P=(0,l.of)(v),[M,O]=(0,o.useState)(!1),j=[(0,s.cY)(0),(0,s.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,s.BN)()],{context:U,refs:W,floatingStyles:B}=(0,i.we)({open:M,placement:"bottom-end",onOpenChange:O,middleware:j,whileElementsMounted:r.ll}),S=(0,i.kp)(U),_=(0,i.s9)(U),{getReferenceProps:K,getFloatingProps:T}=(0,i.bv)([_,S]),L=A=>{E(A),O(!1)};return(0,n.jsxs)("div",{className:P.wrapper,children:[(0,n.jsx)(p.I,{className:y,isOpen:M,narrow:b,variant:D,ref:W.setReference,...K(),...C,children:d?.label||(d?.value!=null?String(d?.value):null)}),M&&(0,n.jsx)("div",{className:P.menuWrapper,ref:W.setFloating,...T(),style:B,children:(0,n.jsx)(u.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)(g.W,{tabIndex:-1,onClose:()=>O(!1),children:h.map(A=>(0,n.jsx)(f.D,{label:A.label??String(A.value),onClick:()=>L(A),active:A.value===d?.value,ariaChecked:A.value===d?.value,ariaLabel:A.ariaLabel||A.label,disabled:A.isDisabled,component:A.component,role:"menuitemradio"},`${A.value}`))})})})]})};c.displayName="ButtonSelect";const x=(0,o.memo)(c),v=m=>({wrapper:(0,a.css)({position:"relative",display:"inline-flex"}),menuWrapper:(0,a.css)({zIndex:m.zIndex.dropdown})})},88559:(te,R,e)=>{"use strict";e.d(R,{m:()=>c});var n=e(74848),a=e(22803),s=e(34743),i=e(83505),r=e(46885),u=e(96540),o=e(66588),l=e(63142),g=e(44019),f=e(71495),p=e(15245);const c=u.memo(({children:v,overlay:m,placement:y,offset:h,onVisibleChange:d})=>{const[E,b]=(0,u.useState)(!1),D=(0,u.useRef)(null),C=(0,u.useCallback)(A=>{b(A),d?.(A)},[d]),P=[(0,s.cY)({mainAxis:h?.[0]??8,crossAxis:h?.[1]??0}),(0,s.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,s.BN)()],{context:M,refs:O,floatingStyles:j}=(0,i.we)({open:E,placement:(0,f.O)(y),onOpenChange:C,middleware:P,whileElementsMounted:r.ll}),U=(0,i.kp)(M),W=(0,i.s9)(M),{getReferenceProps:B,getFloatingProps:S}=(0,i.bv)([W,U]),_=150,K=(0,l.of)(x,_),T=()=>{C(!1)},L=A=>{A.key==="Tab"&&C(!1)};return(0,n.jsxs)(n.Fragment,{children:[u.cloneElement(v,{ref:O.setReference,...B()}),E&&(0,n.jsx)(p.ZL,{children:(0,n.jsx)(i.s3,{context:M,children:(0,n.jsx)("div",{ref:O.setFloating,style:j,onClick:T,onKeyDown:L,children:(0,n.jsx)(o.A,{nodeRef:D,appear:!0,in:!0,timeout:{appear:_,exit:0,enter:0},classNames:K,children:(0,n.jsx)("div",{ref:D,children:(0,g.renderOrCallToRender)(m,{...S()})})})})})})]})});c.displayName="Dropdown";const x=(v,m)=>({appear:(0,a.css)({opacity:"0",position:"relative",transformOrigin:"top",[v.transitions.handleMotion("no-preference")]:{transform:"scaleY(0.5)"}}),appearActive:(0,a.css)({opacity:"1",[v.transitions.handleMotion("no-preference")]:{transform:"scaleY(1)",transition:`transform ${m}ms cubic-bezier(0.2, 0, 0.2, 1), opacity ${m}ms cubic-bezier(0.2, 0, 0.2, 1)`}})})},56887:(te,R,e)=>{"use strict";e.d(R,{_:()=>a,y:()=>s});var n=e(96540);const a=(0,n.createContext)(void 0);function s(i){if(!i)return{};const r=(0,n.useContext)(a);if(!r)return{};const u=r.selected.some(g=>g.id===i),o=(0,n.useCallback)((g,f={})=>{r.enabled&&(g.stopPropagation(),g.shiftKey&&(g.preventDefault(),window.getSelection()?.empty()),r.onSelect({id:i},{...f,multi:f.multi??g.shiftKey}))},[r,i]),l=(0,n.useCallback)(()=>{r.enabled&&r.onClear()},[r]);return{isSelected:u,onSelect:o,onClear:l,isSelectable:r.enabled}}},74451:(te,R,e)=>{"use strict";e.d(R,{Z:()=>i});var n=e(74848),a=e(22803),s=e(63142);const i=({children:u})=>{const o=(0,s.of)(r);return(0,n.jsx)("div",{className:o.container,children:u})},r=u=>({container:(0,a.css)({borderLeft:`3px solid ${u.colors.info.main}`,backgroundColor:`${u.colors.background.secondary}`,padding:u.spacing(2),minWidth:"350px",borderRadius:u.shape.radius.default,marginBottom:u.spacing(4)})})},50201:(te,R,e)=>{"use strict";e.d(R,{p:()=>D});var n=e(74848),a=e(22803),s=e(55494),i=e(63142),r=e(31286),u=e(41654),o=e(66404),l=e(36348);const g=({width:M="auto",height:O})=>{const j=(0,i.of)(f);return(0,n.jsx)(s.default,{src:l,className:j.svg,height:O,width:M})};g.displayName="GrotCTA";const f=M=>({svg:(0,a.css)({"#grot-cta-cactus-1, #grot-cta-cactus-2":{fill:M.isDark?"#58558c":"#c9c5f4"}})});var p=e(96540),c=e(22687);const x=-20,v=5,m=-5,y=5,h=({width:M="auto",height:O})=>{const j=(0,p.useRef)(null),U=(0,i.of)(d);return(0,p.useEffect)(()=>{const W=B=>{if(window.matchMedia("(prefers-reduced-motion: reduce").matches)return;const S=j.current?.querySelector("#grot-not-found-arm"),_=j.current?.querySelector("#grot-not-found-magnifier"),{clientX:K,clientY:T}=B,{innerWidth:L,innerHeight:A}=window,N=T/A,V=K/L,z=E(N,x,v),w=E(V,m,y);window.requestAnimationFrame(()=>{S?.setAttribute("style",`transform: rotate(${z}deg) translateX(${w}%)`),_?.setAttribute("style",`transform: rotate(${z}deg) translateX(${w}%)`)})};return window.addEventListener("mousemove",W),()=>{window.removeEventListener("mousemove",W)}},[]),(0,n.jsx)(s.default,{innerRef:j,src:c,className:U.svg,height:O,width:M})};h.displayName="GrotNotFound";const d=M=>({svg:(0,a.css)({"#grot-not-found-arm, #grot-not-found-magnifier":{transformOrigin:"center"}})}),E=(M,O,j)=>M*(j-O)+O;var b=e(9886);const D=({button:M,children:O,image:j,message:U,hideImage:W=!1,variant:B,role:S})=>{const _=(0,i.of)(P),K=j??C(B);return(0,n.jsx)(r.a,{paddingY:4,display:"flex",direction:"column",alignItems:"center",role:S,children:(0,n.jsxs)("div",{className:_.container,children:[!W&&K,(0,n.jsxs)(u.B,{direction:"column",alignItems:"center",children:[(0,n.jsx)(o.E,{variant:"h4",textAlignment:"center",children:U}),O&&(0,n.jsx)(o.E,{color:"secondary",textAlignment:"center",children:O})]}),M]})})};function C(M){switch(M){case"call-to-action":return(0,n.jsx)(g,{width:300});case"not-found":return(0,n.jsx)(h,{width:300});case"completed":return(0,n.jsx)(s.default,{src:b,width:300});default:throw new Error(`Unknown variant: ${M}`)}}const P=M=>({container:(0,a.css)({display:"flex",flexDirection:"column",alignItems:"center",gap:M.spacing(4),maxWidth:"600px"})})},36303:(te,R,e)=>{"use strict";e.d(R,{Xc:()=>l,Xw:()=>o,tH:()=>u});var n=e(74848),a=e(96540),s=e(32631),i=e(34999),r=e(56297);class u extends a.PureComponent{constructor(){super(...arguments),this.state={error:null,errorInfo:null}}componentDidCatch(f,p){const c=this.props.errorLogger??s.P?.api?.pushError;c&&c(f),this.setState({error:f,errorInfo:p}),this.props.onError&&this.props.onError(f)}componentDidUpdate(f){const{dependencies:p,onRecover:c}=this.props;if(this.state.error&&p&&f.dependencies){for(let x=0;x<p.length;x++)if(p[x]!==f.dependencies[x]){this.setState({error:null,errorInfo:null}),c&&c();break}}}render(){const{children:f}=this.props,{error:p,errorInfo:c}=this.state;return f({error:p,errorInfo:c})}}class o extends a.PureComponent{static{this.defaultProps={title:"An unexpected error happened",style:"alertbox"}}render(){const{title:f,children:p,style:c,dependencies:x,errorLogger:v}=this.props;return(0,n.jsx)(u,{dependencies:x,errorLogger:v,children:({error:m,errorInfo:y})=>y?c==="alertbox"?(0,n.jsx)(i.F,{title:f||"",children:(0,n.jsxs)("details",{style:{whiteSpace:"pre-wrap"},children:[m&&m.toString(),(0,n.jsx)("br",{}),y.componentStack]})}):(0,n.jsx)(r.D,{title:f||"",error:m,errorInfo:y}):p})}}function l(g,f={}){const p=c=>(0,n.jsx)(o,{...f,children:(0,n.jsx)(g,{...c})});return p.displayName="WithErrorBoundary",p}},991:(te,R,e)=>{"use strict";e.d(R,{y:()=>r});var n=e(74848),a=e(1906),s=e(92745),i=e(99887);const r=({featureState:o,tooltip:l})=>{const g=u(o);return(0,n.jsx)(i.E,{text:g.text,color:g.color,icon:g.icon,tooltip:l})};function u(o){switch(o){case a.Ay.alpha:return{text:"Alpha",icon:"exclamation-triangle",color:"orange"};case a.Ay.beta:return{text:"Beta",icon:"rocket",color:"blue"};case a.Ay.experimental:return{text:(0,s.t)("grafana-ui.feature-badge.experimental","Experimental"),icon:"exclamation-triangle",color:"orange"};case a.Ay.preview:return{text:(0,s.t)("grafana-ui.feature-badge.preview","Preview"),icon:"rocket",color:"blue"};case a.Ay.privatePreview:return{text:(0,s.t)("grafana-ui.feature-badge.private-preview","Private preview"),icon:"rocket",color:"blue"};case a.Ay.new:return{text:(0,s.t)("grafana-ui.feature-badge.new","New!"),icon:"rocket",color:"blue"}}}},40279:(te,R,e)=>{"use strict";e.d(R,{gH:()=>x,wI:()=>y});var n=e(74848),a=e(22803),s=e(2543),i=e.n(s),r=e(96540),u=e(10824),o=e(55386),l=e(92745),g=e(63142),f=e(34999),p=e(30703),c=e(48431);function x({options:D,children:C,readAs:P,onLoad:M,fileListRenderer:O,onFileRemove:j}){const[U,W]=(0,r.useState)([]),[B,S]=(0,r.useState)([]),_=(0,o.j_)("decbytes")(D?.maxSize?D?.maxSize:0),K=(0,r.useCallback)((X,I)=>{W(J=>J.map(ee=>(ee.id===X.id&&I(ee),ee)))},[]),T=(0,r.useCallback)((X,I,J)=>{let ee=X.map(E);if(D?.multiple===!1?W(ee):W(q=>[...q,...ee]),Q(I),D?.onDrop)D.onDrop(X,I,J);else for(const q of ee){const ne=new FileReader,se=()=>{P?ne[P](q.file):ne.readAsText(q.file)};K(q,oe=>{oe.abortUpload=()=>{ne.abort()},oe.retryUpload=()=>{K(q,de=>{de.error=null,de.progress=void 0}),se()}}),ne.onabort=()=>{K(q,oe=>{oe.error=new DOMException("Aborted")})},ne.onprogress=oe=>{K(q,de=>{de.progress=oe.loaded})},ne.onload=()=>{M?.(ne.result)},ne.onerror=()=>{K(q,oe=>{oe.error=ne.error})},se()}},[M,D,P,K]),L=X=>{const I=U.filter(J=>X.id!==J.id);W(I),j?.(X)},{getRootProps:A,getInputProps:N,isDragActive:V}=(0,u.VB)({...D,useFsAccessApi:!1,onDrop:T,accept:m(D?.accept)}),z=(0,g.$j)(),w=b(z,V),H=U.map(X=>O?O(X,L):(0,n.jsx)(c.I,{file:X,removeFile:L},X.id)),Q=X=>{let I=[];X.map(J=>{J.errors.map(ee=>{I.findIndex(q=>q.code===ee.code&&q.message===ee.message)===-1&&I.push(ee)})}),S(I)},Z=X=>{const I=(0,o.cN)(_);return(0,n.jsx)("div",{className:w.errorAlert,children:(0,n.jsx)(f.F,{title:(0,l.t)("grafana-ui.file-dropzone.error-title","Upload failed"),severity:"error",onRemove:Y,children:X.map(J=>{switch(J.code){case u.O4.FileTooLarge:return(0,n.jsx)("div",{children:(0,n.jsxs)(l.x6,{i18nKey:"grafana-ui.file-dropzone.file-too-large",children:["File is larger than ",{size:I}]})},J.message+J.code);default:return(0,n.jsx)("div",{children:J.message},J.message+J.code)}})})})},Y=()=>{S([])};return(0,n.jsxs)("div",{className:w.container,children:[(0,n.jsxs)("div",{"data-testid":"dropzone",...A({className:w.dropzone}),children:[(0,n.jsx)("input",{...N()}),C??(0,n.jsx)(y,{primaryText:h(U,D)})]}),B.length>0&&Z(B),(0,n.jsxs)("small",{className:(0,a.cx)(w.small,w.acceptContainer),children:[D?.maxSize&&`Max file size: ${(0,o.cN)(_)}`,D?.maxSize&&D?.accept&&(0,n.jsx)("span",{className:w.acceptSeparator,children:"|"}),D?.accept&&d(D.accept)]}),H]})}function v(D){return["txt","json","csv","xls","yml"].some(C=>D.match(C))?"text/plain":"application/octet-stream"}function m(D){return(0,s.isString)(D)?{[v(D)]:[D]}:Array.isArray(D)?D.reduce((C,P)=>{const M=v(P);return C[M]=C[M]?[...C[M],P]:[P],C},{}):D}function y({primaryText:D="Drop file here or click to upload",secondaryText:C=""}){const P=(0,g.$j)(),M=b(P);return(0,n.jsxs)("div",{className:(0,a.cx)(M.defaultDropZone),"data-testid":"file-drop-zone-default-children",children:[(0,n.jsx)(p.I,{className:(0,a.cx)(M.icon),name:"upload",size:"xl"}),(0,n.jsx)("h6",{className:(0,a.cx)(M.primaryText),children:D}),(0,n.jsx)("small",{className:M.small,children:C})]})}function h(D,C){return C?.multiple===void 0||C?.multiple?"Upload file":D.length?"Replace file":"Upload file"}function d(D){return(0,s.isString)(D)?`Accepted file type: ${D}`:Array.isArray(D)?`Accepted file types: ${D.join(", ")}`:`Accepted file types: ${Object.values(D).flat().join(", ")}`}function E(D){return{id:(0,s.uniqueId)("file"),file:D,error:null}}function b(D,C){return{container:(0,a.css)({display:"flex",flexDirection:"column",width:"100%",padding:D.spacing(2),borderRadius:D.shape.radius.default,border:`1px dashed ${D.colors.border.strong}`,backgroundColor:C?D.colors.background.secondary:D.colors.background.primary,cursor:"pointer",alignItems:"center",justifyContent:"center"}),dropzone:(0,a.css)({height:"100%",width:"100%",display:"flex",flexDirection:"column"}),defaultDropZone:(0,a.css)({textAlign:"center"}),icon:(0,a.css)({marginBottom:D.spacing(1)}),primaryText:(0,a.css)({marginBottom:D.spacing(1)}),acceptContainer:(0,a.css)({textAlign:"center",margin:0}),acceptSeparator:(0,a.css)({margin:`0 ${D.spacing(1)}`}),small:(0,a.css)({color:D.colors.text.secondary}),errorAlert:(0,a.css)({paddingTop:"10px"})}}},48431:(te,R,e)=>{"use strict";e.d(R,{I:()=>p});var n=e(74848),a=e(22803),s=e(55386),i=e(92745),r=e(63142),u=e(28473),o=e(45861),l=e(30703),g=e(76319);const f="Remove file";function p({file:x,removeFile:v}){const m=(0,r.of)(c),{file:y,progress:h,error:d,abortUpload:E,retryUpload:b}=x,D=()=>d?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:m.error,children:d.message}),b&&(0,n.jsx)(g.K,{name:"sync",tooltip:(0,i.t)("grafana-ui.file-dropzone.item-retry","Retry"),tooltipPlacement:"top",onClick:b}),v&&(0,n.jsx)(g.K,{className:b?m.marginLeft:"",name:"trash-alt",onClick:()=>v(x),tooltip:f})]}):h&&y.size>h?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("progress",{className:m.progressBar,max:y.size,value:h}),(0,n.jsxs)("span",{className:m.paddingLeft,children:[Math.round(h/y.size*100),"%"]}),E&&(0,n.jsx)(o.$n,{variant:"secondary",type:"button",fill:"text",onClick:E,children:(0,n.jsx)(i.x6,{i18nKey:"grafana-ui.file-dropzone.cancel-upload",children:"Cancel upload"})})]}):v&&(0,n.jsx)(g.K,{name:"trash-alt",onClick:()=>v(x),tooltip:f,tooltipPlacement:"top"}),C=(0,s.j_)("decbytes")(y.size);return(0,n.jsxs)("div",{className:m.fileListContainer,children:[(0,n.jsxs)("span",{className:m.fileNameWrapper,children:[(0,n.jsx)(l.I,{name:"file-blank",size:"lg","aria-hidden":!0}),(0,n.jsx)("span",{className:m.padding,children:(0,u.i)(y.name)}),(0,n.jsx)("span",{children:(0,s.cN)(C)})]}),(0,n.jsx)("div",{className:m.fileNameWrapper,children:D()})]})}function c(x){return{fileListContainer:(0,a.css)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:x.spacing(2),border:`1px dashed ${x.colors.border.medium}`,backgroundColor:`${x.colors.background.secondary}`,marginTop:x.spacing(1)}),fileNameWrapper:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"center"}),padding:(0,a.css)({padding:x.spacing(0,1)}),paddingLeft:(0,a.css)({paddingLeft:x.spacing(2)}),marginLeft:(0,a.css)({marginLeft:x.spacing(1)}),error:(0,a.css)({paddingRight:x.spacing(2),color:x.colors.error.text}),progressBar:(0,a.css)({borderRadius:x.shape.radius.default,height:"4px","::-webkit-progress-bar":{backgroundColor:x.colors.border.weak,borderRadius:x.shape.radius.default},"::-webkit-progress-value":{backgroundColor:x.colors.primary.main,borderRadius:x.shape.radius.default}})}}},57688:(te,R,e)=>{"use strict";e.d(R,{e:()=>c});var n=e(74848),a=e(22803),s=e(96540),i=e(24726),r=e(51898),u=e(92745),o=e(63142),l=e(35484),g=e(28473),f=e(45861),p=e(30703);const c=({onFileUpload:v,className:m,children:y="Upload file",accept:h="*",size:d="md",showFileName:E})=>{const b=(0,o.of)(x(d)),[D,C]=(0,s.useState)(""),P=(0,i.A)(),M=(0,s.useCallback)(O=>{const j=O.currentTarget?.files?.[0];j&&C(j.name??""),v(O)},[v]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("input",{type:"file",id:P,className:b.fileUpload,onChange:M,multiple:!1,accept:h,"data-testid":r.Tp.components.FileUpload.inputField}),(0,n.jsxs)("label",{htmlFor:P,className:(0,a.cx)(b.labelWrapper,m),children:[(0,n.jsx)(p.I,{name:"upload",className:b.icon}),y]}),E&&D&&(0,n.jsx)("span",{"aria-label":(0,u.t)("grafana-ui.file-upload.file-name","File name"),className:b.fileName,"data-testid":r.Tp.components.FileUpload.fileNameSpan,children:(0,g.i)(D)})]})},x=v=>m=>{const y=(0,f.hs)({theme:m,variant:"primary",size:v,iconOnly:!1}),h=(0,l.getFocusStyles)(m);return{fileUpload:(0,a.css)({height:"0.1px",opacity:"0",overflow:"hidden",position:"absolute",width:"0.1px",zIndex:-1,"&:focus + label":h,"&:focus-visible + label":h}),labelWrapper:y.button,icon:y.icon,fileName:(0,a.css)({marginLeft:m.spacing(.5)})}}},12737:(te,R,e)=>{"use strict";e.d(R,{Z:()=>g});var n=e(74848),a=e(96540),s=e(8934),i=e(92745);function r(...f){const p=a.useRef(null);return a.useEffect(()=>{f.forEach(c=>{c&&(typeof c=="function"?c(p.current):c.current=p.current)})},[f]),p}var u=e(45861),o=e(30703),l=e(63527);const g=(0,a.forwardRef)(({value:f,width:p,onChange:c,escapeRegex:x=!0,...v},m)=>{const y=(0,a.useRef)(null),h=r(m,y),d=f!==""?(0,n.jsx)(u.$n,{icon:"times",fill:"text",size:"sm",onClick:E=>{y.current?.focus(),c(""),E.stopPropagation()},children:(0,n.jsx)(i.x6,{i18nKey:"grafana-ui.filter-input.clear",children:"Clear"})}):null;return(0,n.jsx)(l.p,{prefix:(0,n.jsx)(o.I,{name:"search"}),suffix:d,width:p,type:"text",value:x?(0,s.xb)(f??""):f,onChange:E=>c(x?(0,s.jD)(E.currentTarget.value):E.currentTarget.value),...v,ref:h})});g.displayName="FilterInput"},34343:(te,R,e)=>{"use strict";e.d(R,{m:()=>u});var n=e(74848),a=e(22803),s=e(63142),i=e(45861),r=e(30703);const u=({label:l,selected:g,onClick:f,icon:p="check"})=>{const c=(0,s.of)(o),x=(0,s.of)(i.my);return(0,n.jsxs)("button",{type:"button",className:(0,a.cx)(x,c.wrapper,g&&c.selected),onClick:f,children:[(0,n.jsx)("span",{children:l}),g&&(0,n.jsx)(r.I,{name:p,className:c.icon,"data-testid":"filter-pill-icon"})]})},o=l=>({wrapper:(0,a.css)({background:l.colors.background.secondary,borderRadius:l.shape.radius.pill,padding:l.spacing(0,2),fontSize:l.typography.bodySmall.fontSize,fontWeight:l.typography.fontWeightMedium,lineHeight:l.typography.bodySmall.lineHeight,color:l.colors.text.secondary,display:"flex",alignItems:"center",height:"32px",position:"relative",border:`1px solid ${l.colors.background.secondary}`,whiteSpace:"nowrap","&:hover":{background:l.colors.action.hover,color:l.colors.text.primary}}),selected:(0,a.css)({color:l.colors.text.primary,background:l.colors.action.selected,"&:hover":{background:l.colors.action.focus}}),icon:(0,a.css)({marginLeft:l.spacing(.5)})})},94959:(te,R,e)=>{"use strict";e.d(R,{z:()=>i});var n=e(74848),a=e(22803),s=e(51115);const i=({label:u,tooltip:o,labelWidth:l=6,inputWidth:g=12,inputEl:f,className:p,interactive:c,...x})=>{const v=r();return(0,n.jsxs)("div",{className:(0,a.cx)(v.formField,p),children:[(0,n.jsx)(s.I,{width:l,tooltip:o,interactive:c,children:u}),f||(0,n.jsx)("input",{type:"text",className:`gf-form-input ${g?`width-${g}`:""}`,...x,disabled:x.disabled})]})};i.displayName="FormField";const r=()=>({formField:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative"})})},51115:(te,R,e)=>{"use strict";e.d(R,{I:()=>o});var n=e(74848),a=e(46942),s=e.n(a),i=e(30703),r=e(45967);const o=({children:l,isFocused:g,isInvalid:f,className:p,htmlFor:c,tooltip:x,width:v,interactive:m,...y})=>{const h=s()(p,`gf-form-label width-${v||"10"}`,{"gf-form-label--is-focused":g,"gf-form-label--is-invalid":f});return(0,n.jsxs)("label",{className:h,...y,htmlFor:c,children:[l,x&&(0,n.jsx)(r.m,{placement:"top",content:x,theme:"info",interactive:m,children:(0,n.jsx)(i.I,{name:"info-circle",size:"sm",style:{marginLeft:"10px"}})})]})}},21539:(te,R,e)=>{"use strict";e.d(R,{i:()=>s});var n=e(74848);function a(i){return i<20?.9:i<26?.8:.6}const s=({value:i,className:r,style:u,...o})=>{const l=(i.prefix??"").length>0,g=(i.suffix??"").length>0;let f;if(u&&typeof u.fontSize=="number"&&!Number.isNaN(u.fontSize)){const p=u.fontSize,c=a(p);f={fontSize:p*c}}return(0,n.jsx)("div",{className:r,style:u,...o,children:(0,n.jsxs)("div",{children:[l&&(0,n.jsx)("span",{children:i.prefix}),(0,n.jsx)("span",{children:i.text}),g&&(0,n.jsx)("span",{style:f,children:i.suffix})]})})};s.displayName="FormattedDisplayValue"},32635:(te,R,e)=>{"use strict";e.d(R,{S:()=>o});var n=e(74848),a=e(22803),s=e(96540),i=e(63142),r=e(35484),u=e(72636);const o=s.forwardRef(({label:g,description:f,value:p,htmlValue:c,onChange:x,disabled:v,className:m,indeterminate:y,invalid:h,...d},E)=>{const b=(0,s.useCallback)(P=>{x&&x(P)},[x]),D=(0,i.of)(l,h),C=y?"mixed":void 0;return(0,n.jsxs)("label",{className:(0,a.cx)(D.wrapper,m),children:[(0,n.jsxs)("div",{className:D.checkboxWrapper,children:[(0,n.jsx)("input",{type:"checkbox",className:(0,a.cx)(D.input,y&&D.inputIndeterminate),checked:p,disabled:v,onChange:b,value:c,"aria-checked":C,...d,ref:E}),(0,n.jsx)("span",{className:D.checkmark})]}),g&&(0,n.jsx)("span",{className:D.label,children:g}),f&&(0,n.jsx)("span",{className:D.description,children:f})]})}),l=(g,f=!1)=>{const p=(0,u.f)(g),c=2,x=1,v=m=>f?g.colors.error.border:m;return{wrapper:(0,a.css)({display:"inline-grid",alignItems:"center",columnGap:g.spacing(x),gridAutoRows:"max-content",position:"relative",verticalAlign:"middle"}),input:(0,a.css)({position:"absolute",zIndex:1,top:0,left:0,width:"100% !important",height:"100%",opacity:0,"&:focus + span, &:focus-visible + span":(0,r.getFocusStyles)(g),"&:focus:not(:focus-visible) + span":(0,r.getMouseFocusStyles)(g),"&:checked + span":{background:g.colors.primary.main,border:`1px solid ${v(g.colors.primary.main)}`,"&:hover":{background:g.colors.primary.shade},"&:after":{content:'""',position:"absolute",zIndex:2,left:g.spacing(.5),top:0,width:g.spacing(.75),height:g.spacing(1.5),border:`solid ${g.colors.primary.contrastText}`,borderWidth:"0 3px 3px 0",transform:"rotate(45deg)"}},"&:disabled + span":{backgroundColor:g.colors.action.disabledBackground,cursor:"not-allowed",border:`1px solid ${v(g.colors.action.disabledBackground)}`,"&:hover":{backgroundColor:g.colors.action.disabledBackground},"&:after":{borderColor:g.colors.action.disabledText}}}),inputIndeterminate:(0,a.css)({"&[aria-checked='mixed'] + span":{border:`1px solid ${v(g.colors.primary.main)}`,background:g.colors.primary.main,"&:hover":{background:g.colors.primary.shade},"&:after":{content:'""',position:"absolute",zIndex:2,left:"2px",right:"2px",top:"calc(50% - 1.5px)",height:"3px",border:`1.5px solid ${g.colors.primary.contrastText}`,backgroundColor:g.colors.primary.contrastText,width:"auto",transform:"none"}},"&:disabled[aria-checked='mixed'] + span":{backgroundColor:g.colors.action.disabledBackground,border:`1px solid ${v(g.colors.error.transparent)}`,"&:after":{borderColor:g.colors.action.disabledText}}}),checkboxWrapper:(0,a.css)({display:"flex",alignItems:"center",gridColumnStart:1,gridRowStart:1}),checkmark:(0,a.css)({position:"relative",zIndex:2,display:"inline-block",width:g.spacing(c),height:g.spacing(c),borderRadius:g.shape.radius.default,background:g.components.input.background,border:`1px solid ${v(g.components.input.borderColor)}`,"&:hover":{cursor:"pointer",borderColor:v(g.components.input.borderHover)}}),label:(0,a.cx)(p.label,(0,a.css)({gridColumnStart:2,gridRowStart:1,position:"relative",zIndex:2,cursor:"pointer",maxWidth:"fit-content",lineHeight:g.typography.bodySmall.lineHeight,marginBottom:0})),description:(0,a.cx)(p.description,(0,a.css)({gridColumnStart:2,gridRowStart:2,lineHeight:g.typography.bodySmall.lineHeight,marginTop:0,zIndex:1}))}};o.displayName="Checkbox"},37386:(te,R,e)=>{"use strict";e.d(R,{D:()=>l});var n=e(74848),a=e(22803),s=e(96540),i=e(63142),r=e(44019),u=e(12594),o=e(72636);const l=s.forwardRef(({label:p,description:c,horizontal:x,invalid:v,loading:m,disabled:y,required:h,error:d,children:E,className:b,validationMessageHorizontalOverflow:D,htmlFor:C,noMargin:P,...M},O)=>{const j=(0,i.of)(f,P),U=C??(0,r.getChildId)(E),W=typeof p=="string"?(0,n.jsx)(o.J,{htmlFor:U,description:c,children:`${p}${h?" *":""}`}):p,B=g({invalid:v,disabled:y,loading:m});return(0,n.jsxs)("div",{className:(0,a.cx)(j.field,x&&j.fieldHorizontal,b),...M,children:[W,(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{ref:O,children:s.cloneElement(E,B)}),v&&d&&!x&&(0,n.jsx)("div",{className:(0,a.cx)(j.fieldValidationWrapper,{[j.validationMessageHorizontalOverflow]:!!D}),children:(0,n.jsx)(u.P,{children:d})})]}),v&&d&&x&&(0,n.jsx)("div",{className:(0,a.cx)(j.fieldValidationWrapper,j.fieldValidationWrapperHorizontal,{[j.validationMessageHorizontalOverflow]:!!D}),children:(0,n.jsx)(u.P,{children:d})})]})});l.displayName="Field";function g(p){for(const c in p)p[c]===void 0&&delete p[c];return p}const f=(p,c)=>({field:(0,a.css)({display:"flex",flexDirection:"column",marginBottom:p.spacing(c?0:2)}),fieldHorizontal:(0,a.css)({flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}),fieldValidationWrapper:(0,a.css)({marginTop:p.spacing(.5)}),fieldValidationWrapperHorizontal:(0,a.css)({flex:"1 1 100%"}),validationMessageHorizontalOverflow:(0,a.css)({width:0,overflowX:"visible","& > *":{whiteSpace:"nowrap"}})})},16780:(te,R,e)=>{"use strict";e.d(R,{n:()=>r});var n=e(74848),a=e(22803),s=e(63142),i=e(53487);const r=({label:o,children:l,className:g,...f})=>{const p=(0,s.of)(u);return(0,n.jsxs)("fieldset",{className:(0,a.cx)(p.wrapper,g),...f,children:[o&&(0,n.jsx)(i.s,{children:o}),l]})},u=o=>({wrapper:(0,a.css)({marginBottom:o.spacing(4),"&:last-child":{marginBottom:0}})})},12594:(te,R,e)=>{"use strict";e.d(R,{P:()=>r});var n=e(74848),a=e(22803),s=e(63142),i=e(30703);const r=({children:o,horizontal:l,className:g})=>{const f=(0,s.of)(u),p=(0,a.cx)(l?f.horizontal:f.vertical,g);return(0,n.jsxs)("div",{role:"alert",className:p,children:[(0,n.jsx)(i.I,{className:f.fieldValidationMessageIcon,name:"exclamation-triangle"}),o]})},u=o=>{const l=`
      font-size: ${o.typography.size.sm};
      font-weight: ${o.typography.fontWeightMedium};
      padding: ${o.spacing(.5,1)};
      color: ${o.colors.error.contrastText};
      background: ${o.colors.error.main};
      border-radius: ${o.shape.radius.default};
      position: relative;
      display: inline-block;
      align-self: flex-start;

      a {
        color: ${o.colors.error.contrastText};
        text-decoration: underline;
      }

      a:hover {
        text-decoration: none;
      }
    `;return{vertical:(0,a.css)(l,{margin:o.spacing(.5,0,0,0),"&:before":{content:'""',position:"absolute",left:"9px",top:"-5px",width:0,height:0,borderWidth:"0 4px 5px 4px",borderColor:`transparent transparent ${o.colors.error.main} transparent`,borderStyle:"solid"}}),horizontal:(0,a.css)(l,{marginLeft:"10px","&:before":{content:'""',position:"absolute",left:"-5px",top:"9px",width:0,height:0,borderWidth:"4px 5px 4px 0",borderColor:"transparent #e02f44 transparent transparent",borderStyle:"solid"}}),fieldValidationMessageIcon:(0,a.css)({marginRight:o.spacing()})}}},50426:(te,R,e)=>{"use strict";e.d(R,{l:()=>r});var n=e(74848),a=e(22803),s=e(96540),i=e(49785);function r({defaultValues:u,onSubmit:o,validateOnMount:l=!1,validateFieldsOnMount:g,children:f,validateOn:p="onSubmit",maxWidth:c=600,...x}){const{handleSubmit:v,trigger:m,formState:y,...h}=(0,i.mN)({mode:p,defaultValues:u});return(0,s.useEffect)(()=>{l&&m(g)},[m,g,l]),(0,n.jsx)("form",{className:(0,a.css)({maxWidth:c!=="none"?c+"px":c,width:"100%"}),onSubmit:v(o),...x,children:f({errors:y.errors,formState:y,trigger:m,...h})})}},18027:(te,R,e)=>{"use strict";e.d(R,{I:()=>l});var n=e(74848),a=e(22803),s=e(96540),i=e(63142),r=e(44019),u=e(12594),o=e(79233);const l=({children:f,label:p,tooltip:c,labelWidth:x="auto",invalid:v,loading:m,disabled:y,required:h,className:d,htmlFor:E,grow:b,shrink:D,error:C,transparent:P,interactive:M,validationMessageHorizontalOverflow:O,...j})=>{const U=(0,i.$j)(),W=g(U,b,D),B=E??(0,r.getChildId)(f),S=typeof p=="string"?(0,n.jsx)(o.c,{interactive:M,width:x,tooltip:c,htmlFor:B,transparent:P,children:`${p}${h?" *":""}`}):p;return(0,n.jsxs)("div",{className:(0,a.cx)(W.container,d),...j,children:[S,(0,n.jsxs)("div",{className:W.childContainer,children:[(0,s.cloneElement)(f,{invalid:v,disabled:y,loading:m}),v&&C&&(0,n.jsx)("div",{className:(0,a.cx)(W.fieldValidationWrapper,{[W.validationMessageHorizontalOverflow]:!!O}),children:(0,n.jsx)(u.P,{children:C})})]})]})};l.displayName="InlineField";const g=(f,p,c)=>({container:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",flex:`${p?1:0} ${c?1:0} auto`,margin:`0 ${f.spacing(.5)} ${f.spacing(.5)} 0`}),childContainer:(0,a.css)({flex:`${p?1:0} ${c?1:0} auto`}),fieldValidationWrapper:(0,a.css)({marginTop:f.spacing(.5)}),validationMessageHorizontalOverflow:(0,a.css)({width:0,overflowX:"visible","& > *":{whiteSpace:"nowrap"}})})},97095:(te,R,e)=>{"use strict";e.d(R,{C:()=>i});var n=e(74848),a=e(22803),s=e(63142);const i=({children:u,className:o,...l})=>{const g=(0,s.of)(r);return(0,n.jsx)("div",{className:(0,a.cx)(g.container,o),...l,children:u})},r=u=>({container:(0,a.css)({label:"InlineFieldRow",display:"flex",flexDirection:"row",flexWrap:"wrap",alignContent:"flex-start",rowGap:u.spacing(.5)})})},79233:(te,R,e)=>{"use strict";e.d(R,{c:()=>u});var n=e(74848),a=e(22803),s=e(63142),i=e(30703),r=e(45967);const u=({children:l,className:g,tooltip:f,width:p,transparent:c,interactive:x,as:v="label",...m})=>{const y=(0,s.of)(o,c,p);return(0,n.jsxs)(v,{className:(0,a.cx)(y.label,g),...m,children:[l,f&&(0,n.jsx)(r.m,{interactive:x,placement:"top",content:f,theme:"info",children:(0,n.jsx)(i.I,{tabIndex:0,name:"info-circle",size:"sm",className:y.icon})})]})},o=(l,g=!1,f)=>({label:(0,a.css)({display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0,padding:l.spacing(0,1),fontWeight:l.typography.fontWeightMedium,fontSize:l.typography.size.sm,backgroundColor:g?"transparent":l.colors.background.secondary,height:l.spacing(l.components.height.md),lineHeight:l.spacing(l.components.height.md),marginRight:l.spacing(.5),borderRadius:l.shape.radius.default,border:"none",width:f?f!=="auto"?`${8*f}px`:f:"100%",color:l.colors.text.primary}),icon:(0,a.css)({color:l.colors.text.secondary,marginLeft:"10px",":hover":{color:l.colors.text.primary}})})},83871:(te,R,e)=>{"use strict";e.d(R,{e:()=>i});var n=e(74848),a=e(22803),s=e(63142);const i=({children:u,className:o,grow:l,...g})=>{const f=(0,s.of)(r,l);return(0,n.jsx)("div",{className:(0,a.cx)(f.container,o),...g,children:u})};i.displayName="InlineSegmentGroup";const r=(u,o)=>({container:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",flex:`${o?1:0} 0 auto`,marginBottom:u.spacing(.5)})})},72636:(te,R,e)=>{"use strict";e.d(R,{J:()=>r,f:()=>u});var n=e(74848),a=e(22803),s=e(63142),i=e(30703);const r=({children:o,description:l,className:g,category:f,...p})=>{const c=(0,s.of)(u),x=f?.map((v,m)=>(0,n.jsxs)("span",{className:c.categories,children:[(0,n.jsx)("span",{children:v}),(0,n.jsx)(i.I,{name:"angle-right",className:c.chevron})]},`${v}/${m}`));return(0,n.jsx)("div",{className:(0,a.cx)(c.label,g),children:(0,n.jsxs)("label",{...p,children:[(0,n.jsxs)("div",{className:c.labelContent,children:[x,o]}),l&&(0,n.jsx)("span",{className:c.description,children:l})]})})},u=o=>({label:(0,a.css)({label:"Label",fontSize:o.typography.size.sm,fontWeight:o.typography.fontWeightMedium,lineHeight:1.25,marginBottom:o.spacing(.5),color:o.colors.text.primary,maxWidth:"480px"}),labelContent:(0,a.css)({display:"flex",alignItems:"center"}),description:(0,a.css)({label:"Label-description",color:o.colors.text.secondary,fontSize:o.typography.size.sm,fontWeight:o.typography.fontWeightRegular,marginTop:o.spacing(.25),display:"block"}),categories:(0,a.css)({label:"Label-categories",display:"inline-flex",alignItems:"center"}),chevron:(0,a.css)({margin:o.spacing(0,.25)})})},32581:(te,R,e)=>{"use strict";e.d(R,{O:()=>u,p:()=>o});var n=e(74848),a=e(46942),s=e.n(a),i=e(96540),r=e(75745),u=(l=>(l.Invalid="invalid",l.Valid="valid",l))(u||{});class o extends i.PureComponent{constructor(){super(...arguments),this.state={error:null},this.validatorAsync=g=>f=>{const p=(0,r.tf)(f.target.value,g);this.setState(c=>({...c,error:p?p[0]:null}))},this.populateEventPropsWithStatus=(g,f)=>{const p={...g};return f&&Object.keys(r.Pw).forEach(c=>{((0,r.K)(c,f)||g[c])&&(p[c]=async x=>{x.persist(),(0,r.K)(c,f)&&await this.validatorAsync(f[c]).apply(this,[x]),g[c]&&g[c].apply(null,[x,this.status])})}),p}}static{this.defaultProps={className:""}}get status(){return this.state.error?"invalid":"valid"}get isInvalid(){return this.status==="invalid"}render(){const{validationEvents:g,className:f,hideErrorMessage:p,inputRef:c,...x}=this.props,{error:v}=this.state,m=s()("gf-form-input",{invalid:this.isInvalid},f),y=this.populateEventPropsWithStatus(x,g);return(0,n.jsxs)("div",{style:{flexGrow:1},children:[(0,n.jsx)("input",{...y,ref:c,className:m}),v&&!p&&(0,n.jsx)("span",{children:v})]})}}},53487:(te,R,e)=>{"use strict";e.d(R,{s:()=>r});var n=e(74848),a=e(22803),s=e(63142);const i=u=>({legend:(0,a.css)({fontSize:u.typography.h3.fontSize,fontWeight:u.typography.fontWeightRegular,margin:u.spacing(0,0,2,0)})}),r=({children:u,className:o,...l})=>{const g=(0,s.of)(i);return(0,n.jsx)("legend",{className:(0,a.cx)(g.legend,o),...l,children:u})}},77824:(te,R,e)=>{"use strict";e.d(R,{z:()=>m});var n=e(74848),a=e(22803),s=e(2543),i=e(96540),r=e(30360),u=e(63142),o=e(30703),l=e(51898),g=e(35484),f=e(45967),p=e(3343);const c=2,x=i.forwardRef(({children:h,active:d=!1,disabled:E=!1,size:b="md",onChange:D,onClick:C,id:P,name:M=void 0,description:O,fullWidth:j,"aria-label":U},W)=>{const B=(0,u.of)(v,b,j),S=(0,n.jsx)("input",{type:"radio",className:B.radio,onChange:D,onClick:C,disabled:E,id:P,checked:d,name:M,"aria-label":U,ref:W});return O?(0,n.jsxs)("div",{className:B.radioOption,"data-testid":l.Tp.components.RadioButton.container,children:[(0,n.jsx)(f.m,{content:O,placement:"bottom",children:S}),(0,n.jsx)("label",{className:B.radioLabel,htmlFor:P,title:O||U,children:h})]}):(0,n.jsxs)("div",{className:B.radioOption,"data-testid":l.Tp.components.RadioButton.container,children:[S,(0,n.jsx)("label",{className:B.radioLabel,htmlFor:P,title:O||U,children:h})]})});x.displayName="RadioButton";const v=(h,d,E)=>{const{fontSize:b,height:D,padding:C}=(0,p.SM)(d,h),P=h.colors.text.secondary,M=h.colors.text.primary,O=D*h.spacing.gridSize-4-2;return{radioOption:(0,a.css)({display:"flex",justifyContent:"space-between",position:"relative",flex:E?"1 0 0":"none",textAlign:"center"}),radio:(0,a.css)({position:"absolute",opacity:0,zIndex:2,width:"100% !important",height:"100%",cursor:"pointer","&:checked + label":{color:h.colors.text.primary,fontWeight:h.typography.fontWeightMedium,background:h.colors.action.selected,zIndex:1},"&:focus + label, &:focus-visible + label":(0,g.getFocusStyles)(h),"&:focus:not(:focus-visible) + label":(0,g.getMouseFocusStyles)(h),"&:disabled + label":{color:h.colors.text.disabled,cursor:"not-allowed"}}),radioLabel:(0,a.css)({display:"flex",alignItems:"center",justifyContent:"center",fontSize:b,height:`${O}px`,lineHeight:`${O}px`,color:P,padding:h.spacing(0,C),borderRadius:(0,g.getInternalRadius)(h,c),background:h.colors.background.primary,cursor:"pointer",userSelect:"none",whiteSpace:"nowrap",flexGrow:1,"&:hover":{color:M}})}};function m({options:h,value:d,onChange:E,onClick:b,disabled:D,disabledOptions:C,size:P="md",id:M,className:O,fullWidth:j=!1,autoFocus:U=!1,"aria-label":W,invalid:B=!1}){const S=(0,i.useCallback)(N=>()=>{E&&E(N.value)},[E]),_=(0,i.useCallback)(N=>()=>{b&&b(N.value)},[b]),K=M??(0,s.uniqueId)("radiogroup-"),T=(0,i.useRef)(K),L=(0,u.of)(y),A=(0,i.useRef)(null);return(0,i.useEffect)(()=>{U&&A.current&&A.current.focus()},[U]),(0,n.jsx)("div",{role:"radiogroup","aria-label":W,className:(0,a.cx)(L.radioGroup,j&&L.fullWidth,B&&L.invalid,O),children:h.map((N,V)=>{const z=C&&N.value&&C.includes(N.value),w=N.icon?(0,r.Uo)(N.icon):void 0,H=!!(N.imgUrl||N.label||N.component);return(0,n.jsxs)(x,{size:P,disabled:z||D,active:d===N.value,"aria-label":N.ariaLabel,onChange:S(N),onClick:_(N),id:`option-${N.value}-${K}`,name:T.current,description:N.description,fullWidth:j,ref:d===N.value?A:void 0,children:[w&&(0,n.jsx)(o.I,{name:w,className:(0,a.cx)(H&&L.icon)}),N.imgUrl&&(0,n.jsx)("img",{src:N.imgUrl,alt:N.label,className:L.img}),N.label," ",N.component?(0,n.jsx)(N.component,{}):null]},`o.label-${V}`)})})}m.displayName="RadioButtonGroup";const y=h=>({radioGroup:(0,a.css)({backgroundColor:h.colors.background.primary,display:"inline-flex",flexDirection:"row",flexWrap:"nowrap",border:`1px solid ${h.components.input.borderColor}`,borderRadius:h.shape.radius.default,padding:c,"&:hover":{borderColor:h.components.input.borderHover}}),fullWidth:(0,a.css)({display:"flex",flexGrow:1}),icon:(0,a.css)({marginRight:"6px"}),img:(0,a.css)({width:h.spacing(2),height:h.spacing(2),marginRight:h.spacing(1)}),invalid:(0,a.css)({border:`1px solid ${h.colors.error.border}`})})},45450:(te,R,e)=>{"use strict";e.d(R,{J:()=>i});var n=e(74848),a=e(22803),s=e(63142);const i=({id:u,name:o,label:l,checked:g,value:f,disabled:p,description:c,onChange:x,...v})=>{const m=(0,s.of)(r);return(0,n.jsxs)("label",{title:c,className:m.label,children:[(0,n.jsx)("input",{...v,id:u,name:o,type:"radio",checked:g,value:f,disabled:p,className:m.input,onChange:()=>x&&x(u)}),(0,n.jsxs)("div",{children:[l,c&&(0,n.jsx)("div",{className:m.description,children:c})]})]})},r=u=>({input:(0,a.css)({position:"relative",appearance:"none",outline:"none",backgroundColor:u.colors.background.canvas,width:`${u.spacing(2)} !important`,height:u.spacing(2),border:`1px solid ${u.colors.border.medium}`,borderRadius:u.shape.radius.circle,cursor:"pointer",margin:"3px 0",":checked":{backgroundColor:u.v1.palette.white,border:`5px solid ${u.colors.primary.main}`},":disabled":{backgroundColor:`${u.colors.action.disabledBackground} !important`,borderColor:u.colors.border.weak},":disabled:checked":{border:`1px solid ${u.colors.border.weak}`},":disabled:checked::after":{content:'""',width:"6px",height:"6px",backgroundColor:u.colors.text.disabled,borderRadius:u.shape.radius.circle,display:"inline-block",position:"absolute",top:"4px",left:"4px"},":focus":{outline:"none !important",boxShadow:`0 0 0 1px ${u.colors.background.canvas}, 0 0 0 3px ${u.colors.primary.main}`}}),label:(0,a.css)({fontSize:u.typography.fontSize,lineHeight:"22px",display:"grid",gridTemplateColumns:`${u.spacing(2)} auto`,gap:u.spacing(1),cursor:"pointer"}),description:(0,a.css)({fontSize:u.typography.size.sm,color:u.colors.text.secondary})})},16203:(te,R,e)=>{"use strict";e.d(R,{a:()=>o});var n=e(74848),a=e(22803),s=e(2543),i=e.n(s),r=e(63142),u=e(45450);function o({name:g,id:f,options:p,value:c,onChange:x,className:v,disabled:m,disabledOptions:y=[]}){const h=(0,r.of)(l),d=f??(0,s.uniqueId)("radiogroup-list-");return(0,n.jsx)("div",{id:f,className:(0,a.cx)(h.container,v),role:"radiogroup",children:p.map((E,b)=>{const D=`${d}-${b}`,C=c&&c===E.value,P=m||y.some(O=>O===E.value),M=()=>x&&E.value&&x(E.value);return(0,n.jsx)(u.J,{id:D,name:g,label:E.label,description:E.description,checked:C,value:E.value,disabled:P,onChange:M},b)})})}const l=g=>({container:(0,a.css)({display:"grid",gap:g.spacing(1)})})},18627:(te,R,e)=>{"use strict";e.d(R,{_:()=>y});var n=e(74848),a=e(34796),s=e.n(a),i=e(96540),r=e(55386),u=e(48588),o=e(33553),l=e(739),g=e(53568),f=e(45861),p=e(64394),c=e(36394);const x={mode:o.O.Absolute,steps:[{value:-1/0,color:"green"},{value:80,color:"red"}]};function v(h,d,E,b){const D=E!=null,C=b===l.wV.Vertical?d:h,P=Math.min(C*.15/1.5,20),M=P*1.5,O=D?d-M:d,j=Math.min(O,h);return{showLabel:D,gaugeHeight:j,titleFontSize:P}}function m(h,d,E,b){if(d.color?.mode!==p.Y.Thresholds)return[{value:d.min??u.tw,color:E.color??p.F}];const D=d.thresholds??x,C=D.mode===o.O.Percentage,P=D.steps;let M=d.min??u.tw,O=d.max??u.d1;C&&(M=0,O=100);const j=(0,c.yQ)(M,P),U=(0,c.yQ)(O,P),W=[{value:+M.toFixed(h),color:b.visualization.getColorByName(j.color)}];let B=!0;for(let S=0;S<P.length;S++){const _=P[S];if(B){j===_&&(B=!1);continue}const K=P[S-1];if(W.push({value:_.value,color:b.visualization.getColorByName(K.color)}),_===U)break}return W.push({value:+O.toFixed(h),color:b.visualization.getColorByName(U.color)}),W}class y extends i.PureComponent{constructor(){super(...arguments),this.canvasElement=null,this.renderVisualization=()=>{const{width:d,value:E,height:b,onClick:D,text:C,theme:P,orientation:M}=this.props,O=v(d,b,E.title,M),j=M===l.wV.Vertical?`${O.gaugeHeight}px`:"100%",U=(0,n.jsx)("div",{style:{height:`${O.gaugeHeight}px`,width:j},ref:W=>this.canvasElement=W});return(0,n.jsxs)(n.Fragment,{children:[D?(0,n.jsx)("button",{className:(0,f.my)(P),type:"button",onClick:D,children:U}):U,O.showLabel&&(0,n.jsx)("div",{style:{textAlign:"center",fontSize:C?.titleSize??O.titleFontSize,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",position:"relative",width:j,top:"-4px",cursor:"default"},children:E.title})]})}}static{this.defaultProps={showThresholdMarkers:!0,showThresholdLabels:!1,field:{min:0,max:100,thresholds:x}}}componentDidMount(){this.draw()}componentDidUpdate(){this.draw()}draw(){const{field:d,showThresholdLabels:E,showThresholdMarkers:b,width:D,height:C,theme:P,value:M,orientation:O}=this.props,j=v(D,C,M.title),U=O===l.wV.Vertical?j.gaugeHeight:D,W=Math.min(U,j.gaugeHeight),B=P.colors.background.secondary,S=E?1.5:1,_=Math.min(W/5.5,40)/S,K=_/5,T=(0,r.cN)(M),A=Math.min(U,W*1.3)*.9-((_+(b?K:0)+(E?10:0))*2+10),N=this.props.text?.valueSize??(0,g.Vr)(T,A,W,1,_*1.7),V=Math.max(N/2.5,12);let z=d.min??u.tw,w=d.max??u.d1,H=M.numeric;d.thresholds?.mode===o.O.Percentage&&(z=0,w=100,M.percent===void 0?H=(H-z)/(w-z)*100:H=M.percent*100);const Q=d.decimals===void 0?2:d.decimals;b&&(z=+z.toFixed(Q),w=+w.toFixed(Q));const Z={series:{gauges:{gauge:{min:z,max:w,neutralValue:d.custom?.neutral,background:{color:B},border:{color:null},shadow:{show:!1},width:_},frame:{show:!1},label:{show:!1},layout:{margin:0,thresholdWidth:0,vMargin:0},cell:{border:{width:0}},threshold:{values:m(Q,d,M,P),label:{show:E,margin:K+1,font:{size:V}},show:b,width:K},value:{color:M.color,formatter:()=>T,font:{size:N,family:P.typography.fontFamily}},show:!0}}},Y={data:[[0,H]],label:M.title};try{this.canvasElement&&s().plot(this.canvasElement,[Y],Z)}catch(X){console.error("Gauge rendering error",X,Z,M)}}render(){return(0,n.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",overflow:"hidden"},className:this.props.className,children:this.renderVisualization()})}}},79331:(te,R,e)=>{"use strict";e.d(R,{w:()=>o});var n=e(74848),a=e(22803),s=e(96540),i=e(63142),r=e(34999),u=e(30703);const o=s.memo(s.forwardRef(({title:g,className:f,children:p,branded:c,url:x,urlTitle:v,onDismiss:m,severity:y="info",...h},d)=>{const E=(0,i.of)(l);return(0,n.jsxs)(r.F,{severity:y,className:f,...h,ref:d,title:g,children:[(0,n.jsx)("div",{children:p}),x&&(0,n.jsxs)("a",{href:x,className:(0,a.cx)("external-link",E.docsLink),target:"_blank",rel:"noreferrer",children:[(0,n.jsx)(u.I,{name:"book"})," ",v||"Read more"]})]})}));o.displayName="InfoBox";const l=g=>({docsLink:(0,a.css)({display:"inline-block",marginTop:g.spacing(2)})})},53371:(te,R,e)=>{"use strict";e.d(R,{r:()=>f});var n=e(74848),a=e(22803),s=e(34743),i=e(83505),r=e(46885),u=e(96540),o=e(63142),l=e(30703),g=e(15245);function f({referenceElement:x,children:v,suffixIcon:m,placement:y}){const h=(0,o.of)(p),d=(0,o.$j)(),E=[(0,s.cY)(8),(0,s.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,s.BN)()],{context:b,refs:D,floatingStyles:C}=(0,i.we)({open:!0,placement:y,middleware:E,whileElementsMounted:r.ll,strategy:"fixed"});(0,u.useLayoutEffect)(()=>{D.setReference(x)},[x,D]);const{styles:P}=(0,i.DL)(b,{initial:({side:M})=>({opacity:0,transform:c(M,d)}),duration:d.transitions.duration.shortest});return(0,n.jsx)(g.ZL,{children:(0,n.jsx)("div",{style:{display:"inline-block",...C},ref:D.setFloating,"aria-live":"polite",children:(0,n.jsxs)("span",{className:(0,a.cx)(h.root),style:P,children:[v&&(0,n.jsx)("span",{children:v}),m&&(0,n.jsx)(l.I,{name:m})]})})})}const p=x=>({root:(0,a.css)({...x.typography.bodySmall,willChange:"transform",background:x.components.tooltip.background,color:x.components.tooltip.text,padding:x.spacing(.5,1.5),borderRadius:x.shape.radius.pill,display:"inline-flex",gap:x.spacing(.5),alignItems:"center"})}),c=(x,v)=>{switch(x){case"top":return`translateY(${v.spacing(1)})`;case"bottom":return`translateY(-${v.spacing(1)})`;case"left":return`translateX(${v.spacing(1)})`;case"right":return`translateX(-${v.spacing(1)})`}}},33033:(te,R,e)=>{"use strict";e.d(R,{D:()=>u});var n=e(74848),a=e(96540),s=e(53568),i=e(74660),r=e(63527);const u=a.forwardRef((g,f)=>{const{defaultValue:p="",minWidth:c=10,maxWidth:x,onCommitChange:v,onChange:m,onKeyDown:y,onBlur:h,value:d,placeholder:E,...b}=g,[D,C]=l(d,m),P=D??p,M=(0,a.useMemo)(()=>{const O=P||E||"",j=typeof O=="string"?O:O.toString();return o(j,c,x)},[E,P,c,x]);return(0,n.jsx)(i.W.Provider,{value:!0,children:(0,n.jsx)(r.p,{"data-testid":"autosize-input",...b,placeholder:E,ref:f,value:P.toString(),onChange:O=>{m&&m(O),C(O.currentTarget.value)},width:M,onBlur:O=>{h?h(O):v&&v(O)},onKeyDown:O=>{y?y(O):O.key==="Enter"&&v&&v(O)}})})});function o(g,f,p){if(!g)return f;const x=(0,s.kD)(g.toString(),14).width/8+3;return f&&x<f?f:p&&x>p?p:x}u.displayName="AutoSizeInput";function l(g,f){const p=g!==void 0&&f!==void 0,c=(0,a.useRef)(p),x=(0,a.useRef)(!1);p!==c.current&&!x.current&&(console.warn("An AutoSizeInput is changing from an uncontrolled to a controlled input. If you want to control the input, the empty value should be an empty string."),x.current=!0);const[v,m]=a.useState(g);(0,a.useEffect)(()=>{c.current||m(g)},[g]);const y=(0,a.useCallback)(d=>{c.current||m(d)},[]);return[c.current?g:v,y]}},26987:(te,R,e)=>{"use strict";e.d(R,{e:()=>a});var n=e(49785);const a=n.xI},27594:(te,R,e)=>{"use strict";e.d(R,{j:()=>E});var n=e(74848),a=e(22803),s=e(2543),i=e(96540),r=e(32885),u=e(28105),o=e(63142),l=e(30703),g=e(34213),f=e(45967),p=e(92745),c=e(76319);const x=(0,a.css)({display:"flex",alignItems:"center",height:"100%"});function v({row:P,__rowID:M}){return(0,n.jsx)("div",{className:x,children:(0,n.jsx)(c.K,{tooltip:(0,p.t)("grafana-ui.interactive-table.expand-row-tooltip","Toggle row expanded"),"aria-controls":M,name:P.isExpanded?"angle-down":"angle-right","aria-expanded":P.isExpanded,...P.getToggleRowExpandedProps(),size:"lg"})})}function m({isAllRowsExpanded:P,toggleAllRowsExpanded:M}){return(0,n.jsx)("div",{className:x,children:(0,n.jsx)(c.K,{"aria-label":P?(0,p.t)("grafana-ui.interactive-table.aria-label-collapse-all","Collapse all rows"):(0,p.t)("grafana-ui.interactive-table.aria-label-expand-all","Expand all rows"),name:P?"table-collapse-all":"table-expand-all",onClick:()=>M(),size:"lg",tooltip:P?(0,p.t)("grafana-ui.interactive-table.tooltip-collapse-all","Collapse all rows"):(0,p.t)("grafana-ui.interactive-table.tooltip-expand-all","Expand all rows"),variant:"secondary"})})}const y="__expander";function h(P,M=!1){return[{id:y,Cell:v,...M&&{Header:m},disableSortBy:!0,width:0},...P.map(O=>({id:O.id,accessor:O.id,Header:O.header||(()=>null),sortType:O.sortType||"alphanumeric",disableSortBy:!O.sortType,width:O.disableGrow?0:void 0,visible:O.visible,...O.cell&&{Cell:O.cell}}))]}const d=P=>{const M=P.colors.emphasize(P.colors.background.primary,.03);return{container:(0,a.css)({display:"flex",gap:P.spacing(2),flexDirection:"column",width:"100%",overflowX:"auto"}),cell:(0,a.css)({padding:P.spacing(1),minWidth:P.spacing(3)}),table:(0,a.css)({borderRadius:P.shape.radius.default,width:"100%"}),disableGrow:(0,a.css)({width:0}),header:(0,a.css)({borderBottom:`1px solid ${P.colors.border.weak}`,minWidth:P.spacing(3),"&, & > button":{position:"relative",whiteSpace:"nowrap",padding:P.spacing(1)},"& > button":{"&:after":{content:'"\\00a0"'},width:"100%",height:"100%",background:"none",border:"none",paddingRight:P.spacing(2.5),textAlign:"left",fontWeight:P.typography.fontWeightMedium}}),row:(0,a.css)({label:"row",borderBottom:`1px solid ${P.colors.border.weak}`,"&:hover":{backgroundColor:M},"&:last-child":{borderBottom:0}}),expandedRow:(0,a.css)({label:"expanded-row-content",borderBottom:"none"}),expandedContentCell:(0,a.css)({borderBottom:`1px solid ${P.colors.border.weak}`,position:"relative",padding:P.spacing(2,2,2,5),"&:before":{content:'""',position:"absolute",width:"1px",top:0,left:"16px",bottom:P.spacing(2),background:P.colors.border.medium}}),expandedContentRow:(0,a.css)({label:"expanded-row-content"}),sortableHeader:(0,a.css)({"&&":{padding:0}})}};function E({className:P,columns:M,data:O,getRowId:j,headerTooltips:U,pageSize:W=0,renderExpandedRow:B,showExpandAll:S=!1,fetchData:_,initialSortBy:K=[]}){const T=(0,o.of)(d),L=(0,i.useMemo)(()=>h(M,S),[M,S]),A=b(),N=(0,i.useCallback)(J=>`${A}-${J.id}`.replace(/\s/g,""),[A]),V=[r.useSortBy,r.useExpanded],z=O.length>W,w=W>0;w&&V.push(r.usePagination);const H=(0,r.useTable)({columns:L,data:O,autoResetExpanded:!1,autoResetSortBy:!1,disableMultiSort:!0,manualSortBy:!!_,getRowId:j,initialState:{hiddenColumns:[!B&&y,...L.filter(J=>!(!J.visible||J.visible(O))).map(J=>J.id).filter(u.zz)].filter(u.zz),sortBy:K}},...V),{getTableProps:Q,getTableBodyProps:Z,headerGroups:Y,prepareRow:X}=H,{sortBy:I}=H.state;return(0,i.useEffect)(()=>{_&&_({sortBy:I})},[I,_]),(0,i.useEffect)(()=>{w&&H.setPageSize(W)},[w,W,H.setPageSize,H]),(0,n.jsxs)("div",{className:T.container,children:[(0,n.jsxs)("table",{...Q(),className:(0,a.cx)(T.table,P),children:[(0,n.jsx)("thead",{children:Y.map(J=>{const{key:ee,...q}=J.getHeaderGroupProps();return(0,n.jsx)("tr",{...q,children:J.headers.map(ne=>{const{key:se,...oe}=ne.getHeaderProps(),de=U?.[ne.id];return(0,n.jsx)("th",{className:(0,a.cx)(T.header,{[T.disableGrow]:ne.width===0,[T.sortableHeader]:ne.canSort}),...oe,...ne.isSorted&&{"aria-sort":ne.isSortedDesc?"descending":"ascending"},children:(0,n.jsx)(C,{column:ne,headerTooltip:de})},se)})},ee)})}),(0,n.jsx)("tbody",{...Z(),children:(w?H.page:H.rows).map(J=>{X(J);const{key:ee,...q}=J.getRowProps(),ne=N(J),se=J.isExpanded;return(0,n.jsxs)(i.Fragment,{children:[(0,n.jsx)("tr",{...q,className:(0,a.cx)(T.row,se&&T.expandedRow),children:J.cells.map(oe=>{const{key:de,...fe}=oe.getCellProps();return(0,n.jsx)("td",{className:T.cell,...fe,children:oe.render("Cell",{__rowID:ne})},de)})}),se&&B&&(0,n.jsx)("tr",{...q,id:ne,className:T.expandedContentRow,children:(0,n.jsx)("td",{className:T.expandedContentCell,colSpan:J.cells.length,children:B(J.original)})})]},ee)})})]}),w&&z&&(0,n.jsx)("span",{children:(0,n.jsx)(g.d,{currentPage:H.state.pageIndex+1,numberOfPages:H.pageOptions.length,onNavigate:J=>H.gotoPage(J-1)})})]})}const b=()=>(0,i.useMemo)(()=>(0,s.uniqueId)("InteractiveTable"),[]),D=P=>({sortIcon:(0,a.css)({position:"absolute",top:P.spacing(1)}),headerTooltipIcon:(0,a.css)({marginLeft:P.spacing(.5)})});function C({column:{canSort:P,render:M,isSorted:O,isSortedDesc:j,getSortByToggleProps:U},headerTooltip:W}){const B=(0,o.of)(D),{onClick:S}=U(),_=(0,n.jsxs)(n.Fragment,{children:[M("Header"),W&&(0,n.jsx)(f.m,{theme:"info-alt",content:W.content,placement:"top-end",children:(0,n.jsx)(l.I,{className:B.headerTooltipIcon,name:W.iconName||"info-circle","data-testid":"header-tooltip-icon"})}),O&&(0,n.jsx)("span",{"aria-hidden":"true",className:B.sortIcon,children:(0,n.jsx)(l.I,{name:j?"angle-down":"angle-up"})})]});return P?(0,n.jsx)("button",{type:"button",onClick:S,children:_}):_}},50275:(te,R,e)=>{"use strict";e.d(R,{B:()=>i});var n=e(74848),a=e(96540),s=e(22658);class i extends a.PureComponent{constructor(){super(...arguments),this.wrapperRef=(0,a.createRef)(),this.renderJson=()=>{const{json:u,config:o,open:l,onDidRender:g}=this.props,f=this.wrapperRef.current,p=new s.O(u,l,o);f.hasChildNodes()?f.replaceChild(p.render(),f.lastChild):f.appendChild(p.render()),g&&g(p.json)}}static{this.defaultProps={open:3,config:{animateOpen:!0}}}componentDidMount(){this.renderJson()}componentDidUpdate(){this.renderJson()}render(){const{className:u}=this.props;return(0,n.jsx)("div",{className:u,ref:this.wrapperRef})}}},22658:(te,R,e)=>{"use strict";e.d(R,{O:()=>h});var n=e(2543);function a(d){return d.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function s(d){return!!d&&typeof d==="object"}function i(d){if(d===void 0)return"";if(d===null||typeof d=="object"&&!d.constructor)return"Object";const b=/function ([^(]*)/.exec(d.constructor.toString());return b&&b.length>1?b[1]:""}function r(d){return d===null?"null":typeof d}function u(d,E){const b=r(d);return b==="null"||b==="undefined"?b:(b==="string"&&(E='"'+a(E)+'"'),b==="function"?d.toString().replace(/[\r\n]/g,"").replace(/\{.*\}/,"")+"{\u2026}":E)}let o="";function l(d){return s(d)?(o=i(d),Array.isArray(d)&&(o+="["+d.length+"]")):o=u(d,d.toString()),o}function g(d){return`json-formatter-${d}`}function f(d,E,b){const D=document.createElement(d);return E&&D.classList.add(g(E)),b!==void 0&&(b instanceof Node?D.appendChild(b):D.appendChild(document.createTextNode(String(b)))),D}const p=/(^\d{1,4}[\.|\\/|-]\d{1,2}[\.|\\/|-]\d{1,4})(\s*(?:0?[1-9]:[0-5]|1(?=[012])\d:[0-5])\d\s*[ap]m)?$/,c=/\d{2}:\d{2}:\d{2} GMT-\d{4}/,x=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/,v=10,m=typeof window<"u"&&window.requestAnimationFrame||(d=>(d(),0)),y={animateOpen:!0,animateClose:!0};class h{constructor(E,b=1,D=y,C){this.json=E,this.open=b,this.config=D,this.key=C,this._isOpen=null,this.element=null,this.skipChildren=!1}get isOpen(){return this._isOpen!==null?this._isOpen:this.open>0}set isOpen(E){this._isOpen=E}get isDate(){return this.type==="string"&&(p.test(this.json)||x.test(this.json)||c.test(this.json))}get isUrl(){return this.type==="string"&&this.json.indexOf("http")===0}get isArray(){return Array.isArray(this.json)}get isObject(){return s(this.json)}get isEmptyObject(){return!this.keys.length&&!this.isArray}get isEmpty(){return this.isEmptyObject||this.keys&&!this.keys.length&&this.isArray}get hasKey(){return typeof this.key<"u"}get constructorName(){return i(this.json)}get type(){return r(this.json)}get keys(){return this.isObject?Object.keys(this.json).map(E=>E||'""'):[]}toggleOpen(){this.isOpen=!this.isOpen,this.element&&(this.isOpen?this.appendChildren(this.config.animateOpen):this.removeChildren(this.config.animateClose),this.element.classList.toggle(g("open")))}openAtDepth(E=1){E<0||(this.open=E,this.isOpen=E!==0,this.element&&(this.removeChildren(!1),E===0?this.element.classList.remove(g("open")):(this.appendChildren(this.config.animateOpen),this.element.classList.add(g("open")))))}isNumberArray(){return this.json.length>0&&this.json.length<4&&((0,n.isNumber)(this.json[0])||(0,n.isNumber)(this.json[1]))}renderArray(){const E=f("span");return E.appendChild(f("span","bracket","[")),this.isNumberArray()?(this.json.forEach((b,D)=>{D>0&&E.appendChild(f("span","array-comma",",")),E.appendChild(f("span","number",b))}),this.skipChildren=!0):E.appendChild(f("span","number",this.json.length)),E.appendChild(f("span","bracket","]")),E}render(E=!1){this.element=f("div","row");const b=f("a","toggler-link"),D=f("span","toggler");if(this.isObject&&b.appendChild(D),this.hasKey&&b.appendChild(f("span","key",`${this.key}:`)),this.isObject){const P=f("span","value"),M=f("span"),O=f("span","constructor-name",this.constructorName);if(M.appendChild(O),this.isArray){const j=this.renderArray();M.appendChild(j)}P.appendChild(M),b.appendChild(P)}else{const P=this.isUrl?f("a"):f("span");P.classList.add(g(this.type)),this.isDate&&P.classList.add(g("date")),this.isUrl&&(P.classList.add(g("url")),P.setAttribute("href",this.json));const M=u(this.json,this.json);P.appendChild(document.createTextNode(M)),b.appendChild(P)}const C=f("div","children");return this.isObject&&C.classList.add(g("object")),this.isArray&&C.classList.add(g("array")),this.isEmpty&&C.classList.add(g("empty")),this.config&&this.config.theme&&this.element.classList.add(g(this.config.theme)),this.isOpen&&this.element.classList.add(g("open")),E||this.element.appendChild(b),this.skipChildren?b.removeChild(D):this.element.appendChild(C),this.isObject&&this.isOpen&&this.appendChildren(),this.isObject&&b.addEventListener("click",this.toggleOpen.bind(this)),this.element}appendChildren(E=!1){const b=this.element&&this.element.querySelector(`div.${g("children")}`);if(!(!b||this.isEmpty))if(E){let D=0;const C=()=>{const P=this.keys[D],M=new h(this.json[P],this.open-1,this.config,P);b.appendChild(M.render()),D+=1,D<this.keys.length&&(D>v?C():m(C))};m(C)}else this.keys.forEach(D=>{const C=new h(this.json[D],this.open-1,this.config,D);b.appendChild(C.render())})}removeChildren(E=!1){const b=this.element&&this.element.querySelector(`div.${g("children")}`);if(E){let D=0;const C=()=>{b&&b.children.length&&(b.removeChild(b.children[0]),D+=1,D>v?C():m(C))};m(C)}else b&&(b.innerHTML="")}}},13943:(te,R,e)=>{"use strict";e.d(R,{x:()=>u});var n=e(74848),a=e(22803),s=e(96540),i=e(63142),r=e(43990);const u=(0,s.forwardRef)((l,g)=>{const{alignItems:f,children:p,gap:c,rowGap:x,columnGap:v,columns:m,minColumnWidth:y,...h}=l,d=(0,i.of)(o,c,x,v,m,y,f);return(0,n.jsx)("div",{ref:g,...h,className:d.grid,children:p})});u.displayName="Grid";const o=(l,g,f,p,c,x,v)=>({grid:(0,a.css)([{display:"grid"},(0,r.Y)(l,g,m=>({gap:l.spacing(m)})),(0,r.Y)(l,f,m=>({rowGap:l.spacing(m)})),(0,r.Y)(l,p,m=>({columnGap:l.spacing(m)})),x&&(0,r.Y)(l,x,m=>({gridTemplateColumns:`repeat(auto-fill, minmax(${l.spacing(m)}, 1fr))`})),c&&(0,r.Y)(l,c,m=>({gridTemplateColumns:`repeat(${m}, 1fr)`})),(0,r.Y)(l,v,m=>({alignItems:m}))])})},32881:(te,R,e)=>{"use strict";e.d(R,{Gy:()=>o,gW:()=>l,mc:()=>g});var n=e(74848),a=e(22803),s=e(96540),i=e(63142),r=(x=>(x[x.Horizontal=0]="Horizontal",x[x.Vertical=1]="Vertical",x))(r||{});const u=({children:x,orientation:v=0,spacing:m="sm",justify:y="flex-start",align:h="normal",wrap:d=!1,width:E="100%",height:b="100%",...D})=>{const C=(0,i.of)(f,v,m,y,h,d);return(0,n.jsx)("div",{className:C.layout,style:{width:E,height:b},...D,children:s.Children.toArray(x).filter(Boolean).map((P,M)=>(0,n.jsx)("div",{className:C.childWrapper,children:P},M))})},o=({children:x,spacing:v,justify:m,align:y="center",wrap:h,width:d,height:E})=>(0,n.jsx)(u,{spacing:v,justify:m,orientation:0,align:y,width:d,height:E,wrap:h,children:x}),l=({children:x,spacing:v,justify:m,align:y,width:h,height:d})=>(0,n.jsx)(u,{spacing:v,justify:m,orientation:1,align:y,width:h,height:d,children:x}),g=({children:x,padding:v,margin:m,grow:y,shrink:h})=>{const d=(0,i.of)(c,v,m);return(0,n.jsx)("div",{className:(0,a.cx)(d.wrapper,y!==void 0&&(0,a.css)({flexGrow:y}),h!==void 0&&(0,a.css)({flexShrink:h})),children:x})},f=(x,v,m,y,h,d)=>{const E=m!=="none"?x.spacing(p[m]):0,b=v===0&&!d||v===1?0:`-${E}`,D=v===1?"vertical-group":"horizontal-group";return{layout:(0,a.css)({label:D,display:"flex",flexDirection:v===1?"column":"row",flexWrap:d?"wrap":"nowrap",justifyContent:y,alignItems:h,height:"100%",maxWidth:"100%",marginBottom:b}),childWrapper:(0,a.css)({label:"layoutChildrenWrapper",marginBottom:v===0&&!d?0:E,marginRight:v===0?E:0,display:"flex",alignItems:h,"&:last-child":{marginBottom:v===1?0:void 0,marginRight:v===0?0:void 0}})}},p={none:0,xs:.5,sm:1,md:2,lg:3},c=(x,v,m)=>{const y=v&&v!=="none"&&x.spacing(p[v])||0,h=m&&m!=="none"&&x.spacing(p[m])||0;return{wrapper:(0,a.css)({label:"container",margin:h,padding:y})}}},35137:(te,R,e)=>{"use strict";e.d(R,{$:()=>s});var n=e(74848),a=e(31286);const s=({v:i=0,h:r=0,layout:u})=>(0,n.jsx)(a.a,{paddingRight:r,paddingBottom:i,display:u==="inline"?"inline-block":"block"})},20941:(te,R,e)=>{"use strict";e.d(R,{N:()=>u});var n=e(74848),a=e(96540),s=e(35557),i=e(92138),r=e(63704);const u=(0,a.forwardRef)(({href:o,children:l,...g},f)=>{const p=i.I.stripBaseFromUrl(r.sQ.sanitizeUrl(o??""));return(0,n.jsx)(s.Link,{ref:f,to:p,...g,children:l})});u.displayName="Link"},89640:(te,R,e)=>{"use strict";e.d(R,{Y:()=>p});var n=e(74848),a=e(22803),s=e(96540),i=e(63704),r=e(92138),u=e(63142),o=e(30703),l=e(66969),g=e(20941);const f={h1:"xl",h2:"xl",h3:"lg",h4:"lg",h5:"md",h6:"md",body:"md",bodySmall:"xs"},p=(0,s.forwardRef)(({href:x,color:v="link",external:m=!1,inline:y=!0,variant:h="body",weight:d,icon:E,children:b,...D},C)=>{const P=i.sQ.sanitizeUrl(x??""),M=(0,u.$j)(),O=c(M,y,h,d,v),j=E||"external-link-alt";if(m)return(0,n.jsxs)("a",{href:P,ref:C,...D,target:"_blank",rel:"noreferrer",className:O,children:[b,(0,n.jsx)(o.I,{size:f[h]||"md",name:j})]});const U=r.I.stripBaseFromUrl(P);return(0,n.jsxs)(g.N,{ref:C,href:U,...D,className:O,children:[b,E&&(0,n.jsx)(o.I,{name:E,size:f[h]||"md"})]})});p.displayName="TextLink";const c=(x,v,m,y,h)=>(0,a.css)([m&&{...x.typography[m]},y&&{fontWeight:(0,l.iV)(y,x)},h&&{color:x.colors.text[h]},{alignItems:"center",gap:"0.25em",display:"inline-flex",textDecoration:"none","&:hover":{textDecoration:"underline",color:x.colors.text.link}},v&&{textDecoration:"underline","&:hover":{textDecoration:"none"}}])},46559:(te,R,e)=>{"use strict";e.d(R,{p:()=>u});var n=e(74848),a=e(22803),s=e(96540),i=e(65240);const r=(0,i.N)((o=!1)=>({list:(0,a.css)({listStyleType:"none",margin:0,padding:0}),item:(0,a.css)({display:o&&"inline-block"||"block"})}));class u extends s.PureComponent{constructor(l){super(l)}render(){const{items:l,renderItem:g,getItemKey:f,className:p,inline:c}=this.props,x=r(c);return(0,n.jsx)("ul",{className:(0,a.cx)(x.list,p),children:l.map((v,m)=>(0,n.jsx)("li",{className:x.item,children:g(v,m)},f?f(v):m))})}}},34950:(te,R,e)=>{"use strict";e.d(R,{c:()=>i});var n=e(74848),a=e(96540),s=e(46559);class i extends a.PureComponent{render(){return(0,n.jsx)(s.p,{inline:!0,...this.props})}}},5585:(te,R,e)=>{"use strict";e.d(R,{B:()=>i});var n=e(74848),a=e(96540),s=e(46559);class i extends a.PureComponent{render(){return(0,n.jsx)(s.p,{...this.props})}}},47327:(te,R,e)=>{"use strict";e.d(R,{G:()=>f});var n=e(74848),a=e(22803),s=e(63142);const i=28,r=2.4,u=500,o=4e3,l=300,g=100/i*100;function f({width:c,delay:x=l,ariaLabel:v="Loading bar"}){const m=Math.min(Math.max(Math.round(c*r),u),o),y=(0,s.of)(p,x,m),h={overflow:"hidden"};return(0,n.jsx)("div",{style:h,children:(0,n.jsx)("div",{"aria-label":v,className:y.bar})})}const p=(c,x,v)=>{const m=(0,a.keyframes)({"0%":{transform:"translateX(-100%)"},"85%, 100%":{transform:`translateX(${g}%)`}});return{bar:(0,a.css)({width:i+"%",height:1,background:`linear-gradient(90deg, transparent 0%, ${c.colors.primary.main} 80.75%, transparent 100%)`,transform:"translateX(-100%)",willChange:"transform",[c.transitions.handleMotion("no-preference")]:{animationName:m,animationDelay:`${x}ms`,animationTimingFunction:"linear",animationIterationCount:"infinite",animationDuration:`${v}ms`},[c.transitions.handleMotion("reduce")]:{animationName:m,animationDelay:`${x}ms`,animationTimingFunction:"linear",animationIterationCount:"infinite",animationDuration:`${4*v}ms`}})}}},48457:(te,R,e)=>{"use strict";e.d(R,{O:()=>u});var n=e(74848),a=e(96540),s=e(92745),i=e(18857),r=e(56755);const u=({value:o,onChange:l,context:g,item:f})=>{const p=f.settings??{},c=(0,r.sE)(g.data,p?.filter),x=(0,r.m3)(c,o,void 0,void 0,p.baseNameMode),v=(0,a.useCallback)(y=>{if(!(y&&!(0,r.v3)(y.value,c)))return l(y?.value)},[c,l]),m=x.find(y=>y.value===o);return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(i.l6,{value:m,placeholder:p.placeholderText??(0,s.t)("grafana-ui.matchers-ui.field-name-picker.placeholder","Select field"),options:x,onChange:v,noOptionsMessage:p.noFieldsMessage,width:p.width,isClearable:p.isClearable!==!1})})}},62693:(te,R,e)=>{"use strict";e.d(R,{A:()=>x,bx:()=>f});var n=e(74848),a=e(96540),s=e(95004),i=e(57866),r=e(36638),u=e(92745),o=e(97958),l=e(18857);const g=(0,a.memo)(v=>{const{data:m,options:y,onChange:h,id:d}=v,E=p(m),b=c(E,y),D=(0,a.useCallback)(P=>h(P.value),[h]),C=b.find(P=>P.value===y);return(0,n.jsx)(l.l6,{inputId:d,value:C,options:b,onChange:D})});g.displayName="FieldTypeMatcherEditor";const f=[{value:s.PU.number,label:"Number",icon:(0,o.lV)(s.PU.number)},{value:s.PU.string,label:"String",icon:(0,o.lV)(s.PU.string)},{value:s.PU.time,label:"Time",icon:(0,o.lV)(s.PU.time)},{value:s.PU.boolean,label:"Boolean",icon:(0,o.lV)(s.PU.boolean)},{value:s.PU.trace,label:"Traces",icon:(0,o.lV)(s.PU.trace)},{value:s.PU.enum,label:"Enum",icon:(0,o.lV)(s.PU.enum)},{value:s.PU.other,label:"Other",icon:(0,o.lV)(s.PU.other)}],p=v=>(0,a.useMemo)(()=>{const m=new Map;for(const y of f)m.set(y.value,0);for(const y of v)for(const h of y.fields){const d=h.type||s.PU.other;let E=m.get(d);E||(E=0),m.set(d,E+1)}return m},[v]),c=(v,m)=>(0,a.useMemo)(()=>{let y=!1;const h=[];for(const d of f){const E=v.get(d.value),b=m===d.value;(E||b)&&h.push({...d,label:`${d.label} (${v.get(d.value)})`}),b&&(y=!0)}return m&&!y&&h.push({value:m,label:`${m} (No matches)`}),h},[v,m]),x=()=>({id:i.Ct.byType,component:g,matcher:r.sJ.get(i.Ct.byType),name:(0,u.t)("grafana-ui.matchers-ui.name-fields-with-type","Fields with type"),description:(0,u.t)("grafana-ui.matchers-ui.description-fields-with-type","Set properties for fields of a specific type (number, string, boolean)"),optionsToLabel:v=>v})},18105:(te,R,e)=>{"use strict";e.d(R,{N:()=>c,RH:()=>y});var n=e(74848),a=e(22803),s=e(96540),i=e(46644),r=e(57866),u=e(36638),o=e(92745),l=e(739),g=e(63142),f=e(63527),p=e(18857);const c=[{label:"==",value:l.zT.EQ},{label:"!=",value:l.zT.NEQ},{label:">",value:l.zT.GT},{label:">=",value:l.zT.GTE},{label:"<",value:l.zT.LT},{label:"<=",value:l.zT.LTE}];function x(h){return h===i.gy.allIsNull||h===i.gy.allIsZero}const v=({options:h,onChange:d})=>{const E=(0,g.of)(m),b=(0,s.useMemo)(()=>i.AS.selectOptions([h?.reducer]),[h?.reducer]),D=(0,s.useCallback)(j=>d({...h,reducer:j.value}),[h,d]),C=(0,s.useCallback)(j=>d({...h,op:j.value}),[h,d]),P=(0,s.useCallback)(j=>{const U=j.currentTarget.valueAsNumber;return d({...h,value:U})},[h,d]),M=h??{},O=x(M.reducer);return(0,n.jsxs)("div",{className:E.spot,children:[(0,n.jsx)(p.l6,{value:b.current,options:b.options,onChange:D,placeholder:(0,o.t)("grafana-ui.field-value-matcher.select-field-placeholder","Select field reducer")}),M.reducer&&!O&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.l6,{value:c.find(j=>j.value===M.op),options:c,onChange:C,"aria-label":(0,o.t)("grafana-ui.field-value-matcher.operator-label","Comparison operator"),width:19}),(0,n.jsx)(f.p,{type:"number",value:M.value,onChange:P})]})]})},m=h=>({spot:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"center",alignContent:"flex-end",gap:"4px"})}),y=()=>({id:r.Ct.byValue,component:v,matcher:u.sJ.get(r.Ct.byValue),name:(0,o.t)("grafana-ui.matchers-ui.name-fields-with-value","Fields with values"),description:(0,o.t)("grafana-ui.matchers-ui.description-fields-with-value","Set properties for fields with reducer condition"),optionsToLabel:h=>`${h?.reducer} ${h?.op} ${h?.value}`})},88531:(te,R,e)=>{"use strict";e.d(R,{XL:()=>f,gK:()=>c,h:()=>d,pd:()=>m});var n=e(74848),a=e(96540),s=e(47184),i=e(16515),r=e(57866),u=e(36638),o=e(92745),l=e(18857);const g=(E,b,D)=>{if(!D)return;let C=E.find(P=>!b.some(M=>P===M));if(C)return C};function f({value:E,data:b,onChange:D,placeholder:C}){const P=(0,a.useMemo)(()=>x(b),[b]),[M,O]=(0,a.useState)({refIds:[],value:void 0}),j=(0,a.useMemo)(()=>P.find(W=>W.value===E)??g(P,M.refIds,M.value),[E,P,M]),U=(0,a.useCallback)(W=>{D(W?.value)},[D]);return(P!==M.refIds||j?.value!==M.value)&&O({refIds:P,value:j?.value}),(0,n.jsx)(l.l6,{options:P,onChange:U,isClearable:!0,placeholder:C??"Select query refId",value:j})}const p=(E,b,D)=>{if(!D||!D.length)return;const C=E.filter(P=>b.some(M=>P===M));if(C.length)return C};function c({value:E,data:b,onChange:D,placeholder:C}){const P=(0,a.useMemo)(()=>x(b),[b]),[M,O]=(0,a.useState)({refIds:[],value:void 0}),j=(0,a.useMemo)(()=>{let W=new Set;if(E)if(E.startsWith("/^"))try{W=new Set(h(E))}catch{W.add(E)}else E.includes("|")?W=new Set(E.split("|")):W.add(E);const B=P.filter(_=>W.has(_.value||""));if(B.length)return B;const S=[...W].map(s.z);return p(S,M.refIds,M.value)},[E,P,M]),U=(0,a.useCallback)(W=>{D(W.map(B=>B.value))},[D]);return(P!==M.refIds||j?.length!==M.value?.length)&&O({refIds:P,value:j}),(0,n.jsx)(l.KF,{options:P,onChange:U,isClearable:!0,placeholder:C??"Select query refId",value:j})}function x(E){const b=new Map;for(const C of E){const P=C.refId??"",M=b.get(P)??[];M.length===0&&b.set(P,M),M.push(C)}const D=[];for(const[C,P]of b.entries())D.push({value:C,label:`Query: ${C??"(missing refId)"}`,description:v(P)});return D}function v(E){return`Frames (${E.length}):
    ${E.slice(0,Math.min(3,E.length)).map(b=>(0,i.Ri)(b)).join(", ")} ${E.length>3?"...":""}`}const m=()=>({id:r.Ct.byFrameRefID,component:E=>(0,n.jsx)(f,{value:E.options,data:E.data,onChange:E.onChange}),matcher:u.sJ.get(r.Ct.byFrameRefID),name:(0,o.t)("grafana-ui.matchers-ui.name-fields-by-query","Fields returned by query"),description:(0,o.t)("grafana-ui.matchers-ui.description-fields-by-query","Set properties for fields from a specific query"),optionsToLabel:E=>E});function y(E){return E.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const h=E=>E.slice(5,-3).split(/(?<!\\)\|/g).map(b=>b.replace(/\\(.)/g,"$1")),d=E=>`/^(?:${E.map(b=>y(b)).join("|")})$/`},63152:(te,R,e)=>{"use strict";e.d(R,{g:()=>E});var n=e(42954),a=e(74848),s=e(96540),i=e(57866),r=e(36638),u=e(92745),o=e(63527);const l=(0,s.memo)(b=>{const{options:D,onChange:C}=b,P=(0,s.useCallback)(M=>C(M.target.value),[C]);return(0,a.jsx)(o.p,{placeholder:(0,u.t)("grafana-ui.field-name-by-regex-matcher.input-placeholder","Enter regular expression"),defaultValue:D,onBlur:P})});l.displayName="FieldNameByRegexMatcherEditor";const g=()=>({id:i.Ct.byRegexp,component:l,matcher:r.sJ.get(i.Ct.byRegexp),name:(0,u.t)("grafana-ui.matchers-ui.name-field-name-by-regex-matcher","Fields with name matching regex"),description:(0,u.t)("grafana-ui.matchers-ui.description-field-name-by-regex-matcher","Set properties for fields with names matching a regex"),optionsToLabel:b=>b});var f=e(18857),p=e(56755);const c=(0,s.memo)(b=>{const{data:D,options:C,onChange:P,id:M}=b,O=(0,p.sE)(D),j=(0,p.m3)(O,C),U=(0,s.useCallback)(B=>{if((0,p.v3)(B.value,O))return P(B.value)},[O,P]),W=j.find(B=>B.value===C);return(0,a.jsx)(f.l6,{value:W,options:j,onChange:U,inputId:M})});c.displayName="FieldNameMatcherEditor";const x=()=>({id:i.Ct.byName,component:c,matcher:r.sJ.get(i.Ct.byName),name:(0,u.t)("grafana-ui.matchers-ui.name-fields-with-name","Fields with name"),description:(0,u.t)("grafana-ui.matchers-ui.description-fields-with-name","Set properties for a specific field"),optionsToLabel:b=>b}),v=(0,s.memo)(b=>{const{data:D,options:C,onChange:P}=b,{readOnly:M,prefix:O}=C,j=(0,p.sE)(D),U=(0,p.m3)(j,void 0),W=(0,s.useCallback)(B=>{if(Array.isArray(B))return P({...C,names:B.reduce((S,_)=>((0,p.v3)(_.value,j)&&S.push(_.value),S),[])})},[j,P,C]);if(M){const B=(C.names??[]).join(", ");return(0,a.jsx)(o.p,{value:B,readOnly:!0,disabled:!0,prefix:O})}return(0,a.jsx)(f.KF,{value:C.names,options:U,onChange:W})});v.displayName="FieldNameMatcherEditor";const m=()=>({id:i.Ct.byNames,component:v,matcher:r.sJ.get(i.Ct.byNames),name:(0,u.t)("grafana-ui.matchers-ui.name-fields-with-name","Fields with name"),description:(0,u.t)("grafana-ui.matchers-ui.description-fields-with-name","Set properties for a specific field"),optionsToLabel:b=>(b.names??[]).join(", "),excludeFromPicker:!0});var y=e(62693),h=e(18105),d=e(88531);const E=new n.O(()=>[x(),g(),(0,y.A)(),(0,d.pd)(),m(),(0,h.RH)()])},56755:(te,R,e)=>{"use strict";e.d(R,{BP:()=>u,m3:()=>l,sE:()=>o,v3:()=>r});var n=e(96540),a=e(16515),s=e(38809),i=e(97958);function r(g,f){return g?f.display.has(g)||f.raw.has(g):!1}function u(g,f){const p={display:new Set,raw:new Set,fields:new Map};for(const c of g)for(const x of c.fields){if(f&&!f(x))continue;const v=(0,a.Ct)(x,c,g);p.display.add(v),p.fields.set(v,x),x.name&&v!==x.name&&(p.raw.add(x.name),p.fields.set(x.name,x))}return p}function o(g,f){return(0,n.useMemo)(()=>u(g,f),[g,f])}function l(g,f,p,c,x){return(0,n.useMemo)(()=>{let v=!1;const m=[];if(p&&m.push(p),x===s.X4.OnlyBaseNames)for(const y of g.raw)!v&&y===f&&(v=!0),m.push({value:y,label:`${y} (base field name)`});else{for(const y of g.display){!v&&y===f&&(v=!0);const h=g.fields.get(y);(!c||c===h?.type)&&m.push({value:y,label:y,icon:h?(0,i.SS)(h):void 0})}if(x!==s.X4.ExcludeBaseNames)for(const y of g.raw)g.display.has(y)||(!v&&y===f&&(v=!0),m.push({value:y,label:`${y} (base field name)`}))}return f&&!v&&m.push({value:f,label:`${f} (not found)`}),m},[g,f,p,c,x])}},87063:(te,R,e)=>{"use strict";e.d(R,{W:()=>p});var n=e(74848),a=e(22803),s=e(96540),i=e(63142),r=e(31286),u=e(25460),o=e(30930),l=e(94535),g=e(92132);const f=s.forwardRef(({header:x,children:v,ariaLabel:m,onOpen:y,onClose:h,onKeyDown:d,...E},b)=>{const D=(0,i.of)(c),C=(0,s.useRef)(null);(0,s.useImperativeHandle)(b,()=>C.current);const[P]=(0,g.t)({isMenuOpen:!0,localRef:C,onOpen:y,onClose:h,onKeyDown:d});return(0,n.jsxs)(r.a,{...E,"aria-label":m,backgroundColor:"elevated",borderRadius:"default",boxShadow:"z3",display:"inline-block",onKeyDown:P,paddingX:.5,paddingY:.5,ref:C,role:"menu",tabIndex:-1,children:[x&&(0,n.jsx)("div",{className:(0,a.cx)(D.header,!!v&&s.Children.toArray(v).length>0&&D.headerBorder),children:x}),v]})});f.displayName="Menu";const p=Object.assign(f,{Item:l.D,Divider:u.N,Group:o.r}),c=x=>({header:(0,a.css)({padding:x.spacing(.5,.5,1,.5)}),headerBorder:(0,a.css)({borderBottom:`1px solid ${x.colors.border.weak}`,marginBottom:x.spacing(.5)})})},25460:(te,R,e)=>{"use strict";e.d(R,{N:()=>i});var n=e(74848),a=e(22803),s=e(63142);function i(){const u=(0,s.of)(r);return(0,n.jsx)("div",{className:u.divider})}const r=u=>({divider:(0,a.css)({height:1,backgroundColor:u.colors.border.weak,margin:u.spacing(.5,0)})})},30930:(te,R,e)=>{"use strict";e.d(R,{r:()=>u});var n=e(74848),a=e(22803),s=e(2543),i=e.n(s),r=e(63142);const u=({label:l,ariaLabel:g,children:f})=>{const p=(0,r.of)(o),c=`group-label-${(0,s.uniqueId)()}`;return(0,n.jsxs)("div",{role:"group","aria-labelledby":!g&&l?c:void 0,"aria-label":g,children:[l&&(0,n.jsx)("label",{id:c,className:p.groupLabel,"aria-hidden":!0,children:l}),f]})};u.displayName="MenuGroup";const o=l=>({groupLabel:(0,a.css)({color:l.colors.text.secondary,fontSize:l.typography.size.sm,padding:l.spacing(.5,1)})})},94535:(te,R,e)=>{"use strict";e.d(R,{D:()=>v});var n=e(74848),a=e(22803),s=e(96540),i=e(92745),r=e(63142),u=e(35484),o=e(30703),l=e(41654),g=e(51898),f=e(92132);const p=y=>{if(!y)return!1;const h=y.parentElement.getBoundingClientRect(),d=y.getBoundingClientRect();return d.width!==0&&h.right+d.width+10>window.innerWidth},c=(0,s.memo)(({items:y,isOpen:h,close:d,customStyle:E})=>{const b=(0,r.of)(x),D=(0,s.useRef)(null),[C]=(0,f.t)({localRef:D,isMenuOpen:h,close:d}),[P,M]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{h&&D.current&&M(p(D.current))},[h]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:b.iconWrapper,"aria-hidden":!0,"data-testid":g.Tp.components.Menu.SubMenu.icon,children:(0,n.jsx)(o.I,{name:"angle-right",className:b.icon})}),h&&(0,n.jsx)("div",{ref:D,className:(0,a.cx)(b.subMenu,{[b.pushLeft]:P}),"data-testid":g.Tp.components.Menu.SubMenu.container,style:E,children:(0,n.jsx)("div",{tabIndex:-1,className:b.itemsWrapper,role:"menu",onKeyDown:C,children:y})})]})});c.displayName="SubMenu";const x=y=>({iconWrapper:(0,a.css)({display:"flex",flex:1,justifyContent:"end"}),icon:(0,a.css)({opacity:.7,marginLeft:y.spacing(1),color:y.colors.text.secondary}),itemsWrapper:(0,a.css)({background:y.colors.background.elevated,padding:y.spacing(.5),boxShadow:y.shadows.z3,display:"inline-block",borderRadius:y.shape.radius.default}),pushLeft:(0,a.css)({right:"100%",left:"unset"}),subMenu:(0,a.css)({position:"absolute",top:0,left:"100%",zIndex:y.zIndex.dropdown})}),v=s.memo(s.forwardRef((y,h)=>{const{url:d,icon:E,label:b,description:D,ariaLabel:C,ariaChecked:P,target:M,onClick:O,className:j,active:U,disabled:W,destructive:B,childItems:S,role:_,tabIndex:K=-1,customSubMenuContainerStyles:T,shortcut:L,testId:A}=y,N=(0,r.of)(m),[V,z]=(0,s.useState)(U),[w,H]=(0,s.useState)(!1),Q=(0,s.useCallback)(()=>{W||(H(!0),z(!0))},[W]),Z=(0,s.useCallback)(()=>{W||(H(!1),z(!1))},[W]),Y=S&&S.length>0,X=Y?"div":d===void 0?"button":"a",I=(0,a.cx)({[N.item]:!0,[N.active]:V,[N.disabled]:W,[N.destructive]:B&&!W},j),J={[X==="button"?"disabled":"aria-disabled"]:W,...X==="a"&&W&&{href:void 0,onClick:void 0},...W&&{tabIndex:-1,"data-disabled":W}},ee=(0,s.useRef)(null);(0,s.useImperativeHandle)(h,()=>ee.current);const q=oe=>{switch(oe.key){case"ArrowRight":oe.preventDefault(),oe.stopPropagation(),Y&&(H(!0),z(!0));break;default:break}},ne=()=>{H(!1),z(!1),ee?.current?.focus()},se=!!(L&&L.length>0);return(0,n.jsxs)(X,{target:M,className:I,rel:M==="_blank"?"noopener noreferrer":void 0,href:d,onClick:oe=>{Y&&!w&&(oe.preventDefault(),oe.stopPropagation()),O?.(oe)},onMouseEnter:Q,onMouseLeave:Z,onKeyDown:q,role:d?_:_||"menuitem","data-role":"menuitem",ref:ee,"data-testid":A,"aria-label":C,"aria-checked":P,tabIndex:K,...J,children:[(0,n.jsxs)(l.B,{direction:"row",justifyContent:"flex-start",alignItems:"center",children:[E&&(0,n.jsx)(o.I,{name:E,className:N.icon,"aria-hidden":!0}),(0,n.jsx)("span",{className:N.ellipsis,children:b}),(0,n.jsxs)("div",{className:(0,a.cx)(N.rightWrapper,{[N.withShortcut]:se}),children:[se&&(0,n.jsxs)("div",{className:N.shortcut,children:[(0,n.jsx)(o.I,{name:"keyboard",title:(0,i.t)("grafana-ui.menu-item.keyboard-shortcut-label","Keyboard shortcut")}),L]}),Y&&(0,n.jsx)(c,{items:S,isOpen:w,close:ne,customStyle:T})]})]}),D&&(0,n.jsx)("div",{className:(0,a.cx)(N.description,N.ellipsis,{[N.descriptionWithIcon]:E!==void 0}),children:D}),y.component?(0,n.jsx)(y.component,{}):null]})}));v.displayName="MenuItem";const m=y=>({item:(0,a.css)({background:"none",cursor:"pointer",whiteSpace:"nowrap",color:y.colors.text.primary,display:"flex",flexDirection:"column",alignItems:"stretch",justifyContent:"center",padding:y.spacing(.5,1.5),minHeight:y.spacing(4),borderRadius:y.shape.radius.default,margin:0,border:"none",width:"100%",position:"relative","&:hover, &:focus-visible":{background:y.colors.action.hover,color:y.colors.text.primary,textDecoration:"none"},"&:focus-visible":(0,u.getFocusStyles)(y)}),active:(0,a.css)({background:y.colors.action.hover}),destructive:(0,a.css)({color:y.colors.error.text,svg:{color:y.colors.error.text},"&:hover, &:focus, &:focus-visible":{background:y.colors.error.main,color:y.colors.error.contrastText,svg:{color:y.colors.error.contrastText}}}),disabled:(0,a.css)({color:y.colors.action.disabledText,label:"menu-item-disabled","&:hover, &:focus, &:focus-visible":{cursor:"not-allowed",background:"none",color:y.colors.action.disabledText}}),icon:(0,a.css)({opacity:.7,color:y.colors.text.secondary}),rightWrapper:(0,a.css)({display:"flex",alignItems:"center",marginLeft:"auto"}),withShortcut:(0,a.css)({minWidth:y.spacing(10.5)}),shortcut:(0,a.css)({display:"flex",alignItems:"center",gap:y.spacing(1),marginLeft:y.spacing(2),color:y.colors.text.secondary,opacity:.7}),description:(0,a.css)({...y.typography.bodySmall,color:y.colors.text.secondary,textAlign:"start"}),descriptionWithIcon:(0,a.css)({marginLeft:y.spacing(3)}),ellipsis:(0,a.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})})},92132:(te,R,e)=>{"use strict";e.d(R,{t:()=>r});var n=e(96540),a=e(94701);const s=(u,o)=>(u%o+o)%o,i=-1,r=({localRef:u,isMenuOpen:o,close:l,onOpen:g,onClose:f,onKeyDown:p})=>{const[c,x]=(0,n.useState)(i);return(0,n.useEffect)(()=>{o&&x(0)},[o]),(0,n.useEffect)(()=>{const m=u?.current?.querySelectorAll('[data-role="menuitem"]:not([data-disabled])');m?.[c]?.focus(),m?.forEach((y,h)=>{y.tabIndex=h===c?0:-1})},[u,c]),(0,a.A)(()=>{g?.(x)}),[m=>{const y=u?.current?.querySelectorAll('[data-role="menuitem"]:not([data-disabled])'),h=y?.length??0;switch(m.key){case"ArrowUp":m.preventDefault(),m.stopPropagation(),x(s(c-1,h));break;case"ArrowDown":m.preventDefault(),m.stopPropagation(),x(s(c+1,h));break;case"ArrowLeft":m.preventDefault(),m.stopPropagation(),x(i),l?.();break;case"Home":m.preventDefault(),m.stopPropagation(),x(0);break;case"End":m.preventDefault(),m.stopPropagation(),x(h-1);break;case"Enter":m.preventDefault(),m.stopPropagation(),y?.[c]?.click();break;case"Escape":f?.();break;case"Tab":m.preventDefault(),f?.();break;default:break}p?.(m)}]}},22787:(te,R,e)=>{"use strict";e.d(R,{a:()=>v});var n=e(74848),a=e(22803),s=e(18828),i=e(42211),r=e(93225),u=e(51182),o=e(96540),l=e(92745),g=e(63142),f=e(76319),p=e(41654),c=e(53428),x=e(35621);function v(h){const{title:d,children:E,isOpen:b=!1,closeOnEscape:D=!0,closeOnBackdropClick:C=!0,className:P,contentClassName:M,onDismiss:O,onClickBackdrop:j,trapFocus:U=!0}=h,W=(0,g.of)(x.o),B=(0,o.useRef)(null),{overlayProps:S,underlayProps:_}=(0,r.e)({isKeyboardDismissDisabled:!D,isOpen:b,onClose:O},B),{dialogProps:K,titleProps:T}=(0,s.s)({},B);if(!b)return null;const L=(0,a.cx)(W.modalHeader,typeof d!="string"&&W.modalHeaderWithTabs);return(0,n.jsxs)(u.Sf,{children:[(0,n.jsx)("div",{role:"presentation",className:W.modalBackdrop,onClick:j||(C?O:void 0),..._}),(0,n.jsx)(i.n1,{contain:U,autoFocus:!0,restoreFocus:!0,children:(0,n.jsxs)("div",{className:(0,a.cx)(W.modal,P),ref:B,...S,...K,children:[(0,n.jsxs)("div",{className:L,children:[typeof d=="string"&&(0,n.jsx)(y,{...h,title:d,id:T.id}),typeof d!="string"&&d,(0,n.jsx)("div",{className:W.modalHeaderClose,children:(0,n.jsx)(f.K,{name:"times",size:"xl",onClick:O,"aria-label":(0,l.t)("grafana-ui.modal.close-tooltip","Close")})})]}),(0,n.jsx)("div",{className:(0,a.cx)(W.modalContent,M),children:E})]})})]})}function m({leftItems:h,children:d}){const E=(0,g.of)(x.o);return h?(0,n.jsx)("div",{className:E.modalButtonRow,children:(0,n.jsxs)(p.B,{justifyContent:"space-between",children:[(0,n.jsx)(p.B,{justifyContent:"flex-start",gap:2,children:h}),(0,n.jsx)(p.B,{justifyContent:"flex-end",gap:2,children:d})]})}):(0,n.jsx)("div",{className:E.modalButtonRow,children:(0,n.jsx)(p.B,{justifyContent:"flex-end",gap:2,wrap:"wrap",children:d})})}v.ButtonRow=m;function y({icon:h,iconTooltip:d,title:E,id:b}){return(0,n.jsx)(c.r,{icon:h,iconTooltip:d,title:E,id:b})}},53428:(te,R,e)=>{"use strict";e.d(R,{r:()=>i});var n=e(74848),a=e(63142),s=e(35621);const i=({icon:r,iconTooltip:u,title:o,children:l,id:g})=>{const f=(0,a.of)(s.o);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h2",{className:f.modalHeaderTitle,id:g,children:o}),l]})}},52792:(te,R,e)=>{"use strict";e.d(R,{J:()=>r});var n=e(74848),a=e(60208),s=e(54314),i=e(53428);const r=({icon:u,title:o,tabs:l,activeTab:g,onChangeTab:f})=>(0,n.jsx)(i.r,{icon:u,title:o,children:(0,n.jsx)(s.U,{hideBorder:!0,children:l.map((p,c)=>(0,n.jsx)(a.o,{label:p.label,icon:p.icon,suffix:p.tabSuffix,active:p.value===g,onChangeTab:()=>f(p)},`${p.value}-${c}`))})})},8515:(te,R,e)=>{"use strict";e.d(R,{$s:()=>u,EO:()=>r,YO:()=>i,wE:()=>s});var n=e(74848),a=e(96540);const s=a.createContext({component:null,props:{},showModal:()=>{},hideModal:()=>{}});class i extends a.Component{constructor(l){super(l),this.showModal=(g,f)=>{this.setState({component:g,props:f})},this.hideModal=()=>{this.setState({component:null,props:{}})},this.state={component:l.component||null,props:l.props||{},showModal:this.showModal,hideModal:this.hideModal}}render(){return(0,n.jsx)(s.Provider,{value:this.state,children:this.props.children})}}const r=()=>(0,n.jsx)(s.Consumer,{children:({component:o,props:l})=>o?(0,n.jsx)(o,{...l}):null}),u=s.Consumer},35621:(te,R,e)=>{"use strict";e.d(R,{o:()=>a});var n=e(22803);const a=s=>{const i=s.shape.radius.default;return{modal:(0,n.css)({position:"fixed",zIndex:s.zIndex.modal,background:s.colors.background.primary,boxShadow:s.shadows.z3,borderRadius:i,border:`1px solid ${s.colors.border.weak}`,backgroundClip:"padding-box",outline:"none",width:"750px",maxWidth:"100%",left:0,right:0,marginLeft:"auto",marginRight:"auto",top:"10%",maxHeight:"80%",display:"flex",flexDirection:"column"}),modalBackdrop:(0,n.css)({position:"fixed",zIndex:s.zIndex.modalBackdrop,top:0,right:0,bottom:0,left:0,backgroundColor:s.components.overlay.background}),modalHeader:(0,n.css)({label:"modalHeader",display:"flex",alignItems:"center",minHeight:"42px",margin:s.spacing(1,2,0,2)}),modalHeaderWithTabs:(0,n.css)({borderBottom:`1px solid ${s.colors.border.weak}`}),modalHeaderTitle:(0,n.css)({fontSize:s.typography.size.lg,margin:s.spacing(0,4,0,1),display:"flex",alignItems:"center",position:"relative",top:"2px"}),modalHeaderIcon:(0,n.css)({marginRight:s.spacing(2),fontSize:"inherit","&:before":{verticalAlign:"baseline"}}),modalHeaderClose:(0,n.css)({height:"100%",display:"flex",alignItems:"center",color:s.colors.text.secondary,flexGrow:1,justifyContent:"flex-end"}),modalContent:(0,n.css)({overflow:"auto",padding:s.spacing(3),width:"100%"}),modalButtonRow:(0,n.css)({paddingTop:s.spacing(3)})}}},13477:(te,R,e)=>{"use strict";e.d(R,{O:()=>a});var n=e(78193);function a(s){const i="${"+s.value+"}",r=s.value===s.label?s.origin:`${s.label} / ${s.origin}`;return{label:i,kind:n.q.Property,detail:r,documentation:s.documentation}}},84600:(te,R,e)=>{"use strict";e.d(R,{d:()=>c});var n=e(74848),a=e(22803),s=e(96540),i=e(51898),r=e(92745),u=e(63142),o=e(35484),l=e(30703),g=e(76319),f=e(20941),p=e(36219);const c=(0,s.memo)(({title:v,section:m,parent:y,pageIcon:h,onGoBack:d,children:E,titleHref:b,parentHref:D,leftItems:C,isFullscreen:P,className:M,"aria-label":O,buttonOverflowAlignment:j="right",forceShowLeftItems:U=!1})=>{const W=(0,u.of)(x),B=(0,a.cx)("page-toolbar",W.toolbar,{"page-toolbar--fullscreen":P,[W.noPageIcon]:!h},M),S=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:W.truncateText,children:v}),m&&(0,n.jsxs)("span",{className:W.pre,children:[" / ",m]})]}),_=(0,r.t)("grafana-ui.page-toolbar.go-back","Go back (Esc)"),K=(0,r.t)("grafana-ui.page-toolbar.search-parent-folder","Search dashboard in the {{parent}} folder",{parent:y}),T=(0,r.t)("grafana-ui.page-toolbar.search-dashboard-name","Search dashboard by name"),L=(0,r.t)("grafana-ui.page-toolbar.search-links","Search links");return(0,n.jsxs)("nav",{className:B,"aria-label":O,children:[(0,n.jsxs)("div",{className:W.leftWrapper,children:[h&&!d&&(0,n.jsx)("div",{className:W.pageIcon,children:(0,n.jsx)(l.I,{name:h,size:"lg","aria-hidden":!0})}),d&&(0,n.jsx)("div",{className:W.pageIcon,children:(0,n.jsx)(g.K,{name:"arrow-left",tooltip:_,tooltipPlacement:"bottom",size:"xxl","data-testid":i.Tp.components.BackButton.backArrow,onClick:d})}),(0,n.jsxs)("nav",{"aria-label":L,className:W.navElement,children:[y&&D&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(f.N,{"aria-label":K,className:(0,a.cx)(W.titleText,W.parentLink,W.titleLink,W.truncateText),href:D,children:[y," ",(0,n.jsx)("span",{className:W.parentIcon})]}),b&&(0,n.jsx)("span",{className:(0,a.cx)(W.titleText,W.titleDivider),"aria-hidden":!0,children:"/"})]}),(v||!!C?.length)&&(0,n.jsxs)("div",{className:W.titleWrapper,children:[v&&(0,n.jsx)("h1",{className:W.h1Styles,children:b?(0,n.jsx)(f.N,{"aria-label":T,className:(0,a.cx)(W.titleText,W.titleLink),href:b,children:S}):(0,n.jsx)("div",{className:W.titleText,children:S})}),C?.map((A,N)=>(0,n.jsx)("div",{className:(0,a.cx)(W.leftActionItem,{[W.forceShowLeftActionItems]:U}),children:A},N))]})]})]}),(0,n.jsx)(p.U,{alignment:j,children:s.Children.toArray(E).filter(Boolean)})]})});c.displayName="PageToolbar";const x=v=>{const{spacing:m,typography:y}=v,h=(0,o.getFocusStyles)(v);return{pre:(0,a.css)({whiteSpace:"pre"}),toolbar:(0,a.css)({alignItems:"center",background:v.colors.background.canvas,display:"flex",gap:v.spacing(2),justifyContent:"space-between",padding:v.spacing(1.5,2),[v.breakpoints.down("md")]:{paddingLeft:"53px"}}),noPageIcon:(0,a.css)({[v.breakpoints.down("md")]:{paddingLeft:v.spacing(2)}}),leftWrapper:(0,a.css)({display:"flex",flexWrap:"nowrap",maxWidth:"70%"}),pageIcon:(0,a.css)({display:"none",[v.breakpoints.up("sm")]:{display:"flex",paddingRight:v.spacing(1),alignItems:"center"}}),truncateText:(0,a.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),titleWrapper:(0,a.css)({display:"flex",margin:0,minWidth:0}),navElement:(0,a.css)({display:"flex",alignItems:"center",minWidth:0}),h1Styles:(0,a.css)({margin:m(0,1,0,0),lineHeight:"inherit",flexGrow:1,minWidth:0}),parentIcon:(0,a.css)({marginLeft:v.spacing(.5)}),titleText:(0,a.css)({display:"flex",fontSize:y.size.lg,margin:0,borderRadius:v.shape.radius.default}),titleLink:(0,a.css)({"&:focus-visible":h}),titleDivider:(0,a.css)({padding:m(0,.5,0,.5),display:"none",[v.breakpoints.up("md")]:{display:"unset"}}),parentLink:(0,a.css)({display:"none",[v.breakpoints.up("md")]:{display:"unset",flex:1}}),leftActionItem:(0,a.css)({display:"none",alignItems:"center",paddingRight:m(.5),[v.breakpoints.up("md")]:{display:"flex"}}),forceShowLeftActionItems:(0,a.css)({display:"flex"})}}},34213:(te,R,e)=>{"use strict";e.d(R,{d:()=>l});var n=e(74848),a=e(22803),s=e(96540),i=e(92745),r=e(63142),u=e(45861),o=e(30703);const l=({currentPage:f,numberOfPages:p,onNavigate:c,hideWhenSinglePage:x,showSmallVersion:v,className:m})=>{const y=(0,r.of)(g),h=v?1:8,d=(0,s.useMemo)(()=>{const D=[...new Array(p).keys()],C=p>h,P=(M,O)=>(0,n.jsx)("li",{className:y.item,children:(0,n.jsx)(u.$n,{size:"sm",variant:O,onClick:()=>c(M),children:M})},M);return D.reduce((M,O)=>{const j=O+1,U=j===f?"primary":"secondary",W=h,B=p-h+1,S=B-W,_=j===1||j===p,K=S>-1&&f>=W&&f<=B,T=v?1:3,L=v?0:2;return C?_||f<W&&j<W||S>=0&&f>B&&j>B||S<0&&f>=W&&j>B||K&&j>=f-L&&j<=f+L?M.push(P(j,U)):(j===W&&f<W||j===B&&f>B||K&&(j===f-T||j===f+T))&&M.push((0,n.jsx)("li",{className:y.item,children:(0,n.jsx)(o.I,{className:y.ellipsis,name:"ellipsis-v","data-testid":"pagination-ellipsis-icon"})},j)):M.push(P(j,U)),M},[])},[f,p,c,h,v,y.ellipsis,y.item]);if(x&&p<=1)return null;const E=(0,i.t)("grafana-ui.pagination.previous-page","previous page"),b=(0,i.t)("grafana-ui.pagination.next-page","next page");return(0,n.jsx)("div",{className:(0,a.cx)(y.container,m),role:"navigation",children:(0,n.jsxs)("ol",{children:[(0,n.jsx)("li",{className:y.item,children:(0,n.jsx)(u.$n,{"aria-label":E,size:"sm",variant:"secondary",onClick:()=>c(f-1),disabled:f===1,children:(0,n.jsx)(o.I,{name:"angle-left"})})}),d,(0,n.jsx)("li",{className:y.item,children:(0,n.jsx)(u.$n,{"aria-label":b,size:"sm",variant:"secondary",onClick:()=>c(f+1),disabled:f===p,children:(0,n.jsx)(o.I,{name:"angle-right"})})})]})})},g=()=>({container:(0,a.css)({float:"right"}),item:(0,a.css)({display:"inline-block",paddingLeft:"10px",marginBottom:"5px"}),ellipsis:(0,a.css)({transform:"rotate(90deg)"})})},39884:(te,R,e)=>{"use strict";e.d(R,{I:()=>l});var n=e(74848),a=e(22803),s=e(51898),i=e(92745),r=e(63142),u=e(30703),o=e(45967);const l=({onCancel:p,loading:c})=>{const x=window.matchMedia("(prefers-reduced-motion: reduce)").matches,v=(0,r.of)(f);return c?(0,n.jsx)(o.m,{content:(0,i.t)("grafana-ui.panel-chrome.tooltip-cancel-loading","Cancel query"),children:(0,n.jsx)(u.I,{className:(0,a.cx)(v.spin,{[v.clickable]:!!p}),name:x?"hourglass":"sync",size:"sm",onClick:p,"data-testid":s.Tp.components.LoadingIndicator.icon})}):null},g=(0,a.keyframes)({"0%":{transform:"rotate(0deg) scaleX(-1)"},"100%":{transform:"rotate(359deg) scaleX(-1)"}}),f=p=>({clickable:(0,a.css)({cursor:"pointer"}),spin:(0,a.css)({[p.transitions.handleMotion("no-preference")]:{animation:`${g} 3s linear infinite`}})})},64400:(te,R,e)=>{"use strict";e.d(R,{XF:()=>i,d2:()=>r,e4:()=>s});var n=e(96540),a=e(19379);const s=(0,n.createContext)({eventsScope:"global",eventBus:new a.o}),i=s.Provider,r=()=>(0,n.useContext)(s)},67522:(te,R,e)=>{"use strict";e.d(R,{NR:()=>N});var n=e(39884),a=e(74848),s=e(22803),i=e(96540),r=e(42941),u=e(49185),o=e(28105),l=e(51898),g=e(92745),f=e(63142),p=e(35484);function c({children:V,delay:z}){const[w,H]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{window.setTimeout(()=>{H(!0)},z)},[V,z]),(0,a.jsx)(a.Fragment,{children:w?V:null})}var x=e(36324),v=e(56887),m=e(30703),y=e(47327),h=e(66404),d=e(45967),E=e(88559),b=e(7895);function D({menu:V,title:z,placement:w="bottom",offset:H,dragClassCancel:Q,menuButtonClass:Z,onOpenMenu:Y}){const X=z?l.Tp.components.Panels.Panel.menu(z):"panel-menu-button",I=(0,i.useCallback)(J=>{J&&Y&&Y()},[Y]);return(0,a.jsx)(E.m,{overlay:V,placement:w,offset:H,onVisibleChange:I,children:(0,a.jsx)(b.I,{"aria-label":(0,g.t)("grafana-ui.panel-menu.label","Menu for panel {{ title }}",{title:z??"Untitled"}),title:(0,g.t)("grafana-ui.panel-menu.title","Menu"),icon:"ellipsis-v",iconSize:"md",narrow:!0,"data-testid":X,className:(0,s.cx)(Z,Q)})})}function C({menu:V,title:z,dragClass:w,children:H,offset:Q=-32,onOpenMenu:Z}){const Y=(0,f.of)(P),X=(0,i.useRef)(null),I=l.Tp.components.Panels.Panel.HoverWidget,J=(0,i.useCallback)(q=>{X.current?.setPointerCapture(q.pointerId)},[]),ee=(0,i.useCallback)(q=>{X.current?.releasePointerCapture(q.pointerId)},[]);return H===void 0||i.Children.count(H)===0?null:(0,a.jsxs)("div",{className:(0,s.cx)(Y.container,"show-on-hover"),style:{top:Q},"data-testid":I.container,children:[w&&(0,a.jsx)("div",{className:(0,s.cx)(Y.square,Y.draggable,w),onPointerDown:J,onPointerUp:ee,ref:X,"data-testid":I.dragIcon,children:(0,a.jsx)(m.I,{name:"expand-arrows",className:Y.draggableIcon})}),H,V&&(0,a.jsx)(D,{menu:V,title:z,placement:"bottom",menuButtonClass:Y.menuButton,onOpenMenu:Z})]})}function P(V){return{container:(0,s.css)({label:"hover-container-widget",[V.transitions.handleMotion("no-preference","reduce")]:{transition:"all .1s linear"},display:"flex",position:"absolute",zIndex:1,right:0,boxSizing:"content-box",alignItems:"center",background:V.colors.background.secondary,color:V.colors.text.primary,border:`1px solid ${V.colors.border.weak}`,borderRadius:V.shape.radius.default,height:V.spacing(4),boxShadow:V.shadows.z1}),square:(0,s.css)({display:"flex",justifyContent:"center",alignItems:"center",width:V.spacing(4),height:"100%"}),draggable:(0,s.css)({cursor:"move",[V.breakpoints.down("md")]:{display:"none"}}),menuButton:(0,s.css)({background:"inherit",border:"none","&:hover":{background:V.colors.secondary.main}}),draggableIcon:(0,s.css)({transform:"rotate(45deg)",color:V.colors.text.secondary,"&:hover":{color:V.colors.text.primary}})}}var M=e(45861);const O=(0,i.forwardRef)(({className:V,children:z,href:w,onClick:H,target:Q,title:Z,...Y},X)=>{const I=(0,f.of)(j);return w?(0,a.jsx)("a",{ref:X,href:w,onClick:H,target:Q,title:Z,className:(0,s.cx)(I.linkItem,V),...Y,children:z}):H?(0,a.jsx)(M.$n,{ref:X,className:(0,s.cx)(I.item,V),variant:"secondary",fill:"text",onClick:H,children:z}):(0,a.jsx)("span",{ref:X,className:(0,s.cx)(I.item,V),...Y,children:z})});O.displayName="TitleItem";const j=V=>{const z=(0,s.css)({color:`${V.colors.text.secondary}`,label:"panel-header-item",cursor:"auto",border:"none",borderRadius:`${V.shape.radius.default}`,padding:`${V.spacing(0,1)}`,height:`${V.spacing(V.components.panel.headerHeight)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,p.getFocusStyles)(V),zIndex:1},"&: focus:not(:focus-visible)":(0,p.getMouseFocusStyles)(V),"&:hover ":{boxShadow:`${V.shadows.z1}`,background:`${V.colors.background.secondary}`,color:`${V.colors.text.primary}`}});return{item:z,linkItem:(0,s.cx)(z,(0,s.css)({cursor:"pointer"}))}};function U({description:V,className:z}){const w=(0,f.of)(W),H=()=>{const Q=typeof V=="function"?V():V;return(0,a.jsx)("div",{className:"panel-info-content markdown-html",children:(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:Q}})})};return V!==""?(0,a.jsx)(d.m,{interactive:!0,content:H,children:(0,a.jsx)(O,{className:(0,s.cx)(z,w.description),children:(0,a.jsx)(m.I,{name:"info-circle",size:"md"})})}):null}const W=V=>({description:(0,s.css)({code:{whiteSpace:"normal",wordWrap:"break-word"},"pre > code":{display:"block"}})});function B({message:V,onClick:z,ariaLabel:w="status"}){const H=(0,f.of)(S);return(0,a.jsx)(b.I,{className:H.buttonStyles,onClick:z,variant:"destructive",icon:"exclamation-triangle",iconSize:"md",tooltip:V||"","aria-label":w,"data-testid":l.Tp.components.Panels.Panel.status("error")})}const S=V=>{const{headerHeight:z,padding:w}=V.components.panel;return{buttonStyles:(0,s.css)({label:"panel-header-state-button",display:"flex",alignItems:"center",justifyContent:"center",padding:V.spacing(w),width:V.spacing(z),height:V.spacing(z),borderRadius:V.shape.radius.default})}};function _({width:V,height:z,children:w,padding:H="md",title:Q="",description:Z="",displayMode:Y="default",titleItems:X,menu:I,dragClass:J,dragClassCancel:ee,hoverHeader:q=!1,hoverHeaderOffset:ne,loadingState:se,statusMessage:oe,statusMessageOnClick:de,leftItems:fe,actions:ae,selectionId:ce,onCancelQuery:ie,onOpenMenu:ve,collapsible:le=!1,collapsed:Ee,onToggleCollapse:Re,onFocus:Oe,onMouseMove:Se,onMouseEnter:Te,onDragStart:_e,showMenuAlways:He=!1}){const tt=(0,f.$j)(),Je=(0,f.of)(A),Ge=(0,i.useId)(),je=(0,i.useId)().replace(/:/g,"_"),{isSelected:Fe,onSelect:Be,isSelectable:Ke}=(0,v.y)(ce),Ue=(0,x.C)(),we=!q,[Xe,nt]=(0,r.A)(!0),[he,xe]=(0,i.useState)(!1),me=i.useCallback(()=>xe(!0),[]),ye=i.useCallback(()=>xe(!1),[]);Ee===void 0&&(Ee=!Xe);const De=He?"always-show":"show-on-hover",Le=Y==="transparent",Ve=T(tt,we),{contentStyle:ze,innerWidth:Ze,innerHeight:Me}=L(H,tt,Ve,Ee,z,V),$e={height:Ve,cursor:J?"move":"auto"},at={width:V,height:Ee?void 0:z},[ct,{width:ft}]=(0,u.A)();fe&&(ae=fe);const Et=typeof Q=="string"?l.Tp.components.Panels.Panel.title(Q):"Panel",St=i.useCallback(mt=>{Ue.check(mt)||ee&&mt.target instanceof Element&&mt.target.closest(`.${ee}`)||setTimeout(()=>Be?.(mt))},[ee,Be,Ue]),Pt=i.useCallback(mt=>{mt.stopPropagation(),Ue.set(mt),_e?.(mt)},[Ue,_e]),Dt=i.useCallback(mt=>{mt.target instanceof Element&&mt.target.closest("button,a,canvas,svg")||Be?.(mt)},[Be]),Ye=(0,a.jsxs)(a.Fragment,{children:[!le&&Q&&(0,a.jsx)("div",{className:Je.title,children:(0,a.jsx)(h.E,{element:"h2",variant:"h6",truncate:!0,title:typeof Q=="string"?Q:void 0,id:je,children:Q})}),le&&(0,a.jsx)("div",{className:Je.title,children:(0,a.jsx)(h.E,{element:"h2",variant:"h6",children:(0,a.jsxs)("button",{type:"button",className:Je.clearButtonStyles,onClick:()=>{nt(),Re&&Re(!Ee)},"aria-expanded":!Ee,"aria-controls":Ee?void 0:Ge,children:[(0,a.jsx)(m.I,{name:Ee?"angle-right":"angle-down","aria-hidden":!!Q,"aria-label":Q?void 0:(0,g.t)("grafana-ui.panel-chrome.aria-label-toggle-collapse","toggle collapse panel")}),(0,a.jsx)(h.E,{variant:"h6",truncate:!0,id:je,children:Q})]})})}),(0,a.jsxs)("div",{className:(0,s.cx)(Je.titleItems,ee),"data-testid":"title-items-container",children:[(0,a.jsx)(U,{description:Z,className:ee}),X]}),se===o.Gu.Streaming&&(0,a.jsx)(d.m,{content:ie?(0,g.t)("grafana-ui.panel-chrome.tooltip-stop-streaming","Stop streaming"):(0,g.t)("grafana-ui.panel-chrome.tooltip-streaming","Streaming"),children:(0,a.jsx)(O,{className:ee,"data-testid":"panel-streaming",onClick:ie,children:(0,a.jsx)(m.I,{name:"circle-mono",size:"md",className:Je.streaming})})}),se===o.Gu.Loading&&ie&&(0,a.jsx)(c,{delay:2e3,children:(0,a.jsx)(d.m,{content:(0,g.t)("grafana-ui.panel-chrome.tooltip-cancel","Cancel query"),children:(0,a.jsx)(O,{className:(0,s.cx)(ee,Je.pointer),"data-testid":"panel-cancel-query",onClick:ie,children:(0,a.jsx)(m.I,{name:"sync-slash",size:"md"})})})}),(0,a.jsx)("div",{className:Je.rightAligned,children:ae&&(0,a.jsx)("div",{className:Je.rightActions,children:K(ae,mt=>mt)})})]});return(0,a.jsxs)("section",{className:(0,s.cx)(Je.container,Le&&Je.transparentContainer,Fe&&"dashboard-selected-element",!Fe&&Ke&&he&&"dashboard-selectable-element"),style:at,"aria-labelledby":Q?je:void 0,"data-testid":Et,tabIndex:0,onFocus:Oe,onMouseMove:Se,onMouseEnter:Te,ref:ct,children:[(0,a.jsx)("div",{className:Je.loadingBarContainer,children:se===o.Gu.Loading?(0,a.jsx)(y.G,{width:ft,ariaLabel:(0,g.t)("grafana-ui.panel-chrome.ariaLabel-panel-loading","Panel loading bar")}):null}),q&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(C,{menu:I,title:typeof Q=="string"?Q:void 0,offset:ne,dragClass:J,onOpenMenu:ve,children:Ye}),oe&&(0,a.jsx)("div",{className:Je.errorContainerFloating,children:(0,a.jsx)(B,{message:oe,onClick:de,ariaLabel:(0,g.t)("grafana-ui.panel-chrome.ariaLabel-panel-status","Panel status")})})]}),we&&(0,a.jsxs)("div",{className:(0,s.cx)(Je.headerContainer,J),style:$e,"data-testid":l.Tp.components.Panels.Panel.headerContainer,onPointerDown:Pt,onMouseEnter:Ke?me:void 0,onMouseLeave:Ke?ye:void 0,onPointerUp:St,children:[oe&&(0,a.jsx)("div",{className:ee,children:(0,a.jsx)(B,{message:oe,onClick:de,ariaLabel:(0,g.t)("grafana-ui.panel-chrome.ariaLabel-panel-status","Panel status")})}),Ye,I&&(0,a.jsx)(D,{menu:I,title:typeof Q=="string"?Q:void 0,placement:"bottom-end",menuButtonClass:(0,s.cx)(Je.menuItem,ee,De),onOpenMenu:ve})]}),!Ee&&(0,a.jsx)("div",{id:Ge,"data-testid":l.Tp.components.Panels.Panel.content,className:(0,s.cx)(Je.content,z===void 0&&Je.containNone),style:ze,onPointerDown:Dt,children:typeof w=="function"?w(Ze,Me):w})]})}const K=(V,z)=>{const w=i.Children.toArray(V).filter(Boolean);return w.length>0?z(w):null},T=(V,z)=>z?V.spacing.gridSize*V.components.panel.headerHeight:0,L=(V,z,w,H,Q,Z)=>{const Y=(V==="md"?z.components.panel.padding:0)*z.spacing.gridSize,X=Y*2,I=1*2;let J=0;Z&&(J=Z-X-I);let ee=0;return Q&&(ee=Q-w-X-I),H&&(ee=w),{contentStyle:{padding:Y},innerWidth:J,innerHeight:ee}},A=V=>{const{background:z,borderColor:w,padding:H}=V.components.panel;return{container:(0,s.css)({label:"panel-container",backgroundColor:z,border:`1px solid ${w}`,position:"relative",borderRadius:V.shape.radius.default,height:"100%",display:"flex",flexDirection:"column",".always-show":{background:"none","&:focus-visible, &:hover":{background:V.colors.secondary.shade}},".show-on-hover":{opacity:"0",visibility:"hidden"},"&:focus-visible, &:hover":{".show-on-hover":{opacity:"1",visibility:"visible"}},"&:focus-visible":(0,p.getFocusStyles)(V),"&:focus-within:not(:focus)":{".show-on-hover":{visibility:"visible",opacity:"1"}}}),transparentContainer:(0,s.css)({label:"panel-transparent-container",backgroundColor:"transparent",border:"1px solid transparent",boxSizing:"border-box","&:hover":{border:`1px solid ${w}`}}),loadingBarContainer:(0,s.css)({label:"panel-loading-bar-container",position:"absolute",top:0,width:"100%",zIndex:1}),containNone:(0,s.css)({contain:"none"}),content:(0,s.css)({label:"panel-content",flexGrow:1,contain:"size layout"}),headerContainer:(0,s.css)({label:"panel-header",display:"flex",alignItems:"center"}),pointer:(0,s.css)({cursor:"pointer"}),streaming:(0,s.css)({label:"panel-streaming",marginRight:0,color:V.colors.success.text,"&:hover":{color:V.colors.success.text}}),title:(0,s.css)({label:"panel-title",display:"flex",padding:V.spacing(0,H),minWidth:0,"& > h2":{minWidth:0}}),items:(0,s.css)({display:"flex"}),item:(0,s.css)({display:"flex",justifyContent:"center",alignItems:"center"}),hiddenMenu:(0,s.css)({visibility:"hidden"}),menuItem:(0,s.css)({label:"panel-menu",border:"none",background:V.colors.secondary.main,"&:hover":{background:V.colors.secondary.shade}}),errorContainerFloating:(0,s.css)({label:"error-container",position:"absolute",left:0,top:0,zIndex:1}),rightActions:(0,s.css)({display:"flex",padding:V.spacing(0,H),gap:V.spacing(1)}),rightAligned:(0,s.css)({label:"right-aligned-container",marginLeft:"auto",display:"flex",alignItems:"center"}),titleItems:(0,s.css)({display:"flex",height:"100%"}),clearButtonStyles:(0,s.css)({alignItems:"center",display:"flex",gap:V.spacing(.5),background:"transparent",border:"none",padding:0,maxWidth:"100%"})}},N=_;N.LoadingIndicator=n.I,N.TitleItem=O},49256:(te,R,e)=>{"use strict";e.d(R,{B:()=>n});var n=(a=>(a.ToggleSelection="select",a.AppendToSelection="append",a))(n||{})},3023:(te,R,e)=>{"use strict";e.d(R,{_:()=>i});var n=e(74848),a=e(22803),s=e(63142);const i=({children:u,className:o,...l})=>{const g=(0,s.of)(r);return(0,n.jsx)("div",{className:(0,a.cx)(g,o),...l,children:u})},r=u=>(0,a.css)({backgroundColor:u.components.panel.background,border:`1px solid ${u.components.panel.borderColor}`,borderRadius:u.shape.radius.default})},63509:(te,R,e)=>{"use strict";e.d(R,{B:()=>r});var n=e(74848),a=e(11594),s=e(99887);const i={[a.kv.grafana]:"grafana",[a.kv.commercial]:"shield",[a.kv.community]:"shield",DEFAULT:"shield-exclamation"},r=({status:o,color:l,signatureType:g,signatureOrg:f,...p})=>{const c=u(o,g,f);return(0,n.jsx)(s.E,{text:c.text,color:c.color,icon:c.icon,tooltip:c.tooltip,...p})};r.displayName="PluginSignatureBadge";function u(o,l,g){o||(o=a.Ac.invalid);const f=i[l||""]||i.DEFAULT;switch(o){case a.Ac.internal:return{text:"Core",color:"blue",tooltip:"Core plugin that is bundled with Grafana"};case a.Ac.valid:return{text:l||"Signed",icon:l?f:"lock",color:"green",tooltip:"Signed and verified plugin"};case a.Ac.invalid:return{text:"Invalid signature",icon:"exclamation-triangle",color:"red",tooltip:"Invalid plugin signature"};case a.Ac.modified:return{text:"Modified signature",icon:"exclamation-triangle",color:"red",tooltip:"Valid signature but content has been modified"};case a.Ac.missing:return{text:"Missing signature",icon:"exclamation-triangle",color:"red",tooltip:"Missing plugin signature"};default:return{text:"Unsigned",icon:"exclamation-triangle",color:"red",tooltip:"Unsigned external plugin"}}}},92505:(te,R,e)=>{"use strict";e.d(R,{X:()=>C});var n=e(74848),a=e(22803),s=e(46942),i=e.n(s),r=e(2543),u=e.n(r),o=e(96540),l=e(52845),g=e(29317),f=e(51898),p=e(16123),c=e(54024),x=e(52513),v=e(21266),m=e(59490),y=e(91272),h=e(93427),d=e(63142),E=e(35484),b=e(35458);class D extends o.PureComponent{constructor(O){super(O),this.lastExecutedValue=null,this.mounted=!1,this.editor=null,this.onChange=(S,_)=>{const K=S.document!==this.state.value.document,T=this.state.value;this.props.onRichValueChange&&this.props.onRichValueChange(S),this.setState({value:S},()=>{if(K){const L=l.default.serialize(T)!==l.default.serialize(S);L&&_&&this.runOnChangeAndRunQuery(),L&&!_&&this.runOnChangeDebounced()}})},this.runOnChange=()=>{const{onChange:S}=this.props,_=l.default.serialize(this.state.value);S&&S(this.cleanText(_))},this.runOnRunQuery=()=>{const{onRunQuery:S}=this.props;S&&(S(),this.lastExecutedValue=this.state.value)},this.runOnChangeAndRunQuery=()=>{this.runOnChange(),this.runOnRunQuery()},this.handleBlur=(S,_,K)=>{const{onBlur:T}=this.props;if(T)T();else{const L=this.lastExecutedValue?l.default.serialize(this.lastExecutedValue):"",A=l.default.serialize(_.value);L!==A&&this.runOnChangeAndRunQuery()}return K()},this.runOnChangeDebounced=(0,r.debounce)(this.runOnChange,500);const{onTypeahead:j,cleanText:U,portalOrigin:W,onWillApplySuggestion:B}=O;this.plugins=[(0,h.Pz)({onTypeahead:j,cleanText:U,portalOrigin:W,onWillApplySuggestion:B}),(0,m.U)({handler:this.runOnChangeAndRunQuery}),(0,v.O)(),(0,p.v)(),(0,y.l)(),(0,x.T)(),(0,c.s)(),...O.additionalPlugins||[]].filter(S=>S),this.state={suggestions:[],typeaheadContext:null,typeaheadPrefix:"",typeaheadText:"",value:(0,b.mO)(O.query||"",O.syntax)}}static{this.defaultProps={onBlur:()=>{}}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}componentDidUpdate(O,j){const{query:U,syntax:W,syntaxLoaded:B}=this.props;if(!O.syntaxLoaded&&B&&this.editor){const _=this.editor.insertText(" ").deleteBackward(1);this.onChange(_.value,!0)}const{value:S}=this.state;U!==O.query&&U!==l.default.serialize(S)&&this.setState({value:(0,b.mO)(U||"",W)})}cleanText(O){return O.replace(/[\r]/g,"")}render(){const{disabled:O,theme:j}=this.props,U=i()("slate-query-field__wrapper",{"slate-query-field__wrapper--disabled":O}),W=P(j);return(0,n.jsx)("div",{className:(0,a.cx)(U,W.wrapper),children:(0,n.jsx)("div",{className:"slate-query-field","data-testid":f.Tp.components.QueryField.container,children:(0,n.jsx)(g.Editor,{ref:B=>this.editor=B,schema:b.yx,autoCorrect:!1,readOnly:this.props.disabled,onBlur:this.handleBlur,onClick:this.props.onClick,onChange:B=>{this.onChange(B.value,!1)},placeholder:this.props.placeholder,plugins:this.plugins,spellCheck:!1,value:this.state.value})})})}}const C=(0,d.cV)(D),P=M=>{const O=(0,E.getFocusStyles)(M);return{wrapper:(0,a.css)({"&:focus-within":O})}}},90811:(te,R,e)=>{"use strict";e.d(R,{cC:()=>c,cb:()=>p});var n=e(74848),a=e(22803),s=e(58521),i=e(96540),r=e(74529),u=e(51898),o=e(92745),l=e(93256),g=e(15356),f=e(7895);const p=["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"];class c extends i.PureComponent{constructor(y){super(y),this.onChangeSelect=h=>{const{onIntervalChanged:d}=this.props;d&&h.value!=null&&d(h.value)}}static{this.offOption={label:"Off",value:"",ariaLabel:"Turn off auto refresh"}}static{this.liveOption={label:"Live",value:"LIVE",ariaLabel:"Turn on live streaming"}}static{this.autoOption={label:"Auto",value:"auto",ariaLabel:"Select refresh from the query range"}}static{this.isLive=y=>y===c.liveOption.value}getVariant(){return this.props.isLive||this.props.primary?"primary":this.props.isOnCanvas?"canvas":"default"}render(){const{onRefresh:y,intervals:h,tooltip:d,value:E,text:b,isLoading:D,noIntervalPicker:C,width:P,showAutoInterval:M}=this.props,O=E||"",j=this.getVariant(),U=v({intervals:h,showAutoInterval:M}),W=U.find(({value:z})=>z===O),B=x(c.offOption.value);let S=W||B;S.label===B.label&&(S={value:""});const _=S.ariaLabel,K=(0,o.t)("refresh-picker.aria-label.duration-selected","Choose refresh time interval with current interval {{durationAriaLabel}} selected",{durationAriaLabel:_}),T=(0,o.t)("refresh-picker.aria-label.choose-interval","Auto refresh turned off. Choose refresh time interval"),L=S.value===""?T:K,A=(0,o.t)("refresh-picker.tooltip.interval-selected","Set auto refresh interval"),N=(0,o.t)("refresh-picker.tooltip.turned-off","Auto refresh off"),V=S.value===""?N:A;return(0,n.jsxs)(l.e,{className:"refresh-picker",children:[(0,n.jsx)(f.I,{"aria-label":b,tooltip:d,onClick:y,variant:j,icon:D?"spinner":"sync",style:P?{width:P}:void 0,"data-testid":u.Tp.components.RefreshPicker.runButtonV2,children:b}),!C&&(0,n.jsx)(g.f,{className:(0,a.css)({borderTopLeftRadius:"unset",borderBottomLeftRadius:"unset"}),value:S,options:U,onChange:this.onChangeSelect,variant:j,"data-testid":u.Tp.components.RefreshPicker.intervalButtonV2,"aria-label":L,tooltip:V})]})}}function x(m){switch(m){case c.liveOption.value:return{label:(0,o.t)("refresh-picker.live-option.label","Live"),value:m,ariaLabel:(0,o.t)("refresh-picker.live-option.aria-label","Turn on live streaming")};case c.offOption.value:return{label:(0,o.t)("refresh-picker.off-option.label","Off"),value:m,ariaLabel:(0,o.t)("refresh-picker.off-option.aria-label","Turn off auto refresh")};case c.autoOption.value:return{label:(0,o.t)("refresh-picker.auto-option.label",c.autoOption.label),value:m,ariaLabel:(0,o.t)("refresh-picker.auto-option.aria-label",c.autoOption.ariaLabel)}}return{label:m,value:m}}function v({intervals:m=p,showAutoInterval:y=!1}={}){const h=m.map(d=>{const E=(0,r.E9)(d),b=(0,s.a)(E);return{label:d,value:d,ariaLabel:b}});return y&&h.unshift(x(c.autoOption.value)),h.unshift(x(c.offOption.value)),h}},70663:(te,R,e)=>{"use strict";e.d(R,{I:()=>s});var n=e(96540),a=e(63704);function s({component:i,content:r,...u}){return n.createElement(i||"span",{dangerouslySetInnerHTML:{__html:a.sQ.sanitize(r)},...u})}},23659:(te,R,e)=>{"use strict";e.d(R,{L:()=>o});var n=e(74848),a=e(2543),s=e.n(a),i=e(92745),r=e(45861),u=e(94959);const o=({label:l="Password",labelWidth:g,inputWidth:f=12,onReset:p,isConfigured:c,tooltip:x,placeholder:v="Password",interactive:m,...y})=>(0,n.jsx)(u.z,{label:l,tooltip:x,interactive:m,labelWidth:g,inputEl:c?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("input",{type:"text",className:`gf-form-input width-${f}`,disabled:!0,value:"configured",...(0,a.omit)(y,"value")}),(0,n.jsx)(r.$n,{onClick:p,variant:"secondary",type:"button",children:(0,n.jsx)(i.x6,{i18nKey:"grafana-ui.secret-form-field.reset",children:"Reset"})})]}):(0,n.jsx)("input",{type:"password",className:`gf-form-input width-${f}`,placeholder:v,...y})});o.displayName="SecretFormField"},48767:(te,R,e)=>{"use strict";e.d(R,{L4:()=>o});var n=e(74848),a=e(45861),s=e(63527),i=e(41654);const r="configured",u="Reset",o=({isConfigured:l,onReset:g,...f})=>(0,n.jsxs)(i.B,{children:[!l&&(0,n.jsx)(s.p,{...f,type:"password"}),l&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.p,{...f,type:"text",disabled:!0,value:r}),(0,n.jsx)(a.$n,{onClick:g,variant:"secondary",children:u})]})]})},40601:(te,R,e)=>{"use strict";e.d(R,{lp:()=>p});var n=e(74848),a=e(22803),s=e(63142),i=e(45861),r=e(31286),u=e(41654),o=e(87105);const l="configured",g="Reset",f=c=>({configuredStyle:(0,a.css)({minHeight:c.spacing(c.components.height.md),paddingTop:c.spacing(.5),resize:"none"})}),p=({isConfigured:c,onReset:x,...v})=>{const m=(0,s.of)(f);return(0,n.jsxs)(u.B,{children:[(0,n.jsxs)(r.a,{children:[!c&&(0,n.jsx)(o.f,{...v}),c&&(0,n.jsx)(o.f,{...v,rows:1,disabled:!0,value:l,className:(0,a.cx)(m.configuredStyle)})]}),c&&(0,n.jsx)(i.$n,{onClick:x,variant:"secondary",children:g})]})}},61875:(te,R,e)=>{"use strict";e.d(R,{Y:()=>f});var n=e(74848),a=e(22803),s=e(2543),i=e.n(s),r=e(63142),u=e(79233),o=e(89467),l=e(37864),g=e(3431);function f({options:p,value:c,onChange:x,Component:v,className:m,allowCustomValue:y,allowEmptyValue:h,placeholder:d,disabled:E,inputMinWidth:b,inputPlaceholder:D,onExpandedChange:C,autofocus:P=!1,...M}){const[O,j,U,W]=(0,g.Q)(P,C),B=b?Math.max(b,j):j,S=(0,r.of)(l.m);if(!U){const _=(0,s.isObject)(c)?c.label:c,K=_!=null?String(_):void 0;return(0,n.jsx)(O,{disabled:E,Component:v||(0,n.jsx)(u.c,{className:(0,a.cx)(S.segment,{[S.queryPlaceholder]:d!==void 0&&!c,[S.disabled]:E},m),children:K||d})})}return(0,n.jsx)(o.a,{...M,value:c&&!(0,s.isObject)(c)?{value:c}:c,placeholder:D,options:p,width:B,onClickOutside:()=>W(!1),allowCustomValue:y,allowEmptyValue:h,onChange:_=>{W(!1),x(_)}})}},76671:(te,R,e)=>{"use strict";e.d(R,{s:()=>c});var n=e(74848),a=e(22803),s=e(2543),i=e.n(s),r=e(41053),u=e(92745),o=e(63142),l=e(79233),g=e(89467),f=e(37864),p=e(3431);function c({value:v,onChange:m,loadOptions:y,reloadOptionsOnChange:h=!1,Component:d,className:E,allowCustomValue:b,allowEmptyValue:D,disabled:C,placeholder:P,inputMinWidth:M,inputPlaceholder:O,autofocus:j=!1,onExpandedChange:U,noOptionMessageHandler:W=x,...B}){const[S,_]=(0,r.A)(y,[y]),[K,T,L,A]=(0,p.Q)(j,U),N=M?Math.max(M,T):T,V=(0,o.of)(f.m);if(!L){const z=(0,s.isObject)(v)?v.label:v,w=z!=null?String(z):void 0;return(0,n.jsx)(K,{onClick:h?void 0:_,disabled:C,Component:d||(0,n.jsx)(l.c,{className:(0,a.cx)(V.segment,{[V.queryPlaceholder]:P!==void 0&&!v,[V.disabled]:C},E),children:w||P})})}return(0,n.jsx)(g.a,{...B,value:v&&!(0,s.isObject)(v)?{value:v}:v,placeholder:O,options:S.value??[],loadOptions:h?_:void 0,width:N,noOptionsMessage:W(S),allowCustomValue:b,allowEmptyValue:D,onClickOutside:()=>{A(!1)},onChange:z=>{A(!1),m(z)}})}function x(v){return v.loading?(0,u.t)("grafana-ui.segment-async.loading","Loading options..."):v.error?(0,u.t)("grafana-ui.segment-async.error","Failed to load options"):(0,u.t)("grafana-ui.segment-async.no-options","No options found")}},3263:(te,R,e)=>{"use strict";e.d(R,{o:()=>p});var n=e(74848),a=e(22803),s=e(96540),i=e(29647),r=e(63142),u=e(53568),o=e(79233),l=e(37864),g=e(3431);const f=14;function p({value:c,onChange:x,Component:v,className:m,placeholder:y,inputPlaceholder:h,disabled:d,autofocus:E=!1,onExpandedChange:b,...D}){const C=(0,s.useRef)(null),[P,M]=(0,s.useState)(c),[O,j]=(0,s.useState)((0,u.kD)((c||"").toString(),f).width),[U,,W,B]=(0,g.Q)(E,b),S=(0,r.of)(l.m);if((0,i.A)(C,()=>{B(!1),x(P)}),!W)return(0,n.jsx)(U,{disabled:d,Component:v||(0,n.jsx)(o.c,{className:(0,a.cx)(S.segment,{[S.queryPlaceholder]:y!==void 0&&!P,[S.disabled]:d},m),children:c||y})});const _=(0,a.css)({width:`${Math.max(O+20,32)}px`});return(0,n.jsx)("input",{...D,ref:C,autoFocus:!0,className:(0,a.cx)("gf-form gf-form-input",_),value:P,placeholder:h,onChange:K=>{const{width:T}=(0,u.kD)(K.target.value,f);j(T),M(K.target.value)},onBlur:()=>{B(!1),x(P)},onKeyDown:K=>{[13,27].includes(K.keyCode)&&(B(!1),x(P))}})}},52042:(te,R,e)=>{"use strict";e.d(R,{L:()=>u});var n=e(74848),a=e(22803),s=e(63142),i=e(97095),r=e(79233);const u=({label:l,htmlFor:g,children:f,fill:p})=>{const c=(0,s.of)(o);return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(i.C,{children:[(0,n.jsx)(r.c,{htmlFor:g,width:12,className:c.label,children:l}),f,p&&(0,n.jsx)("div",{className:c.fill,children:(0,n.jsx)(r.c,{children:""})})]})})},o=l=>({label:(0,a.css)({color:l.colors.primary.text}),fill:(0,a.css)({flexGrow:1,marginBottom:l.spacing(.5)})})},89467:(te,R,e)=>{"use strict";e.d(R,{a:()=>r});var n=e(74848),a=e(96540),s=e(63142),i=e(18857);function r({value:u,placeholder:o="",options:l=[],onChange:g,onClickOutside:f,loadOptions:p=void 0,width:c,noOptionsMessage:x="",allowCustomValue:v=!1,allowEmptyValue:m=!1,...y}){const h=(0,a.useRef)(null),d=(0,s.$j)();let E=c>0?c/d.spacing.gridSize:void 0,b,D={};return p?(b=i.DW,D={loadOptions:p,defaultOptions:!0}):b=i.l6,(0,n.jsx)("div",{...y,ref:h,children:(0,n.jsx)(b,{width:E,noOptionsMessage:x,placeholder:o,autoFocus:!0,isOpen:!0,onChange:g,options:l,value:u,closeMenuOnSelect:!1,onCloseMenu:()=>{if(h&&h.current){const C=h.current.querySelector('input[id^="react-select-"]');C&&(C.value||m)?g({value:C.value,label:C.value}):f()}},allowCustomValue:v,...D})})}},37864:(te,R,e)=>{"use strict";e.d(R,{m:()=>a});var n=e(22803);const a=s=>{const i="v1"in s?s.v1.palette:s.palette;return{segment:(0,n.css)({cursor:"pointer",width:"auto"}),queryPlaceholder:(0,n.css)({color:i.gray2}),disabled:(0,n.css)({cursor:"not-allowed",opacity:.65,boxShadow:"none"})}}},3431:(te,R,e)=>{"use strict";e.d(R,{Q:()=>r});var n=e(74848),a=e(96540),s=e(63142),i=e(45861);const r=(u,o)=>{const l=(0,a.useRef)(null),g=(0,s.of)(i.my),[f,p]=(0,a.useState)(u),[c,x]=(0,a.useState)(0),v=y=>{p(y),o&&o(y)};return[({Component:y,onClick:h,disabled:d})=>(0,n.jsx)("button",{type:"button",className:g,ref:l,disabled:d,onClick:()=>{v(!0),l&&l.current&&x(l.current.clientWidth*1.25),h?.()},children:y}),c,f,v]}},82143:(te,R,e)=>{"use strict";e.d(R,{u:()=>x});var n=e(2543),a=e.n(n),s=e(96540),i=e(13752),r=e(62467),u=e(11150),o=e(96083),l=e(63720),g=e(59099),f=e(8934),p=e(90811);function c(v){return{label:v,value:stringToMs(v)}}class x extends s.PureComponent{constructor(m){super(m),this.propsSubject=new i.B,this.subscription=null}componentDidMount(){this.subscription=this.propsSubject.pipe((0,l.n)(m=>p.cC.isLive(m.interval)?(0,r.of)({}):m.loading?u.t:(0,o.Y)((0,f.dc)(m.interval))),(0,g.M)(()=>this.props.func())).subscribe(),this.propsSubject.next(this.props)}componentDidUpdate(m){p.cC.isLive(m.interval)&&p.cC.isLive(this.props.interval)||(0,n.isEqual)(m,this.props)||this.propsSubject.next(this.props)}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe(),this.propsSubject.unsubscribe()}render(){return null}}},59795:(te,R,e)=>{"use strict";e.d(R,{I1:()=>E,_$:()=>m,gl:()=>c});var n=e(2543),a=e.n(n),s=e(38919),i=e(46644),r=e(33553),u=e(35987),o=e(64394),l=e(60519),g=e(36394),f=e(739);const p=["reduceOptions","orientation"];function c(C,P,M){let O=C.options;if(C.fieldConfig=C.fieldConfig||{defaults:{},overrides:[]},P==="singlestat"&&M.angular)return v(C,M);if(P==="graph")return x(C,M);for(const j of p)M.hasOwnProperty(j)&&(O[j]=(0,n.cloneDeep)(M[j]));return O}function x(C,P){const M=P.angular,O={orientation:s.wV.Auto,reduceOptions:{values:!1,calcs:[]},legend:{displayMode:f.lm.List,showLegend:!0,placement:"bottom",calcs:[]}};if(M.xaxis?.mode==="series"){C.fieldConfig={...C.fieldConfig,defaults:{...C.fieldConfig.defaults,color:{mode:"palette-classic"}}},M.xaxis.values&&(O.reduceOptions.calcs=D(M.xaxis.values));const j=M.legend;if(j){if(j.show?O.legend.displayMode=j.alignAsTable?f.lm.Table:f.lm.List:O.legend.showLegend=!1,j.rightSide&&(O.legend.placement="right"),j.values){const U=(0,n.pickBy)(j,n.identity);O.legend.calcs=b(U)}j.sideWidth&&(O.legend.width=j.sideWidth)}}return O}function v(C,P){const M=P.angular,O=i.AS.getIfExists(M.valueName),j={reduceOptions:{calcs:[O?O.id:i.gy.mean]},orientation:s.wV.Horizontal},U={};if(M.format&&(U.unit=M.format),M.tableColumn&&(j.reduceOptions.fields=`/^${M.tableColumn}$/`),M.nullPointMode&&(U.nullValueMode=M.nullPointMode),M.nullText&&(U.noValue=M.nullText),(M.decimals||M.decimals===0)&&(U.decimals=M.decimals),M.thresholds&&M.colors){const B=M.thresholds.split(",").map(_=>Number(_.trim())),S=[];for(const _ of M.colors){const K=S.length-1;K>=0?S.push({value:B[K],color:_}):S.push({value:-1/0,color:_})}U.thresholds={mode:r.O.Absolute,steps:S}}const W=(0,u.bh)(M,U.thresholds);return W&&W.length&&(U.mappings=W),M.gauge&&M.gauge.show&&(U.min=M.gauge.minValue,U.max=M.gauge.maxValue),C.fieldConfig.defaults=U,j}function m(C){if(!C.options)return{reduceOptions:{calcs:[i.gy.mean]},orientation:s.wV.Horizontal};const P=parseFloat(C.pluginVersion||"6.1");let M=C.options;P<6.2&&(M=h(M)),P<6.3&&(M=y(M));const{fieldOptions:O}=M;if(P<6.6&&O){if(O&&O.override){const{override:W,...B}=M.fieldOptions;M={...M,fieldOptions:{...B,overrides:[]}}}let j=O?.defaults?.thresholds;j?delete O.defaults.thresholds:(j=O?.thresholds,delete O.thresholds),j&&(O.defaults.thresholds={mode:r.O.Absolute,steps:j});const{defaults:U}=O;U.color&&typeof U.color=="string"&&(U.color={mode:o.Y.Fixed,fixedColor:U.color}),(0,l.BF)(U)}if(P<7&&(C.fieldConfig=C.fieldConfig||{defaults:{},overrides:[]},C.fieldConfig={defaults:O&&O.defaults?{...C.fieldConfig.defaults,...O.defaults}:C.fieldConfig.defaults,overrides:O&&O.overrides?[...C.fieldConfig.overrides,...O.overrides]:C.fieldConfig.overrides},O&&(M.reduceOptions={values:O.values,limit:O.limit,calcs:O.calcs}),delete M.fieldOptions),P<7.1){const j=C.fieldConfig.defaults.title;j!=null&&(C.fieldConfig.defaults.displayName=j,delete C.fieldConfig.defaults.title)}if(P<8){const j=C.fieldConfig?.defaults;let U=j?.unit;U==="percent"?((0,n.isNumber)(j.min)||(j.min=0),(0,n.isNumber)(j.max)||(j.max=100)):U==="percentunit"&&((0,n.isNumber)(j.min)||(j.min=0),(0,n.isNumber)(j.max)||(j.max=1))}return M}function y(C){const{fieldOptions:P}=C;if(!P)return C;const{mappings:M,...O}=C.fieldOptions;let j;return C.thresholds&&(j={mode:r.O.Absolute,steps:d(C.thresholds)}),{...C,fieldOptions:{...O,defaults:{...P.defaults,mappings:M,thresholds:j}}}}function h(C){const{valueOptions:P}=C;if(!P)return C;const M={},O={};if(M.mappings=C.valueMappings,M.thresholds=C.thresholds,M.defaults=O,O.unit=P.unit,O.decimals=P.decimals,P.stat){const U=i.AS.get(P.stat);U&&(M.calcs=[U.id])}O.min=C.minValue,O.max=C.maxValue;const j={...C,fieldOptions:M};return(0,n.omit)(j,"valueMappings","thresholds","valueOptions","minValue","maxValue")}function d(C){if(!C||!C.length)return;const P=C.map(M=>({value:M.value===null?-1/0:M.value,color:M.color}));return(0,g.RU)(P),P[0].value=-1/0,P}function E(C){return(0,u.bh)(C)}function b(C){const P=[];for(const M in C){const O=i.AS.getIfExists(M);O&&P.push(O.id)}return P}function D(C){const P=[];return C?.forEach(M=>{Object.values(i.gy).includes(M)?P.push(M):M==="current"?P.push(i.gy.lastNotNull):M==="total"?P.push(i.gy.sum):M==="avg"&&P.push(i.gy.mean)}),C?P:[i.gy.sum]}},21103:(te,R,e)=>{"use strict";e.d(R,{F:()=>c});var n=e(74848),a=e(22803),s=e(17437),i=e(69156),r=e(96540),u=e(63142),o=e(5994);const l=x=>{const{value:v,children:m,visible:y,placement:h,tipFormatter:d,...E}=x,b=(0,r.useRef)(null),D=(0,r.useRef)(null),C=(0,u.of)(g);function P(){D.current!==null&&cancelAnimationFrame(D.current)}function M(){D.current=requestAnimationFrame(()=>{b.current?.forceAlign()})}return(0,r.useEffect)(()=>(y?M():P(),P),[v,y]),(0,n.jsx)(o.A,{overlayClassName:C.tooltip,placement:h,overlay:d??v,overlayInnerStyle:{minHeight:"auto"},ref:b,visible:y,...E,children:m})},g=x=>({tooltip:(0,a.css)({position:"absolute",display:"block",visibility:"visible",fontSize:x.typography.bodySmall.fontSize,opacity:.9,padding:3,zIndex:x.zIndex.tooltip})}),f=l;var p=e(91302);const c=({min:x,max:v,onChange:m,onAfterChange:y,orientation:h="horizontal",reverse:d,step:E,formatTooltipResult:b,value:D,tooltipAlwaysVisible:C=!0})=>{const P=(0,r.useCallback)(W=>{m?.(typeof W=="number"?[W,W]:W)},[m]),M=(0,r.useCallback)(W=>{y?.(typeof W=="number"?[W,W]:W)},[y]),O=h==="horizontal",j=(0,u.of)(p.$,O),U=(W,B)=>(0,n.jsx)(f,{value:B.value,visible:C||B.dragging,tipFormatter:b?()=>b(B.value):void 0,placement:O?"top":"right",children:W});return(0,n.jsxs)("div",{className:(0,a.cx)(j.container,j.slider),children:[(0,n.jsx)(s.Global,{styles:j.tooltip}),(0,n.jsx)(i.A,{min:x,max:v,step:E,defaultValue:D,range:!0,onChange:P,onChangeComplete:M,vertical:!O,reverse:d,handleRender:U})]})};c.displayName="RangeSlider"},91302:(te,R,e)=>{"use strict";e.d(R,{$:()=>s});var n=e(22803),a=e(17437);const s=(i,r,u=!1)=>{const{spacing:o}=i,l=i.colors.border.strong,g=i.colors.primary.main,f=i.colors.primary.main,c=`box-shadow: 0px 0px 0px 6px ${i.colors.primary.transparent}`;return{container:(0,n.css)({width:"100%",margin:r?"inherit":o(1,3,1,1),paddingBottom:r&&u?i.spacing(1):"inherit",height:r?"auto":"100%"}),slider:(0,n.css)`
      .rc-slider {
        display: flex;
        flex-grow: 1;
        margin-left: 7px; // half the size of the handle to align handle to the left on 0 value
      }
      .rc-slider-mark {
        top: ${i.spacing(1.75)};
      }
      .rc-slider-mark-text {
        color: ${i.colors.text.disabled};
        font-size: ${i.typography.bodySmall.fontSize};
      }
      .rc-slider-mark-text-active {
        color: ${i.colors.text.primary};
      }
      .rc-slider-handle {
        border: none;
        background-color: ${f};
        box-shadow: ${i.shadows.z1};
        cursor: pointer;
        opacity: 1;
      }

      .rc-slider-handle:hover,
      .rc-slider-handle:active,
      .rc-slider-handle-click-focused:focus {
        ${c};
      }

      // The triple class names is needed because that's the specificity used in the source css :(
      .rc-slider-handle-dragging.rc-slider-handle-dragging.rc-slider-handle-dragging,
      .rc-slider-handle:focus-visible {
        box-shadow: 0 0 0 5px ${i.colors.text.primary};
      }

      .rc-slider-dot,
      .rc-slider-dot-active {
        background-color: ${i.colors.text.primary};
        border-color: ${i.colors.text.primary};
      }

      .rc-slider-track {
        background-color: ${g};
      }
      .rc-slider-rail {
        background-color: ${l};
        cursor: pointer;
      }
    `,tooltip:(0,a.css)`
      body {
        .rc-slider-tooltip {
          cursor: grab;
          user-select: none;
          z-index: ${i.zIndex.tooltip};
        }

        .rc-slider-tooltip-inner {
          color: ${i.colors.text.primary};
          background-color: transparent !important;
          border-radius: 0;
          box-shadow: none;
        }

        .rc-slider-tooltip-placement-top .rc-slider-tooltip-arrow {
          display: none;
        }

        .rc-slider-tooltip-placement-top {
          padding: 0;
        }
      }
    `,sliderInput:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",width:"100%"}),sliderInputVertical:(0,n.css)({flexDirection:"column",height:"100%",".rc-slider":{margin:0,order:2}}),sliderInputField:(0,n.css)({marginLeft:i.spacing(3),input:{textAlign:"center"}}),sliderInputFieldVertical:(0,n.css)({margin:`0 0 ${i.spacing(3)} 0`,order:1})}}},53431:(te,R,e)=>{"use strict";e.d(R,{O:()=>h});var n=e(74848),a=e(2543),s=e(96540),i=e(34455),r=e(76732),u=e(95004),o=e(76637),l=e(739),g=e(92790),f=e(47276),p=e(36192),c=e(8721),x=e(41119),v=e(63409);function m(d,E){const b=d.y.values.length,D={...d.y.config,...E},C=d.x??{name:"",values:[...Array(b).keys()],type:u.PU.number,config:{}};let P={refId:"sparkline",fields:[C,{...d.y,config:D}],length:b};return(0,c.g2)(C.values)||(P=(0,x.ES)(P,0)),(0,v.M)({frame:P,refFieldPseudoMin:d.timeRange?.from.valueOf(),refFieldPseudoMax:d.timeRange?.to.valueOf()})}const y={drawStyle:l.GR.Line,showPoints:l.yL.Auto,axisPlacement:l.vM.Hidden,pointSize:2};class h extends s.PureComponent{constructor(E){super(E);const b=m(E.sparkline,E.config);this.state={data:(0,p.bq)(b,(0,p.ro)(b)),alignedDataFrame:b,configBuilder:this.prepareConfig(b)}}static getDerivedStateFromProps(E,b){const D=m(E.sparkline,E.config),C=(0,i.C)(D);return C?{...b,data:(0,p.bq)(C,(0,p.ro)(C)),alignedDataFrame:C}:{...b}}componentDidUpdate(E,b){const{alignedDataFrame:D}=this.state;if(!D)return;let C=!1;if(E.sparkline!==this.props.sparkline){const P=!(0,r.bW)(this.state.alignedDataFrame,b.alignedDataFrame),M=!(0,a.isEqual)(D.fields[1].state?.range,b.alignedDataFrame.fields[1].state?.range);C=P||M}else C=!(0,a.isEqual)(E.config,this.props.config);C&&this.setState({configBuilder:this.prepareConfig(D)})}getYRange(E){let{min:b,max:D}=this.state.alignedDataFrame.fields[1].state?.range;const C=+this.state.alignedDataFrame.fields[1].config?.noValue;return Number.isNaN(C)||(b=Math.min(b,+C),D=Math.max(D,+C)),b===D?(b===0?D=100:(b=0,D*=2),[b,D]):[Math.max(b,E.config.min??-1/0),Math.min(D,E.config.max??1/0)]}prepareConfig(E){const{theme:b}=this.props,D=new f.e;D.setCursor({show:!1,x:!1,y:!1});const C=E.fields[0];D.addScale({scaleKey:"x",orientation:l.Lt.Horizontal,direction:l.ON.Right,isTime:!1,range:()=>{const{sparkline:P}=this.props;if(P.x){if(P.timeRange&&P.x.type===u.PU.time)return[P.timeRange.from.valueOf(),P.timeRange.to.valueOf()];const M=P.x.values;return[M[0],M[M.length-1]]}return[0,P.y.values.length-1]}}),D.addAxis({scaleKey:"x",theme:b,placement:l.vM.Hidden});for(let P=0;P<E.fields.length;P++){const M=E.fields[P],O=M.config,j={...y,...O.custom};if(M===C||M.type!==u.PU.number)continue;const U=O.unit||"__fixed";D.addScale({scaleKey:U,orientation:l.Lt.Vertical,direction:l.ON.Up,range:()=>this.getYRange(M)}),D.addAxis({scaleKey:U,theme:b,placement:l.vM.Hidden});const W=(0,o.Qi)(M),B=W.getCalculator(M,b)(0,0),S=j.drawStyle===l.GR.Points?l.yL.Always:j.showPoints;D.addSeries({pxAlign:!1,scaleKey:U,theme:b,colorMode:W,thresholds:O.thresholds,drawStyle:j.drawStyle,lineColor:j.lineColor??B,lineWidth:j.lineWidth,lineInterpolation:j.lineInterpolation,showPoints:S,pointSize:j.pointSize,fillOpacity:j.fillOpacity,fillColor:j.fillColor,lineStyle:j.lineStyle,gradientMode:j.gradientMode,spanNulls:j.spanNulls})}return D}render(){const{data:E,configBuilder:b}=this.state,{width:D,height:C}=this.props;return(0,n.jsx)(g.Z,{data:E,config:b,width:D,height:C})}}},93008:(te,R,e)=>{"use strict";e.d(R,{h:()=>p});var n=e(22803),a=e(2543),s=e.n(a),i=e(96540),r=e(63142),u=e(45897);const o=.3,l=new Set(["ArrowUp","ArrowDown"]),g=new Set(["ArrowLeft","ArrowRight"]),f={row:{dim:"width",axis:"clientX",min:"minWidth",max:"maxWidth"},column:{dim:"height",axis:"clientY",min:"minHeight",max:"maxHeight"}};function p(y){const{direction:h,initialSize:d=y.usePixels?300:.5,dragPosition:E="middle",onResizing:b,onSizeChanged:D,usePixels:C}=y,P=m(y.handleSize),M=(0,i.useRef)(null),O=(0,i.useRef)(null),j=(0,i.useRef)(null),U=(0,i.useRef)(null),W=(0,i.useRef)(null),B=(0,i.useRef)(null),S=(0,i.useRef)(void 0),_=(0,i.useRef)(void 0),K=f[h].dim,T=f[h].axis,L=f[h].min,A=f[h].max,N=(0,i.useRef)(null),V=(0,i.useCallback)(ce=>{!O.current||!j.current||(B.current=O.current.getBoundingClientRect()[K],W.current=U.current.getBoundingClientRect()[K],N.current=ce[T],M.current.setPointerCapture(ce.pointerId),C?S.current=x(j.current,C):S.current=x(O.current),_.current=void 0)},[K,T,C]),z=(0,i.useCallback)(ce=>{if(!W.current||!B.current||!j.current)return;const ie=B.current,ve=W.current-ie-P,le=S.current;if(C){const Ee=(0,a.clamp)(ve-ce,le[L],le[A]);j.current.style.flexBasis=`${Ee}px`,M.current.ariaValueNow=`${Ee}`,b?.(Ee,ie+ce,Ee)}else{const Ee=(0,a.clamp)(B.current+ce,le[L],le[A]),Re=Ee/(W.current-P);O.current.style.flexGrow=`${Re}`,j.current.style.flexGrow=`${1-Re}`,M.current.ariaValueNow=c(Ee,le[L],le[A]),b?.(Re,Ee,ve-ce)}},[b,P,C,L,A]),w=(0,i.useCallback)(ce=>{N.current!==null&&z(ce[T]-N.current)},[z,T]),H=(0,i.useCallback)(ce=>{ce.preventDefault(),ce.stopPropagation(),N.current=null,M.current.releasePointerCapture(ce.pointerId);const ie=O.current.getBoundingClientRect()[K],ve=W.current-ie-P;D?.(parseFloat(O.current.style.flexGrow),ie,ve)},[D,P,K]),Q=(0,i.useRef)(new Set),Z=(0,i.useRef)(null),Y=(0,i.useCallback)(ce=>{if(Q.current.size===0){Z.current=null;return}else if(B.current===null)return;const le=(ce-(Z.current??ce))*o;let Ee=0;h==="row"?(Q.current.has("ArrowLeft")&&(Ee-=le),Q.current.has("ArrowRight")&&(Ee+=le)):(Q.current.has("ArrowUp")&&(Ee-=le),Q.current.has("ArrowDown")&&(Ee+=le)),B.current=O.current.getBoundingClientRect()[K],W.current=U.current.getBoundingClientRect()[K],z(Ee),Z.current=ce,window.requestAnimationFrame(Y)},[h,K,z]),X=(0,i.useCallback)(ce=>{if(!O.current||!j.current||!M.current||!U.current||!(h==="column"&&l.has(ce.key)||h==="row"&&g.has(ce.key))||Q.current.has(ce.key))return;if(_.current=void 0,ce.preventDefault(),ce.stopPropagation(),B.current=O.current.getBoundingClientRect()[K],W.current=U.current.getBoundingClientRect()[K],C?S.current=x(j.current):S.current=x(O.current),!Q.current.has(ce.key)){const ve=Q.current.size===0;Q.current.add(ce.key),ve&&window.requestAnimationFrame(Y)}},[h,Y,,K,C]),I=(0,i.useCallback)(ce=>{if(!(h==="row"&&!g.has(ce.key)||h==="column"&&!l.has(ce.key))&&(Q.current.delete(ce.key),B.current!==null)){const ie=W.current-B.current-P;D?.(parseFloat(O.current.style.flexGrow),B.current,ie)}},[h,D,P]),J=(0,i.useCallback)(()=>{!O.current||!j.current||(C?j.current.style.flexBasis=`${d}px`:(O.current.style.flexGrow="0.5",j.current.style.flexGrow="0.5",B.current=O.current.getBoundingClientRect()[K],M.current.ariaValueNow="50"))},[K,C,d]),ee=(0,i.useCallback)(()=>{if(Q.current.size>0&&(Q.current.clear(),N.current=null,typeof B.current=="number")){const ce=W.current-B.current-P;D?.(parseFloat(O.current.style.flexGrow),B.current,ce)}},[D,P]),q=(0,r.of)(v,h),ne=(0,r.of)(u.l,E),se=h==="column"?ne.dragHandleHorizontal:ne.dragHandleVertical,oe=(0,i.useId)(),de={flexGrow:(0,a.clamp)(d,0,1),[L]:"min-content"},fe={flexGrow:(0,a.clamp)(1-d,0,1),[L]:"min-content"};C&&(de.flexGrow=1,fe.flexGrow="unset",fe.flexBasis=`${d}px`);const ae=`start-panel-${oe}`;return{containerProps:{ref:U,className:q.container},primaryProps:{ref:O,className:q.panel,style:de,id:ae},secondaryProps:{ref:j,className:q.panel,style:fe},splitterProps:{onPointerUp:H,onPointerDown:V,onPointerMove:w,onKeyDown:X,onKeyUp:I,onDoubleClick:J,onBlur:ee,ref:M,style:{[K]:`${P}px`},role:"separator","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":d*100,"aria-controls":ae,"aria-label":"Pane resize widget",tabIndex:0,className:se}}}function c(y,h,d){return`${(0,a.clamp)((y-h)/(d-h)*100,0,100)}`}function x(y,h){const d=document.body.style.overflow,E=y.style.width,b=y.style.height,D=y.style.flexGrow,C=y.style.flexBasis;document.body.style.overflow="hidden",y.style.flexGrow="0",y.style.flexBasis="0";const{width:P,height:M}=y.getBoundingClientRect();y.style.flexGrow="100";const{width:O,height:j}=y.getBoundingClientRect();return document.body.style.overflow=d,y.style.width=E,y.style.height=b,y.style.flexGrow=D,y.style.flexBasis=C,{minWidth:P,maxWidth:O,minHeight:M,maxHeight:j}}function v(y,h){return{container:(0,n.css)({display:"flex",flexDirection:h==="row"?"row":"column",width:"100%",flexGrow:1,overflow:"hidden"}),panel:(0,n.css)({display:"flex",position:"relative",flexBasis:0})}}function m(y="md"){return{xs:4,sm:8,md:16,lg:32}[y]}},34107:(te,R,e)=>{"use strict";e.d(R,{S:()=>o});var n=e(74848),a=e(2543),s=e.n(a),i=e(96540),r=e(46644),u=e(18857);class o extends i.PureComponent{constructor(){super(...arguments),this.checkInput=()=>{const{stats:g,allowMultiple:f,defaultStat:p,onChange:c}=this.props,x=r.AS.list(g);if(x.length!==g.length){const v=x.map(y=>y.id),m=(0,a.difference)(g,v);console.warn("Unknown stats",m,g),c(x.map(y=>y.id))}!f&&g.length>1&&(console.warn("Removing extra stat",g),c([g[0]])),p&&g.length<1&&c([p])},this.onSelectionChange=g=>{const{onChange:f}=this.props;Array.isArray(g)?f(g.map(p=>p.value)):f(g&&g.value?[g.value]:[])}}static{this.defaultProps={allowMultiple:!1}}componentDidMount(){this.checkInput()}componentDidUpdate(g){this.checkInput()}render(){const{stats:g,allowMultiple:f,defaultStat:p,placeholder:c,className:x,menuPlacement:v,width:m,inputId:y,filterOptions:h}=this.props,d=r.AS.selectOptions(g,h);return(0,n.jsx)(u.l6,{value:d.current,className:x,isClearable:!p,isMulti:f,width:m,isSearchable:!0,options:d.options,placeholder:c,onChange:this.onSelectionChange,menuPlacement:v,inputId:y})}}},21285:(te,R,e)=>{"use strict";e.d(R,{K:()=>p,d:()=>f});var n=e(74848),a=e(22803),s=e(2543),i=e.n(s),r=e(96540),u=e(37615),o=e(63142),l=e(35484),g=e(30703);const f=(0,r.forwardRef)(({value:x,checked:v,onChange:m,id:y,label:h,disabled:d,invalid:E=!1,...b},D)=>{v&&(0,u.l)("Switch","checked prop","value");const C=(0,o.of)(c),P=(0,r.useRef)(y||(0,s.uniqueId)("switch-"));return(0,n.jsxs)("div",{className:(0,a.cx)(C.switch,E&&C.invalid),children:[(0,n.jsx)("input",{type:"checkbox",role:"switch",disabled:d,checked:x,onChange:M=>{!d&&m?.(M)},id:P.current,...b,ref:D}),(0,n.jsx)("label",{htmlFor:P.current,"aria-label":h,children:(0,n.jsx)(g.I,{name:"check",size:"xs"})})]})});f.displayName="Switch";const p=(0,r.forwardRef)(({transparent:x,className:v,showLabel:m,label:y,value:h,id:d,invalid:E,...b},D)=>{const C=(0,o.of)(c,x);return(0,n.jsxs)("div",{className:(0,a.cx)(C.inlineContainer,v,b.disabled&&C.disabled,E&&C.invalid),children:[m&&(0,n.jsx)("label",{htmlFor:d,className:(0,a.cx)(C.inlineLabel,h&&C.inlineLabelEnabled,"inline-switch-label"),children:y}),(0,n.jsx)(f,{...b,id:d,label:y,ref:D,value:h})]})});p.displayName="Switch";const c=(x,v)=>({switch:(0,a.css)({width:x.spacing(4),height:x.spacing(2),position:"relative",lineHeight:1,input:{height:"100%",width:"100% !important",opacity:0,zIndex:-1e3,position:"absolute","&:checked + label":{background:x.colors.primary.main,borderColor:x.colors.primary.main,"&:hover":{background:x.colors.primary.shade},svg:{transform:`translate3d(${x.spacing(2.25)}, -50%, 0)`,background:x.colors.primary.contrastText,color:x.colors.primary.main}},"&:disabled + label":{background:x.colors.action.disabledBackground,borderColor:x.colors.border.weak,cursor:"not-allowed",svg:{background:x.colors.text.disabled}},"&:disabled:checked + label":{background:x.colors.primary.transparent,svg:{color:x.colors.primary.contrastText}},"&:focus + label, &:focus-visible + label":(0,l.getFocusStyles)(x),"&:focus:not(:focus-visible) + label":(0,l.getMouseFocusStyles)(x)},label:{width:"100%",height:"100%",cursor:"pointer",borderRadius:x.shape.radius.pill,background:x.components.input.background,border:`1px solid ${x.components.input.borderColor}`,transition:"all 0.3s ease","&:hover":{borderColor:x.components.input.borderHover},svg:{position:"absolute",display:"block",color:"transparent",width:x.spacing(1.5),height:x.spacing(1.5),borderRadius:x.shape.radius.circle,background:x.colors.text.secondary,boxShadow:x.shadows.z1,left:0,top:"50%",transform:`translate3d(${x.spacing(.25)}, -50%, 0)`,transition:"transform 0.2s cubic-bezier(0.19, 1, 0.22, 1)","@media (forced-colors: active)":{border:`1px solid ${x.colors.primary.contrastText}`}}}}),inlineContainer:(0,a.css)({padding:x.spacing(0,1),height:x.spacing(x.components.height.md),display:"inline-flex",alignItems:"center",background:v?"transparent":x.components.input.background,border:`1px solid ${v?"transparent":x.components.input.borderColor}`,borderRadius:x.shape.radius.default,"&:hover":{border:`1px solid ${v?"transparent":x.components.input.borderHover}`,".inline-switch-label":{color:x.colors.text.primary}}}),disabled:(0,a.css)({backgroundColor:v?"transparent":"rgba(204, 204, 220, 0.04)",color:"rgba(204, 204, 220, 0.6)",border:`1px solid ${v?"transparent":"rgba(204, 204, 220, 0.04)"}`}),inlineLabel:(0,a.css)({cursor:"pointer",paddingRight:x.spacing(1),color:x.colors.text.secondary,whiteSpace:"nowrap"}),inlineLabelEnabled:(0,a.css)({color:x.colors.text.primary}),invalid:(0,a.css)({"input + label, input:checked + label, input:hover + label":{border:`1px solid ${x.colors.error.border}`}})})},64467:(te,R,e)=>{"use strict";e.d(R,{q:()=>p});var n=e(74848),a=e(22803),s=e(96540),i=e(76319),r=e(60208),u=e(13941),o=e(54314),l=e(63142),g=e(31286),f=e(92807);function p({tabs:x,defaultTab:v,closeIconTooltip:m,onClose:y,testId:h}){const[d,E]=(0,s.useState)(x.some(C=>C.value===v)?v:x[0].value),b=(0,l.of)(c),D=C=>{E(C.value)};return(0,n.jsxs)("div",{className:b.container,"data-testid":h,children:[(0,n.jsxs)(o.U,{className:b.tabs,children:[x.map(C=>(0,n.jsx)(r.o,{label:C.label,active:C.value===d,onChangeTab:()=>D(C),icon:C.icon},C.value)),(0,n.jsx)(g.a,{grow:1,display:"flex",justifyContent:"flex-end",paddingRight:1,children:(0,n.jsx)(i.K,{size:"lg",onClick:y,name:"times",tooltip:m??"Close"})})]}),(0,n.jsx)(f.P,{children:(0,n.jsx)(u.J,{className:b.tabContent,children:x.find(C=>C.value===d)?.content})})]})}const c=x=>({container:(0,a.css)({height:"100%",display:"flex",flexDirection:"column",flex:"1 1 0",minHeight:0}),tabContent:(0,a.css)({padding:x.spacing(2),backgroundColor:x.colors.background.primary,flex:1}),tabs:(0,a.css)({paddingTop:x.spacing(.5),borderColor:x.colors.border.weak,ul:{marginLeft:x.spacing(2)}})})},93948:(te,R,e)=>{"use strict";e.d(R,{a:()=>x,t:()=>c});var n=e(74848),a=e(79118),s=e(41119),i=e(55386),r=e(95004),u=e(739),o=e(63142),l=e(53568),g=e(21539),f=e(53431),p=e(74198);const c={type:u.ob.Sparkline,drawStyle:u.GR.Line,lineInterpolation:u.dx.Smooth,lineWidth:1,fillOpacity:17,gradientMode:u.on.Hue,pointSize:2,barAlignment:u.Nj.Center,showPoints:u.yL.Never,hideValue:!1},x=y=>{const{field:h,innerWidth:d,tableStyles:E,cell:b,cellProps:D,timeRange:C}=y,P=v(b.value),M=(0,o.$j)();if(!P)return(0,n.jsx)("div",{...D,className:E.cellContainer,children:h.config.noValue||"no data"});P.x&&!P.x.config.interval&&P.x.values.length>1&&(P.x.config.interval=P.x.values[1]-P.x.values[0]),P.y.values=P.y.values.map(_=>Number.isFinite(_)?_:null);const O=(0,a.AP)(P.y);P.y.config.min=O.min,P.y.config.max=O.max,P.y.state={range:O},P.timeRange=C;const j=m(h),U={color:h.config.color,custom:{...c,...j}},W=h.config.custom?.cellOptions?.hideValue;let B=0,S=null;if(!W){const _=(0,s.LI)(b.value)?b.value.value:null,K=h.display(_),T=(0,p.zi)(h,K,b.row.index);B=(0,l.kD)((0,i.cN)(T),16).width+M.spacing.gridSize,S=(0,n.jsx)(g.i,{style:{width:`${B-M.spacing.gridSize}px`,textAlign:"right",marginRight:M.spacing(1)},value:K})}return(0,n.jsxs)("div",{...D,className:E.cellContainer,children:[S,(0,n.jsx)("div",{children:(0,n.jsx)(f.O,{width:d-B,height:E.cellHeightInner,sparkline:P,config:U,theme:E.theme})})]})};function v(y){if(Array.isArray(y))return{y:{name:"test",type:r.PU.number,values:y,config:{}}};if((0,s.ci)(y)){const h=y.fields.find(E=>E.type===r.PU.time),d=y.fields.find(E=>E.type===r.PU.number);if(h&&d)return{x:h,y:d}}}function m(y){let h=(0,p.bk)(y);if(h.type===u.ob.Auto&&(h={...h,type:u.ob.Sparkline}),h.type===u.ob.Sparkline)return h;throw new Error(`Expected options type ${u.ob.Sparkline} but got ${h.type}`)}},28533:(te,R,e)=>{"use strict";e.d(R,{n:()=>a});var n=e(74848);const a=({cell:s,tableStyles:i,onCellFilterAdded:r,timeRange:u,userProps:o,frame:l,rowStyled:g,rowExpanded:f,textWrapped:p,height:c,getActions:x,replaceVariables:v,setInspectCell:m})=>{const y=s.getCellProps(),h=s.column.field;if(!h?.display)return null;if(y.style){y.style.wordBreak="break-word",y.style.minWidth=y.style.width;const b=s.column.justifyContent;b==="flex-end"&&!h.config.unit?(y.style.textAlign="right",y.style.direction="rtl",y.style.unicodeBidi="plaintext"):y.style.justifyContent=b}let d=(typeof s.column.width=="number"?s.column.width:24)-i.cellPadding*2;const E=x?x(l,h,s.row.index,v):[];return(0,n.jsx)(n.Fragment,{children:s.render("Cell",{field:h,tableStyles:i,onCellFilterAdded:r,cellProps:y,innerWidth:d,timeRange:u,userProps:o,frame:l,rowStyled:g,rowExpanded:f,textWrapped:p,height:c,actions:E,setInspectCell:m})})}},58738:(te,R,e)=>{"use strict";e.d(R,{e:()=>p,h:()=>c});var n=e(74848),a=e(22803),s=e(34743),i=e(83505),r=e(96540),u=e(51898),o=e(63142),l=e(15245),g=e(39064),f=e(61048);const p=({links:v,actions:m,value:y,coords:h,onTooltipClose:d})=>{const E=(0,o.of)(x),b=[(0,s.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,s.BN)()],D=(0,r.useMemo)(()=>{const{clientX:B,clientY:S}=h;return{getBoundingClientRect(){return{width:0,height:0,x:B,y:S,top:S,left:B,right:B,bottom:S}}}},[h]),C=B=>{M.setFloating(B),M.setReference(D)},{context:P,refs:M,floatingStyles:O}=(0,i.we)({open:!0,placement:"right-start",onOpenChange:d,middleware:b}),j=(0,i.s9)(P),{getFloatingProps:U,getReferenceProps:W}=(0,i.bv)([j]);return v.length===0&&!m?.length?null:(0,n.jsxs)(n.Fragment,{children:[y,(0,n.jsx)(l.ZL,{children:(0,n.jsx)("div",{ref:C,...W(),...U(),style:O,className:E.tooltipWrapper,"data-testid":u.Tp.components.DataLinksActionsTooltip.tooltipWrapper,children:(0,n.jsx)(f.i,{children:(0,n.jsx)(g.S,{dataLinks:v,actions:m})})})})]})},c=(v,m,y)=>(0,n.jsx)("a",{href:v.href,onClick:v.onClick,target:v.target,title:v.title,"data-testid":u.Tp.components.DataLinksContextMenu.singleLink,className:y,children:m}),x=v=>({tooltipWrapper:(0,a.css)({zIndex:v.zIndex.portal,whiteSpace:"pre",borderRadius:v.shape.radius.default,background:v.colors.background.primary,border:`1px solid ${v.colors.border.weak}`,boxShadow:v.shadows.z3,userSelect:"text",fontSize:v.typography.bodySmall.fontSize})})},64780:(te,R,e)=>{"use strict";e.d(R,{B:()=>c,s:()=>x});var n=e(74848),a=e(2543),s=e.n(a),i=e(96540),r=e(92745),u=e(47931),o=e(8207),l=e(41654),g=e(50992),f=e(60208),p=e(54314),c=(v=>(v.code="code",v.text="text",v))(c||{});function x({value:v,onDismiss:m,mode:y}){let h=v;const[d,E]=(0,i.useState)(y);if((0,a.isString)(v)){const M=v.trim();if(M[0]==="{"||M[0]==="["||y==="code")try{v=JSON.parse(v),h=JSON.stringify(v,null,"  ")}catch(O){console.log("Failed to parse JSON in Table cell inspector (this will cause JSON to not print nicely): ",O.message)}}else h=JSON.stringify(v);let b=h;const D=[{label:"Plain text",value:"text"},{label:"Code editor",value:"code"}],C=()=>{E(d==="text"?"code":"text")},P=(0,n.jsx)(p.U,{children:D.map((M,O)=>(0,n.jsx)(f.o,{label:M.label,active:M.value===d,onChangeTab:C},`${M.value}-${O}`))});return(0,n.jsx)(o._,{onClose:m,title:(0,r.t)("grafana-ui.table.inspect-drawer-title","Inspect value"),tabs:P,children:(0,n.jsxs)(l.B,{direction:"column",gap:2,children:[(0,n.jsx)(u.b,{icon:"copy",getText:()=>b,style:{marginLeft:"auto",width:"200px"},children:(0,n.jsx)(r.x6,{i18nKey:"grafana-ui.table.copy",children:"Copy to Clipboard"})}),d==="code"?(0,n.jsx)(g.B,{width:"100%",height:500,language:"json",showLineNumbers:!0,showMiniMap:(b&&b.length)>100,value:b,readOnly:!0,wordWrap:!0}):(0,n.jsx)("pre",{children:b})]})})}},74533:(te,R,e)=>{"use strict";e.d(R,{u:()=>l,d:()=>f});var n=e(74848),a=e(96540),s=e(46644),i=e(51898),r=e(22803);const u=p=>{const c=(0,r.css)({width:"100%",listStyle:"none"}),x=(0,r.css)({width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between"});return p.value&&!Array.isArray(p.value)?(0,n.jsx)("span",{children:p.value}):p.value&&Array.isArray(p.value)&&p.value.length>0?(0,n.jsx)("ul",{className:c,children:p.value.map((v,m)=>{const y=Object.keys(v)[0];return(0,n.jsxs)("li",{className:x,children:[(0,n.jsx)("span",{children:y}),(0,n.jsx)("span",{children:v[y]})]},m)})}):o},o=()=>(0,n.jsx)("span",{children:"\xA0"});function l(p){const{totalColumnsWidth:c,footerGroups:x,isPaginationVisible:v,tableStyles:m}=p,y=i.Tp.components.Panels.Visualization.Table;return(0,n.jsx)("div",{style:{position:v?"relative":"absolute",width:c?`${c}px`:"100%",bottom:"0px"},children:x.map(h=>{const{key:d,...E}=h.getFooterGroupProps();return(0,a.createElement)("div",{className:m.tfoot,...E,key:d,"data-testid":y.footer},h.headers.map(b=>g(b,m)))})})}function g(p,c){const{key:x,...v}=p.getHeaderProps();return v?(v.style=v.style??{},v.style.position="absolute",v.style.justifyContent=p.justifyContent,(0,n.jsx)("div",{className:c.headerCell,...v,children:p.render("Footer")},x)):null}function f(p,c,x){if(c===void 0)return o;if(x){if(c[p]===void 0)return o;const v=s.AS.get(s.gy.count).name;return u({value:[{[v]:String(c[p])}]})}return u({value:c[p]})}},24343:(te,R,e)=>{"use strict";e.d(R,{X:()=>tt});var n=e(74848),a=e(96540),s=e(32885),i=e(46644),r=e(95004),u=e(17503),o=e(36638),l=e(51898),g=e(92745),f=e(739),p=e(63142),c=e(52718),x=e(34213),v=e(64780);function m(Je,Ge){(0,a.useEffect)(()=>{if(Je.current&&Ge.current){const je=Je.current.querySelector(".track-vertical"),Fe=Ge.current.firstChild;Fe&&je&&(je.remove(),Fe instanceof HTMLElement&&(Fe.querySelector(":scope > .track-vertical")?.remove(),Fe.append(je)))}})}function y(Je,Ge,je,Fe){const Be=JSON.stringify(Object.keys(Je.expanded));(0,a.useEffect)(()=>{let Ke=0;Fe||(Number.isFinite(Je.lastExpandedOrCollapsedIndex)&&(Ke=Je.lastExpandedOrCollapsedIndex),Ke=Je.pageIndex===0?Ke-1:Ke-Je.pageIndex-Je.pageIndex*Je.pageSize),Ge.current?.resetAfterIndex(Math.max(Ke,0))},[Je.lastExpandedOrCollapsedIndex,Je.pageSize,Je.pageIndex,Ge,je,Be,Fe])}var h=e(16515);function d({onColumnResize:Je,onSortByChange:Ge,data:je}){return(0,a.useCallback)((Fe,Be)=>{switch(Be.type){case"columnDoneResizing":if(Je){const Ue=Fe.columnResizing?.headerIdWidths?.[0]?.[0],we=parseInt(Ue,10),Xe=Math.round(Fe.columnResizing.columnWidths?.[Ue]),nt=je.fields?.[we];if(!nt)return Fe;const he=(0,h.Ct)(nt,je);Je(he,Xe)}case"toggleSortBy":if(Ge){const Ke=[];for(const Ue of Fe.sortBy){const we=je.fields[parseInt(Ue.id,10)];we&&Ke.push({displayName:(0,h.Ct)(we,je),desc:Ue.desc})}Ge(Ke)}case"toggleRowExpanded":if(Be.id)return{...Fe,lastExpandedOrCollapsedIndex:parseInt(Be.id,10)}}return Fe},[je,Je,Ge])}function E(Je,Ge){const je={};if(Je){je.sortBy=[];for(const Fe of Je)for(const Be of Ge)Be.Header===Fe.displayName&&je.sortBy.push({id:Be.id,desc:Fe.desc})}return je}var b=e(74198),D=e(74533),C=e(97958),P=e(30703),M=e(22803),O=e(2381),j=e(97222),U=e(55386),W=e(15356),B=e(12737),S=e(32635),_=e(72636),K=e(41654);const T=28,L=T*5,A={Contains:{label:"Contains",value:"Contains",description:"Contains"},"=":{label:"=",value:"=",description:"Equals"},"!=":{label:"!=",value:"!=",description:"Not equals"},">":{label:">",value:">",description:"Greater"},">=":{label:">=",value:">=",description:"Greater or Equal"},"<":{label:"<",value:"<",description:"Less"},"<=":{label:"<=",value:"<=",description:"Less or Equal"},Expression:{label:"Expression",value:"Expression",description:'Bool Expression (Char $ represents the column value in the expression, e.g. "$ >= 10 && $ <= 12")'}},N=Object.values(A),V=A.Contains,z=A.Expression,w=Je=>{if(Je=Je.trim().replace(/\\/g,""),/^(\d{4}-\d{2}-\d{2}|\d{4}\/\d{2}\/\d{2})/.test(Je)){const Fe=new Date(Je);if(!isNaN(Fe.getTime())){const Be=(0,U.j_)("dateTimeAsIso");return(0,U.cN)(Be(Fe.getTime()))}}const Ge=parseFloat(Je);if(!isNaN(Ge))return Ge;const je=Je.toLowerCase();return je==="true"||je==="false"?je==="true":Je},H=({options:Je,values:Ge,caseSensitive:je,showOperators:Fe,onChange:Be,searchFilter:Ke,setSearchFilter:Ue,operator:we,setOperator:Xe})=>{const nt=(0,a.useMemo)(()=>new RegExp(Ke,je?void 0:"i"),[Ke,je]),he=(0,a.useMemo)(()=>Je.filter(ct=>{if(!Fe||!Ke||we.value===V.value)return ct.label===void 0?!1:nt.test(ct.label);if(we.value===z.value){if(ct.value===void 0)return!1;try{const ft=Ke.replace(/\\/g,""),Et=new Function("$",`'use strict'; return ${ft};`),St=w(ct.value);return Et(St)}catch{}return!1}else{if(ct.value===void 0)return!1;const ft=w(ct.value),Et=w(Ke);switch(we.value){case"=":return ft===Et;case"!=":return ft!==Et;case">":return ft>Et;case">=":return ft>=Et;case"<":return ft<Et;case"<=":return ft<=Et}return!1}}),[Je,nt,Fe,we,Ke]),xe=(0,a.useMemo)(()=>he.filter(ct=>Ge.includes(ct)),[he,Ge]),me=(0,a.useMemo)(()=>he.length===xe.length,[he,xe]),ye=(0,a.useMemo)(()=>xe.length>0&&he.length>xe.length,[he,xe]),De=(0,a.useMemo)(()=>xe.length?`${xe.length} selected`:"Select all",[xe]),Le=(0,a.useMemo)(()=>he.length!==xe.length?"Add all displayed values to the filter":"Remove all displayed values from the filter",[he,xe]),Ve=(0,p.of)(Z),Ze=(0,p.$j)().spacing.gridSize,Me=(0,a.useMemo)(()=>Math.min(he.length*T,L)+Ze,[Ze,he.length]),$e=(0,a.useCallback)(ct=>ft=>{const Et=ft.currentTarget.checked?Ge.concat(ct):Ge.filter(St=>St.value!==ct.value);Be(Et)},[Be,Ge]),at=(0,a.useCallback)(()=>{if(he.length===xe.length){const ct=Ge.filter(ft=>!he.includes(ft));Be(ct)}else{const ct=[...new Set([...Ge,...he])];Be(ct)}},[Be,Ge,he,xe]);return(0,n.jsxs)(K.B,{direction:"column",gap:.25,children:[!Fe&&(0,n.jsx)(B.Z,{placeholder:(0,g.t)("grafana-ui.table.filter-placeholder","Filter values"),onChange:Ue,value:Ke}),Fe&&(0,n.jsxs)(K.B,{direction:"row",gap:0,children:[(0,n.jsx)(W.f,{variant:"canvas",options:N,onChange:Xe,value:we,tooltip:we.description}),(0,n.jsx)(B.Z,{placeholder:(0,g.t)("grafana-ui.table.filter-placeholder","Filter values"),onChange:Ue,value:Ke})]}),he.length>0?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j.Y1,{height:Me,itemCount:he.length,itemSize:T,itemData:{items:he,values:xe,onCheckedChanged:$e,className:Ve.filterListRow},width:"100%",className:Ve.filterList,children:Q}),(0,n.jsxs)(K.B,{direction:"column",gap:.25,children:[(0,n.jsx)("div",{className:(0,M.cx)(Ve.selectDivider)}),(0,n.jsx)("div",{className:(0,M.cx)(Ve.filterListRow),children:(0,n.jsx)(S.S,{value:me,indeterminate:ye,label:De,description:Le,onChange:at})})]})]}):(0,n.jsx)(_.J,{className:Ve.noValuesLabel,children:(0,n.jsx)(g.x6,{i18nKey:"grafana-ui.table.no-values-label",children:"No values"})})]})};function Q({index:Je,style:Ge,data:{onCheckedChanged:je,items:Fe,values:Be,className:Ke}}){const Ue=Fe[Je],{value:we,label:Xe}=Ue,nt=Be.find(he=>he.value===we)!==void 0;return(0,n.jsx)("div",{className:Ke,style:Ge,title:Xe,children:(0,n.jsx)(S.S,{value:nt,label:Xe,onChange:je(Ue)})})}const Z=Je=>({filterList:(0,M.css)({label:"filterList"}),filterListRow:(0,M.css)({label:"filterListRow",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:Je.spacing(.5),":hover":{backgroundColor:Je.colors.action.hover}}),selectDivider:(0,M.css)({label:"selectDivider",width:"100%",borderTop:`1px solid ${Je.colors.border.medium}`,padding:Je.spacing(.5,2)}),noValuesLabel:(0,M.css)({paddingTop:Je.spacing(1)})});var Y=e(45861),X=e(8135),I=e(76319);const J=({column:{preFilteredRows:Je,filterValue:Ge,setFilter:je},onClose:Fe,field:Be,searchFilter:Ke,setSearchFilter:Ue,operator:we,setOperator:Xe})=>{const nt=(0,p.$j)(),he=(0,a.useMemo)(()=>(0,b.MY)(Je,Be),[Je,Be]),xe=(0,a.useMemo)(()=>(0,b.Yz)(he),[he]),me=(0,a.useMemo)(()=>(0,b.Sj)(xe,Ge),[xe,Ge]),[ye,De]=(0,a.useState)(me),[Le,Ve]=(0,a.useState)(!1),ze=(0,a.useCallback)(ct=>Fe(),[Fe]),Ze=(0,a.useCallback)(ct=>{const ft=ye.length?ye:void 0;je(ft),Fe()},[je,ye,Fe]),Me=(0,a.useCallback)(ct=>{je(void 0),Fe()},[je,Fe]),$e=(0,a.useMemo)(()=>Ge!==void 0,[Ge]),at=(0,p.of)(ee);return(0,n.jsx)(X.N,{onClick:ze,useCapture:!0,children:(0,n.jsx)("div",{className:(0,M.cx)(at.filterContainer),onClick:q,children:(0,n.jsxs)(K.B,{direction:"column",gap:3,children:[(0,n.jsxs)(K.B,{direction:"column",gap:.5,children:[(0,n.jsxs)(K.B,{justifyContent:"space-between",alignItems:"center",children:[(0,n.jsx)(_.J,{className:at.label,children:(0,n.jsx)(g.x6,{i18nKey:"grafana-ui.table.filter-popup-heading",children:"Filter by values:"})}),(0,n.jsx)(I.K,{name:"text-fields",tooltip:(0,g.t)("grafana-ui.table.filter-popup-match-case","Match case"),style:{color:Le?nt.colors.text.link:nt.colors.text.disabled},onClick:()=>{Ve(ct=>!ct)}})]}),(0,n.jsx)("div",{className:(0,M.cx)(at.listDivider)}),(0,n.jsx)(H,{onChange:De,values:ye,options:xe,caseSensitive:Le,showOperators:!0,searchFilter:Ke,setSearchFilter:Ue,operator:we,setOperator:Xe})]}),(0,n.jsxs)(K.B,{gap:3,children:[(0,n.jsxs)(K.B,{children:[(0,n.jsx)(Y.$n,{size:"sm",onClick:Ze,children:(0,n.jsx)(g.x6,{i18nKey:"grafana-ui.table.filter-popup-apply",children:"Ok"})}),(0,n.jsx)(Y.$n,{size:"sm",variant:"secondary",onClick:ze,children:(0,n.jsx)(g.x6,{i18nKey:"grafana-ui.table.filter-popup-cancel",children:"Cancel"})})]}),$e&&(0,n.jsx)(K.B,{children:(0,n.jsx)(Y.$n,{fill:"text",size:"sm",onClick:Me,children:(0,n.jsx)(g.x6,{i18nKey:"grafana-ui.table.filter-popup-clear",children:"Clear filter"})})})]})]})})})},ee=Je=>({filterContainer:(0,M.css)({label:"filterContainer",width:"100%",minWidth:"250px",height:"100%",maxHeight:"400px",backgroundColor:Je.colors.background.primary,border:`1px solid ${Je.colors.border.weak}`,padding:Je.spacing(2),boxShadow:Je.shadows.z3,borderRadius:Je.shape.radius.default}),listDivider:(0,M.css)({label:"listDivider",width:"100%",borderTop:`1px solid ${Je.colors.border.medium}`,padding:Je.spacing(.5,2)}),label:(0,M.css)({marginBottom:0})}),q=Je=>{Je.stopPropagation()},ne=({column:Je,field:Ge,tableStyles:je})=>{const Fe=(0,a.useRef)(null),[Be,Ke]=(0,a.useState)(!1),Ue=(0,p.of)(se),we=(0,a.useMemo)(()=>!!Je.filterValue,[Je.filterValue]),Xe=(0,a.useCallback)(()=>Ke(!0),[Ke]),nt=(0,a.useCallback)(()=>Ke(!1),[Ke]),[he,xe]=(0,a.useState)(""),[me,ye]=(0,a.useState)(V);return!Ge||!Ge.config.custom?.filterable?null:(0,n.jsxs)("button",{className:(0,M.cx)(je.headerFilter,we?Ue.filterIconEnabled:Ue.filterIconDisabled),ref:Fe,type:"button",onClick:Xe,children:[(0,n.jsx)(P.I,{name:"filter"}),Be&&Fe.current&&(0,n.jsx)(O.A,{content:(0,n.jsx)(J,{column:Je,tableStyles:je,field:Ge,onClose:nt,searchFilter:he,setSearchFilter:xe,operator:me,setOperator:ye}),placement:"bottom-start",referenceElement:Fe.current,show:!0})]})},se=Je=>({filterIconEnabled:(0,M.css)({label:"filterIconEnabled",color:Je.colors.primary.text}),filterIconDisabled:(0,M.css)({label:"filterIconDisabled",color:Je.colors.text.disabled})}),oe=Je=>{const{headerGroups:Ge,showTypeIcons:je,tableStyles:Fe}=Je,Be=l.Tp.components.Panels.Visualization.Table;return(0,n.jsx)("div",{role:"rowgroup",className:Fe.headerRow,children:Ge.map(Ke=>{const{key:Ue,...we}=Ke.getHeaderGroupProps();return(0,a.createElement)("div",{className:Fe.thead,...we,key:Ue,"aria-label":Be.header,role:"row"},Ke.headers.map((Xe,nt)=>de(Xe,Fe,je)))})})};function de(Je,Ge,je){const{key:Fe,...Be}=Je.getHeaderProps(),Ke=Je.field??null,Ue=Ke?.config.custom;Je.canResize&&(Be.style.userSelect=Je.isResizing?"none":"auto"),Be.style.position="absolute",Be.style.justifyContent=Je.justifyContent,Be.style.left=Je.totalLeft;let we=Je.render("Header"),Xe=Je.canSort&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{...Je.getSortByToggleProps(),className:Ge.headerCellLabel,children:[je&&(0,n.jsx)(P.I,{name:(0,C.SS)(Ke),title:Ke?.type,size:"sm",className:Ge.typeIcon}),(0,n.jsx)("div",{children:we}),Je.isSorted&&(Je.isSortedDesc?(0,n.jsx)(P.I,{size:"lg",name:"arrow-down",className:Ge.sortIcon}):(0,n.jsx)(P.I,{name:"arrow-up",size:"lg",className:Ge.sortIcon}))]}),Je.canFilter&&(0,n.jsx)(ne,{column:Je,tableStyles:Ge,field:Ke})]});return Xe&&Ue?.headerComponent?Xe=(0,n.jsx)(Ue.headerComponent,{field:Ke,defaultContent:Xe}):Ue?.headerComponent&&(we=(0,n.jsx)(Ue.headerComponent,{field:Ke,defaultContent:we})),(0,n.jsxs)("div",{className:Ge.headerCell,...Be,role:"columnheader",children:[Je.canSort&&Xe,!Je.canSort&&we,!Je.canSort&&Je.canFilter&&(0,n.jsx)(ne,{column:Je,tableStyles:Ge,field:Ke}),Je.canResize&&(0,n.jsx)("div",{...Je.getResizerProps(),className:Ge.resizeHandle})]},Fe)}var fe=e(64423),ae=e(56978),ce=e(57852),ie=e(64400),ve=e(28533);function le({tableStyles:Je,nestedData:Ge,rowIndex:je,width:Fe,cellHeight:Be}){const Ke=Ge.values,Ue=[],we=(0,p.$j)(),Xe=(0,p.of)(Ee);let nt=Je.rowHeight+we.spacing.gridSize;return Ke[je].forEach((he,xe)=>{const me=!!he.meta?.custom?.noHeader,ye=Je.rowHeight*(he.length+(me?0:1)),De={height:ye,paddingLeft:b.jV,position:"absolute",top:nt,backgroundColor:we.colors.background.primary,color:we.colors.text.primary};nt+=ye+we.spacing.gridSize,Ue.push((0,n.jsx)("div",{style:De,children:(0,n.jsx)(tt,{data:he,width:Fe-b.jV,height:Je.rowHeight*(he.length+1),noHeader:me,cellHeight:Be})},`subTable_${je}_${xe}`))}),(0,n.jsx)("div",{className:Xe.subTables,children:Ue})}const Ee=Je=>({subTables:(0,M.css)({"&:before":{content:'""',position:"absolute",width:"1px",top:Je.spacing(5),left:Je.spacing(1),bottom:Je.spacing(2),background:Je.colors.border.medium}})});function Re(Je,Ge,je){return Je.values[Ge].reduce((Ke,Ue)=>{if(Ue.length){const we=!!Ue.meta?.custom?.noHeader;return Ke+je.rowHeight*(Ue.length+(we?0:1))+8}return Ke},je.rowHeight)??je.rowHeight}const Oe=Je=>{const{data:Ge,rows:je,headerHeight:Fe,footerPaginationEnabled:Be,rowHeight:Ke,itemCount:Ue,pageIndex:we,tableState:Xe,prepareRow:nt,onCellFilterAdded:he,width:xe,cellHeight:me=f.qM.Sm,timeRange:ye,tableStyles:De,nestedDataField:Le,listHeight:Ve,listRef:ze,enableSharedCrosshair:Ze=!1,initialRowIndex:Me=void 0,headerGroups:$e,longestField:at,textWrapField:ct,getActions:ft,replaceVariables:Et,setInspectCell:St}=Je,[Pt,Dt]=(0,a.useState)(Me);Me===void 0&&Pt!==void 0&&Dt(void 0);const Ye=(0,p.$j)(),mt=(0,ie.d2)();let zt=null;window.OffscreenCanvas!==void 0&&(zt=new OffscreenCanvas(256,1024).getContext("2d")),zt!=null&&(zt.font=`${Ye.typography.fontSize}px ${Ye.typography.body.fontFamily}`);const Jt=(0,a.useMemo)(()=>{const Rt=Ge.fields.find(Ut=>Ut.type===r.PU.time);return Rt?(0,b.HY)(Rt):0},[Ge]),Xt=(0,a.useCallback)((Rt,Ut)=>{if(!mt||!Ze)return;const Gt=Ut.fields.find(Ft=>Ft.type===r.PU.time);Gt&&mt.eventBus.publish(new ce.b_({point:{time:Gt.values[Rt]}}))},[Ze,mt]),En=(0,a.useCallback)(()=>{!mt||!Ze||mt.eventBus.publish(new ce.ql)},[Ze,mt]),ln=(0,a.useCallback)(Rt=>{if(Rt.payload.point?.time&&Rt.payload.rowIndex!==void 0){const Ut=Ge.fields.find(tn=>tn.type===r.PU.time),Gt=Ut.values[Rt.payload.rowIndex],Ft=Rt.payload.point.time;if((0,b.Iy)(Ft,Gt,Jt)){Dt(Rt.payload.rowIndex);return}const _t=Ut.values.findIndex(tn=>(0,b.Iy)(Ft,tn,Jt));if(_t!==-1){Dt(_t);return}Dt(void 0)}},[Ge.fields,Jt]);(0,a.useEffect)(()=>{if(!mt||!Ze||!(0,u.S1)(Ge)||Be)return;const Rt=new fe.yU;return Rt.add(mt.eventBus.getStream(ce.b_).pipe((0,ae.B)(250)).subscribe({next:Ut=>{mt.eventBus!==Ut.origin&&ln(Ut)}})),Rt.add(mt.eventBus.getStream(ce.ql).pipe((0,ae.B)(250)).subscribe({next:Ut=>{mt.eventBus!==Ut.origin&&Dt(void 0)}})),()=>{Rt.unsubscribe()}},[Ge,Ze,Be,ln,mt]);let cn;if(Pt!==void 0){const Rt=je.findIndex(Ut=>Ut.index===Pt);Rt!==-1&&(cn=Fe+(Rt-1)*Ke)}const Pn=(0,a.useCallback)(Rt=>Xe.pageIndex*Xe.pageSize+Rt,[Xe.pageIndex,Xe.pageSize]);let wn,jn;for(const Rt of Ge.fields){const Ut=Rt.config.custom;Ut!==void 0&&Ut.cellOptions!==void 0&&Ut.cellOptions.type===f.ob.ColorBackground&&Ut.cellOptions.applyToRow&&(wn=Ft=>{const _t=Rt.display(Rt.values.get(Ft));return(0,b.HW)(De.theme,Ut.cellOptions,_t)}),ct!==void 0?jn=ct:at!==void 0&&(jn=at)}const kn=(0,a.useCallback)(({index:Rt,style:Ut,rowHighlightIndex:Gt})=>{const Ft=Pn(Rt),_t=je[Ft];let tn={};nt(_t);const xn=Xe.expanded[_t.id]?(0,M.css)({"&:hover":{background:"inherit"}}):{},mn=Le&&Xe.expanded[_t.id];if(Gt!==void 0&&_t.index===Gt&&(Ut={...Ut,backgroundColor:Ye.components.table.rowSelected},tn={"aria-selected":"true"}),wn){const{bgColor:ca,textColor:ea}=wn(_t.index);Ut.background=ca,Ut.color=ea,Ut.borderLeft=`2px solid ${ca}`}if(jn){const ea=Ge.fields.filter(Jn=>!Jn.config.custom?.hidden).findIndex(Jn=>Jn.name===jn.name),Ca=Ye.typography.body.lineHeight*Ye.typography.fontSize,oa=(0,b.M2)(jn.values[_t.index],$e[0].headers[ea],zt,Ca,De.rowHeight,De.cellPadding);Ut.height=oa.height}const{key:An,...ia}=_t.getRowProps({style:Ut,...tn});return(0,n.jsxs)("div",{...ia,className:(0,M.cx)(De.row,xn),onMouseEnter:()=>Xt(_t.index,Ge),onMouseLeave:En,children:[mn&&(0,n.jsx)(le,{nestedData:Le,tableStyles:De,rowIndex:_t.index,width:xe,cellHeight:me}),_t.cells.map((ca,ea)=>(0,n.jsx)(ve.n,{tableStyles:De,cell:ca,onCellFilterAdded:he,columnIndex:ea,columnCount:_t.cells.length,timeRange:ye,frame:Ge,rowStyled:wn!==void 0,rowExpanded:mn,textWrapped:jn!==void 0,height:Number(Ut.height)-1,getActions:ft,replaceVariables:Et,setInspectCell:St},ea))]},An)},[Pn,je,nt,Xe.expanded,Le,wn,jn,De,En,xe,me,Ye.components.table.rowSelected,Ye.typography.body.lineHeight,Ye.typography.fontSize,Ge,$e,zt,Xt,he,ye,ft,Et,St]),gt=Rt=>{const Ut=Pn(Rt),Gt=je[Ut];if(Xe.expanded[Gt.id]&&Le)return Re(Le,Gt.index,De);if(jn){const _t=Ge.fields.filter(xn=>!xn.config.custom?.hidden).findIndex(xn=>xn.name===jn.name),tn=Ye.typography.fontSize*Ye.typography.body.lineHeight;return(0,b.M2)(jn.values[Gt.index],$e[0].headers[_t],zt,tn,De.rowHeight,De.cellPadding).height}return De.rowHeight},Lt=Rt=>{const{scrollTop:Ut}=Rt.currentTarget;ze.current!==null&&ze.current.scrollTo(Ut)};return(0,a.useEffect)(()=>{ze.current&&ze.current.resetAfterIndex(0)},[je,ze]),(0,n.jsx)(c.A,{onScroll:Lt,hideHorizontalTrack:!0,scrollTop:cn,children:(0,n.jsx)(j._m,{height:Ve,itemCount:Ue,itemSize:gt,width:"100%",ref:ze,style:{overflow:void 0},children:({index:Rt,style:Ut})=>kn({index:Rt,style:Ut,rowHighlightIndex:Pt})},`${Ke}${we}`)})};var Se=e(59692);const Te=150,_e=36,He="No data",tt=(0,a.memo)(Je=>{const{ariaLabel:Ge,data:je,height:Fe,onCellFilterAdded:Be,onColumnResize:Ke,width:Ue,columnMinWidth:we=Te,noHeader:Xe,resizable:nt=!0,initialSortBy:he,footerOptions:xe,showTypeIcons:me,footerValues:ye,enablePagination:De,cellHeight:Le=f.qM.Sm,timeRange:Ve,enableSharedCrosshair:ze=!1,initialRowIndex:Ze=void 0,fieldConfig:Me,getActions:$e,replaceVariables:at}=Je,ct=(0,a.useRef)(null),ft=(0,a.useRef)(null),Et=(0,a.useRef)(null),St=(0,p.$j)(),Pt=(0,Se.k)(St,Le),Dt=Xe?0:Pt.rowHeight,[Ye,mt]=(0,a.useState)(ye),zt=Me?.defaults?.noValue??He,[Jt,Xt]=(0,a.useState)(null),En=(0,a.useMemo)(()=>{const dt=_e;let bt=0;if(!Ye)return 0;for(const Mt of Ye)Array.isArray(Mt)&&Mt.length>bt&&(bt=Mt.length);return bt>1?dt*bt:dt},[Ye]),ln=(0,a.useMemo)(()=>je.fields.length?Array(je.length).fill(0):[],[je]),cn=!!(xe?.countRows&&xe.reducer&&xe.reducer.length&&xe.reducer[0]===i.gy.count),Pn=je.fields.find(dt=>dt.type===r.PU.nestedFrames),wn=Pn!==void 0,jn=(0,a.useMemo)(()=>(0,b.GH)(je,Ue,we,wn,Ye,cn),[je,Ue,we,wn,Ye,cn]),kn=(0,a.useRef)(),gt=d({onColumnResize:Ke,onSortByChange:dt=>{kn.current(!1),Je.onSortByChange&&Je.onSortByChange(dt)},data:je}),Lt=!!je.meta?.uniqueRowIdFields?.length,Rt=(0,a.useMemo)(()=>{const dt={columns:jn,data:ln,disableResizing:!nt,stateReducer:gt,autoResetPage:!1,initialState:E(he,jn),autoResetFilters:!1,sortTypes:{number:b.Ok,"alphanumeric-insensitive":b.IM}};return Lt&&(dt.getRowId=(bt,Mt)=>(0,u.t9)(je,Mt),dt.autoResetExpanded=!1),dt},[he,jn,ln,nt,gt,Lt,je]),{getTableProps:Ut,headerGroups:Gt,footerGroups:Ft,rows:_t,prepareRow:tn,totalColumnsWidth:xn,page:mn,state:An,gotoPage:ia,setPageSize:ca,pageOptions:ea,toggleAllRowsExpanded:Ca}=(0,s.useTable)(Rt,s.useFilters,s.useSortBy,s.useAbsoluteLayout,s.useResizeColumns,s.useExpanded,s.usePagination),oa=An;kn.current=Ca,(0,a.useEffect)(()=>{xe||mt(ye)},[ye,xe]),(0,a.useEffect)(()=>{if(!xe)return;if(!xe.show){mt(void 0);return}if(cn){const bt=[];bt[0]=_t.length.toString()??je.length.toString(),mt(bt);return}const dt=(0,b.Ux)(Gt[0].headers,(0,b.XX)(_t),xe,St);mt(dt)},[xe,St,An.filters,je]);let Jn=Fe-(Dt+En);De&&(Jn-=Pt.cellHeight);const Da=Math.round(Jn/Pt.rowHeight)-1;(0,a.useEffect)(()=>{Da<=0||ca(Da)},[Da,ca]),(0,a.useEffect)(()=>{je.length/Da<An.pageIndex&&ia(0)},[je]),y(oa,ct,je,Lt),m(Et,ft);const Fa=(0,a.useCallback)(dt=>{ia(dt-1)},[ia]),Xn=De?mn.length:_t.length;let ps=null;if(De){const dt=An.pageIndex*An.pageSize+1;let bt=dt+An.pageSize-1;const Mt=Ue<550;bt>je.length&&(bt=je.length);const Bt=_t.length,Kt=bt<_t.length?bt:_t.length;ps=(0,n.jsxs)("div",{className:Pt.paginationWrapper,children:[(0,n.jsx)(x.d,{currentPage:An.pageIndex+1,numberOfPages:ea.length,showSmallVersion:Mt,onNavigate:Fa}),Mt?null:(0,n.jsx)("div",{className:Pt.paginationSummary,children:(0,n.jsxs)(g.x6,{i18nKey:"grafana-ui.table.pagination-summary",children:[{itemsRangeStart:dt}," - ",{displayedEnd:Kt}," of ",{numRows:Bt}," rows"]})})]})}const Aa=Me?(0,b.O4)(Me,je):void 0;let xt;return Me!==void 0&&je.fields.forEach(dt=>{Me.overrides.forEach(bt=>{if((0,o.NS)(bt.matcher)(dt,je,[je]))for(const Bt of bt.properties)Bt.id==="custom.cellOptions"&&Bt.value.wrapText&&(xt=dt)})}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{...Ut(),className:Pt.table,"aria-label":Ge,role:"table",ref:ft,style:{width:Ue,height:Fe},children:[(0,n.jsx)(c.E,{hideVerticalTrack:!0,children:(0,n.jsxs)("div",{className:Pt.tableContentWrapper(xn),children:[!Xe&&(0,n.jsx)(oe,{headerGroups:Gt,showTypeIcons:me,tableStyles:Pt}),Xn>0?(0,n.jsx)("div",{"data-testid":l.Tp.components.Panels.Visualization.Table.body,ref:Et,children:(0,n.jsx)(Oe,{headerGroups:Gt,data:je,rows:_t,width:Ue,cellHeight:Le,headerHeight:Dt,rowHeight:Pt.rowHeight,itemCount:Xn,pageIndex:An.pageIndex,listHeight:Jn,listRef:ct,tableState:An,prepareRow:tn,timeRange:Ve,onCellFilterAdded:Be,nestedDataField:Pn,tableStyles:Pt,footerPaginationEnabled:!!De,enableSharedCrosshair:ze,initialRowIndex:Ze,longestField:Aa,textWrapField:xt,getActions:$e,replaceVariables:at,setInspectCell:Xt})}):(0,n.jsx)("div",{style:{height:Fe-Dt,width:Ue},className:Pt.noData,children:zt}),Ye&&(0,n.jsx)(D.u,{isPaginationVisible:!!De,footerValues:Ye,footerGroups:Ft,totalColumnsWidth:xn,tableStyles:Pt})]})}),ps]}),Jt!==null&&(0,n.jsx)(v.s,{mode:Jt.mode,value:Jt.value,onDismiss:()=>{Xt(null)}})]})});tt.displayName="Table"},59692:(te,R,e)=>{"use strict";e.d(R,{k:()=>a});var n=e(22803);function a(i,r){const u=i.colors.border.weak,o=i.colors.primary.border,l=6,g=s(i,r,l),f=g+2,p=28,c=(x,v,m,y,h,d,E,b,D)=>(0,n.css)({label:y?"cellContainerOverflow":"cellContainerNoOverflow",padding:`${l}px`,width:"100%",height:D?"auto !important":`${f-1}px`,wordBreak:E?"break-all":"inherit",display:"flex",...h?{overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap"}:{},alignItems:"center",borderRight:`1px solid ${u}`,color:b?"inherit":x??void 0,background:b?void 0:v??void 0,backgroundClip:"padding-box","&:last-child:not(:only-child)":{borderRight:"none"},"&:hover":{overflow:y&&!E?"visible":void 0,width:d||!y?"auto":"auto !important",height:(d||y)&&!E?"auto !important":`${f-1}px`,minHeight:`${f-1}px`,wordBreak:d?"break-word":void 0,whiteSpace:d&&y?"normal":"nowrap",boxShadow:y?`0 0 2px ${i.colors.primary.main}`:void 0,background:b?"inherit":m??i.colors.background.primary,zIndex:1,".cellActions":{background:i.components.tooltip.background,color:i.components.tooltip.text,visibility:"visible",opacity:1,width:"auto",borderRadius:i.shape.radius.default}},a:{color:"inherit"},".cellActions":{display:"flex",position:y?void 0:"absolute",top:y?void 0:"1px",right:y?void 0:0,margin:y?i.spacing(0,0,0,1):"auto",visibility:"hidden",opacity:0,width:0,alignItems:"center",height:"100%",padding:i.spacing(.5,0,.5,.5),background:i.components.tooltip.background,color:i.components.tooltip.text},".cellActionsLeft":{right:"auto !important",left:0}});return{theme:i,cellHeight:g,buildCellContainerStyle:c,cellPadding:l,cellHeightInner:g-l*2,rowHeight:f,table:(0,n.css)({height:"100%",width:"100%",overflow:"auto",display:"flex",flexDirection:"column"}),thead:(0,n.css)({label:"thead",height:`${p}px`,overflowY:"auto",overflowX:"hidden",position:"relative"}),tfoot:(0,n.css)({label:"tfoot",height:`${p}px`,borderTop:`1px solid ${u}`,overflowY:"auto",overflowX:"hidden",position:"relative"}),headerRow:(0,n.css)({label:"row",borderBottom:`1px solid ${u}`}),headerCell:(0,n.css)({height:"100%",padding:`0 ${l}px`,overflow:"hidden",whiteSpace:"nowrap",display:"flex",alignItems:"center",fontWeight:i.typography.fontWeightMedium,"&:last-child":{borderRight:"none"}}),headerCellLabel:(0,n.css)({border:"none",padding:0,background:"inherit",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:i.typography.fontWeightMedium,display:"flex",alignItems:"center",marginRight:i.spacing(.5),"&:hover":{textDecoration:"underline",color:i.colors.text.link}}),cellContainerText:c(void 0,void 0,void 0,!0,!0),cellContainerTextNoOverflow:c(void 0,void 0,void 0,!1,!0),cellContainer:c(void 0,void 0,void 0,!0,!1),cellContainerNoOverflow:c(void 0,void 0,void 0,!1,!1),cellText:(0,n.css)({overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",cursor:"text"}),sortIcon:(0,n.css)({marginLeft:i.spacing(.5)}),cellLink:(0,n.css)({cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",color:`${i.colors.text.link} !important`,fontWeight:i.typography.fontWeightMedium,paddingRight:i.spacing(1.5),"&:hover":{textDecoration:"underline",color:i.colors.text.link}}),cellLinkEmpty:(0,n.css)({overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",fontWeight:i.typography.fontWeightMedium,paddingRight:i.spacing(1.5)}),cellLinkForColoredCell:(0,n.css)({cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",fontWeight:i.typography.fontWeightMedium,textDecoration:"underline"}),imageCellLink:(0,n.css)({cursor:"pointer",overflow:"hidden",height:"100%"}),headerFilter:(0,n.css)({background:"transparent",border:"none",label:"headerFilter",padding:0}),paginationWrapper:(0,n.css)({display:"flex",height:`${g}px`,justifyContent:"center",alignItems:"center",width:"100%",li:{marginBottom:0}}),paginationSummary:(0,n.css)({color:i.colors.text.secondary,fontSize:i.typography.bodySmall.fontSize,display:"flex",justifyContent:"flex-end",padding:i.spacing(0,1,0,2)}),tableContentWrapper:x=>{const v=x!==void 0?`${x}px`:"100%";return(0,n.css)({label:"tableContentWrapper",width:v,display:"flex",flexDirection:"column"})},row:(0,n.css)({label:"row",borderBottom:`1px solid ${u}`,"&:hover":{backgroundColor:i.components.table.rowHoverBackground},"&:last-child":{borderBottom:0}}),imageCell:(0,n.css)({height:"100%"}),resizeHandle:(0,n.css)({label:"resizeHandle",cursor:"col-resize !important",display:"inline-block",background:o,opacity:0,[i.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.2s ease-in-out"},width:"8px",height:"100%",position:"absolute",right:"-4px",borderRadius:i.shape.radius.default,top:0,touchAction:"none","&:hover":{opacity:1}}),typeIcon:(0,n.css)({marginRight:i.spacing(1),color:i.colors.text.secondary}),noData:(0,n.css)({alignItems:"center",display:"flex",height:"100%",justifyContent:"center",width:"100%"}),expanderCell:(0,n.css)({display:"flex",flexDirection:"column",justifyContent:"center",height:`${f}px`,cursor:"pointer"})}}function s(i,r,u){const o=i.typography.fontSize,l=i.typography.body.lineHeight;switch(r){case"md":return 42;case"lg":return 48;case"sm":default:return u*2+o*l}}},36100:(te,R,e)=>{"use strict";e.d(R,{Zi:()=>a,mc:()=>n});const n="=",a="!="},74198:(te,R,e)=>{"use strict";e.d(R,{jV:()=>ne,HY:()=>Be,MY:()=>ae,XX:()=>_e,zi:()=>je,HW:()=>Ke,bk:()=>tt,GH:()=>oe,tJ:()=>Xe,Sj:()=>le,Ux:()=>Se,j1:()=>se,O4:()=>we,M2:()=>Ue,Iy:()=>Fe,o7:()=>Je,IM:()=>Ee,Ok:()=>Re,nR:()=>he,Yz:()=>ie});var n=e(2543),a=e(47078),s=e.n(a),i=e(84140),r=e(95004),u=e(16515),o=e(41119),l=e(17503),g=e(55386),f=e(46644),p=e(11576),c=e(739),x=e(8255),v=e(74848),m=e(22803),y=e(63142),h=e(8779);const d=xe=>{const{cellProps:me,tableStyles:ye,actions:De}=xe,Le=(0,y.of)(E);return(0,v.jsx)("div",{...me,className:(0,m.cx)(ye.cellContainerText,Le.buttonsGap),children:De&&De.map((Ve,ze)=>(0,v.jsx)(h.r,{action:Ve,variant:"secondary"},ze))})},E=xe=>({buttonsGap:(0,m.css)({gap:6})});var b=e(96540),D=e(33553),C=e(79118),P=e(38919),M=e(98005),O=e(58738);const j={mode:D.O.Absolute,steps:[{color:"blue",value:-1/0},{color:"green",value:20}]},U=xe=>{const{field:me,innerWidth:ye,tableStyles:De,cell:Le,cellProps:Ve,row:ze}=xe,Ze=me.display(Le.value),Me=tt(me);let $e=(0,C.xg)(me,!1);$e.thresholds||($e={...$e,thresholds:j});let at=c.eX.Gradient,ct;Me.type===c.ob.Gauge&&(at=Me.mode??c.eX.Gradient,ct=Me.valueDisplayMode!==void 0?Me.valueDisplayMode:c.$l.Text);const ft=()=>(0,n.isFunction)(me.getLinks)?me.getLinks({valueRowIndex:ze.index}):[],Et=je(me,Ze,Le.row.index),St=()=>(0,v.jsx)(M.xE,{width:ye,height:De.cellHeightInner,field:$e,display:me.display,text:{valueSize:14},value:Ze,orientation:P.wV.Horizontal,theme:De.theme,alignmentFactors:Et,itemSpacing:1,lcdCellWidth:8,displayMode:at,valueDisplayMode:ct}),[Pt,Dt]=(0,b.useState)(),{shouldShowLink:Ye,hasMultipleLinksOrActions:mt}=Xe(ft()),zt=mt&&Pt!==void 0,Jt=ft();return(0,v.jsx)("div",{...Ve,className:De.cellContainer,style:{...Ve.style,cursor:mt?"context-menu":"auto"},onClick:({clientX:Xt,clientY:En})=>{Dt({clientX:Xt,clientY:En})},children:Ye?(0,O.h)(Jt[0],St()):zt?(0,v.jsx)(O.e,{links:Jt,value:St(),coords:Pt,onTooltipClose:()=>Dt(void 0)}):St()})};var W=e(86059);const B=xe=>{const{field:me,row:ye,cellProps:De,tableStyles:Le}=xe,Ve=(0,W.k)(me,ye);return(0,v.jsx)("div",{...De,className:Le.cellContainerText,children:Ve?.map((ze,Ze)=>!ze.href&&ze.onClick==null?(0,v.jsx)("span",{className:Le.cellLinkEmpty,children:ze.title},Ze):(0,v.jsx)("span",{className:Le.cellLink,onClick:ze.onClick,children:(0,v.jsx)("a",{href:ze.href,target:ze.target,children:ze.title})},Ze))})};var S=e(92745),_=e(76319),K=e(41654),T=e(36100);function L({field:xe,cell:me,previewMode:ye,showFilters:De,onCellFilterAdded:Le,setInspectCell:Ve}){const ze=se(xe)==="flex-end",Ze=!!xe.config.custom?.inspect,Me={size:"sm",tooltipPlacement:"top"},$e=(0,b.useCallback)(ct=>{Le&&Le({key:xe.name,operator:T.mc,value:me.value})},[me,xe,Le]),at=(0,b.useCallback)(ct=>{Le&&Le({key:xe.name,operator:T.Zi,value:me.value})},[me,xe,Le]);return(0,v.jsx)("div",{className:`cellActions${ze?" cellActionsLeft":""}`,children:(0,v.jsxs)(K.B,{gap:.5,children:[Ze&&(0,v.jsx)(_.K,{name:"eye",tooltip:(0,S.t)("grafana-ui.table.cell-inspect","Inspect value"),onClick:()=>{Ve&&Ve({value:me.value,mode:ye})},...Me}),De&&(0,v.jsx)(_.K,{name:"search-plus",onClick:$e,tooltip:(0,S.t)("grafana-ui.table.cell-filter-on","Filter for value"),...Me}),De&&(0,v.jsx)(_.K,{name:"search-minus",onClick:at,tooltip:(0,S.t)("grafana-ui.table.cell-filter-out","Filter out value"),...Me})]})})}var A=e(64780);const N=xe=>{const{field:me,cell:ye,tableStyles:De,row:Le,cellProps:Ve,frame:ze,rowStyled:Ze,rowExpanded:Me,textWrapped:$e,height:at}=xe,ct=!!me.config.custom?.inspect,ft=me.display(ye.value),Et=xe.onCellFilterAdded&&me.config.filterable,St=Et&&ye.value!==void 0||ct,Pt=tt(me);let Dt;const Ye=140;if(Pt.type===c.ob.Custom){const gt=Pt.cellComponent;Dt=(0,v.jsx)(gt,{field:me,value:ye.value,rowIndex:Le.index,frame:ze})}else b.isValidElement(ye.value)?Dt=ye.value:Dt=(0,g.cN)(ft);const mt=typeof Dt=="string",zt=ft.text.length<=Ye&&/\s/.test(ft.text),Jt=z(De,Pt,ft,ct,mt,zt,$e,Ze,Me);if(mt){let gt=Ve.style?.justifyContent;gt==="flex-end"?Ve.style={...Ve.style,textAlign:"right"}:gt==="center"&&(Ve.style={...Ve.style,textAlign:"center"})}at&&(Ve.style={...Ve.style,height:at}),$e&&(Ve.style={...Ve.style,textWrap:"wrap"});const{key:Xt,...En}=Ve,ln=(0,W.k)(me,Le)||[],[cn,Pn]=(0,b.useState)(),{shouldShowLink:wn,hasMultipleLinksOrActions:jn}=Xe(ln),kn=jn&&cn!==void 0;return(0,v.jsxs)("div",{...En,className:Jt,style:{...Ve.style,cursor:jn?"context-menu":"auto"},onClick:he(Pn),children:[wn?(0,O.h)(ln[0],Dt,V(De,Pt)):kn?(0,v.jsx)(O.e,{links:ln,value:Dt,coords:cn,onTooltipClose:()=>Pn(void 0)}):mt?`${Dt}`:(0,v.jsx)("div",{className:De.cellText,children:Dt}),St&&(0,v.jsx)(L,{...xe,previewMode:A.B.text,showFilters:Et})]},Xt)},V=(xe,me)=>me.type===c.ob.Auto?xe.cellLink:xe.cellLinkForColoredCell;function z(xe,me,ye,De=!1,Le=!1,Ve=!1,ze=!1,Ze=!1,Me=!1){let $e,at,ct;const ft=Ke(xe.theme,me,ye);return $e=ft.textColor,at=ft.bgColor,ct=ft.bgHoverColor,xe.buildCellContainerStyle($e,at,ct,!De,Le,Ve,ze,Ze,Me)}var w=e(64136),H=e(27430);function Q(xe){const{cell:me,tableStyles:ye,cellProps:De}=xe;let Le="";return me.value instanceof H.A?Le=new w.A().writeGeometry(me.value,{featureProjection:"EPSG:3857",dataProjection:"EPSG:4326"}):me.value!=null&&(Le=`${me.value}`),(0,v.jsx)("div",{...De,className:ye.cellContainer,children:(0,v.jsx)("div",{className:ye.cellText,style:{fontFamily:"monospace"},children:Le})})}const Z=10,Y=xe=>{const{field:me,cell:ye,tableStyles:De,row:Le,cellProps:Ve}=xe,ze=tt(me),{title:Ze,alt:Me}=ze.type===c.ob.Image?ze:{title:void 0,alt:void 0},$e=me.display(ye.value),at=(0,W.k)(me,Le)||[],[ct,ft]=(0,b.useState)(),{shouldShowLink:Et,hasMultipleLinksOrActions:St}=Xe(at),Pt=St&&ct!==void 0,Dt=(0,v.jsx)("img",{style:{height:De.cellHeight-Z,width:"auto"},src:$e.text,className:De.imageCell,alt:Me,title:Ze});return(0,v.jsx)("div",{...Ve,className:De.cellContainer,style:{...Ve.style,cursor:St?"context-menu":"auto"},onClick:he(ft),children:Et?(0,O.h)(at[0],Dt):Pt?(0,v.jsx)(O.e,{links:at,value:Dt,coords:ct,onTooltipClose:()=>ft(void 0)}):Dt})};function X(xe){const{cell:me,tableStyles:ye,cellProps:De,field:Le,row:Ve}=xe,ze=!!Le.config.custom?.inspect,Ze=(0,m.css)({cursor:"pointer",fontFamily:"monospace"});let Me=me.value,$e=Me;if((0,n.isString)(Me))try{Me=JSON.parse(Me)}catch{}else $e=JSON.stringify(Me,null," ");const at=(0,W.k)(Le,Ve)||[],[ct,ft]=(0,b.useState)(),{shouldShowLink:Et,hasMultipleLinksOrActions:St}=Xe(at),Pt=St&&ct!==void 0;return(0,v.jsxs)("div",{...De,className:ze?ye.cellContainerNoOverflow:ye.cellContainer,children:[(0,v.jsx)("div",{className:(0,m.cx)(ye.cellText,Ze),onClick:he(ft),children:Et?(0,O.h)(at[0],$e):Pt?(0,v.jsx)(O.e,{links:at,value:$e,coords:ct,onTooltipClose:()=>ft(void 0)}):(0,v.jsx)("div",{className:ye.cellText,children:$e})}),ze&&(0,v.jsx)(L,{...xe,previewMode:A.B.code})]})}var I=e(93948),J=e(74533),ee=e(30703);function q({row:xe,tableStyles:me}){return(0,v.jsx)("div",{className:me.expanderCell,...xe.getToggleRowExpandedProps(),children:(0,v.jsx)(ee.I,{"aria-label":xe.isExpanded?(0,S.t)("grafana-ui.row-expander.collapse","Collapse row"):(0,S.t)("grafana-ui.row-expander.expand","Expand row"),name:xe.isExpanded?"angle-down":"angle-right",size:"lg"})})}const ne=50;function se(xe){if(!xe)return"flex-start";if(xe.config.custom)switch(xe.config.custom.align){case"right":return"flex-end";case"left":return"flex-start";case"center":return"center"}return xe.type===r.PU.number?"flex-end":"flex-start"}function oe(xe,me,ye,De,Le,Ve){const ze=[];let Ze=0;De&&(ze.push({Header:()=>null,id:"expander",Cell:q,width:ne,minWidth:ne,filter:($e,at,ct)=>[],justifyContent:"left",field:xe.fields[0],sortType:"basic"}),me-=ne);for(const[$e,at]of xe.fields.entries()){const ct=at.config.custom||{};if(ct.hidden||at.type===r.PU.nestedFrames)continue;ct.width?me-=ct.width:Ze++;const ft=St=>{switch(St){case r.PU.number:case r.PU.frame:return"number";case r.PU.time:return"basic";default:return"alphanumeric-insensitive"}},Et=de(ct.cellOptions?.type,at);ze.push({Cell:Et,id:$e.toString(),field:at,Header:ct.hideHeader?"":(0,u.Ct)(at,xe),accessor:(St,Pt)=>at.values[Pt],sortType:ft(at.type),width:ct.width,minWidth:ct.minWidth??ye,filter:s()(fe(at)),justifyContent:se(at),Footer:(0,J.d)($e,Le,Ve)})}let Me=me/Ze;for(let $e=Ze;$e>0;$e--)for(const at of ze)!at.width&&at.minWidth>Me&&(at.width=at.minWidth,me-=at.width,Ze-=1,Me=me/Ze);for(const $e of ze)$e.width||($e.width=Me),$e.minWidth=50;return ze}function de(xe,me){switch(xe){case c.ob.Custom:case c.ob.ColorText:case c.ob.ColorBackground:return N;case c.ob.Image:return Y;case c.ob.Gauge:return U;case c.ob.Sparkline:return I.a;case c.ob.JSONView:return X;case c.ob.DataLinks:return B;case c.ob.Actions:return d;case c.ob.Pill:return N}if(me.type===r.PU.geo)return Q;if(me.type===r.PU.frame){const ye=me.values[0];return(0,o.ci)(ye)&&(0,l.aH)(ye)?I.a:X}return me.type===r.PU.other?X:N}function fe(xe){return function(me,ye,De){return me.length===0||!De||!xe?me:me.filter(Le=>{if(!Le.values.hasOwnProperty(ye))return!1;const Ve=ce(Le,xe);return De.find(ze=>ze.value===Ve)!==void 0})}}function ae(xe,me){if(!me||xe.length===0)return{};const ye={};for(let De=0;De<xe.length;De++){const Le=ce(xe[De],me);ye[Le||"(Blanks)"]=Le}return ye}function ce(xe,me){if(!me||!xe)return"";const ye=me.values[xe.index],De=me.display?me.display(ye):ye;return me.display?(0,g.cN)(De):De}function ie(xe){return Object.keys(xe).reduce((me,ye)=>me.concat({value:xe[ye],label:ye}),[]).sort(ve)}function ve(xe,me){return xe.label===void 0&&me.label===void 0?0:xe.label===void 0&&me.label!==void 0?-1:xe.label!==void 0&&me.label===void 0?1:xe.label<me.label?-1:xe.label>me.label?1:0}function le(xe,me){return me?xe.filter(ye=>me.some(De=>De.value===ye.value)):[]}function Ee(xe,me,ye){return String(xe.values[ye]).localeCompare(String(me.values[ye]),void 0,{sensitivity:"base"})}function Re(xe,me,ye){const De=Oe(xe.values[ye]),Le=Oe(me.values[ye]);return De===Le?0:De>Le?1:-1}function Oe(xe){return(0,o.LI)(xe)?xe.value??Number.NEGATIVE_INFINITY:xe==null||xe===""||isNaN(xe)?Number.NEGATIVE_INFINITY:typeof xe=="number"?xe:Number(xe)}function Se(xe,me,ye,De){return Ge(xe),xe.map((Le,Ve)=>{if(Le?.field?.type!==r.PU.number)return Ve===0&&ye.reducer&&ye.reducer.length>0?f.AS.get(ye.reducer[0]).name:void 0;let ze=(0,n.clone)(Le.field);return ze.values=me[Le.id],ze.state=void 0,Le.field=ze,ye.fields&&ye.fields.length>0?ye.fields.find(Me=>Me===Le?.field?.name)?Te(Le.field,ye.reducer,De):void 0:Te(Le.field,ye.reducer||[],De)})}function Te(xe,me,ye){const De=me[0];if(De===void 0)return"";const Le=xe.display??(0,p.J)({field:xe,theme:ye}),Ve=(0,f.Nw)({field:xe,reducers:me})[De];return f.AS.get(De).preservesUnits?(0,g.cN)(Le(Ve)):(0,g.cN)({text:Ve})}function _e(xe){const me=[];for(const ye in xe)for(const[De,Le]of Object.entries(xe[ye].values))me[De]===void 0&&(me[De]=[]),me[De].push(Le);return me}const He={type:c.ob.Auto};function tt(xe){return xe.config.custom?.displayMode?Je(xe.config.custom?.displayMode):xe.config.custom?.cellOptions?xe.config.custom.cellOptions:He}function Je(xe){switch(xe){case"basic":case"gradient-gauge":case"lcd-gauge":let me=c.eX.Basic;return xe==="gradient-gauge"?me=c.eX.Gradient:xe==="lcd-gauge"&&(me=c.eX.Lcd),{type:c.ob.Gauge,mode:me};case"color-background":case"color-background-solid":let ye=c.Wq.Basic;return xe==="color-background"&&(ye=c.Wq.Gradient),{type:c.ob.ColorBackground,mode:ye};default:return{type:xe}}}function Ge(xe){const me=xe.findIndex((ye,De)=>ye?.id!==String(De));me===-1||xe[me]?.id==="expander"||(xe.splice(me,0,{id:String(me)}),Ge(xe))}function je(xe,me,ye){let De=xe.state?.alignmentFactors;if(De)return(0,g.cN)(De).length<(0,g.cN)(me).length&&(De={...me},xe.state.alignmentFactors=De),De;{De={...me};const Le=Math.min(xe.values.length,ye+1e3);for(let Ve=ye+1;Ve<Le;Ve++){const ze=xe.display(xe.values[Ve]);(0,g.cN)(De).length>(0,g.cN)(ze).length&&(De.text=me.text)}return xe.state?xe.state.alignmentFactors=De:xe.state={alignmentFactors:De},De}}function Fe(xe,me,ye){return Math.abs(Math.floor(xe)-me)<ye}function Be(xe){let me=-Number.MAX_VALUE,ye=Number.MAX_VALUE;if(xe.values.length<2)return 0;for(let De=0;De<xe.values.length;De++){const Le=xe.values[De];Le>me&&(me=Le),Le<ye&&(ye=Le)}return(me-ye)/xe.values.length}function Ke(xe,me,ye){const De=xe.isDark?1:-.7;let Le,Ve,ze;if(me.type===c.ob.ColorText)Le=ye.color;else if(me.type===c.ob.ColorBackground){const Ze=me.mode??c.Wq.Gradient;if(Ze===c.Wq.Basic)Le=(0,x.mZ)(ye.color,xe.isDark),Ve=(0,i.A)(ye.color).toRgbString(),ze=(0,i.A)(ye.color).setAlpha(1).toRgbString();else if(Ze===c.Wq.Gradient){const Me=(0,i.A)(ye.color).setAlpha(1).toRgbString(),$e=(0,i.A)(ye.color).darken(10*De).spin(5);Le=(0,x.mZ)(ye.color,xe.isDark),Ve=`linear-gradient(120deg, ${$e.toRgbString()}, ${ye.color})`,ze=`linear-gradient(120deg, ${$e.setAlpha(1).toRgbString()}, ${Me})`}}return{textColor:Le,bgColor:Ve,bgHoverColor:ze}}function Ue(xe,me,ye,De,Le,Ve=0){const ze=Number(me?.width??300),Ze=1.17,Me=42,$e=Ve*2;if(ye!==null&&typeof xe=="string"){const at=xe.split(/\s/),ct=[];let ft="",Et=0,St=0;for(let Ye=0;Ye<at.length;Ye++){const mt=at[Ye];let zt=ye.measureText(ft+" "+mt).width;zt<ze-$e?(ft+=" "+mt,Et++):(ct.push({width:zt,line:ft}),ft=mt,Et=0)}for(let Ye=0;Ye<ct.length;Ye++)if(ct[Ye].width>ze){let mt=Math.floor(ct[Ye].width/ze)-1;St+=mt}let Pt=ct.length+St,Dt=38;return Pt>5?Dt=Pt*De*Ze:Dt=Pt*De+Me,Dt+=$e,{width:ze,height:Dt}}return{width:ze,height:Le}}function we(xe,me){let ye;if(xe.defaults.custom?.cellOptions?.wrapText){const Le=me.fields.filter(Ve=>Ve.type===r.PU.string);if(Le.length>=1&&Le[0].values.length>0){const Ve=Le[0].values.length;let ze=0;if(Ve<=30)for(const Ze of Le){const Me=Ze.values.find($e=>$e!=null)?.length??0;Me>ze&&(ze=Me,ye=Ze)}else for(const Ze of Le){const Me=(0,n.sampleSize)(Ze.values,3),$e=(Me[0]?.length+Me[1]?.length+Me[2]?.length)/3;$e>ze&&(ze=$e,ye=Ze)}}}return ye}const Xe=(xe,me)=>{const ye=xe.length>1||!!me?.length;return{shouldShowLink:xe.length===1&&!me?.length,hasMultipleLinksOrActions:ye}},nt=xe=>xe.target===xe.currentTarget,he=xe=>me=>{if(nt(me)){const{clientX:ye,clientY:De}=me;xe({clientX:ye,clientY:De})}}},72489:(te,R,e)=>{"use strict";e.d(R,{p:()=>r});var n=e(74848),a=e(22803),s=e(55386),i=e(63142);const r=({value:o,variant:l="secondary"})=>{const g=(0,i.of)(u,l);return(0,n.jsx)("span",{className:g.counter,children:(0,s.Hg)(o,0).text})},u=(o,l)=>({counter:(0,a.css)({label:"counter",marginLeft:o.spacing(1),borderRadius:o.spacing(3),backgroundColor:l==="primary"?o.colors.primary.main:o.colors.action.hover,padding:o.spacing(.25,1),color:o.colors.text.secondary,fontWeight:o.typography.fontWeightMedium,fontSize:o.typography.size.sm})})},60208:(te,R,e)=>{"use strict";e.d(R,{o:()=>p});var n=e(74848),a=e(22803),s=e(96540),i=e(51898),r=e(63142),u=e(35484),o=e(45861),l=e(30703),g=e(45967),f=e(72489);const p=s.forwardRef(({label:x,active:v,icon:m,onChangeTab:y,counter:h,suffix:d,className:E,href:b,truncate:D,tooltip:C,...P},M)=>{const O=(0,r.of)(c),j=(0,r.of)(o.my),U=()=>(0,n.jsxs)(n.Fragment,{children:[m&&(0,n.jsx)(l.I,{name:m,"data-testid":`tab-icon-${m}`}),x,typeof h=="number"&&(0,n.jsx)(f.p,{value:h}),d&&(0,n.jsx)(d,{className:O.suffix})]}),B={className:(0,a.cx)(j,O.link,v?O.activeStyle:O.notActive,D&&O.linkTruncate),"data-testid":i.Tp.components.Tab.title(x),...P,onClick:y,role:"tab","aria-selected":v,title:C?void 0:P.title};let S=null;return b?S=(0,n.jsx)("div",{className:(0,a.cx)(O.item,D&&O.itemTruncate,E),children:(0,n.jsx)("a",{...B,href:b,ref:M,children:U()})}):S=(0,n.jsx)("div",{className:(0,a.cx)(O.item,D&&O.itemTruncate,E),children:(0,n.jsx)("button",{...B,type:"button",ref:M,children:U()})}),C?(0,n.jsx)(g.m,{content:C,children:S}):S});p.displayName="Tab";const c=x=>({item:(0,a.css)({listStyle:"none",position:"relative",display:"flex",whiteSpace:"nowrap",padding:x.spacing(0,.5)}),itemTruncate:(0,a.css)({maxWidth:x.spacing(40)}),link:(0,a.css)({color:x.colors.text.secondary,padding:x.spacing(1,1.5,1),borderRadius:x.shape.radius.default,display:"block",height:"100%",svg:{marginRight:x.spacing(1)},"&:focus-visible":(0,u.getFocusStyles)(x),"&::before":{display:"block",content:'" "',position:"absolute",left:0,right:0,height:"2px",borderRadius:x.shape.radius.default,bottom:0}}),linkTruncate:(0,a.css)({textOverflow:"ellipsis",whiteSpace:"nowrap",wordBreak:"break-word",overflow:"hidden"}),notActive:(0,a.css)({"a:hover, &:hover, &:focus":{color:x.colors.text.primary,"&::before":{backgroundColor:x.colors.action.hover}}}),activeStyle:(0,a.css)({label:"activeTabStyle",color:x.colors.text.primary,overflow:"hidden","&::before":{backgroundImage:x.colors.gradients.brandHorizontal}}),suffix:(0,a.css)({marginLeft:x.spacing(1)})})},13941:(te,R,e)=>{"use strict";e.d(R,{J:()=>i});var n=e(74848),a=e(22803),s=e(63142);const i=({children:u,className:o,...l})=>{const g=(0,s.of)(r);return(0,n.jsx)("div",{...l,className:(0,a.cx)(g.tabContent,o),children:u})},r=u=>({tabContent:(0,a.css)({background:u.colors.background.primary})})},54314:(te,R,e)=>{"use strict";e.d(R,{U:()=>r});var n=e(74848),a=e(22803),s=e(96540),i=e(63142);const r=(0,s.forwardRef)(({children:o,className:l,hideBorder:g=!1},f)=>{const p=(0,i.of)(u);return(0,n.jsx)("div",{className:(0,a.cx)(p.tabsWrapper,g&&p.noBorder,l),ref:f,children:(0,n.jsx)("div",{className:p.tabs,role:"tablist",children:o})})}),u=o=>({tabsWrapper:(0,a.css)({borderBottom:`1px solid ${o.colors.border.weak}`,overflowX:"auto"}),noBorder:(0,a.css)({borderBottom:0}),tabs:(0,a.css)({position:"relative",display:"flex",alignItems:"center"})});r.displayName="TabsBar"},94018:(te,R,e)=>{"use strict";e.d(R,{v:()=>p});var n=e(74848),a=e(22803),s=e(96540),i=e(70255),r=e(63142),u=e(21348),o=e(48542),l=e(30703);const g=(0,s.forwardRef)(({name:v,onClick:m,icon:y,className:h,colorIndex:d,...E},b)=>{const D=(0,r.$j)(),C=x(D,v,d),P=O=>{O.preventDefault(),O.stopPropagation(),m?.(v,O)},M=(0,a.cx)(C.wrapper,h,{[C.hover]:m!==void 0});return m?(0,n.jsxs)("button",{...E,className:M,onClick:P,ref:b,children:[y&&(0,n.jsx)(l.I,{name:y}),v]}):(0,n.jsxs)("span",{...E,className:M,ref:b,children:[y&&(0,n.jsx)(l.I,{name:y}),v]})});g.displayName="Tag";const f=({rootProps:v})=>{const m=(0,r.of)(c);return(0,n.jsx)(i.A,{width:60,height:22,containerClassName:m.container,...v})},p=(0,u.j)(g,f),c=()=>({container:(0,a.css)({lineHeight:1})}),x=(v,m,y)=>{let h;return y===void 0?h=(0,o.MC)(m):h=(0,o.yC)(y),{wrapper:(0,a.css)({appearance:"none",borderStyle:"none",fontWeight:v.typography.fontWeightMedium,fontSize:v.typography.size.sm,lineHeight:v.typography.bodySmall.lineHeight,verticalAlign:"baseline",backgroundColor:h.color,color:v.v1.palette.gray98,whiteSpace:"pre",textShadow:"none",padding:"3px 6px",borderRadius:v.shape.radius.default}),hover:(0,a.css)({"&:hover":{opacity:.85,cursor:"pointer"}})}}},37658:(te,R,e)=>{"use strict";e.d(R,{L:()=>f});var n=e(74848),a=e(22803),s=e(96540),i=e(92745),r=e(63142),u=e(21348),o=e(94018);const l=(0,s.memo)((0,s.forwardRef)(({displayMax:x,tags:v,icon:m,onClick:y,className:h,getAriaLabel:d,getColorIndex:E},b)=>{const D=(0,r.$j)(),C=c(D,!!(x&&x>0)),P=v.length,M=x?v.slice(0,x):v;return(0,n.jsxs)("ul",{className:(0,a.cx)(C.wrapper,h),"aria-label":(0,i.t)("grafana-ui.tags.list-label","Tags"),ref:b,children:[M.map((O,j)=>(0,n.jsx)("li",{className:C.li,children:(0,n.jsx)(o.v,{name:O,icon:m,onClick:y,"aria-label":d?.(O,j),"data-tag-id":j,colorIndex:E?.(O,j)})},O)),x&&x>0&&P-x>0&&(0,n.jsxs)("span",{className:C.moreTagsLabel,children:["+ ",P-x]})]})}));l.displayName="TagList";const g=({rootProps:x})=>{const v=(0,r.of)(p);return(0,n.jsxs)("div",{className:v.container,...x,children:[(0,n.jsx)(o.v.Skeleton,{}),(0,n.jsx)(o.v.Skeleton,{})]})},f=(0,u.j)(l,g),p=x=>({container:(0,a.css)({display:"flex",gap:x.spacing(1)})}),c=(x,v)=>({wrapper:(0,a.css)({position:"relative",alignItems:v?"center":"unset",display:"flex",flex:"1 1 auto",flexWrap:"wrap",flexShrink:v?0:1,justifyContent:"flex-end",gap:"6px"}),moreTagsLabel:(0,a.css)({color:x.colors.text.secondary,fontSize:x.typography.size.sm}),li:(0,a.css)({listStyle:"none"})})},10928:(te,R,e)=>{"use strict";e.d(R,{u:()=>c});var n=e(74848),a=e(22803),s=e(96540),i=e(92745),r=e(63142),u=e(45861),o=e(63527),l=e(48542),g=e(76319);const f=({name:v,disabled:m,onRemove:y,autoColors:h=!0})=>{const d=(0,r.of)(p),E=(0,s.useMemo)(()=>{if(h){const{color:b,borderColor:D}=(0,l.MC)(v);return{backgroundColor:b,borderColor:D}}},[v,h]);return(0,n.jsxs)("li",{className:(0,a.cx)(d.itemStyle,!E&&d.defaultTagColor),style:E,children:[(0,n.jsx)("span",{className:d.nameStyle,children:v}),(0,n.jsx)(g.K,{name:"times",size:"lg",disabled:m,tooltip:(0,i.t)("grafana-ui.tags-input.remove","Remove tag: {{name}}",{name:v}),onClick:()=>y(v),className:d.buttonStyles})]})},p=v=>{const m=v.spacing.gridSize*3;return{itemStyle:(0,a.css)({display:"flex",gap:"3px",alignItems:"center",height:`${m}px`,lineHeight:`${m-2}px`,borderWidth:"1px",borderStyle:"solid",borderRadius:v.shape.radius.default,padding:`0 ${v.spacing(.5)}`,whiteSpace:"nowrap",textShadow:"none",fontWeight:500,fontSize:v.typography.size.sm,color:"#fff"}),defaultTagColor:(0,a.css)({backgroundColor:v.colors.background.secondary,borderColor:v.components.input.borderColor,color:v.colors.text.primary}),nameStyle:(0,a.css)({maxWidth:"25ch",textOverflow:"ellipsis",overflow:"hidden"}),buttonStyles:(0,a.css)({margin:0,"&:hover::before":{display:"none"}})}},c=(0,s.forwardRef)(({placeholder:v="New tag (enter key to add)",tags:m=[],onChange:y,width:h,className:d,disabled:E,addOnBlur:b,invalid:D,id:C,autoColors:P=!0},M)=>{const[O,j]=(0,s.useState)(""),U=(0,r.of)(x),W=(0,r.$j)(),B=(0,s.useCallback)(L=>{j(L.target.value)},[]),S=L=>{y(m.filter(A=>A!==L))},_=L=>{L?.preventDefault(),m.includes(O)||y(m.concat(O)),j("")},K=()=>{b&&O&&_()},T=L=>{L.key==="Enter"&&O!==""&&_(L)};return(0,n.jsxs)("div",{className:(0,a.cx)(U.wrapper,d,h?(0,a.css)({width:W.spacing(h)}):""),children:[(0,n.jsx)(o.p,{ref:M,id:C,disabled:E,placeholder:v,onChange:B,value:O,onKeyDown:T,onBlur:K,invalid:D,suffix:(0,n.jsx)(u.$n,{fill:"text",className:U.addButtonStyle,onClick:_,size:"md",disabled:O.length<=0,children:(0,n.jsx)(i.x6,{i18nKey:"grafana-ui.tags-input.add",children:"Add"})})}),m?.length>0&&(0,n.jsx)("ul",{className:U.tags,children:m.map(L=>(0,n.jsx)(f,{name:L,onRemove:S,disabled:E,autoColors:P},L))})]})});c.displayName="TagsInput";const x=v=>({wrapper:(0,a.css)({minHeight:v.spacing(4),display:"flex",flexDirection:"column",gap:v.spacing(1),flexWrap:"wrap"}),tags:(0,a.css)({display:"flex",justifyContent:"flex-start",flexWrap:"wrap",gap:v.spacing(.5)}),addButtonStyle:(0,a.css)({margin:`0 -${v.spacing(1)}`})})},87105:(te,R,e)=>{"use strict";e.d(R,{f:()=>u});var n=e(74848),a=e(22803),s=e(96540),i=e(63142),r=e(3343);const u=(0,s.forwardRef)(({invalid:l,className:g,...f},p)=>{const c=(0,i.of)(o,l);return(0,n.jsx)("textarea",{...f,className:(0,a.cx)(c.textarea,g),ref:p})}),o=(l,g=!1)=>({textarea:(0,a.cx)((0,r.Xb)(l),(0,r.gm)(l),(0,a.css)({display:"block",borderRadius:l.shape.radius.default,padding:`${l.spacing.gridSize/4}px ${l.spacing.gridSize}px`,width:"100%",borderColor:g?l.colors.error.border:l.components.input.borderColor}))});u.displayName="TextArea"},59243:(te,R,e)=>{"use strict";e.d(R,{G:()=>p});var n=e(74848),a=e(22803),s=e(34743),i=e(83505),r=e(46885),u=e(96540),o=e(92745),l=e(63142),g=e(71495),f=e(76319);const p=(0,u.memo)(({children:x,theme:v="info",placement:m="auto",content:y,title:h,closeButton:d=!0,onClose:E,footer:b,fitContent:D=!1,onOpen:C,show:P})=>{const M=(0,u.useRef)(null),O=(0,l.$j)(),j=(0,l.of)(c),U=j[v],[W,B]=(0,u.useState)(P),S=P??W,_=[(0,s.cY)(8),(0,s.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,s.BN)(),(0,s.UE)({element:M})],{context:K,refs:T,floatingStyles:L}=(0,i.we)({open:S,placement:(0,g.O)(m),onOpenChange:w=>{P===void 0&&B(w),w?C?.():E?.()},middleware:_,whileElementsMounted:r.ll,strategy:"fixed"}),A=(0,i.kp)(K),N=(0,i.s9)(K),{getReferenceProps:V,getFloatingProps:z}=(0,i.bv)([N,A]);return(0,n.jsxs)(n.Fragment,{children:[(0,u.cloneElement)(x,{ref:T.setReference,tabIndex:0,"aria-expanded":S,...V()}),S&&(0,n.jsx)(i.s3,{context:K,modal:!1,closeOnFocusOut:!1,children:(0,n.jsxs)("div",{"data-testid":"toggletip-content",className:(0,a.cx)(U.container,{[j.fitContent]:D}),ref:T.setFloating,style:L,...z(),children:[(0,n.jsx)(i.ie,{strokeWidth:.3,stroke:O.colors.border.weak,className:U.arrow,ref:M,context:K}),!!h&&(0,n.jsx)("div",{className:U.header,children:h}),d&&(0,n.jsx)("div",{className:U.headerClose,children:(0,n.jsx)(f.K,{"aria-label":(0,o.t)("grafana-ui.toggletip.close","Close"),name:"times","data-testid":"toggletip-header-close",onClick:()=>{B(!1),E?.()}})}),(0,n.jsxs)("div",{className:U.body,children:[(typeof y=="string"||(0,u.isValidElement)(y))&&y,typeof y=="function"&&y({})]}),!!b&&(0,n.jsx)("div",{className:U.footer,children:b})]})})]})});p.displayName="Toggletip";const c=x=>{const v=(0,g.f)(x,x.colors.background.primary,x.colors.border.weak,x.components.tooltip.text,{topBottom:2,rightLeft:2}),m=(0,g.f)(x,x.colors.error.main,x.colors.error.main,x.colors.error.contrastText,{topBottom:2,rightLeft:2});return{info:v,error:m,fitContent:(0,a.css)({maxWidth:"fit-content"})}}},7895:(te,R,e)=>{"use strict";e.d(R,{I:()=>p});var n=e(74848),a=e(22803),s=e(96540),i=e(30360),r=e(51898),u=e(63142),o=e(35484),l=e(45861),g=e(30703),f=e(45967);const p=(0,s.forwardRef)(({tooltip:m,icon:y,iconSize:h,className:d,children:E,imgSrc:b,imgAlt:D,fullWidth:C,isOpen:P,narrow:M,variant:O="default",iconOnly:j,"aria-label":U,isHighlighted:W,...B},S)=>{const _=(0,u.of)(v),K=(0,a.cx)({[_.button]:!0,[_.buttonFullWidth]:C,[_.narrow]:M},_[O],d),T=(0,a.cx)({[_.content]:!0,[_.contentWithIcon]:!!y,[_.contentWithRightIcon]:P!==void 0}),L=(0,n.jsxs)("button",{ref:S,className:K,"aria-label":c(U,m),"aria-expanded":P,type:"button",...B,children:[x(y,h),b&&(0,n.jsx)("img",{className:_.img,src:b,alt:D??""}),E&&!j&&(0,n.jsx)("div",{className:T,children:E}),P===!1&&(0,n.jsx)(g.I,{name:"angle-down"}),P===!0&&(0,n.jsx)(g.I,{name:"angle-up"}),W&&(0,n.jsx)("div",{className:_.highlight})]});return m?(0,n.jsx)(f.m,{ref:S,content:m,placement:"bottom",children:L}):L});p.displayName="ToolbarButton";function c(m,y){return m||(y?r.Tp.components.PageToolbar.item(y):void 0)}function x(m,y){return m?(0,i.n6)(m)?(0,n.jsx)(g.I,{name:m,size:`${y||"lg"}`}):m:null}const v=m=>{const y=(0,l.U_)(m,"primary","solid"),h=(0,l.U_)(m,"destructive","solid"),d=(0,a.css)({color:m.colors.text.primary,background:m.colors.secondary.main,"&:hover":{color:m.colors.text.primary,background:m.colors.secondary.shade,border:`1px solid ${m.colors.border.medium}`}});return{button:(0,a.css)({label:"toolbar-button",position:"relative",display:"flex",alignItems:"center",height:m.spacing(m.components.height.md),padding:m.spacing(0,1),borderRadius:m.shape.radius.default,lineHeight:`${m.components.height.md*m.spacing.gridSize-2}px`,fontWeight:m.typography.fontWeightMedium,border:`1px solid ${m.colors.secondary.border}`,whiteSpace:"nowrap",[m.transitions.handleMotion("no-preference","reduce")]:{transition:m.transitions.create(["background","box-shadow","border-color","color"],{duration:m.transitions.duration.short})},[m.breakpoints.down("md")]:{width:"auto !important"},"&:focus, &:focus-visible":{...(0,o.getFocusStyles)(m),zIndex:1},"&:focus:not(:focus-visible)":(0,o.getMouseFocusStyles)(m),"&[disabled], &:disabled":{cursor:"not-allowed",opacity:m.colors.action.disabledOpacity,background:m.colors.action.disabledBackground,boxShadow:"none","&:hover":{color:m.colors.text.disabled,background:m.colors.action.disabledBackground,boxShadow:"none"}}}),default:(0,a.css)({color:m.colors.text.secondary,background:"transparent",border:"1px solid transparent","&:hover":{color:m.colors.text.primary,background:m.colors.action.hover}}),canvas:d,active:(0,a.cx)(d,(0,a.css)({"&::before":{display:"block",content:'" "',position:"absolute",left:0,right:0,height:"2px",bottom:0,borderRadius:m.shape.radius.default,backgroundImage:m.colors.gradients.brandHorizontal}})),primary:(0,a.css)(y),destructive:(0,a.css)(h),narrow:(0,a.css)({padding:m.spacing(0,.5)}),img:(0,a.css)({width:"16px",height:"16px",marginRight:m.spacing(1)}),buttonFullWidth:(0,a.css)({flexGrow:1}),content:(0,a.css)({display:"flex",flexGrow:1}),contentWithIcon:(0,a.css)({display:"none",paddingLeft:m.spacing(1),[`@media ${(0,o.mediaUp)(m.v1.breakpoints.md)}`]:{display:"block"}}),contentWithRightIcon:(0,a.css)({paddingRight:m.spacing(.5)}),highlight:(0,a.css)({backgroundColor:m.colors.success.main,borderRadius:m.shape.radius.circle,width:"6px",height:"6px",position:"absolute",top:"-3px",right:"-3px",zIndex:1})}}},36219:(te,R,e)=>{"use strict";e.d(R,{U:()=>p});var n=e(74848),a=e(22803),s=e(18828),i=e(42211),r=e(93225),u=e(96540),o=e(92745),l=e(63142),g=e(15245),f=e(7895);const p=(0,u.forwardRef)(({alignment:x="left",className:v,children:m,...y},h)=>{const d=u.Children.toArray(m).filter(_=>_!=null),[E,b]=(0,u.useState)(Array(d.length).fill(!1)),D=(0,u.useRef)(null),[C,P]=(0,u.useState)(!1),M=(0,u.useRef)(null),O=(0,u.createRef)(),{overlayProps:j}=(0,r.e)({onClose:()=>P(!1),isDismissable:!0,isOpen:C,shouldCloseOnInteractOutside:_=>{const K=(0,g.gF)();return!M.current?.contains(_)&&!K.contains(_)}},O),{dialogProps:U}=(0,s.s)({},O),W=(0,l.$j)(),B=x==="left"?E.indexOf(!1)-1:E.length,S=c(W,B,x);return(0,u.useLayoutEffect)(()=>{const _=new IntersectionObserver(K=>{K.forEach(T=>{if(T.target instanceof HTMLElement&&T.target.parentNode){const L=Array.prototype.indexOf.call(T.target.parentNode.children,T.target);b(A=>{const N=[...A];return N[L]=T.isIntersecting,N})}})},{threshold:1,root:D.current});return D.current&&Array.from(D.current.children).forEach(K=>{K instanceof HTMLElement&&K!==M.current&&_.observe(K)}),()=>_.disconnect()},[m]),(0,n.jsxs)("div",{ref:D,className:(0,a.cx)(S.container,v),...y,children:[d.map((_,K)=>(0,n.jsx)("div",{style:{order:K,visibility:E[K]?"visible":"hidden"},className:S.childWrapper,children:_},K)),E.includes(!1)&&(0,n.jsxs)("div",{ref:M,className:S.overflowButton,children:[(0,n.jsx)(f.I,{variant:C?"active":"default",tooltip:(0,o.t)("grafana-ui.toolbar-button-row.show-more","Show more items"),onClick:()=>P(!C),icon:"ellipsis-v",iconOnly:!0,narrow:!0}),C&&(0,n.jsx)(i.n1,{contain:!0,autoFocus:!0,children:(0,n.jsx)("div",{className:S.overflowItems,ref:O,...j,...U,children:d.map((_,K)=>!E[K]&&_)})})]})]})});p.displayName="ToolbarButtonRow";const c=(x,v,m)=>({overflowButton:(0,a.css)({order:v}),overflowItems:(0,a.css)({alignItems:"center",backgroundColor:x.colors.background.primary,borderRadius:x.shape.radius.default,boxShadow:x.shadows.z2,display:"flex",flexWrap:"wrap",gap:x.spacing(1),marginTop:x.spacing(1),maxWidth:"80vw",padding:x.spacing(.5,1),position:"absolute",right:0,top:"100%",width:"max-content",zIndex:x.zIndex.dropdown}),container:(0,a.css)({alignItems:"center",display:"flex",gap:x.spacing(1),justifyContent:m==="left"?"flex-start":"flex-end",minWidth:0,position:"relative"}),childWrapper:(0,a.css)({alignItems:"center",display:"flex",gap:x.spacing(1)})})},2381:(te,R,e)=>{"use strict";e.d(R,{A:()=>g});var n=e(74848),a=e(34743),s=e(83505),i=e(46885),r=e(96540),u=e(63142),o=e(71495),l=e(15245);function g({content:f,show:p,placement:c,className:x,wrapperClassName:v,referenceElement:m,renderArrow:y,hidePopper:h,...d}){const E=(0,u.$j)(),b=(0,r.useRef)(null),D=[(0,a.cY)(8),(0,a.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,a.BN)()];y&&D.push((0,a.UE)({element:b}));const{context:C,refs:P,floatingStyles:M}=(0,s.we)({open:p,placement:(0,o.O)(c),middleware:D,whileElementsMounted:i.ll,strategy:"fixed"});(0,r.useLayoutEffect)(()=>{P.setReference(m)},[m,P]);const{styles:O}=(0,s.DL)(C,{initial:()=>({opacity:0}),duration:E.transitions.duration.enteringScreen});return p?(0,n.jsx)(l.ZL,{children:(0,n.jsx)("div",{ref:P.setFloating,style:{...M,...O},className:v,...d,children:(0,n.jsxs)("div",{className:x,children:[y&&(0,n.jsx)(s.ie,{fill:E.colors.border.weak,ref:b,context:C}),typeof f=="string"&&f,r.isValidElement(f)&&r.cloneElement(f),typeof f=="function"&&f({hidePopper:h})]})})}):void 0}},43533:(te,R,e)=>{"use strict";e.d(R,{I:()=>a});var n=e(96540);class a extends n.Component{constructor(){super(...arguments),this.hideTimeout=null,this.state={show:!1},this.showPopper=()=>{this.hideTimeout&&clearTimeout(this.hideTimeout),this.setState({show:!0})},this.hidePopper=()=>{this.hideTimeout=setTimeout(()=>{this.setState({show:!1})},this.props.hideAfter)}}render(){const{children:i,content:r,placement:u="auto"}=this.props,{show:o}=this.state;return i(this.showPopper,this.hidePopper,{show:o,placement:u,content:r})}}},20662:(te,R,e)=>{"use strict";e.d(R,{z:()=>i});var n=e(74848),a=e(96540);function s(r,u){const o=[];return r.forEach(l=>{o.push(l.start,l.end+1)}),o[0]!==0&&o.unshift(0),o[o.length-1]!==u&&o.push(u),o}const i=r=>{let{highlightParts:u,text:o,highlightClassName:l}=r;if(!u?.length)return null;let g=[],f=s(u,o.length),p=u[0].start===0;for(let c=1;c<f.length;c++){let x=f[c-1],v=f[c];g.push((0,a.createElement)(p?"mark":"span",{key:c-1,className:p?l:void 0},o.substring(x,v))),p=!p}return(0,n.jsx)("div",{children:g})}},12965:(te,R,e)=>{"use strict";e.d(R,{p:()=>o});var n=e(74848),a=e(96540),s=e(55386),i=e(92745),r=e(64913);function u(l){return`Custom unit: ${l}`}class o extends a.PureComponent{constructor(){super(...arguments),this.onChange=g=>{this.props.onChange(g.value)}}render(){const{value:g,width:f}=this.props;let p;const x=(0,s.Ke)().map(v=>{const m=v.submenu.map(y=>{const h={label:y.text,value:y.value};return y.value===g&&(p=h),h});return{label:v.text,value:v.text,items:m}});return g&&!p&&(p={value:g,label:g}),(0,n.jsx)(r.v,{width:f,initialValue:p&&p.label,allowCustomValue:!0,changeOnSelect:!1,formatCreateLabel:u,options:x,placeholder:(0,i.t)("grafana-ui.unit-picker.placeholder","Choose"),isClearable:!0,onSelect:this.props.onChange})}}},71555:(te,R,e)=>{"use strict";e.d(R,{e:()=>r});var n=e(74848),a=e(22803),s=e(63142),i=e(43990);const r=({src:o,alt:l,width:g,height:f})=>{const p=(0,s.of)(u,g,f);return(0,n.jsx)("img",{className:p.image,src:o,alt:l})},u=(o,l=3,g=3)=>({image:(0,a.css)([(0,i.Y)(o,l,f=>({width:o.spacing(f)})),(0,i.Y)(o,g,f=>({height:o.spacing(f)})),{borderRadius:o.shape.radius.circle}])})},59695:(te,R,e)=>{"use strict";e.d(R,{i:()=>o});var n=e(74848),a=e(96540),s=e(51898),i=e(63142),r=e(45861),u=e(18857);function o({"aria-label":l,label:g,icon:f,options:p,onChange:c,variant:x,minWidth:v=16,size:m="sm",isFullWidth:y=!0,menuPlacement:h,fill:d,buttonCss:E}){const[b,D]=(0,a.useState)(!1),C=(0,i.$j)();return(0,n.jsxs)(n.Fragment,{children:[!b&&(0,n.jsx)(r.$n,{size:m||"sm",className:E,icon:f||"plus",onClick:()=>D(!0),variant:x,fill:d,fullWidth:y,"data-testid":s.Tp.components.ValuePicker.button(l??g),children:g}),b&&(0,n.jsx)("span",{style:{minWidth:C.spacing(v),flexGrow:y?1:void 0},children:(0,n.jsx)(u.l6,{placeholder:g,options:p,"aria-label":s.Tp.components.ValuePicker.select(l??g),isOpen:!0,onCloseMenu:()=>D(!1),autoFocus:!0,onChange:P=>{D(!1),c(P)},menuPlacement:h})})]})}},54735:(te,R,e)=>{"use strict";e.d(R,{KU:()=>o});var n=e(74848),a=e(22803),s=e(49185),i=e(63142),r=e(35484),u=e(92807);const o=({width:f,height:p,legend:c,children:x})=>{const v=(0,i.$j)(),m=(0,i.of)(l),y={display:"flex",width:`${f}px`,height:`${p}px`},[h,d]=(0,s.A)();if(!c)return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{style:y,className:m.viz,children:x(f,p)})});let{placement:E,maxHeight:b="35%",maxWidth:D="60%"}=c.props;document.body.clientWidth<v.breakpoints.values.lg&&(E="bottom");let C=null;const P={};switch(E){case"bottom":y.flexDirection="column",P.maxHeight=b,d.height&&(C={width:f,height:p-d.height});break;case"right":y.flexDirection="row",P.maxWidth=D,d.width&&(C={width:f-d.width,height:p}),c.props.width&&(P.width=c.props.width,C={width:f-c.props.width,height:p});break}return C?.width===0&&(C.width=f),C?.height===0&&(C.height=p),(0,n.jsxs)("div",{style:y,children:[(0,n.jsx)("div",{className:m.viz,children:C&&x(C.width,C.height)}),(0,n.jsx)("div",{style:P,ref:h,children:(0,n.jsx)(u.P,{children:c})})]})},l=f=>({viz:(0,a.css)({flexGrow:2,borderRadius:f.shape.radius.default,"&:focus-visible":(0,r.getFocusStyles)(f)})}),g=({children:f})=>(0,n.jsx)(n.Fragment,{children:f});o.Legend=g},71479:(te,R,e)=>{"use strict";e.d(R,{p:()=>u});var n=e(74848),a=e(22803),s=e(96540),i=e(76637),r=e(63142);const u=s.memo(s.forwardRef(({color:l,className:g,gradient:f,lineStyle:p,...c},x)=>{const v=(0,r.$j)(),m=(0,r.of)(o);let y;if(f){const d=i.uf.get(f).getColors?.(v);d?.length?y=`linear-gradient(90deg, ${d.join(", ")})`:y=v.visualization.getColorByName("")}else y=l;let h;return p?.fill==="dot"&&!f?h={backgroundImage:`radial-gradient(circle at 2px 2px, ${l} 2px, transparent 0)`,backgroundSize:"4px 4px",backgroundRepeat:"space"}:p?.fill==="dash"&&!f?h={backgroundImage:`linear-gradient(to right, ${l} 100%, transparent 0%)`,backgroundSize:"6px 4px",backgroundRepeat:"space"}:h={background:y,borderRadius:v.shape.radius.pill},(0,n.jsx)("div",{"data-testid":"series-icon",ref:x,className:(0,a.cx)(g,m.forcedColors,m.container),style:h,...c})})),o=l=>({container:(0,a.css)({marginRight:"8px",display:"inline-block",width:"14px",height:"4px"}),forcedColors:(0,a.css)({"@media (forced-colors: active)":{forcedColorAdjust:"none"}})});u.displayName="SeriesIcon"},4268:(te,R,e)=>{"use strict";e.d(R,{t:()=>U});var n=e(74848),a=e(96540),s=e(57852),i=e(739),r=e(64400),u=e(49256),o=e(22803),l=e(63142),g=e(34950),f=e(5585),p=e(89123);const c=({items:W,itemRenderer:B,onLabelMouseOver:S,onLabelMouseOut:_,onLabelClick:K,placement:T,className:L,readonly:A})=>{const N=(0,l.of)(x);B||(B=z=>(0,n.jsx)(p.M,{item:z,onLabelClick:K,onLabelMouseOver:S,onLabelMouseOut:_,readonly:A}));const V=z=>`${z.getItemKey?z.getItemKey():z.label}`;switch(T){case"right":{const z=(w,H)=>(0,n.jsx)("span",{className:N.itemRight,children:B(w,H)});return(0,n.jsx)("div",{className:(0,o.cx)(N.rightWrapper,L),children:(0,n.jsx)(f.B,{items:W,renderItem:z,getItemKey:V})})}case"bottom":default:{const z=W.filter(Q=>Q.yAxis===1),w=W.filter(Q=>Q.yAxis!==1),H=(Q,Z)=>(0,n.jsx)("span",{className:N.itemBottom,children:B(Q,Z)});return(0,n.jsxs)("div",{className:(0,o.cx)(N.bottomWrapper,L),children:[z.length>0&&(0,n.jsx)("div",{className:N.section,children:(0,n.jsx)(g.c,{items:z,renderItem:H,getItemKey:V})}),w.length>0&&(0,n.jsx)("div",{className:(0,o.cx)(N.section,N.sectionRight),children:(0,n.jsx)(g.c,{items:w,renderItem:H,getItemKey:V})})]})}}};c.displayName="VizLegendList";const x=W=>{const B=(0,o.css)({paddingRight:"10px",display:"flex",fontSize:W.typography.bodySmall.fontSize,whiteSpace:"nowrap"});return{itemBottom:B,itemRight:(0,o.cx)(B,(0,o.css)({marginBottom:W.spacing(.5)})),rightWrapper:(0,o.css)({padding:W.spacing(.5)}),bottomWrapper:(0,o.css)({display:"flex",flexWrap:"wrap",justifyContent:"space-between",width:"100%",padding:W.spacing(.5),gap:"15px 25px"}),section:(0,o.css)({display:"flex"}),sectionRight:(0,o.css)({justifyContent:"flex-end",flexGrow:1,flexBasis:"50%"})}};var v=e(30703),m=e(55386),y=e(92745),h=e(35484),d=e(87);const E=({item:W,onLabelClick:B,onLabelMouseOver:S,onLabelMouseOut:_,className:K,readonly:T})=>{const L=(0,l.of)(b),A=(0,a.useCallback)(z=>{S&&S(W,z)},[W,S]),N=(0,a.useCallback)(z=>{_&&_(W,z)},[W,_]),V=(0,a.useCallback)(z=>{B&&B(W,z)},[W,B]);return(0,n.jsxs)("tr",{className:(0,o.cx)(L.row,K),children:[(0,n.jsx)("td",{children:(0,n.jsxs)("span",{className:L.itemWrapper,children:[(0,n.jsx)(d.R,{color:W.color,seriesName:W.fieldName??W.label,readonly:T,lineStyle:W.lineStyle}),(0,n.jsxs)("button",{disabled:T,type:"button",title:W.label,onBlur:N,onFocus:A,onMouseOver:A,onMouseOut:N,onClick:T?void 0:V,className:(0,o.cx)(L.label,W.disabled&&L.labelDisabled),children:[W.label," ",W.yAxis===2&&(0,n.jsx)("span",{className:L.yAxisLabel,children:(0,n.jsx)(y.x6,{i18nKey:"grafana-ui.viz-legend.right-axis-indicator",children:"(right y-axis)"})})]})]})}),W.getDisplayValues&&W.getDisplayValues().map((z,w)=>(0,n.jsx)("td",{className:L.value,children:(0,m.cN)(z)},`${z.title}-${w}`))]})};E.displayName="LegendTableItem";const b=W=>{const B=(0,h.hoverColor)(W.colors.background.primary,W);return{row:(0,o.css)({label:"LegendRow",fontSize:W.v1.typography.size.sm,borderBottom:`1px solid ${W.colors.border.weak}`,td:{padding:W.spacing(.25,1),whiteSpace:"nowrap"},"&:hover":{background:B}}),label:(0,o.css)({label:"LegendLabel",whiteSpace:"nowrap",background:"none",border:"none",fontSize:"inherit",padding:0,maxWidth:"600px",textOverflow:"ellipsis",overflow:"hidden",userSelect:"text"}),labelDisabled:(0,o.css)({label:"LegendLabelDisabled",color:W.colors.text.disabled}),itemWrapper:(0,o.css)({display:"flex",whiteSpace:"nowrap",alignItems:"center"}),value:(0,o.css)({textAlign:"right"}),yAxisLabel:(0,o.css)({color:W.colors.text.secondary})}},D="Name",C=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}).compare,P=({items:W,sortBy:B,sortDesc:S,itemRenderer:_,className:K,onToggleSort:T,onLabelClick:L,onLabelMouseOver:A,onLabelMouseOut:N,readonly:V,isSortable:z})=>{const w=(0,l.of)(M),H={};z&&(H[D]="");for(const Q of W)if(Q.getDisplayValues)for(const Z of Q.getDisplayValues())H[Z.title??"?"]=Z.description??"";if(B!=null){let Q=new Map;W.forEach(Y=>{if(B!==D&&Y.getDisplayValues){const X=Y.getDisplayValues().find(J=>J.title===B),I=X==null||Number.isNaN(X.numeric)?-1/0:X.numeric;Q.set(Y,I)}});let Z=S?-1:1;B===D?W.sort((Y,X)=>Z*C(Y.label,X.label)):W.sort((Y,X)=>{const I=Q.get(Y)??0,J=Q.get(X)??0;return Z*(I-J)})}return _||(_=(Q,Z)=>(0,n.jsx)(E,{item:Q,onLabelClick:L,onLabelMouseOver:A,onLabelMouseOut:N,readonly:V},`${Q.label}-${Z}`)),(0,n.jsxs)("table",{className:(0,o.cx)(w.table,K),children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[!z&&(0,n.jsx)("th",{}),Object.keys(H).map(Q=>(0,n.jsxs)("th",{title:H[Q],className:(0,o.cx)(w.header,T&&w.headerSortable,z&&w.nameHeader,{[w.withIcon]:B===Q}),onClick:()=>{T&&T(Q)},children:[Q,B===Q&&(0,n.jsx)(v.I,{size:"xs",name:S?"angle-down":"angle-up"})]},Q))]})}),(0,n.jsx)("tbody",{children:W.map(_)})]})},M=W=>({table:(0,o.css)({width:"100%","th:first-child":{width:"100%",borderBottom:`1px solid ${W.colors.border.weak}`}}),header:(0,o.css)({color:W.colors.primary.text,fontWeight:W.typography.fontWeightMedium,borderBottom:`1px solid ${W.colors.border.weak}`,padding:W.spacing(.25,1,.25,1),fontSize:W.typography.bodySmall.fontSize,textAlign:"right",whiteSpace:"nowrap"}),nameHeader:(0,o.css)({textAlign:"left",paddingLeft:"30px"}),withIcon:(0,o.css)({paddingRight:"4px"}),headerSortable:(0,o.css)({cursor:"pointer"})});var O=e(22940);function j(W){return W.ctrlKey||W.metaKey||W.shiftKey?u.B.AppendToSelection:u.B.ToggleSelection}function U({items:W,thresholdItems:B,mappingItems:S,displayMode:_,sortBy:K,seriesVisibilityChangeBehavior:T=O.K.Isolate,sortDesc:L,onLabelClick:A,onToggleSort:N,placement:V,className:z,itemRenderer:w,readonly:H,isSortable:Q}){const{eventBus:Z,onToggleSeriesVisibility:Y,onToggleLegendSort:X}=(0,r.d2)(),I=(0,a.useCallback)((ne,se)=>{Z?.publish({type:s.b_.type,payload:{raw:se,x:0,y:0,dataId:ne.label}})},[Z]),J=(0,a.useCallback)((ne,se)=>{Z?.publish({type:s.ql.type,payload:{raw:se,x:0,y:0,dataId:ne.label}})},[Z]),ee=(0,a.useCallback)((ne,se)=>{A&&A(ne,se),Y&&Y(ne.fieldName??ne.label,T===O.K.Hide?u.B.AppendToSelection:j(se))},[Y,A,T]),q=(0,a.useCallback)(ne=>(0,n.jsx)(c,{className:z,placement:V,onLabelMouseOver:I,onLabelMouseOut:J,onLabelClick:ee,itemRenderer:w,readonly:H,items:ne}),[z,V,I,J,ee,w,H]);switch(_){case i.lm.Table:return(0,n.jsx)(P,{className:z,items:W,placement:V,sortBy:K,sortDesc:L,onLabelClick:ee,onToggleSort:N||X,onLabelMouseOver:I,onLabelMouseOut:J,itemRenderer:w,readonly:H,isSortable:Q});case i.lm.List:const ne=B&&B.length>1,se=S&&S.length>0;return(0,n.jsxs)(n.Fragment,{children:[!ne&&(!se||W.length>1)&&q(W),ne&&q(B),se&&q(S)]});default:return null}}U.displayName="VizLegend"},89123:(te,R,e)=>{"use strict";e.d(R,{M:()=>c});var n=e(74848),a=e(22803),s=e(96540),i=e(51898),r=e(63142),u=e(87),o=e(2543),l=e(55386),g=e(34950);const f=({stats:v})=>{const m=(0,r.of)(p);return v.length===0?null:(0,n.jsx)(g.c,{className:m.list,items:v,renderItem:y=>(0,n.jsxs)("div",{className:m.item,title:y.description,children:[y.title&&`${(0,o.capitalize)(y.title)}:`," ",(0,l.cN)(y)]})})},p=()=>({list:(0,a.css)({flexGrow:1,textAlign:"right"}),item:(0,a.css)({marginLeft:"8px"})});f.displayName="VizLegendStatsList";const c=({item:v,onLabelClick:m,onLabelMouseOver:y,onLabelMouseOut:h,className:d,readonly:E})=>{const b=(0,r.of)(x),D=(0,s.useCallback)(M=>{y&&y(v,M)},[v,y]),C=(0,s.useCallback)(M=>{h&&h(v,M)},[v,h]),P=(0,s.useCallback)(M=>{m&&m(v,M)},[v,m]);return(0,n.jsxs)("div",{className:(0,a.cx)(b.itemWrapper,v.disabled&&b.itemDisabled,d),"data-testid":i.Tp.components.VizLegend.seriesName(v.label),children:[(0,n.jsx)(u.R,{seriesName:v.fieldName??v.label,color:v.color,gradient:v.gradient,readonly:E,lineStyle:v.lineStyle}),(0,n.jsx)("button",{disabled:E,type:"button",onBlur:C,onFocus:D,onMouseOver:D,onMouseOut:C,onClick:P,className:b.label,children:v.label}),v.getDisplayValues&&(0,n.jsx)(f,{stats:v.getDisplayValues()})]})};c.displayName="VizLegendListItem";const x=v=>({label:(0,a.css)({label:"LegendLabel",whiteSpace:"nowrap",background:"none",border:"none",fontSize:"inherit",padding:0,userSelect:"text"}),itemDisabled:(0,a.css)({label:"LegendLabelDisabled",color:v.colors.text.disabled}),itemWrapper:(0,a.css)({label:"LegendItemWrapper",display:"flex",whiteSpace:"nowrap",alignItems:"center",flexGrow:1}),value:(0,a.css)({textAlign:"right"}),yAxisLabel:(0,a.css)({color:v.v1.palette.gray2})})},87:(te,R,e)=>{"use strict";e.d(R,{R:()=>u});var n=e(74848),a=e(96540),s=e(35427),i=e(64400),r=e(71479);const u=(0,a.memo)(({seriesName:o,color:l,gradient:g,readonly:f,lineStyle:p})=>{const{onSeriesColorChange:c}=(0,i.d2)(),x=(0,a.useCallback)(v=>c(o,v),[o,c]);return o&&c&&l&&!f?(0,n.jsx)(s.Dp,{color:l,onChange:x,enableNamedColors:!0,children:({ref:v,showColorPicker:m,hideColorPicker:y})=>(0,n.jsx)(r.p,{color:l,className:"pointer",ref:v,onClick:m,onMouseLeave:y,lineStyle:p})}):(0,n.jsx)(r.p,{color:l,gradient:g,lineStyle:p})});u.displayName="VizLegendSeriesIcon"},22940:(te,R,e)=>{"use strict";e.d(R,{K:()=>n});var n=(a=>(a[a.Isolate=0]="Isolate",a[a.Hide=1]="Hide",a))(n||{})},33352:(te,R,e)=>{"use strict";e.d(R,{S:()=>o});var n=e(74848),a=e(2543),s=e(96540),i=e(38919);const r=(g,f,p,c)=>{const x=u(g,f,c),v=u(f,g,c),m=Math.max(x,v);let y=Math.floor(g/m),h=Math.ceil(c/y);y=Math.ceil(c/h);const d=y-(y*h-c),E=g/d-p+p/d;return{width:g/y-p+p/y,height:f/h-p+p/h,widthOnLastRow:E,xCount:y,yCount:h}};function u(g,f,p){const c=Math.ceil(Math.sqrt(p*g/f));return Math.floor(c*f/g)*c<p?f/Math.ceil(c*f/g):g/c}class o extends s.PureComponent{static{this.defaultProps={itemSpacing:8}}constructor(f){super(f),this.state={values:f.getValues()}}componentDidUpdate(f){const{renderCounter:p,source:c}=this.props;(p!==f.renderCounter||c!==f.source)&&this.setState({values:this.props.getValues()})}getOrientation(){const{orientation:f,width:p,height:c}=this.props;return f===i.wV.Auto?p>c?i.wV.Vertical:i.wV.Horizontal:f}renderGrid(){const{renderValue:f,height:p,width:c,itemSpacing:x,getAlignmentFactors:v,orientation:m}=this.props,{values:y}=this.state,h=r(c,p,x,y.length),d=v?v(y,h.width,h.height):{};let E=0,b=0,D=[];for(let C=0;C<y.length;C++){const P=y[C],O=b===h.yCount-1?h.widthOnLastRow:h.width,j=h.height,U=E*O+x*E,W=b*j+x*b,B={position:"absolute",left:U,top:W,width:`${O}px`,height:`${j}px`};D.push((0,n.jsx)("div",{style:B,children:f({value:P,width:O,height:j,alignmentFactors:d,orientation:m,count:y.length})},C)),E++,E===h.xCount&&(E=0,b++)}return(0,n.jsx)("div",{style:{position:"relative"},children:D})}render(){const{renderValue:f,height:p,width:c,itemSpacing:x,getAlignmentFactors:v,autoGrid:m,orientation:y,maxVizHeight:h,minVizWidth:d,minVizHeight:E}=this.props,{values:b}=this.state;if(m&&y===i.wV.Auto)return this.renderGrid();const D={display:"flex"},C={display:"flex",overflow:`${d?"auto":"hidden"} ${E?"auto":"hidden"}`};let P=p,M=c;const O=this.getOrientation();switch(O){case i.wV.Horizontal:const U=(p+x)/b.length-x;C.flexDirection="column",C.height=`${p}px`,C.overflowX="hidden",C.scrollbarWidth="thin",D.marginBottom=`${x}px`,M=c,P=(0,a.clamp)(U,E??0,h??U);break;case i.wV.Vertical:C.flexDirection="row",C.justifyContent="space-between",C.overflowY="hidden",D.marginRight=`${x}px`,P=p,M=Math.max(c/b.length-x+x/b.length,d??0)}D.width=`${M}px`,D.height=`${P}px`;const j=v?v(b,M,P):{};return(0,n.jsx)("div",{style:C,children:b.map((U,W)=>(0,n.jsx)("div",{style:l(D,W,b.length),children:f({value:U,width:M,height:P,alignmentFactors:j,orientation:O,count:b.length})},W))})}}function l(g,f,p){return f===p-1?{...g,marginRight:0,marginBottom:0}:g}},63428:(te,R,e)=>{"use strict";e.d(R,{g:()=>o,o:()=>l});var n=e(74848),a=e(22803),s=e(92745),i=e(63142),r=e(71479);const u=g=>({icon:(0,a.css)({marginRight:g.spacing(1),verticalAlign:"middle"}),seriesTable:(0,a.css)({display:"table"}),seriesTableRow:(0,a.css)({display:"table-row",fontSize:g.typography.bodySmall.fontSize}),seriesTableCell:(0,a.css)({display:"table-cell"}),label:(0,a.css)({wordBreak:"break-all"}),value:(0,a.css)({paddingLeft:g.spacing(2),textAlign:"right"}),activeSeries:(0,a.css)({fontWeight:g.typography.fontWeightBold,color:g.colors.text.maxContrast}),timestamp:(0,a.css)({fontWeight:g.typography.fontWeightBold,fontSize:g.typography.bodySmall.fontSize})}),o=({color:g,label:f,value:p,isActive:c})=>{const x=(0,i.of)(u);return(0,n.jsxs)("div",{"data-testid":"SeriesTableRow",className:(0,a.cx)(x.seriesTableRow,c&&x.activeSeries),children:[g&&(0,n.jsx)("div",{className:x.seriesTableCell,children:(0,n.jsx)(r.p,{color:g,className:x.icon})}),f&&(0,n.jsx)("div",{className:(0,a.cx)(x.seriesTableCell,x.label),children:f}),p&&(0,n.jsx)("div",{className:(0,a.cx)(x.seriesTableCell,x.value),children:p})]})},l=({timestamp:g,series:f})=>{const p=(0,i.of)(u);return(0,n.jsxs)(n.Fragment,{children:[g&&(0,n.jsx)("div",{className:p.timestamp,"aria-label":(0,s.t)("grafana-ui.viz-tooltip.timestamp","Timestamp"),children:g}),f.map((c,x)=>(0,n.jsx)(o,{isActive:c.isActive,label:c.label,color:c.color,value:c.value},`${c.label}-${x}`))]})}},71076:(te,R,e)=>{"use strict";e.d(R,{o:()=>l});var n=e(74848),a=e(22803),s=e(96540),i=e(52908),r=e(63142),u=e(35484),o=e(55302);const l=({position:{x:f,y:p},offset:{x:c,y:x},children:v,allowPointerEvents:m=!1,className:y,...h})=>{const d=(0,s.useRef)(null),[E,b]=(0,s.useState)({width:0,height:0}),{width:D,height:C}=(0,i.A)(),[P,M]=(0,s.useState)({x:f+c,y:p+x}),O=(0,s.useMemo)(()=>new ResizeObserver(U=>{for(let W of U){const B=Math.floor(W.contentRect.width+16),S=Math.floor(W.contentRect.height+2*8);(E.width!==B||E.height!==S)&&b({width:Math.min(B,D),height:Math.min(S,C)})}}),[E,D,C]);(0,s.useLayoutEffect)(()=>(d.current&&O.observe(d.current),()=>{O.disconnect()}),[O]),(0,s.useLayoutEffect)(()=>{if(d&&d.current){const{x:U,y:W}=(0,o.Ju)(f,p,E.width,E.height,c,x,D,C);M({x:U,y:W})}},[D,C,f,c,p,x,E]);const j=(0,r.of)(g);return(0,n.jsx)("div",{ref:d,style:{position:"fixed",left:0,pointerEvents:m?"auto":"none",top:0,transform:`translate(${P.x}px, ${P.y}px)`,transition:"transform ease-out 0.1s"},"aria-live":"polite","aria-atomic":"true",...h,className:(0,a.cx)(j.wrapper,y),children:v})};l.displayName="VizTooltipContainer";const g=f=>({wrapper:(0,a.css)((0,u.getTooltipContainerStyles)(f))})},39064:(te,R,e)=>{"use strict";e.d(R,{S:()=>m});var n=e(74848),a=e(22803),s=e(96540),i=e(92745),r=e(63142),u=e(8779),o=e(45861),l=e(28134),g=e(30703),f=e(41654);const p="add-annotation-button";function c(h,d,E){return(D,C)=>{if(D.length===0)return;const P=D.find(M=>M.oneClick===!0);return P!=null?(0,n.jsx)("div",{className:C.dataLinks,children:(0,n.jsx)(f.B,{direction:"column",justifyContent:"flex-start",gap:.5,children:(0,n.jsxs)("span",{className:C.oneClickWrapper,children:[(0,n.jsx)(g.I,{name:"info-circle",size:"lg",className:C.infoIcon}),h(P.title)]})})}):(0,n.jsx)("div",{className:C.dataLinks,children:(0,n.jsx)(f.B,{direction:"column",justifyContent:"flex-start",gap:E,children:D.map((M,O)=>d(M,O,C))})})}}const x=c(h=>(0,n.jsxs)(i.x6,{i18nKey:"grafana-ui.viz-tooltip.footer-click-to-navigate",children:["Click to open ",{linkTitle:h}]}),(h,d,E)=>(0,n.jsx)(l.R,{link:h,buttonProps:{className:E.dataLinkButton,fill:"text"}},d),.5),v=c(h=>(0,n.jsxs)(i.x6,{i18nKey:"grafana-ui.viz-tooltip.footer-click-to-action",children:["Click to ",{actionTitle:h}]}),(h,d)=>(0,n.jsx)(u.r,{action:h,variant:"secondary"},d)),m=({dataLinks:h,actions:d=[],annotate:E})=>{const b=(0,r.of)(y),D=(0,s.useMemo)(()=>h.some(P=>P.oneClick===!0),[h]),C=(0,s.useMemo)(()=>d.some(P=>P.oneClick===!0),[d]);return(0,n.jsxs)("div",{className:b.wrapper,children:[!C&&x(h,b),!D&&v(d,b),!D&&!C&&E!=null&&(0,n.jsx)("div",{className:b.addAnnotations,children:(0,n.jsx)(o.$n,{icon:"comment-alt",variant:"secondary",size:"sm",id:p,onClick:E,children:(0,n.jsx)(i.x6,{i18nKey:"grafana-ui.viz-tooltip.footer-add-annotation",children:"Add annotation"})})})]})},y=h=>({wrapper:(0,a.css)({display:"flex",flexDirection:"column",flex:1,padding:h.spacing(0)}),dataLinks:(0,a.css)({borderTop:`1px solid ${h.colors.border.medium}`,padding:h.spacing(1)}),addAnnotations:(0,a.css)({borderTop:`1px solid ${h.colors.border.medium}`,padding:h.spacing(1)}),dataLinkButton:(0,a.css)({cursor:"pointer","&:hover":{textDecoration:"underline",background:"none"},padding:0,height:"auto","& span":{whiteSpace:"normal",textAlign:"left"}}),oneClickWrapper:(0,a.css)({display:"flex",alignItems:"center"}),infoIcon:(0,a.css)({color:h.colors.primary.main,paddingRight:h.spacing(.5)})})},61048:(te,R,e)=>{"use strict";e.d(R,{i:()=>i});var n=e(74848),a=e(22803),s=e(63142);const i=({children:u,className:o})=>{const l=(0,s.of)(r);return(0,n.jsx)("div",{className:(0,a.cx)(l.wrapper,o),children:u})},r=u=>({wrapper:(0,a.css)({display:"flex",flexDirection:"column",fontSize:u.typography.bodySmall.fontSize})})},55978:(te,R,e)=>{"use strict";e.d(R,{Ev:()=>s,fX:()=>n,lJ:()=>a});var n=(i=>(i.series="series",i.value="value",i.hexagon="hexagon",i.pie_1_4="pie_1_4",i.pie_2_4="pie_2_4",i.pie_3_4="pie_3_4",i.marker_sm="marker_sm",i.marker_md="marker_md",i.marker_lg="marker_lg",i))(n||{}),a=(i=>(i.hidden="hidden",i.first="first",i.leading="leading",i.trailing="trailing",i))(a||{});const s="series"},55302:(te,R,e)=>{"use strict";e.d(R,{Ju:()=>o,L$:()=>l,cp:()=>c});var n=e(95004),a=e(76637),s=e(55386),i=e(64394),r=e(739),u=e(55978);const o=(x=0,v=0,m=0,y=0,h=0,d=0,E=0,b=0)=>{let D=x,C=v;const P=Math.max(x+h+m-(E-h),0),M=Math.abs(Math.min(x-h-m-h,0)),O=P>0,j=M>0,U=Math.max(v+d+y-(b-d),0),W=Math.abs(Math.min(v-d-y-d,0)),B=U>0,S=W>0;return O&&j?D=P>M?h:E-h-m:O?D=x-h-m:D=x+h,B&&S?C=U>W?d:b-d-y:B?C=v-d-y:C=v+d,{x:D,y:C}},l=(x,v)=>{switch(x){case u.fX.value:return v.value;case u.fX.hexagon:return v.hexagon;case u.fX.pie_1_4:return v.pie_1_4;case u.fX.pie_2_4:return v.pie_2_4;case u.fX.pie_3_4:return v.pie_3_4;case u.fX.marker_sm:return v.marker_sm;case u.fX.marker_md:return v.marker_md;case u.fX.marker_lg:return v.marker_lg;default:return v.value}},g=(x,v)=>x.numeric-v.numeric,f=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),p=(x,v)=>f.compare(`${x.value}`,`${v.value}`),c=(x,v,m,y,h,d,E=D=>!0,b=!1)=>{let D=[],C=!0;for(let P=0;P<x.length;P++){const M=x[P];if(M===v||M.type===n.PU.time||!E(M)||M.config.custom?.hideFrom?.tooltip||M.config.custom?.hideFrom?.viz||h===r.$N.Single&&y!==P)continue;let O=m[P];if(O==null)continue;M.type===n.PU.number||M.type===n.PU.boolean||M.type===n.PU.enum||(C=!1);const j=x[P].values[O];if(j==null&&M.config.noValue==null||b&&j===0)continue;const U=M.display(j),W=Number.isNaN(U.numeric)?d===r.xB.Descending?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER:U.numeric,B=(0,a.Qi)(M);let S=u.fX.series,_=u.lJ.first;B.isByValue&&(S=u.fX.value,_=u.lJ.trailing),D.push({label:M.state?.displayName??M.name,value:(0,s.cN)(U),color:U.color??i.F,colorIndicator:S,colorPlacement:_,isActive:h===r.$N.Multi&&y===P,numeric:W,lineStyle:M.config.custom?.lineStyle})}if(d!==r.xB.None&&D.length>1){const P=C?g:p,M=d===r.xB.Descending?-1:1;D.sort((O,j)=>M*P(O,j))}return D}},92790:(te,R,e)=>{"use strict";e.d(R,{Z:()=>l});var n=e(74848),a=e(96540),s=e(36613),i=e(36192);function r(g,f){return f.width===g.width&&f.height===g.height}function u(g,f){return f.data===g.data}function o(g,f){return f.config===g.config}class l extends a.Component{constructor(f){super(f),this.plotContainer=(0,a.createRef)(),this.plotCanvasBBox=(0,a.createRef)(),this.plotInstance=null}reinitPlot(){let{width:f,height:p,plotRef:c}=this.props;if(this.plotInstance?.destroy(),f===0&&p===0)return;this.props.config.addHook("setSize",m=>{m.over});const x={width:Math.floor(this.props.width),height:Math.floor(this.props.height),...this.props.config.getConfig()};(0,i.uY)("UPlot",!1,"Reinitializing plot",x);const v=new s.A(x,this.props.data,this.plotContainer.current);c&&c(v),this.plotInstance=v}componentDidMount(){this.reinitPlot()}componentWillUnmount(){this.plotInstance?.destroy()}componentDidUpdate(f){r(f,this.props)?o(f,this.props)?u(f,this.props)||this.plotInstance?.setData(this.props.data):this.reinitPlot():this.plotInstance?.setSize({width:Math.floor(this.props.width),height:Math.floor(this.props.height)})}render(){return(0,n.jsxs)("div",{style:{position:"relative"},children:[(0,n.jsx)("div",{ref:this.plotContainer,"data-testid":"uplot-main-div"}),this.props.children]})}}},61897:(te,R,e)=>{"use strict";e.d(R,{$:()=>p,t:()=>f});var n=e(74848),a=e(96540),s=e(16515),i=e(76637),r=e(739),u=e(63142),o=e(54735),l=e(4268),g=e(36192);function f(c,x){return c.getSeries().some(v=>{const m=v.props.dataFrameFieldIndex;if(!m)return!1;const y=x[m.frameIndex]?.fields[m.fieldIndex];return!(!y||y.config.custom?.hideFrom?.legend)})}const p=(0,a.memo)(({data:c,config:x,placement:v,calcs:m,displayMode:y,...h})=>{const d=(0,u.$j)(),E=x.getSeries().map(b=>{const D=b.props,C=D.dataFrameFieldIndex,P=x.getAxisPlacement(b.props.scaleKey);if(!C)return;const M=c[C.frameIndex]?.fields[C.fieldIndex];if(!M||M.config.custom?.hideFrom?.legend)return;const O=(0,s.Ct)(M,c[C.frameIndex],c),U=(0,i.lz)(M,d).color;return{disabled:!(D.show??!0),fieldIndex:C,color:U,label:O,yAxis:P===r.vM.Left||P===r.vM.Bottom?1:2,getDisplayValues:()=>(0,g.UO)(m,M,d),getItemKey:()=>`${O}-${C.frameIndex}-${C.fieldIndex}`,lineStyle:D.lineStyle}}).filter(b=>b!==void 0);return(0,n.jsx)(o.KU.Legend,{placement:v,...h,children:(0,n.jsx)(l.t,{placement:v,items:E,displayMode:y,sortBy:h.sortBy,sortDesc:h.sortDesc,isSortable:!0})})});p.displayName="PlotLegend"},99555:(te,R,e)=>{"use strict";e.d(R,{P:()=>s,t:()=>i});var n=e(92745),a=e(739);const s=()=>({drawStyle:[{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.draw-style.label-lines","Lines"),value:a.GR.Line},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.draw-style.label-bars","Bars"),value:a.GR.Bars},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.draw-style.label-points","Points"),value:a.GR.Points}],lineInterpolation:[{description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.line-interpolation.description-linear","Linear"),value:a.dx.Linear,icon:"gf-interpolation-linear"},{description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.line-interpolation.description-smooth","Smooth"),value:a.dx.Smooth,icon:"gf-interpolation-smooth"},{description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.line-interpolation.description-step-before","Step before"),value:a.dx.StepBefore,icon:"gf-interpolation-step-before"},{description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.line-interpolation.description-step-after","Step after"),value:a.dx.StepAfter,icon:"gf-interpolation-step-after"}],barAlignment:[{description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.bar-alignment.description-before","Before"),value:a.Nj.Before,icon:"gf-bar-alignment-before"},{description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.bar-alignment.description-center","Center"),value:a.Nj.Center,icon:"gf-bar-alignment-center"},{description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.bar-alignment.description-after","After"),value:a.Nj.After,icon:"gf-bar-alignment-after"}],showPoints:[{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.show-points.label-auto","Auto"),value:a.yL.Auto,description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.show-points.description-auto","Show points when the density is low")},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.show-points.label-always","Always"),value:a.yL.Always},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.show-points.label-never","Never"),value:a.yL.Never}],axisPlacement:[{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.axis-placement.label-auto","Auto"),value:a.vM.Auto,description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.axis-placement.description-auto","First field on the left, everything else on the right")},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.axis-placement.label-left","Left"),value:a.vM.Left},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.axis-placement.label-right","Right"),value:a.vM.Right},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.axis-placement.label-hidden","Hidden"),value:a.vM.Hidden}],fillGradient:[{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.fill-gradient.label-none","None"),value:a.on.None},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.fill-gradient.label-opacity","Opacity"),value:a.on.Opacity,description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.fill-gradient.description-opacity","Enable fill opacity gradient")},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.fill-gradient.label-hue","Hue"),value:a.on.Hue,description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.fill-gradient.description-hue","Small color hue gradient")},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.fill-gradient.label-scheme","Scheme"),value:a.on.Scheme,description:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.fill-gradient.description-scheme","Use color scheme to define gradient")}],stacking:[{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.stacking.label-off","Off"),value:a.gs.None},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.stacking.label-normal","Normal"),value:a.gs.Normal},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.stacking.label-100","100%"),value:a.gs.Percent}],thresholdsDisplayModes:[{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.thresholds-display-mode.label-off","Off"),value:a.Ly.Off},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.thresholds-display-mode.label-lines","As lines"),value:a.Ly.Line},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.thresholds-display-mode.label-dashed-lines","As lines (dashed)"),value:a.Ly.Dashed},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.thresholds-display-mode.label-filled-regions","As filled regions"),value:a.Ly.Area},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.thresholds-display-mode.label-filled-regions-and-lines","As filled regions and lines"),value:a.Ly.LineAndArea},{label:(0,n.t)("grafana-ui.u-plot.config.get-graph-field-options.thresholds-display-mode.label-filled-regions-and-dashed-lines","As filled regions and lines (dashed)"),value:a.Ly.DashedAndArea}]}),i=s()},23414:(te,R,e)=>{"use strict";e.d(R,{Zj:()=>h,pi:()=>g,zH:()=>y});var n=e(55386),a=e(79243),s=e(5421),i=e(80011),r=e(739),u=e(53568),o=e(62748),l=e(42073);const g=12,f=150,p=30,c=15,x=40,v=18,m=8;class y extends o.R{merge(P){this.props.size=(0,l.Y)("max",this.props.size,P.size),this.props.label||(this.props.label=P.label),this.props.placement===r.vM.Auto&&(this.props.placement=P.placement)}getConfig(){let{scaleKey:P,label:M,show:O=!0,placement:j=r.vM.Auto,grid:U={show:!0},ticks:W,space:B,filter:S,gap:_=5,formatValue:K,splits:T,values:L,incrs:A,isTime:N,timeZone:V,theme:z,tickLabelRotation:w,size:H,color:Q,border:Z,decimals:Y,distr:X=r.L4.Linear}=this.props;const I=`${g}px ${z.typography.fontFamily}`,J=z.isDark?"rgba(240, 250, 255, 0.09)":"rgba(0, 10, 23, 0.09)";(0,n.j9)(P)&&(T=[0,1]),Y===0&&X===r.L4.Linear&&(S=(q,ne)=>ne.map(se=>Number.isInteger(se)?se:null));let ee={scale:P,show:O,stroke:Q??z.colors.text.primary,side:D(j),font:I,size:H??((q,ne,se)=>b(q,ne,se)),rotate:w,gap:_,labelGap:0,grid:{show:U.show,stroke:J,width:1/devicePixelRatio},ticks:Object.assign({show:!0,stroke:Z?.show?Q??z.colors.text.primary:J,width:1/devicePixelRatio,size:4},W),splits:T,values:L,space:B??((q,ne,se,oe,de)=>E(q,ne,se,oe,de,K)),filter:S,incrs:A};return Z?.show&&(ee.border={stroke:Q??z.colors.text.primary,width:1/devicePixelRatio,...Z}),M!=null&&M.length>0&&(ee.label=M,ee.labelSize=g+m,ee.labelFont=I,ee.labelGap=m),L?ee.values=L:N?ee.values=d:K&&(ee.values=(q,ne,se,oe,de)=>{let fe=(0,a.E)((0,a.h)(de,6));return ne.map(ae=>ae==null?null:K(ae,fe>0?fe:void 0))}),ee.timeZone=V,ee}}const h={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:28*24*60*60*1e3,year:365*24*60*60*1e3};function d(C,P,M,O,j){const U=C.axes[M],W="timeZone"in U&&typeof U.timeZone=="string"?U.timeZone:void 0,B=C.scales.x,S=(B?.max??0)-(B?.min??0),_=Math.round(h.year/h.day)*h.day,K=Math.round(j/h.day)*h.day;let T=s.WC.interval.year;return j<h.second?T=s.WC.interval.millisecond:j<=h.minute?T=s.WC.interval.second:S<=h.day?T=s.WC.interval.minute:j<=h.day?T=s.WC.interval.hour:S<h.year?T=s.WC.interval.day:K===_?T=s.WC.interval.year:j<=h.year&&(T=s.WC.interval.month),P.map(L=>L==null?"":(0,i.LE)(L,{format:T,timeZone:W}))}function E(C,P,M,O,j,U){const W=C.axes[P],B=C.scales[W.scale];if(W.side!==2||!B)return j<=f?c:p;const S=j/x,_=(O-M)/S,K=Math.max(Math.abs(M),Math.abs(O));let T="";if(B.time)T=d(C,[K],P,x,_)[0];else if(U!=null)T=U(K);else return x;return(0,u.kD)(T,g).width+v}function b(C,P,M){const O=C.axes[M];let j=O.ticks.size;if(O.side===2)j+=O.gap+g;else if(P?.length){let U=P.reduce((B,S)=>Math.max(B,(0,u.kD)(S,g).width),0);const W=Math.min(C.width*.4,U);j+=O.gap+O.labelGap+W}return Math.ceil(j)}function D(C){switch(C){case r.vM.Top:return 0;case r.vM.Right:return 1;case r.vM.Bottom:return 2;case r.vM.Left:}return 3}},47276:(te,R,e)=>{"use strict";e.d(R,{e:()=>b});var n=e(2543),a=e(36613),s=e(22592),i=e(62717),r=e(739),u=e(36192),o=e(23414),l=e(42073),g=e(64394),f=e(6773),p=e(62748),c=e(66650);class x extends p.R{getConfig(){const{facets:C,drawStyle:P,pathBuilder:M,pointsBuilder:O,pointsFilter:j,lineInterpolation:U,lineWidth:W,lineStyle:B,barAlignment:S,barWidthFactor:_,barMaxWidth:K,showPoints:T,pointSize:L,scaleKey:A,pxAlign:N,spanNulls:V,show:z=!0}=this.props;let w={},H=this.getLineColor();w.stroke=H,w.width=W,B&&B.fill!=="solid"&&(B.fill==="dot"&&(w.cap="round"),w.dash=B.dash??[10,10]),M!=null?w.paths=M:P===r.GR.Points?w.paths=()=>null:P!=null&&(w.paths=(Y,X,I,J)=>m(P,U,S,_,K)(Y,X,I,J));const Q=typeof H=="string"?H:(Y,X)=>Y.series[X]._stroke,Z={points:{stroke:Q,fill:Q,size:!L||L<W?void 0:L,filter:j}};return O!=null?Z.points.show=O:P===r.GR.Points?Z.points.show=!0:T===r.yL.Auto?P===r.GR.Bars&&(Z.points.show=!1):T===r.yL.Never?Z.points.show=!1:T===r.yL.Always&&(Z.points.show=!0),{scale:A,facets:C,spanGaps:typeof V=="number"?!1:V,value:()=>"",pxAlign:N,show:z,fill:this.getFill(),...w,...Z}}getLineColor(){const{lineColor:C,gradientMode:P,colorMode:M,thresholds:O,theme:j,hardMin:U,hardMax:W,softMin:B,softMax:S,dynamicSeriesColor:_}=this.props;return P===r.on.None&&_?(K,T)=>_(T)??C??g.F:P===r.on.Scheme&&M?.id!==g.Y.Fixed?(0,c.pl)(1,j,M,O,U,W,B,S):P===r.on.Hue?(0,c.B5)(C??g.F,1,j):C??g.F}getFill(){const{lineColor:C,fillColor:P,gradientMode:M,fillOpacity:O,colorMode:j,thresholds:U,theme:W,hardMin:B,hardMax:S,softMin:_,softMax:K,dynamicSeriesColor:T}=this.props;if(P)return P;const L=M??r.on.None,A=(O??0)/100;if(L===r.on.None&&T&&A>0)return(N,V)=>{let z=N.series[V]._stroke;return f.MV.alpha(z??"",A)};switch(L){case r.on.Opacity:return(0,c.WO)(P??C,A);case r.on.Hue:return(0,c.B5)(P??C,A,W);case r.on.Scheme:if(j?.id!==g.Y.Fixed)return(0,c.pl)(A,W,j,U,B,S,_,K);default:if(A>0)return f.MV.alpha(C??"",A)}}}let v;function m(D,C,P=r.Nj.Center,M=.6,O=200){const j=a.A.paths;if(v||(v={linear:j.linear(),smooth:j.spline(),stepBefore:j.stepped({align:-1}),stepAfter:j.stepped({align:1})}),D===r.GR.Bars){let U=`bars|${P}|${M}|${O}`;return v[U]||(v[U]=j.bars({size:[M,O],align:P})),v[U]}else if(D===r.GR.Line){if(C===r.dx.StepBefore)return v.stepBefore;if(C===r.dx.StepAfter)return v.stepAfter;if(C===r.dx.Smooth)return v.smooth}return v.linear}var y=e(84140),h=e(33553);function d(D){const C=D.config.mode===r.Ly.Dashed||D.config.mode===r.Ly.DashedAndArea?[10,10]:[];function P(T,L,A,N){let V=T.ctx,z=0;for(let w=0;w<A.length;w++)if(A[w].color==="transparent"){z=w;break}V.lineWidth=2,V.setLineDash(C);for(let w=1;w<A.length;w++){const H=A[w];let Q;z>=w&&w>0?Q=(0,y.A)(N.visualization.getColorByName(A[w-1].color)):Q=(0,y.A)(N.visualization.getColorByName(H.color)),Q.getAlpha()===1&&Q.setAlpha(.7);const Z=T.scales.x.ori===r.Lt.Horizontal,Y=T.valToPos(H.value,L,!0);let X=Math.round(Z?T.bbox.left:Y),I=Math.round(Z?Y:T.bbox.top),J=Math.round(Z?T.bbox.left+T.bbox.width:Y),ee=Math.round(Z?Y:T.bbox.top+T.bbox.height);V.beginPath(),V.moveTo(X,I),V.lineTo(J,ee),V.strokeStyle=Q.toString(),V.stroke()}}function M(T,L,A,N){let V=T.ctx,z=(0,c.Z8)(T,L,A.map(w=>{let H=(0,y.A)(N.visualization.getColorByName(w.color));return H.getAlpha()===1&&H.setAlpha(.15),[w.value,H.toString()]}),!0);V.fillStyle=z,V.fillRect(T.bbox.left,T.bbox.top,T.bbox.width,T.bbox.height)}const{scaleKey:O,thresholds:j,theme:U,config:W,hardMin:B,hardMax:S,softMin:_,softMax:K}=D;return T=>{const L=T.ctx,{min:A,max:N}=T.scales.x,{min:V,max:z}=T.scales[O];if(A==null||N==null||V==null||z==null)return;let{steps:w,mode:H}=j;if(H===h.O.Percentage){let[Q,Z]=(0,c.EJ)(T,O,B,S,_,K),Y=Z-Q;w=w.map(X=>({...X,value:Q+Y*(X.value/100)}))}switch(L.save(),W.mode){case r.Ly.Line:case r.Ly.Dashed:P(T,O,w,U);break;case r.Ly.Area:M(T,O,w,U);break;case r.Ly.LineAndArea:case r.Ly.DashedAndArea:M(T,O,w,U),P(T,O,w,U)}L.restore()}}const E={drag:{setScale:!1},points:{size:(D,C)=>D.series[C].points.size*2,width:(D,C,P)=>P/4},focus:{prox:30}};class b{constructor(C=s.lE){this.uid=Math.random().toString(36).slice(2),this.series=[],this.axes={},this.scales=[],this.bands=[],this.stackingGroups=[],this.hasLeftAxis=!1,this.hooks={},this.tz=void 0,this.mode=1,this.frames=void 0,this.thresholds={},this.padding=void 0,this.prepData=void 0,this.scaleKeys=["",""],this.tzDate=P=>{let M=new Date(P);return this.tz?a.A.tzDate(M,this.tz):M},this.tz=(0,i.QZ)(C,Date.now())?.ianaName}addHook(C,P){(0,u.uY)("UPlotConfigBuilder",!1,"addHook",C),this.hooks[C]||(this.hooks[C]=[]),this.hooks[C].push(P)}addThresholds(C){this.thresholds[C.scaleKey]||(this.thresholds[C.scaleKey]=C,this.addHook("drawClear",d(C)))}addAxis(C){C.placement=C.placement??r.vM.Auto,C.grid=C.grid??{};let P=C.scaleKey;if(P==="x"&&(P+=C.timeZone??""),this.axes[P]){this.axes[P].merge(C);return}C.placement===r.vM.Auto&&(C.placement=this.hasLeftAxis?r.vM.Right:r.vM.Left),C.placement===r.vM.Left&&(this.hasLeftAxis=!0),C.placement===r.vM.Hidden&&(C.grid.show=!1,C.size=0),this.axes[P]=new o.zH(C)}getAxisPlacement(C){return this.axes[C]?.props.placement??r.vM.Left}setCursor(C){this.cursor=(0,n.merge)({},this.cursor,C)}setMode(C){this.mode=C}setSelect(C){this.select=C}addSeries(C){this.series.push(new x(C))}getSeries(){return this.series}addScale(C){const P=this.scales.find(M=>M.props.scaleKey===C.scaleKey);if(P){P.merge(C);return}this.scales.push(new l.G(C))}addBand(C){this.bands.push(C)}setStackingGroups(C){this.stackingGroups=C}getStackingGroups(){return this.stackingGroups}setPrepData(C){this.prepData=P=>(this.frames=P,C(P,this.getStackingGroups()))}setPadding(C){this.padding=C}getConfig(){if(this.cachedConfig)return this.cachedConfig;const C={...u.NN,mode:this.mode,series:[this.mode===2?null:{value:()=>""}]};C.axes=this.ensureNonOverlappingAxes(Object.values(this.axes)).map(M=>M.getConfig()),C.series=[...C.series,...this.series.map(M=>M.getConfig())],C.scales=this.scales.reduce((M,O)=>({...M,...O.getConfig()}),{}),C.hooks=this.hooks,C.select=this.select;const P=(M="")=>(O,j)=>{let U=O.series[j].points._stroke;if(typeof U!="string"){let W=this.frames[0].fields[j];U=W.display(W.values[O.cursor.idxs[j]]).color}return U+M};return C.cursor=(0,n.merge)({},E,{points:{stroke:P("80"),fill:P()}},this.cursor),C.tzDate=this.tzDate,Array.isArray(this.padding)&&(C.padding=this.padding),this.stackingGroups.forEach(M=>{(0,u.Tz)(M).forEach(O=>{this.addBand(O)})}),this.bands.length&&(C.bands=this.bands),this.cachedConfig=C,C}ensureNonOverlappingAxes(C){const P=C.find(j=>j.props.scaleKey==="x"),M=C.filter(j=>j.props.grid?.show===void 0),O=M.findIndex(j=>j.props.placement===r.vM.Left||j.props.placement===r.vM.Right||j.props.placement===r.vM.Bottom&&j!==P);for(let j=0;j<M.length;j++)M[j]===P||j===O?M[j].props.grid.show=!0:M[j].props.grid.show=!1;return C}}},42073:(te,R,e)=>{"use strict";e.d(R,{G:()=>u,Y:()=>o});var n=e(36613),a=e(74261),s=e(55386),i=e(739),r=e(62748);class u extends r.R{merge(g){this.props.min=o("min",this.props.min,g.min),this.props.max=o("max",this.props.max,g.max)}getConfig(){let{isTime:g,auto:f,scaleKey:p,min:c,max:x,softMin:v,softMax:m,range:y,direction:h,orientation:d,centeredZero:E,decimals:b,stackingMode:D}=this.props;D===i.gs.Percent&&(c==null&&v==null&&(v=0),x==null&&m==null&&(m=1));const C=this.props.distribution,P=g?{}:{distr:C===i.L4.Symlog?4:C===i.L4.Log?3:C===i.L4.Ordinal?2:1,log:C===i.L4.Log||C===i.L4.Symlog?this.props.log??2:void 0,asinh:C===i.L4.Symlog?this.props.linearThreshold??1:void 0};if(C===i.L4.Log){let _=this.props.log,K=_===2?Math.log2:Math.log10;c!=null&&(c<=0?c=null:c=_**Math.floor(K(c))),x!=null&&(x<=0?x=null:x=_**Math.ceil(K(x))),v!=null&&(v<=0?v=null:v=_**Math.floor(K(v))),m!=null&&(m<=0?m=null:m=_**Math.ceil(K(m)))}let M=v==null?3:1,O=m==null?3:1;const j={min:{pad:.1,hard:c??-1/0,soft:v||0,mode:M},max:{pad:.1,hard:x??1/0,soft:m||0,mode:O}};let U=v==null&&c!=null,W=m==null&&x!=null,B=U&&W;const S=(_,K,T,L)=>{const A=_.scales[L];let N=[K,T];if(!B&&K==null&&T==null)return N;let V=A.log??10;if(A.distr===1||A.distr===2||A.distr===4){if(E){let z=Math.abs(K),w=Math.abs(T),H=Math.max(z,w);H===0&&(H=80),K=-H,T=H}A.distr===4?N=n.A.rangeAsinh(K,T,V,!0):N=n.A.rangeNum(U?c:K,W?x:T,j)}else A.distr===3&&(N=n.A.rangeLog(c??K,x??T,V,!0));if(b===0)if(A.distr===1||A.distr===2)N[0]=(0,a.rs)(N[0],1),N[1]=(0,a.Uh)(N[1],1);else if(A.distr===3){let z=A.log===2?Math.log2:Math.log10;if(N[0]<=1)N[0]=1;else{let H=Math.floor(z(N[0]));N[0]=V**H}let w=Math.ceil(z(N[1]));N[1]=V**w,N[0]===N[1]&&(N[1]*=V)}else A.distr===4&&(N[0]=(0,a.rs)(N[0],1),N[1]=(0,a.Uh)(N[1],1));return(A.distr===1||A.distr===4)&&(U&&(N[0]=c),W&&(N[1]=x)),N[0]>=N[1]&&(N[0]=A.distr===3?1:0,N[1]=100),N};return f??=!g&&!B,(0,s.j9)(p)&&(f=!1,y=[0,1]),{[p]:{time:g,auto:f,range:y??S,dir:h,ori:d,...P}}}}function o(l,g,f){const p=g!=null,c=f!=null;return p?c?l==="min"?g<f?g:f:g>f?g:f:g:f}},66650:(te,R,e)=>{"use strict";e.d(R,{B5:()=>g,EJ:()=>x,WO:()=>l,Z8:()=>p,pl:()=>m});var n=e(84140),a=e(6773),s=e(64394),i=e(33553),r=e(739),u=e(53568);function o(y,h,d){let E=0,b=0,D=0,C=0;return y===3?(b=h.top,C=h.top+h.height):y===2?(E=h.left+h.width,D=h.left):y===1?(b=h.top+h.height,C=h.top):y===0&&(E=h.left,D=h.left+h.width),d.createLinearGradient(E,b,D,C)}function l(y,h){return(d,E)=>{const b=(0,u.Yc)(),D=o(d.scales.x.ori===r.Lt.Horizontal?3:2,d.bbox,b);return D.addColorStop(0,a.MV.alpha(y,h)),D.addColorStop(1,a.MV.alpha(y,0)),D}}function g(y,h,d){return(E,b)=>{const D=(0,u.Yc)(),C=o(E.scales.x.ori===r.Lt.Horizontal?3:2,E.bbox,D),P=(0,n.A)(y).spin(-25).darken(5),M=(0,n.A)(y).saturate(20).spin(20).brighten(10);return d.isDark?(C.addColorStop(0,M.lighten(10).setAlpha(h).toString()),C.addColorStop(1,P.darken(10).setAlpha(h).toString())):(C.addColorStop(0,M.lighten(10).setAlpha(h).toString()),C.addColorStop(1,P.setAlpha(h).toString())),C}}var f=(y=>(y[y.Right=0]="Right",y[y.Up=1]="Up",y[y.Left=2]="Left",y[y.Down=3]="Down",y))(f||{});function p(y,h,d,E=!1){let b=y.scales[h],D=null,C=null;for(let A=0;A<d.length;A++){let N=d[A][0];if((N<=b.min||D==null)&&(D=A),C=A,N>=b.max)break}if(D===C)return d[D][1];let P=d[D][0],M=d[C][0];P===-1/0&&(P=b.min),M===1/0&&(M=b.max);let O=Math.round(y.valToPos(P,h,!0)),j=Math.round(y.valToPos(M,h,!0)),U=O-j;if(U===0)return d[C][1];let W,B,S,_;y.scales.x.ori===r.Lt.Horizontal?(W=S=0,B=O,_=j):(B=_=0,W=O,S=j);let T=(0,u.Yc)().createLinearGradient(W,B,S,_),L;for(let A=D;A<=C;A++){let N=d[A],V=A===D?O:A===C?j:Math.round(y.valToPos(N[0],h,!0)),z=(O-V)/U;E&&A>D&&T.addColorStop(z,L),T.addColorStop(z,L=N[1])}return T}function c(y,h){let d=y.scales[h],E=1/0,b=-1/0;return y.series.forEach((D,C)=>{if(D.show&&D.scale===h)if(D.min==null){let P=y.data[C];for(let M=0;M<P.length;M++)P[M]!=null&&(E=Math.min(E,P[M]),b=Math.max(b,P[M]))}else E=Math.min(E,D.min),b=Math.max(b,D.max)}),b===E&&(E=d.min,b=d.max),[E,b]}function x(y,h,d,E,b,D){let C=d??b??null,P=E??D??null;if(C==null||P==null){let[M,O]=c(y,h);C=C??M??0,P=P??O??100}return[C,P]}function v(y){return y==="transparent"||y[0]==="#"&&y.slice(-2)==="00"}function m(y,h,d,E,b,D,C,P){if(!d)throw Error("Missing colorMode required for color scheme gradients");if(!E)throw Error("Missing thresholds required for color scheme gradients");return(M,O)=>{let j=M.series[O].scale,U="";if(d.id===s.Y.Thresholds)if(E.mode===i.O.Absolute){const W=E.steps.map(B=>[B.value,v(B.color)?"#0000":a.MV.alpha(h.visualization.getColorByName(B.color),y)]);U=p(M,j,W,!0)}else{const[W,B]=x(M,j,b,D,C,P),S=B-W,_=E.steps.map(K=>[W+S*(K.value/100),a.MV.alpha(h.visualization.getColorByName(K.color),y)]);U=p(M,j,_,!0)}else if(d.getColors){const W=d.getColors(h),[B,S]=x(M,j,b,D,C,P),_=S-B,K=W.map((T,L)=>[B+_*(L/(W.length-1)),a.MV.alpha(h.visualization.getColorByName(T),y)]);U=p(M,j,K,!1)}return U}}},7515:(te,R,e)=>{"use strict";e.d(R,{a:()=>u});var n=e(74848),a=e(96540),s=e(1604),i=e(73858),r=e(16477);function u({id:o,events:l,renderEventMarker:g,mapEventToXYCoords:f,config:p}){const c=(0,a.useRef)(),[x,v]=(0,a.useState)(0),m=(0,s.A)();(0,a.useLayoutEffect)(()=>{p.addHook("init",h=>{c.current=h}),p.addHook("draw",()=>{m()&&v(h=>h+1)})},[p,v]);const y=(0,a.useMemo)(()=>{const h=[];if(!c.current||l.length===0)return h;for(let d=0;d<l.length;d++){const E=l[d];for(let b=0;b<E.length;b++){const D=f(E,{fieldIndex:b,frameIndex:d});D&&h.push((0,a.createElement)(i.p,{...D,key:`${o}-marker-${d}-${b}`},g(E,{fieldIndex:b,frameIndex:d})))}}return(0,n.jsx)(n.Fragment,{children:h})},[l,g,x]);return c.current?(0,n.jsx)(r._,{left:c.current.bbox.left/window.devicePixelRatio,top:c.current.bbox.top/window.devicePixelRatio,children:y}):null}},73858:(te,R,e)=>{"use strict";e.d(R,{p:()=>a});var n=e(74848);const a=({x:s,y:i,children:r})=>(0,n.jsx)("div",{style:{position:"absolute",top:`${i}px`,left:`${s}px`},children:r})},16477:(te,R,e)=>{"use strict";e.d(R,{_:()=>i});var n=e(74848),a=e(22803),s=e(96540);const i=({children:r,left:u,top:o})=>{const l=(0,s.useMemo)(()=>(0,a.css)({position:"absolute",overflow:"visible",left:`${u}px`,top:`${o}px`}),[u,o]);return(0,n.jsx)("div",{className:l,children:r})}},70332:(te,R,e)=>{"use strict";e.d(R,{M:()=>s});var n=e(739),a=e(62748);function s(r,u){const o="na",l=`${r.min!==void 0?r.min:o}-${r.max!==void 0?r.max:o}`,g=`${r.custom?.axisSoftMin!==void 0?r.custom.axisSoftMin:o}-${r.custom?.axisSoftMax!==void 0?r.custom.axisSoftMax:o}`,f=`${r.custom?.axisPlacement!==void 0?r.custom?.axisPlacement:n.vM.Auto}`,p=r.unit??a.s,c=r.custom?.scaleDistribution?i(r.custom.scaleDistribution):n.L4.Linear,x=r.custom?.axisLabel?r.custom.axisLabel:o;return`${p}/${l}/${g}/${f}/${c}/${x}/${u}`}function i(r){return r.type===n.L4.Log?`${r.type}${r.log}`:r.type}},84522:(te,R,e)=>{"use strict";e.d(R,{J:()=>r});var n=e(74848),a=e(22803),s=e(76319),i=e(63142);const r=({onClick:o,"aria-label":l,style:g})=>{const f=(0,i.of)(u);return(0,n.jsx)(s.K,{"aria-label":l??"Close",className:f,name:"times",onClick:o,style:g})},u=o=>(0,a.css)({position:"absolute",margin:"0px",right:5,top:6})},18667:(te,R,e)=>{"use strict";e.d(R,{K:()=>l});var n=e(2543),a=e.n(n),s=e(96540),i=e(64423),r=e(99165),u=e(57852),o=e(32899);const l=({config:g,eventBus:f,frame:p})=>{const c=(0,s.useRef)(p);return c.current=p,(0,s.useLayoutEffect)(()=>{let x=null;const v={point:{time:null},data:c.current};g.addHook("init",C=>{x=C});let m=null;g.addHook("setSeries",(C,P)=>{m=P}),g.addHook("setLegend",()=>{if(!(x.cursor.event==null)){let P=x.cursor.idxs.find(M=>M!=null);if(P==null)D();else{let M=P,O=m,j=x.data[0]??x.data[1][0];v.point.time=j[M],v.rowIndex=M??void 0,v.columnIndex=O??void 0,v.data=c.current;let U=x.cursor.top;v.point.panelRelY=U===0?.001:U>0?U/x.rect.height:1,b()}}});function y(C){const P=C.payload?.point?.time;if(P){const M=x.valToPos(P,"x");x.setCursor({left:M,top:x.rect.height/2})}}const h=new i.yU,d=new u.b_(v).setTags(["uplot"]),E=new u.ql().setTags(["uplot"]);let b=(0,n.throttle)(()=>{f.publish(d)},100),D=(0,n.throttle)(()=>{f.publish(E)},100);return h.add(f.getStream(u.b_).subscribe({next:C=>{f===C.origin||C.tags?.has("uplot")||y(C)}})),h.add(f.getStream(o.kb).subscribe({next:C=>y(C)})),h.add(f.getStream(u.ql).pipe((0,r.c)(50)).subscribe({next:C=>{f===C.origin||C.tags?.has("uplot")||x.cursor._lock||x.setCursor({left:-10,top:-10})}})),()=>{h.unsubscribe()}},[g]),null}},93630:(te,R,e)=>{"use strict";e.d(R,{Z:()=>l});var n=e(2543),a=e.n(n),s=e(96540);const i=.1,r=2,u=new Set(["ArrowRight","ArrowLeft","ArrowUp","ArrowDown","Shift"," "]),o=g=>{let f=g.root,p=new Set,c=null,x=null;if(!f)return;f.tabIndex=0;const v=(D,C)=>{const{cursor:P}=g;if(P.left===void 0||P.top===void 0)return;const{width:M,height:O}=g.over.style,[j,U]=[Math.floor(parseFloat(M)),Math.floor(parseFloat(O))];g.setCursor({left:(0,n.clamp)(P.left+D,0,j),top:(0,n.clamp)(P.top+C,0,U)})},m=D=>{if(p.size===0||!g){x=null;return}const M=(D-(x??D))*i;let O=0,j=0;p.has("ArrowUp")&&(j-=M),p.has("ArrowDown")&&(j+=M),p.has("ArrowLeft")&&(O-=M),p.has("ArrowRight")&&(O+=M),p.has("Shift")&&(O*=r,j*=r),v(O,j);const{cursor:U}=g;if(p.has(" ")&&U){const W=Number(g.over.style.height.slice(0,-2));g.setSelect({left:U.left<c?U.left:c,top:0,width:Math.abs(U.left-(c??U.left)),height:W},!1)}x=D,window.requestAnimationFrame(m)},y=D=>{if(D.key==="Tab"){g.setCursor({left:-5,top:-5});return}if(!u.has(D.key))return;if(D.preventDefault(),D.stopPropagation(),!p.has(D.key)){const P=p.size===0;p.add(D.key),c=D.key===" "&&c===null?g.cursor.left:c,P&&window.requestAnimationFrame(m)}},h=D=>{u.has(D.key)&&(p.delete(D.key),D.key===" "&&(D.preventDefault(),D.stopPropagation(),g.setSelect(g.select),c=null))},d=()=>{if(!f?.matches(":focus-visible"))return;const D=parseFloat(g.over.style.width),C=parseFloat(g.over.style.height);g.setCursor({left:D/2,top:C/2})},E=()=>{x=null,c=null,p.clear(),g.setSelect({left:0,top:0,width:0,height:0},!1)};f.addEventListener("keydown",y),f.addEventListener("keyup",h),f.addEventListener("focus",d),f.addEventListener("blur",E);const b=()=>{f?.removeEventListener("keydown",y),f?.removeEventListener("keyup",h),f?.removeEventListener("focus",d),f?.removeEventListener("blur",E),f=null};(g.hooks.destroy??=[]).push(b)},l=({config:g})=>((0,s.useLayoutEffect)(()=>g.addHook("init",o),[g]),null)},69234:(te,R,e)=>{"use strict";e.d(R,{b3:()=>p,xl:()=>d});var n=e(74848),a=e(22803),s=e(96540),i=e(40961),r=e(21275),u=e(63142),o=e(15245),l=e(84522);const g=void 0,f=10;var p=(b=>(b[b.xOne=0]="xOne",b[b.xAll=1]="xAll",b[b.xyOne=2]="xyOne",b))(p||{});function c(b,D){return{...b,...D,style:{...b.style,...D.style}}}function x(){return{style:{transform:"",pointerEvents:"none"},isHovering:!1,isPinned:!1,contents:null,plot:null,dismiss:()=>{}}}const v=5,m=b=>b!=null&&!b.ctrlKey&&!b.metaKey,y=()=>[],h=/Android|iPhone|iPad/i.test(navigator.userAgent),d=({config:b,hoverMode:D,render:C,clientZoom:P=!1,queryZoom:M,onSelectRange:O,maxWidth:j,syncMode:U=r.yV.Off,syncScope:W="global",getDataLinks:B=y})=>{const S=(0,s.useRef)(null),_=(0,s.useRef)(null);_.current==null&&(_.current=(0,o.gF)());const[{plot:K,isHovering:T,isPinned:L,contents:A,style:N,dismiss:V},z]=(0,s.useReducer)(c,null,x),w=(0,s.useRef)(),H=(0,u.of)(E,j),Q=(0,s.useRef)(C);Q.current=C;const Z=(0,s.useRef)(B);return Z.current=B,(0,s.useLayoutEffect)(()=>{w.current?.observer.disconnect(),w.current={width:0,height:0,observer:new ResizeObserver(Ue=>{let we=w.current;for(const Xe of Ue)Xe.borderBoxSize?.length>0?(we.width=Xe.borderBoxSize[0].inlineSize,we.height=Xe.borderBoxSize[0].blockSize):(we.width=Xe.contentRect.width,we.height=Xe.contentRect.height)})};let Y=!1,X=!1,I=K,J=T,ee=!1,q=L,ne=N,se=!1;const oe=U===r.yV.Tooltip;U!==r.yV.Off&&b.scales[0].props.isTime&&b.setCursor({sync:{key:W,scales:["x",null]}});const de=()=>{le?J=se&&ee&&oe:J=ve!=null||D===1&&ee};let fe=0,ae=0,ce=null,ie=[],ve=null,le=!1,Ee=[],Re=[],Oe=!1,Se=!1;const Te=(Ue=!1)=>{Oe||(J?queueMicrotask(He):setTimeout(He,100),Oe=!0),Ue&&(Se=!0)},_e=Ue=>{Ue.target.closest('[role="dialog"], #grafana-portal-container')==null&&tt()},He=()=>{Oe=!1,Se&&(ne={pointerEvents:q?"all":"none"},I.cursor._lock=q,q?(document.addEventListener("mousedown",_e,!0),document.addEventListener("keydown",_e,!0)):(document.removeEventListener("mousedown",_e,!0),document.removeEventListener("keydown",_e,!0)),Se=!1);let Ue={style:ne,isPinned:q,isHovering:J,contents:J||ce!=null?Q.current(I,ie,ve,q,tt,ce,le,q?Ee:ve!=null?Re[ve]:[]):null,dismiss:tt};z(Ue),ce=null},tt=()=>{let Ue=q;q=!1,J=!1,I.setCursor({left:-10,top:-10}),Ee=[],Te(Ue)};b.addHook("init",Ue=>{z({plot:I=Ue}),P&&Ue.over.addEventListener("mousedown",we=>{if(m(we)&&we.button===0&&we.shiftKey){X=!0,Ue.cursor.drag.x=!1,Ue.cursor.drag.y=!0;let Xe=nt=>{Ue.cursor.drag.x=!0,Ue.cursor.drag.y=!1,document.removeEventListener("mouseup",Xe,!0)};document.addEventListener("mouseup",Xe,!0)}},!0),Ue.over.addEventListener("click",we=>{if(we.target===Ue.over){if(we.ctrlKey||we.metaKey){let Xe;Ue.scales.x.ori===0?Xe=Ue.posToVal(Ue.cursor.left,"x"):Xe=Ue.posToVal(Ue.select.top+Ue.select.height,"x"),ce={from:Xe,to:Xe},Te(!1)}else if(J&&!q&&ve!=null){Ee=Z.current(ve,ie[ve]);const Xe=Ee.find(nt=>nt.oneClick===!0);Xe!=null?window.open(Xe.href,Xe.target??"_self"):setTimeout(()=>{q=!0,Te(!0)},0)}}})}),b.addHook("setSelect",Ue=>{const we=Ue.scales.x.ori===0;if(!le&&(P||M!=null))if(m(Ue.cursor.event)){if(O!=null){let Xe=[];const nt=!!Ue.cursor.drag.y,he=!!Ue.cursor.drag.x;let xe=null,me=[];he&&(xe={from:we?Ue.posToVal(Ue.select.left,"x"):Ue.posToVal(Ue.select.top+Ue.select.height,"x"),to:we?Ue.posToVal(Ue.select.left+Ue.select.width,"x"):Ue.posToVal(Ue.select.top,"x")}),nt&&b.scales.forEach(ye=>{const De=ye.props.scaleKey;if(De!=="x"){let Le={from:we?Ue.posToVal(Ue.select.top+Ue.select.height,De):Ue.posToVal(Ue.select.left+Ue.select.width,De),to:we?Ue.posToVal(Ue.select.top,De):Ue.posToVal(Ue.select.left,De)};me.push(Le)}}),he?nt?Xe=me.map(ye=>({x:xe,y:ye})):Xe=[{x:xe}]:nt&&(Xe=me.map(ye=>({y:ye}))),O(Xe)}else if(P&&X){if(Ue.select.height>=v){for(let Xe in Ue.scales)if(Xe!=="x"){const nt=we?Ue.posToVal(Ue.select.top,Xe):Ue.posToVal(Ue.select.left+Ue.select.width,Xe),he=we?Ue.posToVal(Ue.select.top+Ue.select.height,Xe):Ue.posToVal(Ue.select.left,Xe);Ue.setScale(Xe,{min:he,max:nt})}Y=!0}X=!1}else if(M!=null&&Ue.select.width>=v){const Xe=we?Ue.posToVal(Ue.select.left,"x"):Ue.posToVal(Ue.select.top+Ue.select.height,"x"),nt=we?Ue.posToVal(Ue.select.left+Ue.select.width,"x"):Ue.posToVal(Ue.select.top,"x");M({from:Xe,to:nt}),Y=!1}}else ce={from:we?Ue.posToVal(Ue.select.left,"x"):Ue.posToVal(Ue.select.top+Ue.select.height,"x"),to:we?Ue.posToVal(Ue.select.left+Ue.select.width,"x"):Ue.posToVal(Ue.select.top,"x")},Te(!0);Ue.setSelect({left:0,width:0,top:0,height:0},!1)}),(P||M!=null)&&b.setCursor({bind:{dblclick:Ue=>()=>{if(!m(Ue.cursor.event))return null;if(P&&Y){for(let we in Ue.scales)we!=="x"&&Ue.setScale(we,{min:null,max:null});Y=!1}else if(M!=null){let we=Ue.scales.x;const Xe=we.min,nt=we.max,he=(nt-Xe)/2;M({from:Xe-he,to:nt+he})}return null}}}),b.addHook("setData",Ue=>{Y=!1,X=!1,q&&tt()}),b.addHook("setSeries",(Ue,we)=>{ve=we,le=Ue.cursor.event==null,de(),Te()}),b.addHook("setLegend",Ue=>{ie=I?.cursor.idxs.slice(),ee=ie.some((Xe,nt)=>nt>0&&Xe!=null),Re.length===0&&(Re=ie.map((Xe,nt)=>{if(nt>0){const xe=B(nt,ie[nt]).find(me=>me.oneClick===!0);if(xe)return[xe]}return[]})),le=Ue.cursor.event==null;let we=J;de(),(J||J!==we)&&Te()});const Je=16;let Ge=0,je=0;const Fe=()=>{J&&!q&&tt(),Ge=window.innerWidth-Je,je=window.innerHeight-Je},Be=()=>{se=I.rect.bottom<=je&&I.rect.top>=0&&I.rect.left>=0&&I.rect.right<=Ge};Fe(),b.addHook("ready",Be),b.addHook("setCursor",Ue=>{if(le=Ue.cursor.event==null,!J)return;let{left:we=-10,top:Xe=-10}=Ue.cursor;if(we>=0||Xe>=0){let nt=Ue.rect.left+we,he=Ue.rect.top+Xe,xe="",{width:me,height:ye}=w.current;me+=f,ye+=f,ae!==0?he+ye<je||he-ye<0?ae=0:ae!==-ye&&(ae=-ye):he+ye>je&&he-ye>=0&&(ae=-ye),fe!==0?nt+me<Ge||nt-me<0?fe=0:fe!==-me&&(fe=-me):nt+me>Ge&&nt-me>=0&&(fe=-me);const De=nt+(fe===0?f:-f),Le=he+(ae===0?f:-f);xe=`translateX(${De}px) ${fe===0?"":"translateX(-100%)"} translateY(${Le}px) ${ae===0?"":"translateY(-100%)"}`,S.current!=null?S.current.style.transform=xe:(ne.transform=xe,Te())}});const Ke=Ue=>{Be(),J&&Ue.target instanceof Node&&Ue.target.contains(I.root)&&tt()};return window.addEventListener("resize",Fe),window.addEventListener("scroll",Ke,!0),()=>{w.current?.observer.disconnect(),window.removeEventListener("resize",Fe),window.removeEventListener("scroll",Ke,!0),document.removeEventListener("mousedown",_e,!0),document.removeEventListener("keydown",_e,!0)}},[b]),(0,s.useLayoutEffect)(()=>{const Y=w.current;if(S.current!=null){Y.observer.disconnect(),Y.observer.observe(S.current);const{width:X,height:I}=S.current.getBoundingClientRect();Y.width=X,Y.height=I;let J=K.cursor.event;if(J!=null){const ee=J.type!=="mousemove"||h;ee&&(J=new MouseEvent("mousemove",{view:window,bubbles:!0,cancelable:!0,clientX:J.clientX,clientY:J.clientY,screenX:J.screenX,screenY:J.screenY})),!(ee?!1:performance.now()-J.timeStamp>16)&&K.over.dispatchEvent(J)}else K.setCursor({left:K.cursor.left,top:K.cursor.top},!0)}else Y.width=0,Y.height=0},[T]),K&&T?(0,i.createPortal)((0,n.jsxs)("div",{className:(0,a.cx)(H.tooltipWrapper,L&&H.pinned),style:N,"aria-live":"polite","aria-atomic":"true",ref:S,children:[L&&(0,n.jsx)(l.J,{onClick:V}),A]}),_.current):null},E=(b,D)=>({tooltipWrapper:(0,a.css)({top:0,left:0,zIndex:b.zIndex.portal,whiteSpace:"pre",borderRadius:b.shape.radius.default,position:"fixed",background:b.colors.background.elevated,border:`1px solid ${b.colors.border.weak}`,boxShadow:b.shadows.z2,userSelect:"text",maxWidth:D??"none"}),pinned:(0,a.css)({boxShadow:b.shadows.z3})})},62748:(te,R,e)=>{"use strict";e.d(R,{R:()=>a,s:()=>n});const n="__fixed";class a{constructor(i){this.props=i}}},36192:(te,R,e)=>{"use strict";e.d(R,{NN:()=>l,Tz:()=>f,UO:()=>y,bq:()=>c,ro:()=>p,sw:()=>x,uY:()=>d});var n=e(46644),a=e(11576),s=e(739),i=e(20720),r=e(60379),u=e(70332);const o=(E,b,D)=>{let C=b%2?D[0]||D[2]:D[1]||D[3];return D[b]||!C?0:8},l={ms:1,focus:{alpha:1},cursor:{focus:{prox:30}},legend:{show:!1},padding:[o,o,o,o],series:[],hooks:{}};var g=(E=>(E[E.Pos=1]="Pos",E[E.Neg=-1]="Neg",E))(g||{});function f(E){let b=[],{series:D,dir:C}=E,P=D.length-1,M=D.slice().reverse();return M.forEach((O,j)=>{if(j!==P){let U=M[j+1];b.push({series:[O,U],dir:-1*C})}}),b}function p(E){let b=new Map;return E.fields.forEach(({config:D,values:C,type:P},M)=>{if(M===0)return;let{custom:O}=D;if(O==null||O.hideFrom?.viz)return;let{stacking:j}=O;if(j==null)return;let{mode:U,group:W}=j;if(U===s.gs.None)return;let B=O.transform,S=v(B,C),_=O.drawStyle,K=_===s.GR.Bars?O.barAlignment:_===s.GR.Line?O.lineInterpolation:null,T=`${S}|${U}|${W}|${(0,u.M)(D,P)}|${_}|${K}`,L=b.get(T);L==null&&(L={series:[],dir:S},b.set(T,L)),L.series.push(M)}),[...b.values()]}function c(E,b,D){let C=Array(E.fields.length),P=b.length,M=E.length,O=P>0?Array(M).fill(0):[],j=P>0?Array(M).fill(!1):[],U=Array.from({length:P},()=>O.slice()),W=Array.from({length:P},()=>j.slice());if(b.forEach((B,S)=>{let _=W[S];B.series.forEach(K=>{let T=E.fields[K];if(T.config.custom?.hideFrom?.viz)return;let L=T.values;for(let A=0;A<M;A++)L[A]!=null&&(_[A]=!0)})}),E.fields.forEach((B,S)=>{let _=B.values;if(S===0){C[S]=_;return}let{custom:K}=B.config;if(!K||K.hideFrom?.viz){C[S]=_;return}if(K.transform===s.NU.Constant){let L=_.findIndex(N=>N!=null),A=_[L];_=Array(_.length).fill(void 0),_[L]=A}else if(_=_.slice(),K.transform===s.NU.NegativeY)for(let L=0;L<_.length;L++)_[L]!=null&&(_[L]*=-1);let T=K.stacking?.mode;if(!T||T===s.gs.None)C[S]=_;else{let L=b.findIndex(z=>z.series.indexOf(S)>-1),A=U[L],N=W[L],V=C[S]=Array(M);for(let z=0;z<M;z++){let w=_[z];w!=null?V[z]=A[z]+=w:V[z]=N[z]?A[z]:w}}}),D){let B=C.map((S,_)=>{let K=b.findIndex(T=>T.series.indexOf(_)>-1);return K!==-1?U[K]:S});D({totals:B})}return E.fields.forEach((B,S)=>{if(S===0||B.config.custom?.hideFrom?.viz)return;if(B.config.custom?.stacking?.mode===s.gs.Percent){let K=b.findIndex(N=>N.series.indexOf(S)>-1),T=U[K],L=b[K],A=C[S];for(let N=0;N<M;N++){let V=A[N];V!=null&&(A[N]=T[N]===0?0:L.dir*(V/T[N]))}}}),C}function x(E,b){let D,C=1,P=1,M=E.data[1][b],O=E.data[1][b];for(let j=1;j<E.data.length;j++){const W=E.data[j][b];W!=null&&(M==null?M=W:W>M&&(M=E.data[j][b],C=j),O==null?O=W:W<O&&(O=E.data[j][b],P=j))}return O==null&&M==null?D=void 0:O!=null&&M!=null?D=(E.valToPos(O,E.series[P].scale)+E.valToPos(M,E.series[C].scale))/2:D=E.valToPos(O||M,E.series[C||P].scale),D!==void 0&&D<0&&(D=E.bbox.height/devicePixelRatio),D}function v(E,b){const D=m(b);return E===s.NU.NegativeY?D?1:-1:D?-1:1}function m(E,b=100){const D=E.length;if(D===0)return!1;let C=0,P=D-1;for(;C<=P&&E[C]==null;)C++;for(;P>=C&&E[P]==null;)P--;let M=0,O=0;if(P>=C){const j=Math.max(1,Math.floor((P-C+1)/b));for(let U=C;U<=P;U+=j){const W=E[U];W!=null&&typeof W=="number"&&(W<0||Object.is(W,-0)?M++:W>0&&O++)}if(M>O)return!0}return!1}const y=(E,b,D)=>{if(!E?.length)return[];const C=j=>j==null?"-":j.toFixed(1),P=b.display??C;let M=null;const O=(0,n.Nw)({field:b,reducers:E});return E.map(j=>{const U=n.AS.get(j);let W=P;return U.id===n.gy.diffperc&&(W=(0,a.J)({field:{...b,config:{...b.config,unit:"percent"}},theme:D})),(U.id===n.gy.count||U.id===n.gy.changeCount||U.id===n.gy.distinctCount)&&(M||(M=(0,a.J)({field:{...b,config:{...b.config,unit:"none"}},theme:D})),W=M),{...W(O[j]),title:U.name,description:U.description}})},h=(0,r.h)("uPlot"),d=h.logger;(0,i.h)("graphng",void 0,h)},44017:(te,R,e)=>{"use strict";e.d(R,{T4:()=>m,W1:()=>v,Wq:()=>y,rg:()=>c});var n=e(74848),a=e(95004),s=e(38809),i=e(92745),r=e(739),u=e(37386),o=e(77824),l=e(63527),g=e(41654),f=e(18857),p=e(99555);function c(h,d){y(h);const E=[(0,i.t)("grafana-ui.builder.axis.category-axis","Axis")];h.addTextInput({path:"axisLabel",name:(0,i.t)("grafana-ui.builder.axis.name-label","Label"),category:E,defaultValue:"",settings:{placeholder:(0,i.t)("grafana-ui.builder.axis.placeholder-label","Optional text"),expandTemplateVars:!0},showIf:b=>b.axisPlacement!==r.vM.Hidden,shouldApply:b=>b.type!==a.PU.time&&b.type!==a.PU.string}),m(h),h.addRadio({path:"axisGridShow",name:(0,i.t)("grafana-ui.builder.axis.name-grid-lines","Show grid lines"),category:E,defaultValue:void 0,settings:{options:[{value:void 0,label:(0,i.t)("grafana-ui.builder.axis.grid-line-options.label-auto","Auto")},{value:!0,label:(0,i.t)("grafana-ui.builder.axis.grid-line-options.label-on","On")},{value:!1,label:(0,i.t)("grafana-ui.builder.axis.grid-line-options.label-off","Off")}]},showIf:b=>b.axisPlacement!==r.vM.Hidden}).addRadio({path:"axisColorMode",name:(0,i.t)("grafana-ui.builder.axis.color-label","Color"),category:E,defaultValue:r.Y$.Text,settings:{options:[{value:r.Y$.Text,label:(0,i.t)("grafana-ui.builder.axis.color-options.label-text","Text")},{value:r.Y$.Series,label:(0,i.t)("grafana-ui.builder.axis.color-options.label-series","Series")}]},showIf:b=>b.axisPlacement!==r.vM.Hidden}).addBooleanSwitch({path:"axisBorderShow",name:(0,i.t)("grafana-ui.builder.axis.name-show-border","Show border"),category:E,defaultValue:!1,showIf:b=>b.axisPlacement!==r.vM.Hidden}),h.addCustomEditor({id:"scaleDistribution",path:"scaleDistribution",name:(0,i.t)("grafana-ui.builder.axis.name-scale","Scale"),category:E,editor:v,override:v,defaultValue:{type:r.L4.Linear},shouldApply:b=>b.type===a.PU.number,process:s.hS}).addBooleanSwitch({path:"axisCenteredZero",name:(0,i.t)("grafana-ui.builder.axis.name-centered-zero","Centered zero"),category:E,defaultValue:!1,showIf:b=>b.scaleDistribution?.type!==r.L4.Log}).addNumberInput({path:"axisSoftMin",name:(0,i.t)("grafana-ui.builder.axis.name-soft-min","Soft min"),defaultValue:d.axisSoftMin,category:E,settings:{placeholder:(0,i.t)("grafana-ui.builder.axis.placeholder-soft-min","See: Standard options > Min")}}).addNumberInput({path:"axisSoftMax",name:(0,i.t)("grafana-ui.builder.axis.name-soft-max","Soft max"),defaultValue:d.axisSoftMax,category:E,settings:{placeholder:(0,i.t)("grafana-ui.builder.axis.placeholder-soft-max","See: Standard options > Max")}})}const x=[{label:"2",value:2},{label:"10",value:10}],v=({value:h,onChange:d})=>{const E=h?.type??r.L4.Linear,b=h?.log??2,D=[{label:(0,i.t)("grafana-ui.builder.axis.scale-distribution-editor.distribution-options.label-linear","Linear"),value:r.L4.Linear},{label:(0,i.t)("grafana-ui.builder.axis.scale-distribution-editor.distribution-options.label-log","Logarithmic"),value:r.L4.Log},{label:(0,i.t)("grafana-ui.builder.axis.scale-distribution-editor.distribution-options.label-symlog","Symlog"),value:r.L4.Symlog}];return(0,n.jsxs)(g.B,{direction:"column",gap:2,children:[(0,n.jsx)(o.z,{value:E,options:D,onChange:C=>{d({...h,type:C,log:C===r.L4.Linear?void 0:b})}}),(E===r.L4.Log||E===r.L4.Symlog)&&(0,n.jsx)(u.D,{label:(0,i.t)("grafana-ui.axis-builder.log-base","Log base"),children:(0,n.jsx)(f.l6,{options:x,value:b,onChange:C=>{d({...h,log:C.value})}})}),E===r.L4.Symlog&&(0,n.jsx)(u.D,{label:(0,i.t)("grafana-ui.axis-builder.linear-threshold","Linear threshold"),style:{marginBottom:0},children:(0,n.jsx)(l.p,{placeholder:"1",value:h?.linearThreshold,onChange:C=>{d({...h,linearThreshold:Number(C.currentTarget.value)})}})})]})};function m(h){h.addNumberInput({path:"axisWidth",name:(0,i.t)("grafana-ui.builder.axis.name-width","Width"),category:[(0,i.t)("grafana-ui.builder.axis.category-axis","Axis")],settings:{placeholder:(0,i.t)("grafana-ui.builder.axis.placeholder-width","Auto")},showIf:d=>d.axisPlacement!==r.vM.Hidden})}function y(h,d=E=>!0){const E=(0,p.P)();h.addRadio({path:"axisPlacement",name:(0,i.t)("grafana-ui.builder.axis.name-placement","Placement"),category:[(0,i.t)("grafana-ui.builder.axis.category-axis","Axis")],defaultValue:E.axisPlacement[0].value,settings:{options:E.axisPlacement.filter(b=>d(b.value))}})}},45013:(te,R,e)=>{"use strict";e.d(R,{e:()=>l});var n=e(74848),a=e(2543),s=e.n(a),i=e(96540),r=e(34343),u=e(41654);const o=({value:g,onChange:f})=>{const p=(0,i.useCallback)(c=>{f({...g,[c]:!g[c]})},[g,f]);return(0,n.jsx)(u.B,{gap:.5,children:Object.keys(g).map(c=>{const x=c;return(0,n.jsx)(r.m,{icon:g[x]?"eye-slash":"eye",onClick:()=>p(x),label:(0,a.startCase)(x),selected:g[x]},x)})})};function l(g){g.addCustomEditor({id:"hideFrom",name:"Hide in area",category:["Series"],path:"hideFrom",defaultValue:{tooltip:!1,viz:!1,legend:!1},editor:o,override:o,shouldApply:()=>!0,hideFromDefaults:!0,process:f=>f})}},41069:(te,R,e)=>{"use strict";e.d(R,{H:()=>i});var n=e(53543),a=e(92745),s=e(739);function i(r,u=!0,o=!0){const l=[(0,a.t)("grafana-ui.builder.legend.category","Legend")];r.addBooleanSwitch({path:"legend.showLegend",name:(0,a.t)("grafana-ui.builder.legend.name-visibility","Visibility"),category:l,description:"",defaultValue:o}).addRadio({path:"legend.displayMode",name:(0,a.t)("grafana-ui.builder.legend.name-mode","Mode"),category:l,description:"",defaultValue:s.lm.List,settings:{options:[{value:s.lm.List,label:(0,a.t)("grafana-ui.builder.legend.mode-options.label-list","List")},{value:s.lm.Table,label:(0,a.t)("grafana-ui.builder.legend.mode-options.label-table","Table")}]},showIf:g=>g.legend.showLegend}).addRadio({path:"legend.placement",name:(0,a.t)("grafana-ui.builder.legend.name-placement","Placement"),category:l,description:"",defaultValue:"bottom",settings:{options:[{value:"bottom",label:(0,a.t)("grafana-ui.builder.legend.placement-options.label-bottom","Bottom")},{value:"right",label:(0,a.t)("grafana-ui.builder.legend.placement-options.label-right","Right")}]},showIf:g=>g.legend.showLegend}).addNumberInput({path:"legend.width",name:(0,a.t)("grafana-ui.builder.legend.name-width","Width"),category:l,settings:{placeholder:"Auto"},showIf:g=>g.legend.showLegend&&g.legend.placement==="right"}),u&&r.addCustomEditor({id:"legend.calcs",path:"legend.calcs",name:(0,a.t)("grafana-ui.builder.legend.name-values","Values"),category:l,description:(0,a.t)("grafana-ui.builder.legend.description-values","Select values or calculations to show in legend"),editor:n.D.get("stats-picker").editor,defaultValue:[],settings:{allowMultiple:!0},showIf:g=>g.legend.showLegend!==!1})}},81082:(te,R,e)=>{"use strict";e.d(R,{I:()=>c,m:()=>p});var n=e(74848),a=e(38809),s=e(95004),i=e(92745),r=e(739),u=e(77824),o=e(76319),l=e(63527),g=e(41654),f=e(99555);const p=({value:x,context:v,onChange:m,item:y})=>(0,n.jsxs)(g.B,{children:[(0,n.jsx)(u.z,{value:x?.mode||r.gs.None,options:y.settings?.options??[],onChange:h=>{m({...x,mode:h})}}),v.isOverride&&x?.mode&&x?.mode!==r.gs.None&&(0,n.jsx)(l.p,{type:"text",placeholder:(0,i.t)("grafana-ui.stacking-builder.group","Group"),suffix:(0,n.jsx)(o.K,{name:"question-circle",tooltip:(0,i.t)("grafana-ui.stacking-builder.group-tooltip","Name of the stacking group"),tooltipPlacement:"top"}),defaultValue:x?.group,onChange:h=>{m({...x,group:h.currentTarget.value.trim()})}})]});function c(x,v,m=["Graph styles"]){const y=(0,f.P)();x.addCustomEditor({id:"stacking",path:"stacking",name:(0,i.t)("grafana-ui.builder.stacking.name-stack-series","Stack series"),category:m,defaultValue:v,editor:p,override:p,settings:{options:y.stacking},process:a.hS,shouldApply:h=>h.type===s.PU.number})}},14099:(te,R,e)=>{"use strict";e.d(R,{I:()=>a});var n=e(92745);function a(s,i=!0){const r=[(0,n.t)("grafana-ui.builder.text.category-text-size","Text size")];i&&s.addNumberInput({path:"text.titleSize",category:r,name:(0,n.t)("grafana-ui.builder.text.name-title","Title"),settings:{placeholder:(0,n.t)("grafana-ui.builder.text.placeholder-title","Auto"),integer:!1,min:1,max:200},defaultValue:void 0}),s.addNumberInput({path:"text.valueSize",category:r,name:(0,n.t)("grafana-ui.builder.text.name-value","Value"),settings:{placeholder:(0,n.t)("grafana-ui.builder.text.placeholder-value","Auto"),integer:!1,min:1,max:200},defaultValue:void 0}),s.addNumberInput({path:"text.percentSize",category:r,name:(0,n.t)("grafana-ui.builder.text.name-percent-change","Percent change"),settings:{placeholder:(0,n.t)("grafana-ui.builder.text.placeholder-percent-change","Auto"),integer:!1,min:1,max:200},defaultValue:void 0})}},79277:(te,R,e)=>{"use strict";e.d(R,{D:()=>i,U:()=>s});var n=e(92745),a=e(739);const s={tooltip:{mode:a.$N.Single,sort:a.xB.None,hideZeros:!1}};function i(r,u=!1,o=!1,l){const g=[(0,n.t)("grafana-ui.builder.tooltip.category","Tooltip")],f=u?[{value:a.$N.Single,label:(0,n.t)("grafana-ui.builder.tooltip.modeOptions.label-single","Single")},{value:a.$N.None,label:(0,n.t)("grafana-ui.builder.tooltip.modeOptions.label-hidden","Hidden")}]:[{value:a.$N.Single,label:(0,n.t)("grafana-ui.builder.tooltip.modeOptions.label-single","Single")},{value:a.$N.Multi,label:(0,n.t)("grafana-ui.builder.tooltip.modeOptions.label-all","All")},{value:a.$N.None,label:(0,n.t)("grafana-ui.builder.tooltip.modeOptions.label-hidden","Hidden")}],p=[{value:a.xB.None,label:(0,n.t)("grafana-ui.builder.tooltip.sortOptions.label-none","None")},{value:a.xB.Ascending,label:(0,n.t)("grafana-ui.builder.tooltip.sortOptions.label-ascending","Ascending")},{value:a.xB.Descending,label:(0,n.t)("grafana-ui.builder.tooltip.sortOptions.label-descending","Descending")}];r.addRadio({path:"tooltip.mode",name:(0,n.t)("grafana-ui.builder.tooltip.name-tooltip-mode","Tooltip mode"),category:g,defaultValue:l?.tooltip?.mode??a.$N.Single,settings:{options:f}}).addRadio({path:"tooltip.sort",name:(0,n.t)("grafana-ui.builder.tooltip.name-values-sort-order","Values sort order"),category:g,defaultValue:l?.tooltip?.sort??a.xB.None,showIf:c=>c.tooltip?.mode===a.$N.Multi,settings:{options:p}}).addBooleanSwitch({path:"tooltip.hideZeros",name:(0,n.t)("grafana-ui.builder.tooltip.name-hide-zeros","Hide zeros"),category:g,defaultValue:!1,showIf:c=>l?.tooltip?.hideZeros!==void 0&&c.tooltip?.mode===a.$N.Multi}),o&&r.addNumberInput({path:"tooltip.hoverProximity",name:(0,n.t)("grafana-ui.builder.tooltip.name-hover-proximity","Hover proximity"),description:(0,n.t)("grafana-ui.builder.tooltip.description-hover-proximity","How close the cursor must be to a point to trigger the tooltip, in pixels"),category:g,settings:{integer:!0},showIf:c=>c.tooltip?.mode!==a.$N.None}),r.addNumberInput({path:"tooltip.maxWidth",name:(0,n.t)("grafana-ui.builder.tooltip.name-max-width","Max width"),category:g,settings:{integer:!0},showIf:c=>c.tooltip?.mode!==a.$N.None}).addNumberInput({path:"tooltip.maxHeight",name:(0,n.t)("grafana-ui.builder.tooltip.name-max-height","Max height"),category:g,defaultValue:void 0,settings:{integer:!0},showIf:(c,x,v)=>c.tooltip?.mode===a.$N.Multi||v?.some(m=>m.meta?.custom?.resultType==="exemplar")})}},16123:(te,R,e)=>{"use strict";e.d(R,{v:()=>n});function n(){return{onKeyDown(a,s,i){const r=s.value;if(r.selection.isExpanded)return i();if(a.key==="k"&&a.ctrlKey){a.preventDefault();const u=r.anchorText.text,o=r.selection.anchor.offset,g=u.length-o;return s.deleteForward(g),!0}return i()}}}},54024:(te,R,e)=>{"use strict";e.d(R,{s:()=>s});const n=(i,r,u)=>{if(!i.length)return;const o=i.slice(0,-1).join("").length+i.length-1;return i.join(`
`).slice(r,o+u)},a=i=>i?.replace(/[\uFEFF]/g,"");function s(){const i={onCopy(r,u,o){r.preventDefault();const{document:l,selection:g}=u.value,{start:{offset:f},end:{offset:p}}=g,c=l.getLeafBlocksAtRange(g).toArray().map(v=>v.text),x=a(n(c,f,p));return x&&r.clipboardData&&r.clipboardData.setData("Text",x),!0},onPaste(r,u,o){if(r.preventDefault(),r.clipboardData){const g=a(r.clipboardData.getData("Text"))?.split(`
`);if(g&&g.length){u.insertText(g[0]);for(const f of g.slice(1))u.splitBlock().insertText(f)}}return!0}};return{...i,onCut(r,u,o){return i.onCopy(r,u,o),u.deleteAtRange(u.value.selection),!0}}}},52513:(te,R,e)=>{"use strict";e.d(R,{T:()=>f});var n=e(57746),a=e(82611),s=e(52845);const i=(0,n.Sn)("mod+["),r=(0,n.Sn)("shift+tab"),u=(0,n.Sn)("mod+]"),o="  ",l=(p,c,x)=>{const{startBlock:v,endBlock:m,selection:{start:{offset:y,key:h},end:{offset:d,key:E}}}=c.value;if(s.default.serialize(c.value)==="")return;p.preventDefault();const b=v.getFirstText();b&&y===0&&h===b.key&&d===b.text.length&&E===b.key||!v.equals(m)?g(c,"right"):c.insertText(o)},g=(p,c)=>{const x=p.value.selection,v=p.value.document.getLeafBlocksAtRange(x).toArray();if(c==="left")for(const m of v){const y=m.text.length-m.text.trimLeft().length,h=m.getFirstText().key,d={anchor:{key:h,offset:y,path:[]},focus:{key:h,offset:y,path:[]}};p.deleteBackwardAtRange(a.Range.create(d),Math.min(o.length,y))}else{const{startText:m}=p.value,y=m.text.slice(0,x.start.offset),h=/^\s*$/.test(y);for(const d of v)p.insertTextByKey(d.getFirstText().key,0,o);h&&p.moveStartBackward(o.length)}};function f(){return{onKeyDown(p,c,x){if(i(p)||r(p))p.preventDefault(),g(c,"left");else if(u(p))p.preventDefault(),g(c,"right");else if(p.key==="Tab")l(p,c,x);else return x();return!0}}}},21266:(te,R,e)=>{"use strict";e.d(R,{O:()=>a});function n(s){let i=s.length-s.trimLeft().length;if(i){let r=s[0];for(;--i;)r+=s[0];return r}return""}function a(){return{onKeyDown(s,i,r){const u=i.value;if(u.selection.isExpanded)return r();if(s.key==="Enter"){s.preventDefault();const{startBlock:o}=u,l=o.text,g=n(l);return i.splitBlock().insertText(g).focus()}return r()}}}},59490:(te,R,e)=>{"use strict";e.d(R,{U:()=>n});function n({handler:a}){return{onKeyDown(s,i,r){return a&&s.key==="Enter"&&(s.shiftKey||s.ctrlKey)?(s.preventDefault(),a(s),i):r()}}}},91272:(te,R,e)=>{"use strict";e.d(R,{l:()=>s});var n=e(57746);const a=(0,n.Sn)("mod+l");function s(){return{onKeyDown(i,r,u){if(a(i)){i.preventDefault();const{focusBlock:o,document:l}=r.value;r.moveAnchorToStartOfBlock(),l.getNextBlock(o.key)?r.moveFocusToStartOfNextBlock():r.moveFocusToEndOfText()}else return u();return!0}}}},65937:(te,R,e)=>{"use strict";e.d(R,{A:()=>a});const a="prism-token"},56103:(te,R,e)=>{"use strict";e.d(R,{D:()=>c,R:()=>y});var n=e(28848),a=e.n(n),s=e(82611),i=e(65937),r=e(74848),u=e(49568);function o(h){return h.object==="block"&&h.type==="code_block"}function l(h){return"javascript"}function g(h,d,E){const{decoration:b}=h;if(b.type!==i.A)return E();const D=b.data.get("className");return(0,r.jsx)("span",{className:D,children:h.children})}class f extends(0,u.Record)({onlyIn:o,getSyntax:l,renderDecoration:g}){constructor(d){super(d)}}const p=f;function c(h={},d=a().languages){const E=new p(h);return{decorateNode:(b,D,C)=>{if(!E.onlyIn(b))return C();const P=s.Block.create(b),M=E.getSyntax(P),O=d[M];if(!O)return[];const U=P.getTexts().map(_=>_&&_.getText()).join(`
`),W=a().tokenize(U,O),B=y(W),S=D.value.data.set("tokens",B);return D.setData(S),x(E,W,P)},renderDecoration:(b,D,C)=>E.renderDecoration({children:b.children,decoration:b.decoration},D,C)}}function x(h,d,E){const b=E.getTexts(),D=[];let C=0,P=0;return b.forEach(M=>{P=C+M.getText().length;let O=0;function j(U,W){if(typeof U=="string"){if(W){const B=v({text:M,textStart:C,textEnd:P,start:O,end:O+U.length,className:`prism-token token ${W}`,block:E});B&&D.push(B)}O+=U.length}else if(W=`${W} ${U.type}`,U.alias&&(W+=" "+U.alias),typeof U.content=="string"){const B=v({text:M,textStart:C,textEnd:P,start:O,end:O+U.content.length,className:`prism-token token ${W}`,block:E});B&&D.push(B),O+=U.content.length}else for(let B=0;B<U.content.length;B+=1)j(U.content[B],W)}d.forEach(j),C=P+1}),D}function v({text:h,textStart:d,textEnd:E,start:b,end:D,className:C,block:P}){return b>=E||D<=d?null:(b=Math.max(b,d),D=Math.min(D,E),b-=d,D-=d,P.createDecoration({object:"decoration",anchor:{key:h.key,offset:b,object:"point"},focus:{key:h.key,offset:D,object:"point"},type:i.A,data:{className:C}}))}function m(h){return typeof h=="string"?[{content:h,types:[],aliases:[]}]:Array.isArray(h)?h.flatMap(d=>m(d)):h instanceof a().Token?m(h.content).flatMap(d=>{let E=[];return typeof h.alias=="string"?E=[h.alias]:E=h.alias??[],{content:d.content,types:[h.type,...d.types],aliases:[...E,...d.aliases]}}):[]}function y(h){const d=m(h);if(!d.length)return[];const E=d[0];E.prev=null,E.next=d.length>=2?d[1]:null,E.offsets={start:0,end:E.content.length};for(let D=1;D<d.length-1;D++)d[D].prev=d[D-1],d[D].next=d[D+1],d[D].offsets={start:d[D-1].offsets.end,end:d[D-1].offsets.end+d[D].content.length};const b=d[d.length-1];return b.prev=d.length>=2?d[d.length-2]:null,b.next=null,b.offsets={start:d.length>=2?d[d.length-2].offsets.end:0,end:d.length>=2?d[d.length-2].offsets.end+b.content.length:b.content.length},d}},93427:(te,R,e)=>{"use strict";e.d(R,{Pz:()=>T});var n=e(74848),a=e(2543),s=e(22803),i=e(96540),r=e(40961),u=e(97222),o=e(35555),l=e(53926),g=e(49579);const f=N=>N.reduce((V,{items:z,label:w})=>(V.push({label:w,kind:l.I.GroupTitle}),z.reduce((H,Q)=>(H.push(Q),H),V)),[]),p=N=>N.reduce((V,z)=>V.length<z.label.length?z.label:V,""),c=(N,V,z)=>{const w=(0,g.A)(z,{font:N.typography.fontFamilyMonospace,fontSize:N.typography.bodySmall.fontSize,fontWeight:"normal"}),H=v(w.width,N),Q=x(w.height,N),Z=m(Q,V);return{listWidth:H,listHeight:Z,itemHeight:Q}},x=(N,V)=>{const z=V.spacing.gridSize*2;return N+z},v=(N,V)=>{const z=V.spacing.gridSize*3;return Math.min(Math.max(N+z,200),800)},m=(N,V)=>{const z=Math.min(V.length,10),w=100,H=z*N;return Math.max(H,w)};var y=e(67458),h=e(63142);const d=(N,V,z)=>({typeaheadItem:(0,s.css)({label:"type-ahead-item",zIndex:11,padding:N.spacing(1,1,1,2),border:N.colors.border.medium,overflowY:"scroll",overflowX:"hidden",outline:"none",background:N.colors.background.secondary,color:N.colors.text.secondary,boxShadow:`0 0 20px ${N.v1.colors.dropdownShadow}`,visibility:z===!0?"visible":"hidden",width:"250px",minHeight:`${V+parseInt(N.spacing(.25),10)}px`,position:"relative",wordBreak:"break-word"})}),E=({item:N,height:V})=>{const z=N&&!!N.documentation,w=N?N.label:"",H=(0,y.G)(N?.documentation),Q=(0,h.$j)(),Z=d(Q,V,z);return(0,n.jsxs)("div",{className:(0,s.cx)([Z.typeaheadItem]),children:[(0,n.jsx)("b",{children:w}),(0,n.jsx)("hr",{}),(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:H}})]})};var b=e(23257),D=e.n(b),C=e(20662);const P=N=>({typeaheadItem:(0,s.css)({border:"none",background:"none",textAlign:"left",label:"type-ahead-item",height:"auto",fontFamily:N.typography.fontFamilyMonospace,padding:N.spacing(1,1,1,2),fontSize:N.typography.bodySmall.fontSize,textOverflow:"ellipsis",overflow:"hidden",zIndex:11,display:"block",whiteSpace:"nowrap",cursor:"pointer",[N.transitions.handleMotion("no-preference","reduce")]:{transition:"color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), border-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), background 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), padding 0.15s cubic-bezier(0.645, 0.045, 0.355, 1)"}}),typeaheadItemSelected:(0,s.css)({label:"type-ahead-item-selected",backgroundColor:N.colors.background.secondary}),typeaheadItemMatch:(0,s.css)({label:"type-ahead-item-match",color:N.v1.palette.yellow,borderBottom:`1px solid ${N.v1.palette.yellow}`,padding:"inherit",background:"inherit"}),typeaheadItemGroupTitle:(0,s.css)({label:"type-ahead-item-group-title",color:N.colors.text.secondary,fontSize:N.typography.bodySmall.fontSize,lineHeight:N.typography.body.lineHeight,padding:N.spacing(1)})}),M=N=>{const V=(0,h.of)(P),{isSelected:z,item:w,prefix:H,style:Q,onMouseEnter:Z,onMouseLeave:Y,onClickItem:X}=N,I=z?(0,s.cx)([V.typeaheadItem,V.typeaheadItemSelected]):(0,s.cx)([V.typeaheadItem]),J=(0,s.cx)([V.typeaheadItemMatch]),ee=(0,s.cx)([V.typeaheadItemGroupTitle]),q=w.label||"";return w.kind===l.I.GroupTitle?(0,n.jsx)("li",{className:ee,style:Q,children:(0,n.jsx)("span",{children:q})}):(0,n.jsx)("li",{role:"none",children:(0,n.jsx)("button",{role:"menuitem",className:I,style:Q,onMouseDown:X,onMouseEnter:Z,onMouseLeave:Y,type:"button",children:w.highlightParts!==void 0?(0,n.jsx)(C.z,{text:q,highlightClassName:J,highlightParts:w.highlightParts}):(0,n.jsx)(D(),{textToHighlight:q,searchWords:[H??""],autoEscape:!0,highlightClassName:J})})})},O=(N,V)=>N-V*Math.floor(N/V);class j extends i.PureComponent{constructor(){super(...arguments),this.listRef=(0,i.createRef)(),this.state={hoveredItem:null,typeaheadIndex:null,allItems:[],listWidth:-1,listHeight:-1,itemHeight:-1},this.componentDidMount=()=>{this.props.menuRef&&this.props.menuRef(this),document.addEventListener("selectionchange",this.handleSelectionChange);const V=f(this.props.groupedItems),z=p(V),{listWidth:w,listHeight:H,itemHeight:Q}=c(this.context,V,z);this.setState({listWidth:w,listHeight:H,itemHeight:Q,allItems:V})},this.componentWillUnmount=()=>{document.removeEventListener("selectionchange",this.handleSelectionChange)},this.handleSelectionChange=()=>{this.forceUpdate()},this.componentDidUpdate=(V,z)=>{if(this.state.typeaheadIndex!==null&&z.typeaheadIndex!==this.state.typeaheadIndex&&this.listRef&&this.listRef.current){if(this.state.typeaheadIndex===1){this.listRef.current.scrollToItem(0);return}this.listRef.current.scrollToItem(this.state.typeaheadIndex)}if((0,a.isEqual)(V.groupedItems,this.props.groupedItems)===!1){const w=f(this.props.groupedItems),H=p(w),{listWidth:Q,listHeight:Z,itemHeight:Y}=c(this.context,w,H);this.setState({listWidth:Q,listHeight:Z,itemHeight:Y,allItems:w,typeaheadIndex:null})}},this.onMouseEnter=V=>{this.setState({hoveredItem:V})},this.onMouseLeave=()=>{this.setState({hoveredItem:null})},this.moveMenuIndex=V=>{const z=this.state.allItems.length;if(z){const w=this.state.typeaheadIndex||0;let H=O(w+V,z);this.state.allItems[H].kind===l.I.GroupTitle&&(H=O(H+V,z)),this.setState({typeaheadIndex:H});return}},this.insertSuggestion=()=>{this.props.onSelectSuggestion&&this.state.typeaheadIndex!==null&&this.props.onSelectSuggestion(this.state.allItems[this.state.typeaheadIndex])}}static{this.contextType=o.D}get menuPosition(){if(!window.getSelection)return"";const V=window.getSelection(),z=V&&V.anchorNode;if(z&&z.parentElement){const w=z.parentElement.getBoundingClientRect(),H=window.scrollX,Q=window.scrollY;return`position: absolute; display: flex; top: ${w.top+Q+w.height+6}px; left: ${w.left+H-2}px`}return""}render(){const{prefix:V,isOpen:z=!1,origin:w}=this.props,{allItems:H,listWidth:Q,listHeight:Z,itemHeight:Y,hoveredItem:X,typeaheadIndex:I}=this.state,J=W(this.context),ee=X||I,q=H[X||I||0];return(0,n.jsxs)(U,{origin:w,isOpen:z,style:this.menuPosition,children:[(0,n.jsx)("ul",{role:"menu",className:J.typeahead,"data-testid":"typeahead",children:(0,n.jsx)(u.Y1,{ref:this.listRef,itemCount:H.length,itemSize:Y,itemKey:ne=>{const se=H&&H[ne];return se?`${ne}-${se.label}`:`${ne}`},width:Q,height:Z,children:({index:ne,style:se})=>{const oe=H&&H[ne];return oe?(0,n.jsx)(M,{onClickItem:()=>this.props.onSelectSuggestion?this.props.onSelectSuggestion(oe):{},isSelected:I===null?!1:H[I]===oe,item:oe,prefix:V,style:se,onMouseEnter:()=>this.onMouseEnter(ne),onMouseLeave:this.onMouseLeave}):null}})}),ee&&(0,n.jsx)(E,{height:Z,item:q})]})}}class U extends i.PureComponent{constructor(V){super(V);const{index:z=0,origin:w="query",style:H}=V;this.node=document.createElement("div"),this.node.setAttribute("style",H),this.node.classList.add(`slate-typeahead-${w}-${z}`),document.body.appendChild(this.node)}componentWillUnmount(){document.body.removeChild(this.node)}render(){return this.props.isOpen?(this.node.setAttribute("style",this.props.style),this.node.classList.add("slate-typeahead--open"),r.createPortal(this.props.children,this.node)):(this.node.classList.remove("slate-typeahead--open"),null)}}const W=N=>({typeahead:(0,s.css)({position:"relative",zIndex:N.zIndex.typeahead,borderRadius:N.shape.radius.default,border:`1px solid ${N.components.panel.borderColor}`,maxHeight:"66vh",overflowY:"scroll",overflowX:"hidden",outline:"none",listStyle:"none",background:N.components.panel.background,color:N.colors.text.primary,boxShadow:N.shadows.z2,strong:{color:N.v1.palette.yellow}})});var B=e(59258),S=e(35458),_=e(65937);const K=250;function T({onTypeahead:N,cleanText:V,onWillApplySuggestion:z,portalOrigin:w}){let H,Q={groupedItems:[],typeaheadPrefix:"",typeaheadContext:"",typeaheadText:""};const Z=(0,a.debounce)(L,K),Y=X=>{Q={...Q,...X}};return{onBlur:(X,I,J)=>(Q={...Q,groupedItems:[]},J()),onClick:(X,I,J)=>(Q={...Q,groupedItems:[]},J()),onKeyDown:(X,I,J)=>{const q=Q.groupedItems.length;switch(X.key){case"Escape":{if(q)return X.preventDefault(),Q={...Q,groupedItems:[]},I.insertText("");break}case"ArrowDown":case"ArrowUp":if(q){X.preventDefault(),H.moveMenuIndex(X.key==="ArrowDown"?1:-1);return}break;case"Enter":{if(!(X.shiftKey||X.ctrlKey)&&q)return X.preventDefault(),H.insertSuggestion();break}case"Tab":{if(q)return X.preventDefault(),H.insertSuggestion();break}default:{X.key.length===1&&Z(I,Y,N,V);break}}return J()},commands:{selectSuggestion:(X,I)=>{const J=Q.groupedItems;if(!J||!J.length)return X;const ee=X.applyTypeahead(I);return Z(X,Y,N,V),ee},applyTypeahead:(X,I)=>{let J=I.insertText||I.label;const ee=I.kind==="function",q=I.move||0,ne=q>0?q:0,se=q<0?-q:0,{typeaheadPrefix:oe,typeaheadText:de,typeaheadContext:fe}=Q;z&&(J=z(J,{groupedItems:Q.groupedItems,typeaheadContext:fe,typeaheadPrefix:oe,typeaheadText:de}));const{forward:ae,backward:ce}=A(J,oe,de,ee,I.deleteBackwards,V);if(J.match(/\n/)){const ie=(0,S.dF)(J);return X.deleteBackward(ce).deleteForward(ae).insertFragment(ie).focus(),X}return Q={...Q,groupedItems:[]},X.snapshotSelection().deleteBackward(ce).deleteForward(ae).insertText(J).moveForward(ne).moveBackward(se).focus(),X}},renderEditor(X,I,J){if(I.value.selection.isExpanded)return J();const ee=J();return(0,n.jsxs)(n.Fragment,{children:[ee,(0,n.jsx)(j,{menuRef:q=>H=q,origin:w,prefix:Q.typeaheadPrefix,isOpen:!!Q.groupedItems.length,groupedItems:Q.groupedItems,onSelectSuggestion:I.selectSuggestion})]})}}}const L=async(N,V,z,w)=>{if(!z)return;const{value:H}=N,{selection:Q}=H,Z=H.document.getClosestBlock(H.focusBlock.key),Y=H.selection.start.offset-1,X=Z&&Z.getDecorations(N),I=X?X.filter(ce=>ce.start.offset<=Y&&ce.end.offset>Y&&ce.type===_.A).toArray():[],J=X&&X.filter(ce=>ce.end.offset<=Y&&ce.type===_.A&&ce.data.get("className").includes("label-key")).last(),ee=J&&H.focusText.text.slice(J.start.offset,J.end.offset),q=I.map(ce=>ce.data.get("className")).join(" ").split(" ").filter(ce=>ce.length);let ne=H.focusText.text,se=ne.slice(0,Q.focus.offset);I.length&&(ne=H.focusText.text.slice(I[0].start.offset,I[0].end.offset),se=H.focusText.text.slice(I[0].start.offset,Q.focus.offset));const oe=se.match(/(?:!?=~?"?|")(.*)/);oe?se=oe[1]:w&&(se=w(se));const{suggestions:de,context:fe}=await z({prefix:se,text:ne,value:H,wrapperClasses:q,labelKey:ee||void 0,editor:N}),ae=de.map(ce=>{if(!ce.items)return ce;const ie=ce.searchFunctionType||(ce.prefixMatch?B.T.Prefix:B.T.Word),ve=B.H[ie];let le={...ce};return se&&(ce.skipFilter||(le.items=le.items.filter(Ee=>(Ee.filterText||Ee.label).length>=se.length),le.items=ve(le.items,se)),le.items=le.items.filter(Ee=>!(Ee.insertText===se||(Ee.filterText??Ee.label)===se))),ce.skipSort||(le.items=(0,a.sortBy)(le.items,Ee=>Ee.sortText===void 0?Ee.sortValue!==void 0?Ee.sortValue:Ee.label:Ee.sortText||Ee.label)),le}).filter(ce=>ce.items&&ce.items.length);V({groupedItems:ae,typeaheadPrefix:se,typeaheadContext:fe,typeaheadText:ne}),N.blur().focus()};function A(N,V,z,w,H,Q){const Z=H||V.length,Y=Q?Q(z):z,X=z.indexOf(V),I=X>-1?Y.length-X-V.length:Y.length-V.length;return{forward:!!(V&&I>0||N===z)&&!w?I+X:0,backward:Z}}},77345:(te,R,e)=>{"use strict";e.d(R,{k:()=>K});var n=e(74848),a=e(17437),s=e(63142);function i(T){return(0,a.css)({".sr-only":{position:"absolute",width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",border:0}})}function r(T){return(0,a.css)({".alert-state-paused, .alert-state-pending":{color:T.colors.text.secondary,fontWeight:T.typography.fontWeightMedium},".alert-state-ok":{color:T.colors.success.text,fontWeight:T.typography.fontWeightMedium},".alert-state-warning":{color:T.colors.warning.text,fontWeight:T.typography.fontWeightMedium},".alert-state-critical":{color:T.colors.error.text,fontWeight:T.typography.fontWeightMedium}})}function u(T){return(0,a.css)({".card-section":{marginBottom:T.spacing(4)},".card-list":{display:"flex",flexDirection:"row",flexWrap:"wrap",listStyleType:"none"},".card-item":{display:"block",height:"100%",background:T.colors.background.secondary,boxShadow:"none",padding:T.spacing(2),borderRadius:T.shape.radius.default,"&:hover":{background:T.colors.emphasize(T.colors.background.secondary,.03)},".label-tag":{marginLeft:T.spacing(1),fontSize:"11px",padding:"2px 6px"}},".card-item-body":{display:"flex",overflow:"hidden"},".card-item-details":{overflow:"hidden"},".card-item-header":{marginBottom:T.spacing(2)},".card-item-type":{color:T.colors.text.secondary,textTransform:"uppercase",fontSize:T.typography.size.sm,fontWeight:T.typography.fontWeightMedium},".card-item-badge":{margin:"6px 0"},".card-item-notice":{fontSize:T.typography.size.sm},".card-item-name":{color:T.colors.text.primary,overflow:"hidden",textOverflow:"ellipsis",width:"100%"},".card-item-label":{marginLeft:T.spacing(1)},".card-item-sub-name":{color:T.colors.text.secondary,overflow:"hidden",textOverflow:"ellipsis",width:"100%"},".card-item-sub-name--header":{color:T.colors.text.secondary,textTransform:"uppercase",marginBottom:T.spacing(2),fontSize:T.typography.size.sm,fontWeight:"bold"},".card-list-layout-grid":{".card-item-type":{display:"inline-block"},".card-item-notice":{fontSize:T.typography.size.sm,display:"inline-block",marginLeft:T.spacing(2)},".card-item-header-action":{float:"right"},".card-item-wrapper":{width:"100%",padding:T.spacing(0,2,2,0)},".card-item-wrapper--clickable":{cursor:"pointer"},".card-item-figure":{margin:T.spacing(0,2,2,0),height:"80px",img:{width:"80px"}},".card-item-name":{fontSize:T.typography.h3.fontSize},[T.breakpoints.up("md")]:{".card-item-wrapper":{width:"50%"}},[T.breakpoints.up("lg")]:{".card-item-wrapper":{width:"33.333333%"}},"&.card-list-layout-grid--max-2-col":{[T.breakpoints.up("lg")]:{".card-item-wrapper":{width:"50%"}}}},".card-list-layout-list":{".card-item-wrapper":{padding:0,width:"100%",marginBottom:T.spacing(1)},".card-item-wrapper--clickable":{cursor:"pointer"},".card-item":{borderRadius:T.shape.radius.default},".card-item-header":{float:"right",textAlign:"right"},".card-item-figure":{margin:T.spacing(0,2,0,0),img:{width:"48px"}},".card-item-name":{fontSize:T.typography.h4.fontSize},".card-item-sub-name":{fontSize:T.typography.size.sm},".layout-selector":{marginRight:0}}})}function o(T){return(0,a.css)({"code, pre, kbd, samp":{...T.typography.code,fontSize:T.typography.bodySmall.fontSize,backgroundColor:T.colors.background.primary,color:T.colors.text.primary,border:`1px solid ${T.colors.border.medium}`,borderRadius:T.shape.radius.default},code:{whiteSpace:"nowrap",padding:"2px 5px",margin:"0 2px"},pre:{display:"block",margin:T.spacing(0,0,2),lineHeight:T.typography.body.lineHeight,wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre-wrap",overflow:"auto",padding:"10px",code:{padding:0,color:"inherit",whiteSpace:"pre-wrap",backgroundColor:"transparent",border:0}}})}function l(T){return(0,a.css)({".react-resizable-handle":{visibility:"hidden"},".react-grid-item, #grafana-portal-container":{touchAction:"initial !important","&:hover":{".react-resizable-handle":{visibility:"visible"}}},".dragging-active":{"*":{cursor:"move",userSelect:"none"}},[T.breakpoints.down("md")]:{".react-grid-layout":{height:"unset !important"},".react-grid-item":{display:"block !important",transitionProperty:"none !important",position:"unset !important",transform:"translate(0px, 0px) !important",marginBottom:T.spacing(2)},".panel-repeater-grid-item":{height:"auto !important"}},".react-grid-item.react-grid-placeholder":{boxShadow:`0 0 4px ${T.colors.primary.border} !important`,background:`${T.colors.primary.transparent} !important`,zIndex:"-1 !important",opacity:"unset !important"},".react-grid-item > .react-resizable-handle::after":{borderRight:`2px solid ${T.isDark?T.v1.palette.gray1:T.v1.palette.gray3} !important`,borderBottom:`2px solid ${T.isDark?T.v1.palette.gray1:T.v1.palette.gray3} !important`},".react-grid-item.resizing.panel, .react-grid-item.panel.dropdown-menu-open, .react-grid-item.react-draggable-dragging.panel":{zIndex:T.zIndex.dropdown},".react-grid-item.cssTransforms":{transitionProperty:"none !important"},[T.transitions.handleMotion("no-preference")]:{".react-grid-layout--enable-move-animations":{".react-grid-item.cssTransforms":{transitionProperty:"transform !important"}}},".dashboard-selected-element":{outline:`1px dashed ${T.colors.primary.border}`,outlineOffset:"0px",borderRadius:T.shape.radius.default},".dashboard-selectable-element":{"&:hover":{outline:`1px dashed ${T.colors.border.strong}`,outlineOffset:"0px",borderRadius:T.shape.radius.default,backgroundColor:T.colors.emphasize(T.colors.background.canvas,.08)}},".dashboard-canvas-add-button":{display:"flex",opacity:.5,transition:T.transitions.create("opacity"),filter:"grayscale(100%)","&:hover,:focus-within":{opacity:1,filter:"unset"}},".dashboard-visible-hidden-element":{position:"relative"},".dashboard-drop-target":{"&:is(:hover),&:not(:hover)":{outline:`2px solid ${T.colors.primary.border}`,outlineOffset:"0px",borderRadius:T.shape.radius.default}},".dashboard-draggable-transparent-selection":{"*::selection":{all:"inherit"}},".react-draggable-dragging":{opacity:.8}})}function g(T){return(0,a.css)({".delta-html":{background:T.colors.background.secondary,paddingTop:"5px",paddingBottom:"5px",userSelect:"none"},".diff-line":{color:T.colors.text.primary,fontFamily:T.typography.fontFamilyMonospace,fontSize:T.typography.size.sm,lineHeight:2,marginBottom:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",position:"relative","&:after":{left:"-40px"}},".diff-line-number":{color:T.colors.text.secondary,display:"inline-block",fontSize:T.typography.size.xs,lineHeight:2.3,textAlign:"right",width:"30px"},".diff-line-number-hide":{visibility:"hidden"},".diff-line-icon":{color:T.colors.text.primary,fontSize:T.typography.size.xs,float:"right",position:"relative",top:"2px",right:"10px"},".diff-json-new, .diff-json-old, .diff-json-deleted, .diff-json-added":{color:T.v1.palette.gray5,".diff-line-number":{color:T.colors.text.primary}},".diff-json-new":{backgroundColor:T.isDark?"#457740":"#664e33"},".diff-json-old":{backgroundColor:T.isDark?"#a04338":"#5a372a"},".diff-json-added":{backgroundColor:T.colors.primary.shade},".diff-json-deleted":{backgroundColor:T.colors.error.shade},".diff-value":{userSelect:"all"},".diff-circle":{marginRight:"0.5em","*":{marginBottom:"1px"}},".diff-circle-changed":{color:"#f59433"},".diff-circle-added":{color:"#29d761"},".diff-circle-deleted":{color:"#fd474a"},".diff-item-added, .diff-item-deleted":{listStyle:"none"},".diff-group":{background:T.colors.background.secondary,fontSize:"16px",fontStyle:"normal",padding:"10px 15px",margin:T.spacing(2,0),".diff-group":{padding:"0 5px"}},".diff-group-name":{display:"inline-block",width:"100%",fontSize:"16px",paddingLeft:"1.75em",margin:"0 0 14px 0"},".diff-summary-key":{paddingLeft:"0.25em"},".diff-list":{paddingLeft:"40px",".diff-list":{paddingLeft:0}},".diff-item":{color:T.v1.palette.gray2,lineHeight:2.5,"> div":{display:"inline"}},".diff-item-changeset":{listStyle:"none"},".diff-label":{backgroundColor:T.colors.action.hover,borderRadius:T.shape.radius.default,color:T.colors.text.primary,display:"inline",fontSize:`${T.typography.fontSize}px`,margin:"0 5px",padding:"3px 8px"},".diff-linenum":{float:"right"},".diff-arrow":{color:T.colors.text.primary},".diff-block":{width:"100%",display:"inline-block"},".diff-block-title":{fontSize:"16px",display:"inline-block"},".diff-title":{fontSize:"16px"},".diff-change-container":{margin:"0 0",paddingLeft:"3em",paddingRight:0},".diff-change-group":{width:"100%",color:T.colors.text.primary,marginBottom:"14px"},".diff-change-item":{display:"inline-block"},".diff-change-title":{fontSize:"16px"},".bullet-position-container":{position:"relative",left:"-6px"},".diff-list-circle":{marginBottom:"3px"}})}var f=e(27629),p=e(35484);function c(T,L){const A=L?{}:{overflowY:"auto !important"};return(0,a.css)({"*, *::before, *::after":{boxSizing:"inherit"},"[tabindex='-1']:focus":{outline:"none !important"},html:{MsOverflowStyle:"scrollbar",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)",boxSizing:"border-box",height:"100%",fontSize:`${T.typography.htmlFontSize}px`,fontFamily:T.typography.fontFamily,lineHeight:T.typography.body.lineHeight,fontKerning:"normal"},":root":{colorScheme:T.colors.mode},body:{height:"100%",width:"100%",position:"unset",color:T.colors.text.primary,backgroundColor:T.colors.background.canvas,paddingRight:"0 !important","@media print":{overflow:"visible"},"@page":{margin:0,size:"auto",padding:0},fontVariantLigatures:"no-contextual",...T.typography.body,...A,fontVariantNumeric:(0,f.$)("tabularNumbers")?"tabular-nums":"initial"},"h1, .h1":x(T.typography.h1),"h2, .h2":x(T.typography.h2),"h3, .h3":x(T.typography.h3),"h4, .h4":x(T.typography.h4),"h5, .h5":x(T.typography.h5),"h6, .h6":x(T.typography.h6),p:{margin:T.spacing(0,0,2)},textarea:{overflow:"auto",resize:"vertical"},button:{letterSpacing:T.typography.body.letterSpacing,"&:focus-visible":(0,p.getFocusStyles)(T),"&:focus":{outline:"none"}},label:{display:"inline-block"},figure:{margin:T.spacing(0,0,2)},img:{verticalAlign:"middle"},fieldset:{minWidth:0,padding:0,margin:0,border:0},legend:{display:"block",width:"100%",padding:0,marginBottom:T.spacing(1),fontSize:T.spacing(3),lineHeight:"inherit",border:0},"small, .small":{fontSize:T.typography.bodySmall.fontSize,fontWeight:"normal"},"b, strong":{fontWeight:T.typography.fontWeightMedium},em:{fontStyle:"italic",color:T.colors.text.primary},cite:{fontStyle:"normal"},blockquote:{padding:T.spacing(0,0,0,2),margin:T.spacing(0,0,2),borderLeft:`5px solid ${T.v1.palette.gray3}`,p:{marginBottom:0,fontSize:T.typography.fontSize*1.25,fontWeight:300,lineHeight:1.25},small:{display:"block",lineHeight:T.typography.body.lineHeight,color:T.v1.palette.gray2,"&:before":{content:"'\\2014 \\00A0'"}}},"q:before, q:after, blockquote:before, blockquote:after":{content:"''"},address:{display:"block",marginBottom:T.spacing(2),fontStyle:"normal",lineHeight:T.typography.body.lineHeight},"a.external-link":{color:T.colors.text.link,textDecoration:"normal","&:hover":{color:T.colors.text.link,textDecoration:"underline"}},".link":{color:T.colors.text.primary,cursor:"pointer"},".link:hover":{color:T.colors.text.maxContrast},".pointer":{cursor:"pointer"},"audio, canvas, progress, video":{display:"inline-block",verticalAlign:"baseline"},"audio:not([controls])":{display:"none",height:0},"abbr[title]":{borderBottom:"1px dotted",cursor:"help"},dfn:{fontStyle:"italic"},"sub, sup":{fontSize:"75%",lineHeight:0,position:"relative",verticalAlign:"baseline"},sup:{top:"-0.5em"},sub:{bottom:"-0.25em"},hr:{marginTop:T.spacing(2),marginBottom:T.spacing(2),border:0,borderTop:`1px solid ${T.colors.border.medium}`},"mark, .mark":{background:T.colors.warning.main},"ul, ol, dl":{marginTop:0,marginBottom:0,padding:0},"ul ul, ul ol, ol ol, ol ul":{marginBottom:0},li:{lineHeight:T.typography.body.lineHeight},dd:{marginBottom:T.spacing(1),marginLeft:0},"dt, dd":{lineHeight:T.typography.body.lineHeight},dt:{fontWeight:T.typography.fontWeightMedium},"button, input, optgroup, select, textarea":{borderRadius:0,color:"inherit",font:"inherit",lineHeight:"inherit",margin:0},optgroup:{fontWeight:"bold"},'button, html input[type="button"], input[type="submit"]':{WebkitAppearance:"button",cursor:"pointer"},'input[type="search"]':{WebkitAppearance:"none"},'input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration':{WebkitAppearance:"none"},table:{backgroundColor:"transparent",borderCollapse:"collapse",borderSpacing:0},caption:{paddingTop:T.spacing(.5),paddingBottom:T.spacing(.5),color:T.colors.text.secondary,textAlign:"left",captionSide:"bottom"},th:{fontWeight:T.typography.fontWeightMedium,textAlign:"left"},"td, th":{padding:0},".muted":{color:T.colors.text.secondary},"a.muted:hover, a.muted:focus":{color:T.colors.text.primary},".text-warning":{color:T.colors.warning.text,"&:hover, &:focus":{color:T.colors.emphasize(T.colors.warning.text,.15)}},".text-error":{color:T.colors.error.text,"&:hover, &:focus":{color:T.colors.emphasize(T.colors.error.text,.15)}},".text-success":{color:"$success-text-color","&:hover, &:focus":{color:T.colors.emphasize(T.colors.success.text,.15)}},a:{cursor:"pointer",color:T.colors.text.primary,textDecoration:"none","&:focus":{outline:"none"},"&:focus-visible":(0,p.getFocusStyles)(T),"&:[disabled]":{cursor:"default",pointerEvents:"none !important"}},"[role='button']":{cursor:"pointer"},"[hidden]":{display:"none !important"},"a, area, button, [role='button'], input, label, select, summary, textarea":{touchAction:"manipulation"},".text-link":{textDecoration:"underline"},".text-left":{textAlign:"left"},".text-right":{textAlign:"right"},".text-center":{textAlign:"center"},".highlight-search-match":{background:T.components.textHighlight.background,color:T.components.textHighlight.text,padding:0},".template-variable":{color:T.colors.primary.text},".modal-header-title":{fontSize:T.typography.size.lg,float:"left",paddingTop:T.spacing(1),margin:T.spacing(0,2)}})}function x(T){return{margin:0,fontSize:T.fontSize,lineHeight:T.lineHeight,fontWeight:T.fontWeight,letterSpacing:T.letterSpacing,fontFamily:T.fontFamily,marginBottom:"0.45em"}}function v(T){return(0,a.css)({"iframe.intercom-borderless-frame":{colorScheme:T.colors.mode}})}function m(T){return(0,a.css)({".filter-table *":{boxSizing:"border-box"},".filter-table":{width:"100%",borderCollapse:"separate",tbody:{"tr:nth-of-type(odd)":{background:T.colors.emphasize(T.colors.background.primary,.02)}},th:{width:"auto",padding:T.spacing(.5,1),textAlign:"left",lineHeight:"30px",height:"30px",whiteSpace:"nowrap"},td:{padding:T.spacing(.5,1),lineHeight:"30px",height:"30px",whiteSpace:"nowrap"},".link-td":{padding:0,lineHeight:"30px",height:"30px",whiteSpace:"nowrap",a:{display:"block",padding:T.spacing(0,1),height:"30px"}},".ellipsis":{display:"block",width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},".expanded":{borderColor:T.components.panel.background},".expanded > td":{paddingBottom:0},".filter-table__avatar":{width:"25px",height:"25px",borderRadius:T.shape.radius.circle},"&--hover":{"tbody tr:hover":{background:T.colors.emphasize(T.colors.background.primary,.05)}}}})}function y(T){const L=typeof window<"u"&&window.__grafana_public_path__,A=L?`${L}fonts/`:"public/fonts/";return(0,a.css)([{"@font-face":{fontFamily:"Roboto Mono",fontStyle:"normal",fontWeight:400,fontDisplay:"swap",src:`url('${A}roboto/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0mQ.woff2') format('woff2')`,unicodeRange:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD"}},{"@font-face":{fontFamily:"Roboto Mono",fontStyle:"normal",fontWeight:500,fontDisplay:"swap",src:`url('${A}roboto/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0mQ.woff2') format('woff2')`,unicodeRange:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD"}},{"@font-face":{fontFamily:"Inter",fontStyle:"normal",fontWeight:400,fontDisplay:"swap",src:`url('${A}inter/Inter-Regular.woff2') format('woff2')`}},{"@font-face":{fontFamily:"Inter",fontStyle:"normal",fontWeight:500,fontDisplay:"swap",src:`url('${A}inter/Inter-Medium.woff2') format('woff2')`}}])}function h(T){return(0,a.css)({"input, button, select, textarea":{fontFamily:T.typography.body.fontFamily,fontSize:T.typography.body.fontSize,fontWeight:T.typography.body.fontWeight,lineHeight:T.typography.body.lineHeight},"input, select":{backgroundColor:T.components.input.background,color:T.components.input.text,border:"none",boxShadow:"none"},"input, textarea":{"&::placeholder":{color:T.colors.text.disabled}},'input[type="number"]::-webkit-outer-spin-button, input[type="number"]::-webkit-inner-spin-button':{WebkitAppearance:"none",margin:0},'input[type="number"]':{MozAppearance:"textfield"},'select, input[type="file"]':{height:T.components.height.md,lineHeight:T.components.height.md},select:{width:"220px",border:`1px solid ${T.components.input.borderColor}`,backgroundColor:T.components.input.background},"select[multiple], select[size], textarea":{height:"auto"},'select:focus, input[type="file"]:focus, input[type="radio"]:focus, input[type="checkbox"]:focus':{outline:"5px auto -webkit-focus-ring-color",outlineOffset:"-2px"},"input[type='file'], input[type='image'], input[type='submit'], input[type='reset'], input[type='button'], input[type='radio'], input[type='checkbox']":{width:"auto"},"input[disabled], select[disabled], textarea[disabled], input[readonly], select[readonly], textarea[readonly]":{cursor:"not-allowed",backgroundColor:T.colors.action.disabledBackground},'input[type="radio"][disabled], input[type="checkbox"][disabled], input[type="radio"][readonly], input[type="checkbox"][readonly]':{cursor:"not-allowed",backgroundColor:"transparent"},"input:-webkit-autofill, input:-webkit-autofill:hover, input:-webkit-autofill:focus, input:-webkit-autofill, textarea:-webkit-autofill, textarea:-webkit-autofill:hover, textarea:-webkit-autofill:focus, select:-webkit-autofill, select:-webkit-autofill:hover, select:-webkit-autofill:focus":{WebkitBoxShadow:`0 0 0px 1000px ${T.components.input.background} inset !important`,WebkitTextFillColor:T.components.input.text,boxShadow:`0 0 0px 1000px ${T.components.input.background} inset`,border:`1px solid ${T.components.input.background}`},".gf-form":{display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",marginBottom:T.spacing(.5),"&--offset-1":{marginLeft:T.spacing(2)},"&--grow":{flexGrow:1},"&--flex-end":{justifyContent:"flex-end"},"&--align-center":{alignContent:"center"},"&--alt":{flexDirection:"column",alignItems:"flex-start",".gf-form-label":{padding:"4px 0"}}},".gf-form--has-input-icon":{position:"relative",marginRight:T.spacing(.5),".gf-form-input-icon":{position:"absolute",top:"8px",fontSize:T.typography.size.lg,left:"10px",color:T.colors.text.disabled},"> input":{paddingLeft:"35px","&:focus + .gf-form-input-icon":{color:T.colors.text.secondary}},".Select--multi .Select-multi-value-wrapper, .Select-placeholder":{paddingLeft:"30px"}},".gf-form-disabled":{color:T.colors.text.secondary,".gf-form-select-wrapper::after":{color:T.colors.text.secondary},"a, .gf-form-input":{color:T.colors.text.secondary}},".gf-form-group":{marginBottom:T.spacing(5)},".gf-form-inline":{display:"flex",flexDirection:"row",flexWrap:"wrap",alignContent:"flex-start","&--nowrap":{flexWrap:"nowrap"},"&--xs-view-flex-column":{flexDirection:"row",flexWrap:"nowrap",[T.breakpoints.down("sm")]:{flexDirection:"column"}},".select-container":{marginRight:T.spacing(.5)},".gf-form-spacing":{marginRight:T.spacing(.5)}},".gf-form-button-row":{paddingTop:T.spacing(3),"a, button":{marginRight:T.spacing(2)}},".gf-form-label":{display:"flex",alignItems:"center",padding:T.spacing(0,1),flexShrink:0,fontWeight:T.typography.fontWeightMedium,fontSize:T.typography.size.sm,backgroundColor:T.colors.background.secondary,height:"32px",lineHeight:"32px",marginRight:T.spacing(.5),borderRadius:T.shape.radius.default,justifyContent:"space-between",border:"none","&--grow":{flexGrow:1},"&--transparent":{backgroundColor:"transparent",border:0,textAlign:"right",paddingLeft:0},"&--variable":{color:T.colors.primary.text,background:T.components.panel.background,border:`1px solid ${T.components.panel.borderColor}`},"&--btn":{border:"none",borderRadius:T.shape.radius.default,"&:hover":{background:T.colors.background.secondary,color:T.colors.text.primary}},"&:disabled":{color:T.colors.text.secondary}},".gf-form-label + .gf-form-label":{marginRight:T.spacing(.5)},".gf-form-pre":{display:"block !important",flexGrow:1,margin:0,marginRight:T.spacing(.5),border:"1px solid transparent",borderLeft:"none",borderRadius:T.shape.radius.default},".gf-form-textarea":{maxWidth:"650px"},".gf-form-input":{display:"block",width:"100%",height:"32px",padding:T.spacing(0,1),fontSize:T.typography.size.md,lineHeight:"18px",color:T.components.input.text,backgroundColor:T.components.input.background,backgroundImage:"none",backgroundClip:"padding-box",border:`1px solid ${T.components.input.borderColor}`,borderRadius:T.shape.radius.default,marginRight:T.spacing(.5),whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","&textarea":{overflow:"auto",whiteSpace:"pre-wrap",padding:`6px ${T.spacing(1)}`,minHeight:"32px",height:"auto"},"&::-ms-expand":{backgroundColor:"transparent",border:0,display:"none"},"&:focus":{borderColor:T.colors.primary.border,outline:"none"},"&::placeholder":{color:T.colors.text.disabled,opacity:1},"&:disabled, &[readonly]":{backgroundColor:T.colors.action.disabledBackground,opacity:1},"&:disabled":{cursor:"not-allowed"},"&.gf-size-auto":{width:"auto"},"&--dropdown":{paddingRight:T.spacing(3),position:"relative",display:"flex",alignItems:"center","&::after":{position:"absolute",top:"36%",right:"11px",fontSize:"11px",backgroundColor:"transparent",color:T.colors.text.primary,font:`normal normal normal ${T.typography.size.sm}/1 FontAwesome`,content:'"\f0d7"',pointerEvents:"none"}},"&--has-help-icon":{paddingRight:T.spacing(4)}},".gf-form-select-wrapper":{position:"relative",backgroundColor:T.components.input.background,marginRight:T.spacing(.5),".gf-form-select-icon":{position:"absolute",zIndex:1,top:"50%",marginTop:"-7px","+ .gf-form-input":{position:"relative",zIndex:2,paddingLeft:T.spacing(4),backgroundColor:"transparent",option:{color:T.v1.palette.black}}},".gf-form-input":{marginRight:0,lineHeight:"32px"},"select.gf-form-input":{textIndent:"0.01px",textOverflow:"''",paddingRight:T.spacing(4),appearance:"none","&:-moz-focusring":{outline:"none",color:"transparent",textShadow:`0 0 0 ${T.colors.text.primary}`},"&.ng-empty":{color:T.colors.text.secondary}},"&::after":{position:"absolute",top:"36%",right:"11px",backgroundColor:"transparent",color:T.colors.text.primary,font:`normal normal normal ${T.typography.size.sm}/1 FontAwesome`,content:'"\f0d7"',pointerEvents:"none",fontSize:"11px"},"&--has-help-icon":{"&::after":{right:T.spacing(4)}}},".gf-form--v-stretch":{alignItems:"stretch"},".gf-form-btn":{padding:T.spacing(0,1),marginRight:T.spacing(.5),lineHeight:"18px",fontSize:T.typography.size.sm,flexShrink:0,flexGrow:0},".gf-form-help-icon":{flexGrow:0,color:T.colors.text.secondary,"&:hover":{color:T.colors.text.primary}},".cta-form":{position:"relative",padding:T.spacing(3),backgroundColor:T.colors.background.secondary,marginBottom:T.spacing(3),borderTop:`3px solid ${T.colors.success.main}`},".input-small":{width:"90px"}})}function d(T){return(0,a.css)([])}function E(T){return(0,a.css)({".json-formatter-row":{fontFamily:"monospace","&, a, a:hover":{color:T.colors.text.primary,textDecoration:"none"},".json-formatter-row":{marginLeft:T.spacing(2)},".json-formatter-children":{"&.json-formatter-empty":{opacity:.5,marginLeft:T.spacing(2),"&::after":{display:"none"},"&.json-formatter-object::after":{content:"'No properties'"},"&.json-formatter-array::after":{content:"'[]'"}}},".json-formatter-string":{color:T.isDark?"#23d662":"green",whiteSpace:"pre-wrap",wordWrap:"break-word",wordBreak:"break-all"},".json-formatter-number":{color:T.isDark?T.colors.primary.text:T.colors.primary.main},".json-formatter-boolean":{color:T.isDark?T.colors.primary.text:T.colors.error.main},".json-formatter-null":{color:T.isDark?"#eec97d":"#855a00"},".json-formatter-undefined":{color:T.isDark?"rgb(239, 143, 190)":"rgb(202, 11, 105)"},".json-formatter-function":{color:T.isDark?"#fd48cb":"#ff20ed"},".json-formatter-url":{textDecoration:"underline",color:T.isDark?"#027bff":T.colors.primary.main,cursor:"pointer"},".json-formatter-bracket":{color:T.isDark?"#9494ff":T.colors.primary.main},".json-formatter-key":{color:T.isDark?"#23a0db":"#00008b",cursor:"pointer",paddingRight:T.spacing(.25),marginRight:T.spacing(.5)},".json-formatter-constructor-name":{cursor:"pointer"},".json-formatter-array-comma":{marginRight:T.spacing(.5)},".json-formatter-toggler":{lineHeight:"16px",fontSize:T.typography.size.xs,verticalAlign:"middle",opacity:.6,cursor:"pointer",paddingRight:T.spacing(.25),"&::after":{display:"inline-block",transition:"transform 100ms ease-in",content:"'\u25BA'"}},"> a > .json-formatter-preview-text":{opacity:0,transition:"opacity 0.15s ease-in",fontStyle:"italic"},"&:hover > a > .json-formatter-preview-text":{opacity:.6},"&.json-formatter-open":{"> .json-formatter-toggler-link .json-formatter-toggler::after":{transform:"rotate(90deg)"},"> .json-formatter-children::after":{display:"inline-block"},"> a > .json-formatter-preview-text":{display:"none"},"&.json-formatter-empty::after":{display:"block"}}}})}function b(T){return(0,a.css)({".gf-form-select-box__control":{width:"100%",marginRight:T.spacing(.5),backgroundColor:T.components.input.background,border:`1px solid ${T.components.input.borderColor}`,borderRadius:T.shape.radius.default,color:T.components.input.text,cursor:"default",height:T.spacing(4),outline:"none",overflow:"hidden",position:"relative"},".gf-form-select-box__control--is-focused":{backgroundColor:T.components.input.background,borderColor:T.colors.primary.border,outline:"none",boxShadow:`inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px ${T.colors.primary.border}`},".gf-form-select-box__control--is-disabled":{backgroundColor:T.colors.action.disabledBackground},".gf-form-select-box__control--menu-right":{".gf-form-select-box__menu":{right:0,left:"unset"}},".gf-form-select-box__input":{input:{lineHeight:"inherit"}},".gf-form-select-box__menu":{background:T.colors.background.primary,boxShadow:T.shadows.z3,position:"absolute",zIndex:T.zIndex.dropdown,minWidth:"100%","&-notice--no-options":{backgroundColor:T.components.input.background,padding:"10px"}},".gf-form-select-box__menu-list":{overflowY:"auto",maxHeight:"300px",maxWidth:"600px"},".tag-filter .gf-form-select-box__menu":{width:"100%"},".gf-form-select-box__multi-value":{display:"inline",margin:"0 6px 0 0",cursor:"pointer"},".gf-form-select-box__multi-value__remove":{textAlign:"center",display:"inline-block",marginLeft:"2px",position:"relative"},".gf-form-select-box__multi-value__label":{display:"inline",verticalAlign:"middle"},".gf-form-select-box__option":{borderLeft:"2px solid transparent",whiteSpace:"nowrap",backgroundColor:T.components.input.background,"&.gf-form-select-box__option--is-focused":{color:T.colors.text.primary,background:T.colors.action.hover,borderImage:T.colors.gradients.brandVertical,borderImageSlice:1,borderStyle:"solid",borderTop:0,borderRight:0,borderBottom:0,borderLeftWidth:"2px"},"&.gf-form-select-box__option--is-selected":{".fa":{color:T.colors.text.primary}}},".gf-form-select-box__placeholder":{color:T.colors.text.disabled},".gf-form-select-box__control--is-focused .gf-form-select-box__placeholder":{display:"none"},".gf-form-select-box__value-container":{display:"inline-block",padding:"6px 20px 6px 10px",verticalAlign:"middle","> div":{display:"inline-block",verticalAlign:"middle"}},".gf-form-select-box__indicators":{position:"absolute",height:"100%",right:"8px",top:"1px",display:"inline-block",textAlign:"right"},".gf-form-input--form-dropdown":{padding:0,border:0,overflow:"visible",position:"relative"},".gf-form--has-input-icon":{".gf-form-select-box__value-container":{paddingLeft:"30px"}},".gf-form-select-box__desc-option":{display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%"},".gf-form-select-box__desc-option__body":{display:"flex",flexDirection:"column",flexGrow:1,paddingRight:"10px",fontWeight:T.typography.fontWeightMedium},".gf-form-select-box__desc-option__desc":{fontWeight:"normal",fontSize:T.typography.bodySmall.fontSize,color:T.colors.text.secondary},".gf-form-select-box__desc-option__img":{width:"16px",marginRight:"10px"},".gf-form-select-box__option-group__header":{display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%",borderBottom:`1px solid ${T.v1.palette.dark9}`,textTransform:"capitalize",".fa":{paddingRight:"2px"}},".gf-form-select-box-button-select":{height:"auto"},".select-button":{display:"flex",alignItems:"center"}})}function D(T){return(0,a.css)({".markdown-html":{img:{maxWidth:"100%"},"ul, ol":{paddingLeft:T.spacing(3),marginBottom:T.spacing(2)},table:{marginBottom:T.spacing(2),"td, th":{padding:T.spacing(.5,1)},th:{fontWeight:T.typography.fontWeightMedium,background:T.colors.background.secondary}},"table, th, td":{border:`1px solid ${T.colors.border.medium}`,borderCollapse:"collapse"},a:{color:T.colors.text.link,textDecoration:"none","&:hover":{color:T.colors.text.link,textDecoration:"underline"}},"p:last-child":{marginBottom:0},"table:last-child, ul:last-child, ol:last-child":{marginBottom:0}}})}function C(T){const L=T.breakpoints.values.xxl+T.spacing.gridSize*2+T.components.sidemenu.width;return(0,a.css)({".grafana-app":{display:"flex",flexDirection:"column",height:"100vh"},".main-view":{display:"flex",flexDirection:"column",flexGrow:1,position:"relative",minWidth:0},".page-scrollbar-content":{display:"flex",minHeight:"100%",flexDirection:"column",width:"100%",height:"100%"},".page-container":{flexGrow:1,flexBasis:"100%",paddingLeft:T.spacing(2),paddingRight:T.spacing(2),[T.breakpoints.up("sm")]:{margin:T.spacing(0,1)},[T.breakpoints.up("md")]:{margin:T.spacing(0,2)},[`@media (min-width: ${L}px)`]:{maxWidth:`${T.breakpoints.values.xxl}px`,marginLeft:"auto",marginRight:"auto",width:"100%"}},".page-full":{marginLeft:T.spacing(2),paddingLeft:T.spacing(2),paddingRight:T.spacing(2)},".page-body":{padding:T.spacing(1),background:T.components.panel.background,border:`1px solid ${T.components.panel.borderColor}`,marginBottom:"32px",[T.breakpoints.up("md")]:{padding:T.spacing(2)},[T.breakpoints.up("lg")]:{padding:T.spacing(3)}},".page-heading":{fontSize:T.typography.h4.fontSize,marginTop:0,marginBottom:T.spacing(2)},".page-action-bar":{marginBottom:T.spacing(2),display:"flex",alignItems:"flex-start",gap:T.spacing(2)},".page-action-bar--narrow":{marginBottom:0},".page-action-bar__spacer":{width:T.spacing(2),flexGrow:1},".page-sub-heading":{marginBottom:T.spacing(2)},".page-sub-heading-icon":{marginLeft:T.spacing(1),marginTop:T.spacing(.5)},".page-hidden":{display:"none"}})}function P(T){return(0,a.css)({".query-editor-row":{marginBottom:"2px","&--disabled":{".query-keyword":{color:T.colors.text.secondary}}},".query-keyword":{fontWeight:T.typography.fontWeightMedium,color:`${T.colors.primary.text} !important`},".query-part":{backgroundColor:T.colors.background.secondary,"&:hover":{background:T.colors.emphasize(T.colors.background.secondary,.03)}},".query-segment-operator":{color:`${T.v1.palette.orange} !important`},".tight-form-func":{background:T.colors.background.secondary},'input[type="text"].tight-form-func-param':{fontSize:T.typography.bodySmall.fontSize,background:"transparent",border:"none",margin:0,padding:0},".tight-form-func-controls":{textAlign:"center",".fa-arrow-left":{float:"left",position:"relative",top:2},".fa-arrow-right":{float:"right",position:"relative",top:2},".fa-remove":{marginLeft:"10px"}}})}var M=e(21348);const O=T=>(0,a.css)({".react-loading-skeleton":M.Q});function j(T){return(0,a.css)({".slate-query-field":{fontSize:T.typography.fontSize,fontFamily:T.typography.fontFamilyMonospace,height:"auto",wordBreak:"break-word",overflow:"auto"},".slate-query-field__wrapper":{position:"relative",display:"inline-block",padding:"6px 8px",minHeight:"32px",width:"100%",color:T.colors.text.primary,backgroundColor:T.components.input.background,backgroundImage:"none",border:`1px solid ${T.components.input.borderColor}`,borderRadius:T.shape.radius.default,transition:"all 0.3s",lineHeight:"18px"},".slate-query-field__wrapper--disabled":{backgroundColor:"inherit",cursor:"not-allowed"},".slate-typeahead":{".typeahead":{position:"relative",zIndex:T.zIndex.typeahead,borderRadius:T.shape.radius.default,border:`1px solid ${T.components.panel.borderColor}`,maxHeight:"66vh",overflowY:"scroll",overflowX:"hidden",outline:"none",listStyle:"none",background:T.components.panel.background,color:T.colors.text.primary,boxShadow:T.shadows.z2},".typeahead-group__title":{color:T.colors.text.secondary,fontSize:T.typography.size.sm,lineHeight:T.typography.body.lineHeight,padding:T.spacing(1)},".typeahead-item":{height:"auto",fontFamily:T.typography.fontFamilyMonospace,padding:T.spacing(1,1,1,2),fontSize:T.typography.size.sm,textOverflow:"ellipsis",overflow:"hidden",zIndex:1,display:"block",whiteSpace:"nowrap",cursor:"pointer",transition:"color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), border-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), background 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), padding 0.15s cubic-bezier(0.645, 0.045, 0.355, 1)"},".typeahead-item__selected":{backgroundColor:T.isDark?T.v1.palette.dark9:T.v1.palette.gray6,".typeahead-item-hint":{fontSize:T.typography.size.xs,color:T.colors.text.primary,whiteSpace:"normal"}},".typeahead-match":{color:T.v1.palette.yellow,borderBottom:`1px solid ${T.v1.palette.yellow}`,padding:"inherit",background:"inherit"}},".slate-query-field, .prism-syntax-highlight":{".token.comment, .token.block-comment, .token.prolog, .token.doctype, .token.cdata":{color:T.colors.text.secondary},".token.variable, .token.entity":{color:T.colors.text.primary},".token.property, .token.tag, .token.constant, .token.symbol, .token.deleted":{color:T.colors.error.text},".token.attr-value, .token.selector, .token.string, .token.char, .token.builtin, .token.inserted":{color:T.colors.success.text},".token.boolean, .token.number, .token.operator, .token.url":{color:"#fe85fc"},".token.function, .token.attr-name, .token.function-name, .token.atrule, .token.keyword, .token.class-name":{color:T.colors.primary.text},".token.punctuation, .token.regex, .token.important":{color:T.v1.palette.orange},".token.important":{fontWeight:"normal"},".token.bold":{fontWeight:"bold"},".token.italic":{fontStyle:"italic"},".token.entity":{cursor:"help"},".namespace":{opacity:.7}}})}function U(T){return(0,a.css)({".uplot":{fontFamily:"inherit"},".u-select":{background:"rgba(120, 120, 130, 0.2)"},".u-hz .u-cursor-x, .u-vt .u-cursor-y":{borderRight:"1px dashed rgba(120, 120, 130, 0.5)"},".u-hz .u-cursor-y, .u-vt .u-cursor-x":{borderBottom:"1px dashed rgba(120, 120, 130, 0.5)"},".shared-crosshair:not(.plot-active) .u-cursor-pt":{display:"none !important"}})}function W(T,L,A="#fff",N="0px 1px 0 rgba(0, 0, 0, 0.1)"){return{backgroundColor:T,backgroundImage:`linear-gradient(to bottom, ${T}, ${L})`,backgroundRepeat:"repeat-x",color:A,textShadow:N,borderColor:T,"&:hover, &:focus, &:active, &.active, &.disabled, &[disabled]":{color:A,backgroundImage:"none",backgroundColor:T}}}function B(T,L,A,N){return{padding:`${T} ${L}`,fontSize:A,borderRadius:N}}function S(T,L){let A={};for(let N=1;N<=L;N++){const V=`${T.spacing(2*N)} !important`;A[`.width-${N}`]={width:V},A[`.max-width-${N}`]={maxWidth:V,flexGrow:1},A[`.min-width-${N}`]={minWidth:V},A[`.offset-width-${N}`]={marginLeft:V}}return A}function _(T){return(0,a.css)({".highlight-word":{color:T.v1.palette.orange},".hide":{display:"none"},".show":{display:"block"},".invisible":{visibility:"hidden !important"},".absolute":{position:"absolute"},".flex-grow-1":{flexGrow:1},".flex-shrink-1":{flexShrink:1},".flex-shrink-0":{flexShrink:0},".center-vh":{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",justifyItems:"center"},".btn":{display:"inline-flex",alignItems:"center",justifyContent:"center",fontWeight:T.typography.fontWeightMedium,lineHeight:T.typography.body.lineHeight,textAlign:"center",verticalAlign:"middle",cursor:"pointer",border:"none",height:`${T.spacing.gridSize*T.components.height.md}px`,...B(T.spacing(0),T.spacing(2),`${T.typography.fontSize}px`,T.shape.radius.default),"&, &:active, &.active":{"&:focus, &.focus":{outline:"none"}},"&:focus, &:hover":{textDecoration:"none"},"&.focus":{textDecoration:"none"},"&:active, &.active":{backgroundImage:"none",outline:0},"&.disabled, &[disabled], &:disabled":{cursor:"not-allowed",opacity:.65,boxShadow:"none",pointerEvents:"none"}},".btn-small":{...B(T.spacing(.5),T.spacing(1),T.typography.size.sm,T.shape.radius.default),height:`${T.spacing.gridSize*T.components.height.sm}px`},".btn-mini":{...B(T.spacing(.5),T.spacing(1),T.typography.size.sm,T.shape.radius.default),height:`${T.spacing.gridSize*T.components.height.sm}px`},".btn-success, .btn-primary":{...W(T.colors.primary.main,T.colors.primary.shade)},".btn-danger":{...W(T.colors.error.main,T.colors.error.shade)},".btn-secondary":{...W(T.colors.secondary.main,T.colors.secondary.shade,T.colors.text.primary)},".btn-inverse":{...W(T.isDark?T.v1.palette.dark6:T.v1.palette.gray5,T.isDark?T.v1.palette.dark5:T.v1.palette.gray4,T.colors.text.primary),"&":{boxShadow:"none"}},".typeahead":{zIndex:T.zIndex.typeahead},...S(T,30),".row":{display:"flex",flexWrap:"wrap",marginLeft:`calc(${T.spacing(4)} / -2)`,marginRight:`calc(${T.spacing(4)} / -2)`},".container":{marginLeft:"auto",marginRight:"auto",paddingLeft:`calc(${T.spacing(4)} / 2)`,paddingRight:`calc(${T.spacing(4)} / 2)`,[T.breakpoints.up("sm")]:{maxWidth:T.breakpoints.values.sm},[T.breakpoints.up("md")]:{maxWidth:T.breakpoints.values.md},[T.breakpoints.up("lg")]:{maxWidth:T.breakpoints.values.lg},[T.breakpoints.up("xl")]:{maxWidth:T.breakpoints.values.xl}}})}function K(T){const L=(0,s.$j)(),{isExtensionSidebarOpen:A}=T;return(0,n.jsx)(a.Global,{styles:[i(L),r(L),o(L),g(L),l(L),c(L,A),v(L),m(L),y(L),h(L),E(L),u(L),D(L),C(L),P(L),O(L),j(L),U(L),_(L),b(L),d({})]})}},53926:(te,R,e)=>{"use strict";e.d(R,{I:()=>n});var n=(a=>(a.GroupTitle="GroupTitle",a))(n||{})},14226:(te,R,e)=>{"use strict";e.d(R,{Q:()=>n});const n=(a,s)=>{a.key==="Tab"||a.altKey||a.ctrlKey||a.metaKey||(a.stopPropagation(),a.key==="Escape"&&s())}},8255:(te,R,e)=>{"use strict";e.d(R,{Ih:()=>h,Mk:()=>r,Tj:()=>p,UJ:()=>f,Xw:()=>u,ct:()=>g,mZ:()=>y,nO:()=>l,sg:()=>m,xj:()=>o});var n=e(2543),a=e.n(n),s=e(84140);const i=4,r="rgba(0, 211, 255, 1)",u="rgba(11, 237, 50, 1)",o="rgba(237, 46, 24, 1)",l="rgba(150, 150, 150, 1)",g="rgba(247, 149, 32, 1)",f=.09,p=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"];function c(d){const E=(0,n.map)(d,x),b=(0,n.sortBy)(E,["h"]),D=(0,n.chunk)(b,i),C=(0,n.map)(D,M=>(0,n.sortBy)(M,"l")),P=(0,n.flattenDeep)((0,n.zip)(...C));return(0,n.map)(P,v)}function x(d){return(0,s.A)(d).toHsl()}function v(d){return(0,s.A)(d).toHexString()}function m(d){return(0,s.A)(d).getBrightness()>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}function y(d,E){const b=(0,s.A)(d),D=b.getBrightness();return b.getAlpha()<.3?E?"rgb(247, 248, 250)":"rgb(32, 34, 38)":D>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}let h=c(p)},75254:(te,R,e)=>{"use strict";e.d(R,{J:()=>n});const n=a=>a().map(s=>({label:s.title,ariaLabel:s.title,url:s.href,target:s.target,icon:`${s.target==="_blank"?"external-link-alt":"link"}`,onClick:s.onClick}))},20720:(te,R,e)=>{"use strict";e.d(R,{h:()=>n});function n(a,s,i){}},27629:(te,R,e)=>{"use strict";e.d(R,{$:()=>n});function n(a,s=!1){return window.grafanaBootData?.settings.featureToggles[a]??s}},28473:(te,R,e)=>{"use strict";e.d(R,{i:()=>n});function n(a){const i=a.lastIndexOf("."),r=a.substring(i),u=a.substring(0,i);return u.length<16?a:`${u.substring(0,16)}...${r}`}},63267:(te,R,e)=>{"use strict";e.d(R,{I:()=>s});var n=e(2543),a=e.n(n);function s(i,r){let u=0,o=i.indexOf(r);r=r.replace(/\s/g,"");const l=[];if(o!==-1)return{distance:0,found:!0,ranges:[{start:o,end:o+r.length-1}]};for(const g of r){const f=i.indexOf(g,o);if(f===-1)return{distance:1/0,ranges:[],found:!1};if(o!==-1&&(u+=f-o),o=f+1,l.length===0)l.push({start:f,end:f});else{const p=(0,n.last)(l);f===p.end+1?p.end++:l.push({start:f,end:f})}}return{distance:u,ranges:l,found:!0}}},60379:(te,R,e)=>{"use strict";e.d(R,{h:()=>i});var n=e(2543),a=e.n(n);const s=(0,n.throttle)((...r)=>{console.log(...r)},500),i=r=>{let u=!1;return typeof window<"u"&&(u=window.localStorage.getItem("grafana.debug")==="true"),{logger:(o,l=!1,...g)=>{},enable:()=>u=!0,disable:()=>u=!1,isEnabled:()=>u}}},53568:(te,R,e)=>{"use strict";e.d(R,{Vr:()=>o,Yc:()=>r,kD:()=>u});let n;const a=new Map,s=500;let i="";function r(){return n||(n=document.createElement("canvas").getContext("2d")),n}function u(l,g,f=400){const p=`${f} ${g}px 'Inter'`,c=l+p,x=a.get(c);if(x)return x;const v=r();i!==p&&(v.font=i=p);const m=v.measureText(l);return a.size===s&&a.clear(),a.set(c,m),m}function o(l,g,f,p,c,x){const v=u(l,14,x),m=g/(v.width+2)*14,y=f/p,h=Math.min(y,m);return Math.min(h,c??h)}},44019:(te,R,e)=>{"use strict";e.r(R),e.d(R,{getChildId:()=>a,renderOrCallToRender:()=>s});var n=e(96540);function a(i){let r;const u=n.Children.only(i);return"id"in u?.props?r=u.props.id:"inputId"in u.props&&(r=u?.props.inputId),typeof r=="string"?r:void 0}function s(i,r){if(n.isValidElement(i)||typeof i=="string"||typeof i=="number")return i;if(typeof i=="function"&&r)return i(r);throw new Error(`${i} is not a React element nor a function that returns React element`)}},59258:(te,R,e)=>{"use strict";e.d(R,{H:()=>u,T:()=>a});var n=e(63267),a=(o=>(o.Word="Word",o.Prefix="Prefix",o.Fuzzy="Fuzzy",o))(a||{});const u={Word:(o,l)=>o.filter(g=>(g.filterText||g.label).includes(l)),Prefix:(o,l)=>o.filter(g=>(g.filterText||g.label).startsWith(l)),Fuzzy:(o,l)=>(l=l.toLowerCase(),o.filter(g=>{const{distance:f,ranges:p,found:c}=(0,n.I)(g.label.toLowerCase(),l);return c?(g.sortValue=f,g.highlightParts=p,!0):!1}))}},21348:(te,R,e)=>{"use strict";e.d(R,{Q:()=>i,j:()=>r});var n=e(74848),a=e(22803);const i={animationName:(0,a.keyframes)({"0%":{opacity:0},"100%":{opacity:1}}),animationDelay:"100ms",animationTimingFunction:"ease-in",animationDuration:"100ms",animationFillMode:"backwards"},r=(u,o)=>Object.assign(u,{Skeleton:g=>(0,n.jsx)(o,{...g,rootProps:{style:i}})})},35458:(te,R,e)=>{"use strict";e.d(R,{dF:()=>s,mO:()=>i,yx:()=>a});var n=e(82611);const a={document:{nodes:[{match:[{type:"paragraph"},{type:"code_block"},{type:"code_line"}]}]},inlines:{}},s=(r,u)=>{const o=r.split(`
`).map(g=>n.Block.create({type:"code_line",nodes:[n.Text.create(g)]})),l=n.Block.create({data:{syntax:u},type:"code_block",nodes:o});return n.Document.create({nodes:[l]})},i=(r,u)=>{const o=s(r,u);return n.Value.create({document:o})}},86059:(te,R,e)=>{"use strict";e.d(R,{k:()=>n});const n=(a,s)=>{let i;if(a.getLinks&&(i=a.getLinks({valueRowIndex:s.index})),!!i){for(let r=0;r<i?.length;r++)if(i[r].onClick){const u=i[r].onClick;i[r].onClick=o=>{o.ctrlKey||o.metaKey||o.shiftKey||(o.preventDefault(),u(o,{field:a,rowIndex:s.index}))}}return i.filter(r=>r.href||r.onClick!=null)}}},48542:(te,R,e)=>{"use strict";e.d(R,{JF:()=>s,MC:()=>i,yC:()=>r});const n=["#D32D20","#1E72B8","#B240A2","#705DA0","#466803","#497A3C","#3D71AA","#B15415","#890F02","#6E6E6E","#0A437C","#6D1F62","#584477","#4C7A3F","#2F4F4F","#BF1B00","#7662B1","#8A2EB8","#517A00","#000000","#3F6833","#2F575E","#99440A","#AE561A","#0E4AB4","#58140C","#052B51","#511749","#3F2B5B"],a=["#FF7368","#459EE7","#E069CF","#9683C6","#6C8E29","#76AC68","#6AA4E2","#E7823D","#AF3528","#9B9B9B","#3069A2","#934588","#7E6A9D","#88C477","#557575","#E54126","#A694DD","#B054DE","#8FC426","#262626","#658E59","#557D84","#BF6A30","#FF9B53","#3470DA","#7E3A32","#2B5177","#773D6F","#655181"];function s(l=""){const g=u(l.toLowerCase());return Math.abs(g%n.length)}function i(l=""){const g=s(l);return r(g)}function r(l){return{color:n[l],borderColor:a[l]}}function u(l){let g=5381;for(let f=0;f<l.length;f++)g=(g<<5)+g+l.charCodeAt(f);return g}var o={getTagColorsFromName:i}},79104:(te,R,e)=>{"use strict";e.d(R,{C:()=>a});var n=e(96540);function a(){const[s,i]=(0,n.useState)(0);return(0,n.useCallback)(()=>i(r=>r+1),[])}},36324:(te,R,e)=>{"use strict";e.d(R,{C:()=>s,b:()=>a});var n=e(96540);function a(u=10){let o={x:0,y:0};return{set:f=>{o=i(f)},check:(f,p=u)=>r(o,i(f),p)}}function s(u=10){const o=n.useRef({x:0,y:0}),l=(0,n.useCallback)(f=>{o.current=i(f)},[]),g=(0,n.useCallback)((f,p=u)=>r(o.current,i(f),p),[u]);return(0,n.useMemo)(()=>({set:l,check:g}),[l,g])}function i(u){return{x:u.clientX,y:u.clientY}}function r(u,o,l){return Math.hypot(u.x-o.x,u.y-o.y)>l}},75745:(te,R,e)=>{"use strict";e.d(R,{K:()=>s,Pw:()=>n,RP:()=>i,tf:()=>a});var n=(r=>(r.onBlur="onBlur",r.onFocus="onFocus",r.onChange="onChange",r))(n||{});const a=(r,u)=>{const o=u.reduce((l,g)=>g.rule(r)?l:l.concat(g.errorMessage),[]);return o.length>0?o:null},s=(r,u)=>u&&u[r],i=(r,u)=>({rule:o=>!!o.match(r),errorMessage:u||"Value is not valid"})},87161:(te,R,e)=>{"use strict";e.d(R,{Z:()=>l,k:()=>g});var n=e(75816),a=e(73892),s=e(85618);const i=(0,s.TP)("folder.grafana.app","v1beta1"),r=(0,n.xP)({reducerPath:"folderAPIv1beta1",baseQuery:(0,a.W)({baseURL:i}),endpoints:()=>({})}),u=["API Discovery","Folder"],l=r.enhanceEndpoints({addTagTypes:u}).injectEndpoints({endpoints:f=>({getApiResources:f.query({query:()=>({url:"/apis/folder.grafana.app/v1beta1/"}),providesTags:["API Discovery"]}),listFolder:f.query({query:p=>({url:"/folders",params:{pretty:p.pretty,allowWatchBookmarks:p.allowWatchBookmarks,continue:p.continue,fieldSelector:p.fieldSelector,labelSelector:p.labelSelector,limit:p.limit,resourceVersion:p.resourceVersion,resourceVersionMatch:p.resourceVersionMatch,sendInitialEvents:p.sendInitialEvents,timeoutSeconds:p.timeoutSeconds,watch:p.watch}}),providesTags:["Folder"]}),createFolder:f.mutation({query:p=>({url:"/folders",method:"POST",body:p.folder,params:{pretty:p.pretty,dryRun:p.dryRun,fieldManager:p.fieldManager,fieldValidation:p.fieldValidation}}),invalidatesTags:["Folder"]}),deletecollectionFolder:f.mutation({query:p=>({url:"/folders",method:"DELETE",params:{pretty:p.pretty,continue:p.continue,dryRun:p.dryRun,fieldSelector:p.fieldSelector,gracePeriodSeconds:p.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:p.ignoreStoreReadErrorWithClusterBreakingPotential,labelSelector:p.labelSelector,limit:p.limit,orphanDependents:p.orphanDependents,propagationPolicy:p.propagationPolicy,resourceVersion:p.resourceVersion,resourceVersionMatch:p.resourceVersionMatch,sendInitialEvents:p.sendInitialEvents,timeoutSeconds:p.timeoutSeconds}}),invalidatesTags:["Folder"]}),getFolder:f.query({query:p=>({url:`/folders/${p.name}`,params:{pretty:p.pretty}}),providesTags:["Folder"]}),replaceFolder:f.mutation({query:p=>({url:`/folders/${p.name}`,method:"PUT",body:p.folder,params:{pretty:p.pretty,dryRun:p.dryRun,fieldManager:p.fieldManager,fieldValidation:p.fieldValidation}}),invalidatesTags:["Folder"]}),deleteFolder:f.mutation({query:p=>({url:`/folders/${p.name}`,method:"DELETE",params:{pretty:p.pretty,dryRun:p.dryRun,gracePeriodSeconds:p.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:p.ignoreStoreReadErrorWithClusterBreakingPotential,orphanDependents:p.orphanDependents,propagationPolicy:p.propagationPolicy}}),invalidatesTags:["Folder"]}),updateFolder:f.mutation({query:p=>({url:`/folders/${p.name}`,method:"PATCH",body:p.patch,params:{pretty:p.pretty,dryRun:p.dryRun,fieldManager:p.fieldManager,fieldValidation:p.fieldValidation,force:p.force}}),invalidatesTags:["Folder"]}),getFolderAccess:f.query({query:p=>({url:`/folders/${p.name}/access`}),providesTags:["Folder"]}),getFolderChildren:f.query({query:p=>({url:`/folders/${p.name}/children`}),providesTags:["Folder"]}),getFolderCounts:f.query({query:p=>({url:`/folders/${p.name}/counts`}),providesTags:["Folder"]}),getFolderParents:f.query({query:p=>({url:`/folders/${p.name}/parents`}),providesTags:["Folder"]})}),overrideExisting:!1}).enhanceEndpoints({}),{useGetFolderQuery:g}=l},58614:(te,R,e)=>{"use strict";e.d(R,{o3:()=>c,Dp:()=>v,Iq:()=>m,Uu:()=>y,o6:()=>h,Lv:()=>d});var n=e(68143),a=e(6890),s=e(64762),i=e(15130),r=e(85618),u=e(75816),o=e(73892);const l=(0,r.TP)("playlist.grafana.app","v0alpha1"),g=(0,u.xP)({reducerPath:"playlistAPIv0alpha1",baseQuery:(0,o.W)({baseURL:l}),endpoints:()=>({})}),f=["Playlist"],c=g.enhanceEndpoints({addTagTypes:f}).injectEndpoints({endpoints:E=>({listPlaylist:E.query({query:b=>({url:"/playlists",params:{pretty:b.pretty,allowWatchBookmarks:b.allowWatchBookmarks,continue:b.continue,fieldSelector:b.fieldSelector,labelSelector:b.labelSelector,limit:b.limit,resourceVersion:b.resourceVersion,resourceVersionMatch:b.resourceVersionMatch,sendInitialEvents:b.sendInitialEvents,timeoutSeconds:b.timeoutSeconds,watch:b.watch}}),providesTags:["Playlist"]}),createPlaylist:E.mutation({query:b=>({url:"/playlists",method:"POST",body:b.playlist,params:{pretty:b.pretty,dryRun:b.dryRun,fieldManager:b.fieldManager,fieldValidation:b.fieldValidation}}),invalidatesTags:["Playlist"]}),getPlaylist:E.query({query:b=>({url:`/playlists/${b.name}`,params:{pretty:b.pretty}}),providesTags:["Playlist"]}),replacePlaylist:E.mutation({query:b=>({url:`/playlists/${b.name}`,method:"PUT",body:b.playlist,params:{pretty:b.pretty,dryRun:b.dryRun,fieldManager:b.fieldManager,fieldValidation:b.fieldValidation}}),invalidatesTags:["Playlist"]}),deletePlaylist:E.mutation({query:b=>({url:`/playlists/${b.name}`,method:"DELETE",params:{pretty:b.pretty,dryRun:b.dryRun,gracePeriodSeconds:b.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:b.ignoreStoreReadErrorWithClusterBreakingPotential,orphanDependents:b.orphanDependents,propagationPolicy:b.propagationPolicy}}),invalidatesTags:["Playlist"]})}),overrideExisting:!1}).enhanceEndpoints({endpoints:{getPlaylist:{transformResponse:async E=>(await x(E.spec),E)},createPlaylist:E=>{const b=E.query;b&&(E.query=D=>{if(!D.playlist.metadata.name&&!D.playlist.metadata.generateName){const C=i.TP.user.login;D.playlist.metadata.generateName=C?C.slice(0,2):"g"}return b(D)}),E.onQueryStarted=async(D,{queryFulfilled:C,dispatch:P})=>{try{await C,P((0,a.dx)((0,s.tZ)("Playlist created")))}catch(M){(0,r.H4)(M,P,"Unable to create playlist")}}},replacePlaylist:{onQueryStarted:async(E,{queryFulfilled:b,dispatch:D})=>{try{await b,D((0,a.dx)((0,s.tZ)("Playlist updated")))}catch(C){(0,r.H4)(C,D,"Unable to update playlist")}}},deletePlaylist:{onQueryStarted:async(E,{queryFulfilled:b,dispatch:D})=>{try{await b,D((0,a.dx)((0,s.tZ)("Playlist deleted")))}catch(C){(0,r.H4)(C,D,"Unable to delete playlist")}}}}});async function x(E){if(E?.items){for(const b of E.items)if(b.type==="dashboard_by_id"){b.type="dashboard_by_uid";const D=await(0,n.AI)().get(`/api/dashboards/ids/${b.value}`);D?.length&&(b.value=D[0])}}}const{useCreatePlaylistMutation:v,useDeletePlaylistMutation:m,useGetPlaylistQuery:y,useListPlaylistQuery:h,useReplacePlaylistMutation:d}=c},64975:(te,R,e)=>{"use strict";e.d(R,{C:()=>i,F:()=>r});var n=e(75816),a=e(43173),s=e(73892);const i=`apis/provisioning.grafana.app/v0alpha1/namespaces/${a.$.namespace}`,r=(0,n.xP)({reducerPath:"provisioningAPIv0alpha1",baseQuery:(0,s.W)({baseURL:i}),endpoints:()=>({})})},33680:(te,R,e)=>{"use strict";e.d(R,{PP:()=>V,tj:()=>D,bS:()=>j,ZL:()=>x,L:()=>K,Qo:()=>C,So:()=>h,KA:()=>v,F9:()=>A,Bm:()=>d,Kw:()=>E,$j:()=>M,qC:()=>O,$9:()=>U,Sw:()=>m,nS:()=>B,c2:()=>S,v$:()=>N,L3:()=>f,Ih:()=>c,XM:()=>b,hD:()=>y});var n=e(92745),a=e(68143),s=e(6890),i=e(64762),r=e(54115);function u(z){return async function(H,{updateCachedData:Q,cacheDataLoaded:Z,cacheEntryRemoved:Y}){if(!H?.watch)return;const X=new r.ws({group:"provisioning.grafana.app",version:"v0alpha1",resource:z});let I=null;try{const ee=(await Z).data.metadata?.resourceVersion;I=X.watch({resourceVersion:ee}).subscribe(q=>{Q(ne=>{ne.items||(ne.items=[]);const se=ne.items.findIndex(oe=>oe.metadata?.name===q.object.metadata.name);q.type==="ADDED"&&se===-1?ne.items.push(q.object):q.type==="DELETED"&&se!==-1?ne.items.splice(se,1):se!==-1&&(ne.items[se]=q.object)})})}catch(J){console.error("Error in onCacheEntryAdded:",J)}await Y,I?.unsubscribe()}}var o=e(64975);const l=["Job","Repository","Provisioning"],g=o.F.enhanceEndpoints({addTagTypes:l}).injectEndpoints({endpoints:z=>({listJob:z.query({query:w=>({url:"/jobs",params:{allowWatchBookmarks:w.allowWatchBookmarks,continue:w.continue,fieldSelector:w.fieldSelector,labelSelector:w.labelSelector,limit:w.limit,pretty:w.pretty,resourceVersion:w.resourceVersion,resourceVersionMatch:w.resourceVersionMatch,sendInitialEvents:w.sendInitialEvents,timeoutSeconds:w.timeoutSeconds,watch:w.watch}}),providesTags:["Job"]}),getJob:z.query({query:w=>({url:`/jobs/${w.name}`,params:{pretty:w.pretty}}),providesTags:["Job"]}),listRepository:z.query({query:w=>({url:"/repositories",params:{pretty:w.pretty,allowWatchBookmarks:w.allowWatchBookmarks,continue:w.continue,fieldSelector:w.fieldSelector,labelSelector:w.labelSelector,limit:w.limit,resourceVersion:w.resourceVersion,resourceVersionMatch:w.resourceVersionMatch,sendInitialEvents:w.sendInitialEvents,timeoutSeconds:w.timeoutSeconds,watch:w.watch}}),providesTags:["Repository"]}),createRepository:z.mutation({query:w=>({url:"/repositories",method:"POST",body:w.repository,params:{pretty:w.pretty,dryRun:w.dryRun,fieldManager:w.fieldManager,fieldValidation:w.fieldValidation}}),invalidatesTags:["Repository"]}),deletecollectionRepository:z.mutation({query:w=>({url:"/repositories",method:"DELETE",params:{pretty:w.pretty,continue:w.continue,dryRun:w.dryRun,fieldSelector:w.fieldSelector,gracePeriodSeconds:w.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:w.ignoreStoreReadErrorWithClusterBreakingPotential,labelSelector:w.labelSelector,limit:w.limit,orphanDependents:w.orphanDependents,propagationPolicy:w.propagationPolicy,resourceVersion:w.resourceVersion,resourceVersionMatch:w.resourceVersionMatch,sendInitialEvents:w.sendInitialEvents,timeoutSeconds:w.timeoutSeconds}}),invalidatesTags:["Repository"]}),getRepository:z.query({query:w=>({url:`/repositories/${w.name}`,params:{pretty:w.pretty}}),providesTags:["Repository"]}),replaceRepository:z.mutation({query:w=>({url:`/repositories/${w.name}`,method:"PUT",body:w.repository,params:{pretty:w.pretty,dryRun:w.dryRun,fieldManager:w.fieldManager,fieldValidation:w.fieldValidation}}),invalidatesTags:["Repository"]}),deleteRepository:z.mutation({query:w=>({url:`/repositories/${w.name}`,method:"DELETE",params:{pretty:w.pretty,dryRun:w.dryRun,gracePeriodSeconds:w.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:w.ignoreStoreReadErrorWithClusterBreakingPotential,orphanDependents:w.orphanDependents,propagationPolicy:w.propagationPolicy}}),invalidatesTags:["Repository"]}),getRepositoryFiles:z.query({query:w=>({url:`/repositories/${w.name}/files/`,params:{ref:w.ref}}),providesTags:["Repository"]}),getRepositoryFilesWithPath:z.query({query:w=>({url:`/repositories/${w.name}/files/${w.path}`,params:{ref:w.ref}}),providesTags:["Repository"]}),replaceRepositoryFilesWithPath:z.mutation({query:w=>({url:`/repositories/${w.name}/files/${w.path}`,method:"PUT",body:w.body,params:{ref:w.ref,message:w.message,skipDryRun:w.skipDryRun}}),invalidatesTags:["Repository"]}),createRepositoryFilesWithPath:z.mutation({query:w=>({url:`/repositories/${w.name}/files/${w.path}`,method:"POST",body:w.body,params:{ref:w.ref,message:w.message,skipDryRun:w.skipDryRun}}),invalidatesTags:["Repository"]}),deleteRepositoryFilesWithPath:z.mutation({query:w=>({url:`/repositories/${w.name}/files/${w.path}`,method:"DELETE",params:{ref:w.ref,message:w.message,skipDryRun:w.skipDryRun}}),invalidatesTags:["Repository"]}),getRepositoryHistory:z.query({query:w=>({url:`/repositories/${w.name}/history`,params:{ref:w.ref}}),providesTags:["Repository"]}),getRepositoryHistoryWithPath:z.query({query:w=>({url:`/repositories/${w.name}/history/${w.path}`,params:{ref:w.ref}}),providesTags:["Repository"]}),getRepositoryJobs:z.query({query:w=>({url:`/repositories/${w.name}/jobs`}),providesTags:["Repository"]}),createRepositoryJobs:z.mutation({query:w=>({url:`/repositories/${w.name}/jobs`,method:"POST",body:w.jobSpec}),invalidatesTags:["Repository"]}),getRepositoryJobsWithPath:z.query({query:w=>({url:`/repositories/${w.name}/jobs/${w.uid}`}),providesTags:["Repository"]}),getRepositoryRenderWithPath:z.query({query:w=>({url:`/repositories/${w.name}/render/${w.guid}`}),providesTags:["Repository"]}),getRepositoryResources:z.query({query:w=>({url:`/repositories/${w.name}/resources`}),providesTags:["Repository"]}),getRepositoryStatus:z.query({query:w=>({url:`/repositories/${w.name}/status`,params:{pretty:w.pretty}}),providesTags:["Repository"]}),replaceRepositoryStatus:z.mutation({query:w=>({url:`/repositories/${w.name}/status`,method:"PUT",body:w.repository,params:{pretty:w.pretty,dryRun:w.dryRun,fieldManager:w.fieldManager,fieldValidation:w.fieldValidation}}),invalidatesTags:["Repository"]}),createRepositoryTest:z.mutation({query:w=>({url:`/repositories/${w.name}/test`,method:"POST",body:w.body}),invalidatesTags:["Repository"]}),getRepositoryWebhook:z.query({query:w=>({url:`/repositories/${w.name}/webhook`}),providesTags:["Repository"]}),createRepositoryWebhook:z.mutation({query:w=>({url:`/repositories/${w.name}/webhook`,method:"POST"}),invalidatesTags:["Repository"]}),getFrontendSettings:z.query({query:()=>({url:"/settings"}),providesTags:["Provisioning","Repository"]}),getResourceStats:z.query({query:()=>({url:"/stats"}),providesTags:["Provisioning","Repository"]})}),overrideExisting:!1}),{useListJobQuery:f,useGetJobQuery:p,useListRepositoryQuery:c,useCreateRepositoryMutation:x,useDeletecollectionRepositoryMutation:v,useGetRepositoryQuery:m,useReplaceRepositoryMutation:y,useDeleteRepositoryMutation:h,useGetRepositoryFilesQuery:d,useGetRepositoryFilesWithPathQuery:E,useReplaceRepositoryFilesWithPathMutation:b,useCreateRepositoryFilesWithPathMutation:D,useDeleteRepositoryFilesWithPathMutation:C,useGetRepositoryHistoryQuery:P,useGetRepositoryHistoryWithPathQuery:M,useGetRepositoryJobsQuery:O,useCreateRepositoryJobsMutation:j,useGetRepositoryJobsWithPathQuery:U,useGetRepositoryRenderWithPathQuery:W,useGetRepositoryResourcesQuery:B,useGetRepositoryStatusQuery:S,useReplaceRepositoryStatusMutation:_,useCreateRepositoryTestMutation:K,useGetRepositoryWebhookQuery:T,useCreateRepositoryWebhookMutation:L,useGetFrontendSettingsQuery:A,useGetResourceStatsQuery:N}=g,V=g.enhanceEndpoints({endpoints:{listJob:{query:({watch:z,...w})=>({url:"/jobs",params:w}),onCacheEntryAdded:u("jobs")},listRepository:{query:({watch:z,...w})=>({url:"/repositories",params:w}),onCacheEntryAdded:u("repositories")},deleteRepository:{onQueryStarted:async(z,{queryFulfilled:w,dispatch:H})=>{try{await w,H((0,s.dx)((0,i.tZ)((0,n.t)("provisioning.delete-repository-button.success-repository-deleted","Repository settings queued for deletion"))))}catch(Q){Q instanceof Error&&H((0,s.dx)((0,i.gi)((0,n.t)("provisioning.delete-repository-button.error-repository-delete","Failed to delete repository"),Q)))}}},deletecollectionRepository:{onQueryStarted:async(z,{queryFulfilled:w,dispatch:H})=>{try{await w,H((0,s.dx)((0,i.tZ)((0,n.t)("provisioning.home-page.success-all-repositories-deleted","All configured repositories deleted"))))}catch(Q){Q instanceof Error&&H((0,s.dx)((0,i.gi)((0,n.t)("provisioning.home-page.error-delete-all-repositories","Failed to delete all repositories"),Q)))}}},createRepositoryTest:{onQueryStarted:async(z,{queryFulfilled:w,dispatch:H})=>{try{await w}catch(Q){Q?Q instanceof Error?H((0,s.dx)((0,i.gi)("Error validating repository",Q))):typeof Q=="object"&&"error"in Q&&(0,a.NF)(Q.error)&&Array.isArray(Q.error.data.errors)&&Q.error.data.errors.length&&Q.error.data.errors.filter(Y=>!Y.field).length>0&&H((0,s.dx)((0,i.gi)("Error validating repository"))):H((0,s.dx)((0,i.gi)("Error validating repository",new Error("Unknown error"))))}}},createRepositoryJobs:{onQueryStarted:async(z,{queryFulfilled:w,dispatch:H})=>{try{await w,H((0,s.dx)((0,i.tZ)((0,n.t)("provisioning.sync-repository.success-pull-started","Pull started"))))}catch(Q){Q instanceof Error&&H((0,s.dx)((0,i.gi)((0,n.t)("provisioning.sync-repository.error-pulling-resources","Error pulling resources"),Q)))}}},createRepository:{onQueryStarted:async(z,{queryFulfilled:w,dispatch:H})=>{try{await w,H((0,s.dx)((0,i.tZ)((0,n.t)("provisioning.config-form.alert-repository-settings-saved","Repository settings saved"))))}catch(Q){Q instanceof Error&&H((0,s.dx)((0,i.gi)((0,n.t)("provisioning.config-form.error-save-repository","Failed to save repository settings"),Q)))}}},replaceRepository:{onQueryStarted:async(z,{queryFulfilled:w,dispatch:H})=>{try{await w,H((0,s.dx)((0,i.tZ)((0,n.t)("provisioning.config-form.alert-repository-settings-updated","Repository settings updated"))))}catch(Q){Q instanceof Error&&H((0,s.dx)((0,i.gi)((0,n.t)("provisioning.config-form.error-save-repository","Failed to save repository settings"),Q)))}}}}})},73892:(te,R,e)=>{"use strict";e.d(R,{W:()=>s,s:()=>i});var n=e(75505),a=e(68143);function s({baseURL:r}){async function u(o){try{const{data:l,...g}=await(0,n.s)((0,a.AI)().fetch({...o,url:r+o.url,showErrorAlert:o.showErrorAlert??!1,data:o.body}));return{data:l,meta:g}}catch(l){return o.manageError?o.manageError(l):i(l)}}return u}function i(r){return(0,a.NF)(r)||r instanceof Error?{error:r}:{error:new Error("Unknown error")}}},85618:(te,R,e)=>{"use strict";e.d(R,{Ge:()=>r,H4:()=>o,TP:()=>u});var n=e(43173),a=e(68143),s=e(6890),i=e(64762);const r=()=>n.$.namespace,u=(l,g)=>`/apis/${l}/${g}/namespaces/${r()}`,o=(l,g,f)=>{l?l instanceof Error?g((0,s.dx)((0,i.gi)(f,l))):typeof l=="object"&&"error"in l&&(l.error instanceof Error?g((0,s.dx)((0,i.gi)(f,l.error))):(0,a.NF)(l.error)&&Array.isArray(l.error.data.errors)&&l.error.data.errors.length&&g((0,s.dx)((0,i.gi)(f,l.error.data.errors.join(`
`))))):g((0,s.dx)((0,i.gi)(f,new Error("Unknown error"))))}},873:(te,R,e)=>{"use strict";e.d(R,{A:()=>s});var n=e(2543),a=e.n(n);class s{constructor(o){if(this.columns=[],this.columnMap={},this.rows=[],this.type="table",o){if(o.columns)for(const l of o.columns)this.addColumn(l);if(o.rows)for(const l of o.rows)this.addRow(l)}}sort(o){o.col===null||o.col===void 0||this.columns.length<=o.col||(this.rows.sort((l,g)=>(l=l[o.col],g=g[o.col],+(l==null)-+(g==null)||+(l>g)||-(l<g))),o.desc&&this.rows.reverse(),this.columns[o.col].sort=!0,this.columns[o.col].desc=o.desc)}addColumn(o){this.columnMap[o.text]||(this.columns.push(o),this.columnMap[o.text]=o)}addRow(o){this.rows.push(o)}}function i(u,o,l){let g=!1;for(let f=0;f<u.length;f++)if(o[f]!==void 0&&l[f]!==void 0){if(o[f]!==l[f])return!1}else(o[f]===void 0||l[f]===void 0)&&(g=!0);return g}function r(u,...o){const l=u||new s;if(arguments.length===1)return l;if(arguments.length===2)return l.columns=o[0].hasOwnProperty("columns")?[...o[0].columns]:[],l.rows=o[0].hasOwnProperty("rows")?[...o[0].rows]:[],l;const g=o.filter(y=>!!y.columns),f={},p=g.slice().reduce((y,h)=>(h.columns.forEach(d=>{const{text:E}=d;f[E]===void 0&&(f[E]=y.length,y.push(d))}),y),[]),c=g.map(y=>y.columns.map(h=>f[h.text])),x=g.reduce((y,h,d)=>{const E=c[d];return h.rows.forEach(b=>{const D=[];E.forEach((C,P)=>{D[C]=b[P]}),y.push(D)}),y},[]),v={},m=x.reduce((y,h,d)=>{if(!v[d]){let E=d+1;for(;E<x.length;){const b=findIndex(x,D=>i(p,h,D),E);if(b>-1){const D=x[b];for(let C=0;C<p.length;C++)h[C]===void 0&&D[C]!==void 0&&(h[C]=D[C]);v[b]=D,E=b+1}else break}y.push(h)}return y},[]);return l.columns=p,l.rows=m,l}},20018:(te,R,e)=>{"use strict";e.d(R,{N:()=>a});var n=e(65307);const a=(0,n.VP)("core/cleanUpState")},6890:(te,R,e)=>{"use strict";e.d(R,{Do:()=>n.Do,Vz:()=>a.Vz,YA:()=>a.YA,dx:()=>n.dx});var n=e(12066),a=e(43550)},54384:(te,R,e)=>{"use strict";e.d(R,{x:()=>N});var n=e(74848),a=e(22803),s=e(2543),i=e(96540),r=e(92745),u=e(63142),o=e(31286),l=e(66404),g=e(45861),f=e(63722),p=e(83873),c=e(78059),x=e(90382),v=e(41654),m=e(18857),y=e(15840),h=e(76459),d=e.n(h),E=e(68143);class b extends i.Component{constructor(I){super(I),this.search=d()(async J=>(this.setState({isLoading:!0}),(0,s.isNil)(J)&&(J=""),(0,E.AI)().get(`/api/serviceaccounts/search?query=${J}&perpage=100`).then(ee=>ee.serviceAccounts.map(q=>({id:q.id,uid:q.uid,value:q,label:q.login,imgUrl:q.avatarUrl,login:q.login}))).finally(()=>{this.setState({isLoading:!1})})),300,{leading:!0}),this.state={isLoading:!1}}render(){const{className:I,onSelected:J,inputId:ee}=this.props,{isLoading:q}=this.state;return(0,n.jsx)("div",{className:"service-account-picker","data-testid":"serviceAccountPicker",children:(0,n.jsx)(m.DW,{isClearable:!0,className:I,inputId:ee,isLoading:q,defaultOptions:!0,loadOptions:this.search,onChange:J,placeholder:(0,r.t)("service-account-picker.select-placeholder","Start typing to search for service accounts"),noOptionsMessage:(0,r.t)("service-account-picker.noOptionsMessage-no-service-accounts-found","No service accounts found"),"aria-label":(0,r.t)("service-account-picker.select-aria-label","Service account picker")})})}}class D extends i.Component{constructor(I){super(I),this.search=d()(async J=>(this.setState({isLoading:!0}),(0,s.isNil)(J)&&(J=""),(0,E.AI)().get(`/api/teams/search?perpage=100&page=1&query=${J}`).then(ee=>{const q=ee.teams.map(ne=>({value:ne,label:ne.name,imgUrl:ne.avatarUrl}));return this.setState({isLoading:!1}),q})),300,{leading:!0}),this.state={isLoading:!1}}componentDidMount(){const{teamId:I}=this.props;I&&(0,E.AI)().get(`/api/teams/${I}`).then(J=>{this.setState({value:{value:J,label:J.name,imgUrl:J.avatarUrl}})})}render(){const{onSelected:I,className:J}=this.props,{isLoading:ee,value:q}=this.state;return(0,n.jsx)("div",{className:"user-picker","data-testid":"teamPicker",children:(0,n.jsx)(m.DW,{isLoading:ee,defaultOptions:!0,loadOptions:this.search,value:q,onChange:I,className:J,placeholder:(0,r.t)("team-picker.select-placeholder","Select a team"),noOptionsMessage:(0,r.t)("team-picker.noOptionsMessage-no-teams-found","No teams found"),"aria-label":(0,r.t)("team-picker.select-aria-label","Team picker")})})}}class C extends i.Component{constructor(I){super(I),this.search=d()(async J=>(this.setState({isLoading:!0}),(0,s.isNil)(J)&&(J=""),(0,E.AI)().get(`/api/org/users/lookup?query=${J}&limit=100`).then(ee=>ee.map(q=>({id:q.userId,uid:q.uid,value:q,label:q.login,imgUrl:q.avatarUrl,login:q.login}))).finally(()=>{this.setState({isLoading:!1})})),300,{leading:!0}),this.state={isLoading:!1}}render(){const{className:I,onSelected:J,inputId:ee}=this.props,{isLoading:q}=this.state;return(0,n.jsx)("div",{className:"user-picker","data-testid":"userPicker",children:(0,n.jsx)(m.DW,{isClearable:!0,className:I,inputId:ee,isLoading:q,defaultOptions:!0,loadOptions:this.search,onChange:J,placeholder:(0,r.t)("user-picker.select-placeholder","Start typing to search for user"),noOptionsMessage:(0,r.t)("user-picker.noOptionsMessage-no-users-found","No users found"),"aria-label":(0,r.t)("user-picker.select-aria-label","User picker")})})}}var P=(X=>(X.None="None",X.Team="Team",X.User="User",X.ServiceAccount="ServiceAccount",X.BuiltInRole="builtInRole",X))(P||{});const M=({title:X=(0,r.t)("access-control.add-permission.title","Add permission for"),permissions:I,assignments:J,onAdd:ee,onCancel:q})=>{const[ne,se]=(0,i.useState)(P.None),[oe,de]=(0,i.useState)(""),[fe,ae]=(0,i.useState)(""),[ce,ie]=(0,i.useState)(""),[ve,le]=(0,i.useState)(""),Ee=(0,i.useMemo)(()=>{const Oe=[];return J.users&&Oe.push({value:P.User,label:(0,r.t)("access-control.add-permission.user-label","User")}),J.serviceAccounts&&Oe.push({value:P.ServiceAccount,label:(0,r.t)("access-control.add-permission.serviceaccount-label","Service Account")}),J.teams&&Oe.push({value:P.Team,label:(0,r.t)("access-control.add-permission.team-label","Team")}),J.builtInRoles&&Oe.push({value:P.BuiltInRole,label:(0,r.t)("access-control.add-permission.role-label","Role")}),Oe},[J]);(0,i.useEffect)(()=>{I.length>0&&le(I[0])},[I]);const Re=()=>ne===P.Team&&oe||ne===P.User&&fe||ne===P.ServiceAccount&&fe||P.BuiltInRole&&x.X.hasOwnProperty(ce);return(0,n.jsxs)("div",{className:"cta-form","aria-label":(0,r.t)("access-control.add-permission.permissions-aria-label","Permissions slider"),children:[(0,n.jsx)(y.J,{onClick:q}),(0,n.jsx)("h5",{children:X}),(0,n.jsx)("form",{name:"addPermission",onSubmit:Oe=>{Oe.preventDefault(),ee({userUid:fe,teamUid:oe,builtInRole:ce,permission:ve,target:ne})},children:(0,n.jsxs)(v.B,{gap:1,direction:"row",children:[(0,n.jsx)(m.l6,{"aria-label":(0,r.t)("access-control.add-permission.role-select-aria-label","Role to add new permission to"),value:ne,options:Ee,onChange:Oe=>se(Oe.value),disabled:Ee.length===0,width:"auto"}),ne===P.User&&(0,n.jsx)(C,{onSelected:Oe=>ae(Oe?.value?.uid||"")}),ne===P.ServiceAccount&&(0,n.jsx)(b,{onSelected:Oe=>ae(Oe?.value?.uid||"")}),ne===P.Team&&(0,n.jsx)(D,{onSelected:Oe=>de(Oe.value?.uid||"")}),ne===P.BuiltInRole&&(0,n.jsx)(m.l6,{"aria-label":(0,r.t)("access-control.add-permission.built-in-aria-label","Built-in role picker"),options:Object.values(x.X).filter(Oe=>Oe!==x.X.None).map(Oe=>({value:Oe,label:Oe})),onChange:Oe=>ie(Oe.value||""),width:"auto"}),(0,n.jsx)(m.l6,{"aria-label":(0,r.t)("access-control.add-permission.level-aria-label","Permission level"),width:"auto",value:I.find(Oe=>Oe===ve),options:I.map(Oe=>({label:Oe,value:Oe})),onChange:Oe=>le(Oe.value||"")}),(0,n.jsx)(g.$n,{type:"submit",disabled:!Re(),children:(0,n.jsx)(r.x6,{i18nKey:"access-control.add-permissions.save",children:"Save"})})]})})]})};var O=e(45967),j=e(30703);const U=({item:X,permissionLevels:I,canSet:J,onRemove:ee,onChange:q})=>{const ne=(0,u.of)(K);return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:W(X)}),(0,n.jsx)("td",{children:S(X)}),(0,n.jsx)("td",{children:X.isInherited&&(0,n.jsx)("em",{className:ne.inherited,children:(0,n.jsx)(r.x6,{i18nKey:"access-control.permission-list-item.inherited",children:"Inherited from folder"})})}),(0,n.jsx)("td",{children:(0,n.jsx)(m.l6,{disabled:!J||!X.isManaged,onChange:se=>q(X,se.value),value:I.find(se=>se===X.permission),options:I.map(se=>({value:se,label:se}))})}),(0,n.jsx)("td",{children:X.warning?(0,n.jsx)(O.m,{content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.a,{marginBottom:1,children:X.warning}),_(X)]}),children:(0,n.jsx)(j.I,{name:"exclamation-triangle",className:ne.warning})}):(0,n.jsx)(O.m,{content:_(X),children:(0,n.jsx)(j.I,{name:"info-circle"})})}),(0,n.jsx)("td",{children:X.isManaged?(0,n.jsx)(g.$n,{size:"sm",icon:"times",variant:"destructive",disabled:!J,onClick:()=>ee(X),"aria-label":(0,r.t)("access-control.permission-list-item.remove-aria-label","Remove permission for {{identifier}}",{identifier:B(X)})}):(0,n.jsx)(O.m,{content:X.isInherited?(0,r.t)("access-control.permission-list-item.tooltip-inherited-permission","Inherited permission"):(0,r.t)("access-control.permission-list-item.tooltip-provisioned-permission","Provisioned permission"),children:(0,n.jsx)(g.$n,{size:"sm",icon:"lock","aria-label":(0,r.t)("access-control.permission-list-item.locked-aria-label","Locked permission indicator")})})})]})},W=X=>X.teamId?(0,n.jsx)("img",{className:"filter-table__avatar",src:X.teamAvatarUrl,alt:`Avatar for team ${X.teamId}`}):X.userId?(0,n.jsx)("img",{className:"filter-table__avatar",src:X.userAvatarUrl,alt:`Avatar for user ${X.userId}`}):(0,n.jsx)(j.I,{size:"xl",name:"shield"}),B=X=>X.userId?X.userLogin:X.teamId?X.team:X.builtInRole,S=X=>X.userId?(0,n.jsxs)("span",{children:[X.userLogin," "]},"name"):X.teamId?(0,n.jsxs)("span",{children:[X.team," "]},"name"):X.builtInRole?(0,n.jsxs)("span",{children:[X.builtInRole," "]},"name"):(0,n.jsx)("span",{},"name"),_=X=>`Actions: ${[...new Set(X.actions)].sort().join(" ")}`,K=X=>({warning:(0,a.css)({color:X.colors.warning.main}),inherited:(0,a.css)({color:X.colors.text.secondary,flexWrap:"nowrap"})}),T=({title:X,items:I,compareKey:J,permissionLevels:ee,canSet:q,onRemove:ne,onChange:se})=>{const oe=(0,i.useMemo)(()=>{const de={};for(let fe of I){const ae=fe[J];if(!de[ae]){de[ae]=fe;continue}if(fe.actions.length>de[ae].actions.length){de[ae]=fe;continue}fe.actions.length===de[ae].actions.length&&de[ae].isManaged&&!fe.isManaged&&(de[ae]=fe)}return Object.keys(de).map(fe=>de[fe])},[I,J]);return oe.length===0?null:(0,n.jsx)("div",{children:(0,n.jsxs)("table",{className:"filter-table gf-form-group",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{style:{width:"1%"}}),(0,n.jsx)("th",{children:X}),(0,n.jsx)("th",{style:{width:"1%"}}),(0,n.jsx)("th",{style:{width:"40%"},children:(0,n.jsx)(r.x6,{i18nKey:"access-control.permission-list.permission",children:"Permission"})}),(0,n.jsx)("th",{style:{width:"1%"}}),(0,n.jsx)("th",{style:{width:"1%"}})]})}),(0,n.jsx)("tbody",{children:oe.map((de,fe)=>(0,n.jsx)(U,{item:de,onRemove:ne,onChange:se,canSet:q,permissionLevels:ee},`${fe}-${de.userId}`))})]})})},L="",A={permissions:[],assignments:{teams:!1,users:!1,serviceAccounts:!1,builtInRoles:!1}},N=({title:X=(0,r.t)("access-control.permissions.title","Permissions"),buttonLabel:I=(0,r.t)("access-control.permissions.add-label","Add a permission"),emptyLabel:J=(0,r.t)("access-control.permissions.no-permissions","There are no permissions"),resource:ee,resourceId:q,canSetPermissions:ne,addPermissionTitle:se,getWarnings:oe,epilogue:de})=>{const fe=(0,u.of)(Y),[ae,ce]=(0,i.useState)(!1),[ie,ve]=(0,i.useState)([]),[le,Ee]=(0,i.useState)(A),Re=(0,i.useCallback)(async()=>{let Ke=await z(ee,q);oe&&(Ke=oe(Ke)),ve(Ke)},[ee,q,oe]);(0,i.useEffect)(()=>{V(ee).then(Ke=>(Ee(Ke),Re()))},[ee,q,Re]);const Oe=Ke=>{let Ue=null;Ke.target===P.User||Ke.target===P.ServiceAccount?Ue=w(ee,q,Ke.userUid,Ke.permission):Ke.target===P.Team?Ue=H(ee,q,Ke.teamUid,Ke.permission):Ke.target===P.BuiltInRole&&(Ue=Q(ee,q,Ke.builtInRole,Ke.permission)),Ue!==null&&Ue.then(Re)},Se=Ke=>{let Ue=null;Ke.userUid?Ue=w(ee,q,Ke.userUid,L):Ke.teamUid?Ue=H(ee,q,Ke.teamUid,L):Ke.builtInRole&&(Ue=Q(ee,q,Ke.builtInRole,L)),Ue!==null&&Ue.then(Re)},Te=(Ke,Ue)=>{console.log("onChange",Ke,Ue),Ke.permission!==Ue&&(Ke.userUid||Ke.isServiceAccount?Oe({permission:Ue,userUid:Ke.userUid,target:P.User}):Ke.teamUid?Oe({permission:Ue,teamUid:Ke.teamUid,target:P.Team}):Ke.builtInRole&&Oe({permission:Ue,builtInRole:Ke.builtInRole,target:P.BuiltInRole}))},_e=(0,i.useMemo)(()=>(0,s.sortBy)(ie.filter(Ke=>Ke.teamId),["team","isManaged"]),[ie]),He=(0,i.useMemo)(()=>(0,s.sortBy)(ie.filter(Ke=>Ke.userId&&!Ke.isServiceAccount),["userLogin","isManaged"]),[ie]),tt=(0,i.useMemo)(()=>(0,s.sortBy)(ie.filter(Ke=>Ke.userId&&Ke.isServiceAccount),["userLogin","isManaged"]),[ie]),Je=(0,i.useMemo)(()=>(0,s.sortBy)(ie.filter(Ke=>Ke.builtInRole),["builtInRole","isManaged"]),[ie]),Ge=(0,r.t)("access-control.permissions.role","Role"),je=(0,r.t)("access-control.permissions.user","User"),Fe=(0,r.t)("access-control.permissions.serviceaccount","Service Account"),Be=(0,r.t)("access-control.permissions.team","Team");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[ne&&ee==="folders"&&(0,n.jsxs)(o.a,{paddingBottom:2,children:[(0,n.jsx)(r.x6,{i18nKey:"access-control.permissions.permissions-change-warning",children:"This will change permissions for this folder and all its descendants. In total, this will affect:"}),(0,n.jsx)(c.x,{selectedItems:{folder:{[q]:!0},dashboard:{},panel:{},$all:!1}})]}),ie.length===0&&(0,n.jsx)(o.a,{children:(0,n.jsx)(l.E,{children:J})}),(0,n.jsx)(T,{title:Ge,items:Je,compareKey:"builtInRole",permissionLevels:le.permissions,onChange:Te,onRemove:Se,canSet:ne}),(0,n.jsx)(T,{title:je,items:He,compareKey:"userLogin",permissionLevels:le.permissions,onChange:Te,onRemove:Se,canSet:ne}),(0,n.jsx)(T,{title:Fe,items:tt,compareKey:"userLogin",permissionLevels:le.permissions,onChange:Te,onRemove:Se,canSet:ne}),(0,n.jsx)(T,{title:Be,items:_e,compareKey:"team",permissionLevels:le.permissions,onChange:Te,onRemove:Se,canSet:ne}),ne&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.$n,{className:fe.addPermissionButton,variant:"primary",onClick:()=>ce(!0),icon:"plus",children:I},"add-permission"),(0,n.jsx)(f.a,{in:ae,children:(0,n.jsx)(M,{title:se,onAdd:Oe,permissions:le.permissions,assignments:le.assignments,onCancel:()=>ce(!1)})})]})]}),de&&de(ie)]})},V=async X=>{try{return await(0,p.AI)().get(`/api/access-control/${X}/description`)}catch(I){return console.error("failed to load resource description: ",I),A}},z=(X,I)=>(0,p.AI)().get(`/api/access-control/${X}/${I}`),w=(X,I,J,ee)=>Z(X,I,"users",J,ee),H=(X,I,J,ee)=>Z(X,I,"teams",J,ee),Q=(X,I,J,ee)=>Z(X,I,"builtInRoles",J,ee),Z=(X,I,J,ee,q)=>(0,p.AI)().post(`/api/access-control/${X}/${I}/${J}/${ee}`,{permission:q}),Y=X=>({breakdown:(0,a.css)({...X.typography.bodySmall,color:X.colors.text.secondary,marginBottom:X.spacing(2)}),addPermissionButton:(0,a.css)({marginBottom:X.spacing(2)})})},63722:(te,R,e)=>{"use strict";e.d(R,{a:()=>o});var n=e(74848),a=e(96540),s=e(22669);const i="200px",r=200,u={transition:`max-height ${r}ms ease-in-out`,overflow:"hidden"},o=({children:l,in:g,maxHeight:f=i,style:p=u})=>{const c=(0,a.useRef)(null),x={exited:{maxHeight:0},entering:{maxHeight:f},entered:{maxHeight:"unset",overflow:"visible"},exiting:{maxHeight:0}};return(0,n.jsx)(s.Ay,{in:g,timeout:r,nodeRef:c,children:v=>(0,n.jsx)("div",{style:{...p,...x[v]},ref:c,children:l})})}},43707:(te,R,e)=>{"use strict";e.d(R,{H:()=>s});var n=e(96540),a=e(27963);const s=n.memo(({actions:i,breadcrumbActions:r})=>{const{chrome:u}=(0,a.Il)();return(0,n.useLayoutEffect)(()=>()=>{u.update({actions:void 0,breadcrumbActions:void 0})},[u]),(0,n.useLayoutEffect)(()=>{u.update({actions:i,breadcrumbActions:r})}),null});s.displayName="TopNavUpdate"},92270:(te,R,e)=>{"use strict";e.d(R,{EE:()=>g,T0:()=>l,nf:()=>o,yq:()=>u});var n=e(74848),a=e(22803),s=e(33604),i=e(63142),r=e(58449);const u=300,o=100,l=Math.floor(window.innerWidth*(2/3));function g(){const p=f((0,i.$j)()),{dockedComponentId:c,isEnabled:x,props:v={}}=(0,r.sA)(),{components:m,isLoading:y}=(0,s.f)({extensionPointId:r.up});if(y||!c||!x)return null;const h=(0,r.rS)(c);if(!h)return null;const d=m.find(E=>E.meta.pluginId===h.pluginId&&E.meta.title===h.componentTitle);return d?(0,n.jsx)("div",{className:p.sidebarWrapper,children:(0,n.jsx)("div",{className:p.content,children:(0,n.jsx)(d,{...v})})}):null}const f=p=>({sidebarWrapper:(0,a.css)({backgroundColor:p.colors.background.primary,borderLeft:`1px solid ${p.colors.border.weak}`,display:"flex",flexDirection:"column",gap:p.spacing(1),padding:p.spacing(1),width:"100%",height:"100%",overflow:"auto"}),content:(0,a.css)({flex:1,minHeight:0})})},58449:(te,R,e)=>{"use strict";e.d(R,{kn:()=>E,pF:()=>b,rS:()=>D,sA:()=>d,up:()=>x});var n=e(74848),a=e(96540),s=e(78685),i=e(78012),r=e(43173),u=e(36490),o=e(46907),l=e(75234),g=e(27489),f=e(3260),p=e(87745),c=e(92270);const x="grafana/extension-sidebar/v0-alpha",v="grafana.navigation.extensionSidebarDocked",m="grafana.navigation.extensionSidebarWidth",y=["grafana-investigations-app","grafana-assistant-app","grafana-dash-app","grafana-grafanadocsplugin-app"],h=(0,a.createContext)({isEnabled:!!r.$.featureToggles.extensionSidebar,isOpen:!1,dockedComponentId:void 0,setDockedComponentId:()=>{},availableComponents:new Map,extensionSidebarWidth:c.yq,setExtensionSidebarWidth:()=>{}});function d(){return(0,a.useContext)(h)}const E=({children:C})=>{const[P,M]=(0,a.useState)(void 0),O=i.M.get(v),[j,U]=(0,s.A)(m,c.yq),[W,B]=(0,a.useState)(u.Ny.getLocation().pathname);(0,a.useEffect)(()=>{const z=u.Ny.getLocationObservable().subscribe(w=>{B(w.pathname)});return()=>{z.unsubscribe()}},[]);const{links:S,isLoading:_}=(0,o.U)({extensionPointId:x,context:{path:W}}),K=!!r.$.featureToggles.extensionSidebar,T=(0,a.useMemo)(()=>K?new Map(Array.from((0,f.UX)(x).entries()).filter(([z,w])=>y.includes(z)&&S.some(H=>H.pluginId===z&&w.addedComponents.some(Q=>Q.title===H.title)))):new Map,[K,S]);let L;O&&D(O)&&(L=O);const[A,N]=(0,a.useState)(L);(0,a.useEffect)(()=>{if(!_&&A){const z=D(A);if(z){const w=T.get(z.pluginId);(!w||!w.addedComponents.some(H=>H.title===z.componentTitle))&&N(void 0)}else N(void 0)}},[_,T,A]);const V=(0,a.useCallback)((z,w)=>{M(w),N(z)},[N]);return(0,a.useEffect)(()=>{if(!K)return;const z=H=>{H.payload.pluginId&&H.payload.componentTitle&&y.includes(H.payload.pluginId)&&V(JSON.stringify({pluginId:H.payload.pluginId,componentTitle:H.payload.componentTitle}),H.payload.props)},w=(0,l.J7)().subscribe(p.Am,z);return()=>{w.unsubscribe()}},[K,V]),(0,a.useEffect)(()=>{if(_)return;const z=D(A??""),w=i.M.get(v),H=D(w??""),Q=A!==void 0;(Q||H)&&(0,g.rR)("grafana_extension_sidebar_changed",{opened:Q,componentTitle:(Q?z:H)?.componentTitle,pluginId:(Q?z:H)?.pluginId,fromLocalstorage:w===A}),A?i.M.set(v,A):i.M.delete(v)},[A,_]),(0,n.jsx)(h.Provider,{value:{isEnabled:K,isOpen:K&&A!==void 0,dockedComponentId:A,setDockedComponentId:z=>V(z,void 0),availableComponents:T,extensionSidebarWidth:j??c.yq,setExtensionSidebarWidth:U,props:P},children:C})};function b(C,P){return JSON.stringify({pluginId:C,componentTitle:P.title})}function D(C){try{const P=JSON.parse(C);return typeof P=="object"&&P!==null&&"pluginId"in P&&"componentTitle"in P&&typeof P.pluginId=="string"&&typeof P.componentTitle=="string"?P:void 0}catch{return}}},89409:(te,R,e)=>{"use strict";e.d(R,{t3:()=>P,iL:()=>M,fn:()=>O});var n=e(74848),a=e(22803),s=e(92745),i=e(63142),r=e(41654),u=e(7895),o=e(76319),l=e(27963),g=e(92948),f=e(96540),p=e(36490),c=e(35137),x=e(66404),v=e(15130),m=e(93922),y=e(52763),h=e(18857),d=e(30703);function E({orgs:U,onSelectChange:W}){const B=(0,i.of)(b),{orgId:S}=v.TP.user,_=(0,f.useMemo)(()=>U.map(N=>({label:N.name,description:N.role,value:N})),[U]),K=(0,f.useMemo)(()=>_.find(N=>N.value.orgId===S),[_,S]),[T,L]=(0,f.useState)(()=>K),A=N=>{L(N),W(N)};return(0,n.jsx)(h.l6,{"aria-label":(0,s.t)("navigation.org-switcher.aria-label","Change organization"),width:"auto",value:T,prefix:(0,n.jsx)(d.I,{className:"prefix-icon",name:"building"}),className:B.select,options:_,onChange:A})}const b=U=>({select:(0,a.css)({border:"none",background:"none",color:U.colors.text.secondary,"&:hover":{color:U.colors.text.primary,"& .prefix-icon":(0,a.css)({color:U.colors.text.primary})}})});function D(){const U=(0,y.wA)(),W=(0,y.d4)(S=>S.organization.userOrgs),B=S=>{S.value&&((0,m.bA)(S.value.orgId),p.Ny.push(`/?orgId=${S.value.orgId}`),window.location.reload())};return(0,f.useEffect)(()=>{v.TP.isSignedIn&&!(v.TP.user.authenticatedBy==="apikey"||v.TP.user.authenticatedBy==="render")&&U((0,m.wV)())},[U]),W?.length<=1?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.$,{h:1}),(0,n.jsx)(x.E,{truncate:!0,children:g.M.AppTitle})]}):(0,n.jsx)(E,{orgs:W,onSelectChange:B})}var C=e(31937);const P="dock-menu-button",M="mega-menu-header-toggle";function O({handleMegaMenu:U,handleDockedMenu:W,onClose:B}){const S=(0,i.$j)(),{chrome:_}=(0,l.Il)(),K=_.useState(),T=j(S);return(0,n.jsxs)("div",{className:T.header,children:[(0,n.jsxs)(r.B,{alignItems:"center",minWidth:0,gap:.25,children:[(0,n.jsx)(u.I,{narrow:!0,id:M,onClick:U,tooltip:(0,s.t)("navigation.megamenu.close","Close menu"),children:(0,n.jsx)(g.M.MenuLogo,{className:T.img})}),(0,n.jsx)(D,{})]}),(0,n.jsx)(o.K,{id:P,className:T.dockMenuButton,tooltip:K.megaMenuDocked?(0,s.t)("navigation.megamenu.undock","Undock menu"):(0,s.t)("navigation.megamenu.dock","Dock menu"),name:"web-section-alt",onClick:W,variant:"secondary"}),(0,n.jsx)(o.K,{className:T.mobileCloseButton,tooltip:(0,s.t)("navigation.megamenu.close","Close menu"),name:"times",onClick:B,size:"xl",variant:"secondary"})]})}O.displayName="MegaMenuHeader";const j=U=>({dockMenuButton:(0,a.css)({display:"none",[U.breakpoints.up("xl")]:{display:"inline-flex"}}),header:(0,a.css)({alignItems:"center",borderBottom:`1px solid ${U.colors.border.weak}`,display:"flex",gap:U.spacing(1),justifyContent:"space-between",padding:U.spacing(0,1,0,.75),height:(0,C.vn)(),flexShrink:0}),img:(0,a.css)({alignSelf:"center",height:U.spacing(3),width:U.spacing(3)}),mobileCloseButton:(0,a.css)({[U.breakpoints.up("md")]:{display:"none"}})})},5071:(te,R,e)=>{"use strict";e.d(R,{s:()=>i});var n=e(96540),a=e(43173),s=e(1492);const i=()=>{const r=(0,s.Pj)(void 0,{skip:!a.$.bootData.user.isSignedIn}),u=(0,n.useMemo)(()=>r.data?.navbar?.bookmarkUrls||[],[r]);return a.$.featureToggles.pinNavItems?u:[]}},30362:(te,R,e)=>{"use strict";e.d(R,{A6:()=>m,CS:()=>c,J0:()=>x,Wk:()=>h,m0:()=>v,n0:()=>d});var n=e(96540),a=e(92745),s=e(27489),i=e(43173),r=e(95943),u=e(43550),o=e(87745),l=e(45229),g=e(10388),f=e(47981),p=e(89409);const c=E=>{let b=E.children||[];if(E.id==="help"){const D=()=>{l.A.publish(new o.S8({component:f.N}))};E.children=[...b,...(0,g.Dd)(),...y(),{id:"keyboard-shortcuts",text:(0,a.t)("nav.help/keyboard-shortcuts","Keyboard shortcuts"),icon:"keyboard",onClick:D}]}return E},x=(E,b,D=!1)=>{const C={...E},P=C.onClick;let M;return C.isNew?M="item":D&&(M="ancestor"),C.onClick=()=>{(0,s.rR)("grafana_navigation_item_clicked",{path:C.url??C.id,menuIsDocked:b,itemIsBookmarked:!!(i.$.featureToggles.pinNavItems&&C?.parentItem?.id==="bookmarks"),bookmarkToggleOn:!!i.$.featureToggles.pinNavItems,isNew:M}),P?.()},C.children&&(C.children=C.children.map(O=>x(O,b,M!==void 0))),C},v=(E,b)=>!!E.children?.some(D=>D===b?!0:v(D,b)),m=(E,b,D)=>{const{id:C,parentItem:P}=b;if(D==="/")return E.find(O=>O.id===u.Id);if(b.id==="profile")return;for(const O of E){const j=!!(O.id&&O.id===C),U=O.text===b.text&&O.url===b.url;if(j||U)return O;if(O.children){const W=m(O.children,b);if(W)return W}}const M=E[0]?.parentItem?.id==="bookmarks";if(P&&!M)return m(E,P)};function y(){const{buildInfo:E,licenseInfo:b}=i.$,D=b.stateInfo?` (${b.stateInfo})`:"",C=[];return C.push({target:"_blank",id:"version",text:`${E.edition}${D}`,url:b.licenseUrl,icon:"external-link-alt"}),E.hasUpdate&&C.push({target:"_blank",id:"updateVersion",text:"New version available!",icon:"download-alt",url:"https://grafana.com/grafana/download?utm_source=grafana_footer"}),C}function h(E,b){for(const D of E){if(D.url===b)return D;if(D.children?.length){const C=h(D.children,b);if(C)return C}}return null}function d(E,b){(0,n.useEffect)(()=>{E?document.getElementById(p.iL)?.focus():document.getElementById(r.Ut)?.focus()},[E]),(0,n.useEffect)(()=>{b?document.getElementById(p.t3)?.focus():document.getElementById(r.Ut)?.focus()},[b])}},5423:(te,R,e)=>{"use strict";e.d(R,{K:()=>i});var n=e(74848),a=e(22803),s=e(63142);function i({className:u,leftActionsSeparator:o}){const l=(0,s.of)(r);return o?(0,n.jsx)("div",{className:(0,a.cx)(u,l.leftActionsSeparator)}):(0,n.jsx)("div",{className:(0,a.cx)(u,l.line)})}const r=u=>({leftActionsSeparator:(0,a.css)({display:"flex",flexGrow:1}),line:(0,a.css)({width:1,backgroundColor:u.colors.border.medium,height:24,flexShrink:0,flexGrow:0,[u.breakpoints.down("sm")]:{display:"none"}})})},31937:(te,R,e)=>{"use strict";e.d(R,{UH:()=>o,k9:()=>g,vn:()=>f});var n=e(96540),a=e(69896),s=e(43173),i=e(27963),r=e(51702),u=e(58449);function o(){const{chrome:p}=(0,i.Il)(),c=p.state.getValue(),x=(0,a.b)(),v=(0,r.i)("xl"),[m,y]=(0,n.useState)(l(c,x?.state.enabled,v));return(0,n.useEffect)(()=>{const h=p.state.subscribe(d=>{const E=l(d,x?.state.enabled,v);E!==m&&y(E)});return()=>h.unsubscribe()},[p,m,x,v]),m}function l(p,c=!1,x){return p.kioskMode||p.chromeless?0:c?2:p.actions?p.megaMenuDocked||!s.$.featureToggles.dashboardScene?2:x&&s.$.featureToggles.unifiedNavbars?1:2:1}function g(){const p=o(),{isOpen:c}=(0,u.sA)();return c?0:p*f()}function f(){return 40}},92948:(te,R,e)=>{"use strict";e.d(R,{M:()=>c});var n=e(74848),a=e(22803),s=e(6773),i=e(63142),r=e(11701),u=e(53459),o=e(42581);const l=({className:x,logo:v})=>(0,n.jsx)("img",{className:x,src:`${v||o}`,alt:"Grafana"}),g=({className:x,children:v})=>{const m=(0,i.$j)(),y=(0,a.css)({"&:before":{content:'""',position:"fixed",left:0,right:0,bottom:0,top:0,background:`url(${m.isDark?r:u})`,backgroundPosition:"top center",backgroundSize:"auto",backgroundRepeat:"no-repeat",opacity:0,transition:"opacity 3s ease-in-out",[m.breakpoints.up("md")]:{backgroundPosition:"center",backgroundSize:"cover"}}});return(0,n.jsx)("div",{className:(0,a.cx)(y,x),children:v})},f=({className:x})=>(0,n.jsx)("img",{className:x,src:o,alt:"Grafana"}),p=()=>{const x=(0,i.$j)();return(0,a.css)({background:s.MV.alpha(x.colors.background.primary,.7),backgroundSize:"cover"})};class c{static{this.LoginLogo=l}static{this.LoginBackground=g}static{this.MenuLogo=f}static{this.LoginBoxBackground=p}static{this.AppTitle="DanePlus - APISystems"}static{this.LoginTitle="APISystems"}static{this.HideEdition=!1}static{this.GetLoginSubTitle=()=>null}}},18607:(te,R,e)=>{"use strict";e.d(R,{Z:()=>n});function n(a,s,i,r){const u=[];let o=!1,l;function g(f,p=!1){if(o)return;const c=f.url?.split("?")??["",""];let x=c[0];const v=new URLSearchParams(c[1]);if(v.has("editview")&&(x+=`?editview=${v.get("editview")}`),i&&x===i.url){r||u.unshift({text:i.text,href:f.url??""}),o=!0;return}const m=x.length>0&&l===x;if(l=x,!f.hideFromBreadcrumbs&&!(p&&m)){const h=f.children?.findIndex(d=>d.active)??-1;if(h>0){const d=f.children?.[h];d&&u.unshift({text:d.text,href:d.url??""})}u.unshift({text:f.text,href:f.url??""})}f.parentItem&&g(f.parentItem)}return s&&g(s),g(a,!0),u}},15840:(te,R,e)=>{"use strict";e.d(R,{J:()=>u});var n=e(74848),a=e(22803),s=e(92745),i=e(63142),r=e(76319);const u=({onClick:l,"aria-label":g,style:f})=>{const p=(0,i.of)(o);return(0,n.jsx)(r.K,{"aria-label":g??"Close",className:p,name:"times",onClick:l,style:f,tooltip:(0,s.t)("close-button.tooltip","Close")})},o=l=>(0,a.css)({position:"absolute",right:l.spacing(.5),top:l.spacing(1)})},10388:(te,R,e)=>{"use strict";e.d(R,{Dd:()=>l,wi:()=>c});var n=e(74848),a=e(22803),s=e(96540),i=e(92745),r=e(43173),u=e(63142),o=e(30703);let l=()=>[{target:"_blank",id:"documentation",text:(0,i.t)("nav.help/documentation","Documentation"),icon:"document-info",url:"https://grafana.com/docs/grafana/latest/?utm_source=grafana_footer"},{target:"_blank",id:"support",text:(0,i.t)("nav.help/support","Support"),icon:"question-circle",url:"https://grafana.com/products/enterprise/?utm_source=grafana_footer"},{target:"_blank",id:"community",text:(0,i.t)("nav.help/community","Community"),icon:"comments-alt",url:"https://community.grafana.com/?utm_source=grafana_footer"}];function g(m){return{hasReleaseNotes:!0,isBeta:m.includes("-beta")}}function f(m){const{buildInfo:y,licenseInfo:h}=r.$,d=[],E=h.stateInfo?` (${h.stateInfo})`:"";if(m||d.push({target:"_blank",id:"license",text:`${y.edition}${E}`,url:h.licenseUrl}),y.hideVersion)return d;const{hasReleaseNotes:b}=g(y.version);return d.push({target:"_blank",id:"version",text:y.versionString,url:b?"https://github.com/grafana/grafana/blob/main/CHANGELOG.md":void 0}),y.hasUpdate&&d.push({target:"_blank",id:"updateVersion",text:"New version available!",icon:"download-alt",url:"https://grafana.com/grafana/download?utm_source=grafana_footer"}),d}function p(m){l=m}const c=(0,s.memo)(({customLinks:m,hideEdition:y})=>{const h=(m||l()).concat(f(y)),d=(0,u.of)(v);return(0,n.jsx)("footer",{className:d.footer,children:(0,n.jsx)("div",{className:"text-center",children:(0,n.jsx)("ul",{className:d.list,children:h.map((E,b)=>(0,n.jsx)("li",{className:d.listItem,children:(0,n.jsx)(x,{item:E})},b))})})})});c.displayName="Footer";function x({item:m}){const y=m.url?(0,n.jsx)("a",{href:m.url,target:m.target,rel:"noopener noreferrer",id:m.id,children:m.text}):m.text;return(0,n.jsxs)(n.Fragment,{children:[m.icon&&(0,n.jsx)(o.I,{name:m.icon})," ",y]})}const v=m=>({footer:(0,a.css)({...m.typography.bodySmall,color:m.colors.text.primary,display:"block",padding:m.spacing(2,0),position:"relative",width:"98%","a:hover":{color:m.colors.text.maxContrast,textDecoration:"underline"},[m.breakpoints.down("md")]:{display:"none"}}),list:(0,a.css)({listStyle:"none"}),listItem:(0,a.css)({display:"inline-block","&:after":{content:"' | '",padding:m.spacing(0,1)},"&:last-child:after":{content:"''",paddingLeft:0}})})},90666:(te,R,e)=>{"use strict";e.d(R,{T:()=>r});var n=e(74848),a=e(22803),s=e(63142),i=e(43990);function r({children:o,spacing:l,level:g}){const f=(0,s.of)(u,l,g);return(0,n.jsx)("span",{className:(0,a.css)(f.indentor),children:o})}const u=(o,l,g)=>({indentor:(0,a.css)((0,i.Y)(o,l,f=>({paddingLeft:o.spacing(f*g)})))})},36321:(te,R,e)=>{"use strict";e.d(R,{b:()=>i});var n=e(74848),a=e(96540),s=e(29043);const i=r=>{const{children:u,storageKey:o,defaultValue:l}=r,[g,f]=(0,a.useState)({value:s.A.getObject(r.storageKey,r.defaultValue)});(0,a.useEffect)(()=>{const x=v=>{v.key===o&&f({value:s.A.getObject(r.storageKey,r.defaultValue)})};return window.addEventListener("storage",x),()=>{window.removeEventListener("storage",x)}});const p=x=>{try{s.A.setObject(o,x)}catch(v){console.error(v)}f({value:x})},c=()=>{try{s.A.delete(o)}catch(x){console.log(x)}f({value:l})};return(0,n.jsx)(n.Fragment,{children:u(g.value,p,c)})}},94076:(te,R,e)=>{"use strict";e.d(R,{A:()=>a,X:()=>s});var n=e(96540);function a({children:i,onSetScrollRef:r,divId:u}){const o=(0,n.useRef)(null);return(0,n.useEffect)(()=>{r&&r(new s(document.documentElement))},[o,r]),i}class s{constructor(r){this.element=r}get scrollTop(){return this.element.scrollTop}scrollTo(r,u,o=0){if(!(this.element.scrollHeight-this.element.clientHeight-u>=0)&&o<10){requestAnimationFrame(()=>this.scrollTo(r,u,o+1));return}this.element.scrollTo(r,u)}}},21234:(te,R,e)=>{"use strict";e.d(R,{I:()=>r});var n=e(74848),a=e(22803),s=e(63142),i=e(8073);function r({description:o,text:l,url:g}){const f=(0,s.of)(u);return(0,n.jsxs)(i.Z,{className:f.card,href:g,children:[(0,n.jsx)(i.Z.Heading,{children:l}),(0,n.jsx)(i.Z.Description,{className:f.description,children:o})]})}const u=o=>({card:(0,a.css)({marginBottom:0,gridTemplateRows:"1fr 0 2fr"}),description:(0,a.css)({WebkitLineClamp:3,WebkitBoxOrient:"vertical",display:"-webkit-box",overflow:"hidden"})})},82151:(te,R,e)=>{"use strict";e.d(R,{b:()=>r});var n=e(74848),a=e(92745),s=e(99887),i=e(27321);function r({folder:u}){const o=(0,i.F)();return!u||"parentUID"in u&&u.parentUID||!u.managedBy||o?null:(0,n.jsx)(s.E,{text:(0,a.t)("folder-repo.badge-text","Provisioned"),color:"darkgrey"})}},3208:(te,R,e)=>{"use strict";e.r(R),e.d(R,{NestedFolderPicker:()=>Ee});var n=e(74848),a=e(22803),s=e(34743),i=e(83505),r=e(46885),u=e(10378),o=e(76459),l=e.n(o),g=e(96540),f=e(92745),p=e(43173),c=e(63142),x=e(41654),v=e(66404),m=e(63527),y=e(30703),h=e(34999),d=e(47327),E=e(18346),b=e(55860),D=e(93854),C=e(70590),P=e(82151),M=e(70255),O=e(97222),j=e(10022),U=e(76319),W=e(90666),B=e(80231),S=e(52763);const _=40,K="md",T=(Oe,Se)=>`${Oe}-${Se||"root"}`;function L({items:Oe,focusedItemIndex:Se,foldersAreOpenable:Te,idPrefix:_e,selectedFolder:He,onFolderExpand:tt,onFolderSelect:Je,isItemLoaded:Ge,requestLoadMore:je}){const Fe=(0,g.useRef)(null),Be=(0,c.of)(V),Ke=(0,g.useMemo)(()=>({items:Oe,focusedItemIndex:Se,foldersAreOpenable:Te,selectedFolder:He,onFolderExpand:tt,onFolderSelect:Je,idPrefix:_e}),[Oe,Se,Te,He,tt,Je,_e]),Ue=(0,g.useCallback)(Xe=>Ge(Xe),[Ge]),we=(0,g.useCallback)((Xe,nt)=>{const{parentUID:he}=Oe[Xe];je(he)},[je,Oe]);return(0,n.jsx)("div",{className:Be.table,role:"tree",children:Oe.length>0?(0,n.jsx)(j.A,{ref:Fe,itemCount:Oe.length,isItemLoaded:Ue,loadMoreItems:we,children:({onItemsRendered:Xe,ref:nt})=>(0,n.jsx)(O.Y1,{ref:nt,height:_*Math.min(6.5,Oe.length),width:"100%",itemData:Ke,itemSize:_,itemCount:Oe.length,onItemsRendered:Xe,children:N})}):(0,n.jsx)("div",{className:Be.emptyMessage,children:(0,n.jsx)(f.x6,{i18nKey:"browse-dashboards.folder-picker.empty-message",children:"No folders found"})})})}const A=[100,200,130,160,150];function N({index:Oe,style:Se,data:Te}){const{items:_e,focusedItemIndex:He,foldersAreOpenable:tt,selectedFolder:Je,onFolderExpand:Ge,onFolderSelect:je,idPrefix:Fe}=Te,{item:Be,isOpen:Ke,level:Ue,parentUID:we}=_e[Oe],Xe=(0,g.useRef)(null),nt=(0,g.useId)(),he=(0,S.d4)(B.ku),xe=(0,S.d4)(B.Am),me=(Be.uid?xe[Be.uid]:he)?.items??[];let ye=[];Be.uid&&(ye=(we?xe[we]:he)?.items??[]);const De=(0,c.of)(V),Le=(0,g.useCallback)(ze=>{ze.preventDefault(),ze.stopPropagation(),Be.uid&&Ge(Be.uid,!Ke)},[Be.uid,Ke,Ge]),Ve=(0,g.useCallback)(()=>{Be.kind==="folder"&&je(Be)},[Be,je]);if(Be.kind==="ui"&&Be.uiKind==="pagination-placeholder")return(0,n.jsxs)("span",{style:Se,className:De.row,children:[(0,n.jsx)(W.T,{level:Ue,spacing:2}),(0,n.jsx)(M.A,{width:A[Oe%A.length]})]});if(Be.kind!=="folder"){const ze=Be.kind,Ze=Be.uid;return null}return(0,n.jsx)("div",{ref:Xe,style:Se,className:(0,a.cx)(De.row,{[De.rowFocused]:Oe===He,[De.rowSelected]:Be.uid===Je}),tabIndex:-1,onClick:Ve,"aria-expanded":Ke,"aria-selected":Be.uid===Je,"aria-labelledby":nt,"aria-level":Ue+1,role:"treeitem","aria-owns":me.length>0?me.map(ze=>T(Fe,ze.uid)).join(" "):void 0,"aria-setsize":me.length,"aria-posinset":ye.findIndex(ze=>ze.uid===Be.uid)+1,id:T(Fe,Be.uid),children:(0,n.jsxs)("div",{className:De.rowBody,children:[(0,n.jsx)(W.T,{level:Ue,spacing:2}),tt?(0,n.jsx)(U.K,{size:K,onMouseDown:Le,tabIndex:-1,"aria-label":Ke?`Collapse folder ${Be.title}`:`Expand folder ${Be.title}`,name:Ke?"angle-down":"angle-right"}):(0,n.jsx)("span",{className:De.folderButtonSpacer}),(0,n.jsxs)("label",{className:De.label,id:nt,children:[(0,n.jsx)(v.E,{truncate:!0,children:Be.title}),(0,n.jsx)(P.b,{folder:Be})]})]})})}const V=Oe=>{const Se=(0,a.css)({height:_,display:"flex",position:"relative",alignItems:"center",flexGrow:1,gap:Oe.spacing(.5),overflow:"hidden",padding:Oe.spacing(0,1)});return{table:(0,a.css)({background:Oe.components.input.background}),emptyMessage:(0,a.css)({padding:Oe.spacing(1),textAlign:"center",width:"100%"}),folderButtonSpacer:(0,a.css)({paddingLeft:Oe.spacing(.5)}),row:(0,a.css)({display:"flex",position:"relative",alignItems:"center",":not(:first-child)":{borderTop:`solid 1px ${Oe.colors.border.weak}`}}),rowFocused:(0,a.css)({backgroundColor:Oe.colors.background.secondary}),rowSelected:(0,a.css)({"&::before":{display:"block",content:'""',position:"absolute",left:0,bottom:0,top:0,width:4,borderRadius:Oe.shape.radius.default,backgroundImage:Oe.colors.gradients.brandVertical}}),rowBody:Se,label:(0,a.css)({display:"flex",alignItems:"center",gap:Oe.spacing(1),lineHeight:_+"px",flexGrow:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","&:hover":{textDecoration:"underline",cursor:"pointer"}})}};var z=e(35484),w=e(35222);function H({handleClearSelection:Oe,isLoading:Se,invalid:Te,label:_e,...He},tt){const Je=(0,c.$j)(),Ge=Z(Je,Te),je=Fe=>{(Fe.key==="Enter"||Fe.key===" ")&&Oe?.(Fe)};return Se?(0,n.jsx)(w.A,{}):(0,n.jsx)("div",{className:Ge.wrapper,children:(0,n.jsxs)("div",{className:Ge.inputWrapper,children:[_e?(0,n.jsx)("div",{className:Ge.prefix,children:(0,n.jsx)(y.I,{name:"folder"})}):void 0,(0,n.jsxs)("button",{type:"button",className:(0,a.cx)(Ge.fakeInput,_e?Ge.hasPrefix:void 0),...He,ref:tt,children:[_e?(0,n.jsx)(v.E,{truncate:!0,children:_e}):(0,n.jsx)(v.E,{truncate:!0,color:"secondary",children:(0,n.jsx)(f.x6,{i18nKey:"browse-dashboards.folder-picker.button-label",children:"Select folder"})}),!Se&&Oe&&(0,n.jsx)(y.I,{role:"button",tabIndex:0,"aria-label":(0,f.t)("browse-dashboards.folder-picker.clear-selection","Clear selection"),className:Ge.clearIcon,name:"times",onClick:Oe,onKeyDown:je})]}),(0,n.jsx)("div",{className:Ge.suffix,children:(0,n.jsx)(y.I,{name:"angle-down"})})]})})}const Q=(0,g.forwardRef)(H),Z=(Oe,Se=!1)=>{const Te=(0,m.n)({theme:Oe,invalid:Se});return{wrapper:Te.wrapper,inputWrapper:Te.inputWrapper,prefix:(0,a.css)([Te.prefix,{pointerEvents:"none",color:Oe.colors.text.primary}]),suffix:(0,a.css)([Te.suffix,{pointerEvents:"none"}]),fakeInput:(0,a.css)([Te.input,{textAlign:"left",letterSpacing:"normal","&:focus":{outline:"unset",boxShadow:"unset"},"&:focus-visible":(0,z.getFocusStyles)(Oe),alignItems:"center",display:"flex",flexWrap:"nowrap",justifyContent:"space-between",paddingRight:28}]),hasPrefix:(0,a.css)({paddingLeft:28}),clearIcon:(0,a.css)({color:Oe.colors.text.secondary,cursor:"pointer","&:hover":{color:Oe.colors.text.primary},"&:focus:not(:focus-visible)":(0,z.getMouseFocusStyles)(Oe),"&:focus-visible":(0,z.getFocusStyles)(Oe)})}};var Y=e(25508),X=e(87161),I=e(75735),J=e(27044),ee=e(78034);const q={isOpen:!0,level:0,item:{kind:"folder",title:"Dashboards",uid:""}},ne="general",se=new Intl.Collator;function oe(Oe,Se){const Te=(0,S.wA)(),_e=(0,g.useRef)([]),[He,tt]=(0,g.useState)([]),Je=(0,g.useMemo)(()=>(0,Y.Mz)(He,(...Be)=>{let Ke=!1;const Ue={};for(const we of Be){we.status===u.RE.pending&&(Ke=!0);const Xe=we.originalArgs?.name;Xe&&(Ue[Xe]=we)}return{isLoading:Ke,responseByParent:Ue}}),[He]),Ge=(0,S.d4)(Je),je=(0,g.useCallback)(Be=>{const Ke=Be??ne;if(Ge.responseByParent[Ke]?.status===u.RE.pending)return;const Xe={name:Ke},nt=Te(X.Z.endpoints.getFolderChildren.initiate(Xe)),he=X.Z.endpoints.getFolderChildren.select(Xe);tt(xe=>xe.concat(he)),_e.current=_e.current.concat([nt])},[Ge,Te]);return(0,g.useEffect)(()=>()=>{for(const Be of _e.current)Be.unsubscribe()},[]),{items:(0,g.useMemo)(()=>{if(!Oe)return[];function Be(Ue,we,Xe){let nt=we?.data?.items?[...we.data.items]:[];nt.sort((xe,me)=>se.compare(xe.spec.title,me.spec.title));const he=nt.flatMap(xe=>{const me=xe.metadata.name,ye=Se[me],De={isOpen:!!ye,level:Xe,item:{kind:"folder",title:xe.spec.title,uid:me,managedBy:xe.metadata?.annotations?.[I.LH]}},Le=ye&&Ge.responseByParent[me];if(Le){const Ve=Be(me,Le,Xe+1);return[De,...Ve]}return De});return we||he.push(...(0,ee.T)(J.md,Ue,Xe)),he}const Ke=Be(ne,Ge.responseByParent[ne],1);return Ke.unshift(q),Ke},[Ge,Oe,Se]),isLoading:Ge.isLoading,requestNextPage:je}}const de="pending";function fe(Oe){const Se=Oe.at(-1),Te=Se?.originalArgs?.page,_e=Se?.status===de;return Se?.data?[Se.data.length<Se.originalArgs.limit,Te,_e]:[!1,Te,_e]}function ae(Oe,Se,Te){const _e=(0,S.wA)(),He=(0,g.useRef)([]),[tt,Je]=(0,g.useState)([]),Ge=(0,g.useMemo)(()=>(0,Y.Mz)(tt,(...Ke)=>{let Ue=!1;const we=[],Xe={};for(const nt of Ke){nt.status===de&&(Ue=!0);const he=nt.originalArgs?.parentUid;he?(Xe[he]||(Xe[he]=[]),Xe[he].push(nt)):we.push(nt)}return{isLoading:Ue,rootPages:we,pagesByParent:Xe}}),[tt]),je=(0,S.d4)(Ge),Fe=(0,g.useCallback)(Ke=>{const Ue=Ke?je.pagesByParent[Ke]:je.rootPages,[we,Xe,nt]=fe(Ue??[]);if(we||nt)return;const he={parentUid:Ke,page:(Xe??0)+1,limit:J.md,permission:Te},xe=_e(E.cU.endpoints.listFolders.initiate(he)),me=E.cU.endpoints.listFolders.select({parentUid:xe.arg.parentUid,page:xe.arg.page,limit:xe.arg.limit,permission:xe.arg.permission});Je(ye=>ye.concat(me)),He.current=He.current.concat([xe])},[je,_e,Te]);return(0,g.useEffect)(()=>()=>{for(const Ke of He.current)Ke.unsubscribe()},[]),{items:(0,g.useMemo)(()=>{if(!Oe)return[];function Ke(we,Xe,nt){const he=Xe.flatMap(me=>(me.data??[]).flatMap(De=>{const Le=Se[De.uid],Ve={isOpen:!!Le,level:nt,item:{kind:"folder",title:De.title,uid:De.uid,managedBy:De.managedBy}},ze=Le&&je.pagesByParent[De.uid];if(ze){const Ze=Ke(De.uid,ze,nt+1);return[Ve,...Ze]}return Ve})),[xe]=fe(Xe);return xe||he.push(...(0,ee.T)(J.md,we,nt)),he}const Ue=Ke(void 0,je.rootPages,1);return Ue.unshift(q),Ue},[je,Oe,Se]),isLoading:je.isLoading,requestNextPage:Fe}}function ce(Oe,Se,Te){const _e=ae(Oe,Se,Te),He=oe(Oe,Se);return p.$.featureToggles.foldersAppPlatformAPI?He:_e}function ie({tree:Oe,handleCloseOverlay:Se,handleFolderSelect:Te,handleFolderExpand:_e,idPrefix:He,search:tt,visible:Je}){const[Ge,je]=(0,g.useState)(-1),Fe=!!p.$.featureToggles.nestedFolders;(0,g.useEffect)(()=>{Je&&je(-1)},[Je]),(0,g.useEffect)(()=>{je(0)},[tt]),(0,g.useEffect)(()=>{document.getElementById(T(He,Oe[Ge]?.item.uid))?.scrollIntoView({block:"nearest",inline:"nearest"})},[Ge,He,Oe]);const Be=(0,g.useCallback)(Ke=>{const Ue=Fe&&!tt;switch(Ke.key){case"ArrowRight":case"ArrowLeft":Ue&&(Ke.preventDefault(),_e(Oe[Ge].item.uid,Ke.key==="ArrowRight"));break;case"ArrowUp":Ge>0&&(Ke.preventDefault(),je(Ge-1));break;case"ArrowDown":Ge<Oe.length-1&&(Ke.preventDefault(),je(Ge+1));break;case"Enter":Ke.preventDefault();const we=Oe[Ge].item;we.kind==="folder"&&Te(we);break;case"Tab":Ke.stopPropagation(),Se();break;case"Escape":Ke.stopPropagation(),Ke.preventDefault(),Se();break}},[Ge,Se,_e,Te,Fe,tt,Oe]);return{focusedItemIndex:Ge,handleKeyDown:Be}}const ve=l()(le,300);async function le(Oe,Se){const Te=await(0,b.S)().search({query:Oe,kind:["folder"],limit:100,permission:Se}),_e=Te.view.map(He=>(0,D.hI)(He,Te.view));return{...Te,items:_e}}function Ee({value:Oe,invalid:Se,showRootFolder:Te=!0,clearable:_e=!1,excludeUIDs:He,permission:tt="edit",onChange:Je}){const Ge=(0,c.of)(Re),je=(0,E.kH)(Oe||u.hT),Fe=!!p.$.featureToggles.nestedFolders,[Be,Ke]=(0,g.useState)(""),[Ue,we]=(0,g.useState)(null),[Xe,nt]=(0,g.useState)(!1),[he,xe]=(0,g.useState)(!1),[me,ye]=(0,g.useState)(!1),[De,Le]=(0,g.useState)({}),Ve=(0,g.useId)(),[ze]=(0,g.useState)(void 0),Ze=(0,g.useRef)(0),Me=(0,g.useMemo)(()=>{if(tt==="view")return C.RG.View;if(tt==="edit")return C.RG.Edit;throw new Error("Invalid permission")},[tt]),$e=!!(me&&!(Be&&Ue)),{items:at,isLoading:ct,requestNextPage:ft}=ce($e,De,Me);(0,g.useEffect)(()=>{if(!Be){we(null);return}const Ft=Date.now();nt(!0),ve(Be,Me).then(_t=>{if(Ft>Ze.current){const tn=_t.view.map(xn=>(0,D.hI)(xn,_t.view));we({..._t,items:tn}),nt(!1),Ze.current=Ft}})},[Be,Me]);const Et=[(0,s.UU)({crossAxis:!1,boundary:document.body})],{context:St,refs:Pt,floatingStyles:Dt,elements:Ye}=(0,i.we)({open:me,placement:"bottom",onOpenChange:Ft=>{Ft&&(Ke(""),xe(!0)),ye(Ft)},middleware:Et,whileElementsMounted:r.ll}),mt=(0,i.kp)(St),zt=(0,i.s9)(St),{getReferenceProps:Jt,getFloatingProps:Xt}=(0,i.bv)([zt,mt]),En=(0,g.useCallback)(async(Ft,_t)=>{Le(tn=>({...tn,[Ft]:_t})),_t&&!De[Ft]&&ft(Ft)},[ft,De]),ln=(0,g.useCallback)(Ft=>{Je&&Je(Ft.uid,Ft.title),ye(!1)},[Je]),cn=(0,g.useCallback)(Ft=>{Ft.preventDefault(),Ft.stopPropagation(),Je&&Je(void 0,void 0)},[Je]),Pn=(0,g.useCallback)(()=>ye(!1),[ye]),wn=(0,g.useCallback)(Ft=>{Be||ft(Ft)},[Be,ft]),jn=(0,g.useMemo)(()=>{let Ft=[];return $e?Ft=at:Ft=Ue?.items.map(_t=>({isOpen:!1,level:0,item:{kind:"folder",title:_t.title,uid:_t.uid}}))??[],(!Te||He?.length)&&(Ft=Ft.filter(_t=>!(!Te&&_t===q||He?.includes(_t.item.uid)))),Ft},[at,He,$e,Ue?.items,Te]),kn=(0,g.useCallback)(Ft=>{const _t=jn[Ft];if(!_t)return!1;const tn=_t.item;return!(tn.kind==="ui"&&tn.uiKind==="pagination-placeholder")},[jn]),gt=ct||Xe,{focusedItemIndex:Lt,handleKeyDown:Rt}=ie({tree:jn,handleCloseOverlay:Pn,handleFolderSelect:ln,handleFolderExpand:En,idPrefix:Ve,search:Be,visible:me});let Ut=je.data?.title;Oe===""&&(Ut="Dashboards");const Gt=Ut?(0,n.jsxs)(x.B,{alignItems:"center",children:[(0,n.jsx)(v.E,{truncate:!0,children:Ut}),(0,n.jsx)(P.b,{folder:je.data})]}):"";return me?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m.p,{ref:Pt.setReference,autoFocus:!0,prefix:Ut?(0,n.jsx)(y.I,{name:"folder"}):null,placeholder:Ut??(0,f.t)("browse-dashboards.folder-picker.search-placeholder","Search folders"),value:Be,invalid:Se,className:Ge.search,onChange:Ft=>Ke(Ft.currentTarget.value),"aria-autocomplete":"list","aria-expanded":!0,"aria-haspopup":!0,"aria-controls":Ve,"aria-owns":Ve,"aria-activedescendant":T(Ve,jn[Lt]?.item.uid),role:"combobox",suffix:(0,n.jsx)(y.I,{name:"search"}),...Jt(),onKeyDown:Rt}),(0,n.jsx)("fieldset",{ref:Pt.setFloating,id:Ve,className:Ge.tableWrapper,style:{...Dt,width:Ye.domReference?.clientWidth},...Xt(),children:ze?(0,n.jsx)(h.F,{className:Ge.error,severity:"warning",title:(0,f.t)("browse-dashboards.folder-picker.error-title","Error loading folders"),children:ze.message||ze.toString?.()||(0,f.t)("browse-dashboards.folder-picker.unknown-error","Unknown error")}):(0,n.jsxs)("div",{children:[gt&&(0,n.jsx)("div",{className:Ge.loader,children:(0,n.jsx)(d.G,{width:600})}),(0,n.jsx)(L,{items:jn,selectedFolder:Oe,focusedItemIndex:Lt,onFolderExpand:En,onFolderSelect:ln,idPrefix:Ve,foldersAreOpenable:Fe&&!(Be&&Ue),isItemLoaded:kn,requestLoadMore:wn})]})})]}):(0,n.jsx)(Q,{label:Gt,handleClearSelection:_e&&Oe!==void 0?cn:void 0,invalid:Se,isLoading:je.isLoading,autoFocus:he,ref:Pt.setReference,"aria-label":Ut?(0,f.t)("browse-dashboards.folder-picker.accessible-label","Select folder: {{ label }} currently selected",{label:Ut}):void 0,...Jt()})}const Re=Oe=>({button:(0,a.css)({maxWidth:"100%"}),error:(0,a.css)({marginBottom:0}),tableWrapper:(0,a.css)({boxShadow:Oe.shadows.z3,position:"relative",zIndex:Oe.zIndex.portal}),loader:(0,a.css)({position:"absolute",top:0,left:0,right:0,zIndex:Oe.zIndex.portal+1,overflow:"hidden"}),search:(0,a.css)({input:{cursor:"default"}})})},35222:(te,R,e)=>{"use strict";e.d(R,{A:()=>u});var n=e(74848),a=e(22803),s=e(70255),i=e(63142),r=e(63527);function u(){const l=(0,i.of)(o);return(0,n.jsx)("div",{className:l.wrapper,children:(0,n.jsx)("div",{className:l.inputWrapper,children:(0,n.jsx)("button",{type:"button",className:l.fakeInput,"aria-disabled":!0,children:(0,n.jsx)(s.A,{width:100})})})})}const o=l=>{const g=(0,r.n)({theme:l});return{wrapper:g.wrapper,inputWrapper:g.inputWrapper,fakeInput:(0,a.css)([g.input,{textAlign:"left"}])}}},19753:(te,R,e)=>{"use strict";e.d(R,{Q:()=>o});var n=e(74848),a=e(2543),s=e.n(a),i=e(96540),r=e(63527),u=e(37386);class o extends i.PureComponent{constructor(){super(...arguments),this.state={text:"",inputCorrected:!1},this.inputRef=i.createRef(),this.updateValue=()=>{const g=this.inputRef.current?.value;let f=!1,p="";const c=this.props.min,x=this.props.max;let v=g!==""?Number(g):void 0;v&&!Number.isNaN(v)&&(c!=null&&v<c?(p=c.toString(),f=!0):x!=null&&v>x?(p=x.toString(),f=!0):p=g??"",this.setState({text:p,inputCorrected:f})),f&&this.updateValueDebounced(),!Number.isNaN(v)&&v!==this.props.value&&this.props.onChange(v)},this.updateValueDebounced=(0,a.debounce)(this.updateValue,500),this.onChange=g=>{this.setState({text:g.currentTarget.value}),this.updateValueDebounced()},this.onKeyPress=g=>{g.key==="Enter"&&this.updateValue()}}componentDidMount(){this.setState({text:isNaN(this.props.value)?"":`${this.props.value}`})}componentDidUpdate(g){if(this.props.value!==g.value){const f=isNaN(this.props.value)?"":`${this.props.value}`;f!==this.state.text&&this.setState({text:f})}}renderInput(){return(0,n.jsx)(r.p,{type:"number",ref:this.inputRef,min:this.props.min,max:this.props.max,step:this.props.step,autoFocus:this.props.autoFocus,value:this.state.text,onChange:this.onChange,onBlur:this.updateValue,onKeyPress:this.onKeyPress,placeholder:this.props.placeholder,disabled:this.props.fieldDisabled,width:this.props.width,suffix:this.props.suffix})}render(){const{inputCorrected:g}=this.state;if(g){let f="",{min:p,max:c}=this.props;return c==null?p!=null&&(f=`< ${p}`):p!=null?f=`${p} < > ${c}`:f=`> ${c}`,(0,n.jsx)(u.D,{invalid:g,error:`Out of range ${f}`,validationMessageHorizontalOverflow:!0,style:{direction:"rtl"},children:this.renderInput()})}return this.renderInput()}}},38669:(te,R,e)=>{"use strict";e.d(R,{a:()=>l});var n=e(74848),a=e(22803),s=e(92745),i=e(63142),r=e(35427),u=e(76319),o=e(13409);const l=({value:f,settings:p,onChange:c,details:x})=>{const v=(0,i.$j)(),m=(0,i.of)(g);return(0,n.jsx)(r.sk,{color:f??"",onChange:c,enableNamedColors:p?.enableNamedColors!==!1,children:({ref:y,showColorPicker:h,hideColorPicker:d})=>(0,n.jsxs)("div",{className:m.spot,children:[(0,n.jsx)("div",{className:m.colorPicker,children:(0,n.jsx)(o.q,{ref:y,onClick:h,onMouseLeave:d,color:f?v.visualization.getColorByName(f):v.components.input.borderColor})}),x&&(0,n.jsxs)(n.Fragment,{children:[f?(0,n.jsx)("span",{className:m.colorText,onClick:h,children:f}):(0,n.jsx)("span",{className:m.placeholderText,onClick:h,children:p?.placeholder??"Select color"}),p?.isClearable&&f&&(0,n.jsx)(u.K,{name:"times",onClick:()=>c(void 0),tooltip:(0,s.t)("options-ui.color.clear-tooltip","Clear settings")})]})]})})},g=f=>({spot:(0,a.css)({cursor:"pointer",color:f.colors.text.primary,background:f.components.input.background,padding:"3px",height:f.v1.spacing.formInputHeight,border:`1px solid ${f.components.input.borderColor}`,display:"flex",flexDirection:"row",alignItems:"center",alignContent:"flex-end","&:hover":{border:`1px solid ${f.components.input.borderHover}`}}),colorPicker:(0,a.css)({padding:`0 ${f.spacing(1)}`}),colorText:(0,a.css)({flexGrow:2}),placeholderText:(0,a.css)({flexGrow:2,color:f.colors.text.secondary})})},85053:(te,R,e)=>{"use strict";e.d(R,{w:()=>i});var n=e(74848),a=e(96540),s=e(19753);const i=({value:r,onChange:u,item:o})=>{const{settings:l}=o,g=(0,a.useCallback)(f=>{u(l?.integer&&f!==void 0?Math.floor(f):f)},[u,l?.integer]);return(0,n.jsx)(s.Q,{value:r,min:l?.min,max:l?.max,step:l?.step,placeholder:l?.placeholder,onChange:g})}},83162:(te,R,e)=>{"use strict";e.d(R,{H:()=>he,u:()=>xe});var n=e(74848),a=e(53543),s=e(38809),i=e(95004),r=e(33553),u=e(92745),o=e(21285),l=e(77824),g=e(59310),f=e(48457),p=e(96540),c=e(22803),x=e(2543),v=e(36394),m=e(35555),y=e(8255),h=e(63527),d=e(35427),E=e(76319),b=e(45861),D=e(72636),C=e(65240);class P extends p.PureComponent{constructor(ye){super(ye),this.onAddThreshold=()=>{const{steps:Le}=this.state;let Ve=0;Le.length>1&&(Ve=Le[Le.length-1].value+10);let ze=y.Tj.filter($e=>!Le.some(at=>at.color===$e))[1];ze||(ze="#CCCCCC");const Ze={value:Ve,color:ze,key:M++},Me=[...Le,Ze];(0,v.RU)(Me),this.setState({steps:Me},()=>{this.latestThresholdInputRef.current&&this.latestThresholdInputRef.current.focus(),this.onChange()})},this.onRemoveThreshold=Le=>{const{steps:Ve}=this.state;Ve.length&&Le.key!==Ve[0].key&&this.setState({steps:Ve.filter(ze=>ze.key!==Le.key)},this.onChange)},this.onChangeThresholdValue=(Le,Ve)=>{const ze=Le.target.value.replace(/,/g,"."),Ze=parseFloat(ze),Me=isNaN(Ze)?"":Ze,$e=this.state.steps.map(at=>(at.key===Ve.key&&(at={...at,value:Me}),at));$e.length&&($e[0].value=-1/0),(0,v.RU)($e),this.setState({steps:$e})},this.onChangeThresholdColor=(Le,Ve)=>{const{steps:ze}=this.state,Ze=ze.map(Me=>(Me.key===Le.key&&(Me={...Me,color:Ve}),Me));this.setState({steps:Ze},this.onChange)},this.onBlur=()=>{const Le=[...this.state.steps];(0,v.RU)(Le),this.setState({steps:Le},this.onChange)},this.onChange=()=>{this.props.onChange(j(this.props.thresholds,this.state.steps))},this.onModeChanged=Le=>{this.props.onChange({...this.props.thresholds,mode:Le})};const De=O(ye.thresholds.steps);De[0].value=-1/0,this.state={steps:De},this.latestThresholdInputRef=p.createRef()}renderInput(ye,De,Le){const Ve=this.props.thresholds.mode===r.O.Percentage,ze=Le+1,Ze=(0,u.t)("dimensions.thresholds-editor.aria-label-threshold","Threshold {{thresholdNumber}}",{thresholdNumber:ze});return isFinite(ye.value)?(0,n.jsx)(h.p,{type:"number",step:"0.0001",onChange:Me=>this.onChangeThresholdValue(Me,ye),value:ye.value,"aria-label":Ze,ref:Le===0?this.latestThresholdInputRef:null,onBlur:this.onBlur,prefix:(0,n.jsxs)("div",{className:De.inputPrefix,children:[(0,n.jsx)("div",{className:De.colorPicker,children:(0,n.jsx)(d.sk,{color:ye.color,onChange:Me=>this.onChangeThresholdColor(ye,Me),enableNamedColors:!0})}),Ve&&(0,n.jsx)("div",{className:De.percentIcon,children:"%"})]}),suffix:(0,n.jsx)(E.K,{className:De.trashIcon,name:"trash-alt",onClick:()=>this.onRemoveThreshold(ye),tooltip:(0,u.t)("dimensions.threshold-editor.tooltip-remove-threshold","Remove threshold {{thresholdNumber}}",{thresholdNumber:ze})})},Ve.toString()):(0,n.jsx)(h.p,{type:"text",value:(0,u.t)("dimensions.thresholds-editor.value-base","Base"),"aria-label":Ze,disabled:!0,prefix:(0,n.jsx)("div",{className:De.colorPicker,children:(0,n.jsx)(d.sk,{color:ye.color,onChange:Me=>this.onChangeThresholdColor(ye,Me),enableNamedColors:!0})})})}render(){const{thresholds:ye}=this.props,{steps:De}=this.state,Le=[{value:r.O.Absolute,label:(0,u.t)("dimensions.thresholds-editor.modes.label.absolute","Absolute"),description:(0,u.t)("dimensions.thresholds-editor.modes.description.thresholds-based-absolute-values","Pick thresholds based on the absolute values")},{value:r.O.Percentage,label:(0,u.t)("dimensions.thresholds-editor.modes.label.percentage","Percentage"),description:(0,u.t)("dimensions.thresholds-editor.modes.description.threshold-based-percent-between-minmax","Pick threshold based on the percent between min/max")}];return(0,n.jsx)(m.D.Consumer,{children:Ve=>{const ze=U(Ve);return(0,n.jsxs)("div",{className:ze.wrapper,children:[(0,n.jsx)(b.$n,{size:"sm",icon:"plus",onClick:()=>this.onAddThreshold(),variant:"secondary",className:ze.addButton,fullWidth:!0,children:(0,n.jsx)(u.x6,{i18nKey:"dimensions.thresholds-editor.add-threshold",children:"Add threshold"})}),(0,n.jsx)("div",{className:ze.thresholds,children:De.slice(0).reverse().map((Ze,Me)=>(0,n.jsx)("div",{className:ze.item,children:this.renderInput(Ze,ze,Me)},`${Ze.key}`))}),(0,n.jsxs)("div",{children:[(0,n.jsx)(D.J,{description:(0,u.t)("dimensions.thresholds-editor.description-percentage-means-thresholds-relative","Percentage means thresholds relative to min & max"),children:(0,n.jsx)(u.x6,{i18nKey:"dimensions.thresholds-editor.thresholds-mode",children:"Thresholds mode"})}),(0,n.jsx)(l.z,{options:Le,onChange:this.onModeChanged,value:ye.mode})]})]})}})}}let M=100;function O(me){return(!me||me.length===0)&&(me=[{value:-1/0,color:"green"}]),me.filter((ye,De)=>(0,x.isNumber)(ye.value)||De===0).map(ye=>({color:ye.color,value:ye.value===null?-1/0:ye.value,key:M++}))}function j(me,ye){return{mode:me.mode??r.O.Absolute,steps:ye.map(Le=>{const{key:Ve,...ze}=Le;return ze})}}const U=(0,C.N)(me=>({wrapper:(0,c.css)({display:"flex",flexDirection:"column"}),thresholds:(0,c.css)({display:"flex",flexDirection:"column",marginBottom:me.spacing(2)}),item:(0,c.css)({marginBottom:me.spacing(1),"&:last-child":{marginBottom:0}}),colorPicker:(0,c.css)({padding:me.spacing(0,1)}),addButton:(0,c.css)({marginBottom:me.spacing(1)}),percentIcon:(0,c.css)({fontSize:me.typography.bodySmall.fontSize,color:me.colors.text.secondary}),inputPrefix:(0,c.css)({display:"flex",alignItems:"center"}),trashIcon:(0,c.css)({color:me.colors.text.secondary,cursor:"pointer",marginRight:0,"&:hover":{color:me.colors.text.primary}})}));class W extends p.PureComponent{constructor(ye){super(ye)}render(){const{onChange:ye}=this.props;let De=this.props.value;return De||(De={mode:r.O.Percentage,steps:[]}),(0,n.jsx)(P,{thresholds:De,onChange:ye})}}var B=e(18600),S=e(63142),_=e(32881),K=e(30703),T=e(22787),L=e(4896),A=e(71451),N=e(89332),V=e(59695),z=e(18857);function w({mapping:me,index:ye,onChange:De,onRemove:Le,onDuplicate:Ve,showIconPicker:ze}){const{key:Ze,result:Me,id:$e}=me,at=(0,S.of)(H),ct=(0,p.useRef)(null),ft=(0,p.useCallback)(cn=>{const Pn={...me,result:{...me.result}};cn(Pn),De(ye,Pn)},[me,ye,De]);(0,p.useEffect)(()=>{ct.current&&me.isNew&&(ct.current.focus(),ft(cn=>{cn.isNew=!1}))},[me,ct,ft]);const Et=cn=>{ft(Pn=>{Pn.result.color=cn})},St=()=>{ft(cn=>{cn.result.color=void 0})},Pt=cn=>{ft(Pn=>{Pn.result.icon=cn})},Dt=()=>{ft(cn=>{cn.result.icon=void 0})},Ye=cn=>{ft(Pn=>{Pn.key=cn.currentTarget.value})},mt=cn=>{ft(Pn=>{Pn.result.text=cn.currentTarget.value})},zt=cn=>{ft(Pn=>{Pn.from=parseFloat(cn.currentTarget.value)})},Jt=cn=>{ft(Pn=>{Pn.to=parseFloat(cn.currentTarget.value)})},Xt=cn=>{ft(Pn=>{Pn.pattern=cn.currentTarget.value})},En=cn=>{ft(Pn=>{Pn.specialMatch=cn.value})},ln=[{label:"Null",value:B.W.Null,description:(0,u.t)("dimensions.value-mapping-edit-row.special-match-options.description.matches-null-and-undefined-values","Matches null and undefined values")},{label:"NaN",value:B.W.NaN,description:(0,u.t)("dimensions.value-mapping-edit-row.special-match-options.description.matches-against-number-na-n-not-a-number","Matches against Number.NaN (not a number)")},{label:"Null + NaN",value:B.W.NullAndNaN,description:(0,u.t)("dimensions.value-mapping-edit-row.special-match-options.description.matches-null-undefined-and-na-n","Matches null, undefined and NaN")},{label:"True",value:B.W.True,description:(0,u.t)("dimensions.value-mapping-edit-row.special-match-options.description.boolean-true-values","Boolean true values")},{label:"False",value:B.W.False,description:(0,u.t)("dimensions.value-mapping-edit-row.special-match-options.description.boolean-false-values","Boolean false values")},{label:(0,u.t)("dimensions.value-mapping-edit-row.special-match-options.label.empty","Empty"),value:B.W.Empty,description:(0,u.t)("dimensions.value-mapping-edit-row.special-match-options.description.empty-string","Empty string")}];return(0,n.jsx)(N.sx,{draggableId:$e,index:ye,children:cn=>(0,n.jsxs)("tr",{className:at.dragRow,ref:cn.innerRef,...cn.draggableProps,children:[(0,n.jsx)("td",{children:(0,n.jsx)("div",{className:at.dragHandle,...cn.dragHandleProps,children:(0,n.jsx)(K.I,{name:"draggabledots",size:"lg"})})}),(0,n.jsx)("td",{className:at.typeColumn,children:me.type}),(0,n.jsxs)("td",{children:[me.type===B.d.ValueToText&&(0,n.jsx)(h.p,{ref:ct,type:"text",value:Ze??"",onChange:Ye,placeholder:(0,u.t)("dimensions.value-mapping-edit-row.placeholder-exact-value-to-match","Exact value to match")}),me.type===B.d.RangeToText&&(0,n.jsxs)("div",{className:at.rangeInputWrapper,children:[(0,n.jsx)(h.p,{type:"number",value:me.from??"",placeholder:(0,u.t)("dimensions.value-mapping-edit-row.placeholder-from","From"),onChange:zt}),(0,n.jsx)(h.p,{type:"number",value:me.to??"",placeholder:(0,u.t)("dimensions.value-mapping-edit-row.placeholder-to","To"),onChange:Jt})]}),me.type===B.d.RegexToText&&(0,n.jsx)(h.p,{type:"text",value:me.pattern??"",placeholder:(0,u.t)("dimensions.value-mapping-edit-row.placeholder-regular-expression","Regular expression"),onChange:Xt}),me.type===B.d.SpecialValue&&(0,n.jsx)(z.l6,{value:ln.find(Pn=>Pn.value===me.specialMatch),options:ln,onChange:En})]}),(0,n.jsx)("td",{children:(0,n.jsx)(h.p,{type:"text",value:Me.text??"",onChange:mt,placeholder:(0,u.t)("dimensions.value-mapping-edit-row.placeholder-optional-display-text","Optional display text")})}),(0,n.jsxs)("td",{className:at.textAlignCenter,children:[Me.color&&(0,n.jsxs)(_.Gy,{spacing:"sm",justify:"center",children:[(0,n.jsx)(d.sk,{color:Me.color,onChange:Et,enableNamedColors:!0}),(0,n.jsx)(E.K,{name:"times",onClick:St,tooltip:(0,u.t)("dimensions.value-mapping-edit-row.tooltip-remove-color","Remove color"),tooltipPlacement:"top"})]}),!Me.color&&(0,n.jsx)(d.sk,{color:"gray",onChange:Et,enableNamedColors:!0,children:Pn=>(0,n.jsx)(b.$n,{variant:"primary",fill:"text",onClick:Pn.showColorPicker,ref:Pn.ref,size:"sm",children:(0,n.jsx)(u.x6,{i18nKey:"dimensions.value-mapping-edit-row.set-color",children:"Set color"})})})]}),ze&&(0,n.jsx)("td",{className:at.textAlignCenter,children:(0,n.jsxs)(_.Gy,{spacing:"sm",justify:"center",children:[(0,n.jsx)(A.n,{onChange:Pt,onClear:Dt,value:Me.icon,size:L.Iy.SMALL,folderName:L.Iu.Icon,mediaType:L.zu.Icon,color:Me.color}),Me.icon&&(0,n.jsx)(E.K,{name:"times",onClick:Dt,tooltip:(0,u.t)("dimensions.value-mapping-edit-row.tooltip-remove-icon","Remove icon"),tooltipPlacement:"top"})]})}),(0,n.jsx)("td",{className:at.textAlignCenter,children:(0,n.jsxs)(_.Gy,{spacing:"sm",children:[(0,n.jsx)(E.K,{name:"copy",onClick:()=>Ve(ye),"data-testid":"duplicate-value-mapping","aria-label":(0,u.t)("dimensions.value-mapping-edit-row.duplicate-value-mapping-aria-label-duplicate-value-mapping","Duplicate value mapping"),tooltip:(0,u.t)("dimensions.value-mapping-edit-row.duplicate-value-mapping-tooltip-duplicate","Duplicate")}),(0,n.jsx)(E.K,{name:"trash-alt",onClick:()=>Le(ye),"data-testid":"remove-value-mapping","aria-label":(0,u.t)("dimensions.value-mapping-edit-row.remove-value-mapping-aria-label-delete-value-mapping","Delete value mapping"),tooltip:(0,u.t)("dimensions.value-mapping-edit-row.remove-value-mapping-tooltip-delete","Delete")})]})})]})},$e)}const H=me=>({dragRow:(0,c.css)({position:"relative"}),dragHandle:(0,c.css)({cursor:"grab","&:focus-visible&:after":{bottom:0,content:'""',left:0,position:"absolute",right:0,top:0,outline:`2px solid ${me.colors.primary.main}`,outlineOffset:"-2px"}}),rangeInputWrapper:(0,c.css)({display:"flex","> div:first-child":{marginRight:me.spacing(2)}}),regexInputWrapper:(0,c.css)({display:"flex","> div:first-child":{marginRight:me.spacing(2)}}),typeColumn:(0,c.css)({textTransform:"capitalize",textAlign:"center",width:"1%"}),textAlignCenter:(0,c.css)({textAlign:"center"})});function Q({value:me,onChange:ye,onClose:De,showIconPicker:Le}){const Ve=(0,S.of)(Z),[ze,Ze]=(0,p.useState)([]);(0,p.useEffect)(()=>{Ze(ee(me))},[me]);const Me=Pt=>{if(!me||!Pt.destination)return;const Dt=[...ze],Ye=Dt[Pt.source.index];Dt.splice(Pt.source.index,1),Dt.splice(Pt.destination.index,0,Ye),Ze(Dt)},$e=(Pt,Dt)=>{const Ye=[...ze];Ye.splice(Pt,1,Dt),Ze(Ye)},at=Pt=>{const Dt=[...ze];Dt.splice(Pt,1),Ze(Dt)},ct=[{label:(0,u.t)("dimensions.value-mappings-editor-modal.mapping-types.label.value","Value"),value:B.d.ValueToText,description:(0,u.t)("dimensions.value-mappings-editor-modal.mapping-types.description.match-a-specific-text-value","Match a specific text value")},{label:(0,u.t)("dimensions.value-mappings-editor-modal.mapping-types.label.range","Range"),value:B.d.RangeToText,description:(0,u.t)("dimensions.value-mappings-editor-modal.mapping-types.description.match-a-numerical-range-of-values","Match a numerical range of values")},{label:(0,u.t)("dimensions.value-mappings-editor-modal.mapping-types.label.regex","Regex"),value:B.d.RegexToText,description:(0,u.t)("dimensions.value-mappings-editor-modal.mapping-types.description.match-a-regular-expression-with-replacement","Match a regular expression with replacement")},{label:(0,u.t)("dimensions.value-mappings-editor-modal.mapping-types.label.special","Special"),value:B.d.SpecialValue,description:(0,u.t)("dimensions.value-mappings-editor-modal.mapping-types.description.match-boolean-empty-values","Match on null, NaN, boolean and empty values")}],ft=Pt=>{Ze([...ze,X({type:Pt.value,result:{},isNew:!0})])},Et=Pt=>{const Dt=I(ze[Pt]),Ye=[...ze];Ye.splice(Pt,0,{...Dt});for(let mt=Pt;mt<ze.length;mt++)Ye[mt].result.index=mt;Ze(Ye)},St=()=>{ye(J(ze)),De()};return(0,p.useEffect)(()=>{me?.length||ft({value:B.d.ValueToText})},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:Ve.tableWrap,children:(0,n.jsxs)("table",{className:Ve.editTable,children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{style:{width:"1%"}}),(0,n.jsx)("th",{style:{width:"40%",textAlign:"left"},colSpan:2,children:(0,n.jsx)(u.x6,{i18nKey:"dimensions.value-mappings-editor-modal.condition",children:"Condition"})}),(0,n.jsx)("th",{style:{textAlign:"left"},children:(0,n.jsx)(u.x6,{i18nKey:"dimensions.value-mappings-editor-modal.display-text",children:"Display text"})}),(0,n.jsx)("th",{style:{width:"10%"},children:(0,n.jsx)(u.x6,{i18nKey:"dimensions.value-mappings-editor-modal.color",children:"Color"})}),Le&&(0,n.jsx)("th",{style:{width:"10%"},children:(0,n.jsx)(u.x6,{i18nKey:"dimensions.value-mappings-editor-modal.icon",children:"Icon"})}),(0,n.jsx)("th",{style:{width:"1%"}})]})}),(0,n.jsx)(N.JY,{onDragEnd:Me,children:(0,n.jsx)(N.gL,{droppableId:"sortable-field-mappings",direction:"vertical",children:Pt=>(0,n.jsxs)("tbody",{ref:Pt.innerRef,...Pt.droppableProps,children:[ze.map((Dt,Ye)=>(0,n.jsx)(w,{mapping:Dt,index:Ye,onChange:$e,onRemove:at,onDuplicate:Et,showIconPicker:Le},Dt.id)),Pt.placeholder]})})})]})}),(0,n.jsxs)(T.a.ButtonRow,{leftItems:(0,n.jsx)(V.i,{label:(0,u.t)("dimensions.value-mappings-editor-modal.label-add-a-new-mapping","Add a new mapping"),variant:"secondary",size:"md",icon:"plus",menuPlacement:"auto",minWidth:40,options:ct,onChange:ft}),children:[(0,n.jsx)(b.$n,{variant:"secondary",fill:"outline",onClick:De,children:(0,n.jsx)(u.x6,{i18nKey:"dimensions.value-mappings-editor-modal.cancel",children:"Cancel"})}),(0,n.jsx)(b.$n,{variant:"primary",onClick:St,children:(0,n.jsx)(u.x6,{i18nKey:"dimensions.value-mappings-editor-modal.update",children:"Update"})})]})]})}const Z=me=>({tableWrap:(0,c.css)({maxHeight:"calc(80vh - 170px)",minHeight:"40px",overflow:"auto"}),editTable:(0,c.css)({width:"100%",marginBottom:me.spacing(2),"thead th":{textAlign:"center"},"tbody tr:hover":{background:me.colors.action.hover}," th, td":{padding:me.spacing(1)}})});function Y(){return(0,x.uniqueId)("mapping-")}function X(me){return{type:B.d.ValueToText,result:{},id:Y(),...me}}function I(me){return{...X(me),id:Y()}}function J(me){const ye=[],De={type:B.d.ValueToText,options:{}};return me.forEach((Le,Ve)=>{const ze={...Le.result,index:Ve};switch((!ze.text||ze.text.trim().length===0)&&(ze.text=void 0),Le.type){case B.d.ValueToText:Le.key!=null&&(De.options[Le.key]=ze);break;case B.d.RangeToText:(Le.from!=null||Le.to!=null)&&ye.push({type:Le.type,options:{from:Le.from??null,to:Le.to??null,result:ze}});break;case B.d.RegexToText:Le.pattern!=null&&ye.push({type:Le.type,options:{pattern:Le.pattern,result:ze}});break;case B.d.SpecialValue:ye.push({type:Le.type,options:{match:Le.specialMatch,result:ze}})}}),Object.keys(De.options).length>0&&ye.unshift(De),ye}function ee(me){const ye=[];if(me)for(const De of me)switch(De.type){case B.d.ValueToText:for(const Le in De.options)ye.push(X({type:De.type,result:De.options[Le],key:Le}));break;case B.d.RangeToText:ye.push(X({type:De.type,result:De.options.result,from:De.options.from,to:De.options.to}));break;case B.d.RegexToText:ye.push(X({type:De.type,result:De.options.result,pattern:De.options.pattern}));break;case B.d.SpecialValue:ye.push(X({type:De.type,result:De.options.result,specialMatch:De.options.match??B.W.Null}))}return ye.sort((De,Le)=>(De.result.index??0)>(Le.result.index??0)?1:-1),ye}const q=(0,p.memo)(me=>{const{value:ye,onChange:De,item:Le}=me,Ve=(0,S.of)(ne),ze=Le.settings?.icon,[Ze,Me]=(0,p.useState)(!1),$e=(0,p.useCallback)(()=>{Me(!1)},[Me]),at=(0,p.useMemo)(()=>ee(ye),[ye]),ct=(0,p.useCallback)((Et,St)=>{at[St].result.color=Et,De(J(at))},[at,De]),ft=(0,p.useCallback)((Et,St)=>{at[St].result.icon=Et,De(J(at))},[at,De]);return(0,n.jsxs)(_.gW,{children:[(0,n.jsx)("table",{className:Ve.compactTable,children:(0,n.jsx)("tbody",{children:at.map((Et,St)=>(0,n.jsxs)("tr",{children:[(0,n.jsxs)("td",{children:[Et.type===B.d.ValueToText&&Et.key,Et.type===B.d.RangeToText&&(0,n.jsxs)("span",{children:["[",Et.from??"-\u221E"," - ",Et.to??"\u221E","]"]}),Et.type===B.d.RegexToText&&Et.pattern,Et.type===B.d.SpecialValue&&Et.specialMatch]}),(0,n.jsx)("td",{children:(0,n.jsx)(K.I,{name:"arrow-right"})}),(0,n.jsx)("td",{children:Et.result.text}),Et.result.color&&(0,n.jsx)("td",{children:(0,n.jsx)(d.sk,{color:Et.result.color,onChange:Pt=>ct(Pt,St),enableNamedColors:!0})}),ze&&Et.result.icon&&(0,n.jsx)("td",{"data-testid":"iconPicker",children:(0,n.jsx)(A.n,{onChange:Pt=>ft(Pt,St),value:Et.result.icon,size:L.Iy.SMALL,folderName:L.Iu.Icon,mediaType:L.zu.Icon,color:Et.result.color})})]},St.toString()))})}),(0,n.jsxs)(b.$n,{variant:"secondary",size:"sm",fullWidth:!0,onClick:()=>Me(!0),children:[at.length>0&&(0,n.jsx)("span",{children:(0,n.jsx)(u.x6,{i18nKey:"dimensions.value-mappings-editor.edit-value-mappings",children:"Edit value mappings"})}),at.length===0&&(0,n.jsx)("span",{children:(0,n.jsx)(u.x6,{i18nKey:"dimensions.value-mappings-editor.add-value-mappings",children:"Add value mappings"})})]}),(0,n.jsx)(T.a,{isOpen:Ze,title:(0,u.t)("dimensions.value-mappings-editor.title-value-mappings","Value mappings"),onDismiss:$e,className:Ve.modal,closeOnBackdropClick:!1,children:(0,n.jsx)(Q,{value:ye,onChange:De,onClose:$e,showIconPicker:ze})})]})});q.displayName="ValueMappingsEditor";const ne=me=>({modal:(0,c.css)({width:"980px"}),compactTable:(0,c.css)({width:"100%","tbody td":{padding:me.spacing(.5)}})});var se=e(95506);const oe=({value:me,onChange:ye,item:De})=>{const{placeholder:Le,isClearable:Ve}=De?.settings??{},ze=(0,p.useCallback)(Ze=>{ye(Ze?.value?.uid)},[ye]);return(0,n.jsx)(se.b,{isClearable:Ve,defaultOptions:!0,onChange:ze,placeholder:Le,value:me})};var de=e(79609),fe=e(49517);const ae=({value:me,onChange:ye,context:De})=>(0,n.jsx)(fe.G,{actions:me,onChange:ye,data:De.data,getSuggestions:()=>De.getSuggestions?De.getSuggestions(de.uP.Values):[]});var ce=e(38669),ie=e(76637),ve=e(64394),le=e(37386);const Ee=({value:me,onChange:ye,item:De,id:Le})=>{const Ve=(0,S.$j)(),ze=(0,S.of)(Oe),Ze=(0,ie.Hs)(me?.mode),$e=(De.settings?.byValueSupport?ie.uf.list():ie.uf.list().filter(St=>!St.isByValue)).filter(St=>!St.excludeFromPicker).map(St=>{let Pt=St.isByValue?" (by value)":"";return{value:St.id,label:`${St.name}${Pt}`,description:St.description,isContinuous:St.isContinuous,isByValue:St.isByValue,component(){return(0,n.jsx)(Re,{mode:St,theme:Ve})}}}),at=St=>{ye({...me,mode:St.value})},ct=St=>{ye({...me,mode:Et,fixedColor:St})},ft=St=>{ye({...me,mode:Et,seriesBy:St})},Et=me?.mode??ve.Y.Thresholds;if(Et===ve.Y.Fixed||Et===ve.Y.Shades)return(0,n.jsxs)("div",{className:ze.group,children:[(0,n.jsx)(z.l6,{minMenuHeight:200,options:$e,value:Et,onChange:at,className:ze.select,inputId:Le}),(0,n.jsx)(ce.a,{value:me?.fixedColor,onChange:ct})]});if(De.settings?.bySeriesSupport&&Ze.isByValue){const St=[{label:"Last",value:"last"},{label:"Min",value:"min"},{label:"Max",value:"max"}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{style:{marginBottom:Ve.spacing(2)},children:(0,n.jsx)(z.l6,{minMenuHeight:200,options:$e,value:Et,onChange:at,inputId:Le})}),(0,n.jsx)(le.D,{label:(0,u.t)("options-ui.field-color.color-by-label","Color series by"),children:(0,n.jsx)(l.z,{value:me?.seriesBy??"last",options:St,onChange:ft})})]})}return(0,n.jsx)(z.l6,{minMenuHeight:200,options:$e,value:Et,onChange:at,inputId:Le})},Re=({mode:me,theme:ye})=>{if(!me.getColors)return null;const De=me.getColors(ye).map(ye.visualization.getColorByName),Le={height:"8px",width:"100%",margin:"2px 0",borderRadius:"3px",opacity:1};if(me.isContinuous)Le.background=`linear-gradient(90deg, ${De.join(",")})`;else{let Ve="",ze="";for(let Ze=0;Ze<De.length;Ze++){const Me=De[Ze];if(Ve==="")Ve=`linear-gradient(90deg, ${Me} 0%`;else{const at=Ze/De.length*100;Ve+=`, ${ze} ${at}%, ${Me} ${at}%`}ze=Me}Le.background=Ve}return(0,n.jsx)("div",{style:Le})},Oe=me=>({group:(0,c.css)({display:"flex"}),select:(0,c.css)({marginRight:me.spacing(1),flexGrow:1})});var Se=e(96822);const Te=({value:me,onChange:ye,context:De,item:Le})=>(0,n.jsx)(Se.e,{links:me,onChange:ye,data:De.data,getSuggestions:()=>De.getSuggestions?De.getSuggestions(de.uP.Values):[],showOneClick:Le.settings?.showOneClick});class _e extends p.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0,options:[]},this.updateOptions=async()=>{const{item:ye}=this.props,{settings:De}=ye;let Le=ye.settings?.options||[];De?.getOptions&&(Le=await De.getOptions(this.props.context)),this.state.options!==Le&&this.setState({isLoading:!1,options:Le})}}componentDidMount(){this.updateOptions()}componentDidUpdate(ye){const De=ye.item?.settings,Le=this.props.item?.settings;if(De!==Le)this.updateOptions();else if(Le?.getOptions){const Ve=ye.context?.data,ze=this.props.context?.data;Ve!==ze&&this.updateOptions()}}render(){const{options:ye,isLoading:De}=this.state,{value:Le,onChange:Ve,item:ze}=this.props,{settings:Ze}=ze;return(0,n.jsx)(z.KF,{isLoading:De,value:Le,defaultValue:Le,allowCustomValue:Ze?.allowCustomValue,onChange:Me=>{Ve(Me.map($e=>$e.value).flatMap($e=>$e!==void 0?[$e]:[]))},options:ye})}}var He=e(85053);class tt extends p.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0,options:[]},this.updateOptions=async()=>{const{item:ye}=this.props,{settings:De}=ye;let Le=ye.settings?.options||[];De?.getOptions&&(Le=await De.getOptions(this.props.context)),this.state.options!==Le&&this.setState({isLoading:!1,options:Le})}}componentDidMount(){this.updateOptions()}componentDidUpdate(ye){const De=ye.item?.settings,Le=this.props.item?.settings;if(De!==Le)this.updateOptions();else if(Le?.getOptions){const Ve=ye.context?.data,ze=this.props.context?.data;Ve!==ze&&this.updateOptions()}}render(){const{options:ye,isLoading:De}=this.state,{value:Le,onChange:Ve,item:ze}=this.props,{settings:Ze}=ze;let Me=ye.find($e=>$e.value===Le);return!Me&&Le&&(Me={label:`${Le}`,value:Le}),(0,n.jsx)(z.l6,{isLoading:De,value:Me,defaultValue:Le,allowCustomValue:Ze?.allowCustomValue,isClearable:Ze?.isClearable,onChange:$e=>Ve($e?.value),options:ye})}}var Je=e(21253),Ge=e(34107);const je=({value:me,onChange:ye,item:De,id:Le})=>(0,n.jsx)(Ge.S,{stats:me,onChange:ye,allowMultiple:!!De.settings?.allowMultiple,defaultStat:De.settings?.defaultStat,inputId:Le});var Fe=e(41185),Be=e(43173);class Ke extends p.PureComponent{constructor(){super(...arguments),this.state={showAdd:!1},this.onRemoveString=ye=>{const{value:De,onChange:Le}=this.props,Ve=[...De];Ve.splice(ye,1),Le(Ve)},this.onValueChange=(ye,De)=>{if("key"in ye&&ye.key!=="Enter")return;const{value:Le,onChange:Ve}=this.props,ze=ye.currentTarget.value.trim();if(De<0){ze&&(ye.currentTarget.value="",Ve([...Le,ze])),this.setState({showAdd:!1});return}if(!ze)return this.onRemoveString(De);const Ze=[...Le];Ze[De]=ze,Ve(Ze)}}render(){const{value:ye,item:De}=this.props,{showAdd:Le}=this.state,Ve=Ue(Be.$.theme2),ze=De.settings?.placeholder||"Add text";return(0,n.jsxs)("div",{children:[ye.map((Ze,Me)=>(0,n.jsx)(h.p,{className:Ve.textInput,defaultValue:Ze||"",onBlur:$e=>this.onValueChange($e,Me),onKeyDown:$e=>this.onValueChange($e,Me),suffix:(0,n.jsx)(K.I,{className:Ve.trashIcon,name:"trash-alt",onClick:()=>this.onRemoveString(Me)})},`${Me}/${Ze}`)),Le?(0,n.jsx)(h.p,{autoFocus:!0,className:Ve.textInput,placeholder:ze,defaultValue:"",onBlur:Ze=>this.onValueChange(Ze,-1),onKeyDown:Ze=>this.onValueChange(Ze,-1),suffix:(0,n.jsx)(K.I,{name:"plus-circle"})}):(0,n.jsx)(b.$n,{icon:"plus",size:"sm",variant:"secondary",onClick:()=>this.setState({showAdd:!0}),children:ze})]})}}const Ue=(0,C.N)(me=>({textInput:(0,c.css)({marginBottom:"5px","&:hover":{border:`1px solid ${me.components.input.borderHover}`}}),trashIcon:(0,c.css)({color:me.colors.text.secondary,cursor:"pointer","&:hover":{color:me.colors.text.primary}})}));var we=e(12965);function Xe({value:me,onChange:ye,item:De}){const Le=(0,S.of)(nt);return De?.settings?.isClearable&&me!=null?(0,n.jsxs)("div",{className:Le.wrapper,children:[(0,n.jsx)("span",{className:Le.first,children:(0,n.jsx)(we.p,{value:me,onChange:ye})}),(0,n.jsx)(E.K,{name:"times",onClick:()=>ye(void 0),tooltip:(0,u.t)("options-ui.units.clear-tooltip","Clear unit selection")})]}):(0,n.jsx)(we.p,{value:me,onChange:ye})}const nt=me=>({wrapper:(0,c.css)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center"}),first:(0,c.css)({marginRight:me.spacing(1),flexGrow:2})}),he=()=>{const me={id:"number",name:"Number",description:"Allows numeric values input",editor:He.w},ye={id:"slider",name:"Slider",description:"Allows numeric values input",editor:Je.G},De={id:"text",name:"Text",description:"Allows string values input",editor:Fe.g},Le={id:"strings",name:"String array",description:"An array of strings",editor:Ke},Ve={id:"boolean",name:"Boolean",description:"Allows boolean values input",editor(Jt){return(0,n.jsx)(o.d,{...Jt,onChange:Xt=>Jt.onChange(Xt.currentTarget.checked)})}},ze={id:"select",name:"Select",description:"Allows option selection",editor:tt},Ze={id:"multi-select",name:"Multi select",description:"Allows for multiple option selection",editor:_e},Me={id:"radio",name:"Radio",description:"Allows option selection",editor(Jt){return(0,n.jsx)(l.z,{...Jt,options:Jt.item.settings?.options})}},$e={id:"unit",name:"Unit",description:"Allows unit input",editor:Xe},at={id:"color",name:"Color",description:"Allows color selection",editor(Jt){return(0,n.jsx)(ce.a,{value:Jt.value,onChange:Jt.onChange,settings:Jt.item.settings,details:!0})}},ct={id:"fieldColor",name:"Field Color",description:"Field color selection",editor:Ee},ft={id:"links",name:"Links",description:"Allows defining data links",editor:Te},Et={id:"actions",name:"Actions",description:"Allows defining actions",editor:ae},St={id:"stats-picker",name:"Stats Picker",editor:je,description:""},Pt={id:"timezone",name:(0,u.t)("options-ui.registry.get-all-option-editors.name-time-zone","Time zone"),description:(0,u.t)("options-ui.registry.get-all-option-editors.description-time-zone","Time zone selection"),editor:g.U},Dt={id:"field-name",name:"Field name",description:"Allows selecting a field name from a data frame",editor:f.O};return[De,me,ye,Ve,Me,ze,$e,ft,Et,St,Le,Pt,ct,at,Ze,Dt,{id:"dashboard-uid",name:"Dashboard",description:"Select dashboard",editor:oe},{id:"mappings",name:"Mappings",description:"Allows defining value mappings",editor:q},{id:"thresholds",name:"Thresholds",description:"Allows defining thresholds",editor:W}]},xe=()=>{const me=[(0,u.t)("options-ui.registry.standard-field-configs.category","Standard options")],ye={id:"displayName",path:"displayName",name:(0,u.t)("options-ui.registry.standard-field-configs.name-display-name","Display name"),description:(0,u.t)("options-ui.registry.standard-field-configs.description-display-name","Change the field or series name"),editor:a.D.get("text").editor,override:a.D.get("text").editor,process:s.AM,settings:{placeholder:(0,u.t)("options-ui.registry.standard-field-configs.placeholder-display-name","none"),expandTemplateVars:!0},shouldApply:()=>!0,category:me},De={id:"unit",path:"unit",name:(0,u.t)("options-ui.registry.standard-field-configs.name-unit","Unit"),description:"",editor:a.D.get("unit").editor,override:a.D.get("unit").editor,process:s.OU,settings:{placeholder:(0,u.t)("options-ui.registry.standard-field-configs.placeholder-unit","none")},shouldApply:()=>!0,category:me},Le={id:"fieldMinMax",path:"fieldMinMax",name:(0,u.t)("options-ui.registry.standard-field-configs.name-field-min-max","Field min/max"),description:(0,u.t)("options-ui.registry.standard-field-configs.description-field-min-max","Calculate min max per field"),editor:a.D.get("boolean").editor,override:a.D.get("boolean").editor,process:s.FM,shouldApply:Dt=>Dt.type===i.PU.number,showIf:Dt=>Dt.min===void 0||Dt.max===void 0,category:me},Ve={id:"min",path:"min",name:(0,u.t)("options-ui.registry.standard-field-configs.name-min","Min"),description:(0,u.t)("options-ui.registry.standard-field-configs.description-min","Leave empty to calculate based on all values"),editor:a.D.get("number").editor,override:a.D.get("number").editor,process:s.m0,settings:{placeholder:(0,u.t)("options-ui.registry.standard-field-configs.placeholder-min","auto")},shouldApply:Dt=>Dt.type===i.PU.number,category:me},ze={id:"max",path:"max",name:(0,u.t)("options-ui.registry.standard-field-configs.name-max","Max"),description:(0,u.t)("options-ui.registry.standard-field-configs.description-max","Leave empty to calculate based on all values"),editor:a.D.get("number").editor,override:a.D.get("number").editor,process:s.m0,settings:{placeholder:(0,u.t)("options-ui.registry.standard-field-configs.placeholder-max","auto")},shouldApply:Dt=>Dt.type===i.PU.number,category:me},Ze={id:"decimals",path:"decimals",name:(0,u.t)("options-ui.registry.standard-field-configs.name-decimals","Decimals"),editor:a.D.get("number").editor,override:a.D.get("number").editor,process:s.m0,settings:{placeholder:(0,u.t)("options-ui.registry.standard-field-configs.placeholder-decimals","auto"),min:0,max:15,integer:!0},shouldApply:Dt=>Dt.type===i.PU.number,category:me},Me={id:"noValue",path:"noValue",name:(0,u.t)("options-ui.registry.standard-field-configs.name-no-value","No value"),description:(0,u.t)("options-ui.registry.standard-field-configs.description-no-value","What to show when there is no value"),editor:a.D.get("text").editor,override:a.D.get("text").editor,process:s.OU,settings:{placeholder:"-"},shouldApply:()=>!0,category:me},$e=(0,u.t)("options-ui.registry.standard-field-condigs.category-data-links","Data links and actions"),at={id:"links",path:"links",name:(0,u.t)("options-ui.registry.standard-field-configs.name-data-links","Data links"),editor:a.D.get("links").editor,override:a.D.get("links").editor,process:s.Ch,settings:{showOneClick:!1},shouldApply:()=>!0,category:[$e],getItemsCount:Dt=>Dt?Dt.length:0},ct={id:"actions",path:"actions",name:(0,u.t)("options-ui.registry.standard-field-configs.name-actions","Actions"),editor:a.D.get("actions").editor,override:a.D.get("actions").editor,process:s.cz,settings:{showOneClick:!1},shouldApply:()=>!0,category:[$e],getItemsCount:Dt=>Dt?Dt.length:0,hideFromDefaults:!0},ft={id:"color",path:"color",name:(0,u.t)("options-ui.registry.standard-field-configs.name-color-scheme","Color scheme"),editor:a.D.get("fieldColor").editor,override:a.D.get("fieldColor").editor,process:s.hS,shouldApply:()=>!0,settings:{byValueSupport:!0,preferThresholdsMode:!0},category:me},Et={id:"mappings",path:"mappings",name:(0,u.t)("options-ui.registry.standard-field-configs.name-value-mappings","Value mappings"),description:(0,u.t)("options-ui.registry.standard-field-configs.description-value-mappings","Modify the display text based on input value"),editor:a.D.get("mappings").editor,override:a.D.get("mappings").editor,process:s.xT,settings:{},defaultValue:[],shouldApply:Dt=>Dt.type!==i.PU.time,category:[(0,u.t)("options-ui.registry.standard-field-configs.category-value-mappings","Value mappings")],getItemsCount:Dt=>Dt?Dt.length:0},St={id:"thresholds",path:"thresholds",name:(0,u.t)("options-ui.registry.standard-field-configs.name-thresholds","Thresholds"),editor:a.D.get("thresholds").editor,override:a.D.get("thresholds").editor,process:s.N7,settings:{},defaultValue:{mode:r.O.Absolute,steps:[{value:-1/0,color:"green"},{value:80,color:"red"}]},shouldApply:()=>!0,category:[(0,u.t)("options-ui.registry.standard-field-configs.category-thresholds","Thresholds")],getItemsCount:Dt=>Dt?Dt.steps.length:0},Pt={id:"filterable",path:"filterable",name:(0,u.t)("options-ui.registry.standard-field-configs.name-ad-hoc","Ad-hoc filterable"),hideFromDefaults:!0,editor:a.D.get("boolean").editor,override:a.D.get("boolean").editor,process:s.FM,shouldApply:()=>!0,settings:{},category:me};return[De,Ve,ze,Le,Ze,ye,ft,Me,at,ct,Et,St,Pt]}},21253:(te,R,e)=>{"use strict";e.d(R,{G:()=>g});var n=e(74848),a=e(22803),s=e(17437),i=e(69156),r=e(96540),u=e(63142),o=e(91302),l=e(19753);const g=({value:c,onChange:x,item:v})=>{const m=(0,r.useRef)(null),{settings:y}=v,h=y?.min||0,d=y?.max||100,E=y?.step,b=y?.marks||{[h]:h,[d]:d},D=y?.included,C=y?.ariaLabelForHandle,P=75,M=!0,O=(0,u.$j)(),[j,U]=(0,r.useState)(c??h),[W,B]=(0,r.useState)(P);(0,r.useEffect)(()=>{c!=null&&c!==j&&U(c)},[c,j]),(0,r.useEffect)(()=>{const A=getComputedStyle(m.current),N=A.getPropertyValue("font-weight")||"normal",V=A.getPropertyValue("font-size")||"16px",z=A.getPropertyValue("font-family")||"Arial",w="0",H=4,Q=8,Z=Math.max((d+(E||0)).toString().length,(d-(E||0)).toString().length)+H,Y=w.repeat(Z),X=f(Y,`${N} ${V} ${z}`);X&&B(X+Q*2)},[d,E]);const S=(0,r.useCallback)(A=>{const N=typeof A=="number"?A:A[0];U(N),x&&x(N)},[U,x]),_=(0,r.useCallback)(A=>{let N=A;(Number.isNaN(N)||!N)&&(N=0),U(N),x&&x(N)},[x]),K=(0,o.$)(O,M,!!b),T=p(O,W),L=M?[]:[K.sliderInputVertical];return(0,n.jsxs)("div",{className:(0,a.cx)(K.container,K.slider),children:[(0,n.jsx)(s.Global,{styles:K.slider}),(0,n.jsxs)("div",{className:(0,a.cx)(K.sliderInput,...L),children:[(0,n.jsx)(i.A,{min:h,max:d,step:E,defaultValue:c,value:j,onChange:S,vertical:!M,reverse:!1,ariaLabelForHandle:C,marks:b,included:D}),(0,n.jsx)("span",{className:T.numberInputWrapper,ref:m,children:(0,n.jsx)(l.Q,{value:j,onChange:_,max:d,min:h,step:E})})]})]})};function f(c,x){const m=document.createElement("canvas").getContext("2d");return m?(m.font=x,m.measureText(c).width):null}const p=(c,x)=>({numberInputWrapper:(0,a.css)({marginLeft:c.spacing(3),maxHeight:"32px",maxWidth:x,minWidth:x,overflow:"visible",width:"100%"})})},41185:(te,R,e)=>{"use strict";e.d(R,{g:()=>r});var n=e(74848),a=e(96540),s=e(87105),i=e(63527);const r=({value:u,onChange:o,item:l,suffix:g})=>{const f=l.settings?.useTextarea?s.f:i.p,p=(0,a.useCallback)(c=>{let x=u??"";"key"in c?c.key==="Enter"&&!l.settings?.useTextarea&&(x=c.currentTarget.value.trim()):x=c.currentTarget.value.trim(),x!==u&&o(x===""?void 0:x)},[u,l.settings?.useTextarea,o]);return(0,n.jsx)(f,{placeholder:l.settings?.placeholder,defaultValue:u||"",rows:l.settings?.useTextarea&&l.settings.rows||5,onBlur:p,onKeyDown:p,suffix:g})}},13791:(te,R,e)=>{"use strict";e.d(R,{Y:()=>V});var n=e(74848),a=e(22803),s=e(96540),i=e(75683),r=e(63142),u=e(27963),o=e(94076),l=e(11098);const g=({isLoading:w,children:H,className:Q})=>{let Z=Q?(0,n.jsx)("div",{className:Q,children:H}):H;return(0,n.jsx)(n.Fragment,{children:w?(0,n.jsx)(l.A,{}):Z})};function f({info:w}){const H=(0,r.of)(p);return(0,n.jsx)("div",{className:H.container,children:w.map((Q,Z)=>(0,n.jsxs)(s.Fragment,{children:[(0,n.jsxs)("div",{className:H.infoItem,children:[(0,n.jsx)("div",{className:H.label,children:Q.label}),Q.value]}),Z+1<w.length&&(0,n.jsx)("div",{"data-testid":"page-info-separator",className:H.separator})]},Z))})}const p=w=>({container:(0,a.css)({display:"flex",flexDirection:"row",gap:w.spacing(1.5),overflow:"auto"}),infoItem:(0,a.css)({...w.typography.bodySmall,display:"flex",flexDirection:"column",gap:w.spacing(.5)}),label:(0,a.css)({color:w.colors.text.secondary}),separator:(0,a.css)({borderLeft:`1px solid ${w.colors.border.weak}`})});var c=e(92745),x=e(68143),v=e(66404),m=e(76319),y=e(37386),h=e(63527);const d=({value:w,onEdit:H})=>{const Q=(0,r.of)(E),[Z,Y]=(0,s.useState)(w),[X,I]=(0,s.useState)(!1),[J,ee]=(0,s.useState)(!1),[q,ne]=(0,s.useState)();(0,s.useEffect)(()=>{Y(w)},[w]);const se=(0,s.useCallback)(async oe=>{const de=oe.currentTarget.value;if(!de)ne("Please enter a title");else if(de===w)ne(void 0),I(!1);else{ee(!0);try{await H(de),ne(void 0),I(!1)}catch(fe){(0,x.NF)(fe)?ne(fe.data.message):fe instanceof Error&&ne(fe.message)}ee(!1)}},[H,w]);return X?(0,n.jsx)("div",{className:Q.inputContainer,children:(0,n.jsx)(y.D,{className:Q.field,loading:J,invalid:!!q,error:q,children:(0,n.jsx)(h.p,{className:Q.input,defaultValue:Z,onKeyDown:oe=>{oe.key==="Enter"&&se(oe)},autoFocus:!0,onBlur:se,onChange:oe=>Y(oe.currentTarget.value),onFocus:()=>I(!0)})})}):(0,n.jsx)("div",{className:Q.textContainer,children:(0,n.jsxs)("div",{className:Q.textWrapper,children:[(0,n.jsx)(v.E,{element:"h1",truncate:!0,children:Z}),(0,n.jsx)(m.K,{name:"pen",size:"lg",tooltip:(0,c.t)("page.editable-title.edit-tooltip","Edit title"),onClick:()=>I(!0)})]})})};d.displayName="EditableTitle";const E=w=>({textContainer:(0,a.css)({minWidth:0}),field:(0,a.css)({flex:1,left:`calc(-${w.spacing(1)} - 1px)`,position:"relative",marginBottom:0}),input:(0,a.css)({input:{...w.typography.h1}}),inputContainer:(0,a.css)({display:"flex",flex:1}),textWrapper:(0,a.css)({alignItems:"center",display:"flex",gap:w.spacing(1),height:w.spacing(w.components.height.md)})});function b({navItem:w,renderTitle:H,actions:Q,info:Z,subTitle:Y,onEditTitle:X}){const I=(0,r.of)(D),J=Y??w.subTitle,ee=X?(0,n.jsx)(d,{value:w.text,onEdit:X}):(0,n.jsxs)("div",{className:I.title,children:[w.img&&(0,n.jsx)("img",{className:I.img,src:w.img,alt:`logo for ${w.text}`}),H?H(w.text):(0,n.jsx)("h1",{children:w.text})]});return(0,n.jsxs)("div",{className:I.pageHeader,children:[(0,n.jsxs)("div",{className:I.topRow,children:[(0,n.jsxs)("div",{className:I.titleInfoContainer,children:[ee,Z&&(0,n.jsx)(f,{info:Z})]}),(0,n.jsx)("div",{className:I.actions,children:Q})]}),J&&(0,n.jsx)("div",{className:I.subTitle,children:J})]})}const D=w=>({topRow:(0,a.css)({alignItems:"flex-start",display:"flex",flexDirection:"row",flexWrap:"wrap",gap:w.spacing(1,3)}),title:(0,a.css)({display:"flex",flexDirection:"row",maxWidth:"100%",flex:1,h1:{marginBottom:0}}),actions:(0,a.css)({display:"flex",flexDirection:"row",gap:w.spacing(1)}),titleInfoContainer:(0,a.css)({display:"flex",label:"title-info-container",flex:1,flexWrap:"wrap",gap:w.spacing(1,4),justifyContent:"space-between",maxWidth:"100%",minWidth:"200px"}),pageHeader:(0,a.css)({label:"page-header",display:"flex",flexDirection:"column",gap:w.spacing(1),marginBottom:w.spacing(2)}),subTitle:(0,a.css)({position:"relative",color:w.colors.text.secondary}),img:(0,a.css)({width:"32px",height:"32px",marginRight:w.spacing(2)})});var C=e(54314),P=e(30360),M=e(60208);function O({navItem:w}){const H=(0,r.of)(j);return(0,n.jsx)("div",{className:H.tabsWrapper,children:(0,n.jsx)(C.U,{children:w.children.map((Q,Z)=>{const Y=Q.icon?(0,P.Uo)(Q.icon):void 0;return!Q.hideFromTabs&&(0,n.jsx)(M.o,{label:Q.text,active:Q.active,icon:Y,counter:Q.tabCounter,href:Q.url,suffix:Q.tabSuffix,onChangeTab:Q.onClick},`${Q.url}-${Z}`)})})})}const j=w=>({tabsWrapper:(0,a.css)({paddingBottom:w.spacing(3)})});var U=e(25508),W=e(84057),B=e(8535),S=e(52763);function _(w,H){if(H)return H;if(w&&B.M_)return(0,S.d4)((0,U.Mz)(K,Q=>(0,W.tc)(Q,w??"home")))}function K(w){return w.navIndex}var T=e(43550),L=e(92948),A=e(18607);function N(w,H){const Q=(0,S.d4)(Z=>Z.navIndex)?.[T.Id];(0,s.useEffect)(()=>{const Z=(w?.node!==w?.main?w?.node:w?.main)??{text:"Grafana"},Y=(0,A.Z)(Z,H,Q).map(X=>X.text).reverse();Y[Y.length-1]=L.M.AppTitle,document.title=Y.join(" - ")},[Q,w,H])}const V=({navId:w,navModel:H,pageNav:Q,renderTitle:Z,onEditTitle:Y,actions:X,subTitle:I,children:J,className:ee,info:q,layout:ne=i.k.Standard,onSetScrollRef:se,...oe})=>{const de=(0,r.of)(z),fe=_(w,H),{chrome:ae}=(0,u.Il)();N(fe,Q);const ce=Q??fe?.node;return(0,s.useLayoutEffect)(()=>{fe&&ae.update({sectionNav:fe,pageNav:Q,layout:ne})},[fe,Q,ae,ne]),(0,n.jsxs)("div",{className:(0,a.cx)(de.wrapper,ee),...oe,children:[ne===i.k.Standard&&(0,n.jsx)(o.A,{divId:"page-scrollbar",onSetScrollRef:se,children:(0,n.jsxs)("div",{className:de.pageInner,children:[ce&&(0,n.jsx)(b,{actions:X,onEditTitle:Y,navItem:ce,renderTitle:Z,info:q,subTitle:I}),Q&&Q.children&&(0,n.jsx)(O,{navItem:Q}),(0,n.jsx)("div",{className:de.pageContent,children:J})]})}),ne===i.k.Canvas&&(0,n.jsx)(o.A,{divId:"page-scrollbar",onSetScrollRef:se,children:(0,n.jsx)("div",{className:de.canvasContent,children:J})}),ne===i.k.Custom&&J]})};V.Contents=g;const z=w=>({wrapper:(0,a.css)({label:"page-wrapper",display:"flex",flex:"1 1 0",flexDirection:"column",position:"relative"}),pageContent:(0,a.css)({label:"page-content",flexGrow:1}),primaryBg:(0,a.css)({background:w.colors.background.primary}),pageInner:(0,a.css)({label:"page-inner",padding:w.spacing(2),borderBottom:"none",background:w.colors.background.primary,display:"flex",flexDirection:"column",flexGrow:1,margin:w.spacing(0,0,0,0),[w.breakpoints.up("md")]:{padding:w.spacing(4)}}),canvasContent:(0,a.css)({label:"canvas-content",display:"flex",flexDirection:"column",padding:w.spacing(2),flexBasis:"100%",flexGrow:1})})},11098:(te,R,e)=>{"use strict";e.d(R,{A:()=>r});var n=e(74848),a=e(31286),s=e(6975);const r=({pageName:u=""})=>{const o=`Loading ${u}...`;return(0,n.jsx)(a.a,{display:"flex",alignItems:"center",direction:"column",justifyContent:"center",paddingTop:10,children:(0,n.jsx)(s._,{text:o})})}},1506:(te,R,e)=>{"use strict";e.d(R,{L:()=>l});var n=e(74848),a=e(22803),s=e(51898),i=e(92745),r=e(63142),u=e(50201),o=e(89640);function l({entity:f="Page"}){const p=(0,r.of)(g),c=f.toLowerCase();return(0,n.jsx)("div",{className:p.container,"data-testid":s.Tp.components.EntityNotFound.container,children:(0,n.jsx)(u.p,{message:`${f} not found`,variant:"not-found",children:(0,n.jsxs)(i.x6,{i18nKey:"entity-not-found.description",children:["We're looking but can't seem to find this ",{lowerCaseEntity:c},". Try returning"," ",(0,n.jsx)(o.Y,{href:"/",children:"home"})," or seeking help on the"," ",(0,n.jsx)(o.Y,{href:"https://community.grafana.com",external:!0,children:"community site."})]})})})}function g(f){return{container:(0,a.css)({padding:f.spacing(8,2,2,2)})}}},86678:(te,R,e)=>{"use strict";e.d(R,{H:()=>r});var n=e(74848),a=e(75683),s=e(13791),i=e(1506);function r(){return(0,n.jsx)(s.Y,{navId:"home",layout:a.k.Canvas,pageNav:{text:"Page not found"},children:(0,n.jsx)(i.L,{entity:"Page"})})}},92100:(te,R,e)=>{"use strict";e.d(R,{$:()=>f});var n=e(74848),a=e(22803),s=e(96540),i=e(92745),r=e(63142),u=e(45861),o=e(18857),l=e(30703),g=e(52193);const f=({onChange:c,maxMenuHeight:x})=>{const v=(0,s.useMemo)(g.A4,[]),m=(0,s.useMemo)(()=>v.map(D=>({label:D.name,imgUrl:D.info.logos.small,value:D})).sort((D,C)=>D.label?.localeCompare(C.label)),[v]),[y,h]=(0,s.useState)([]),d=(0,s.useCallback)(D=>{const C=D.filter(P=>P.value).map(P=>P.value);c(C),h(D)},[c]),E=(0,r.of)(p),b={defaultOptions:!0,getOptionLabel:D=>D.label,getOptionValue:D=>D.value,noOptionsMessage:(0,i.t)("panel-type-filter.select-no-options","No panel types found"),placeholder:(0,i.t)("panel-type-filter.select-placeholder","Filter by type"),maxMenuHeight:x,options:m,value:y,onChange:d};return(0,n.jsxs)("div",{className:E.container,children:[y.length>0&&(0,n.jsx)(u.$n,{size:"xs",icon:"trash-alt",fill:"text",className:E.clear,onClick:()=>d([]),children:(0,n.jsx)(i.x6,{i18nKey:"panel-type-filter.clear-button",children:"Clear types"})}),(0,n.jsx)(o.KF,{...b,prefix:(0,n.jsx)(l.I,{name:"filter"}),"aria-label":(0,i.t)("panel-type-filter.select-aria-label","Panel type filter")})]})};function p(c){return{container:(0,a.css)({label:"container",position:"relative",minWidth:"180px",flexGrow:1}),clear:(0,a.css)({label:"clear",fontSize:c.spacing(1.5),position:"absolute",top:c.spacing(-4.5),right:0})}}},68805:(te,R,e)=>{"use strict";e.d(R,{j:()=>u});var n=e(74848),a=e(22803),s=e(96540),i=e(67458),r=e(63142);const u=s.memo(s.forwardRef(({className:g,children:f,markdown:p,styleOverrides:c,onRemove:x,...v},m)=>{const y=(0,r.of)(h=>l(h,c?.borderTop));return(0,n.jsxs)("div",{className:(0,a.cx)(y.wrapper,g),...v,ref:m,children:[p&&o(p),f]})}));function o(g){const f=(0,i.G)(g);return(0,n.jsx)("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:f}})}u.displayName="OperationRowHelp";const l=(g,f)=>{const p=g.shape.radius.default,c=g.colors.background.secondary;return{wrapper:(0,a.css)({padding:g.spacing(2),border:`2px solid ${c}`,borderTop:f?f+c:"none",borderRadius:`0 0 ${p} ${p}`,position:"relative",top:"-4px"})}}},43260:(te,R,e)=>{"use strict";e.d(R,{A:()=>l,q:()=>o});var n=e(74848),a=e(22803),s=e(51898),i=e(63142),r=e(76319);function u(f){const p=(0,i.of)(g);return(0,n.jsx)("div",{className:(0,a.cx)(p.icon,"active"in f&&f.active&&p.active),children:(0,n.jsx)(r.K,{name:f.icon,tooltip:f.title,className:p.icon,disabled:!!f.disabled,onClick:f.onClick,type:"button","data-testid":f.dataTestId??s.Tp.components.QueryEditorRow.actionButton(f.title),..."active"in f&&{"aria-pressed":f.active}})})}function o(f){return(0,n.jsx)(u,{...f})}const l=f=>(0,n.jsx)(u,{...f}),g=f=>({icon:(0,a.css)({display:"flex",position:"relative",color:f.colors.text.secondary}),active:(0,a.css)({"&:before":{display:"block",content:'" "',position:"absolute",left:-1,right:2,height:3,borderRadius:f.shape.radius.default,bottom:-8,backgroundImage:f.colors.gradients.brandHorizontal}})})},85348:(te,R,e)=>{"use strict";e.d(R,{u:()=>m});var n=e(74848),a=e(22803),s=e(89332),i=e(96540),r=e(22589),u=e(27489),o=e(63142),l=e(44019),g=e(92745),f=e(76319),p=e(41654),c=e(30703);const x=({actionsElement:h,disabled:d,draggable:E,collapsable:b=!0,dragHandleProps:D,headerElement:C,isContentVisible:P,onRowToggle:M,reportDragMousePosition:O,title:j,id:U,expanderMessages:W})=>{const B=(0,o.of)(v);let S=P?(0,g.t)("query-operation.header.collapse-row","Collapse query row"):(0,g.t)("query-operation.header.expand-row","Expand query row");W!==void 0&&P?S=W.close:W!==void 0&&(S=W?.open);const _=(0,g.t)("query-operation.header.drag-and-drop","Drag and drop to reorder");return(0,n.jsxs)("div",{className:B.header,children:[(0,n.jsxs)("div",{className:B.column,children:[b&&(0,n.jsx)(f.K,{name:P?"angle-down":"angle-right",tooltip:S,className:B.collapseIcon,onClick:M,"aria-expanded":P,"aria-controls":U}),j&&(0,n.jsx)("div",{className:B.titleWrapper,onClick:M,children:(0,n.jsx)("div",{className:(0,a.cx)(B.title,d&&B.disabled),children:j})}),C]}),(0,n.jsxs)(p.B,{gap:1,alignItems:"center",children:[h,E&&(0,n.jsx)("div",{onMouseMove:O,...D,children:(0,n.jsx)(c.I,{title:_,name:"draggabledots",size:"lg",className:B.dragIcon})})]})]})},v=h=>({header:(0,a.css)({label:"Header",padding:h.spacing(.5,.5),borderRadius:h.shape.radius.default,background:h.colors.background.secondary,minHeight:h.spacing(4),display:"grid",gridTemplateColumns:"minmax(100px, max-content) min-content",alignItems:"center",justifyContent:"space-between",whiteSpace:"nowrap","&:focus":{outline:"none"}}),column:(0,a.css)({label:"Column",display:"flex",alignItems:"center",overflow:"hidden"}),dragIcon:(0,a.css)({cursor:"grab",color:h.colors.text.disabled,margin:h.spacing(0,.5),"&:hover":{color:h.colors.text.primary}}),collapseIcon:(0,a.css)({marginLeft:h.spacing(.5),color:h.colors.text.disabled}),titleWrapper:(0,a.css)({display:"flex",alignItems:"center",flexGrow:1,cursor:"pointer",overflow:"hidden",marginRight:h.spacing(.5)}),title:(0,a.css)({fontWeight:h.typography.fontWeightBold,color:h.colors.text.link,marginLeft:h.spacing(.5),overflow:"hidden",textOverflow:"ellipsis"}),disabled:(0,a.css)({color:h.colors.text.disabled})});x.displayName="QueryOperationRowHeader";function m({children:h,actions:d,title:E,headerElement:b,onClose:D,onOpen:C,isOpen:P,disabled:M,draggable:O,collapsable:j,index:U,id:W,expanderMessages:B}){const[S,_]=(0,i.useState)(P!==void 0?P:!0),K=(0,o.of)(y),T=(0,i.useCallback)(()=>{_(!S)},[S,_]);(0,i.useEffect)(()=>{typeof P=="boolean"&&_(P)},[P]);const L=(0,i.useCallback)(z=>{if(z.defaultPrevented){const w=z.currentTarget.getBoundingClientRect(),H=z.clientX-w.left,Q=z.clientY-w.top;(0,u.rR)("query_row_reorder_drag_position",{x:H/w.width,y:Q/w.height,width:w.width,height:w.height})}},[]);(0,r.A)(()=>{S?C&&C():D&&D()},[S]);const A={isOpen:S,onOpen:()=>{_(!0)},onClose:()=>{_(!1)}},N=d&&l.renderOrCallToRender(d,A),V=b&&l.renderOrCallToRender(b,A);return O?(0,n.jsx)(s.sx,{draggableId:W,index:U,children:z=>(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{ref:z.innerRef,className:K.wrapper,...z.draggableProps,children:[(0,n.jsx)("div",{children:(0,n.jsx)(x,{id:W,actionsElement:N,disabled:M,draggable:!0,collapsable:j,dragHandleProps:z.dragHandleProps,headerElement:V,isContentVisible:S,onRowToggle:T,reportDragMousePosition:L,title:E,expanderMessages:B})}),S&&(0,n.jsx)("div",{className:K.content,children:h})]})})}):(0,n.jsxs)("div",{className:K.wrapper,children:[(0,n.jsx)(x,{id:W,actionsElement:N,disabled:M,draggable:!1,collapsable:j,headerElement:V,isContentVisible:S,onRowToggle:T,reportDragMousePosition:L,title:E,expanderMessages:B}),S&&(0,n.jsx)("div",{className:K.content,children:h})]})}const y=h=>({wrapper:(0,a.css)({marginBottom:h.spacing(2)}),content:(0,a.css)({marginTop:h.spacing(.5),marginLeft:h.spacing(3)})});m.displayName="QueryOperationRow"},30868:(te,R,e)=>{"use strict";e.d(R,{y:()=>f});var n=e(74848),a=e(55494),s=e(63704),i=e(24726);const r=2,u=5,o=v=>{const m=v.match(new RegExp('<style type="text/css">([\\s\\S]*?)<\\/style>'));return m?m[0]:null},l=v=>v.match(new RegExp(`<svg.*id\\s*=\\s*(['"])(.*?)\\1`))?.[r],g=v=>{let m=l(v);if(!m){m=`x${(0,i.A)()}`;const h=v.indexOf("<svg")+u;v=v.substring(0,h)+`id="${m}" `+v.substring(h)}let y=o(v);if(y){let h=y.replace(/(#(.*?))?\./g,`#${m} .`);v=v.replace(y,h)}return v},f=v=>{const{cleanStyle:m,...y}=v;return(0,n.jsx)(a.default,{...y,cacheRequests:!0,preProcessor:m?x:c})};let p=new Map;function c(v){let m=p.get(v);return m||(m=s.sQ.sanitizeSVGContent(v),p.set(v,m)),m}function x(v){let m=p.get(v);return m||(m=s.sQ.sanitizeSVGContent(v),m.indexOf('<style type="text/css">')>-1&&(m=g(m)),p.set(v,m)),m}},95506:(te,R,e)=>{"use strict";e.d(R,{b:()=>x});var n=e(74848),a=e(76459),s=e.n(a),i=e(96540),r=e(18857),u=e(83873),o=e(75735),l=e(13956),g=e(60171);const f=(v="Dashboards",m)=>`${v}/${m}`;async function p(v=""){return u.IB.search({type:"dash-db",query:v,limit:100}).then(m=>m.map(y=>({value:{uid:y.uid,title:y.title,folderTitle:y.folderTitle,folderUid:y.folderUid},label:f(y?.folderTitle,y.title)})))}const c=s()(p,250,{leading:!0}),x=(0,i.forwardRef)(({value:v,onChange:m,placeholder:y="Select dashboard",noOptionsMessage:h="No dashboards found",...d},E)=>{const[b,D]=(0,i.useState)();(0,i.useEffect)(()=>{!v||v===b?.value?.uid||(async()=>{const P=await(0,l.n)().getDashboardDTO(v,void 0);(0,g.HG)(P)?D({value:{uid:P.metadata.name,title:P.spec.title,folderTitle:P.metadata.annotations?.[o.w2],folderUid:P.metadata.annotations?.[o.ew]},label:f(P.metadata.annotations?.[o.ew],P.spec.title)}):P.dashboard&&D({value:{uid:P.dashboard.uid,title:P.dashboard.title,folderTitle:P.meta.folderTitle,folderUid:P.meta.folderUid},label:f(P.meta?.folderTitle,P.dashboard.title)})})()},[v]);const C=(0,i.useCallback)(P=>{D(P),m?.(P?.value)},[m,D]);return(0,n.jsx)(r.DW,{loadOptions:c,onChange:C,placeholder:y,noOptionsMessage:h,value:b,defaultOptions:!0,...d,selectRef:E})})},91156:(te,R,e)=>{"use strict";e.d(R,{d:()=>a});var n=e(3208);const a=n.NestedFolderPicker},18552:(te,R,e)=>{"use strict";e.d(R,{r:()=>g});var n=e(74848),a=e(16817),s=e(92745),i=e(18857),r=e(30703),u=e(99090),o=e(55860);const l=()=>(0,o.S)().getSortOptions();function g({onChange:f,value:p,placeholder:c,filter:x,getSortOptions:v,isClearable:m}){const y=(0,a.A)(async()=>{const d=await(v??l)();return x?d.filter(E=>x.includes(E.value)):d},[v,x]);if(y.loading)return null;const h=!!(p?.includes("desc")||p?.startsWith("-"));return(0,n.jsx)(i.l6,{width:28,onChange:f,value:y.value?.find(d=>d.value===p)??null,options:y.value,"aria-label":(0,s.t)("sort-picker.select-aria-label","Sort"),placeholder:c??`Sort (Default ${u.r4.label})`,prefix:(0,n.jsx)(r.I,{name:h?"sort-amount-down":"sort-amount-up"}),isClearable:m},p)}},11297:(te,R,e)=>{"use strict";e.d(R,{$:()=>o,E:()=>u});var n=e(74848),a=e(22803),s=e(48542),i=e(63142),r=e(30703);const u=({count:l,label:g,onClick:f,removeIcon:p})=>{const{color:c}=(0,s.MC)(g),x=(0,i.of)(o),v=l!==0&&(0,n.jsx)("span",{style:{marginLeft:"3px"},children:`(${l})`});return(0,n.jsxs)("span",{className:x.badge,style:{backgroundColor:c},children:[p&&(0,n.jsx)(r.I,{onClick:f,name:"times"}),g," ",v]})},o=l=>({badge:(0,a.css)({...l.typography.bodySmall,backgroundColor:l.v1.palette.gray1,borderRadius:l.shape.radius.default,color:l.v1.palette.white,display:"inline-block",height:"20px",lineHeight:"20px",padding:l.spacing(0,.75),verticalAlign:"baseline",whiteSpace:"nowrap","&:hover":{opacity:.85}})})},93732:(te,R,e)=>{"use strict";e.d(R,{$:()=>v});var n=e(74848),a=e(22803),s=e(96540),i=e(73757),r=e(8934),u=e(92745),o=e(63142),l=e(18857),g=e(30703),f=e(11297);const p=({data:y,className:h,label:d,isFocused:E,innerProps:b})=>{const D=(0,o.of)(c);return(0,n.jsx)("div",{className:(0,a.cx)(D.option,E&&D.optionFocused),"aria-label":(0,u.t)("tag-filter.tag-option-label","Tag option"),...b,children:(0,n.jsx)("div",{className:(0,a.cx)(D.optionInner,h),children:typeof d=="string"?(0,n.jsx)(f.E,{label:d,removeIcon:!1,count:y.count??0}):d})})},c=y=>({option:(0,a.css)({padding:y.spacing(.5),whiteSpace:"nowrap",cursor:"pointer",borderLeft:"2px solid transparent",borderRadius:y.shape.radius.default,"&:hover":{background:y.colors.action.hover}}),optionFocused:(0,a.css)({background:y.colors.action.focus,borderStyle:"solid",borderTop:0,borderRight:0,borderBottom:0,borderLeftWidth:"2px"}),optionInner:(0,a.css)({position:"relative",textAlign:"left",width:"100%",display:"block",cursor:"pointer",padding:"2px 0"})}),x=(y,h)=>{const d=RegExp((0,r.jD)(h),"i");return!!(y.value&&d.test(y.value))},v=({allowCustomValue:y=!1,formatCreateLabel:h,hideValues:d,inputId:E,isClearable:b,onChange:D,placeholder:C,tagOptions:P,tags:M,width:O})=>{const j=(0,o.of)(m),U=M.map(Q=>({value:Q,label:Q,count:0})),[W,B]=(0,s.useState)(U),[S,_]=(0,s.useState)(!1),[K,T]=(0,s.useState)(M),[L,A]=(0,s.useState)(U),N=(0,s.useMemo)(()=>M.join(),[M]),V=(0,s.useCallback)(async()=>(await P()).map(Z=>M.includes(Z.term)?{value:Z.term,label:Z.term,count:0}:{value:Z.term,label:Z.term,count:Z.count}),[P,M]),z=(0,s.useCallback)(async()=>{_(!0);const Q=await V();y&&L.forEach(Z=>Q.push(Z)),B(Q),_(!1)},[y,L,V]);(0,s.useEffect)(()=>{M.length>0&&W.length===0&&z()},[z,W.length,M.length]),(0,s.useEffect)(()=>{M!==K&&(T(M),z())},[z,K,M]);const w=Q=>{Q.forEach(Z=>Z.count=0),D((Q||[]).map(Z=>Z.value)),y&&A(Q.filter(Z=>!M.includes(Z)))},H={onFocus:z,isLoading:S,options:W,allowCreateWhileLoading:!0,allowCustomValue:y,formatCreateLabel:h,defaultOptions:!0,filterOption:x,getOptionLabel:Q=>Q.label,getOptionValue:Q=>Q.value,inputId:E,isMulti:!0,onChange:w,loadingMessage:(0,u.t)("tag-filter.loading","Loading..."),noOptionsMessage:(0,u.t)("tag-filter.no-tags","No tags found"),placeholder:C||(0,u.t)("tag-filter.placeholder","Filter by tag"),value:U,width:O,components:{Option:p,MultiValueLabel:()=>null,MultiValueRemove(Q){const{data:Z}=Q;return(0,n.jsx)(i.c.MultiValueRemove,{...Q,children:(0,n.jsx)(f.E,{label:Z.label,removeIcon:!0,count:Z.count},Z.label)})},MultiValueContainer:d?()=>null:i.c.MultiValueContainer}};return(0,n.jsxs)("div",{className:j.tagFilter,children:[b&&M.length>0&&(0,n.jsx)("button",{className:j.clear,onClick:()=>w([]),children:(0,n.jsx)(u.x6,{i18nKey:"tag-filter.clear-button",children:"Clear tags"})}),(0,n.jsx)(l.KF,{...H,prefix:(0,n.jsx)(g.I,{name:"tag-alt"}),"aria-label":(0,u.t)("tag-filter.select-aria-label","Tag filter")},N)]})};v.displayName="TagFilter";const m=y=>{const h=(0,f.$)(y);return{tagFilter:(0,a.css)({position:"relative",minWidth:"180px",flexGrow:1,[`.${h.badge}`]:{marginLeft:"6px",cursor:"pointer"}}),clear:(0,a.css)({background:"none",border:"none",textDecoration:"underline",fontSize:"12px",padding:"none",position:"absolute",top:"-17px",right:0,cursor:"pointer",color:y.colors.text.secondary,"&:hover":{color:y.colors.text.primary}})}}},61074:(te,R,e)=>{"use strict";e.d(R,{F:()=>s});var n=e(47070),a=e(43173);function s(){const i=[];return a.$.featureToggles.grafanaconThemes&&(i.push("desertbloom"),i.push("gildedgrove"),i.push("sapphiredusk"),i.push("tron"),i.push("gloom")),(0,n.k)(i)}},51158:(te,R,e)=>{"use strict";e.d(R,{mR:()=>x});var n=e(74848),a=e(2543),s=e.n(a),i=e(32899),r=e(17548),u=e(25229),o=e(92745),l=e(91867),g=e(45229),f=e(36321);const p="grafana.dashboard.timepicker.history",c=4,x=D=>(0,n.jsx)(f.b,{storageKey:p,defaultValue:[],children:(C,P)=>{const M=v(C),O=m(M);return(0,n.jsx)(l.$6,{...D,history:O,onChange:j=>{y(j,M,P),D.onChange(j)},onError:j=>g.A.emit(i.r1.alertError,[(0,o.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,o.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:j})])})}});function v(D){const C=[];if(!Array.isArray(D))return C;for(let P of D){const M=E(P);M&&C.push(M)}return C}function m(D){return D.map(C=>r.convertRawToRange(C,"utc",void 0,"YYYY-MM-DD HH:mm:ss"))}function y(D,C,P){if(!h(D))return;const M={from:b(D.raw.from),to:b(D.raw.to)},O=d([M,...C]);P(O)}function h(D){return(0,u.Ar)(D.raw.from)||(0,u.Ar)(D.raw.to)}function d(D){return(0,a.uniqBy)(D,C=>C.from+C.to).slice(0,c)}function E(D){if(typeof D!="object"||D===null||Object.keys(D).length!==2||!("from"in D)||!("to"in D))return null;const{from:C,to:P}=D;return typeof C=="string"&&typeof P=="string"?{from:C,to:P}:null}function b(D){if(typeof D=="string")return D;if(!D?.toISOString)throw console.error("Invalid DateTime object passed to convertToISOString");return D.toISOString()}},47981:(te,R,e)=>{"use strict";e.d(R,{N:()=>p});var n=e(74848),a=e(22803),s=e(96540),i=e(92745),r=e(63142),u=e(22787),o=e(13943),l=e(66404),g=e(9628);const f=m=>[{category:(0,i.t)("help-modal.shortcuts-category.global","Global"),shortcuts:[{keys:["g","h"],description:(0,i.t)("help-modal.shortcuts-description.go-to-home-dashboard","Go to Home Dashboard")},{keys:["g","d"],description:(0,i.t)("help-modal.shortcuts-description.go-to-dashboards","Go to Dashboards")},{keys:["g","e"],description:(0,i.t)("help-modal.shortcuts-description.go-to-explore","Go to Explore")},{keys:["g","p"],description:(0,i.t)("help-modal.shortcuts-description.go-to-profile","Go to Profile")},{keys:[`${m} + k`],description:(0,i.t)("help-modal.shortcuts-description.open-search","Open search")},{keys:["esc"],description:(0,i.t)("help-modal.shortcuts-description.exit-edit/setting-views","Exit edit/setting views")},{keys:["?"],description:(0,i.t)("help-modal.shortcuts-description.show-all-shortcuts","Show all keyboard shortcuts")},{keys:["c","t"],description:(0,i.t)("help-modal.shortcuts-description.change-theme","Change theme")}]},{category:(0,i.t)("help-modal.shortcuts-category.time-range","Time range"),shortcuts:[{keys:["t","z"],description:(0,i.t)("help-modal.shortcuts-description.zoom-out-time-range","Zoom out time range")},{keys:["t","\u2190"],description:(0,i.t)("help-modal.shortcuts-description.move-time-range-back","Move time range back")},{keys:["t","\u2192"],description:(0,i.t)("help-modal.shortcuts-description.move-time-range-forward","Move time range forward")},{keys:["t","a"],description:(0,i.t)("help-modal.shortcuts-description.make-time-range-permanent","Make time range absolute/permanent")},{keys:["t","c"],description:(0,i.t)("help-modal.shortcuts-description.copy-time-range","Copy time range")},{keys:["t","v"],description:(0,i.t)("help-modal.shortcuts-description.paste-time-range","Paste time range")}]},{category:(0,i.t)("help-modal.shortcuts-category.dashboard","Dashboard"),shortcuts:[{keys:[`${m} + s`],description:(0,i.t)("help-modal.shortcuts-description.save-dashboard","Save dashboard")},{keys:["d","r"],description:(0,i.t)("help-modal.shortcuts-description.refresh-all-panels","Refresh all panels")},{keys:["d","s"],description:(0,i.t)("help-modal.shortcuts-description.dashboard-settings","Dashboard settings")},{keys:["d","v"],description:(0,i.t)("help-modal.shortcuts-description.toggle-active-mode","Toggle in-active / view mode")},{keys:["d","k"],description:(0,i.t)("help-modal.shortcuts-description.toggle-kiosk","Toggle kiosk mode (hides top nav)")},{keys:["d","\u21E7 + e"],description:(0,i.t)("help-modal.shortcuts-description.expand-all-rows","Expand all rows")},{keys:["d","\u21E7 + c"],description:(0,i.t)("help-modal.shortcuts-description.collapse-all-rows","Collapse all rows")},{keys:["d","a"],description:(0,i.t)("help-modal.shortcuts-description.toggle-auto-fit","Toggle auto fit panels (experimental feature)")},{keys:[`${m} + o`],description:(0,i.t)("help-modal.shortcuts-description.toggle-graph-crosshair","Toggle shared graph crosshair")},{keys:["d","l"],description:(0,i.t)("help-modal.shortcuts-description.toggle-all-panel-legends","Toggle all panel legends")},{keys:["d","x"],description:(0,i.t)("help-modal.shortcuts-description.toggle-exemplars","Toggle exemplars in all panel")}]},{category:(0,i.t)("help-modal.shortcuts-category.focused-panel","Focused panel"),shortcuts:[{keys:["e"],description:(0,i.t)("help-modal.shortcuts-description.toggle-panel-edit","Toggle panel edit view")},{keys:["v"],description:(0,i.t)("help-modal.shortcuts-description.toggle-panel-fullscreen","Toggle panel fullscreen view")},{keys:["p","u"],description:(0,i.t)("help-modal.shortcuts-description.open-share-link-drawer","Share panel link")},{keys:["p","e"],description:(0,i.t)("help-modal.shortcuts-description.open-share-embed-drawer","Share panel embed")},{keys:["p","s"],description:(0,i.t)("help-modal.shortcuts-description.open-shared-modal","Share panel snapshot")},{keys:["p","x"],description:(0,i.t)("help-modal.shortcuts-description.explore-panel","Explore panel")},{keys:["i"],description:(0,i.t)("help-modal.shortcuts-description.inspect-panel","Inspect panel")},{keys:["p","d"],description:(0,i.t)("help-modal.shortcuts-description.duplicate-panel","Duplicate Panel")},{keys:["p","r"],description:(0,i.t)("help-modal.shortcuts-description.remove-panel","Remove Panel")},{keys:["p","l"],description:(0,i.t)("help-modal.shortcuts-description.toggle-panel-legend","Toggle panel legend")}]}],p=({onDismiss:m})=>{const y=(0,r.of)(v),h=(0,s.useMemo)(()=>(0,g.gn)(),[]),d=(0,s.useMemo)(()=>f(h),[h]);return(0,n.jsx)(u.a,{title:(0,i.t)("help-modal.title","Shortcuts"),isOpen:!0,onDismiss:m,onClickBackdrop:m,children:(0,n.jsx)(o.x,{columns:{xs:1,sm:2},gap:3,tabIndex:0,children:Object.values(d).map(({category:E,shortcuts:b})=>(0,n.jsx)("section",{children:(0,n.jsxs)("table",{className:y.table,children:[(0,n.jsx)("caption",{children:(0,n.jsx)(l.E,{element:"p",variant:"h5",children:E})}),(0,n.jsx)("thead",{className:"sr-only",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:(0,n.jsx)(i.x6,{i18nKey:"help-modal.column-headers.keys",children:"Keys"})}),(0,n.jsx)("th",{children:(0,n.jsx)(i.x6,{i18nKey:"help-modal.column-headers.description",children:"Description"})})]})}),(0,n.jsx)("tbody",{children:b.map(({keys:D,description:C})=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:y.keys,children:D.map(P=>(0,n.jsx)(c,{children:P},P))}),(0,n.jsx)("td",{children:(0,n.jsx)(l.E,{variant:"bodySmall",element:"p",children:C})})]},D.join()))})]})},E))})})},c=({children:m})=>{const y=(0,r.of)(v),h=(0,s.useMemo)(()=>x(m),[m]),d=(0,n.jsx)("span",{dangerouslySetInnerHTML:{__html:h}});return(0,n.jsx)("kbd",{className:y.shortcutTableKey,children:(0,n.jsx)(l.E,{variant:"code",children:d})})};function x(m){let y,h;if(m.includes("ctrl"))y="ctrl",h="Control";else if(m.includes("esc"))y="esc",h="Escape";else return m;return m.replace(y,`<span class="sr-only">${h}</span><span aria-hidden="true" role="none">${y}</span>`)}function v(m){return{table:(0,a.css)({borderCollapse:"separate",borderSpacing:m.spacing(2),"& caption":{captionSide:"top"}}),keys:(0,a.css)({textAlign:"end",whiteSpace:"nowrap",minWidth:83}),shortcutTableKey:(0,a.css)({display:"inline-block",textAlign:"center",marginRight:m.spacing(.5),padding:"3px 5px",lineHeight:"10px",verticalAlign:"middle",border:`solid 1px ${m.colors.border.medium}`,borderRadius:m.shape.radius.default,color:m.colors.text.primary,backgroundColor:m.colors.background.secondary})}}},95943:(te,R,e)=>{"use strict";e.d(R,{FG:()=>v,Gk:()=>p,HG:()=>r,IZ:()=>c,Pz:()=>i,Ut:()=>y,bJ:()=>o,cV:()=>s,cx:()=>l,dU:()=>a,o9:()=>u,rt:()=>f,sD:()=>n,tH:()=>g,wV:()=>m});const n=30,a=8,s=24,i="v",r="h",u=4,o=250,l=n*3,g="panel-copy",f="row-copy",p="tab-copy",c=2,x=23763571993,v=40,m="VisualizationSelectPane.ListMode",y="mega-menu-toggle"},27963:(te,R,e)=>{"use strict";e.d(R,{Il:()=>i,YE:()=>s,ni:()=>r});var n=e(96540),a=e(36490);const s=(0,n.createContext)(void 0);function i(){const u=(0,n.useContext)(s);if(!u)throw new Error("No GrafanaContext found");return u}function r(){const{chrome:u}=i();return(0,n.useCallback)((o,l)=>{const{pathname:g,search:f}=a.Ny.getLocation();u.setReturnToPrevious({title:o,href:l??g+f})},[u])}},64762:(te,R,e)=>{"use strict";e.d(R,{Cf:()=>v,_2:()=>m,gi:()=>c,q8:()=>x,tZ:()=>p});var n=e(96540),a=e(24726),s=e(47797),i=e(8535),r=e(96221),u=e(52763),o=e(6890);const l={title:"",text:"",severity:r.Qd.Success,icon:"check"},g={title:"",text:"",severity:r.Qd.Warning,icon:"exclamation-triangle"},f={title:"",text:"",severity:r.Qd.Error,icon:"exclamation-triangle"},p=(d,E="",b)=>({...l,title:d,text:E,id:(0,a.A)(),timestamp:Date.now(),showing:!0}),c=(d,E="",b,D)=>({...f,text:(0,s.q6)(E),title:d,id:(0,a.A)(),traceId:b,component:D,timestamp:Date.now(),showing:!0}),x=(d,E="",b)=>({...g,title:d,text:E,traceId:b,id:(0,a.A)(),timestamp:Date.now(),showing:!0}),v=(d,E="",b)=>({severity:r.Qd.Info,icon:"info-circle",title:d,text:E,id:(0,a.A)(),timestamp:Date.now(),showing:!0});function m(){const d=(0,u.wA)();return(0,n.useMemo)(()=>({[r.Qd.Success]:(E,b="")=>{d((0,o.dx)(y(E,b,r.Qd.Success)))},[r.Qd.Warning]:(E,b="",D)=>{d((0,o.dx)(y(E,b,r.Qd.Warning,D)))},[r.Qd.Error]:(E,b="",D)=>{d((0,o.dx)(y(E,b,r.Qd.Error,D)))},[r.Qd.Info]:(E,b="")=>{d((0,o.dx)(y(E,b,r.Qd.Info)))}}),[d])}function y(d,E="",b=r.Qd.Success,D){return{[r.Qd.Success]:(P,M="")=>p(P,M),[r.Qd.Warning]:(P,M="",O)=>x(P,M,O),[r.Qd.Error]:(P,M="",O)=>c(P,M,O),[r.Qd.Info]:(P,M="")=>v(P,M)}[b](d,E,D)}function h(d,E="",b=AppNotificationSeverity.Success){storeDispatch(notifyApp(y(d,E,b)))}},66594:(te,R,e)=>{"use strict";e.d(R,{$H:()=>g,Ay:()=>f});var n=e(2543),a=e(29043),s=e(72054),i=e(78282);const r=E=>{const b=(0,i.l)().getInstanceSettings(E.datasourceName);return{id:E.ts.toString(),createdAt:E.ts,datasourceName:E.datasourceName,datasourceUid:b?.uid||"",starred:E.starred,comment:E.comment,queries:E.queries}},u=E=>{if(!(0,i.l)().getInstanceSettings({uid:E.datasourceUid}))throw new Error("Datasource not found.");return{ts:E.createdAt,datasourceName:E.datasourceName,starred:E.starred,comment:E.comment,queries:E.queries}};var o=e(68126);const l="grafana.explore.richHistory",g=1e4;class f{async getRichHistory(b){const D=v().map(r),C=b.starred?D.filter(O=>O.starred===!0):D,P=b.from&&b.to?[b.from,b.to]:void 0,M=(0,o.a_)(C,b.sortOrder,b.datasourceFilters,b.search,P);return{richHistory:M,total:M.length}}async addToRichHistory(b){const D=Date.now(),C={id:D.toString(),createdAt:D,...b},P=u(C),M=c(v()),O=P.queries.map(S=>(0,n.omit)(S,["key","refId"])),j=M.length>0&&M[0].queries.map(S=>(0,n.omit)(S,["key","refId"]));if((0,n.isEqual)(O,j)){const S=new Error("Entry already exists");throw S.name=s.m.DuplicatedEntry,S}const{queriesToKeep:U,limitExceeded:W}=x(M),B=[P,...U];try{a.A.setObject(l,B)}catch(S){if(S instanceof Error&&S.name==="QuotaExceededError")d(s.m.StorageFull,`Saving rich history failed: ${S.message}`);else throw S}return W?{warning:{type:s.C.LimitExceeded,message:`Query history reached the limit of ${g}. Old, not-starred items have been removed.`},richHistoryQuery:C}:{richHistoryQuery:C}}async deleteAll(){a.A.delete(l)}async deleteRichHistory(b){const D=parseInt(b,10),P=a.A.getObject(l,[]).filter(M=>M.ts!==D);a.A.setObject(l,P)}async updateStarred(b,D){return p(b,C=>C.starred=D)}async updateComment(b,D){return p(b,C=>C.comment=D)}async getSettings(){return{activeDatasourcesOnly:a.A.getObject(o.mE.activeDatasourcesOnly)??a.A.getObject(o.mE.legacyActiveDatasourceOnly,!1),retentionPeriod:a.A.getObject(o.mE.retentionPeriod,7),starredTabAsFirstTab:a.A.getBool(o.mE.starredTabAsFirstTab,!1),lastUsedDatasourceFilters:a.A.getObject(o.mE.datasourceFilters,[]).map(D=>D.value)}}async updateSettings(b){a.A.set(o.mE.activeDatasourcesOnly,b.activeDatasourcesOnly),a.A.set(o.mE.retentionPeriod,b.retentionPeriod),a.A.set(o.mE.starredTabAsFirstTab,b.starredTabAsFirstTab),a.A.setObject(o.mE.datasourceFilters,(b.lastUsedDatasourceFilters||[]).map(D=>({value:D})))}}function p(E,b){const D=parseInt(E,10),C=a.A.getObject(l,[]),P=(0,n.find)(C,{ts:D});if(!P)throw new Error("Rich history item not found.");return b(P),a.A.setObject(l,C),r(P)}function c(E){const b=a.A.getObject(o.mE.retentionPeriod,7),D=(0,o.wQ)(b,{isLastTs:!1});return E.filter(C=>C.ts>D||C.starred===!0)||[]}function x(E){let b=!1,D=E.length-1;for(;D>=0&&E.length>=g;)E[D].starred||(E.splice(D,1),b=!0),D--;return{queriesToKeep:E,limitExceeded:b}}function v(){const E=a.A.getObject(l,[]);return m(E)}function m(E){return E.map(D=>{const C=D.queries.map((P,M)=>y(D,P,M));return{...D,queries:C}})}function y(E,b,D){const C="ABCDEFGHIJKLMNOPQRSTUVXYZ";return typeof b=="object"?b:h(b)?JSON.parse(b):{expr:b,refId:C[D]}}function h(E){try{JSON.parse(E)}catch{return!1}return!0}function d(E,b){const D=new Error(b);throw D.name=E,D}},72054:(te,R,e)=>{"use strict";e.d(R,{C:()=>a,m:()=>n});var n=(s=>(s.StorageFull="StorageFull",s.DuplicatedEntry="DuplicatedEntry",s))(n||{}),a=(s=>(s.LimitExceeded="LimitExceeded",s))(a||{})},68126:(te,R,e)=>{"use strict";e.d(R,{a_:()=>r,mE:()=>p,wQ:()=>u});var n=e(2543),a=e.n(n),s=e(25229),i=e(80977);function r(c,x,v,m,y){const h=l(c,v),d=g(h,m),E=y?o(d,y):d;return f(E,x)}const u=(c,x)=>{let v=x.now;return v||(v=x.tz?(0,s.oZ)(x.tz):(0,s.KQ)()),v.add(-c,"d"),(x.isLastTs?v.endOf("d"):v.startOf("d")).valueOf()};function o(c,x){return c.filter(v=>v.createdAt>x[0]&&v.createdAt<x[1])}function l(c,x){return x.length>0?c.filter(v=>x.includes(v.datasourceName)):c}function g(c,x){return c.filter(v=>v.comment.includes(x)?!0:v.queries.filter(y=>Object.values((0,n.omit)(y,["datasource","key","refId","hide","queryType"])).some(h=>h?.toString().includes(x))).length>0)}const f=(c,x)=>{let v;return x===i.x.Ascending&&(v=(m,y)=>m.createdAt<y.createdAt?-1:m.createdAt>y.createdAt?1:0),x===i.x.Descending&&(v=(m,y)=>m.createdAt<y.createdAt?1:m.createdAt>y.createdAt?-1:0),x===i.x.DatasourceZA&&(v=(m,y)=>m.datasourceName<y.datasourceName?-1:m.datasourceName>y.datasourceName?1:0),x===i.x.DatasourceAZ&&(v=(m,y)=>m.datasourceName<y.datasourceName?1:m.datasourceName>y.datasourceName?-1:0),c.sort(v)},p={retentionPeriod:"grafana.explore.richHistory.retentionPeriod",starredTabAsFirstTab:"grafana.explore.richHistory.starredTabAsFirstTab",legacyActiveDatasourceOnly:"grafana.explore.richHistory.activeDatasourceOnly",activeDatasourcesOnly:"grafana.explore.richHistory.activeDatasourcesOnly",datasourceFilters:"grafana.explore.richHistory.datasourceFilters"}},53222:(te,R,e)=>{"use strict";e.d(R,{tU:()=>y,a:()=>m,gQ:()=>h});var n=e(43173),a=e(73427),s=e(80977),i=e(66594),r=e(75505),u=e(68143),o=e(78282),l=e(69738);const g=d=>{const E=(0,o.l)().getInstanceSettings({uid:d.datasourceUid});return{id:d.uid,createdAt:d.createdAt*1e3,datasourceName:E?.name||"",datasourceUid:d.datasourceUid,starred:d.starred,comment:d.comment,queries:d.queries}},f=d=>({uid:d.id,createdAt:Math.floor(d.createdAt/1e3),datasourceUid:d.datasourceUid,starred:d.starred,comment:d.comment,queries:d.queries});class p{constructor(){this.preferenceService=new l.W("user")}async addToRichHistory(E){const{result:b}=await(0,u.AI)().post("/api/query-history",{dataSourceUid:E.datasourceUid,queries:E.queries});return{richHistoryQuery:g(b)}}async deleteAll(){throw new Error("not supported")}async deleteRichHistory(E){(0,u.AI)().delete(`/api/query-history/${E}`)}async getRichHistory(E){const b=c(E);let D="query-history-get-all";E.starred&&(D="query-history-get-starred");const P=(await(0,r.s)((0,u.AI)().fetch({method:"GET",url:`/api/query-history?${b}`,requestId:D}))).data,M=(P.result.queryHistory||[]).map(g),O=P.result.totalCount||0;return{richHistory:M,total:O}}async getSettings(){return{activeDatasourcesOnly:!1,lastUsedDatasourceFilters:void 0,retentionPeriod:14,starredTabAsFirstTab:(await this.preferenceService.load()).queryHistory?.homeTab==="starred"}}async updateComment(E,b){const D=await(0,u.AI)().patch(`/api/query-history/${E}`,{comment:b});return g(D.result)}updateSettings(E){return this.preferenceService.patch({queryHistory:{homeTab:E.starredTabAsFirstTab?"starred":"query"}})}async updateStarred(E,b){let D;return b?D=await(0,u.AI)().post(`/api/query-history/star/${E}`):D=await(0,u.AI)().delete(`/api/query-history/star/${E}`),g(D.result)}}function c(d){let E=`${d.datasourceFilters.map(b=>{const D=(0,o.l)().getInstanceSettings(b).uid;return`datasourceUid=${encodeURIComponent(D)}`}).join("&")}`;return d.search&&(E=E+`&searchString=${d.search}`),d.sortOrder&&(E=E+`&sort=${d.sortOrder===s.x.Ascending?"time-asc":"time-desc"}`),d.starred||(E=E+`&to=${d.to}`,E=E+`&from=${d.from}`),E=E+"&limit=100",E=E+`&page=${d.page||1}`,d.starred&&(E=E+`&onlyStarred=${d.starred}`),E}const x=new i.Ay,v=new p,m=()=>n.$.queryHistoryEnabled?v:x,y=()=>x,h=()=>n.$.queryHistoryEnabled?{availableFilters:[s.x.Descending,s.x.Ascending],lastUsedDataSourcesAvailable:!1,clearHistory:!1,onlyActiveDataSource:!1,changeRetention:!1,queryHistoryAvailable:a.TP.isSignedIn}:{availableFilters:[s.x.Descending,s.x.Ascending,s.x.DatasourceAZ,s.x.DatasourceZA],lastUsedDataSourcesAvailable:!0,clearHistory:!0,onlyActiveDataSource:!0,changeRetention:!0,queryHistoryAvailable:!0}},94232:(te,R,e)=>{"use strict";e.d(R,{u:()=>a});var n=e(96540);function a(s,i){const[r,u]=(0,n.useState)();return(0,n.useEffect)(()=>{const o=s.subscribe(i,u);return()=>o.unsubscribe()},[s,i]),r}},51702:(te,R,e)=>{"use strict";e.d(R,{i:()=>s});var n=e(96540),a=e(63142);function s(i){const r=(0,a.$j)(),u=(0,n.useMemo)(()=>window.matchMedia(`(min-width: ${r.breakpoints.values[i]}px)`),[r,i]),[o,l]=(0,n.useState)(u.matches);return(0,n.useEffect)(()=>{const g=f=>l(f.matches);return u.addEventListener("change",g),()=>u.removeEventListener("change",g)},[u]),o}},45776:(te,R,e)=>{"use strict";e.d(R,{C:()=>s});var n=e(52763),a=e(84057);const s=i=>{const r=(0,n.d4)(u=>u.navIndex);return(0,a.tc)(r,i)}},70958:(te,R,e)=>{"use strict";e.d(R,{s:()=>i});var n=e(96540),a=e(54148),s=e(36490);function i(){const{search:r}=(0,a.zy)(),u=(0,n.useMemo)(()=>(0,s.SE)(r||""),[r]),o=(0,n.useCallback)((l,g)=>s.Ny.partial(l,g),[]);return[u,o]}},29662:(te,R,e)=>{"use strict";e.d(R,{VV:()=>r,Yj:()=>u,dK:()=>l});var n=e(2543),a=e.n(n),s=e(22480),i=e(57002);const r="grafana",u=s.Y.map(g=>{const f=g.code===i.wi?i.Nm:g.code;return{...g,loader:{[r]:()=>e(7170)(`./${f}/grafana.json`)}}});{const g=e(55905);if(g.keys().includes("app/extensions/locales/localeExtensions")){const{LOCALE_EXTENSIONS:f,ENTERPRISE_I18N_NAMESPACE:p}=g("app/extensions/locales/localeExtensions");for(const c of u){const x=f[c.code];x&&(c.loader[p]=x)}}}const o=u.map(g=>g.code),l=(0,n.uniq)(u.flatMap(g=>Object.keys(g.loader)))},12810:(te,R,e)=>{"use strict";e.d(R,{Y:()=>p,a:()=>c});var n=e(32017),a=e.n(n),s=e(47078),i=e.n(s),r=e(92745),u=e(65642);const o=x=>i()(x,{isEqual:a()}),l=u.$W.featureToggles.localeFormatPreference,g=o((x,v)=>new Intl.DateTimeFormat(x,v)),f=o((x,v)=>new Intl.DurationFormat(x,v)),p=o((x,v={})=>{if(typeof x=="string")return p(new Date(x),v);const m=l?u.$W.regionalFormat:(0,r.Z0)();return g(m,v).format(x)}),c=o((x,v={})=>{const m=l?u.$W.regionalFormat:(0,r.Z0)();return f(m,v).format(x)})},74101:(te,R,e)=>{"use strict";e.d(R,{z:()=>s});var n=e(54148),a=e(36490);function s(){const i=(0,n.zy)();return[new URLSearchParams(i.search),(o,l)=>{a.Ny.partial(o,l)}]}},12066:(te,R,e)=>{"use strict";e.d(R,{$K:()=>m,Do:()=>f,XC:()=>c,XR:()=>p,dx:()=>g,fX:()=>E,g5:()=>v,oF:()=>x,qN:()=>d});var n=e(65307),a=e(25508),s=e(96221);const i=25,r="notifications",u=`${r}/lastRead`,o={byId:P(),lastRead:Number.parseInt(window.localStorage.getItem(u)??`${Date.now()}`,10)},l=(0,n.Z0)({name:"appNotifications",initialState:o,reducers:{notifyApp:(O,{payload:j})=>{Object.values(O.byId).some(U=>b(j,U)&&U.showing)||(O.byId[j.id]=j,M(O.byId))},hideAppNotification:(O,{payload:j})=>{j in O.byId&&(O.byId[j].showing=!1,M(O.byId))},clearNotification:(O,{payload:j})=>{delete O.byId[j],M(O.byId)},clearAllNotifications:O=>{O.byId={},M(O.byId)},readAllNotifications:(O,{payload:j})=>{O.lastRead=j}}}),{notifyApp:g,hideAppNotification:f,clearNotification:p,clearAllNotifications:c,readAllNotifications:x}=l.actions,v=l.reducer,m=O=>O.lastRead,y=O=>O.byId,h=(0,a.Mz)(y,O=>Object.values(O).sort((j,U)=>U.timestamp-j.timestamp)),d=(0,a.Mz)(h,O=>O.filter(D)),E=(0,a.Mz)(y,O=>Object.values(O).filter(j=>j.showing));function b(O,j){return O.icon===j.icon&&O.severity===j.severity&&O.text===j.text&&O.title===j.title}function D(O){return O.severity===s.Qd.Warning||O.severity===s.Qd.Error}function C(O){return typeof O=="object"&&O!==null&&"id"in O&&"icon"in O&&"title"in O&&"text"in O}function P(){const O=window.localStorage.getItem(r);if(!O)return{};const j=JSON.parse(O);return Object.values(j).every(U=>C(U))?j:{}}function M(O){const j=Object.values(O).filter(D).sort((U,W)=>W.timestamp-U.timestamp).slice(0,i).reduce((U,W)=>(U[W.id]={id:W.id,severity:W.severity,icon:W.icon,title:W.title,text:W.text,traceId:W.traceId,timestamp:W.timestamp,showing:!1},U),{});try{window.localStorage.setItem(r,JSON.stringify(j))}catch(U){console.error("Unable to persist notifications to local storage"),console.error(U)}}},38206:(te,R,e)=>{"use strict";e.d(R,{I_:()=>c,L1:()=>u,TU:()=>f,ci:()=>l,fc:()=>g,ve:()=>p});var n=e(65307),a=e(43173),s=e(18832);const i=a.$.bootData?.navTree??[];function r(x){return x.map(v=>{const m=v.children&&r(v.children);return{...v,children:m,text:(0,s.C)(v.id)??v.text,subTitle:(0,s.o)(v.id)??v.subTitle,emptyMessage:(0,s.C)(v.emptyMessageId)}})}const u="starred/",o=(0,n.Z0)({name:"navBarTree",initialState:()=>r(a.$.bootData?.navTree??[]),reducers:{setStarred:(x,v)=>{const m=x.find(b=>b.id==="starred"),{id:y,title:h,url:d,isStarred:E}=v.payload;if(m)if(E){m.children||(m.children=[]);const b={id:u+y,text:h,url:d};m.children.push(b),m.children.sort((D,C)=>D.text.localeCompare(C.text))}else{const b=m.children?.findIndex(D=>D.id===u+y)??-1;b>-1&&m?.children?.splice(b,1)}},setBookmark:(x,v)=>{if(!a.$.featureToggles.pinNavItems)return;const m=x.find(d=>d.id==="bookmarks"),{item:y,isSaved:h}=v.payload;if(m)if(h){m.children||=[];const d={...y,children:[],sortWeight:0,emptyMessageId:"",emptyMessage:"",parentItem:{id:m.id,text:m.text}};m.children.push(d)}else m.children=m.children?.filter(d=>d.url!==y.url)??[]},updateDashboardName:(x,v)=>{const{id:m,title:y,url:h}=v.payload,d=x.find(E=>E.id==="starred");if(d){const E=d.children?.find(b=>b.id===m);E&&(E.text=y,E.url=h,d.children?.sort((b,D)=>b.text.localeCompare(D.text)))}},removePluginFromNavTree:(x,v)=>{const m="plugin-page-"+v.payload.pluginID,y=x.findIndex(h=>h.id===m);y>-1&&x.splice(y,1)}}}),{setStarred:l,removePluginFromNavTree:g,updateDashboardName:f,setBookmark:p}=o.actions,c=o.reducer},43550:(te,R,e)=>{"use strict";e.d(R,{Id:()=>u,Im:()=>x,Vz:()=>p,YA:()=>c,_h:()=>m,s2:()=>o});var n=e(65307),a=e(2543),s=e.n(a),i=e(65642),r=e(18832);const u="home";function o(){const y={},h=(0,a.cloneDeep)(i.Ay.bootData.navTree),d=h.find(b=>b.id===u),E=h.filter(b=>b.id!==u);return d&&l(y,[d]),l(y,E,y[u]),y}function l(y,h,d){const E=[];for(const b of h){const D={...b,text:(0,r.C)(b.id)??b.text,subTitle:(0,r.o)(b.id)??b.subTitle,emptyMessage:(0,r.C)(b.emptyMessageId),parentItem:d};D.id&&(y[D.id]=D),D.children&&l(y,D.children,D),E.push(D)}d&&(d.children=E),y["not-found"]={...g("Page not found","404 Error").node},y.error={...g("Page error","An unexpected error").node}}function g(y,h){const d={text:y,subTitle:h,icon:"exclamation-triangle"};return{node:d,main:d}}const f={},p=(0,n.VP)("navIndex/updateNavIndex"),c=(0,n.VP)("navIndex/updateConfigurationSubtitle"),x=(0,n.VP)("navIndex/removeNavIndex"),v=(y,h)=>({...y,parentItem:{...y.parentItem,text:y.parentItem?.text??"",subTitle:h}}),m=(y=f,h)=>{if(p.match(h)){let E=function(C){if(C.children)for(const P of C.children)b[P.id]={...P,parentItem:C};C.parentItem&&E(C.parentItem)};var d=E;const b={},D=h.payload;return E(D),{...y,...b}}else if(c.match(h)){const E=`Organization: ${h.payload}`;return{...y,cfg:{...y.cfg,subTitle:E},datasources:v(y.datasources,E),correlations:v(y.correlations,E),users:v(y.users,E),teams:v(y.teams,E),plugins:v(y.plugins,E),"org-settings":v(y["org-settings"],E),apikeys:v(y.apikeys,E)}}else x.match(h)&&delete y[h.payload];return y}},84057:(te,R,e)=>{"use strict";e.d(R,{rH:()=>u,tc:()=>r});var n=e(41811),a=e(66198),s=e(43550);const i=()=>{const g={id:"not-found",text:"Page not found",icon:"exclamation-triangle",subTitle:"404 Error",url:"not-found"};return{node:g,main:g}},r=(0,n.default)((g,f,p,c=!1)=>{if(g[f]){const x=g[f],v=c?x:u(x),m=o(v,f);return{node:x,main:m}}return p||i()});function u(g){return g.id===a.Rj?g:g.parentItem&&g.parentItem.id!==s.Id?u(g.parentItem):g}function o(g,f){return g.id===f?{...g,active:!0}:g.children&&g.children.length>0?{...g,children:g.children.map(p=>o(p,f))}:g}const l=g=>`${g.main.text}${g.node.text?": "+g.node.text:""}`},69738:(te,R,e)=>{"use strict";e.d(R,{W:()=>a});var n=e(83873);class a{constructor(i){this.resourceUri=i}update(i){return n.IB.put(`/api/${this.resourceUri}/preferences`,i)}patch(i){return n.IB.patch(`/api/${this.resourceUri}/preferences`,i)}load(){return n.IB.get(`/api/${this.resourceUri}/preferences`)}}},5114:(te,R,e)=>{"use strict";e.d(R,{Q:()=>i});var n=e(96540),a=e(13752),s=e(79104);class i{constructor(o){this._subject=new a.B,this._state=o}useState(){return r(this)}get state(){return this._state}setState(o){this._state={...this._state,...o},this._subject.next(this._state)}subscribeToState(o){return this._subject.subscribe(o)}}function r(u){const o=(0,s.C)();return(0,n.useEffect)(()=>{const l=u.subscribeToState({next:o});return()=>l.unsubscribe()},[u,o]),u.state}},83873:(te,R,e)=>{"use strict";e.d(R,{Mf:()=>Je,IB:()=>Ge,AI:()=>je});var n=e(56568),a=e(13752),s=e(75505),i=e(88483),r=e(64423),u=e(13288),o=e(65474),l=e(20039),g=e(81160),f=e(69862),p=e(59099),c=e(37748),x=e(66847),v=e(67791),m=e(16126),y=e(41560),h=e(69850),d=e(1005),E=e(24726),b=e(32899),D=e(94644),C=e(37615),P=e(43173),M=e(45229),O=e(65642),j=e(57680),U=e(65556),W=e(13956),B=e(74848),S=e(22803),_=e(92745),K=e(63142),T=e(15245),L=e(79331),A=e(45861),N=e(35621);const V=Fe=>{const Be=(0,K.of)(z),Ke=(0,K.$j)(),Ue=(0,N.o)(Ke),we=!!Fe.maxConcurrentSessions,Xe=()=>{window.location.reload()};return(0,B.jsxs)(T.ZL,{children:[(0,B.jsx)("div",{className:Ue.modal,children:(0,B.jsxs)(L.w,{title:(0,_.t)("users.token-revoked-modal.title-you-have-been-automatically-signed-out","You have been automatically signed out"),severity:"warning",className:Be.infobox,children:[(0,B.jsxs)("div",{className:Be.text,children:[(0,B.jsx)("p",{children:(0,B.jsxs)(_.x6,{i18nKey:"users.token-revoked-modal.auto-revoked",values:{numSessions:we?Fe.maxConcurrentSessions:""},children:["Your session token was automatically revoked because you have reached"," ",(0,B.jsxs)("strong",{children:["the maximum number of ","{{numSessions}}"," concurrent sessions"]})," for your account."]})}),(0,B.jsx)("p",{children:(0,B.jsxs)(_.x6,{i18nKey:"users.token-revoked-modal.resume-message",children:[(0,B.jsx)("strong",{children:"To resume your session, sign in again."}),"Contact your administrator or visit the license page to review your quota if you are repeatedly signed out automatically."]})})]}),(0,B.jsx)(A.$n,{size:"md",variant:"primary",onClick:Xe,children:(0,B.jsx)(_.x6,{i18nKey:"users.token-revoked-modal.sign-in",children:"Sign in"})})]})}),(0,B.jsx)("div",{className:(0,S.cx)(Ue.modalBackdrop,Be.backdrop)})]})},z=Fe=>({infobox:(0,S.css)({marginBottom:0}),text:(0,S.css)({margin:Fe.spacing(1,0,2)}),backdrop:(0,S.css)({backgroundColor:Fe.colors.background.canvas,opacity:.8})});var w=e(87745),H=e(2543),Q=e(63704);const Z=Fe=>{const Be=Fe.method,Ke=oe(Fe),Ue=de(Ke),we=fe(Fe,Ue),Xe=ve(Fe);return{method:Be,headers:Ke,body:we,credentials:Xe,signal:Fe.abortSignal}},Y={canParse:()=>!0,parse:Fe=>(Fe.get("accept")||Fe.set("accept","application/json, text/plain, */*"),Fe)},X=Fe=>({canParse:Be=>(Be?.method?Be?.method.toLowerCase():"")===Fe,parse:Be=>(Be.get("content-type")||Be.set("content-type","application/json"),Be)}),I=X("post"),J=X("put"),ee=X("patch"),q=[I,J,ee,Y],ne=/[^\u0000-\u00ff]/g;function se(Fe){return ne.test(Fe)?encodeURI(Fe):Fe}const oe=Fe=>{const Be={};for(let[Xe,nt]of Object.entries(Fe.headers??{}))Be[se(Xe)]=se(nt);const Ke=new Headers(Be);return q.filter(Xe=>Xe.canParse(Fe)).reduce((Xe,nt)=>nt.parse(Xe),Ke)},de=Fe=>{if(!Fe)return!1;const Be=Fe.get("content-type");return!!(Be&&(Be.toLowerCase()==="application/json"||Be.toLowerCase()==="application/merge-patch+json"))},fe=(Fe,Be)=>Fe&&(!Fe.data||typeof Fe.data=="string"||Fe.data instanceof Blob?Fe.data:Be?JSON.stringify(Fe.data):new URLSearchParams(Fe.data));async function ae(Fe,Be){if(Be)switch(Be){case"arraybuffer":return Fe.arrayBuffer();case"blob":return Fe.blob();case"json":return Fe.headers.get("Content-Length")==="0"?(console.warn(`${Fe.url} returned an invalid JSON`),{}):await Fe.json();case"text":return Fe.text()}const Ke=await Fe.text();try{return JSON.parse(Ke)}catch{}return Ke}function ce(Fe){return Object.keys(Fe).map(Be=>{const Ke=Fe[Be];return Array.isArray(Ke)?Ke.map(Ue=>`${encodeURIComponent(Be)}=${encodeURIComponent(Ue)}`).join("&"):`${encodeURIComponent(Be)}=${encodeURIComponent(Ke)}`}).join("&")}const ie=Fe=>{const Be=(0,H.omitBy)(Fe.params,we=>we===void 0||we&&we.length===0),Ke=ce(Be),Ue=Fe.validatePath?(0,Q.iQ)(Fe.url):Fe.url;return Fe.params&&Ke.length?`${Ue}?${Ke}`:Ue},ve=Fe=>Fe&&(Fe.credentials?Fe.credentials:Fe.withCredentials?((0,C.l)("BackendSrvRequest","withCredentials","credentials"),"include"):"same-origin");var le=e(1404),Ee=(Fe=>(Fe[Fe.Pending=0]="Pending",Fe[Fe.InProgress=1]="InProgress",Fe[Fe.Done=2]="Done",Fe))(Ee||{});class Re{constructor(Be=!1){this.state={},this.queue=new a.B,this.updates=new a.B,this.add=(Ke,Ue)=>this.queue.next({id:Ke,options:Ue,state:0}),this.setInProgress=Ke=>this.queue.next({id:Ke,state:1}),this.setDone=Ke=>this.queue.next({id:Ke,state:2}),this.getUpdates=()=>this.updates.asObservable(),this.getUpdate=Ke=>{const Ue=Object.keys(Ke).filter(Xe=>Ke[Xe].state===1).length;return{noOfPending:Object.keys(Ke).filter(Xe=>Ke[Xe].state===0).length,noOfInProgress:Ue,state:Ke}},this.publishUpdate=(Ke,Ue)=>{this.printState(Ke,Ue),this.updates.next(Ke)},this.printState=(Ke,Ue)=>{if(!Ue)return;const we=Object.keys(Ke.state).reduce((Xe,nt)=>{const he={id:nt,state:Ke.state[nt].state};return Xe.push(he),Xe},[]);console.log("FetchQueue noOfStarted",Ke.noOfInProgress),console.log("FetchQueue noOfNotStarted",Ke.noOfPending),console.log("FetchQueue state",we)},this.queue.subscribe(Ke=>{const{id:Ue,state:we,options:Xe}=Ke;if(this.state[Ue]||(this.state[Ue]={state:0,options:{url:""}}),we===2){delete this.state[Ue];const he=this.getUpdate(this.state);this.publishUpdate(he,Be);return}this.state[Ue].state=we,Xe&&(this.state[Ue].options=Xe);const nt=this.getUpdate(this.state);this.publishUpdate(nt,Be)})}}var Oe=e(95864);class Se{constructor(Be,Ke,Ue){const we=Ue?.http2Enabled?1e3:5;Be.getUpdates().pipe((0,m.p)(({noOfPending:Xe})=>Xe>0),(0,Oe.H)(({state:Xe,noOfInProgress:nt})=>{const he=Object.keys(Xe).filter(De=>Xe[De].state===Ee.Pending&&!(0,le.dr)(Xe[De].options.url)).reduce((De,Le)=>{const Ve={id:Le,options:Xe[Le].options};return De.push(Ve),De},[]),xe=Object.keys(Xe).filter(De=>Xe[De].state===Ee.Pending&&(0,le.dr)(Xe[De].options.url)).reduce((De,Le)=>{const Ve={id:Le,options:Xe[Le].options};return De.push(Ve),De},[]),me=Math.max(we-nt-he.length,0),ye=xe.slice(0,me);return he.concat(ye)})).subscribe(({id:Xe,options:nt})=>{Ke.add(Xe,nt)})}}class Te{constructor(Be,Ke){this.queue=new a.B,this.responses=new a.B,this.add=(Ue,we)=>{this.queue.next({id:Ue,options:we})},this.getResponses=Ue=>this.responses.asObservable().pipe((0,m.p)(we=>we.id===Ue)),this.queue.subscribe(Ue=>{const{id:we,options:Xe}=Ue;Be.setInProgress(we),this.responses.next({id:we,observable:Ke(Xe)})})}}var _e=e(15130);const He="cancel_all_requests_request_id",tt="grafana-trace-id";class Je{constructor(Be){this.inFlightRequests=new a.B,this.HTTP_REQUEST_CANCELED=-1,this.inspectorStream=new a.B,this._tokenRotationInProgress=null,this.deviceID=null,this.dependencies={fromFetch:l.$,appEvents:M.A,contextSrv:_e.TP,logout:()=>{_e.TP.setLoggedOut()}},this.chunkRequestId=1,Be&&(this.dependencies={...this.dependencies,...Be}),this.noBackendCache=!1,this.internalFetch=this.internalFetch.bind(this),this.fetchQueue=new Re,this.responseQueue=new Te(this.fetchQueue,this.internalFetch),this.initGrafanaDeviceID(),new Se(this.fetchQueue,this.responseQueue,(0,O.zj)())}async initGrafanaDeviceID(){try{const Ke=await(await n.Ay.load()).get();this.deviceID=Ke.visitorId}catch(Be){console.error(Be)}}async request(Be){return await(0,s.s)(this.fetch(Be).pipe((0,g.T)(Ke=>Ke.data)))}fetch(Be){const Ke=(0,E.A)(),Ue=this.fetchQueue;return new i.c(we=>{const Xe=new r.yU;return Xe.add(this.responseQueue.getResponses(Ke).subscribe(nt=>{Xe.add(nt.observable.subscribe(we))})),this.fetchQueue.add(Ke,Be),function(){Ue.setDone(Ke),Xe.unsubscribe()}})}chunked(Be){const Ke=Be.requestId??`chunked-${this.chunkRequestId++}`,Ue=new AbortController;let we;try{we=ie(Be)}catch(nt){return(0,u.$)(()=>nt)}const Xe=Z({...Be,requestId:Ke,abortSignal:Ue.signal});return new i.c(nt=>{let he=!1;const xe=this.dependencies.fromFetch(we,Xe).subscribe({next:me=>{const ye={status:me.status,statusText:me.statusText,ok:me.ok,headers:me.headers,url:me.url,type:me.type,redirected:me.redirected,config:Be,traceId:me.headers.get(tt)??void 0,data:void 0};if(!me.body){nt.next(ye),nt.complete();return}const De=me.body.getReader();async function Le(){for(;De&&!he;){if(Ue.signal.aborted){De.cancel(Ue.signal.reason),console.log(Ke,"signal.aborted");return}const Ve=await De.read();nt.next({...ye,data:Ve.value}),Ve.done&&(he=!0,console.log(Ke,"done"))}}Le().then(()=>{console.log(Ke,"complete"),nt.complete()}).catch(Ve=>{console.log(Ke,"catch",Ve),nt.error(Ve)})},error:me=>{nt.error(me)}});return function(){console.log(Ke,"unsubscribe"),Ue.abort("unsubscribe"),xe.unsubscribe()}})}internalFetch(Be){Be.requestId&&this.inFlightRequests.next(Be.requestId),Be=this.parseRequestOptions(Be);const Ke=(0,U.r)();return Ke!==null&&Ke!==""&&P.$.jwtUrlLogin&&P.$.jwtHeaderName&&(Be.headers=Be.headers??{},Be.headers[P.$.jwtHeaderName]=`${Ke}`),this.deviceID&&(Be.headers=Be.headers??{},Be.headers["X-Grafana-Device-Id"]=`${this.deviceID}`),this.getFromFetchStream(Be).pipe(this.handleStreamResponse(Be),this.handleStreamError(Be),this.handleStreamCancellation(Be))}resolveCancelerIfExists(Be){this.inFlightRequests.next(Be)}cancelAllInFlightRequests(){this.inFlightRequests.next(He)}async datasourceRequest(Be){return(0,s.s)(this.fetch(Be))}parseRequestOptions(Be){const Ke=this.dependencies.contextSrv.user?.orgId;return Be.retry=Be.retry??0,(0,le.Lr)(Be.url)&&(Ke&&(Be.headers=Be.headers??{},Be.headers["X-Grafana-Org-Id"]=Ke),Be.url.startsWith("/")&&(Be.url=Be.url.substring(1)),Be.headers?.Authorization&&(Be.headers["X-DS-Authorization"]=Be.headers.Authorization,delete Be.headers.Authorization),this.noBackendCache&&(Be.headers=Be.headers??{},Be.headers["X-Grafana-NoCache"]="true")),Be.hideFromInspector===void 0&&(Be.hideFromInspector=(0,le.Lr)(Be.url)&&!(0,le.dr)(Be.url)),Be}getFromFetchStream(Be){const Ke=Z(Be);let Ue;try{Ue=ie(Be)}catch(we){return(0,u.$)(()=>we)}return this.dependencies.fromFetch(Ue,Ke).pipe((0,f.Z)(async we=>{const{status:Xe,statusText:nt,ok:he,headers:xe,url:me,type:ye,redirected:De}=we,Le=Be.responseType??(de(xe)?"json":void 0),Ve=await ae(we,Le);return{status:Xe,statusText:nt,ok:he,data:Ve,headers:xe,url:me,type:ye,redirected:De,config:Be,traceId:we.headers.get(tt)??void 0}}))}showApplicationErrorAlert(Be){}showSuccessAlert(Be){const{config:Ke}=Be;if(Ke.showSuccessAlert===!1||Ke.showSuccessAlert===void 0&&(Ke.method==="GET"||(0,le.dr)(Ke.url)||!(0,le.Lr)(Ke.url)))return;const Ue=Be.data;Ue?.message&&this.dependencies.appEvents.emit(b.r1.alertSuccess,[Ue.message])}showErrorAlert(Be,Ke){if((Ke.status<400||Ke.status>=500)&&this.dependencies.contextSrv.isSignedIn&&(this.dependencies.contextSrv.user.authenticatedBy==="apikey"||this.dependencies.contextSrv.user.authenticatedBy==="render")||Be.showErrorAlert===!1||Be.showErrorAlert===void 0&&((0,le.dr)(Be.url)||!(0,le.Lr)(Be.url)))return;let Ue="",we=Ke.data.message;we==="Unexpected error"&&Ke.message&&(we=Ke.message),we.length>80&&(Ue=we,we="Error"),Ke.status===422&&(Ue=Ke.data.message,we="Validation failed"),this.dependencies.appEvents.emit(Ke.status<500?b.r1.alertWarning:b.r1.alertError,[we,Ue,Ke.data.traceID])}processRequestError(Be,Ke){return Ke.data=Ke.data??{message:"Unexpected error"},typeof Ke.data=="string"&&(Ke.data={message:Ke.data,error:Ke.statusText,response:Ke.data}),Ke.data&&!Ke.data.message&&typeof Ke.data.error=="string"&&(Ke.data.message=Ke.data.error),Ke.data.message&&setTimeout(()=>{Ke.isHandled||this.showErrorAlert(Be,Ke)},50),this.inspectorStream.next({response:Ke,requestId:Be.requestId}),Ke}handleStreamResponse(Be){return Ke=>Ke.pipe((0,g.T)(Ue=>{if(!Ue.ok){const{status:we,statusText:Xe,data:nt}=Ue;throw{status:we,statusText:Xe,data:nt,config:Be,traceId:Ue.headers.get(tt)??void 0}}return Ue}),(0,p.M)(Ue=>{this.showSuccessAlert(Ue),this.inspectorStream.next({response:Ue,requestId:Be.requestId})}))}handleStreamError(Be){const{isSignedIn:Ke}=this.dependencies.contextSrv.user;return Ue=>Ue.pipe((0,c.l)(we=>we.pipe((0,f.Z)((Xe,nt)=>{const he=nt===0&&Be.retry===0;if(Xe.status===401&&(0,le.Lr)(Be.url)&&he&&Ke){if(Xe.data?.error?.id==="ERR_TOKEN_REVOKED")return this.dependencies.appEvents.publish(new w.S8({component:V,props:{maxConcurrentSessions:Xe.data?.error?.maxConcurrentSessions}})),this.dependencies.contextSrv.setRedirectToUrl(),(0,u.$)(()=>Xe);let xe=this.loginPing();return(0,j.m)()&&(0,j.W)()*1e3<Date.now()&&(xe=this.rotateToken()),(0,o.H)(xe).pipe((0,x.W)(me=>(me.status===401&&this.dependencies.logout(),(0,u.$)(me))))}return(0,u.$)(Xe)}))),(0,x.W)(we=>(0,u.$)(()=>this.processRequestError(Be,we))))}handleStreamCancellation(Be){return Ke=>Ke.pipe((0,v.Q)(this.inFlightRequests.pipe((0,m.p)(Ue=>{let we=!1;return Be&&Be.requestId&&Be.requestId===Ue&&(we=!0),Ue===He&&(we=!0),we}))),(0,y.v)(()=>({type:D.v2.Cancelled,cancelled:!0,data:null,status:this.HTTP_REQUEST_CANCELED,statusText:"Request was aborted",config:Be})))}getInspectorStream(){return this.inspectorStream}async get(Be,Ke,Ue,we){return this.request({...we,method:"GET",url:Be,params:Ke,requestId:Ue})}async delete(Be,Ke,Ue){return this.request({...Ue,method:"DELETE",url:Be,data:Ke})}async post(Be,Ke,Ue){return this.request({...Ue,method:"POST",url:Be,data:Ke})}async patch(Be,Ke,Ue){return this.request({...Ue,method:"PATCH",url:Be,data:Ke})}async put(Be,Ke,Ue){return this.request({...Ue,method:"PUT",url:Be,data:Ke})}withNoBackendCache(Be){return this.noBackendCache=!0,Be().finally(()=>{this.noBackendCache=!1})}rotateToken(){return this._tokenRotationInProgress?this._tokenRotationInProgress:(this._tokenRotationInProgress=this.fetch({url:"/api/user/auth-tokens/rotate",method:"POST",retry:1}).pipe((0,h.j)(()=>{this._tokenRotationInProgress=null}),(0,d.u)()),this._tokenRotationInProgress)}loginPing(){return this.fetch({url:"/api/login/ping",method:"GET",retry:1})}search(Be){return this.get("/api/search",Be)}getDashboardByUid(Be){return(0,C.l)("backend_srv","getDashboardByUid(uid)","getDashboardAPI().getDashboardDTO(uid)"),(0,W.n)("v1").getDashboardDTO(Be)}validateDashboard(Be){return Promise.resolve({isValid:!1,message:"dashboard validation is not supported"})}getPublicDashboardByUid(Be){return this.get(`/api/public/dashboards/${Be}`)}getFolderByUid(Be,Ke={}){const Ue=new URLSearchParams;return Ke.withAccessControl&&Ue.set("accesscontrol","true"),this.get(`/api/folders/${Be}?${Ue.toString()}`,void 0,void 0,{showErrorAlert:!1})}}const Ge=new Je,je=()=>Ge},78731:(te,R,e)=>{"use strict";e.d(R,{n:()=>a});var n=e(78646);const a=(i,r)=>{(0,n.x$)().addEvent({type:n.on.Performance,payload:{name:i,value:r}})},s=i=>faro?.api?.pushError(i)},25240:(te,R,e)=>{"use strict";e.d(R,{S5:()=>r,k0:()=>s});var n=e(60379),a=e(20720);function s(u,o=!1){return new Promise(l=>{const g=document.createElement("script");g.onload=l,g.src=u,g.async=o,document.head.appendChild(g)})}const i=(0,n.h)("EchoSrv"),r=i.logger;(0,a.h)("echo",void 0,i)},67020:(te,R,e)=>{"use strict";e.d(R,{A:()=>l});var n=e(2543),a=e.n(n),s=e(68143),i=e(65642),r=e(29043);class u{constructor(){}addDashboardImpression(f){const p=this.impressionKey();let c=[];r.A.exists(p)&&(c=JSON.parse(r.A.get(p)),(0,n.isArray)(c)||(c=[])),c=c.filter(x=>f!==x),c.unshift(f),c.length>50&&c.pop(),r.A.set(p,JSON.stringify(c))}async convertToUIDs(){let f=this.getImpressions();const p=(0,n.filter)(f,x=>(0,n.isNumber)(x));if(!p.length)return;const c=await(0,s.AI)().get(`/api/dashboards/ids/${p.join(",")}`);r.A.set(this.impressionKey(),JSON.stringify([...(0,n.filter)(f,x=>(0,n.isString)(x)),...c]))}getImpressions(){const f=r.A.get(this.impressionKey())||"[]";return JSON.parse(f)}async getDashboardOpened(){try{await this.convertToUIDs()}catch{}return(0,n.filter)(this.getImpressions(),p=>(0,n.isString)(p))}impressionKey(){return"dashboard_impressions-"+i.Ay.bootData.user.orgId}}const l=new u},12469:(te,R,e)=>{"use strict";e.d(R,{R:()=>d});let n={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},a={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},i={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},r=null;for(let E=1;E<20;++E)n[111+E]="f"+E;for(let E=0;E<=9;++E)n[E+96]=E.toString();function u(E){if(E.type==="keypress"){let b=String.fromCharCode(E.which);return E.shiftKey||(b=b.toLowerCase()),b}return n[E.which]?n[E.which]:a[E.which]?a[E.which]:String.fromCharCode(E.which).toLowerCase()}function o(E,b){return E.sort().join(",")===b.sort().join(",")}function l(E){let b=[];return E.shiftKey&&b.push("shift"),E.altKey&&b.push("alt"),E.ctrlKey&&b.push("ctrl"),E.metaKey&&b.push("meta"),b}function g(E){if(E.preventDefault){E.preventDefault();return}E.returnValue=!1}function f(E){if(E.stopPropagation){E.stopPropagation();return}E.cancelBubble=!0}function p(E){return E==="shift"||E==="ctrl"||E==="alt"||E==="meta"}function c(){if(!r){r={};for(let E in n){const b=parseInt(E,10);b>95&&b<112||n.hasOwnProperty(E)&&(r[n[E]]=E)}}return r}function x(E,b,D){return D||(D=c()[E]?"keydown":"keypress"),D==="keypress"&&b.length&&(D="keydown"),D}function v(E){return E==="+"?["+"]:(E=E.replace(/\+{2}/g,"+plus"),E.split("+"))}function m(E,b){let D,C,P,M=[];for(D=v(E),P=0;P<D.length;++P)C=D[P],i[C]&&(C=i[C]),b&&b!=="keypress"&&s[C]&&(C=s[C],M.push("shift")),p(C)&&M.push(C);if(!C)throw new Error("Unable to get key");return b=x(C,M,b),{key:C,modifiers:M,action:b}}function y(E,b){return E===null||E===document?!1:E===b?!0:y(E.parentNode,b)}class h{constructor(b){this._callbacks={},this._directMap={},this._sequenceLevels={},this._resetTimer=void 0,this._ignoreNextKeyup=!1,this._ignoreNextKeypress=!1,this._nextExpectedAction=!1,this._globalCallbacks={},this._resetSequences=D=>{D=D||{};let C=!1,P;for(P in this._sequenceLevels){if(D[P]){C=!0;continue}this._sequenceLevels[P]=0}C||(this._nextExpectedAction=!1)},this._getMatches=(D,C,P,M,O,j)=>{let U,W,B=[],S=P.type;if(!this._callbacks[D])return[];for(S==="keyup"&&p(D)&&(C=[D]),U=0;U<this._callbacks[D].length;++U)if(W=this._callbacks[D][U],!(!M&&W.seq&&this._sequenceLevels[W.seq]!==W.level)&&S===W.action&&(S==="keypress"&&!P.metaKey&&!P.ctrlKey||o(C,W.modifiers))){let _=!M&&W.combo===O,K=M&&W.seq===M&&W.level===j;(_||K)&&this._callbacks[D].splice(U,1),B.push(W)}return B},this._fireCallback=(D,C,P,M)=>{const O=C.target||C.srcElement;O&&O instanceof HTMLElement&&this.stopCallback(C,O,P,M)||D(C,P)===!1&&(g(C),f(C))},this._handleKey=(D,C,P)=>{let M=this._getMatches(D,C,P),O,j={},U=0,W=!1;for(O=0;O<M.length;++O)M[O].seq&&(U=Math.max(U,M[O].level??0));for(O=0;O<M.length;++O){const S=M[O].seq;if(S){if(M[O].level!==U)continue;W=!0,j[S]=1,this._fireCallback(M[O].callback,P,M[O].combo,S);const _=S.lastIndexOf(D),K=S.slice(0,_);for(const[T,L]of Object.entries(this._sequenceLevels))L>0&&T.startsWith(K)&&(j[T]=1);continue}W||this._fireCallback(M[O].callback,P,M[O].combo)}for(const S of this._callbacks[D]??[])S.action===P.type&&S.seq&&S.level===0&&(j[S.seq]=1);let B=P.type==="keypress"&&this._ignoreNextKeypress;P.type===this._nextExpectedAction&&!p(D)&&!B&&this._resetSequences(j),this._ignoreNextKeypress=W&&P.type==="keydown"},this._handleKeyEvent=D=>{if(!(D instanceof KeyboardEvent))throw new Error("Didn't get a KeyboardEvent");const C=D;if(C.repeat)return;typeof C.which!="number"&&(C.which=C.keyCode);let P=u(C);if(P){if(C.type==="keyup"&&this._ignoreNextKeyup===P){this._ignoreNextKeyup=!1;return}this.handleKey(P,l(C),C)}},this._resetSequenceTimer=()=>{clearTimeout(this._resetTimer),this._resetTimer=setTimeout(this._resetSequences,1e3)},this._bindSequence=(D,C,P,M)=>{this._sequenceLevels[D]=0;const O=U=>()=>{this._nextExpectedAction=U,++this._sequenceLevels[D],this._resetSequenceTimer()},j=U=>{this._fireCallback(P,U,D),M!=="keyup"&&(this._ignoreNextKeyup=u(U)),this._resetSequenceTimer()};for(let U=0;U<C.length;++U){let B=U+1===C.length?j:O(M||m(C[U+1]).action);this._bindSingle(C[U],B,M,D,U)}},this._bindSingle=(D,C,P,M,O)=>{this._directMap[D+":"+P]=C,D=D.replace(/\s+/g," ");let j=D.split(" "),U;if(j.length>1){this._bindSequence(D,j,C,P);return}U=m(D,P),this._callbacks[U.key]=this._callbacks[U.key]||[];const W={type:U.action,metaKey:!1,ctrlKey:!1};this._getMatches(U.key,U.modifiers,W,M,D,O);const B={callback:C,modifiers:U.modifiers,action:U.action,seq:M,level:O,combo:D};this._callbacks[U.key][M?"unshift":"push"](B)},this._bindMultiple=(D,C,P)=>{for(let M=0;M<D.length;++M)this._bindSingle(D[M],C,P)},this.bind=(D,C,P)=>{let M=this;return D=D instanceof Array?D:[D],this._bindMultiple(D,C,P),M},this.unbind=(D,C)=>this.bind(D,function(){},C),this.bindGlobal=(D,C,P)=>{if(this.bind(D,C,P),D instanceof Array){for(let M=0;M<D.length;M++)this._globalCallbacks[D[M]]=!0;return}this._globalCallbacks[D]=!0},this.unbindGlobal=(D,C)=>{if(this.unbind(D,C),D instanceof Array){for(let P=0;P<D.length;P++)this._globalCallbacks[D[P]]=!1;return}this._globalCallbacks[D]=!1},this.trigger=(D,C)=>{let P=this;return P._directMap[D+":"+C]&&P._directMap[D+":"+C]({},D),P},this.reset=()=>(this._callbacks={},this._directMap={},this),this.stopCallback=(D,C,P,M)=>{if(this._globalCallbacks[P]||M&&this._globalCallbacks[M]||(" "+C.className+" ").indexOf(" mousetrap ")>-1||y(C,this.target))return!1;if("composedPath"in D&&typeof D.composedPath=="function"){let O=D.composedPath()[0];O!==D.target&&O instanceof HTMLElement&&(C=O)}return!!(C.tagName==="INPUT"||C.tagName==="SELECT"||C.tagName==="TEXTAREA"||"isContentEditable"in C&&C.isContentEditable)},this.handleKey=(...D)=>this._handleKey(...D),this.addKeycodes=D=>{for(let C in D)D.hasOwnProperty(C)&&(n[C]=D[C]);r=null},this.target=b,this.target.addEventListener("keypress",D=>{D instanceof KeyboardEvent&&this._handleKeyEvent(D)}),this.target.addEventListener("keydown",D=>{D instanceof KeyboardEvent&&this._handleKeyEvent(D)}),this.target.addEventListener("keyup",D=>{D instanceof KeyboardEvent&&this._handleKeyEvent(D)})}}const d=new h(document)},44410:(te,R,e)=>{"use strict";e.d(R,{K:()=>o,O:()=>l});var n=e(47070),a=e(75234),s=e(45229),i=e(65642),r=e(73427),u=e(69738);async function o(g,f){const p=i.$W.theme2,c=(0,n.g)(g);if(s.A.publish(new a.E8(c)),p.colors.mode!==c.colors.mode){const v=document.createElement("link");v.rel="stylesheet",v.href=i.$W.bootData.assets[c.colors.mode],v.onload=()=>{const m=document.getElementsByTagName("link");for(let y=0;y<m.length;y++){const h=m[y];h.href&&h.href.includes(`build/grafana.${p.colors.mode}`)&&h.remove()}},document.head.insertBefore(v,document.head.firstChild)}if(f||!r.TP.isSignedIn)return;await new u.W("user").patch({theme:g})}async function l(g){const f=i.$W.theme2;o(f.isDark?"light":"dark",g)}},29043:(te,R,e)=>{"use strict";e.d(R,{A:()=>a});var n=e(78012);const a=n.M},81871:(te,R,e)=>{"use strict";e.d(R,{F:()=>n});function n(a={}){return{...a,accesscontrol:!0}}},49344:(te,R,e)=>{"use strict";e.d(R,{b:()=>n});const n=(a,s,i)=>(a.splice(i,0,a.splice(s,1)[0]),a)},9628:(te,R,e)=>{"use strict";e.d(R,{gn:()=>s});function n(){const i=navigator.userAgent.indexOf("MSIE")>-1,r=navigator.userAgent.indexOf("Edge/")>-1||navigator.userAgent.indexOf("Edg/")>-1,u=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,o=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),l=/Edge\/([0-9.]+)/.exec(navigator.userAgent);return i&&parseFloat(/Trident\/([0-9.]+)/.exec(navigator.userAgent)[1])<=7||r&&(l&&parseFloat(l[1])<=16||parseFloat(/Edg\/([0-9.]+)/.exec(navigator.userAgent)[1])<=16)||u&&parseFloat(/Firefox\/([0-9.]+)/.exec(navigator.userAgent)[1])<=64?!1:!(o&&parseFloat(/Chrome\/([0-9.]+)/.exec(navigator.userAgent)[1])<=54)}function a(){return/(iPhone|iPad|Mac)/.test(navigator.platform)}function s(){return a()?"\u2318":"ctrl"}},68220:(te,R,e)=>{"use strict";e.d(R,{TS:()=>s});class n{_linkTo(o,l){l<=0&&o.inputEdges.push(this),l>=0&&o.outputEdges.push(this),o.edges.push(this)}link(o,l){if(!o)throw Error("inputNode is required");if(!l)throw Error("outputNode is required");return this.unlink(),this.inputNode=o,this.outputNode=l,this._linkTo(o,1),this._linkTo(l,-1),this}unlink(){let o;const l=this.inputNode,g=this.outputNode;l&&g&&(o=l.edges.indexOf(this),o>-1&&l.edges.splice(o,1),o=g.edges.indexOf(this),o>-1&&g.edges.splice(o,1),o=l.outputEdges.indexOf(this),o>-1&&l.outputEdges.splice(o,1),o=g.inputEdges.indexOf(this),o>-1&&g.inputEdges.splice(o,1))}}class a{constructor(o){this.name=o,this.edges=[],this.inputEdges=[],this.outputEdges=[]}getEdgeFrom(o){return o?typeof o=="object"?this.inputEdges.find(l=>l.inputNode?.name===o.name):this.inputEdges.find(l=>l.inputNode?.name===o):null}getEdgeTo(o){return o?typeof o=="object"?this.outputEdges.find(l=>l.outputNode?.name===o.name):this.outputEdges.find(l=>l.outputNode?.name===o):null}getOptimizedInputEdges(){const o=[];return this.inputEdges.forEach(l=>{l.inputNode?.inputEdges.map(f=>f.inputNode)?.forEach(f=>{const p=f?.getEdgeTo(this.name);p&&o.push(p)})}),this.inputEdges.filter(l=>o.indexOf(l)===-1)}}class s{constructor(){this.nodes={}}createNode(o){const l=new a(o);return this.nodes[o]=l,l}createNodes(o){const l=[];return o.forEach(g=>{l.push(this.createNode(g))}),l}link(o,l){let g=[],f=[];const p=[],c=[];o instanceof Array?g=o:g=[o],l instanceof Array?f=l:f=[l];for(let v=0;v<g.length;v++){const m=g[v];if(typeof m=="string"){const y=this.getNode(m);if(!y)throw Error(`cannot link input node named ${m} since it doesn't exist in graph`);p.push(y)}else p.push(m)}for(let v=0;v<f.length;v++){const m=f[v];if(typeof m=="string"){const y=this.getNode(m);if(!y)throw Error(`cannot link output node named ${m} since it doesn't exist in graph`);c.push(y)}else c.push(m)}const x=[];return p.forEach(v=>{c.forEach(m=>{if(this.willCreateCycle(v,m))throw Error(`cannot link ${v.name} to ${m.name} since it would create a cycle`);x.push(this.createEdge().link(v,m))})}),x}descendants(o){if(!o.length)return new Set;const l=new Set(r(o)?o.map(g=>this.nodes[g]).filter(g=>g!==void 0):o);return this.descendantsRecursive(l)}descendantsRecursive(o,l=new Set){for(const g of o){const f=new Set;for(const{inputNode:p}of g.inputEdges)p&&!l.has(p)&&(l.add(p),f.add(p));this.descendantsRecursive(f,l)}return l}willCreateCycle(o,l){if(o===l)return!0;const g=new Set,f=[l];for(;f.length;){const p=f.pop();if(p===o)return!0;g.add(p);for(const c of p.outputEdges){const x=c.outputNode;x&&!g.has(x)&&f.push(x)}}return!1}createEdge(){return new n}getNode(o){return this.nodes[o]}}const i=u=>{Object.keys(u.nodes).forEach(o=>{const l=u.nodes[o];let g=l.outputEdges.map(p=>p.outputNode?.name).join(", ");g||(g="<none>");let f=l.inputEdges.map(p=>p.inputNode?.name).join(", ");f||(f="<none>"),console.log(`${l.name}:
 - links to:   ${g}
 - links from: ${f}`)})};function r(u){return u.length>0&&typeof u[0]=="string"}},47797:(te,R,e)=>{"use strict";e.d(R,{do:()=>s,ee:()=>r,q6:()=>a,rE:()=>i});var n=e(68143);function a(u){if(typeof u=="string")return u;if(u){if(u instanceof Error)return u.message;if((0,n.NF)(u)){if(u.data&&u.data.message)return u.data.message;if(u.statusText)return u.statusText}else if(u.hasOwnProperty("message"))return u.message}return JSON.stringify(u)}function s(u){if(typeof u!="string"&&u){if(u instanceof Error)return;if((0,n.NF)(u))return u.status;if(u.hasOwnProperty("status"))return u.status}}function i(u){if(typeof u!="string"&&u){if(u instanceof Error)return;if((0,n.NF)(u))return u.data?.messageId;if(u.hasOwnProperty("messageId"))return u.messageId}}function r(u){const o=u.config?.method??"GET",l=u.config?.url;return o&&l?`${o} ${l}`:"request"}},62635:(te,R,e)=>{"use strict";e.d(R,{HQ:()=>E,Ll:()=>W,MA:()=>j,WP:()=>m,Xe:()=>C,_u:()=>N,bI:()=>M,dY:()=>T,di:()=>S,dr:()=>b,eF:()=>B,o$:()=>D,uE:()=>A,uJ:()=>z,uq:()=>P,w4:()=>O,zT:()=>K,zq:()=>L});var n=e(43561),a=e(24726),s=e(739),i=e(83175),r=e(92138),u=e(1906),o=e(22592),l=e(39796),g=e(17548),f=e(78282),p=e(90811),c=e(29043),x=e(4651);const v={dedupStrategy:s.fY.none},m="0123456789abcdefghijklmnopqrstuvwxyz",y=(0,n.d_)(m,3),h="grafana.explore.datasource",d=w=>`${h}.${w}`,E=w=>c.A.getObject(d(w)),b=(w,H)=>c.A.setObject(d(w),H);function D(){for(;;){const w=y(3);if(!/^\d+$/.test(w))return w}}async function C(w){const{queries:H,dsRef:Q,timeRange:Z,scopedVars:Y,adhocFilters:X}=w,I=(await Promise.allSettled(H.filter(ee=>ee.datasource?.uid!==x.Uj).map(async ee=>{const q=await(0,f.l)().get(ee.datasource||Q);return{...q.interpolateVariablesInQueries?.([ee],Y??{},X)[0]||ee,...!q.meta.mixed&&{datasource:q.getRef()}}}))).filter(ee=>ee.status==="fulfilled").map(ee=>ee.value),J=JSON.stringify({[D()]:{range:(0,i.sQ)(Z.raw),queries:I,datasource:Q?.uid}});return r.I.assureBaseUrl(i.kM.renderUrl("/explore",{panes:J,schemaVersion:1}))}function P(w){return`explore_${w}`}function M(w,H,Q,Z,Y,X,I){const J=Number.parseInt(w,36),{interval:ee,intervalMs:q}=V(Z,Q.minInterval,Q.maxDataPoints),ne={app:u.Jk.Explore,timezone:X||o.lE,startTime:Date.now(),interval:ee,intervalMs:q,panelId:J,targets:H,range:Z,requestId:P(w),rangeRaw:Z.raw,scopedVars:{__interval:{text:ee,value:ee},__interval_ms:{text:q,value:q},...I},maxDataPoints:Q.maxDataPoints,liveStreaming:Q.liveStreaming,skipQueryCache:!0};return{queries:H,request:ne,scanning:Y,id:U(),done:!1}}const O=({key:w,...H})=>H,j=(w,H)=>{if(w==null)return"";try{return JSON.stringify(w,null,H)}catch(Q){console.error(Q)}return""};function U(w=0){return`Q-${(0,a.A)()}-${w}`}async function W(w,H=0,Q){let Z,Y,X;return Q?Y=Q:w.length>0&&w[w.length-1].datasource?Y=w[w.length-1].datasource:(Z=await(0,f.l)().get(),X=Z.getDefaultQuery?.(u.Jk.Explore),Y=Z.getRef()),Z||(Z=await(0,f.l)().get(Y),X=Z.getDefaultQuery?.(u.Jk.Explore)),{...X,refId:(0,l.M)(w),key:U(H),datasource:Y}}const B=(w,H,Q=0)=>{const Z=U(Q),Y=w.refId||(0,l.M)(H);return{...w,refId:Y,key:Z}};async function S(w,H){if(w&&typeof w=="object"&&w.length>0){const Q=[];for(let Z=0;Z<w.length;Z++){const Y=w[Z],X=U(Z);let I=Y.refId;I||(I=(0,l.M)(Q));let J=!0;if(Y.datasource)try{await(0,f.l)().get(Y.datasource.uid)}catch{console.error("One of the queries has a datasource that is no longer available and was removed."),J=!1}J&&Q.push({...Y,refId:I,key:X})}return Q}try{const Q=H??(await(0,f.l)().get()).getRef();return[await W(w??[],void 0,Q)]}catch{return[]}}const _=["refId","key","context","datasource"];function K(w){return w&&w.some(H=>Object.entries(H).filter(([Z,Y])=>_.indexOf(Z)===-1).filter(([Z,Y])=>Y).length>0)}const T=w=>w.reduce((Q,Z,Y)=>{const X=Z.datasource?.uid||Z.key;return Q.concat(`${X}-${Y}`)},[]),L=(w,H,Q)=>g.convertRawToRange(H,w,Q),A=w=>p.cC.isLive(w)?s.uH.Ascending:s.uH.Descending,N=w=>{w&&w.unsubscribe()};function V(w,H,Q){return Q?g.calculateInterval(w,Q,H):{interval:"1s",intervalMs:1e3}}const z=w=>{if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(w);else{const H=document.createElement("textarea");H.value=w,document.body.appendChild(H),H.select(),document.execCommand("copy"),document.body.removeChild(H)}}},77197:(te,R,e)=>{"use strict";e.d(R,{A:()=>o});var n=e(37615),a=e(8934),s=e(17548),i=e(55386);const u={valueFormats:{},intervalRegex:/(\d+(?:\.\d+)?)(ms|[Mwdhmsy])/,intervalsInSeconds:{y:31536e3,M:2592e3,w:604800,d:86400,h:3600,m:60,s:1,ms:.001},regexEscape:l=>((0,n.l)("kbn.ts","kbn.regexEscape()","escapeRegex from @grafana/data"),(0,a.$f)(l)),roundInterval:l=>((0,n.l)("kbn.ts","kbn.roundInterval()","@grafana/data"),s.roundInterval(l)),secondsToHms:l=>((0,n.l)("kbn.ts","kbn.secondsToHms()","@grafana/data"),s.secondsToHms(l)),secondsToHhmmss:l=>{const g=[],f=Math.floor(l/3600),p=Math.floor(l%3600/60),c=Math.floor(l%3600%60);return f>9?g.push(""+f):g.push("0"+f),p>9?g.push(""+p):g.push("0"+p),c>9?g.push(""+c):g.push("0"+c),g.join(":")},toPercent:(l,g)=>Math.floor(l/g*1e4)/100+"%",addSlashes:l=>l.replace(/[\'\"\\0]/g,"\\$&"),describeInterval:l=>((0,n.l)("kbn.ts","kbn.describeInterval()","@grafana/data"),s.describeInterval(l)),intervalToSeconds:l=>((0,n.l)("kbn.ts","rangeUtil.intervalToSeconds()","@grafana/data"),s.intervalToSeconds(l)),intervalToMs:l=>((0,n.l)("kbn.ts","rangeUtil.intervalToMs()","@grafana/data"),s.intervalToMs(l)),calculateInterval:(l,g,f)=>((0,n.l)("kbn.ts","kbn.calculateInterval()","@grafana/data"),s.calculateInterval(l,g,f)),queryColorDot:(l,g)=>'<div class="icon-circle" style="'+["display:inline-block","color:"+l,"font-size:"+g+"px"].join(";")+'"></div>',slugifyForUrl:l=>l.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-"),stringToJsRegex:l=>((0,n.l)("kbn.ts","kbn.stringToJsRegex()","@grafana/data"),(0,a.dO)(l)),toFixed:(l,g)=>{if(l===null)return"";const f=g?Math.pow(10,Math.max(0,g)):1,p=String(Math.round(l*f)/f);if(p.indexOf("e")!==-1||l===0)return p;if(g!=null){const c=p.indexOf("."),x=c===-1?0:p.length-c-1;if(x<g)return(x?p:p+".")+String(f).slice(1,g-x+1)}return p},toFixedScaled:(l,g,f,p,c)=>f===null?u.toFixed(l,g)+c:u.toFixed(l,f+p)+c,roundValue:(l,g)=>{if(l===null)return null;const f=Math.pow(10,g),p=(f*l).toFixed(g);return Math.round(parseFloat(p))/f},getUnitFormats:i.Ke};typeof Proxy<"u"?u.valueFormats=new Proxy(u.valueFormats,{get(l,g,f){if(typeof g!="string")throw{message:`Value format ${String(g)} is not a string`};const p=(0,i.j_)(g);return p?(c,x,v,m)=>(0,i.cN)(p(c,x,v,m?"utc":"browser")):Reflect.get(l,g,f)}}):u.valueFormats=(0,i.uH)();const o=u},60017:(te,R,e)=>{"use strict";e.d(R,{j:()=>a,z:()=>s});var n=e(78731);function a(i){if(!(!performance||!performance.mark))try{performance.mark(`${i}_started`)}catch(r){console.error(`[Metrics] Failed to startMeasure ${i}`,r)}}function s(i){if(!(!performance||!performance.mark))try{const r=`${i}_started`,u=`${i}_completed`,o=`${i}_measured`;performance.mark(u);const l=performance.measure(o,r,u);return(0,n.n)(`${i}_ms`,l.duration),performance.clearMarks(r),performance.clearMarks(u),performance.clearMeasures(o),l}catch(r){console.error(`[Metrics] Failed to stopMeasure ${i}`,r);return}}},18832:(te,R,e)=>{"use strict";e.d(R,{C:()=>s,o:()=>i});var n=e(92745),a=e(43173);function s(r){switch(r){case"home":return(0,n.t)("nav.home.title","Home");case"home-setup-guide":return(0,n.t)("nav.setup-guide.title","Getting started guide");case"new":return(0,n.t)("nav.new.title","New");case"create":return(0,n.t)("nav.create.title","Create");case"create-dashboard":return(0,n.t)("nav.create-dashboard.title","Dashboard");case"folder":return(0,n.t)("nav.create-folder.title","Folder");case"import":return(0,n.t)("nav.create-import.title","Import dashboard");case"alert":return(0,n.t)("nav.create-alert.title","New alert rule");case"bookmarks":return(0,n.t)("nav.bookmarks.title","Bookmarks");case"bookmarks-empty":return(0,n.t)("nav.bookmarks-empty.title","Bookmark pages for them to appear here");case"starred":return(0,n.t)("nav.starred.title","Starred");case"starred-empty":return(0,n.t)("nav.starred-empty.title","Your starred dashboards will appear here");case"dashboards":return(0,n.t)("nav.dashboards.title","Dashboards");case"dashboards/browse":return(0,n.t)("nav.dashboards.title","Dashboards");case"dashboards/playlists":return(0,n.t)("nav.playlists.title","Playlists");case"dashboards/snapshots":return(0,n.t)("nav.snapshots.title","Snapshots");case"dashboards/library-panels":return(0,n.t)("nav.library-panels.title","Library panels");case"reports":return(0,n.t)("nav.reporting.title","Reporting");case"dashboards/public":return a.$.featureToggles.newDashboardSharingComponent?(0,n.t)("nav.shared-dashboard.title","Shared dashboards"):(0,n.t)("nav.public.title","Public dashboards");case"dashboards/recently-deleted":return(0,n.t)("nav.recently-deleted.title","Recently deleted");case"dashboards/new":return(0,n.t)("nav.new-dashboard.title","New dashboard");case"dashboards/folder/new":return(0,n.t)("nav.new-folder.title","New folder");case"dashboards/import":return(0,n.t)("nav.create-import.title","Import dashboard");case"scenes":return(0,n.t)("nav.scenes.title","Scenes");case"explore":return(0,n.t)("nav.explore.title","Explore");case"drilldown":return(0,n.t)("nav.drilldown.title","Drilldown");case"alerting":return(0,n.t)("nav.alerting.title","Alerting");case"plugin-page-grafana-oncall-app":return(0,n.t)("nav.oncall.title","OnCall");case"alerting-legacy":return(0,n.t)("nav.alerting-legacy.title","Alerting (legacy)");case"alerting-upgrade":return(0,n.t)("nav.alerting-upgrade.title","Alerting upgrade");case"alert-home":return(0,n.t)("nav.alerting-home.title","Home");case"alert-list":return(0,n.t)("nav.alerting-list.title","Alert rules");case"alert-list-legacy":return(0,n.t)("nav.alert-list-legacy.title","Alert rules");case"receivers":return(0,n.t)("nav.alerting-receivers.title","Contact points");case"am-routes":return(0,n.t)("nav.alerting-am-routes.title","Notification policies");case"channels":return(0,n.t)("nav.alerting-channels.title","Notification channels");case"silences":return(0,n.t)("nav.alerting-silences.title","Silences");case"groups":return(0,n.t)("nav.alerting-groups.title","Active notifications");case"alerting-admin":return(0,n.t)("nav.alerting-admin.title","Settings");case"alerts/recently-deleted":return(0,n.t)("nav.alerts-recently-deleted.title","Recently deleted");case"cfg":return(0,n.t)("nav.config.title","Administration");case"cfg/general":return(0,n.t)("nav.config-general.title","General");case"cfg/plugins":return(0,n.t)("nav.config-plugins.title","Plugins and data");case"cfg/access":return(0,n.t)("nav.config-access.title","Users and access");case"datasources":return(0,n.t)("nav.datasources.title","Data sources");case"authentication":return(0,n.t)("nav.authentication.title","Authentication");case"licensing":return(0,n.t)("nav.statistics-and-licensing.title","Statistics and licensing");case"recordedQueries":return(0,n.t)("nav.recorded-queries.title","Recorded queries");case"correlations":return(0,n.t)("nav.correlations.title","Correlations");case"users":return(0,n.t)("nav.users.title","Users");case"teams":return(0,n.t)("nav.teams.title","Teams");case"plugins":return(0,n.t)("nav.plugins.title","Plugins");case"org-settings":return(0,n.t)("nav.org-settings.title","Default preferences");case"serviceaccounts":return(0,n.t)("nav.service-accounts.title","Service accounts");case"admin":return(0,n.t)("nav.admin.title","Server admin");case"support-bundles":return(0,n.t)("nav.support-bundles.title","Support bundles");case"global-users":return(0,n.t)("nav.global-users.title","Users");case"global-orgs":return(0,n.t)("nav.global-orgs.title","Organizations");case"server-settings":return(0,n.t)("nav.server-settings.title","Settings");case"storage":return(0,n.t)("nav.storage.title","Storage");case"migrate-to-cloud":return(0,n.t)("nav.migrate-to-cloud.title","Migrate to Grafana Cloud");case"upgrading":return(0,n.t)("nav.upgrading.title","Stats and license");case"monitoring":return(0,n.t)("nav.monitoring.title","Observability");case"infrastructure":return(0,n.t)("nav.infrastructure.title","Infrastructure");case"frontend":return(0,n.t)("nav.frontend.title","Frontend");case"apps":return(0,n.t)("nav.apps.title","More apps");case"alerts-and-incidents":return(0,n.t)("nav.alerts-and-incidents.title","Alerts & IRM");case"testing-and-synthetics":return(0,n.t)("nav.testing-and-synthetics.title","Testing & synthetics");case"plugin-page-grafana-incident-app":return(0,n.t)("nav.incidents.title","Incident");case"plugin-page-grafana-ml-app":return(0,n.t)("nav.machine-learning.title","AI & machine learning");case"plugin-page-grafana-slo-app":return(0,n.t)("nav.slo.title","SLO");case"plugin-page-k6-app":return(0,n.t)("nav.k6.title","Performance");case"plugin-page-grafana-k8s-app":return(0,n.t)("nav.kubernetes.title","Kubernetes");case"plugin-page-grafana-dbo11y-app":return(0,n.t)("nav.databases.title","Databases");case"plugin-page-grafana-app-observability-app":return(0,n.t)("nav.application.title","Application");case"plugin-page-grafana-pyroscope-app":return(0,n.t)("nav.profiles.title","Profiles");case"plugin-page-grafana-kowalski-app":return(0,n.t)("nav.frontend-app.title","Frontend");case"plugin-page-grafana-synthetic-monitoring-app":return(0,n.t)("nav.synthetics.title","Synthetics");case"help":return(0,n.t)("nav.help.title","Help");case"profile/settings":return(0,n.t)("nav.profile/settings.title","Profile");case"profile/notifications":return(0,n.t)("nav.profile/notifications.title","Notification history");case"profile/password":return(0,n.t)("nav.profile/password.title","Change password");case"sign-out":return(0,n.t)("nav.sign-out.title","Sign out");case"search":return(0,n.t)("nav.search-dashboards.title","Search dashboards");case"connections":return(0,n.t)("nav.connections.title","Connections");case"connections-add-new-connection":return(0,n.t)("nav.add-new-connections.title","Add new connection");case"standalone-plugin-page-/connections/collector":return(0,n.t)("nav.collector.title","Collector");case"connections-datasources":return(0,n.t)("nav.data-sources.title","Data sources");case"standalone-plugin-page-/connections/infrastructure":return(0,n.t)("nav.integrations.title","Integrations");case"standalone-plugin-page-/connections/connect-data":return(0,n.t)("nav.connect-data.title","Connect data");case"standalone-plugin-page-/connections/private-data-source-connections":return(0,n.t)("nav.private-data-source-connections.title","Private data source connect");case"plugin-page-grafana-detect-app":return(0,n.t)("nav.detect.title","Detect");case"plugin-page-grafana-quaderno-app":return(0,n.t)("nav.grafana-quaderno.title","Grafana Quaderno");default:return}}function i(r){switch(r){case"dashboards":return(0,n.t)("nav.dashboards.subtitle","Create and manage dashboards to visualize your data");case"dashboards/browse":return(0,n.t)("nav.dashboards.subtitle","Create and manage dashboards to visualize your data");case"manage-folder":return(0,n.t)("nav.manage-folder.subtitle","Manage folder dashboards and permissions");case"dashboards/playlists":return(0,n.t)("nav.playlists.subtitle","Groups of dashboards that are displayed in a sequence");case"dashboards/snapshots":return(0,n.t)("nav.snapshots.subtitle","Interactive, publically available, point-in-time representations of dashboards and panels");case"dashboards/public":return a.$.featureToggles.newDashboardSharingComponent?(0,n.t)("nav.shared-dashboard.subtitle","Manage your organization's externally shared dashboards"):void 0;case"dashboards/library-panels":return(0,n.t)("nav.library-panels.subtitle","Reusable panels that can be added to multiple dashboards");case"dashboards/recently-deleted":return(0,n.t)("nav.recently-deleted.subtitle","Any items listed here for more than 30 days will be automatically deleted.");case"alerting":return(0,n.t)("nav.alerting.subtitle","Learn about problems in your systems moments after they occur");case"alerting-upgrade":return(0,n.t)("nav.alerting-upgrade.subtitle","Upgrade your existing legacy alerts and notification channels to the new Grafana Alerting");case"alerting-admin":return(0,n.t)("nav.alerting-admin.subtitle","Manage Alertmanager configurations and enable receiving Grafana-managed alerts");case"alert-list":return(0,n.t)("nav.alerting-list.subtitle","Rules that determine whether an alert will fire");case"receivers":return(0,n.t)("nav.alerting-receivers.subtitle","Choose how to notify your contact points when an alert instance fires");case"am-routes":return(0,n.t)("nav.alerting-am-routes.subtitle","Determine how alerts are routed to contact points");case"silences":return(0,n.t)("nav.alerting-silences.subtitle","Stop notifications from one or more alerting rules");case"groups":return(0,n.t)("nav.alerting-groups.subtitle","See grouped alerts with active notifications");case"alerts/recently-deleted":return(0,n.t)("nav.alerts-recently-deleted.subtitle","See recently deleted alert rules");case"datasources":return(0,n.t)("nav.datasources.subtitle","Add and configure data sources");case"correlations":return(0,n.t)("nav.correlations.subtitle","Add and configure correlations");case"users":return(0,n.t)("nav.users.subtitle","Invite and assign roles to users");case"teams":return(0,n.t)("nav.teams.subtitle","Groups of users that have common dashboard and permission needs");case"plugins":return(0,n.t)("nav.plugins.subtitle","Extend the Grafana experience with plugins");case"org-settings":return(0,n.t)("nav.org-settings.subtitle","Manage preferences across an organization");case"serviceaccounts":return(0,n.t)("nav.service-accounts.subtitle","Use service accounts to run automated workloads in Grafana");case"groupsync":return(0,n.t)("nav.groupsync.subtitle","Manage mappings of Identity Provider groups to Grafana Roles");case"global-users":return(0,n.t)("nav.global-users.subtitle","Manage users in Grafana");case"global-orgs":return(0,n.t)("nav.global-orgs.subtitle","Isolated instances of Grafana running on the same server");case"server-settings":return(0,n.t)("nav.server-settings.subtitle","View the settings defined in your Grafana config");case"storage":return(0,n.t)("nav.storage.subtitle","Manage file storage");case"migrate-to-cloud":return(0,n.t)("nav.migrate-to-cloud.subtitle","Copy resources from your self-managed installation to a cloud stack");case"support-bundles":return(0,n.t)("nav.support-bundles.subtitle","Download support bundles");case"admin":return(0,n.t)("nav.admin.subtitle","Manage server-wide settings and access to resources such as organizations, users, and licenses");case"cfg/general":return(0,n.t)("nav.config-general.subtitle","Manage default preferences and settings across Grafana");case"cfg/plugins":return(0,n.t)("nav.config-plugins.subtitle","Install plugins and define the relationships between data");case"cfg/access":return(0,n.t)("nav.config-access.subtitle","Configure access for individual users, teams, and service accounts");case"apps":return(0,n.t)("nav.apps.subtitle","App plugins that extend the Grafana experience");case"monitoring":return(0,n.t)("nav.monitoring.subtitle","Out-of-the-box observability solutions");case"infrastructure":return(0,n.t)("nav.infrastructure.subtitle","Understand your infrastructure's health");case"frontend":return(0,n.t)("nav.frontend.subtitle","Gain real user monitoring insights");case"alerts-and-incidents":return(0,n.t)("nav.alerts-and-incidents.subtitle","Alerting and incident management apps");case"testing-and-synthetics":return(0,n.t)("nav.testing-and-synthetics.subtitle","Optimize performance with k6 and Synthetic Monitoring insights");case"connections-add-new-connection":return(0,n.t)("nav.connections.subtitle","Browse and create new connections");case"connections-datasources":return(0,n.t)("nav.data-sources.subtitle","View and manage your connected data source connections");case"connections-private-data-source-connections":return(0,n.t)("nav.private-data-source-connections.subtitle","Query data that lives within a secured network without opening the network to inbound traffic from Grafana Cloud. Learn more in our docs.");case"plugin-page-grafana-ml-app":return(0,n.t)("nav.machine-learning.subtitle","Explore AI and machine learning features");default:return}}},10605:(te,R,e)=>{"use strict";e.d(R,{v:()=>s});var n=e(2543),a=e.n(n);function s(i,r){return(0,n.isArray)(i)?i.map(u=>s(u,r)):(0,n.isPlainObject)(i)?Object.keys(i).sort().reduce((u,o)=>{const l=i[o];return l!=null&&(u[o]=s(l,r)),r&&(l===1/0||l===-1/0)&&(u[o]=0),u},{}):i}},1404:(te,R,e)=>{"use strict";e.d(R,{Ih:()=>a,Lr:()=>r,U7:()=>s,dr:()=>i,fE:()=>u});var n=e(39796);function a(o){const l=["refId","hide","key","queryType","datasource"];for(const g in o)if(g!=="label"&&!l.includes(g))return!1;return!0}function s(o,l,g){const f={...l,refId:(0,n.M)(o),hide:!1};return!f.datasource&&g&&(f.datasource=g),[...o,f]}function i(o){return o.indexOf("api/datasources/proxy")!==-1||o.indexOf("api/ds/query")!==-1}function r(o){return!o.match(/^http/)}function u(o){return o||void 0}},81970:(te,R,e)=>{"use strict";e.d(R,{Ax:()=>W,DI:()=>y,Gx:()=>d,IA:()=>M,NC:()=>C,TR:()=>S,U3:()=>P,X1:()=>E,cX:()=>D,l0:()=>m,oU:()=>b,rs:()=>h,x8:()=>B,xB:()=>v.x});var n=e(2543),a=e.n(n),s=e(83175),i=e(80011),r=e(92745),u=e(78282),o=e(6890),l=e(64762),g=e(8535),f=e(72054),p=e(68126),c=e(53222),x=e(15130),v=e(80977);async function m(K){const{queries:T,localOverride:L,datasource:A,starred:N,comment:V,showNotif:z}=K,w=z?.quotaExceededError??!0,H=z?.limitExceededWarning??!0,Q=z?.otherErrors??!0,Z=T&&T.filter(Y=>_(Y));if(Z.length>0){let Y=!1,X=!1,I;try{I=(await(L?(0,c.tU)():(0,c.a)()).addToRichHistory({datasourceUid:A.uid,datasourceName:A.name??"",queries:Z,starred:N,comment:V??""})).warning}catch(J){return J instanceof Error&&(J.name===f.m.StorageFull?(Y=!0,w&&(0,g.JD)((0,o.dx)((0,l.gi)(J.message)))):Q&&J.name!==f.m.DuplicatedEntry&&(0,g.JD)((0,o.dx)((0,l.gi)((0,r.t)("explore.rich-history-utils-notification.update-failed","Rich History update failed"),J.message)))),{richHistoryStorageFull:Y,limitExceeded:X}}return I&&I.type===f.C.LimitExceeded&&(X=!0,H&&(0,g.JD)((0,o.dx)((0,l.q8)(I.message)))),{richHistoryStorageFull:Y,limitExceeded:X}}return{}}async function y(K){const T={...K,from:K.to===void 0?K.to:(0,p.wQ)(K.to,{isLastTs:!0,tz:x.TP.user?.timezone}),to:K.from===void 0?K.from:(0,p.wQ)(K.from,{isLastTs:!0,tz:x.TP.user?.timezone})};return await(0,c.a)().getRichHistory(T)}async function h(K){await(0,c.a)().updateSettings(K)}async function d(){return await(0,c.a)().getSettings()}async function E(){return(0,c.a)().deleteAll()}async function b(K,T){try{return await(0,c.a)().updateStarred(K,T)}catch(L){L instanceof Error&&(0,g.JD)((0,o.dx)((0,l.gi)((0,r.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),L.message)));return}}async function D(K,T){try{return await(0,c.a)().updateComment(K,T)}catch(L){L instanceof Error&&(0,g.JD)((0,o.dx)((0,l.gi)((0,r.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),L.message)));return}}async function C(K){try{return await(0,c.a)().deleteRichHistory(K),K}catch(T){T instanceof Error&&(0,g.JD)((0,o.dx)((0,l.gi)((0,r.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),T.message)));return}}const P=K=>{const T={range:{from:"now-1h",to:"now"},datasource:K.datasourceName,queries:K.queries},L=(0,s.Pp)(T),A=/.*(?=\/explore)/.exec(`${window.location.href}`)[0];return s.kM.renderUrl(`${A}/explore`,{left:L})},M=K=>{let T;switch(K){case 0:T=(0,r.t)("explore.rich-history-utils.today","today");break;case 1:T=(0,r.t)("explore.rich-history-utils.yesterday","yesterday");break;case 7:T=(0,r.t)("explore.rich-history-utils.a-week-ago","a week ago");break;case 14:T=(0,r.t)("explore.rich-history-utils.two-weeks-ago","two weeks ago");break;default:T=(0,r.t)("explore.rich-history-utils.days-ago","{{num}} days ago",{num:`${K}`})}return T};function O(K){return(0,i.LE)(K,{format:"MMMM D"})}function j(K){const T=(0,n.omit)(K,["key","refId","datasource"]);return JSON.stringify(T)}function U(K,T){let L="";return T===v.x.DatasourceAZ||T===v.x.DatasourceZA?L=K.datasourceName:L=O(K.createdAt),L}function W(K,T){return T?.getQueryDisplayText?T.getQueryDisplayText(K):j(K)}function B(K,T){let L={};return K.forEach(A=>{let N=U(A,T);N in L?L[N]=[...L[N],A]:L[N]=[A]}),L}function S(){return(0,u.l)().getList({mixed:!0}).map(K=>({name:K.name,uid:K.uid}))}function _(K){const T=(0,n.omit)(K,["key","refId","datasource"]);return Object.keys(T).length>0}},80977:(te,R,e)=>{"use strict";e.d(R,{x:()=>n});var n=(a=>(a.Descending="Descending",a.Ascending="Ascending",a.DatasourceAZ="Datasource A-Z",a.DatasourceZA="Datasource Z-A",a))(n||{})},71673:(te,R,e)=>{"use strict";e.d(R,{$l:()=>d,Sp:()=>y,VN:()=>h,VP:()=>m,fn:()=>v,sU:()=>b});var n=e(41811),a=e(92745),s=e(43173),i=e(68143),r=e(36490),u=e(36674),o=e(6890),l=e(64762),g=e(52043),f=e(8535),p=e(62635);function c(){return`${window.location.protocol}//${window.location.host}${s.$.appSubUrl}`}function x(D){let C=D.replace(c(),"");return C.startsWith("/")?C.substring(1,C.length):C}const v=(0,n.default)(async function(D){try{return(await(0,i.AI)().post("/api/short-urls",{path:x(D)})).url}catch(C){console.error("Error when creating shortened link: ",C),(0,f.JD)((0,o.dx)((0,l.gi)("Error generating shortened link")))}}),m=async D=>{const C=await v(D);C?((0,p.uJ)(C),(0,f.JD)((0,o.dx)((0,l.tZ)("Shortened link copied to clipboard")))):(0,f.JD)((0,o.dx)((0,l.gi)("Error generating shortened link")))},y=async(D,C,P)=>{const M=h(D,C,P);if(C.useShortUrl)return await m(M);(0,p.uJ)(M),(0,f.JD)((0,o.dx)((0,l.tZ)((0,a.t)("link.share.copy-to-clipboard","Link copied to clipboard"))))},h=(D,C,P)=>{const M=r.Ny.getLocation(),O=u.jh.getTimeRange(P??D),j=d(C,O,P);return(0,g.u)({uid:D.state.uid,slug:D.state.meta.slug,currentQueryParams:M.search,updateQuery:j,absolute:!C.useShortUrl})},d=(D,C,P)=>{const M={};return P&&(M.viewPanel=P.state.key),D.useAbsoluteTimeRange&&(M.from=C.state.value.from.toISOString(),M.to=C.state.value.to.toISOString()),D.theme!=="current"&&(M.theme=D.theme),M};function E(D,C){for(let P=C.indexOf(D)-1;P>=0;P--)if(C[P].timeEpochMs>D.timeEpochMs)return C[P];return null}function b(D,C,P){const M={from:new Date(P.from).toISOString(),to:new Date(P.to).toISOString()};if(!s.$.featureToggles.logsInfiniteScrolling)return M;const O=C.filter(U=>U.dataFrame.refId===D.dataFrame.refId),j=E(D,O);return D.timeEpochMs>P.to&&!j?{from:new Date(P.from).toISOString(),to:new Date(D.timeEpochMs+1).toISOString()}:{from:new Date(P.from).toISOString(),to:new Date(j?j.timeEpochMs:P.to).toISOString()}}},23237:(te,R,e)=>{"use strict";e.d(R,{Wb:()=>a,Zk:()=>s,zG:()=>i});var n=e(25229);const a=(r,u)=>{const o={from:(0,n.yT)(u.from),to:(0,n.yT)(u.to)},l=(o.to.valueOf()-o.from.valueOf())/2;let g,f;return r===-1?(g=o.to.valueOf()-l,f=o.from.valueOf()-l):r===1?(g=o.to.valueOf()+l,f=o.from.valueOf()+l,g>Date.now()&&o.to.valueOf()<Date.now()&&(g=Date.now(),f=o.from.valueOf())):(g=o.to.valueOf(),f=o.from.valueOf()),{from:f,to:g}},s=(r,u)=>{const o=r.to.valueOf()-r.from.valueOf(),l=r.to.valueOf()-o/2,g=o===0?3e4:o*u,f=l+g/2;return{from:l-g/2,to:f}};async function i(){const r=await navigator.clipboard.readText();let u;try{return u=JSON.parse(r),!u.from||!u.to?{range:r,isError:!0}:{range:u,isError:!1}}catch{return{range:r,isError:!0}}}},65556:(te,R,e)=>{"use strict";e.d(R,{r:()=>a});let n="";const a=()=>{const i=new URLSearchParams(window.location.search).get("auth_token");return i!==null&&i!==""?(n=i,i):n}},49517:(te,R,e)=>{"use strict";e.d(R,{G:()=>S});var n=e(74848),a=e(85891),s=e(73628),i=e(96540),r=e(92745),u=e(22787),o=e(45861),l=e(22803),g=e(63142),f=e(50275),p=e(37386),c=e(18027),x=e(35427),v=e(21285),m=e(97095),y=e(77824),h=e(17200),d=e(41654),E=e(63527),b=e(43243),D=e(76319);const C=({value:_,onChange:K})=>{const[T,L]=(0,i.useState)(""),[A,N]=(0,i.useState)(""),[V,z]=(0,i.useState)(a.VR.String),w=J=>{L(J)},H=J=>{N(J)},Q=J=>{z(J.value)},Z=()=>{let J;_?J=_.filter(ee=>ee.key!==T):J=[],J.push({key:T,name:A,type:V}),J.sort((ee,q)=>ee.key.localeCompare(q.key)),K(J),L(""),N(""),z(a.VR.String)},Y=J=>()=>{const ee=_.filter(q=>q.key!==J);K(ee)},X=A===""||T==="",I=[{label:"string",value:a.VR.String}];return(0,n.jsxs)("div",{children:[(0,n.jsxs)(d.B,{direction:"row",children:[(0,n.jsx)(E.p,{value:T,onChange:J=>w(J.currentTarget.value),placeholder:(0,r.t)("actions.params-editor.placeholder-key","Key"),width:300}),(0,n.jsx)(E.p,{value:A,onChange:J=>H(J.currentTarget.value),placeholder:(0,r.t)("actions.params-editor.placeholder-name","Name"),width:300}),(0,n.jsx)(b.G,{value:V,onChange:Q,placeholder:(0,r.t)("actions.variables-editor.placeholder-type","Type"),options:I,maxWidth:100,minWidth:10,width:"auto"}),(0,n.jsx)(D.K,{"aria-label":(0,r.t)("actions.params-editor.aria-label-add","Add"),name:"plus-circle",onClick:()=>Z(),disabled:X})]}),(0,n.jsx)(d.B,{direction:"column",children:_.map(J=>(0,n.jsxs)(d.B,{direction:"row",children:[(0,n.jsx)(E.p,{disabled:!0,value:J.key,width:300}),(0,n.jsx)(E.p,{disabled:!0,value:J.name,width:300}),(0,n.jsx)(E.p,{disabled:!0,value:J.type,width:100}),(0,n.jsx)(D.K,{"aria-label":(0,r.t)("actions.params-editor.aria-label-delete","Delete"),onClick:Y(J.key),name:"trash-alt"})]},J.key))})]})};var P=e(18857);const M=({value:_,onChange:K,suggestions:T,contentTypeHeader:L=!1})=>{const A=(0,g.of)(O),N=_.find(([oe,de])=>oe==="Content-Type"),[V,z]=(0,i.useState)(""),[w,H]=(0,i.useState)(""),[Q,Z]=(0,i.useState)("");(0,i.useEffect)(()=>{Q!==""?Z(Q):N&&Z(N[1])},[Q,N]);const[Y,X]=(0,i.useState)(Math.random().toString()),I=oe=>{H(oe)},J=oe=>{z(oe)},ee=oe=>()=>{const de=_.filter(fe=>fe[0]!==oe);K(de)},q=oe=>{let de;_?de=_.filter(fe=>fe[0]!==(oe?oe[0]:V)):de=[],de.push(oe??[V,w]),de.sort((fe,ae)=>fe[0].localeCompare(ae[0])),K(de),z(""),H(""),X(Math.random().toString())},ne=oe=>{Z(oe),q(["Content-Type",oe])},se=V===""||w==="";return(0,n.jsxs)("div",{children:[(0,n.jsxs)(d.B,{direction:"row",children:[(0,n.jsx)(h.y,{value:V,onChange:J,suggestions:T,placeholder:(0,r.t)("actions.params-editor.placeholder-key","Key"),style:{width:332}}),(0,n.jsx)(h.y,{value:w,onChange:I,suggestions:T,placeholder:(0,r.t)("actions.params-editor.placeholder-value","Value"),style:{width:332}}),(0,n.jsx)(D.K,{"aria-label":(0,r.t)("actions.params-editor.aria-label-add","Add"),name:"plus-circle",onClick:()=>q(),disabled:se})]},Y),(0,n.jsx)(d.B,{direction:"column",children:Array.from(_.filter(oe=>oe[0]!=="Content-Type")||[]).map(oe=>(0,n.jsxs)(d.B,{direction:"row",children:[(0,n.jsx)(E.p,{disabled:!0,value:oe[0]}),(0,n.jsx)(E.p,{disabled:!0,value:oe[1]}),(0,n.jsx)(D.K,{"aria-label":(0,r.t)("actions.params-editor.aria-label-delete","Delete"),onClick:ee(oe[0]),name:"trash-alt"})]},oe[0]))}),L&&(0,n.jsx)("div",{className:A.extraHeader,children:(0,n.jsxs)(d.B,{direction:"row",children:[(0,n.jsx)(E.p,{value:"Content-Type",disabled:!0}),(0,n.jsx)(P.l6,{onChange:oe=>ne(oe.value),options:a.Ur,value:Q})]})})]})},O=_=>({extraHeader:(0,l.css)({marginTop:_.spacing(1),marginBottom:_.spacing(1),maxWidth:673})}),j=13,U=(0,i.memo)(({index:_,value:K,onChange:T,suggestions:L,showOneClick:A})=>{const N=(0,g.of)(W),V=(0,g.$j)(),z=se=>{T(_,{...K,title:se})},w=se=>{T(_,{...K,confirmation:se})},H=()=>{T(_,{...K,oneClick:!K.oneClick})},Q=se=>{T(_,{...K,fetch:{...K.fetch,url:se}})},Z=se=>{T(_,{...K,fetch:{...K.fetch,body:se}})},Y=se=>{T(_,{...K,fetch:{...K.fetch,method:se}})},X=se=>{T(_,{...K,variables:se})},I=se=>{T(_,{...K,fetch:{...K.fetch,queryParams:se}})},J=se=>{T(_,{...K,fetch:{...K.fetch,headers:se}})},ee=se=>{T(_,{...K,style:{...K.style,backgroundColor:se}})},q=(se="{}")=>{try{const oe=JSON.parse(se);return(0,n.jsx)(f.B,{json:oe})}catch(oe){return oe instanceof Error?`Invalid JSON provided: ${oe.message}`:"Invalid JSON provided"}},ne=K.fetch.method!==a.DO.GET&&K.fetch.headers?.some(([se,oe])=>se==="Content-Type"&&oe==="application/json");return(0,n.jsxs)("div",{className:N.listItem,children:[(0,n.jsx)(p.D,{label:(0,r.t)("grafana-ui.action-editor.modal.action-title","Title"),className:N.inputField,children:(0,n.jsx)(h.y,{value:K.title,onChange:z,suggestions:L,autoFocus:K.title==="",placeholder:(0,r.t)("grafana-ui.action-editor.modal.action-title-placeholder","Action title")})}),(0,n.jsx)(p.D,{label:(0,r.t)("grafana-ui.viz-tooltip.actions-confirmation-label","Confirmation message"),description:(0,r.t)("grafana-ui.viz-tooltip.actions-confirmation-message","Provide a descriptive prompt to confirm or cancel the action."),className:N.inputField,children:(0,n.jsx)(h.y,{value:K.confirmation,onChange:w,suggestions:L,placeholder:(0,r.t)("grafana-ui.viz-tooltip.actions-confirmation-input-placeholder","Are you sure you want to {{ actionTitle }}?",{actionTitle:K.title||"... "})})}),(0,n.jsx)(p.D,{label:(0,r.t)("grafana-ui.action-editor.button.style","Button style"),children:(0,n.jsx)(c.I,{label:(0,r.t)("actions.action-editor.button.style.background-color","Color"),labelWidth:j,className:N.colorPicker,children:(0,n.jsx)(x.sk,{color:K?.style?.backgroundColor||V.colors.secondary.main,onChange:ee})})}),A&&(0,n.jsx)(p.D,{label:(0,r.t)("grafana-ui.data-link-inline-editor.one-click","One click"),description:(0,r.t)("grafana-ui.action-editor.modal.one-click-description","Only one link or action can have one click enabled at a time"),children:(0,n.jsx)(v.d,{value:K.oneClick||!1,onChange:H})}),(0,n.jsx)(m.C,{children:(0,n.jsx)(c.I,{label:(0,r.t)("grafana-ui.action-editor.modal.action-method","Method"),labelWidth:j,grow:!0,children:(0,n.jsx)(y.z,{value:K?.fetch.method,options:a.ki,onChange:Y,fullWidth:!0})})}),(0,n.jsx)(m.C,{children:(0,n.jsx)(c.I,{label:(0,r.t)("actions.action-editor.label-url","URL"),labelWidth:j,grow:!0,children:(0,n.jsx)(h.y,{value:K.fetch.url,onChange:Q,suggestions:L,placeholder:(0,r.t)("actions.action-editor.placeholder-url","URL")})})}),(0,n.jsx)(p.D,{label:(0,r.t)("grafana-ui.action-editor.modal.action-variables","Variables"),className:N.fieldGap,noMargin:!0,children:(0,n.jsx)(C,{onChange:X,value:K.variables??[]})}),(0,n.jsx)(p.D,{label:(0,r.t)("grafana-ui.action-editor.modal.action-query-params","Query parameters"),className:N.fieldGap,children:(0,n.jsx)(M,{value:K?.fetch.queryParams??[],onChange:I,suggestions:L})}),(0,n.jsx)(p.D,{label:(0,r.t)("actions.action-editor.label-headers","Headers"),children:(0,n.jsx)(M,{value:K?.fetch.headers??[],onChange:J,suggestions:L,contentTypeHeader:!0})}),K?.fetch.method!==a.DO.GET&&(0,n.jsx)(p.D,{label:(0,r.t)("grafana-ui.action-editor.modal.action-body","Body"),className:N.inputField,children:(0,n.jsx)(h.y,{value:K.fetch.body,onChange:Z,suggestions:L,type:h.c.TextAreaElement})}),ne&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("br",{}),q(K?.fetch.body)]})]})}),W=_=>({listItem:(0,l.css)({marginBottom:_.spacing()}),infoText:(0,l.css)({paddingBottom:_.spacing(2),marginLeft:"66px",color:_.colors.text.secondary}),fieldGap:(0,l.css)({marginTop:_.spacing(2)}),inputField:(0,l.css)({marginRight:4}),colorPicker:(0,l.css)({display:"flex",alignItems:"center"})});U.displayName="ActionEditor";const B=({action:_,index:K,onSave:T,onCancel:L,getSuggestions:A,showOneClick:N})=>{const[V,z]=(0,i.useState)(_);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(U,{value:V,index:K,onChange:(w,H)=>{z(H)},suggestions:A(),showOneClick:N}),(0,n.jsxs)(u.a.ButtonRow,{children:[(0,n.jsx)(o.$n,{variant:"secondary",onClick:()=>L(K),fill:"outline",children:(0,n.jsx)(r.x6,{i18nKey:"action-editor.modal.cancel-button",children:"Cancel"})}),(0,n.jsx)(o.$n,{onClick:()=>{T(K,V)},disabled:V.title.trim()===""||V.fetch.url.trim()==="",children:(0,n.jsx)(r.x6,{i18nKey:"action-editor.modal.save-button",children:"Save"})})]})]})},S=({actions:_,getSuggestions:K,showOneClick:T=!1,...L})=>(0,n.jsx)(s.J,{type:"action",items:_,...L,children:(A,N,V,z)=>(0,n.jsx)(B,{index:N,action:A??a.mx,data:L.data,onSave:V,onCancel:z,getSuggestions:K,showOneClick:T})})},74267:(te,R,e)=>{"use strict";e.d(R,{$u:()=>V,A5:()=>Y,Bc:()=>X,DX:()=>_,JI:()=>B,Jc:()=>K,Kg:()=>S,MV:()=>y,N6:()=>E,P3:()=>C,Pi:()=>P,T$:()=>O,TK:()=>v,VR:()=>j,Vk:()=>w,hG:()=>d,hU:()=>L,is:()=>I,kz:()=>c,ly:()=>m,mI:()=>W,nM:()=>N,nh:()=>D,nr:()=>h,pm:()=>U,xq:()=>Q,yd:()=>z});var n=e(2543),a=e.n(n),s=e(80011),i=e(62061),r=e(68143),u=e(36490),o=e(65642),l=e(73427),g=e(81871),f=e(11257),p=e(52695);function c(J){return async ee=>{try{ee((0,p.D1)(!1)),await ee(x(J)),await ee(b(J)),await ee(M(J)),o.Ay.ldapEnabled&&(0,i.a)("ldapsync")&&await ee(U()),ee((0,p.D1)(!0))}catch(q){if(console.error(q),(0,r.NF)(q)){const ne={title:q.data.message,body:q.data.error};ee((0,p.PV)(ne))}}}}function x(J){return async ee=>{const q=await(0,r.AI)().get(`/api/users/${J}`,(0,g.F)());ee((0,p.G_)(q))}}function v(J){return async ee=>{await(0,r.AI)().put(`/api/users/${J.uid}`,J),ee(c(J.uid))}}function m(J,ee){return async q=>{const ne={password:ee};await(0,r.AI)().put(`/api/admin/users/${J}/password`,ne),q(c(J))}}function y(J){return async ee=>{await(0,r.AI)().post(`/api/admin/users/${J}/disable`),u.Ny.push("/admin/users")}}function h(J){return async ee=>{await(0,r.AI)().post(`/api/admin/users/${J}/enable`),ee(c(J))}}function d(J){return async ee=>{await(0,r.AI)().delete(`/api/admin/users/${J}`),u.Ny.push("/admin/users")}}function E(J,ee){return async q=>{const ne={isGrafanaAdmin:ee};await(0,r.AI)().put(`/api/admin/users/${J}/permissions`,ne),q(c(J))}}function b(J){return async ee=>{const q=await(0,r.AI)().get(`/api/users/${J}/orgs`);ee((0,p.OF)(q))}}function D(J,ee,q){return async ne=>{const se={loginOrEmail:J.login,role:q};await(0,r.AI)().post(`/api/orgs/${ee}/users/`,se),ne(c(J.uid))}}function C(J,ee,q){return async ne=>{const se={role:q};await(0,r.AI)().patch(`/api/orgs/${ee}/users/${J}`,se),ne(c(J))}}function P(J,ee){return async q=>{await(0,r.AI)().delete(`/api/orgs/${ee}/users/${J}`),q(c(J))}}function M(J){return async ee=>{if(!l.TP.hasPermission(f.w.UsersAuthTokenList))return;const q=await(0,r.AI)().get(`/api/admin/users/${J}/auth-tokens`);q.reverse();const ne=q.map(se=>({id:se.id,isActive:se.isActive,seenAt:(0,s.fq)(se.seenAt),createdAt:se.createdAt,clientIp:se.clientIp,browser:se.browser,browserVersion:se.browserVersion,authModule:se.authModule,os:se.os,osVersion:se.osVersion,device:se.device}));ee((0,p.ag)(ne))}}function O(J,ee){return async q=>{const ne={authTokenId:J};await(0,r.AI)().post(`/api/admin/users/${ee}/revoke-auth-token`,ne),q(M(ee))}}function j(J){return async ee=>{await(0,r.AI)().post(`/api/admin/users/${J}/logout`),ee(M(J))}}function U(){return async J=>{const ee=l.TP.hasPermission(f.w.LDAPStatusRead);if((0,i.a)("ldapsync")&&ee){const q=await(0,r.AI)().get("/api/admin/ldap-sync-status");J((0,p.OR)(q))}}}function W(J,ee){return async q=>{await(0,r.AI)().post(`/api/admin/ldap/sync/${J}`),q(c(ee))}}function B(){return async J=>{if(l.TP.hasPermission(f.w.LDAPStatusRead))try{const ee=await(0,r.AI)().get("/api/admin/ldap/status");J((0,p.pH)(ee))}catch(ee){if((0,r.NF)(ee)){ee.isHandled=!0;const q={title:ee.data.message,body:ee.data.error};J((0,p.V$)(q))}}}}function S(J){return async ee=>{try{const q=await(0,r.AI)().get(`/api/admin/ldap/${encodeURIComponent(J)}`),{name:ne,surname:se,email:oe,login:de,isGrafanaAdmin:fe,isDisabled:ae,roles:ce,teams:ie}=q,ve={info:{name:ne,surname:se,email:oe,login:de},permissions:{isGrafanaAdmin:fe,isDisabled:ae},roles:ce,teams:ie};ee((0,p.TW)(ve))}catch(q){if((0,r.NF)(q)){q.isHandled=!0;const ne={title:q.data.message,body:q.data.error};ee((0,p.Vv)()),ee((0,p.Nf)(ne))}}}}function _(){return J=>{J((0,p.zi)())}}function K(){return J=>{J((0,p.zi)()),J((0,p.Vv)())}}const T=J=>J.map(ee=>Array.isArray(ee.value)?ee.value.map(q=>`${ee.name}=${q.value}`).join("&"):`${ee.name}=${ee.value}`).join("&");function L(){return async(J,ee)=>{try{const{perPage:q,page:ne,query:se,filters:oe,sort:de}=ee().userListAdmin;let fe=`/api/users/search?perpage=${q}&page=${ne}&query=${se}&${T(oe)}`;de&&(fe+=`&sort=${de}`);const ae=await(0,r.AI)().get(fe);J((0,p.Mb)(ae))}catch(q){(0,p.g4)(),console.error(q)}}}const A=(0,n.debounce)(J=>J(L()),500);function N(J){return async ee=>{ee((0,p.Cj)()),ee((0,p.L5)(J)),A(ee)}}function V(J){return async ee=>{ee((0,p.Cj)()),ee((0,p.jX)(J)),A(ee)}}function z(J){return async ee=>{ee((0,p.Cj)()),ee((0,p.EC)(J)),ee(L())}}function w({sortBy:J}){const ee=J.length?`${J[0].id}-${J[0].desc?"desc":"asc"}`:void 0;return async(q,ne)=>{ne().userListAdmin.sort!==ee&&(q((0,p.Cj)()),q((0,p.$u)(ee)),q(L()))}}const H=J=>J.map(ee=>Array.isArray(ee.value)?ee.value.map(q=>`${ee.name}=${q.value}`).join("&"):`${ee.name}=${ee.value}`).join("&");function Q(){return async(J,ee)=>{try{const{perPage:q,page:ne,query:se,filters:oe,sort:de}=ee().userListAnonymousDevices;let fe=`/api/anonymous/search?perpage=${q}&page=${ne}&query=${se}&${H(oe)}`;de&&(fe+=`&sort=${de}`);const ae=await(0,r.AI)().get(fe);J((0,p.o3)(ae))}catch(q){console.error(q)}}}const Z=(0,n.debounce)(J=>J(Q()),500);function Y({sortBy:J}){const ee=J.length?`${J[0].id}-${J[0].desc?"desc":"asc"}`:void 0;return async(q,ne)=>{ne().userListAnonymousDevices.sort!==ee&&(q((0,p.kh)(ee)),q(Q()))}}function X(J){return async ee=>{ee((0,p.xx)(J)),Z(ee)}}function I(J){return async ee=>{ee((0,p.iK)(J)),ee(Q())}}},52695:(te,R,e)=>{"use strict";e.d(R,{$u:()=>W,Ay:()=>V,Cj:()=>P,D1:()=>h,EC:()=>j,G_:()=>v,L5:()=>O,Mb:()=>C,Nf:()=>g,OF:()=>m,OR:()=>l,PV:()=>d,TW:()=>f,V$:()=>o,Vv:()=>r,ag:()=>y,g4:()=>M,iK:()=>L,jX:()=>U,kh:()=>T,o3:()=>K,pH:()=>u,xx:()=>A,zi:()=>i});var n=e(65307);const a={connectionInfo:[],syncInfo:void 0,user:void 0,connectionError:void 0,userError:void 0},s=(0,n.Z0)({name:"ldap",initialState:a,reducers:{ldapConnectionInfoLoadedAction:(z,w)=>({...z,ldapError:void 0,connectionInfo:w.payload}),ldapFailedAction:(z,w)=>({...z,ldapError:w.payload}),ldapSyncStatusLoadedAction:(z,w)=>({...z,syncInfo:w.payload}),userMappingInfoLoadedAction:(z,w)=>({...z,user:w.payload,userError:void 0}),userMappingInfoFailedAction:(z,w)=>({...z,user:void 0,userError:w.payload}),clearUserMappingInfoAction:(z,w)=>({...z,user:void 0}),clearUserErrorAction:(z,w)=>({...z,userError:void 0})}}),{clearUserErrorAction:i,clearUserMappingInfoAction:r,ldapConnectionInfoLoadedAction:u,ldapFailedAction:o,ldapSyncStatusLoadedAction:l,userMappingInfoFailedAction:g,userMappingInfoLoadedAction:f}=s.actions,p=s.reducer,c={user:void 0,sessions:[],orgs:[],isLoading:!0,error:void 0},x=(0,n.Z0)({name:"userAdmin",initialState:c,reducers:{userProfileLoadedAction:(z,w)=>({...z,user:w.payload}),userOrgsLoadedAction:(z,w)=>({...z,orgs:w.payload}),userSessionsLoadedAction:(z,w)=>({...z,sessions:w.payload}),userAdminPageLoadedAction:(z,w)=>({...z,isLoading:!w.payload}),userAdminPageFailedAction:(z,w)=>({...z,error:w.payload,isLoading:!1})}}),{userProfileLoadedAction:v,userOrgsLoadedAction:m,userSessionsLoadedAction:y,userAdminPageLoadedAction:h,userAdminPageFailedAction:d}=x.actions,E=x.reducer,b={users:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,filters:[{name:"activeLast30Days",value:!1}],isLoading:!0},D=(0,n.Z0)({name:"userListAdmin",initialState:b,reducers:{usersFetched:(z,w)=>{const{totalCount:H,perPage:Q,...Z}=w.payload,Y=Math.ceil(H/Q);return{...z,...Z,totalPages:Y,perPage:Q,showPaging:Y>1,isLoading:!1}},usersFetchBegin:z=>({...z,isLoading:!0}),usersFetchEnd:z=>({...z,isLoading:!1}),queryChanged:(z,w)=>({...z,query:w.payload,page:0}),pageChanged:(z,w)=>({...z,page:w.payload}),sortChanged:(z,w)=>({...z,page:0,sort:w.payload}),filterChanged:(z,w)=>{const{name:H,value:Q}=w.payload;return z.filters.some(Z=>Z.name===H)?{...z,page:0,filters:z.filters.map(Z=>Z.name===H?{...Z,value:Q}:Z)}:{...z,page:0,filters:[...z.filters,w.payload]}}}}),{usersFetched:C,usersFetchBegin:P,usersFetchEnd:M,queryChanged:O,pageChanged:j,filterChanged:U,sortChanged:W}=D.actions,B=D.reducer,S={devices:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,filters:[{name:"activeLast30Days",value:!0}]},_=(0,n.Z0)({name:"userListAnonymousDevices",initialState:S,reducers:{usersAnonymousDevicesFetched:(z,w)=>{const{totalCount:H,perPage:Q,...Z}=w.payload,Y=Math.ceil(H/Q);return{...z,...Z,totalPages:Y,perPage:Q,showPaging:Y>1}},anonQueryChanged:(z,w)=>({...z,query:w.payload,page:0}),anonPageChanged:(z,w)=>({...z,page:w.payload}),anonUserSortChanged:(z,w)=>({...z,page:0,sort:w.payload}),filterChanged:(z,w)=>{const{name:H,value:Q}=w.payload;return z.filters.some(Z=>Z.name===H)?{...z,page:0,filters:z.filters.map(Z=>Z.name===H?{...Z,value:Q}:Z)}:{...z,page:0,filters:[...z.filters,w.payload]}}}}),{usersAnonymousDevicesFetched:K,anonUserSortChanged:T,anonPageChanged:L,anonQueryChanged:A}=_.actions,N=_.reducer,V={ldap:p,userAdmin:E,userListAdmin:B,userListAnonymousDevices:N}},2954:(te,R,e)=>{"use strict";e.d(R,{A:()=>b,p:()=>l});var n=e(2543),a=e.n(n),s=e(92745),i=e(56355);const r=new i.tI({type:"query",params:[{name:"queryRefId",type:"string",dynamicLookup:!0},{name:"from",type:"string",options:["10s","1m","5m","10m","15m","1h","2h","6h","12h","24h","48h"]},{name:"to",type:"string",options:["now","now-1m","now-5m","now-10m","now-1h"]}],defaultParams:["#A","15m","now","avg"]}),u=[{text:"Query",value:"query"}],o={alerting:1,firing:1,no_data:2,pending:3,ok:4,paused:5,inactive:5};var l=(D=>(D.IsAbove="gt",D.IsBelow="lt",D.IsEqual="eq",D.IsNotEqual="ne",D.IsGreaterThanEqual="gte",D.IsLessThanEqual="lte",D.IsOutsideRange="outside_range",D.IsWithinRange="within_range",D.IsWithinRangeIncluded="within_range_included",D.IsOutsideRangeIncluded="outside_range_included",D.HasNoValue="no_value",D))(l||{});const g=[{value:"gt",text:"IS ABOVE"},{value:"lt",text:"IS BELOW"},{value:"eq",text:"IS EQUAL TO"},{value:"ne",text:"IS NOT EQUAL TO"},{value:"gte",text:"IS ABOVE OR EQUAL TO"},{value:"lte",text:"IS BELOW OR EQUAL TO"},{value:"outside_range",text:"IS OUTSIDE RANGE"},{value:"within_range",text:"IS WITHIN RANGE"},{value:"outside_range_included",text:"IS OUTSIDE RANGE INCLUDED"},{value:"within_range_included",text:"IS WITHIN RANGE INCLUDED"},{value:"no_value",text:"HAS NO VALUE"}],f=[{text:"OR",value:"or"},{text:"AND",value:"and"},{text:"LOGIC OR",value:"logic-or"}],p=[{text:"avg()",value:"avg"},{text:"min()",value:"min"},{text:"max()",value:"max"},{text:"sum()",value:"sum"},{text:"count()",value:"count"},{text:"last()",value:"last"},{text:"median()",value:"median"},{text:"diff()",value:"diff"},{text:"diff_abs()",value:"diff_abs"},{text:"percent_diff()",value:"percent_diff"},{text:"percent_diff_abs()",value:"percent_diff_abs"},{text:"count_non_null()",value:"count_non_null"}],c=[{text:"Alerting",value:"alerting"},{text:"No Data",value:"no_data"},{text:"Keep Last State",value:"keep_state"},{text:"Ok",value:"ok"}],x=[{text:"Alerting",value:"alerting"},{text:"Keep Last State",value:"keep_state"}];function v(D){const C=new i.tI({type:D.type,defaultParams:[]});return new i.kW(D,C)}function m(D){return D.toLowerCase().replace(/_/g,"").split(" ")[0]}function y(D){switch(m(D)){case"normal":case"ok":return{text:(0,s.t)("alerting.get-state-display-model.text.ok","OK"),iconClass:"heart",stateClass:"alert-state-ok"};case"alerting":return{text:(0,s.t)("alerting.get-state-display-model.text.alerting","ALERTING"),iconClass:"heart-break",stateClass:"alert-state-critical"};case"nodata":return{text:(0,s.t)("alerting.get-state-display-model.text.no-data","NO DATA"),iconClass:"question-circle",stateClass:"alert-state-warning"};case"paused":return{text:(0,s.t)("alerting.get-state-display-model.text.paused","PAUSED"),iconClass:"pause",stateClass:"alert-state-paused"};case"pending":return{text:(0,s.t)("alerting.get-state-display-model.text.pending","PENDING"),iconClass:"hourglass",stateClass:"alert-state-warning"};case"recovering":return{text:(0,s.t)("alerting.get-state-display-model.text.recovering","RECOVERING"),iconClass:"hourglass",stateClass:"alert-state-warning"};case"firing":return{text:(0,s.t)("alerting.get-state-display-model.text.firing","FIRING"),iconClass:"fire",stateClass:""};case"inactive":return{text:(0,s.t)("alerting.get-state-display-model.text.inactive","INACTIVE"),iconClass:"check",stateClass:""};case"error":return{text:(0,s.t)("alerting.get-state-display-model.text.error","ERROR"),iconClass:"heart-break",stateClass:"alert-state-critical"};case"unknown":default:return{text:(0,s.t)("alerting.get-state-display-model.text.unknown","UNKNOWN"),iconClass:"question-circle",stateClass:".alert-state-paused"}}}function h(D,C){return(0,n.reduce)(D,(P,M)=>(M.metric!==void 0&&M.value!==void 0&&P.push(M.metric+"="+M.value),M.Metric!==void 0&&M.Value!==void 0&&P.push(M.Metric+"="+M.Value),P),[]).join(C)}function d(D){return(0,n.isArray)(D.data)?h(D.data,", "):(0,n.isArray)(D.data.evalMatches)?h(D.data.evalMatches,", "):D.data.error?"Error: "+D.data.error:""}function E(D){return(0,n.isArray)(D)?h(D,", "):(0,n.isArray)(D.evalMatches)?h(D.evalMatches,", "):D.error?"Error: "+D.error:""}const b={alertQueryDef:r,getStateDisplayModel:y,conditionTypes:u,evalFunctions:g,evalOperators:f,noDataModes:c,executionErrorModes:x,reducerTypes:p,createReducerPart:v,getAlertAnnotationInfo:d,getAlertAnnotationText:E,alertStateSortScore:o}},56355:(te,R,e)=>{"use strict";e.d(R,{Dw:()=>u,Wn:()=>r,kW:()=>i,tI:()=>s});var n=e(2543),a=e.n(n);class s{constructor(f){this.type=f.type,this.params=f.params,this.defaultParams=f.defaultParams,this.renderer=f.renderer,this.category=f.category,this.addStrategy=f.addStrategy}}class i{constructor(f,p){if(this.part=f,this.def=p,!this.def)throw{message:"Could not find query part "+f.type};f.params=f.params||(0,n.clone)(this.def.defaultParams),this.params=f.params,this.text="",this.updateText()}render(f){return this.def.renderer(this,f)}hasMultipleParamsInString(f,p){return f.indexOf(",")===-1?!1:this.def.params[p+1]&&this.def.params[p+1].optional}updateParam(f,p){if(this.hasMultipleParamsInString(f,p)){(0,n.each)(f.split(","),(c,x)=>{this.updateParam(c.trim(),x)});return}f===""&&this.def.params[p].optional?this.params.splice(p,1):this.params[p]=f,this.part.params=this.params,this.updateText()}updateText(){if(this.params.length===0){this.text=this.def.type+"()";return}let f=this.def.type+"(";f+=this.params.join(", "),f+=")",this.text=f}}function r(g,f){const p=g.def.type+"(",c=(0,n.map)(g.params,(x,v)=>{const m=g.def.params[v];return m.type==="time"&&x==="auto"&&(x="$__interval"),m.quote==="single"?"'"+x+"'":m.quote==="double"?'"'+x+'"':x});return f&&c.unshift(f),p+c.join(", ")+")"}function u(g,f){return f+" "+g.params[0]}function o(g,f){return g.params[0]}function l(g,f){return'"'+g.params[0]+'"'}},74268:(te,R,e)=>{"use strict";e.d(R,{AK:()=>j,Cl:()=>Q,D0:()=>I,D_:()=>ne,Ey:()=>S,FF:()=>c,Gn:()=>P,Hs:()=>X,IR:()=>C,KF:()=>m,Ke:()=>h,Ks:()=>J,P6:()=>Z,Pq:()=>_,QA:()=>ee,Rh:()=>U,Rk:()=>D,Sn:()=>V,Sq:()=>E,Tc:()=>T,U6:()=>w,U7:()=>v,XW:()=>B,Yk:()=>O,Zc:()=>q,a5:()=>se,aL:()=>z,cg:()=>W,fH:()=>g,iF:()=>K,iW:()=>Y,l$:()=>p,le:()=>l,nf:()=>b,t6:()=>H,vO:()=>M,vV:()=>f,xd:()=>x,zs:()=>A});var n=e(2543),a=e.n(n),s=e(25992),i=e(43173),r=e(27489),u=e(73427),o=e(56369);const l={filterByLabel:"filtering alert instances by label",loadedList:"loaded Alert Rules list",leavingRuleGroupEdit:"leaving rule group edit without saving",alertRuleFromPanel:"creating alert rule from panel",alertRuleFromScratch:"creating alert rule from scratch",recordingRuleFromScratch:"creating recording rule from scratch",clickingAlertStateFilters:"clicking alert state filters",cancelSavingAlertRule:"user canceled alert rule creation",successSavingAlertRule:"alert rule saved successfully",unknownMessageFromError:"unknown messageFromError",grafanaRecording:"creating Grafana recording rule from scratch",loadedCentralAlertStateHistory:"loaded central alert state history",exportNewGrafanaRule:"exporting new Grafana rule",noAlertRuleVersionsFound:"no alert rule versions found"},{logInfo:g,logError:f,logMeasurement:p,logWarning:c}=(0,s.DW)("features.alerting",{module:"Alerting"});function x(oe,de,fe={}){return async function(...ae){const ce=`${de}:start`;performance.mark(ce);const ie=await oe(...ae),ve=performance.measure(de,ce);return p(de,{duration:ve.duration,loadTimesMs:ve.duration},fe),ie}}function v(oe,de,fe){return async(...ae)=>{const ce=performance.now(),ie=await de(...ae),{namespacesCount:ve,groupsCount:le,rulesCount:Ee}=y(ie);return p(oe,{loadTimeMs:performance.now()-ce,namespacesCount:ve,groupsCount:le,rulesCount:Ee},fe),ie}}function m(oe){Object.entries(oe).forEach(([de,fe])=>{const ae=fe.message??"unknown error",ce=String(fe.type)??"unknown",ie=new Error(ae);f(ie,{field:de,type:ce})})}function y(oe){const de=oe.length,fe=oe.flatMap(ie=>ie.groups).length,ae=oe.flatMap(ie=>ie.groups).flatMap(ie=>ie.rules).length;return{namespacesCount:de,groupsCount:fe,rulesCount:ae}}function h(oe,de,fe){return async(...ae)=>{const ce=performance.now(),ie=await de(...ae),{namespacesCount:ve,groupsCount:le,rulesCount:Ee}=d(ie);return p(oe,{namespacesCount:ve,groupsCount:le,rulesCount:Ee,loadTimeMs:performance.now()-ce},fe),ie}}function d(oe){const de=Object.keys(oe),fe=Object.values(oe).flatMap(ce=>ce),ae=fe.flatMap(ce=>ce.rules);return{namespacesCount:de.length,groupsCount:fe.length,rulesCount:ae.length}}const E=async(oe={grafana_version:i.$.buildInfo.version,org_id:u.TP.user.orgId,user_id:u.TP.user.id})=>{(0,r.rR)("grafana_alerting_navigation",oe)},b=oe=>{(0,r.rR)("grafana_alerting_rule_creation",oe)},D=oe=>{(0,r.rR)("grafana_alerting_rule_aborted",oe)},C=oe=>{(0,r.rR)("grafana_alerting_rule_form_error",oe)},P=oe=>{(0,r.rR)("grafana_alerting_grafana_rule_creation_new_success",oe)},M=()=>{(0,r.rR)("grafana_alerting_grafana_rule_creation_new_aborted")},O=()=>{(0,r.rR)("grafana_alerting_grafana_rule_creation_new_error")},j=async oe=>{const de={grafana_version:i.$.buildInfo.version,org_id:u.TP.user.orgId,user_id:u.TP.user.id};(0,r.rR)("grafana_alerting_insights",{...de,...oe})},U=async oe=>{(0,r.rR)("grafana_alerting_rule_versions_comparison_click",{...oe})},W=async oe=>{(0,r.rR)("grafana_alerting_rule_versions_restore_success",{...oe})},B=async oe=>{(0,r.rR)("grafana_alerting_rule_versions_restore_error",{...oe})},S=async()=>{(0,r.rR)("grafana_alerting_deleted_rule_restore_success")},_=async()=>{(0,r.rR)("grafana_alerting_deleted_rule_restore_error")},K=async oe=>{(0,r.rR)("grafana_alerting_import_to_gma_success",{...oe})},T=async oe=>{(0,r.rR)("grafana_alerting_import_to_gma_error",{...oe})};function L(oe){(0,r.rR)("grafana_alerting_rules_search",{...oe})}function A({oldQuery:oe,newQuery:de}){try{const fe=(0,o.XY)(oe),ae=(0,o.XY)(de),ce=N(fe);N(ae).filter(le=>!ce.includes(le)).forEach(le=>{L({filter:le,triggeredBy:"typing"})})}catch(fe){fe instanceof Error&&f(fe)}}function N(oe){return Object.entries(oe).filter(([de,fe])=>!(0,n.isEmpty)(fe)).map(([de])=>de)}function V(oe){L({filter:oe,triggeredBy:"component"})}function z(oe){(0,r.rR)("grafana_alerting_rules_list_mode",{...oe})}function w(){(0,r.rR)("grafana_alerting_contact_point_form_edit_input_with_template")}function H(){(0,r.rR)("grafana_alerting_contact_point_form_use_custom_input_in_template")}function Q(){(0,r.rR)("grafana_alerting_contact_point_form_use_single_template_in_input")}function Z(oe){(0,r.rR)("grafana_alerting_central_alert_state_history_filter_by_clicking",oe)}function Y(){(0,r.rR)("grafana_alerting_central_alert_state_history_expand_row")}function X(oe){(0,r.rR)("grafana_alerting_central_alert_state_history_max_events_reached",oe)}function I(){(0,r.rR)("grafana_alerting_folder_bulk_actions_delete_success")}function J(){(0,r.rR)("grafana_alerting_folder_bulk_actions_delete_fail")}function ee(){(0,r.rR)("grafana_alerting_folder_bulk_actions_pause_success")}function q(){(0,r.rR)("grafana_alerting_folder_bulk_actions_unpause_success")}function ne(){(0,r.rR)("grafana_alerting_folder_bulk_actions_pause_fail")}function se(){(0,r.rR)("grafana_alerting_folder_bulk_actions_unpause_fail")}},28390:(te,R,e)=>{"use strict";e.r(R),e.d(R,{default:()=>d,defaultPageNav:()=>y});var n=e(74848),a=e(96540),s=e(54148),i=e(92745),r=e(68143),u=e(34999),o=e(1506),l=e(36826),g=e(54552),f=e(22973),p=e(44109),c=e(77256),x=e(94646),v=e(88547);const m=()=>{const E=(0,s.g)(),b=(0,x.uE)(E),[D]=(0,f.P5)(),P=D===f.gQ.Instances?void 0:0,M=(0,a.useMemo)(()=>{if(!b)throw new Error("Rule ID is required");return(0,x.qg)(b,!0)},[b]),{loading:O,error:j,result:U}=(0,p.ZU)({ruleIdentifier:M,limitAlerts:P});return j?(0,n.jsx)(l.d,{pageNav:y,navId:"alert-list",children:(0,n.jsx)(h,{error:j})}):O?(0,n.jsx)(l.d,{pageNav:y,navId:"alert-list",isLoading:!0}):U?(0,n.jsx)(g.K,{identifier:M,rule:U,children:(0,n.jsx)(f.Ay,{})}):!U&&!O?(0,n.jsx)(l.d,{pageNav:y,navId:"alert-list",children:(0,n.jsx)(o.L,{entity:"Rule"})}):null},y={id:"alert-rule-view",text:""};function h({error:E}){return(0,r.NF)(E)&&E.status===404?(0,n.jsx)(o.L,{entity:"Rule"}):(0,n.jsx)(u.F,{title:(0,i.t)("alerting.rule-viewer.error-loading","Something went wrong loading the rule"),children:(0,c.JZ)(E)})}const d=(0,v.S)(m)},70327:(te,R,e)=>{"use strict";e.d(R,{hK:()=>c});var n=e(92745),a=e(52161),s=e(39659),i=e(29609),r=e(5709),u=e(55143),o=e(78467),l=e(77295);const g="/api/v1/rule/test/grafana",f="api/prometheus/grafana/api/v1/rules";var p=(x=>(x.RuleName="rule_name",x.RuleNameVanilla="rule_name[]",x.RuleGroup="rule_group",x.RuleGroupVanilla="rule_group[]",x.Namespace="file",x.NamespaceVanilla="file[]",x.FolderUID="folder_uid",x.LimitAlerts="limit_alerts",x.MaxGroups="max_groups",x.ExcludeAlerts="exclude_alerts",x))(p||{});const c=r.H.injectEndpoints({endpoints:x=>({preview:x.mutation({query:({alertQueries:v,condition:m,customLabels:y,folder:h,alertName:d,alertUid:E})=>({url:g,data:{rule:{grafana_alert:{data:v,condition:m,no_data_state:"Alerting",title:d,uid:E??"N/A"},for:"0s",labels:(0,s.x4)(y),annotations:{}},folderUid:h.uid,folderTitle:h.title},method:"POST"})}),prometheusRulesByNamespace:x.query({query:({limitAlerts:v,identifier:m,filter:y,state:h,matcher:d})=>{const E=new URLSearchParams;v&&E.set("limit_alerts",String(v)),m&&((0,i.Mj)(m)||(0,i.X4)(m))&&(E.set("file",m.namespace),E.set("file[]",m.namespace),E.set("rule_group",m.groupName),E.set("rule_group[]",m.groupName));const D={...(0,o.ou)(y),...Object.fromEntries(E)};return{url:f,params:(0,o.Dj)(D,h,d)}},transformResponse:v=>(0,o.lH)(v.data.groups,a.hY)}),prometheusRuleNamespaces:x.query({query:({ruleSourceName:v,namespace:m,groupName:y,ruleName:h,dashboardUid:d,panelId:E,limitAlerts:b,maxGroups:D,excludeAlerts:C})=>{const P={rule_group:y,rule_name:h,dashboard_uid:d,panel_id:E?.toString()};return m&&((0,a.z2)(v)?P.folder_uid=m:(P.file=m,P["file[]"]=m)),b!==void 0&&(P.limit_alerts="limit_alerts"),D&&(P.max_groups=String(D)),C&&(P.exclude_alerts="true"),{url:`api/prometheus/${(0,a.w5)(v)}/api/v1/rules`,params:P}},transformResponse:(v,m,y)=>(0,o.lH)(v.data.groups,y.ruleSourceName),providesTags:["CombinedAlertRule"]}),rulerRules:x.query({query:({rulerConfig:v,filter:m})=>{const{path:y,params:h}=(0,l.$o)(v).rules(m);return{url:y,params:h}},providesTags:["CombinedAlertRule"]}),rulerNamespace:x.query({query:({rulerConfig:v,namespace:m})=>{const{path:y,params:h}=(0,l.$o)(v).namespace(m);return{url:y,params:h}},providesTags:(v,m,{namespace:y})=>[{type:"RuleNamespace",id:y}]}),getRuleGroupForNamespace:x.query({query:({rulerConfig:v,namespace:m,group:y,notificationOptions:h})=>{const{path:d,params:E}=(0,l.$o)(v).namespaceGroup(m,y);return{url:d,params:E,notificationOptions:h}},providesTags:(v,m,{namespace:y,group:h,rulerConfig:d})=>[{type:"RuleGroup",id:`${d.dataSourceUid}/${y}/${h}`},{type:"RuleNamespace",id:`${d.dataSourceUid}/${y}`}]}),getGrafanaRulerGroup:x.query({query:({folderUid:v,groupName:m})=>{const{path:y,params:h}=(0,l.$o)(u.b).namespaceGroup(v,m);return{url:y,params:h}},providesTags:(v,m,{folderUid:y,groupName:h})=>[{type:"RuleGroup",id:`grafana/${y}/${h}`},{type:"RuleNamespace",id:`grafana/${y}`}]}),deleteRuleGroupFromNamespace:x.mutation({query:({rulerConfig:v,namespace:m,group:y,notificationOptions:h})=>{const d=(0,n.t)("alerting.rule-groups.delete.success","Successfully deleted rule group"),{path:E,params:b}=(0,l.$o)(v).namespaceGroup(m,y);return{url:E,params:b,method:"DELETE",notificationOptions:{successMessage:d,...h}}},invalidatesTags:(v,m,{namespace:y,group:h,rulerConfig:d})=>[{type:"RuleGroup",id:`${d.dataSourceUid}/${y}/${h}`},{type:"RuleNamespace",id:`${d.dataSourceUid}/${y}`},"DeletedRules"]}),upsertRuleGroupForNamespace:x.mutation({query:({payload:v,namespace:m,rulerConfig:y,notificationOptions:h})=>{const{path:d,params:E}=(0,l.$o)(y).namespace(m),b=(0,n.t)("alerting.rule-groups.update.success","Successfully updated rule group");return{url:d,params:E,data:v,method:"POST",notificationOptions:{successMessage:b,...h}}},invalidatesTags:(v,m,{namespace:y,payload:h,rulerConfig:d})=>{const E=h.rules.filter(i.p.grafana.rule),b=[];return d.dataSourceUid===a.hY&&b.push({type:"GrafanaPrometheusGroups",id:`grafana/${y}/__any__/`},{type:"GrafanaPrometheusGroups",id:`grafana/${y}/${h.name}/__any__`},...E.map(D=>({type:"GrafanaPrometheusGroups",id:`grafana/${y}/${h.name}/${D.grafana_alert.title}`}))),[{type:"RuleNamespace",id:`${d.dataSourceUid}/${y}`},{type:"RuleGroup",id:`${d.dataSourceUid}/${y}/${h.name}`},...E.flatMap(D=>[{type:"GrafanaRulerRule",id:D.grafana_alert.uid},{type:"GrafanaRulerRuleVersion",id:D.grafana_alert.uid}]),...b,"DeletedRules"]}}),getAlertRule:x.query({query:({uid:v})=>({url:`/api/ruler/${a.hY}/api/v1/rule/${v}`}),providesTags:(v,m,{uid:y})=>[{type:"GrafanaRulerRule",id:y}]}),getAlertVersionHistory:x.query({query:({uid:v})=>({url:`/api/ruler/${a.hY}/api/v1/rule/${v}/versions`}),providesTags:(v,m,{uid:y})=>[{type:"GrafanaRulerRuleVersion",id:y}]}),exportRules:x.query({query:({format:v,folderUid:m,group:y,ruleUid:h})=>({url:"/api/ruler/grafana/api/v1/export/rules",params:{format:v,folderUid:m,group:y,ruleUid:h},responseType:"text"}),keepUnusedDataFor:0}),exportReceiver:x.query({query:({receiverName:v,decrypt:m,format:y})=>({url:"/api/v1/provisioning/contact-points/export/",params:{format:y,decrypt:m,name:v},responseType:"text"}),keepUnusedDataFor:0}),exportReceivers:x.query({query:({decrypt:v,format:m})=>({url:"/api/v1/provisioning/contact-points/export/",params:{format:m,decrypt:v},responseType:"text"}),keepUnusedDataFor:0}),exportPolicies:x.query({query:({format:v})=>({url:"/api/v1/provisioning/policies/export/",params:{format:v},responseType:"text"}),keepUnusedDataFor:0}),exportModifiedRuleGroup:x.mutation({query:({payload:v,format:m,nameSpaceUID:y})=>({url:`/api/ruler/grafana/api/v1/rules/${y}/export/`,params:{format:m},responseType:"text",data:v,method:"POST"})}),exportMuteTimings:x.query({query:({format:v})=>({url:"/api/v1/provisioning/mute-timings/export/",params:{format:v},responseType:"text"}),keepUnusedDataFor:0}),exportMuteTiming:x.query({query:({format:v,muteTiming:m})=>({url:`/api/v1/provisioning/mute-timings/${m}/export/`,params:{format:v},responseType:"text"}),keepUnusedDataFor:0}),getDeletedRules:x.query({query:()=>({url:`/api/ruler/${a.hY}/api/v1/rules/`,params:{deleted:"true"}}),transformResponse:v=>{const m=Object.values(v);return m.length>0?m[0][0]?.rules:[]},providesTags:["DeletedRules"]}),permanentlyDeleteRule:x.mutation({query:({guid:v})=>({url:`/api/ruler/${a.hY}/api/v1/trash/rule/guid/${v}`,method:"DELETE"}),invalidatesTags:["DeletedRules"]})})})},62421:(te,R,e)=>{"use strict";e.d(R,{F:()=>i});var n=e(32899),a=e(45229),s=e(5709);const i=s.H.injectEndpoints({endpoints:r=>({getSilences:r.query({query:({datasourceUid:u,ruleMetadata:o,accessControl:l})=>({url:`/api/alertmanager/${u}/api/v2/silences`,params:{ruleMetadata:o,accesscontrol:l}}),providesTags:u=>u?[...u.map(({id:o})=>({type:"AlertmanagerSilences",id:o})),{type:"AlertmanagerSilences"}]:[{type:"AlertmanagerSilences"}]}),getSilence:r.query({query:({datasourceUid:u,id:o,ruleMetadata:l,accessControl:g})=>({url:`/api/alertmanager/${u}/api/v2/silence/${o}`,showErrorAlert:!1,params:{ruleMetadata:l,accesscontrol:g}}),providesTags:(u,o,{id:l})=>u?[{type:"AlertmanagerSilences",id:l}]:["AlertmanagerSilences"]}),createSilence:r.mutation({query:({datasourceUid:u,payload:o})=>({url:`/api/alertmanager/${u}/api/v2/silences`,method:"POST",data:o}),invalidatesTags:["AlertmanagerSilences","AlertmanagerAlerts"],onQueryStarted:async(u,{queryFulfilled:o})=>{try{await o,a.A.emit(n.r1.alertSuccess,["Silence created"])}catch{a.A.emit(n.r1.alertError,["Could not create silence"])}}}),expireSilence:r.mutation({query:({datasourceUid:u,silenceId:o})=>({url:`/api/alertmanager/${u}/api/v2/silence/${o}`,method:"DELETE"}),invalidatesTags:["AlertmanagerSilences"]})})})},5709:(te,R,e)=>{"use strict";e.d(R,{H:()=>p});var n=e(75816),a=e(10378),s=e(2543),i=e.n(s),r=e(75505),u=e(32899),o=e(68143),l=e(45229),g=e(74268);const f=()=>async({body:c,notificationOptions:x={},...v},m,y)=>{const{errorMessage:h,showErrorAlert:d,successMessage:E,showSuccessAlert:b}=x,{hideErrorMessage:D}=y||{};try{const C={...v,...c&&{data:c},...(0,s.isBoolean)(b)&&{showSuccessAlert:b},...(0,s.isBoolean)(d)&&{showErrorAlert:d},...E&&{showSuccessAlert:!1},...(h||D)&&{showErrorAlert:!1}},P=performance.now(),{data:M,...O}=await(0,r.s)((0,o.AI)().fetch(C));return(0,g.l$)("backendSrvBaseQuery",{loadTimeMs:performance.now()-P},{url:v.url,method:v.method??"GET",responseStatus:O.statusText}),E&&b!==!1&&l.A.emit(u.r1.alertSuccess,[E]),{data:M,meta:O}}catch(C){return h&&d!==!1&&l.A.emit(u.r1.alertError,[h]),{error:C}}},p=(0,n.xP)({reducerPath:"alertingApi",baseQuery:f(),serializeQueryArgs:c=>(0,a.lE)((0,s.omit)(c,"queryArgs.notificationOptions")),tagTypes:["AlertingConfiguration","AlertmanagerConfiguration","AlertmanagerConnectionStatus","AlertmanagerAlerts","AlertmanagerSilences","OnCallIntegrations","DataSourceSettings","GrafanaLabels","CombinedAlertRule","GrafanaRulerRule","GrafanaRulerRuleVersion","GrafanaSlo","RuleGroup","RuleNamespace","ContactPoint","ContactPointsStatus","Receiver","DeletedRules","GrafanaPrometheusGroups"],endpoints:()=>({})})},47938:(te,R,e)=>{"use strict";e.d(R,{By:()=>f,VO:()=>g,WS:()=>r,f4:()=>l,nd:()=>o,vk:()=>u});var n=e(75505),a=e(28105),s=e(68143),i=e(52161);async function r(m){try{const y=await(0,n.s)((0,s.AI)().fetch({url:`/api/alertmanager/${(0,i.w5)(m)}/config/api/v1/alerts`,showErrorAlert:!1,showSuccessAlert:!1}));return{template_files:y.data.template_files??{},template_file_provenances:y.data.template_file_provenances??{},alertmanager_config:y.data.alertmanager_config??{},last_applied:y.data.last_applied,id:y.data.id}}catch(y){if(m===i.hY&&(0,s.NF)(y)&&y.data?.message?.includes("could not find an Alertmanager configuration"))return{template_files:{},alertmanager_config:{}};throw y}}async function u(m,y){await(0,n.s)((0,s.AI)().fetch({method:"POST",url:`/api/alertmanager/${(0,i.w5)(m)}/config/api/v1/alerts`,data:y,showErrorAlert:!1,showSuccessAlert:!1}))}async function o(m){await(0,n.s)((0,s.AI)().fetch({method:"DELETE",url:`/api/alertmanager/${(0,i.w5)(m)}/config/api/v1/alerts`,showErrorAlert:!1,showSuccessAlert:!1}))}async function l(m){return(await(0,n.s)((0,s.AI)().fetch({url:`/api/alertmanager/${(0,i.w5)(m)}/api/v2/alerts/groups`,showErrorAlert:!1,showSuccessAlert:!1}))).data}async function g(m){return(await(0,n.s)((0,s.AI)().fetch({url:`/api/alertmanager/${(0,i.w5)(m)}/api/v2/status`,showErrorAlert:!1,showSuccessAlert:!1}))).data}async function f(m,y,h){const d={receivers:y,alert:h};try{const E=await(0,n.s)((0,s.AI)().fetch({method:"POST",data:d,url:`/api/alertmanager/${(0,i.w5)(m)}/config/api/v1/receivers/test`,showErrorAlert:!1,showSuccessAlert:!1}));if(p(E.data))throw new Error(v(E.data))}catch(E){throw(0,s.NF)(E)&&c(E.data)&&p(E.data)?new Error(v(E.data)):E}}function p(m){return m.receivers.some(y=>y.grafana_managed_receiver_configs.some(h=>h.status==="failed"))}function c(m){return(0,a.Gv)(m)&&"receivers"in m&&Array.isArray(m.receivers)?m.receivers.every(x):!1}function x(m){return(0,a.Gv)(m)&&"name"in m&&typeof m.name=="string"&&"grafana_managed_receiver_configs"in m&&Array.isArray(m.grafana_managed_receiver_configs)}function v(m){return m.receivers.flatMap(y=>y.grafana_managed_receiver_configs.filter(h=>h.status==="failed").map(h=>h.error??"Unknown error.")).join("; ")}},91984:(te,R,e)=>{"use strict";e.d(R,{m:()=>y});var n=e(2543),a=e.n(n),s=e(63895),i=e(8535),r=e(74268),u=e(86017),o=e(52161),l=e(77256),g=e(36200),f=e(5709),p=e(47938),c=e(55143);const x=30,v=30*1e3,m=["AlertingConfiguration","AlertmanagerConfiguration","AlertmanagerConnectionStatus","ContactPoint","ContactPointsStatus","Receiver"],y=f.H.injectEndpoints({endpoints:h=>({getAlertmanagerAlerts:h.query({query:({amSourceName:d,filter:E,showErrorAlert:b=!0})=>{const D=E?.matchers?.filter(W=>W.name&&W.value).map(W=>(0,s.b2)((0,u.MU)(W))),{silenced:C,inhibited:P,unprocessed:M,active:O}=E||{},j=Object.fromEntries(Object.entries({silenced:C,active:O,inhibited:P,unprocessed:M}).filter(([W,B])=>B!==void 0)),U={filter:D};return j&&Object.keys(j).forEach(W=>{U[W]=j[W]}),{url:`/api/alertmanager/${(0,o.w5)(d)}/api/v2/alerts`,params:U,showErrorAlert:b}},providesTags:["AlertmanagerAlerts"]}),getAlertmanagerAlertGroups:h.query({query:({amSourceName:d})=>({url:`/api/alertmanager/${(0,o.w5)(d)}/api/v2/alerts/groups`})}),grafanaNotifiers:h.query({query:()=>({url:"/api/alert-notifiers"}),transformResponse:d=>{const E=(b,D)=>({...b,secureFieldKey:b.secure&&!b.secureFieldKey?`${D}${b.propertyName}`:void 0,subformOptions:b.subformOptions?.map(C=>E(C,`${D}${b.propertyName}.`))});return d.map(b=>({...b,options:b.options.map(D=>E(D,""))}))}}),getGrafanaAlertingConfiguration:h.query({query:()=>({url:"/api/v1/ngalert/admin_config",showErrorAlert:!1}),providesTags:["AlertingConfiguration"]}),getGrafanaAlertingConfigurationStatus:h.query({query:()=>({url:"/api/v1/ngalert"}),providesTags:["AlertingConfiguration"]}),getExternalAlertmanagers:h.query({query:()=>({url:"/api/v1/ngalert/alertmanagers"}),transformResponse:d=>d.data,providesTags:["AlertmanagerConnectionStatus"]}),updateGrafanaAlertingConfiguration:h.mutation({query:d=>({url:"/api/v1/ngalert/admin_config",method:"POST",data:d,showSuccessAlert:!1}),invalidatesTags:[...m]}),getAlertmanagerConfigurationHistory:h.query({query:()=>({url:`/api/alertmanager/${(0,o.w5)(o.hY)}/config/history`,params:{limit:x}}),providesTags:["AlertmanagerConfiguration"]}),resetAlertmanagerConfigurationToOldVersion:h.mutation({query:d=>({url:`/api/alertmanager/${(0,o.w5)(o.hY)}/config/history/${d.id}/_activate`,method:"POST"}),invalidatesTags:["AlertmanagerConfiguration"]}),getAlertmanagerConfiguration:h.query({queryFn:async d=>{const E=d===o.hY;if((0,o.AL)(d))return(0,g.$I)((0,p.VO)(d).then(j=>({data:{alertmanager_config:j.config,template_files:{}}})));const{data:D}=await(0,i.JD)(c.L.endpoints.discoverAmFeatures.initiate({amSourceName:d})),C={alertmanager_config:{},template_files:{},template_file_provenances:{}},P=D?.lazyConfigInit??!1,M=(0,r.xd)(p.WS,"unifiedalerting/fetchAmConfig",{dataSourceName:d,thunk:"unifiedalerting/fetchAmConfig"}),O=(0,l.i9)(()=>M(d),j=>!!(0,g.CZ)(j)?.includes("alertmanager storage object not found")&&!P,v).then(j=>E?j:(0,n.isEmpty)(j.alertmanager_config)&&(0,n.isEmpty)(j.template_files)?(0,p.VO)(d).then(W=>({alertmanager_config:W.config,template_files:{},template_file_provenances:j.template_file_provenances,last_applied:j.last_applied,id:j.id})):j).then(j=>j??C).then(j=>({data:j})).catch(j=>{if(P&&(0,g.CZ)(j)?.includes("alertmanager storage object not found"))return{data:C};throw j});return(0,g.$I)(O).catch(j=>({error:j,data:void 0}))},providesTags:["AlertmanagerConfiguration"]}),updateAlertmanagerConfiguration:h.mutation({query:({selectedAlertmanager:d,config:E})=>({url:`/api/alertmanager/${(0,o.w5)(d)}/config/api/v1/alerts`,method:"POST",data:E,showSuccessAlert:!1}),invalidatesTags:["AlertmanagerConfiguration","ContactPoint","ContactPointsStatus","Receiver"]}),getContactPointsStatus:h.query({query:()=>({url:`/api/alertmanager/${(0,o.w5)(o.hY)}/config/api/v1/receivers`}),transformResponse:d=>{const E=b=>b.startsWith("0001-01-01");return d.map(b=>({...b,integrations:b.integrations.map(D=>{const C=E(D.lastNotifyAttempt);return{...D,lastNotifyAttempt:C?"":D.lastNotifyAttempt,lastNotifyAttemptDuration:C?"":D.lastNotifyAttemptDuration}})}))},providesTags:["ContactPointsStatus"]})})})},1895:(te,R,e)=>{"use strict";e.d(R,{O5:()=>p,_y:()=>f,cc:()=>l});var n=e(75505),a=e(68143),s=e(24619),i=e(95443),r=e(52161),u=e(78467),o=e(77295);async function l(h){if(h===r.hY)return{application:"grafana",features:{rulerApiEnabled:!0}};const d=(0,r.of)(h);if(!d)throw new Error(`Cannot find data source configuration for ${h}`);const{url:E,name:b,type:D}=d;if(!E)throw new Error("The data source url cannot be empty.");if(!(0,r.cl)(D))throw new Error(`The build info request is not available for ${D}. Supported values are ${r.at.join()}.`);return g({name:b,url:E,type:D})}async function g(h){const{url:d,name:E,type:b}=h,D=b==="loki"?void 0:await x(d);if(!(D!==void 0)){if(!await v(E))throw new Error(`Unable to fetch alert rules. Is the ${E} data source properly configured?`);const O=await m(E);return{application:b==="loki"?"Loki":s.N1.Cortex,features:{rulerApiEnabled:O}}}const{features:P}=D.data;return P?{application:s.N1.Mimir,features:{rulerApiEnabled:P?.ruler_config_api==="true"}}:{application:s.N1.Prometheus,features:{rulerApiEnabled:!1}}}async function f(h){if(h===r.hY)return{lazyConfigInit:!1};const d=c(h),{url:E,type:b}=d;if(!E)throw new Error("The data source url cannot be empty.");if(b!=="alertmanager")throw new Error(`Alertmanager feature discovery is not available for ${b}. Only 'alertmanager' type is supported`);return await p(E)}async function p(h){try{return{lazyConfigInit:(await x(h))?.data?.application==="Grafana Mimir"}}catch{return{lazyConfigInit:!1}}}function c(h){const d=(0,r.oh)(h);if(!d)throw new Error(`Cannot find data source configuration for ${h}`);return d}async function x(h){return(await(0,n.s)((0,a.AI)().fetch({url:`${h}/api/v1/status/buildinfo`,showErrorAlert:!1,showSuccessAlert:!1})).catch(E=>{if(!("status"in E&&E.status===404))throw E}))?.data}async function v(h){try{return await(0,u.sA)(h),!0}catch{return!1}}async function m(h){try{return await(0,o.Zp)(h),!0}catch(d){if(y(d))return!1;throw d}}function y(h){return(0,a.NF)(h)?h.data.message?.includes("GetRuleGroup unsupported in rule local store")||h.data.message?.includes("page not found")||h.data.message?.includes(i.UU):h instanceof Error&&h.message?.includes("404 from rules config endpoint")}},55143:(te,R,e)=>{"use strict";e.d(R,{L:()=>o,b:()=>u});var n=e(86791),a=e(24619),s=e(52161),i=e(5709),r=e(1895);const u={dataSourceName:"grafana",dataSourceUid:"grafana",apiVersion:"legacy"},o=i.H.injectEndpoints({endpoints:l=>({discoverAmFeatures:l.query({queryFn:async({amSourceName:g})=>{try{return{data:await(0,r._y)(g)}}catch(f){return{error:f}}}}),discoverDsFeatures:l.query({queryFn:async g=>{const f=(0,s.Iz)(g);if(!f)return{error:new Error(`Unable to find data source for ${JSON.stringify(g)}`)};if(f===n.l$)return{data:{name:s.hY,uid:s.hY,application:"grafana",rulerConfig:u}};const p=f?(0,s.of)(f):void 0;if(!p)return{error:new Error(`Missing data source configuration for ${g}`)};try{const c=await(0,r.cc)(p.uid),x=c.features.rulerApiEnabled?{dataSourceName:p.name,dataSourceUid:p.uid,apiVersion:c.application===a.N1.Cortex?"legacy":"config"}:void 0;return{data:{name:p.name,uid:p.uid,application:c.application,rulerConfig:x}}}catch(c){return{error:c}}}})})})},77788:(te,R,e)=>{"use strict";e.d(R,{Pc:()=>r,WG:()=>o,uz:()=>f});var n=e(68143),a=e(6135),s=e(182),i=e(5709);const r="grafana_alerting_v2";function u(p){return`/api/plugins/${(0,s.BO)()}/resources${p}`}const o=i.H.injectEndpoints({endpoints:p=>({grafanaOnCallIntegrations:p.query({query:()=>({url:u("/alert_receive_channels/"),params:{filters:!0,integration:[a.FI,"legacy_grafana_alerting"],skip_pagination:!0},showErrorAlert:!1}),transformResponse:c=>l(c)?c.results:c,providesTags:["OnCallIntegrations"]}),validateIntegrationName:p.query({query:c=>({url:u("/alert_receive_channels/validate_name/"),params:{verbal_name:c},showErrorAlert:!1})}),createIntegration:p.mutation({query:c=>({url:u("/alert_receive_channels/"),data:c,method:"POST",showErrorAlert:!0}),invalidatesTags:["OnCallIntegrations"]}),features:p.query({query:()=>({url:u("/features/"),showErrorAlert:!1})}),onCallConfigChecks:p.query({query:()=>({url:u("/organization/config-checks/"),showErrorAlert:!1})})})});function l(p){return"results"in p&&Array.isArray(p.results)}const{useGrafanaOnCallIntegrationsQuery:g}=o;function f(p){return(0,n.NF)(p)&&"detail"in p.data}},78467:(te,R,e)=>{"use strict";e.d(R,{Dj:()=>f,JY:()=>p,Kw:()=>x,lH:()=>c,ou:()=>g,sA:()=>m});var n=e(1932),a=e(75505),s=e(68143),i=e(74268),r=e(24619),u=e(52161),o=e(29609);function l(y){const{dataSourceName:h,limitAlerts:d,identifier:E}=y;return{rules:(b,D,C)=>{const P=new URLSearchParams;h===u.hY&&d&&P.set("limit_alerts",String(d)),E&&((0,o.Mj)(E)||(0,o.X4)(E))&&(P.set("file",E.namespace),P.set("rule_group",E.groupName));const O={...g(b),...Object.fromEntries(P)};return{url:`/api/prometheus/${(0,u.w5)(h)}/api/v1/rules`,params:f(O,D,C)}}}}function g(y){const h={};return y?.dashboardUID&&(h.dashboard_uid=y.dashboardUID,y?.panelId&&(h.panel_id=String(y.panelId))),h}function f(y,h,d){let E={...y};if(h?.length&&(E={...E,state:h}),d?.length){const b=d.map(D=>JSON.stringify(D));E={...E,matcher:b}}return E}function p(y){return(0,n.jM)(y,h=>{h.rules.forEach(d=>{d.query=d.query||"",d.type===r.JS.Alerting&&(d.state||((0,i.fH)("prom rule with type=alerting is missing a state",{ruleName:d.name}),d.state=r.cF.Inactive))})})}const c=(y,h)=>{const d=y.map(p),E={};return d.forEach(b=>{E[b.file]?E[b.file].groups.push(b):E[b.file]={dataSourceName:h,name:b.file,groups:[b]}}),Object.values(E)},x=(y=[])=>y?.flatMap(h=>h.groups.flatMap(d=>v(d,h.name)));function v(y,h){return{name:y.name,file:h,rules:y.rules,interval:y.interval}}async function m(y,h,d,E,b,D){if(h?.dashboardUID&&y!==u.hY)throw new Error("Filtering by dashboard UID is only supported for Grafana Managed rules.");const{url:C,params:P}=l({dataSourceName:y,limitAlerts:d,identifier:D}).rules(h,b,E),M=await(0,a.s)((0,s.AI)().fetch({url:C,params:P,showErrorAlert:!1,showSuccessAlert:!1})).catch(O=>{throw"status"in O&&O.status===404?new Error("404 from rule state endpoint. Perhaps ruler API is not enabled?"):O});return c(M.data.data.groups,y)}},77295:(te,R,e)=>{"use strict";e.d(R,{$o:()=>f,HO:()=>y,Zp:()=>m,iy:()=>x});var n=e(75505),a=e(28105),s=e(68143),i=e(55376),r=e(95443),u=e(52161),o=e(78467);const l="QUERY_NAMESPACE",g="QUERY_GROUP";function f(D){const C=c(D),P=p(D),M=D.apiVersion==="legacy"?"cortex":"mimir";return{rules:O=>({path:C,params:{subtype:M,...(0,o.ou)(O)}}),namespace:O=>{const{namespace:j,searchParams:U}=P.namespace(O);return{path:`${C}/${encodeURIComponent(j)}`,params:{subtype:M,...U}}},namespaceGroup:(O,j)=>{if(!O)throw new Error("Namespace UID is required to fetch ruler group");if(!j)throw new Error("Group name is required to fetch ruler group");const{namespace:U,searchParams:W}=P.namespace(O),{group:B,searchParams:S}=P.group(j);return{path:`${C}/${encodeURIComponent(U)}/${encodeURIComponent(B)}`,params:{subtype:M,...W,...S}}}}}function p(D){const C=D.dataSourceName===u.hY,P=M=>(0,i.Cl)(M)===!0?{group:g,searchParams:{group:M}}:{group:M,searchParams:{}};return C?{namespace:M=>({namespace:M,searchParams:{}}),group:P}:{namespace:M=>(0,i.Cl)(M)===!0?{namespace:l,searchParams:{namespace:M}}:{namespace:M,searchParams:{}},group:P}}function c(D){return`${`/api/ruler/${D.dataSourceUid}`}/api/v1/rules`}async function x(D,C){if(C?.dashboardUID&&D.dataSourceName!==u.hY)throw new Error("Filtering by dashboard UID is only supported by Grafana.");const{path:P,params:M}=f(D).rules(C);return h(P,{},M)}async function v(D,C){const{path:P,params:M}=f(D).namespace(C);return(await h(P,{},M))[C]||[]}async function m(D){return h(`/api/ruler/${(0,u.w5)(D)}/api/v1/rules/test/test`,null)}async function y(D,C,P){const{path:M,params:O}=f(D).namespaceGroup(C,P);return h(M,null,O)}async function h(D,C,P){try{return(await(0,n.s)((0,s.AI)().fetch({url:D,showErrorAlert:!1,showSuccessAlert:!1,params:P}))).data}catch(M){if(!d(M))throw M;if(b(M))return C;throw E(M)?{...M,data:{...M.data,message:r.UU}}:M}}function d(D){if(!(0,a.Gv)(D))return!1;const C="data"in D&&D.data!==null&&D.data!==void 0;return"status"in D&&Number.isFinite(D.status)&&C}function E(D){return D.status===404||D.status===500&&D.data.message?.includes("unexpected content type from upstream. expected YAML, got text/html")}function b(D){return D.status===404&&(D.data.message?.includes("group does not exist")||D.data.message?.includes("no rule groups found"))}},62939:(te,R,e)=>{"use strict";e.d(R,{E:()=>s,R:()=>a});var n=e(68143);function a(i){if(s(i))return null;throw i}function s(i){return(0,n.NF)(i)&&i.status===404}},7840:(te,R,e)=>{"use strict";e.d(R,{m:()=>c});var n=e(74848),a=e(22803),s=e(2543),i=e.n(s),r=e(96540),u=e(92745),o=e(63142),l=e(45861),g=e(48542),f=e(39659),p=e(78793);const c=({labels:m,commonLabels:y={},size:h,onClick:d})=>{const E=(0,o.of)(v,h),[b,D]=(0,r.useState)(!1),C=(0,s.chain)(m).toPairs().reject(f.w0).reject(([j])=>b?!1:j in y).value(),P=Object.keys(y).length,M=P>0,O=(0,u.t)("alert-labels.button.show.tooltip","Show common labels");return(0,n.jsxs)("div",{className:E.wrapper,role:"list","aria-label":(0,u.t)("alerting.alert-labels.aria-label-labels","Labels"),children:[C.map(([j,U])=>(0,n.jsx)(p.J,{size:h,label:j,value:U,color:x(j),onClick:d},j+U)),!b&&M&&(0,n.jsx)(l.$n,{variant:"secondary",fill:"text",onClick:()=>D(!0),tooltip:O,tooltipPlacement:"top",size:"sm",children:(0,n.jsxs)(u.x6,{i18nKey:"alerting.alert-labels.common-labels-count",count:P,children:["+","{{count}}"," common labels"]})}),b&&M&&(0,n.jsx)(l.$n,{variant:"secondary",fill:"text",onClick:()=>D(!1),tooltipPlacement:"top",size:"sm",children:(0,n.jsx)(u.x6,{i18nKey:"alert-labels.button.hide",children:"Hide common labels"})})]})};function x(m){return(0,g.MC)(m).color}const v=(m,y)=>({wrapper:(0,a.css)({display:"flex",flexWrap:"wrap",alignItems:"center",gap:y==="md"?m.spacing():m.spacing(.5)})})},36826:(te,R,e)=>{"use strict";e.d(R,{d:()=>D,y:()=>C});var n=e(74848),a=e(87586),s=e(13791),i=e(5358),r=e(22803),u=e(96540),o=e(92745),l=e(63142),g=e(18027),f=e(18857),p=e(72508),c=e(52161);function x(O){return O.name===c.hY?"Grafana":O.name}const v=({disabled:O=!1})=>{const j=(0,l.of)(m),{selectedAlertmanager:U,availableAlertManagers:W,setSelectedAlertmanager:B}=(0,i.VI)(),S=(0,u.useMemo)(()=>W.map(T=>({label:x(T),value:T.name,imgUrl:T.imgUrl,meta:T.meta})),[W]),_=O||S.length===1,K=_?"Alertmanager":"Choose Alertmanager";return(0,n.jsx)(g.I,{className:j.field,label:K,disabled:_,"data-testid":"alertmanager-picker",children:(0,n.jsx)(f.l6,{"aria-label":K,width:29,className:"ds-picker select-container",backspaceRemovesValue:!1,onChange:T=>{T?.value&&B(T.value)},options:S,noOptionsMessage:(0,o.t)("alerting.alert-manager-picker.noOptionsMessage-no-datasources-found","No datasources found"),value:U,getOptionLabel:T=>T.label,components:{Option:y}})})},m=O=>({field:(0,r.css)({margin:0})}),y=O=>(0,n.jsx)(p.o5,{...O,renderOptionLabel:({label:j})=>(0,n.jsx)("div",{style:{whiteSpace:"pre-line"},children:j})});var h=e(34999);const d=()=>(0,n.jsx)(h.F,{title:(0,o.t)("alerting.no-alert-managers-available.title-no-alertmanager-found","No Alertmanager found"),severity:"warning",children:(0,n.jsx)(o.x6,{i18nKey:"alerting.no-alert-managers-available.body-no-alertmanager-found",children:"We could not find any external Alertmanagers and you may not have access to the built-in Grafana Alertmanager."})}),E=()=>(0,n.jsx)(h.F,{title:(0,o.t)("alerting.other-alert-managers-available.title-selected-alertmanager-not-found","Selected Alertmanager not found."),severity:"warning",children:(0,n.jsx)(o.x6,{i18nKey:"alerting.other-alert-managers-available.body-selected-alertmanager-not-found",children:"The selected Alertmanager no longer exists or you may not have permission to access it. You can select a different Alertmanager from the dropdown."})}),b=({availableAlertManagers:O})=>{const j=O.length>0;return(0,n.jsx)("div",{children:j?(0,n.jsx)(E,{}):(0,n.jsx)(d,{})})},D=({children:O,isLoading:j,...U})=>(0,n.jsx)(s.Y,{...U,children:(0,n.jsx)(s.Y.Contents,{isLoading:j,children:O})}),C=({children:O,accessType:j,...U})=>{const W=P();return(0,n.jsx)(i.b9,{accessType:j,children:(0,n.jsx)(D,{...U,actions:(0,n.jsx)(v,{disabled:W}),children:(0,n.jsx)(M,{children:O})})})};function P(){const O=(0,a.A)();return["/edit","/new"].some(U=>O?.pathname?.includes(U))}const M=({children:O})=>{const{availableAlertManagers:j,selectedAlertmanager:U}=(0,i.VI)();return U?(0,n.jsx)(n.Fragment,{children:O}):(0,n.jsx)(b,{availableAlertManagers:j})}},83750:(te,R,e)=>{"use strict";e.d(R,{s:()=>p});var n=e(74848),a=e(22803),s=e(45967),i=e(63142),r=e(89640),u=e(95443),o=e(40165),l=e(9368),g=e(16591);const f=["message","description"],p=({annotationKey:v,value:m,valueLink:y})=>{const h=v,d=u.J3[h]?(0,n.jsx)(s.m,{content:v,placement:"top",theme:"info",children:(0,n.jsx)("span",{children:u.J3[h]})}):v;return(0,n.jsx)(o.X,{label:d,horizontal:!0,children:(0,n.jsx)(c,{annotationKey:v,value:m,valueLink:y})})},c=({annotationKey:v,value:m,valueLink:y})=>{const h=(0,i.of)(x),d=f.includes(v),E=m&&m.startsWith("http"),b=(0,n.jsx)(l.Y,{input:m,delimiter:["{{","}}"]});return y?(0,n.jsx)(r.Y,{href:y,external:!0,children:m}):d?(0,n.jsx)(g.L,{className:h.well,children:b}):E?(0,n.jsx)(r.Y,{href:m,external:!0,children:m}):(0,n.jsx)(n.Fragment,{children:b})},x=v=>({well:(0,a.css)({wordBreak:"break-word"})})},24898:(te,R,e)=>{"use strict";e.d(R,{_:()=>r});var n=e(74848),a=e(2543),s=e.n(a),i=e(16692);const r=({actions:p,children:c})=>{const x=(0,a.filter)(p,g),v=(0,a.filter)(p,f);return x.length?(0,n.jsx)(u,{actions:x,children:c}):v.length?(0,n.jsx)(o,{actions:v,children:c}):null},u=({actions:p,children:c})=>{const x=(0,i.iI)();return l(x,p)?(0,n.jsx)(n.Fragment,{children:c}):null},o=({actions:p,children:c})=>{const x=(0,i.e2)();return l(x,p)?(0,n.jsx)(n.Fragment,{children:c}):null};function l(p,c){return(0,a.chain)(p).pick(c).values().value().some(([x,v])=>v===!0)}function g(p){return Object.values(i.QI).includes(p)}function f(p){return Object.values(i.RY).includes(p)}},10427:(te,R,e)=>{"use strict";e.d(R,{A:()=>s});var n=e(96540);function a({children:i,shouldWrap:r,wrap:u},o){return r?(0,n.cloneElement)(u(i)):i}const s=(0,n.forwardRef)(a)},40165:(te,R,e)=>{"use strict";e.d(R,{X:()=>i});var n=e(74848),a=e(22803),s=e(63142);const i=({className:u,label:o,horizontal:l,children:g,childrenWrapperClassName:f})=>{const p=(0,s.of)(r);return(0,n.jsxs)("div",{className:(0,a.cx)(p.field,l?p.fieldHorizontal:p.fieldVertical,u),children:[(0,n.jsx)("div",{children:o}),(0,n.jsx)("div",{className:f,children:g})]})},r=u=>({fieldHorizontal:(0,a.css)({flexDirection:"row",[u.breakpoints.down("md")]:{flexDirection:"column"}}),fieldVertical:(0,a.css)({flexDirection:"column"}),field:(0,a.css)({display:"flex",margin:`${u.spacing(2)} 0`,"& > div:first-child":{width:"110px",paddingRight:u.spacing(1),fontSize:u.typography.size.sm,fontWeight:u.typography.fontWeightBold,lineHeight:1.8},"& > div:nth-child(2)":{flex:1,color:u.colors.text.secondary}})})},6106:(te,R,e)=>{"use strict";e.d(R,{E:()=>p});var n=e(74848),a=e(22803),s=e(96540),i=e(51898),r=e(92745),u=e(63142),o=e(76319),l=e(34213),g=e(74048),f=e(18771);const p=({cols:x,items:v,isExpandable:m=!1,onCollapse:y,onExpand:h,isExpanded:d,renderExpandedContent:E,testIdGenerator:b,pagination:D,paginationStyles:C,renderPrefixCell:P,renderPrefixHeader:M,footerRow:O,dataTestId:j})=>{const U=(0,u.of)(f.H);if((y||h||d)&&!(y&&h&&d))throw new Error("either all of onCollapse, onExpand, isExpanded must be provided, or none");if((m||E)&&!(m&&E))throw new Error("either both isExpanded and renderExpandedContent must be provided, or neither");const W=(0,u.of)(c(x,m,!!M)),[B,S]=(0,s.useState)([]),_=V=>{d&&y&&h?d(V)?y(V):h(V):S(B.includes(V.id)?B.filter(z=>z!==V.id):[...B,V.id])},K=D?.itemsPerPage??v.length,{page:T,numberOfPages:L,onPageChange:A,pageItems:N}=(0,g.W)(v,1,K);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:W.container,"data-testid":j??"dynamic-table",children:[(0,n.jsxs)("div",{className:W.row,"data-testid":"header",children:[M&&M(),m&&(0,n.jsx)("div",{className:W.cell()}),x.map(V=>(0,n.jsx)("div",{className:W.cell(V.alignColumn),children:V.label},V.id))]}),N.map((V,z)=>{const w=d?d(V):B.includes(V.id);return(0,n.jsxs)("div",{className:W.row,"data-testid":b?.(V,z)??"row",children:[P&&P(V,z,v),m&&(0,n.jsx)("div",{className:(0,a.cx)(W.cell(),W.expandCell),children:(0,n.jsx)(o.K,{tooltip:w?(0,r.t)("alerting.dynamic-table.tooltip-collapse-row","Collapse row"):(0,r.t)("alerting.dynamic-table.tooltip-expand-row","Expand row"),"data-testid":i.Tp.components.AlertRules.toggle,name:w?"angle-down":"angle-right",onClick:()=>_(V)})}),x.map(H=>(0,n.jsx)("div",{className:(0,a.cx)(W.cell(H.alignColumn),W.bodyCell,H.className),"data-column":H.label,children:H.renderCell(V,z)},`${V.id}-${H.id}`)),w&&E&&(0,n.jsx)("div",{className:W.expandedContentRow,"data-testid":i.Tp.components.AlertRules.expandedContent,children:E(V,z,v)})]},`${V.id}-${z}`)}),O&&(0,n.jsx)("div",{className:(0,a.cx)(W.row,W.footerRow),children:O})]}),D&&(0,n.jsx)(l.d,{className:(0,a.cx)(U,C),currentPage:T,numberOfPages:L,onNavigate:A,hideWhenSinglePage:!0})]})},c=(x,v,m)=>{const y=x.map(h=>h.size?typeof h.size=="number"?`${h.size}fr`:h.size:"auto");return v&&y.unshift("calc(1em + 16px)"),m&&y.unshift("0"),h=>({container:(0,a.css)({border:`1px solid ${h.colors.border.weak}`,borderRadius:h.shape.radius.default,color:h.colors.text.secondary}),row:(0,a.css)({display:"grid",gridTemplateColumns:y.join(" "),gridTemplateRows:"1fr auto","&:nth-child(2n + 1)":{backgroundColor:h.colors.background.secondary},"&:nth-child(2n)":{backgroundColor:h.colors.background.primary},[h.breakpoints.down("sm")]:{gridTemplateColumns:"auto 1fr",gridTemplateAreas:"left right",padding:`0 ${h.spacing(.5)}`,"&:first-child":{display:"none"},"& > *:first-child":{display:m?"none":void 0}}}),footerRow:(0,a.css)({display:"flex",padding:h.spacing(1)}),cell:d=>(0,a.css)({display:"flex",alignItems:"center",padding:h.spacing(1),justifyContent:d||"initial",[h.breakpoints.down("sm")]:{padding:`${h.spacing(1)} 0`,gridTemplateColumns:"1fr"}}),bodyCell:(0,a.css)({overflow:"hidden",[h.breakpoints.down("sm")]:{gridColumnEnd:"right",gridColumnStart:"right","&::before":{content:"attr(data-column)",display:"block",color:h.colors.text.primary}}}),expandCell:(0,a.css)({justifyContent:"center",[h.breakpoints.down("sm")]:{alignItems:"start",gridArea:"left"}}),expandedContentRow:(0,a.css)({gridColumnEnd:y.length+1,gridColumnStart:m?3:2,gridRow:2,padding:`0 ${h.spacing(3)} 0 ${h.spacing(1)}`,position:"relative",[h.breakpoints.down("sm")]:{gridColumnStart:2,borderTop:`1px solid ${h.colors.border.strong}`,gridRow:"auto",padding:`${h.spacing(1)} 0 0 0`}})})}},57487:(te,R,e)=>{"use strict";e.d(R,{B:()=>r});var n=e(74848),a=e(22803),s=e(63142),i=e(6106);const r=({renderExpandedContent:o,...l})=>{const g=(0,s.of)(u);return(0,n.jsx)(i.E,{renderExpandedContent:o?(f,p,c)=>(0,n.jsxs)(n.Fragment,{children:[p!==c.length-1&&(0,n.jsx)("div",{className:(0,a.cx)(g.contentGuideline,g.guideline)}),o(f,p,c)]}):void 0,renderPrefixHeader:()=>(0,n.jsx)("div",{className:g.relative,children:(0,n.jsx)("div",{className:(0,a.cx)(g.headerGuideline,g.guideline)})}),renderPrefixCell:(f,p,c)=>(0,n.jsxs)("div",{className:g.relative,children:[(0,n.jsx)("div",{className:(0,a.cx)(g.topGuideline,g.guideline)}),p!==c.length-1&&(0,n.jsx)("div",{className:(0,a.cx)(g.bottomGuideline,g.guideline)})]}),...l})},u=o=>({relative:(0,a.css)({position:"relative",height:"100%"}),guideline:(0,a.css)({left:"-19px",borderLeft:`1px solid ${o.colors.border.weak}`,position:"absolute",[o.breakpoints.down("md")]:{display:"none"}}),topGuideline:(0,a.css)({width:"18px",borderBottom:`1px solid ${o.colors.border.medium}`,top:0,bottom:"50%"}),bottomGuideline:(0,a.css)({top:"50%",bottom:0}),contentGuideline:(0,a.css)({top:0,bottom:0,left:"-49px !important"}),headerGuideline:(0,a.css)({top:"-17px",bottom:0})})},58750:(te,R,e)=>{"use strict";e.d(R,{M:()=>f});var n=e(74848),a=e(22803),s=e(92745),i=e(63142),r=e(34999),u=e(84266),o=e(91984),l=e(16692),g=e(52161);function f({currentAlertmanager:c}){const x=(0,i.of)(p),v=c!==g.hY,[m,y]=(0,l.Ej)(l.RY.ReadConfigurationStatus),h=m&&y,{currentData:d}=o.m.endpoints.getGrafanaAlertingConfigurationStatus.useQuery(void 0,{skip:v||!h});if(!(d?.alertmanagersChoice&&[u.nA.External,u.nA.All].includes(d?.alertmanagersChoice))||v)return null;const b=d.numExternalAlertmanagers>0;return d.alertmanagersChoice===u.nA.External?(0,n.jsxs)(r.F,{title:(0,s.t)("alerting.grafana-alertmanager-delivery-warning.title-grafana-alerts-delivered-alertmanager","Grafana alerts are not delivered to Grafana Alertmanager"),children:[(0,n.jsx)(s.x6,{i18nKey:"alerting.grafana-alertmanager-delivery-warning.configuration-changes-external",children:"Grafana is configured to send alerts to external Alertmanagers only. Changing Grafana Alertmanager configuration will not affect delivery of your alerts."}),(0,n.jsx)("div",{className:x.adminHint,children:(0,n.jsx)(s.x6,{i18nKey:"alerting.grafana-alertmanager-delivery-warning.admin-hint-external",children:"To change your Alertmanager setup, go to the Alerting Admin page. If you do not have access, contact your Administrator."})})]}):d.alertmanagersChoice===u.nA.All&&b?(0,n.jsxs)(r.F,{title:(0,s.t)("alerting.grafana-alertmanager-delivery-warning.title-you-have-additional-alertmanagers-to-configure","You have additional Alertmanagers to configure"),severity:"warning",children:[(0,n.jsx)(s.x6,{i18nKey:"alerting.grafana-alertmanager-delivery-warning.configuration-changes-all",children:"Ensure you make configuration changes in the correct Alertmanagers; both internal and external. Changing one will not affect the others."}),(0,n.jsx)("div",{className:x.adminHint,children:(0,n.jsx)(s.x6,{i18nKey:"alerting.grafana-alertmanager-delivery-warning.admin-hint-all",children:"To change your Alertmanager setup, go to the Alerting Admin page. If you do not have access, contact your Administrator."})})]}):null}const p=c=>({adminHint:(0,a.css)({fontSize:c.typography.bodySmall.fontSize,fontWeight:c.typography.bodySmall.fontWeight})})},38055:(te,R,e)=>{"use strict";e.d(R,{B:()=>f});var n=e(74848),a=e(22803),s=e(46942),i=e.n(s),r=e(96540),u=e(63142),o=e(41654),l=e(43533),g=e(2381);const f=({children:c,header:x,content:v,footer:m,arrow:y,showAfter:h=300,wrapperClassName:d,disabled:E=!1,showOn:b="hover",...D})=>{const C=(0,r.useRef)(null),P=(0,u.of)(p);if(E)return c;const M=b==="hover",O=b==="click",j=(0,n.jsxs)(o.B,{direction:"column",gap:0,role:"tooltip",children:[x&&(0,n.jsx)("div",{className:P.card.header,children:x}),(0,n.jsx)("div",{className:P.card.body,children:v}),m&&(0,n.jsx)("div",{className:P.card.footer,children:m})]});return(0,n.jsx)(l.I,{content:j,hideAfter:100,children:(U,W,B)=>{const S={onClick:U},_={onMouseLeave:W,onMouseEnter:U},K={onBlur:W,onFocus:U};return(0,n.jsxs)(n.Fragment,{children:[C.current&&(0,n.jsx)(g.A,{...B,...D,wrapperClassName:i()(P.popover,d),referenceElement:C.current,renderArrow:y,...K,...M?_:{}}),(0,r.cloneElement)(c,{ref:C,onFocus:U,onBlur:W,tabIndex:0,...M?_:{},...O?S:{}})]})}})},p=c=>({popover:(0,a.css)({borderRadius:c.shape.radius.default,boxShadow:c.shadows.z3,background:c.colors.background.primary,border:`1px solid ${c.colors.border.weak}`}),card:{body:(0,a.css)({padding:c.spacing(1)}),header:(0,a.css)({padding:c.spacing(1),background:c.colors.background.secondary,borderBottom:`solid 1px ${c.colors.border.medium}`}),footer:(0,a.css)({padding:c.spacing(.5,1),background:c.colors.background.secondary,borderTop:`solid 1px ${c.colors.border.medium}`})}})},85311:(te,R,e)=>{"use strict";e.d(R,{A:()=>r});var n=e(74848),a=e(92745),s=e(34999);const r=()=>(0,n.jsx)(s.F,{severity:"info",title:(0,a.t)("alerting.alert.evaluation-paused","Alert evaluation currently paused"),children:(0,n.jsx)(a.x6,{i18nKey:"alerting.alert.evaluation-paused-description",children:"Notifications for this rule will not fire and no alert instances will be created until the rule is un-paused."})})},78793:(te,R,e)=>{"use strict";e.d(R,{J:()=>l});var n=e(74848),a=e(22803),s=e(96540),i=e(84140),r=e(63142),u=e(41654),o=e(30703);const l=({label:f,value:p,icon:c,color:x,size:v="md",onClick:m})=>{const y=(0,r.of)(g,x,v),h=`${f}: ${p}`,d=f?.toString()??"",E=p?.toString()??"",b=(0,s.useMemo)(()=>(0,n.jsxs)(u.B,{direction:"row",gap:0,alignItems:"stretch",children:[(0,n.jsx)("div",{className:y.label,children:(0,n.jsxs)(u.B,{direction:"row",gap:.5,alignItems:"center",children:[c&&(0,n.jsx)(o.I,{name:c}),f&&(0,n.jsx)("span",{className:y.labelText,title:f.toString(),children:f??""})]})}),(0,n.jsx)("div",{className:y.value,title:p?.toString(),children:p??"-"})]}),[c,f,p,y]);return(0,n.jsx)("div",{className:y.wrapper,role:"listitem","aria-label":h,"data-testid":"label-value",children:m?(0,n.jsx)("div",{className:y.clickable,role:"button",tabIndex:0,onClick:()=>m(d,E),onKeyDown:D=>{D.key==="Enter"&&(m(d,E),D.preventDefault())},children:b},d+E):b})},g=(f,p,c)=>{const x=p??f.colors.secondary.main,v=f.isDark?(0,i.A)(x).lighten(5).toString():(0,i.A)(x).darken(5).toString(),m=f.isDark?(0,i.A)(x).darken(5).toString():(0,i.A)(x).lighten(5).toString(),y=p?i.A.mostReadable(x,["#000","#fff"]).toString():f.colors.text.primary;let h=f.spacing(.33,1);switch(c){case"sm":h=f.spacing(.2,.6);break;case"xs":h=f.spacing(0,.5);break;default:break}return{wrapper:(0,a.css)({color:y,fontSize:f.typography.bodySmall.fontSize,borderRadius:f.shape.borderRadius(2)}),labelText:(0,a.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"}),label:(0,a.css)({display:"flex",alignItems:"center",color:"inherit",padding:h,background:x,border:`solid 1px ${v}`,borderTopLeftRadius:f.shape.borderRadius(2),borderBottomLeftRadius:f.shape.borderRadius(2)}),clickable:(0,a.css)({"&:hover":{opacity:.8,cursor:"pointer"}}),value:(0,a.css)({color:"inherit",padding:h,background:m,border:`solid 1px ${v}`,borderLeft:"none",borderTopRightRadius:f.shape.borderRadius(2),borderBottomRightRadius:f.shape.borderRadius(2),whiteSpace:"pre",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"})}}},1625:(te,R,e)=>{"use strict";e.d(R,{P:()=>o});var n=e(74848),a=e(22803),s=e(63142),i=e(66404),r=e(41654),u=e(30703);const o=({children:g,icon:f,color:p="secondary",direction:c="row",...x})=>{const v=(0,s.of)(l),m=typeof x.onClick=="function",y=c==="row",h=y?"center":"flex-start",d=y?.5:0;return(0,n.jsx)("div",{className:(0,a.cx)({[v.interactive]:m}),...x,children:(0,n.jsx)(i.E,{variant:"bodySmall",color:p,children:(0,n.jsxs)(r.B,{direction:c,alignItems:h,gap:d,wrap:"wrap",children:[f&&(0,n.jsx)(u.I,{size:"xs",name:f}),g]})})})},l=()=>({interactive:(0,a.css)({cursor:"pointer"})})},27691:(te,R,e)=>{"use strict";e.d(R,{A:()=>l});var n=e(74848),a=e(96540),s=e(92745),i=e(45861),r=e(41654),u=e(30703);const l=(0,a.forwardRef)(function(f,p){return(0,n.jsx)(i.$n,{variant:"secondary",size:"sm",type:"button","aria-label":f.title??(0,s.t)("alerting.more-button.aria-label","More"),ref:p,...f,children:(0,n.jsxs)(r.B,{direction:"row",alignItems:"center",gap:0,children:[f.title??(0,n.jsx)(s.x6,{i18nKey:"alerting.more-button.button-text",children:"More"}),(0,n.jsx)(u.I,{name:"angle-down"})]})})})},28405:(te,R,e)=>{"use strict";e.d(R,{h:()=>i});var n=e(74848),a=e(3986);const s=({children:r,plugin:u,loadingComponent:o,notInstalledFallback:l})=>{const{loading:g,installed:f}=usePluginBridge(u);return g?o??null:f?jsx(Fragment,{children:r}):l??null};function i(r,u,o){const l=new URLSearchParams(o).toString();return`/a/${r}${u}`+(l?"?"+l:"")}},1972:(te,R,e)=>{"use strict";e.d(R,{Yi:()=>o,hk:()=>u,rS:()=>l});var n=e(74848),a=e(92745),s=e(34999),i=e(99887),r=e(45967),u=(g=>(g.ContactPoint="contact point",g.Template="template",g.MuteTiming="time interval",g.AlertRule="alert rule",g.RootNotificationPolicy="root notification policy",g))(u||{});const o=({resource:g,...f})=>(0,n.jsx)(s.F,{title:(0,a.t)("alerting.provisioning.title-provisioned","This {{resource}} cannot be edited through the UI",{resource:g}),severity:"info",...f,children:(0,n.jsxs)(a.x6,{i18nKey:"alerting.provisioning.body-provisioned",children:["This ",{resource:g}," has been provisioned, that means it was created by config. Please contact your server admin to update this ",{resource:g},"."]})}),l=({tooltip:g,provenance:f})=>{const p=(0,n.jsx)(i.E,{text:(0,a.t)("alerting.provisioning-badge.badge.text-provisioned","Provisioned"),color:"purple"});if(g){const c=(0,n.jsxs)(a.x6,{i18nKey:"alerting.provisioning.badge-tooltip-provenance",values:{provenance:f},children:["This resource has been provisioned via ",{provenance:f}," and cannot be edited through the UI"]}),x=(0,n.jsx)(a.x6,{i18nKey:"alerting.provisioning.badge-tooltip-standard",children:"This resource has been provisioned and cannot be edited through the UI"}),v=f?c:x;return(0,n.jsx)(r.m,{content:v,children:(0,n.jsx)("span",{children:p})})}return p}},40360:(te,R,e)=>{"use strict";e.d(R,{c:()=>i});var n=e(74848),a=e(66404),s=e(30703);const i=({namespace:r,group:u})=>u?(0,n.jsxs)(a.E,{element:"h3",variant:"body",children:[r," ",(0,n.jsx)(s.I,{name:"angle-right","aria-label":">"})," ",u]}):(0,n.jsx)(a.E,{element:"h3",variant:"body",children:r})},49779:(te,R,e)=>{"use strict";e.d(R,{h:()=>s});var n=e(74848),a=e(22803);const s=()=>(0,n.jsx)("span",{className:(0,a.css)({flex:1})})},67834:(te,R,e)=>{"use strict";e.d(R,{O:()=>r});var n=e(74848),a=e(22803),s=e(96540),i=e(63142);const r=(0,s.forwardRef)(({children:o,state:l,size:g="md",muted:f=!1},p)=>{const c=(0,i.of)(u);return(0,n.jsx)("span",{className:(0,a.cx)(c.common,c[l],c[g],{[c.muted]:f}),ref:p,children:o||l})});r.displayName="StateTag";const u=o=>({common:(0,a.css)({display:"inline-block",color:"white",borderRadius:o.shape.radius.default,fontSize:o.typography.size.sm,textTransform:"capitalize",lineHeight:"1.2",textAlign:"center",fontWeight:o.typography.fontWeightBold}),good:(0,a.css)({backgroundColor:o.colors.success.main,border:`solid 1px ${o.colors.success.main}`,color:o.colors.success.contrastText}),warning:(0,a.css)({backgroundColor:o.colors.warning.main,border:`solid 1px ${o.colors.warning.main}`,color:o.colors.warning.contrastText}),bad:(0,a.css)({backgroundColor:o.colors.error.main,border:`solid 1px ${o.colors.error.main}`,color:o.colors.error.contrastText}),neutral:(0,a.css)({backgroundColor:o.colors.secondary.main,border:`solid 1px ${o.colors.secondary.main}`,color:o.colors.secondary.contrastText}),info:(0,a.css)({backgroundColor:o.colors.primary.main,border:`solid 1px ${o.colors.primary.main}`,color:o.colors.primary.contrastText}),md:(0,a.css)({padding:o.spacing(.5,1),minWidth:o.spacing(8)}),sm:(0,a.css)({padding:o.spacing(.3,.5),minWidth:"52px"}),muted:(0,a.css)({opacity:"0.5"})})},9368:(te,R,e)=>{"use strict";e.d(R,{Y:()=>l});var n=e(74848),a=e(22803),s=e(63142),i=e(99887),r=e(38055),u=e(56652);const o=["$",".",'"'];function l({input:y,delimiter:h=["{{","}}"]}){const d=(0,s.of)(m),[E,b]=h,D=new RegExp(`(?<before>.*?)(${E}(?<token>.*?)${b}|$)`,"gm"),C=y.split(`
`),P=[];return C.forEach((M,O)=>{Array.from(M.matchAll(D)).forEach((U,W)=>{const B=U.groups?.before,S=U.groups?.token?.trim();if(B&&P.push((0,n.jsx)("span",{children:B},`${O}-${W}-before`)),S){const _=v(S),K=_==="variable"?S:"",T=`${E} ${S} ${b}`;P.push((0,n.jsx)(f,{content:T,type:_,description:K},`${O}-${W}-token`))}}),P.push((0,n.jsx)("br",{},`${O}-newline`))}),(0,n.jsx)("span",{className:d.wrapper,children:P})}var g=(y=>(y.Variable="variable",y.Function="function",y.Keyword="keyword",y.Unknown="unknown",y))(g||{});function f({content:y,description:h,type:d}){const E=(0,s.of)(m),b=!d;return(0,n.jsx)(r.B,{placement:"top-start",disabled:b,content:(0,n.jsxs)("div",{className:E.hoverTokenItem,children:[(0,n.jsx)(i.E,{tabIndex:0,text:(0,n.jsx)(n.Fragment,{children:d}),color:"blue"})," ",h&&(0,n.jsx)("code",{children:h})]}),children:(0,n.jsx)("span",{children:(0,n.jsx)(i.E,{tabIndex:0,className:E.token,text:y,color:"blue"})})})}function p(y){return o.some(h=>y.startsWith(h))}function c(y){return u.keywords.some(h=>y.startsWith(h))}function x(y){return u.builtinFunctions.some(h=>y.startsWith(h))}function v(y){let h;return p(y)?h="variable":c(y)?h="keyword":x(y)?h="function":h="unknown",h}const m=y=>({wrapper:(0,a.css)({whiteSpace:"pre-wrap"}),token:(0,a.css)({cursor:"default",fontFamily:y.typography.fontFamilyMonospace}),popover:(0,a.css)({borderRadius:y.shape.radius.default,boxShadow:y.shadows.z3,background:y.colors.background.primary,border:`1px solid ${y.colors.border.medium}`,padding:y.spacing(1)}),hoverTokenItem:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"center",gap:y.spacing(1)})})},16591:(te,R,e)=>{"use strict";e.d(R,{L:()=>i});var n=e(74848),a=e(22803),s=e(63142);const i=({children:u,className:o})=>{const l=(0,s.of)(r);return(0,n.jsx)("div",{className:(0,a.cx)(l.wrapper,o),children:u})},r=u=>({wrapper:(0,a.css)({backgroundColor:u.components.panel.background,border:`solid 1px ${u.components.input.borderColor}`,borderRadius:u.shape.radius.default,padding:u.spacing(.5,1),fontFamily:u.typography.fontFamilyMonospace})})},2401:(te,R,e)=>{"use strict";e.d(R,{d:()=>s});var n=e(96540),a=e(41071);const s=({component:i,title:r="previous page"})=>{const u=(0,a.i)(),o=(0,n.useCallback)(()=>{u(r)},[u,r]);return(0,n.cloneElement)(i,{onClick:o})}},87133:(te,R,e)=>{"use strict";e.d(R,{X:()=>m});var n=e(74848),a=e(22803),s=e(96540),i=e(40996),r=e(92745),u=e(63142),o=e(30703),l=e(37386),g=e(72636),f=e(41654),p=e(45967),c=e(63527),x=e(74268),v=e(63895);const m=({onFilterChange:h,defaultQueryString:d})=>{const E=(0,u.of)(y),[b,D]=(0,s.useState)(d??"");(0,i.A)(()=>{(0,x.fH)(x.le.filterByLabel),h(b)},600,[b]);const C=(0,n.jsx)(o.I,{name:"search"});let P=!!(d&&d.length>=3);try{d?(0,v.S6)(d):P=!0}catch{P=!1}return(0,n.jsx)(l.D,{className:E.fixMargin,invalid:!P,error:P?null:"Query must use valid matcher syntax. See the examples in the help tooltip.",label:(0,n.jsx)(g.J,{children:(0,n.jsxs)(f.B,{gap:.5,alignItems:"center",children:[(0,n.jsx)("span",{children:(0,n.jsx)(r.x6,{i18nKey:"alerting.matcher-filter.search-by-label",children:"Search by label"})}),(0,n.jsx)(p.m,{content:(0,n.jsxs)("div",{children:[(0,n.jsx)(r.x6,{i18nKey:"alerting.matcher-filter.filter-alerts-using-label-querying-without-spaces",children:"Filter alerts using label querying without spaces, ex:"}),(0,n.jsx)("pre",{children:'{severity="critical", instance=~"cluster-us-.+"}'}),(0,n.jsx)(r.x6,{i18nKey:"alerting.matcher-filter.invalid-use-of-spaces",children:"Invalid use of spaces:"}),(0,n.jsx)("pre",{children:'{severity= "critical"}'}),(0,n.jsx)("pre",{children:'{severity ="critical"}'}),(0,n.jsx)(r.x6,{i18nKey:"alerting.matcher-filter.valid-use-of-spaces",children:"Valid use of spaces:"}),(0,n.jsx)("pre",{children:'{severity=" critical"}'}),(0,n.jsx)(r.x6,{i18nKey:"alerting.matcher-filter.filter-alerts-using-label-querying-without-braces",children:"Filter alerts using label querying without braces, ex:"}),(0,n.jsx)("pre",{children:'severity="critical", instance=~"cluster-us-.+"'})]}),children:(0,n.jsx)(o.I,{name:"info-circle",size:"sm"})})]})}),children:(0,n.jsx)(c.p,{placeholder:(0,r.t)("alerting.matcher-filter.search-query-input-placeholder-search","Search"),value:b,onChange:M=>D(M.currentTarget.value),"data-testid":"search-query-input",prefix:C,className:E.inputWidth})})},y=h=>({fixMargin:(0,a.css)({marginBottom:0}),inputWidth:(0,a.css)({width:340,flexGrow:0})})},16194:(te,R,e)=>{"use strict";e.d(R,{S:()=>s,X:()=>i});var n=e(74848),a=e(66404);const s=({content:r})=>(0,n.jsx)(a.E,{color:"primary",children:r}),i=({content:r})=>(0,n.jsx)(a.E,{variant:"code",children:r})},24961:(te,R,e)=>{"use strict";e.d(R,{z8:()=>X,yz:()=>ee});var n=e(74848),a=e(22803),s=e(2543),i=e(96540),r=e(25229),u=e(92745),o=e(63142),l=e(41654),g=e(30703),f=e(66404),p=e(45967),c=e(16194),x=e(87063),v=e(89640),m=e(45861),y=e(88559),h=e(10427),d=e(8307),E=e(28141),b=e(5358),D=e(22628),C=e(56476),P=e(16692),M=e(92367),O=e(27691),j=e(1972),U=e(49779),W=e(99887);const B=()=>(0,n.jsx)(W.E,{text:(0,u.t)("alerting.unused-contact-point-badge.text-unused","Unused"),"aria-label":(0,u.t)("alerting.unused-contact-point-badge.aria-label-unused","unused"),color:"orange",icon:"exclamation-triangle",tooltip:(0,u.t)("alerting.unused-contact-point-badge.tooltip-unused","This contact point is not used in any notification policy or alert rule")});var S=e(66056);const _=({contactPoint:se,onDelete:oe})=>{const{name:de,id:fe,provisioned:ae,policies:ce=[]}=se,ie=(0,o.of)(K),[ve,le]=(0,i.useState)(!1),{selectedAlertmanager:Ee}=(0,b.VI)(),Re=(0,C.dM)(Ee),[Oe,Se]=(0,P.L7)(P.QI.ExportContactPoint),[Te,_e]=(0,P.L7)(P.QI.UpdateContactPoint),[He,tt]=(0,P.L7)(P.QI.UpdateContactPoint),[Je,Ge]=(0,d.G)(),je=(0,S.T8)(Ee,se),Fe=ce.filter(Me=>Me.route.type!=="auto-generated"),Be=(0,C.gw)(se,D.T.InUseRoutes),Ke=Re?Number(Be):ce.length,Ue=Re?Number(Be):Fe.length,we=Number((0,C.gw)(se,D.T.InUseRules))||0,Xe=Re?!!(Ke||we):ce.length>0,nt=(0,C.Au)(se)||_e,xe=Te&&nt&&!ae,me=(0,C.zl)(se)||tt,De=He&&me&&(!ae&&!Ue&&!we),Le=[];if(je&&Le.push((0,n.jsx)(i.Fragment,{children:(0,n.jsx)(x.W.Item,{icon:"unlock",label:(0,u.t)("alerting.contact-point-header.label-manage-permissions","Manage permissions"),onClick:()=>le(!0)})},"manage-permissions")),Oe&&Le.push((0,n.jsxs)(i.Fragment,{children:[(0,n.jsx)(x.W.Item,{icon:"download-alt",label:(0,u.t)("alerting.contact-point-header.export-label-export","Export"),ariaLabel:(0,u.t)("alerting.contact-point-header.export-ariaLabel-export","Export"),disabled:!Se,"data-testid":"export",onClick:()=>Ge(de)}),(0,n.jsx)(x.W.Divider,{})]},"export-contact-point")),He){const Me=(0,u.t)("alerting.contact-points.delete-reasons.no-permissions","You do not have the required permission to delete this contact point"),$e=(0,u.t)("alerting.contact-points.delete-reasons.provisioned","Contact point is provisioned and cannot be deleted via the UI"),at=(0,u.t)("alerting.contact-points.delete-reasons.policies","Contact point is referenced by one or more notification policies"),ct=(0,u.t)("alerting.contact-points.delete-reasons.rules","Contact point is referenced by one or more alert rules"),ft=[me?"":Me,ae?$e:"",Ue>0?at:"",we?ct:""].filter(Boolean),Et=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.x6,{i18nKey:"alerting.contact-points.delete-reasons.heading",children:"Contact point cannot be deleted for the following reasons:"}),(0,n.jsx)("br",{}),ft.map(St=>(0,n.jsx)("li",{children:St},St))]});Le.push((0,n.jsx)(h.A,{shouldWrap:!De,wrap:St=>(0,n.jsx)(p.m,{content:Et,placement:"top",children:(0,n.jsx)("span",{children:St})}),children:(0,n.jsx)(x.W.Item,{label:(0,u.t)("alerting.contact-point-header.label-delete","Delete"),ariaLabel:(0,u.t)("alerting.contact-point-header.ariaLabel-delete","Delete"),icon:"trash-alt",destructive:!0,disabled:!De,onClick:()=>oe(se)})},"delete-contact-point"))}const Ve=(0,u.t)("alerting.contact-points.used-by","Used by {{ count }} notification policy",{count:Ke}),ze=(0,u.t)("alerting.contact-points.used-by-rules","Used by {{ count }} alert rule",{count:we}),Ze=fe||de;return(0,n.jsxs)("div",{className:ie.headerWrapper,children:[(0,n.jsxs)(l.B,{direction:"row",alignItems:"center",gap:1,children:[(0,n.jsx)(l.B,{alignItems:"center",gap:1,minWidth:0,children:(0,n.jsx)(f.E,{element:"h2",variant:"body",weight:"medium",truncate:!0,children:de})}),Ke>0&&(0,n.jsx)(v.Y,{href:(0,M.G)("/alerting/routes",{contactPoint:de}),variant:"bodySmall",color:"primary",inline:!1,children:Ve}),we>0&&(0,n.jsx)(v.Y,{href:(0,M.G)("/alerting/list",{search:`contactPoint:"${de}"`}),variant:"bodySmall",color:"primary",inline:!1,children:ze}),ae&&(0,n.jsx)(j.rS,{tooltip:!0,provenance:(0,C.gw)(se,D.T.Provenance)}),!Xe&&(0,n.jsx)(B,{}),(0,n.jsx)(U.h,{}),(0,n.jsx)(m.z9,{tooltipPlacement:"top",tooltip:ae?(0,u.t)("alerting.contact-point-header.tooltip-provisioned-contact-points","Provisioned contact points cannot be edited in the UI"):void 0,variant:"secondary",size:"sm",icon:xe?"pen":"eye",type:"button","data-testid":`${xe?"edit":"view"}-action`,href:`/alerting/notifications/receivers/${encodeURIComponent(Ze)}/edit`,children:xe?(0,u.t)("alerting.contact-point-header.button-edit","Edit"):(0,u.t)("alerting.contact-point-header.button-view","View")}),Le.length>0&&(0,n.jsx)(y.m,{overlay:(0,n.jsx)(x.W,{children:Le}),children:(0,n.jsx)(O.A,{"aria-label":(0,u.t)("alerting.contact-point-header.aria-label-more-actions",'More actions for contact point "{{contactPointName}}"',{contactPointName:se.name})})})]}),Je,ve&&(0,n.jsx)(E.v,{resource:"receivers",resourceId:se.id,resourceName:se.name,onClose:()=>le(!1)})]})},K=se=>({headerWrapper:(0,a.css)({background:`${se.colors.background.secondary}`,padding:`${se.spacing(1)} ${se.spacing(1.5)}`,borderBottom:`solid 1px ${se.colors.border.weak}`,borderTopLeftRadius:`${se.shape.radius.default}`,borderTopRightRadius:`${se.shape.radius.default}`})});var T=e(22787),L=e(77256);const A=se=>{const[oe,de]=(0,i.useState)(!1),[fe,ae]=(0,i.useState)(),[ce,ie]=(0,i.useState)(),[ve,le]=(0,i.useState)(!1),Ee=(0,i.useCallback)(()=>{ve||(ae(void 0),de(!1),ie(void 0))},[ve]),Re=(0,i.useCallback)(({name:Te,resourceVersion:_e})=>{ae({name:Te,resourceVersion:_e}),de(!0),ie(void 0)},[]),Oe=(0,i.useCallback)(()=>{fe&&(le(!0),se(fe).then(()=>de(!1)).catch(ie).finally(()=>{le(!1)}))},[se,fe]);return[(0,i.useMemo)(()=>ce?(0,n.jsx)(N,{isOpen:oe,onDismiss:Ee,error:ce}):(0,n.jsxs)(T.a,{isOpen:oe,onDismiss:Ee,closeOnBackdropClick:!ve,closeOnEscape:!ve,title:(0,u.t)("alerting.use-delete-contact-point-modal.modal-element.title-delete-contact-point","Delete contact point"),children:[(0,n.jsx)("p",{children:(0,n.jsx)(u.x6,{i18nKey:"alerting.use-delete-contact-point-modal.modal-element.deleting-contact-point-permanently-remove",children:"Deleting this contact point will permanently remove it."})}),(0,n.jsx)("p",{children:(0,n.jsx)(u.x6,{i18nKey:"alerting.use-delete-contact-point-modal.modal-element.delete-contact-point",children:"Are you sure you want to delete this contact point?"})}),(0,n.jsxs)(T.a.ButtonRow,{children:[(0,n.jsx)(m.$n,{type:"button",variant:"destructive",onClick:Oe,disabled:ve,children:ve?(0,u.t)("alerting.use-delete-contact-point-modal.deleting","Deleting..."):(0,u.t)("alerting.use-delete-contact-point-modal.delete-confirm","Yes, delete contact point")}),(0,n.jsx)(m.$n,{type:"button",variant:"secondary",onClick:Ee,disabled:ve,children:(0,n.jsx)(u.x6,{i18nKey:"alerting.common.cancel",children:"Cancel"})})]})]}),[ce,Ee,Oe,ve,oe]),Re,Ee]},N=({isOpen:se,onDismiss:oe,error:de})=>(0,n.jsxs)(T.a,{isOpen:se,onDismiss:oe,closeOnBackdropClick:!0,closeOnEscape:!0,title:(0,u.t)("alerting.error-modal.title-something-went-wrong","Something went wrong"),children:[(0,n.jsx)("p",{children:(0,n.jsx)(u.x6,{i18nKey:"alerting.error-modal.failed-to-update-your-configuration",children:"Failed to update your configuration:"})}),(0,n.jsx)("pre",{children:(0,n.jsx)("code",{children:(0,L.JZ)(de)})})]});var V=e(97507);const z={pagerduty:"PagerDuty",pushover:"Pushover",slack:"Slack",opsgenie:"OpsGenie",webhook:"Webhook",victorops:"VictorOps",wechat:"WeChat",discord:"Discord",webex:"Cisco Webex Teams",sns:"Amazon SNS",telegram:"Telegram",msteams:"Microsoft Teams"},w={discord:"discord",email:"envelope",googlechat:"google-hangouts-alt",hipchat:"hipchat",line:"line",pagerduty:"pagerduty",slack:"slack",teams:"microsoft",telegram:"telegram-alt",webhook:"link",sns:"amazon"};var H=e(1625);const Q=({metadata:{icon:se,title:oe,externalUrl:de,warning:fe}})=>{const ae=(0,o.of)(Z);return(0,n.jsxs)(l.B,{alignItems:"center",gap:.5,children:[(0,n.jsxs)(l.B,{direction:"row",alignItems:"center",gap:.5,children:[fe?(0,n.jsx)(p.m,{content:fe,theme:"error",children:(0,n.jsx)(g.I,{name:"exclamation-triangle",className:ae.warnIcon})}):(0,n.jsx)("img",{src:se,alt:oe,height:"16px"}),(0,n.jsx)("span",{children:oe})]}),de&&(0,n.jsx)(m.z9,{icon:"external-link-alt",href:de,target:"_blank",variant:"secondary",size:"sm"})]})},Z=se=>({warnIcon:(0,a.css)({fill:se.colors.warning.text})});var Y=e(3887);const X=({contactPoint:se})=>{const{grafana_managed_receiver_configs:oe}=se,de=(0,o.of)(ne),{selectedAlertmanager:fe}=(0,b.VI)(),[ae]=(0,V.$x)({alertmanager:fe}),[ce,ie]=A(ae.execute),ve=oe.some(le=>!!le[Y.MX]);return(0,n.jsxs)("div",{className:de.contactPointWrapper,"data-testid":"contact-point",children:[(0,n.jsxs)(l.B,{direction:"column",gap:0,children:[(0,n.jsx)(_,{contactPoint:se,onDelete:le=>ie({name:le.id||le.name,resourceVersion:le.metadata?.resourceVersion})}),ve?(0,n.jsx)("div",{children:oe.map((le,Ee)=>{const Re=le[Y.v4],Oe=le[Y.MX],Se=!le.disableResolveMessage,Te=le[Y.sW],_e=Oe.name+Ee;return(0,n.jsx)(I,{name:Oe.name,type:le.type,description:(0,S.aM)(le),diagnostics:Re,pluginMetadata:Te,sendingResolved:Se},_e)})}):(0,n.jsx)("div",{className:de.integrationWrapper,children:(0,n.jsx)(ee,{receivers:oe})})]}),ce]})},I=se=>{const{name:oe,type:de,description:fe,diagnostics:ae,pluginMetadata:ce,sendingResolved:ie=!0}=se,ve=(0,o.of)(ne),le=ae!==void 0;return(0,n.jsx)("div",{className:ve.integrationWrapper,children:(0,n.jsxs)(l.B,{direction:"column",gap:.5,children:[(0,n.jsx)(J,{name:oe,type:de,description:fe,pluginMetadata:ce}),le&&(0,n.jsx)(q,{diagnostics:ae,sendingResolved:ie})]})})};function J(se){const{name:oe,type:de,description:fe,pluginMetadata:ae}=se,ce=w[de];return(0,n.jsxs)(l.B,{direction:"row",alignItems:"center",gap:1,children:[(0,n.jsxs)(l.B,{direction:"row",alignItems:"center",gap:.5,children:[ce&&(0,n.jsx)(g.I,{name:ce}),ae?(0,n.jsx)(Q,{metadata:ae}):(0,n.jsx)(f.E,{variant:"body",color:"primary",children:oe})]}),fe&&(0,n.jsx)(f.E,{variant:"bodySmall",color:"secondary",children:fe})]})}const ee=({receivers:se,limit:oe})=>{const de=oe??Number.MAX_VALUE,fe=(0,s.groupBy)(se,ve=>ve.type),ae=(0,s.size)(fe),ce=Object.entries(fe).slice(0,de),ie=ae-de;return(0,n.jsx)(l.B,{direction:"column",gap:0,children:(0,n.jsxs)(l.B,{direction:"row",alignItems:"center",gap:1,children:[ce.length===0&&(0,n.jsx)(H.P,{color:"warning",icon:"exclamation-triangle",children:(0,n.jsx)(u.x6,{i18nKey:"alerting.contact-points.no-integrations",children:"No integrations configured"})}),ce.map(([ve,le],Ee)=>{const Re=w[ve],Oe=z[ve]??(0,s.upperFirst)(ve),Se=(0,s.size)(fe)-1===Ee,Te=le[0];return(0,n.jsxs)(i.Fragment,{children:[(0,n.jsxs)(l.B,{direction:"row",alignItems:"center",gap:.5,children:[Te[Y.sW]?.icon&&(0,n.jsx)("img",{width:"14px",src:Te[Y.sW]?.icon,alt:Te[Y.sW]?.title}),Re&&(0,n.jsx)(g.I,{name:Re}),(0,n.jsxs)("span",{children:[Oe,le.length>1&&` (${le.length})`]})]}),!Se&&"\u22C5"]},ve)}),ie>0&&(0,n.jsx)("span",{children:`+${ie} more`})]})})},q=({diagnostics:se,sendingResolved:oe})=>{const de=(0,o.of)(ne),fe=!!se.lastNotifyAttemptError,ae=(0,r.KQ)(se.lastNotifyAttempt),ce=se.lastNotifyAttemptDuration,ie=ae.isValid();return(0,n.jsx)("div",{className:de.metadataRow,children:(0,n.jsx)(l.B,{direction:"row",gap:1,children:fe?(0,n.jsx)(H.P,{color:"error",icon:"exclamation-circle",children:(0,n.jsx)(p.m,{content:se.lastNotifyAttemptError,children:(0,n.jsx)("span",{children:(0,n.jsx)(u.x6,{i18nKey:"alerting.contact-points.last-delivery-failed",children:"Last delivery attempt failed"})})})}):(0,n.jsxs)(n.Fragment,{children:[ie&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(H.P,{icon:"clock-nine",children:[(0,n.jsx)(u.x6,{i18nKey:"alerting.contact-points.last-delivery-attempt",children:"Last delivery attempt"}),(0,n.jsx)(p.m,{content:ae.toLocaleString(),children:(0,n.jsx)("span",{children:(0,n.jsx)(f.E,{color:"primary",children:ae.locale("en").fromNow()})})})]}),(0,n.jsx)(H.P,{icon:"stopwatch",children:(0,n.jsxs)(u.x6,{i18nKey:"alerting.contact-points.delivery-duration",children:["Last delivery took ",(0,n.jsx)(c.S,{content:ce})]})})]}),!ie&&(0,n.jsx)(H.P,{icon:"clock-nine",children:(0,n.jsx)(u.x6,{i18nKey:"alerting.contact-points.no-delivery-attempts",children:"No delivery attempts"})}),!oe&&(0,n.jsx)(H.P,{icon:"info-circle",children:(0,n.jsxs)(u.x6,{i18nKey:"alerting.contact-points.only-firing",children:["Delivering ",(0,n.jsx)(f.E,{color:"primary",children:"only firing"})," notifications"]})})]})})})},ne=se=>({contactPointWrapper:(0,a.css)({borderRadius:se.shape.radius.default,border:`solid 1px ${se.colors.border.weak}`,borderBottom:"none"}),integrationWrapper:(0,a.css)({position:"relative",background:`${se.colors.background.primary}`,padding:`${se.spacing(1)} ${se.spacing(1.5)}`,borderBottom:`solid 1px ${se.colors.border.weak}`}),metadataRow:(0,a.css)({borderBottomLeftRadius:`${se.shape.radius.default}`,borderBottomRightRadius:`${se.shape.radius.default}`}),noIntegrationsContainer:(0,a.css)({paddingTop:`${se.spacing(1.5)}`,paddingLeft:`${se.spacing(1.5)}`})})},3887:(te,R,e)=>{"use strict";e.d(R,{MX:()=>a,sW:()=>s,v4:()=>n});const n=Symbol("receiver_status"),a=Symbol("receiver_metadata"),s=Symbol("receiver_plugin_metadata")},76070:(te,R,e)=>{"use strict";e.d(R,{PE:()=>a,w6:()=>i});var n=e(11257);const a=[n.w.AlertingReceiversRead],s=[n.w.AlertingReceiversCreate,n.w.AlertingReceiversWrite],i=[...a,...s]},97507:(te,R,e)=>{"use strict";e.d(R,{dK:()=>z,Kt:()=>Q,$x:()=>w,om:()=>V,Z3:()=>L,Pm:()=>Z,cB:()=>Y});var n=e(96540),a=e(5709);const s=["Receiver"],r=a.H.enhanceEndpoints({addTagTypes:s}).injectEndpoints({endpoints:X=>({listNamespacedReceiver:X.query({query:I=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${I.namespace}/receivers`,params:{pretty:I.pretty,allowWatchBookmarks:I.allowWatchBookmarks,continue:I.continue,fieldSelector:I.fieldSelector,labelSelector:I.labelSelector,limit:I.limit,resourceVersion:I.resourceVersion,resourceVersionMatch:I.resourceVersionMatch,sendInitialEvents:I.sendInitialEvents,timeoutSeconds:I.timeoutSeconds,watch:I.watch}}),providesTags:["Receiver"]}),createNamespacedReceiver:X.mutation({query:I=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${I.namespace}/receivers`,method:"POST",body:I.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1Receiver,params:{pretty:I.pretty,dryRun:I.dryRun,fieldManager:I.fieldManager,fieldValidation:I.fieldValidation}}),invalidatesTags:["Receiver"]}),readNamespacedReceiver:X.query({query:I=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${I.namespace}/receivers/${I.name}`,params:{pretty:I.pretty}}),providesTags:["Receiver"]}),replaceNamespacedReceiver:X.mutation({query:I=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${I.namespace}/receivers/${I.name}`,method:"PUT",body:I.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1Receiver,params:{pretty:I.pretty,dryRun:I.dryRun,fieldManager:I.fieldManager,fieldValidation:I.fieldValidation}}),invalidatesTags:["Receiver"]}),deleteNamespacedReceiver:X.mutation({query:I=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${I.namespace}/receivers/${I.name}`,method:"DELETE",body:I.ioK8SApimachineryPkgApisMetaV1DeleteOptions,params:{pretty:I.pretty,dryRun:I.dryRun,gracePeriodSeconds:I.gracePeriodSeconds,orphanDependents:I.orphanDependents,propagationPolicy:I.propagationPolicy}}),invalidatesTags:["Receiver"]})}),overrideExisting:!1}).enhanceEndpoints({endpoints:{createNamespacedReceiver:{invalidatesTags:["Receiver","ContactPoint","ContactPointsStatus","AlertmanagerConfiguration"]},deleteNamespacedReceiver:X=>{const I=X.query;X.query=(...J)=>{const ee=I(...J);return ee.headers={"content-type":"application/json"},ee}},readNamespacedReceiver:X=>{const I={hideErrorMessage:!0};X.extraOptions=I}}});var u=e(53226),o=e(51740),l=e(52161),g=e(56476),f=e(85618),p=e(91984),c=e(77788),x=e(80218),v=e(3986),m=e(43100),y=e(15518),h=e(182),d=e(66056);const E=10*1e3,{useGetAlertmanagerConfigurationQuery:b,useGetContactPointsStatusQuery:D,useGrafanaNotifiersQuery:C,useLazyGetAlertmanagerConfigurationQuery:P}=p.m,{useGrafanaOnCallIntegrationsQuery:M}=c.WG,{useListNamespacedReceiverQuery:O,useReadNamespacedReceiverQuery:j,useDeleteNamespacedReceiverMutation:U,useCreateNamespacedReceiverMutation:W,useReplaceNamespacedReceiverMutation:B}=r,S={refetchOnFocus:!0,refetchOnReconnect:!0},_=({skip:X}={})=>{const{installed:I,loading:J}=(0,v._)((0,h.BO)()),ee=M(void 0,{skip:X||!I});return(0,n.useMemo)(()=>I?ee:{isLoading:J,data:void 0},[I,J,ee])},K=X=>({id:X.metadata.name||X.metadata.uid||X.spec.title,name:X.spec.title,provisioned:(0,g.Uo)(X),grafana_managed_receiver_configs:X.spec.integrations,metadata:X.metadata}),T=(...[X,I])=>O(X,{...I,selectFromResult:J=>{const ee=J.data?.items.map(q=>K(q));return{...J,data:J.error?[]:ee,currentData:ee}}}),L=({fetchStatuses:X,fetchPolicies:I,skip:J}={})=>{const ee=(0,f.Ge)(),q={skip:J},ne=_(q),se=C(void 0,q),oe=T({namespace:ee},q),de=D(void 0,{...S,pollingInterval:E,skip:J||!X}),fe=b(l.hY,{skip:J||!I});return(0,n.useMemo)(()=>{if(ne.isLoading||se.isLoading||oe.isLoading)return{...oe,isLoading:!0,contactPoints:[]};const ce=(0,d.Rm)({status:de.data,notifiers:se.data,onCallIntegrations:ne?.data,contactPoints:oe.data||[],alertmanagerConfiguration:fe.data});return{...oe,contactPoints:ce}},[se,fe,oe,de,ne])},A=({alertmanager:X,name:I},J)=>b(X,{...J,selectFromResult:ee=>{const q=ee.data?.alertmanager_config.receivers?.find(ne=>ne.name===I);return{...ee,data:q,currentData:q}}}),N=({name:X},I)=>{const J=(0,f.Ge)();return j({namespace:J,name:X},{...I,selectFromResult:ee=>{const q=ee.data?K(ee.data):void 0;return{...ee,data:q,currentData:q}},skip:I?.skip})},V=({alertmanager:X,name:I})=>{const J=X===l.hY,ee=N({name:I},{skip:!J}),q=A({alertmanager:X,name:I},{skip:J});return J?ee:q};function z({alertmanager:X,fetchStatuses:I,fetchPolicies:J,skip:ee}){const q=X===l.hY,ne=L({skip:ee||!q,fetchStatuses:I,fetchPolicies:J}),se=b(X,{...S,selectFromResult:oe=>({...oe,contactPoints:oe.data?(0,d.Rm)({notifiers:o.r,contactPoints:oe.data.alertmanager_config.receivers??[],alertmanagerConfiguration:oe.data}):[]}),skip:ee||q});return q?ne:se}function w({alertmanager:X}){const I=(0,g.dM)(X),[J]=(0,m.d)(),[ee]=U(),q=(0,x.Yb)(async({name:se,resourceVersion:oe})=>{const de=(0,f.Ge)();await ee({name:se,namespace:de,ioK8SApimachineryPkgApisMetaV1DeleteOptions:{preconditions:{resourceVersion:oe}}}).unwrap()}),ne=(0,x.Yb)(async({name:se})=>{const oe=(0,y.FS)(se);return J(oe)});return I?q:ne}const H=(X,I,J)=>({metadata:{...I&&{name:I},resourceVersion:J},spec:{title:X.name,integrations:X.grafana_managed_receiver_configs||[]}}),Q=({alertmanager:X})=>{const I=X===l.hY,{createOnCallIntegrations:J}=(0,u.VY)(),[ee]=W(),[q]=(0,m.d)(),ne=(0,x.Yb)(async({contactPoint:oe})=>{const de=await J(oe),fe=(0,f.Ge)(),ae=H(de);return ee({namespace:fe,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1Receiver:ae}).unwrap()}),se=(0,x.Yb)(async({contactPoint:oe})=>{const de=(0,y.BD)(oe);return q(de)});return I?ne:se},Z=({alertmanager:X})=>{const I=X===l.hY,J=(0,g.dM)(X),{createOnCallIntegrations:ee}=(0,u.VY)(),[q]=B(),[ne]=(0,m.d)();return(0,x.Yb)(async oe=>{if("resourceVersion"in oe&&J){const{contactPoint:de,id:fe,resourceVersion:ae}=oe,ce=I?await ee(de):de,ie=(0,f.Ge)(),ve=H(ce,fe,ae);return q({name:fe,namespace:ie,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1Receiver:ve}).unwrap()}else if("originalName"in oe){const{contactPoint:de,originalName:fe}=oe,ae=I?await ee(de):de,ce=(0,y.Xm)({name:fe,receiver:ae});return ne(ce)}})},Y=({alertmanager:X})=>{const[I]=P();return X===l.hY?()=>{}:async(J,ee)=>{if(!(ee&&J===ee))return I(X).unwrap().then(q=>{const{alertmanager_config:ne}=q;return!!ne.receivers?.find(oe=>oe.name===J)?`Contact point already exists with name "${J}"`:void 0})}}},8307:(te,R,e)=>{"use strict";e.d(R,{B:()=>m,G:()=>y});var n=e(74848),a=e(96540),s=e(42941),i=e(16692),r=e(92745),u=e(6975),o=e(70327),l=e(77880),g=e(25149),f=e(78102);const p=({receiverName:h,decrypt:d,exportFormat:E,onClose:b})=>{const{currentData:D="",isFetching:C}=o.hK.useExportReceiverQuery({receiverName:h,decrypt:d,format:E}),P=`cp-${h}-${new Date().getTime()}`;return C?(0,n.jsx)(u._,{text:(0,r.t)("alerting.grafana-receiver-export-preview.text-loading","Loading....")}):(0,n.jsx)(l.J,{format:E,textDefinition:D,downloadFileName:P,onClose:b})},c=({onClose:h,receiverName:d,decrypt:E})=>{const[b,D]=(0,a.useState)("yaml");return(0,n.jsx)(g.m,{activeTab:b,onTabChange:D,onClose:h,formatProviders:Object.values(f.sl),children:(0,n.jsx)(p,{receiverName:d,decrypt:E,exportFormat:b,onClose:h})})},x=({decrypt:h,exportFormat:d,onClose:E})=>{const{currentData:b="",isFetching:D}=o.hK.useExportReceiversQuery({decrypt:h,format:d}),C=`contact-points-${new Date().getTime()}`;return D?(0,n.jsx)(u._,{text:(0,r.t)("alerting.grafana-receivers-export-preview.text-loading","Loading....")}):(0,n.jsx)(l.J,{format:d,textDefinition:b,downloadFileName:C,onClose:E})},v=({onClose:h,decrypt:d})=>{const[E,b]=(0,a.useState)("yaml");return(0,n.jsx)(g.m,{activeTab:E,onTabChange:b,onClose:h,formatProviders:Object.values(f.sl),children:(0,n.jsx)(x,{decrypt:d,exportFormat:E,onClose:h})})},m=Symbol("all contact points"),y=()=>{const[h,d]=(0,a.useState)(null),[E,b]=(0,s.A)(!1),[D,C]=(0,i.L7)(i.QI.DecryptSecrets),P=D&&C,M=(0,a.useCallback)(()=>{d(null),b(!1)},[b]),O=U=>{d(U),b(!0)};return[(0,a.useMemo)(()=>!h||!E?null:h===m?(0,n.jsx)(v,{decrypt:P,onClose:M}):(0,n.jsx)(c,{receiverName:h,decrypt:P,onClose:M}),[P,E,M,h]),O]}},66056:(te,R,e)=>{"use strict";e.d(R,{Rm:()=>C,aM:()=>b,T8:()=>U});var n=e(2543),a=e(92745),s=e(56476),i=e(84266),r=e(48442);function u(W){return"grafana_managed_receiver_configs"in W?W.grafana_managed_receiver_configs??[]:Object.entries(W).filter(([S])=>S!=="grafana_managed_receiver_configs"&&S.endsWith("_configs")).filter(([S,_])=>Array.isArray(_)&&!(0,n.isEmpty)(_)).reduce((S,[_,K])=>{const T=_.replace("_configs",""),L=K.map(A=>({name:W.name,type:T,settings:A,disableResolveMessage:!1}));return S.concat(L)},[])}var o=e(6135),l=e(182),g=e(28405),f=e(58774),p=e(15645),c=e(2869);const y={title:"Grafana OnCall",icon:{[c.W.OnCall]:p,[c.W.Irm]:f,[c.W.Incident]:"",[c.W.MachineLearning]:"",[c.W.Labels]:"",[c.W.Slo]:""}[(0,l.BO)()]};function h(W,B,S=!0){const _=(0,l.ZP)()?"IRM":"OnCall";if(!S||!B.settings?.url||W===void 0)return y;if(W==null)return{...y,warning:`Grafana ${_} is not installed or is disabled`};const K=W.find(T=>T.integration_url===B.settings?.url);return{...y,description:K?.display_name,externalUrl:K?(0,g.h)((0,l.BO)(),`/integrations/${K.value}`):void 0,warning:K?void 0:`${_} Integration no longer exists`}}var d=e(3887);const E="__grafana_receiver__";function b(W){if(!W.settings)return;const{settings:B}=W;switch(W.type){case"email":{const S=B.addresses||B.to;return S?D(S):void 0}case"slack":{const S=B.recipient||B.channel;return S?`#${S.replace(/^#/,"")}`:void 0}case"kafka":return B.kafkaTopic;case"webhook":return B.url;case"jira":return(0,a.t)("alerting.contact-points.receiver-summary.jira",'Creates a "{{issueType}}" issue in the "{{project}}" project',{issueType:B.issue_type,project:B.project,url:B.api_url});case o.J4.OnCall:return W[d.sW]?.description;default:return W[d.MX]?.description}}function D(W){const S=/,|;|\n+/g,_=W.trim().split(S).map(n.trim),K=(0,n.take)(_,3),T=(0,n.difference)(_,K);return T.length&&K.push(`+${T.length} more`),K.join(", ")}function C({status:W=[],notifiers:B=[],onCallIntegrations:S,contactPoints:_,alertmanagerConfiguration:K}){const T=(0,r._I)(K?.alertmanager_config?.route??{}),L=O(T),A=(0,n.groupBy)(L,"receiver");return _.map(V=>{const z=u(V),w=W.find(Q=>Q.name===V.name),H=P(V);return{...V,id:H,policies:K&&A&&(A[V.name]??[]),grafana_managed_receiver_configs:z.map((Q,Z)=>{const Y=Q.type===o.J4.OnCall;return{...Q,[d.v4]:w?.integrations[Z],[d.MX]:j(B,Q),[d.sW]:Y?h(S,Q,!!K):void 0}})}}).sort((V,z)=>V.name.localeCompare(z.name))}function P(W){return"id"in W&&W.id?W.id:W.name}function M(W){return W.object_matchers?W.object_matchers.some(B=>B[0]===E&&B[1]===i.ho.equal)??!1:!1}function O(W){const B=W.routes?.flatMap(S=>O(S))??[];return W.receiver?[{receiver:W.receiver,route:{type:M(W)?"auto-generated":"normal"}},...B]:B}function j(W,B){const S=W.find(_=>_.type===B.type);return{name:S?.name??(0,n.upperFirst)(B.type),description:S?.description}}const U=(W,B)=>(0,s.dM)(W)&&(0,s.jw)(B)},77880:(te,R,e)=>{"use strict";e.d(R,{J:()=>m});var n=e(74848),a=e(22803),s=e(4213),i=e.n(s),r=e(96540),u=e(70713),o=e(92745),l=e(63142),g=e(50992),f=e(45861),p=e(47931),c=e(89640),x=e(34999),v=e(78102);function m({format:d,textDefinition:E,downloadFileName:b,onClose:D}){const C=(0,l.of)(y),P=v.sl[d],M=(0,r.useCallback)(()=>{const j=new Blob([E],{type:`application/${d};charset=utf-8`});i()(j,`${b}.${d}`)},[E,b,d]),O=(0,r.useMemo)(()=>P.formatter?P.formatter(E):E,[P,E]);return(0,n.jsxs)("div",{className:C.container,children:[(0,n.jsx)(h,{exportProvider:P}),(0,n.jsx)("div",{className:C.content,children:(0,n.jsx)(u.Ay,{disableWidth:!0,children:({height:j})=>(0,n.jsx)(g.B,{width:"100%",height:j,language:d,value:O,monacoOptions:{minimap:{enabled:!1},scrollBeyondLastLine:!1,lineNumbers:"on",readOnly:!0}})})}),(0,n.jsxs)("div",{className:C.actions,children:[(0,n.jsx)(f.$n,{variant:"secondary",onClick:D,children:(0,n.jsx)(o.x6,{i18nKey:"alerting.common.cancel",children:"Cancel"})}),(0,n.jsx)(p.b,{icon:"copy",getText:()=>E,children:(0,n.jsx)(o.x6,{i18nKey:"alerting.file-export-preview.copy-code",children:"Copy code"})}),(0,n.jsx)(f.$n,{icon:"download-alt",onClick:M,children:(0,n.jsx)(o.x6,{i18nKey:"alerting.file-export-preview.download",children:"Download"})})]})]})}const y=d=>({container:(0,a.css)({display:"flex",flexDirection:"column",height:"100%",gap:d.spacing(2)}),content:(0,a.css)({flex:"1 1 100%"}),actions:(0,a.css)({flex:0,justifyContent:"flex-end",display:"flex",gap:d.spacing(1)})});function h({exportProvider:d}){const{name:E,type:b}=d,D={file:{title:(0,o.t)("alerting.file-export-inline-documentation.export-inline-doc.title.fileprovisioning-format","File-provisioning format"),component:(0,n.jsxs)(o.x6,{i18nKey:"alerting.file-export-inline-documentation.file-provisioning",children:[{name:E}," format is only valid for File Provisioning."," ",(0,n.jsx)(c.Y,{href:"https://grafana.com/docs/grafana/latest/alerting/set-up/provision-alerting-resources/file-provisioning/",external:!0,children:"Read more in the docs."})]})},api:{title:(0,o.t)("alerting.file-export-inline-documentation.export-inline-doc.title.apiprovisioning-format","API-provisioning format"),component:(0,n.jsxs)(o.x6,{i18nKey:"alerting.file-export-inline-documentation.api-provisioning",children:[{name:E}," format is only valid for API Provisioning."," ",(0,n.jsx)(c.Y,{href:"https://grafana.com/docs/grafana/latest/alerting/set-up/provision-alerting-resources/http-api-provisioning/",external:!0,children:"Read more in the docs."})]})},terraform:{title:(0,o.t)("alerting.file-export-inline-documentation.export-inline-doc.title.terraformprovisioning-format","Terraform-provisioning format"),component:(0,n.jsxs)(o.x6,{i18nKey:"alerting.file-export-inline-documentation.terraform-provisioning",children:[{name:E}," format is only valid for Terraform Provisioning."," ",(0,n.jsx)(c.Y,{href:"https://grafana.com/docs/grafana/latest/alerting/set-up/provision-alerting-resources/terraform-provisioning/",external:!0,children:"Read more in the docs."})]})}},{title:C,component:P}=D[b];return(0,n.jsx)(x.F,{title:C,severity:"info",bottomSpacing:0,topSpacing:0,children:P})}},25149:(te,R,e)=>{"use strict";e.d(R,{m:()=>r});var n=e(74848),a=e(92745),s=e(8207),i=e(29855);function r({activeTab:u,onTabChange:o,children:l,onClose:g,formatProviders:f,title:p="Export"}){const c=Object.values(f).map(v=>({label:v.name,value:v.exportFormat})),x=f.length>1?(0,a.t)("alerting.export.subtitle.formats","Select the format and download the file or copy the contents to clipboard"):(0,a.t)("alerting.export.subtitle.one-format","Download the file or copy the contents to clipboard");return(0,n.jsx)(s._,{title:p,subtitle:x,tabs:(0,n.jsx)(i.sb,{tabs:c,setActiveTab:o,activeTab:u}),onClose:g,size:"md",children:l})}},78102:(te,R,e)=>{"use strict";e.d(R,{dX:()=>s,sl:()=>i});const n={name:"JSON",exportFormat:"json",type:"file",formatter:u=>{try{return JSON.stringify(JSON.parse(u),null,4)}catch{return u}}},a={name:"YAML",exportFormat:"yaml",type:"file"},s={name:"Terraform (HCL)",exportFormat:"hcl",type:"terraform"},i={[n.exportFormat]:n,[a.exportFormat]:a,[s.exportFormat]:s},r=[n,a]},51993:(te,R,e)=>{"use strict";e.d(R,{GX:()=>N,r4:()=>L});var n=e(74848),a=e(22803),s=e(2543),i=e.n(s),r=e(96540),u=e(49785),o=e(28105),l=e(1906),g=e(17503),f=e(80011),p=e(92745),c=e(63142),x=e(34999),v=e(41654),m=e(45861),y=e(33033),h=e(76319),d=e(66404),E=e(91073),b=e(18203),D=e(89931),C=e(4652),P=e(32576),M=e(38610),O=e(4651),j=e(24619),U=e(74048),W=e(29609),B=e(38055),S=e(49779),_=e(65420),K=e(38076),T=e(88589);const L=({queries:ee=[],query:q,data:ne,error:se,warning:oe,isAlertCondition:de,onSetCondition:fe,onUpdateRefId:ae,onRemoveExpression:ce,onUpdateExpressionType:ie,onChangeQuery:ve})=>{const le=(0,c.of)(J),Ee=q?.type,{setError:Re,clearErrors:Oe,watch:Se}=(0,u.xW)(),Te=Se("type"),_e=Te?(0,W.pq)(Te):!1,He=(0,r.useCallback)(Xe=>{Xe?Re("queries",{type:"custom",message:Xe}):Oe("queries")},[Re,Oe]),tt=ne&&Object.values(ne).some(Xe=>!!Xe&&Xe.state===o.Gu.Loading),Je=Array.isArray(ne?.series)&&!tt,Ge=ne?.series??[],je=de??!1,{seriesCount:Fe,groupedByState:Be}=z(Ge),Ke=(0,r.useCallback)(Xe=>{const nt=ee.filter(he=>Xe.refId!==he.refId).map(he=>({value:he.refId,label:he.refId}));switch(Xe.type){case O.Tz.math:return(0,n.jsx)(b.z,{onChange:ve,query:Xe,labelWidth:"auto",onRunQuery:()=>{}});case O.Tz.reduce:return(0,n.jsx)(D.Z,{onChange:ve,refIds:nt,labelWidth:"auto",app:l.Jk.UnifiedAlerting,query:Xe});case O.Tz.resample:return(0,n.jsx)(C.C,{onChange:ve,query:Xe,labelWidth:"auto",refIds:nt});case O.Tz.classic:return(0,n.jsx)(E.z,{onChange:ve,query:Xe,refIds:nt});case O.Tz.threshold:return(0,n.jsx)(M.O,{onChange:ve,query:Xe,labelWidth:"auto",refIds:nt,onError:He,useHysteresis:!0});case O.Tz.sql:return(0,n.jsx)(P.k,{onChange:he=>ve(he),query:Xe,refIds:nt,alerting:!0});default:return(0,n.jsxs)(p.x6,{i18nKey:"alerting.expression.not-supported",values:{expression:Xe.type},children:["Expression not supported: ","{{expression}}"]})}},[ve,ee,He]),we=O.uQ.find(Xe=>Xe.value===Ee)?.description??"";return(0,n.jsx)("div",{className:(0,a.cx)(le.expression.wrapper,je&&le.expression.alertCondition,Ee===O.Tz.classic&&le.expression.classic,Ee!==O.Tz.classic&&le.expression.nonClassic),children:(0,n.jsxs)("div",{className:le.expression.stack,children:[(0,n.jsx)(w,{refId:q.refId,queryType:Ee,onRemoveExpression:()=>ce(q.refId),onUpdateRefId:Xe=>ae(q.refId,Xe),onSetCondition:fe,query:q,alertCondition:je}),(0,n.jsxs)("div",{className:le.expression.body,children:[se&&(0,n.jsx)(x.F,{title:(0,p.t)("alerting.expression.title-expression-failed","Expression failed"),severity:"error",children:se.message}),oe&&(0,n.jsx)(x.F,{title:(0,p.t)("alerting.expression.title-expression-warning","Expression warning"),severity:"warning",children:oe.message}),(0,n.jsx)("div",{className:le.expression.description,children:we}),Ke(q)]}),Je&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(N,{series:Ge,isAlertCondition:de,isRecordingRule:_e}),!_e&&(0,n.jsx)("div",{className:le.footer,children:(0,n.jsxs)(v.B,{direction:"row",alignItems:"center",children:[(0,n.jsx)(S.h,{}),(0,n.jsx)(V,{isCondition:!!de,firing:Be[j.cF.Firing].length,normal:Be[j.cF.Inactive].length,seriesCount:Fe})]})})]})]})})},A=20,N=({series:ee,isAlertCondition:q,isRecordingRule:ne=!1})=>{const{pageItems:se,previousPage:oe,nextPage:de,numberOfPages:fe,pageStart:ae,pageEnd:ce}=(0,U.W)(ee,1,A),ie=(0,c.of)(J),ve=(0,T.PI)(ee),le=!ve&&(0,g.jq)(ee),Ee=fe>1;return(0,n.jsxs)("div",{className:ie.expression.results,children:[!ve&&le&&(0,n.jsx)("div",{children:se.map((Re,Oe)=>(0,n.jsx)(I,{frame:Re,index:ae+Oe,isAlertCondition:q},(0,s.uniqueId)()))}),!ve&&!le&&se.map((Re,Oe)=>(0,n.jsx)(X,{frame:Re,index:ae+Oe,isAlertCondition:q,isRecordingRule:ne},(0,s.uniqueId)())),ve&&(0,n.jsx)("div",{className:(0,a.cx)(ie.expression.noData,ie.mutedText),children:(0,n.jsx)(p.x6,{i18nKey:"alerting.expression-result.no-data",children:"No data"})}),Ee&&(0,n.jsx)("div",{className:ie.pagination.wrapper,"data-testid":"paginate-expression",children:(0,n.jsxs)(v.B,{children:[(0,n.jsx)(m.$n,{variant:"secondary",fill:"outline",onClick:oe,icon:"angle-left",size:"sm","aria-label":(0,p.t)("alerting.expression-result.aria-label-previouspage","previous-page")}),(0,n.jsx)(S.h,{}),(0,n.jsx)("span",{className:ie.mutedText,children:(0,n.jsxs)(p.x6,{i18nKey:"alerting.expression-result.page-counter",values:{pageStart:ae,pageEnd:ce,numPages:ee.length},children:["{{pageStart}}"," - ","{{pageEnd}}"," of ","{{numPages}}"]})}),(0,n.jsx)(S.h,{}),(0,n.jsx)(m.$n,{variant:"secondary",fill:"outline",onClick:de,icon:"angle-right",size:"sm","aria-label":(0,p.t)("alerting.expression-result.aria-label-nextpage","next-page")})]})})]})},V=({firing:ee,normal:q,isCondition:ne,seriesCount:se})=>{const{mutedText:oe}=(0,c.of)(J);return se===0?(0,n.jsx)("span",{className:oe,children:(0,n.jsx)(p.x6,{i18nKey:"alerting.preview-summary.no-series",children:"No series"})}):ne?(0,n.jsx)("span",{className:oe,children:`${se} series: ${ee} firing, ${q} normal`}):(0,n.jsx)("span",{className:oe,children:`${se} series`})};function z(ee){const q=ee.filter(oe=>(0,T.Lm)(oe)===void 0).length,ne={[j.cF.Firing]:ee.filter(oe=>(0,T.Lm)(oe)!==void 0&&(0,T.Lm)(oe)!==0),[j.cF.Inactive]:ee.filter(oe=>(0,T.Lm)(oe)===0)},se=ee.length-q;return{groupedByState:ne,seriesCount:se}}const w=({refId:ee,queryType:q,onUpdateRefId:ne,onRemoveExpression:se,onSetCondition:oe,alertCondition:de,query:fe})=>{const ae=(0,c.of)(J),ce=(0,c.of)(m.my),[ie,ve]=(0,r.useState)(!1),Ee=ie!==!1&&ie==="refId";return(0,n.jsx)("header",{className:ae.header.wrapper,children:(0,n.jsxs)(v.B,{direction:"row",gap:.5,alignItems:"center",children:[(0,n.jsxs)(v.B,{direction:"row",gap:1,alignItems:"center",children:[!Ee&&(0,n.jsx)("button",{type:"button",className:(0,a.cx)(ce,ae.editable),onClick:()=>ve("refId"),children:(0,n.jsx)("div",{className:ae.expression.refId,children:ee})}),Ee&&(0,n.jsx)(y.D,{autoFocus:!0,defaultValue:ee,minWidth:5,onFocus:Re=>Re.target.select(),onBlur:Re=>{ne(Re.currentTarget.value),ve(!1)}}),(0,n.jsx)("div",{children:(0,O.NI)(q)})]}),(0,n.jsx)(S.h,{}),(0,n.jsx)(K.a,{refId:ee,onSetCondition:()=>oe(fe.refId),isCondition:de}),(0,n.jsx)(h.K,{name:"trash-alt",variant:"secondary",className:ae.mutedIcon,onClick:se,tooltip:(0,p.t)("alerting.header.tooltip-remove",'Remove expression "{{refId}}"',{refId:ee})})]})})},H=()=>(0,n.jsx)("span",{children:"{"}),Q=()=>(0,n.jsx)("span",{children:"}"}),Z=()=>(0,n.jsx)("span",{children:'"'}),Y=()=>(0,n.jsx)("span",{children:"="});function X({frame:ee,index:q,isAlertCondition:ne,isRecordingRule:se}){const oe=(0,c.of)(J),de=(0,T.Jw)(ee)||"Series "+q,fe=(0,T.Lm)(ee),ae=(0,T.JQ)(ee),ce=Object.entries(ae),ie=ce.length>0,ve=ne&&fe!==0,le=ne&&fe===0,Ee=`${ie?"":de}${ie?`{${(0,T.h6)(ae)}}`:""}`,Re=!se;return(0,n.jsx)("div",{className:oe.expression.resultsRow,children:(0,n.jsxs)(v.B,{direction:"row",gap:1,alignItems:"center",children:[(0,n.jsx)("div",{className:oe.expression.resultLabel,title:Ee,children:(0,n.jsx)(d.E,{variant:"code",children:ie?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(H,{}),ce.map(([Oe,Se],Te)=>(0,n.jsxs)(d.E,{variant:"body",children:[(0,n.jsx)("span",{className:oe.expression.labelKey,children:Oe}),(0,n.jsx)(Y,{}),(0,n.jsx)(Z,{}),(0,n.jsx)("span",{className:oe.expression.labelValue,children:Se}),(0,n.jsx)(Z,{}),Te<ce.length-1&&(0,n.jsx)("span",{children:", "})]},(0,s.uniqueId)())),(0,n.jsx)(Q,{})]}):(0,n.jsx)("span",{className:oe.expression.labelKey,children:Ee})})}),(0,n.jsx)("div",{className:oe.expression.resultValue,children:(0,T.Cs)(fe)}),Re&&(0,n.jsxs)(n.Fragment,{children:[ve&&(0,n.jsx)(_.C,{state:j.cF.Firing,size:"sm"}),le&&(0,n.jsx)(_.C,{state:j.cF.Inactive,size:"sm"})]})]})})}const I=({frame:ee,index:q})=>{const ne=(0,c.of)(J),se=ee.fields[1],oe=se.labels,fe=se.config?.displayNameFromDS??(oe?(0,T.h6)(se.labels??{}):"Series "+q),ae=ee.fields[0].values,ce=ve=>ee.fields[0].values[ve],ie=ve=>ee.fields[1].values[ve];return(0,n.jsx)("div",{className:ne.expression.resultsRow,children:(0,n.jsxs)(v.B,{direction:"row",alignItems:"center",children:[(0,n.jsx)("span",{className:(0,a.cx)(ne.mutedText,ne.expression.resultLabel),title:fe,children:fe}),(0,n.jsx)("div",{className:ne.expression.resultValue,children:(0,n.jsx)(B.B,{placement:"right",wrapperClassName:ne.timeseriesTableWrapper,content:(0,n.jsxs)("table",{className:ne.timeseriesTable,children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:(0,n.jsx)(p.x6,{i18nKey:"alerting.timeseries-row.timestamp",children:"Timestamp"})}),(0,n.jsx)("th",{children:(0,n.jsx)(p.x6,{i18nKey:"alerting.timeseries-row.value",children:"Value"})})]})}),(0,n.jsx)("tbody",{children:ae.map((ve,le)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:ne.mutedText,children:(0,f.LE)(ce(le))}),(0,n.jsx)("td",{className:ne.expression.resultValue,children:ie(le)})]},le))})]}),children:(0,n.jsx)("span",{children:(0,n.jsx)(p.x6,{i18nKey:"alerting.timeseries-row.time-series-data",children:"Time series data"})})})})]})})},J=ee=>({expression:{wrapper:(0,a.css)({display:"flex",border:`solid 1px ${ee.colors.border.medium}`,flex:1,flexBasis:"400px",borderRadius:ee.shape.radius.default}),stack:(0,a.css)({display:"flex",flexDirection:"column",flexWrap:"nowrap",gap:0,width:"100%",minWidth:"0"}),classic:(0,a.css)({maxWidth:"100%"}),nonClassic:(0,a.css)({maxWidth:"640px"}),alertCondition:(0,a.css)({}),body:(0,a.css)({padding:ee.spacing(1),flex:1}),description:(0,a.css)({marginBottom:ee.spacing(1),fontSize:ee.typography.size.xs,color:ee.colors.text.secondary}),refId:(0,a.css)({fontWeight:ee.typography.fontWeightBold,color:ee.colors.primary.text}),results:(0,a.css)({display:"flex",flexDirection:"column",flexWrap:"nowrap",borderTop:`solid 1px ${ee.colors.border.medium}`}),noResults:(0,a.css)({display:"flex",alignItems:"center",justifyContent:"center"}),resultsRow:(0,a.css)({padding:`${ee.spacing(.75)} ${ee.spacing(1)}`,"&:nth-child(odd)":{backgroundColor:ee.colors.background.secondary},"&:hover":{backgroundColor:ee.colors.background.canvas}}),labelKey:(0,a.css)({color:ee.isDark?"#73bf69":"#56a64b"}),labelValue:(0,a.css)({color:ee.isDark?"#ce9178":"#a31515"}),resultValue:(0,a.css)({textAlign:"right"}),resultLabel:(0,a.css)({flex:1,overflowX:"auto",display:"inline-block",whiteSpace:"nowrap"}),noData:(0,a.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:ee.spacing()})},mutedText:(0,a.css)({color:ee.colors.text.secondary,fontSize:"0.9em",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),header:{wrapper:(0,a.css)({background:ee.colors.background.secondary,padding:`${ee.spacing(.5)} ${ee.spacing(1)}`,borderBottom:`solid 1px ${ee.colors.border.weak}`})},footer:(0,a.css)({background:ee.colors.background.secondary,padding:ee.spacing(1),borderTop:`solid 1px ${ee.colors.border.weak}`}),draggableIcon:(0,a.css)({cursor:"grab"}),mutedIcon:(0,a.css)({color:ee.colors.text.secondary}),editable:(0,a.css)({padding:`${ee.spacing(.5)} ${ee.spacing(1)}`,border:`solid 1px ${ee.colors.border.weak}`,borderRadius:ee.shape.radius.default,display:"flex",flexDirection:"row",alignItems:"center",gap:ee.spacing(1),cursor:"pointer"}),timeseriesTableWrapper:(0,a.css)({maxHeight:"500px",overflowY:"scroll"}),timeseriesTable:(0,a.css)({tableLayout:"auto",width:"100%",height:"100%","td, th":{padding:ee.spacing(1)},td:{background:ee.colors.background.primary},th:{background:ee.colors.background.secondary},tr:{borderBottom:`1px solid ${ee.colors.border.medium}`,"&:last-of-type":{borderBottom:"none"}}}),pagination:{wrapper:(0,a.css)({borderTop:`1px solid ${ee.colors.border.medium}`,padding:ee.spacing()})}})},38076:(te,R,e)=>{"use strict";e.d(R,{a:()=>l});var n=e(74848),a=e(22803),s=e(49785),i=e(63142),r=e(99887),u=e(45861),o=e(29609);const l=({isCondition:f,onSetCondition:p,refId:c})=>{const x=(0,i.of)(g),{watch:v}=(0,s.xW)(),m=v("type"),y=m?(0,o.pq)(m):!1,h=y?"Recording rule output":"Alert condition",d=c?`Set "${c}" as alert condition`:"Set as alert condition",E=y?"Set as recording rule output":d;return f?(0,n.jsx)(r.E,{color:"green",icon:"check",text:h},"condition"):(0,n.jsx)("button",{type:"button",className:x.actionLink,onClick:()=>p&&p(),children:E},"make-condition")},g=f=>{const p=(0,u.my)(f);return{actionLink:(0,a.css)(p,{color:f.colors.text.link,cursor:"pointer","&:hover":{textDecoration:"underline"}})}}},88589:(te,R,e)=>{"use strict";e.d(R,{Cs:()=>l,EL:()=>p,JQ:()=>g,Jw:()=>r,Lm:()=>u,PI:()=>x,h6:()=>f});var n=e(2543),a=e.n(n),s=e(79243),i=e(52161);const r=v=>{const m=v.fields.at(0);return m?.config?.displayNameFromDS??v.name??m?.labels?.__name__},u=v=>v.fields.at(0)?.values.at(0),o=new Intl.NumberFormat(void 0,{maximumSignificantDigits:5}),l=v=>Number.isFinite(v)&&typeof v=="number"?Math.abs(v)<1?o.format(v):(0,s.h)(v,5).toString(10):String(v),g=v=>v.fields[0]?.labels??{},f=v=>Object.entries(v).map(([m,y])=>m+"="+y).join(", "),p=v=>{const m=v.name;if((0,i.Eb)(v.rulesSource))return{name:m,parents:[]};try{const y=JSON.parse(m);if(!Array.isArray(y))throw new Error("not a nested Grafana folder");const h=(0,n.last)(y)??m,d=(0,n.dropRight)(y,1);return{name:h,parents:d}}catch{return{name:v.name,parents:[]}}},c=(v,m=[])=>JSON.stringify(m.concat(v)),x=v=>v.every(y=>y.fields.every(h=>h.values.every(d=>d==null)))},66513:(te,R,e)=>{"use strict";e.d(R,{GK:()=>i,Zr:()=>s,xK:()=>a});var n=e(11257);const a=[n.w.AlertingTimeIntervalsRead],s=[n.w.AlertingTimeIntervalsWrite],i=[...a,...s]},92125:(te,R,e)=>{"use strict";e.d(R,{s:()=>f});var n=e(74848),a=e(22803),s=e(2543),i=e.n(s),r=e(63142),u=e(41654),o=e(48542),l=e(63895),g=e(38055);const f=({matchers:x,formatter:v="default"})=>{const m=(0,r.of)(c),y=5,h=(0,s.take)(x,y),d=(0,s.takeRight)(x,x.length-y),E=d.length>0;return(0,n.jsx)("span",{"data-testid":"label-matchers",children:(0,n.jsxs)(u.B,{direction:"row",gap:1,alignItems:"center",wrap:"wrap",children:[h.map(b=>(0,n.jsx)(p,{matcher:b,formatter:v},(0,s.uniqueId)())),E&&(0,n.jsx)(g.B,{arrow:!0,placement:"top",content:(0,n.jsx)(n.Fragment,{children:d.map(b=>(0,n.jsx)(p,{matcher:b},(0,s.uniqueId)()))}),children:(0,n.jsx)("span",{children:(0,n.jsx)("div",{className:m.metadata,children:`and ${d.length} more`})})})]})})},p=({matcher:x,formatter:v="default"})=>{const m=(0,r.of)(c);return(0,n.jsx)("div",{className:m.matcher(x[0]).wrapper,children:(0,n.jsx)(u.B,{direction:"row",gap:0,alignItems:"baseline",children:l.t8[v](x)})})},c=x=>({matcher:v=>{const{color:m,borderColor:y}=(0,o.MC)(v);return{wrapper:(0,a.css)({color:"#fff",background:m,padding:`${x.spacing(.33)} ${x.spacing(.66)}`,fontSize:x.typography.bodySmall.fontSize,border:`solid 1px ${y}`,borderRadius:x.shape.borderRadius(2),whiteSpace:"pre"})}},metadata:(0,a.css)({color:x.colors.text.secondary,fontSize:x.typography.bodySmall.fontSize,fontWeight:x.typography.bodySmall.fontWeight})})},42004:(te,R,e)=>{"use strict";e.d(R,{PE:()=>J,OJ:()=>Ee});var n=e(74848),a=e(22803),s=e(2543),i=e(55127),r=e.n(i),u=e(96540),o=e(42941),l=e(92745),g=e(63142),f=e(41654),p=e(76319),c=e(45861),x=e(88559),v=e(87063),m=e(66404),y=e(45967),h=e(99887),d=e(30703),E=e(89640),b=e(48542),D=e(10427),C=e(27691),P=e(16194),M=e(24961),O=e(84266),j=e(16692),U=e(86017),W=e(63895),B=e(77256),S=e(48442),_=e(24898),K=e(38055),T=e(78793),L=e(1625),A=e(1972),N=e(49779),V=e(6975),z=e(70327),w=e(77880),H=e(25149),Q=e(78102);const Z=({exportFormat:He,onClose:tt})=>{const{currentData:Je="",isFetching:Ge}=z.hK.useExportPoliciesQuery({format:He}),je=`policies-${new Date().getTime()}`;return Ge?(0,n.jsx)(V._,{text:(0,l.t)("alerting.grafana-policies-exporter-preview.text-loading","Loading....")}):(0,n.jsx)(w.J,{format:He,textDefinition:Je,downloadFileName:je,onClose:tt})},Y=({onClose:He})=>{const[tt,Je]=(0,u.useState)("yaml");return(0,n.jsx)(H.m,{activeTab:tt,onTabChange:Je,onClose:He,formatProviders:Object.values(Q.sl),children:(0,n.jsx)(Z,{exportFormat:tt,onClose:He})})};var X=e(92125);const I=20,J=He=>{const{receivers:tt=[],contactPointsState:Je,readOnly:Ge=!1,provisioned:je=!1,alertManagerSourceName:Fe,currentRoute:Be,inheritedProperties:Ke,routesMatchingFilters:Ue={filtersApplied:!1,matchedRoutesWithPath:new Map},matchingInstancesPreview:we={enabled:!1},onEditPolicy:Xe,onAddPolicy:nt,onDeletePolicy:he,onShowAlertInstances:xe,isAutoGenerated:me=!1,isDefaultPolicy:ye=!1}=He,De=(0,g.of)(_e),Le=Be.receiver,Ve=Be.continue??!1,ze=(0,W.J$)(Be),Ze=!!(ze&&ze.length),{filtersApplied:Me,matchedRoutesWithPath:$e}=Ue,at=Array.from($e.keys()),ct=Me&&at.some(Jn=>Jn.id===Be.id),ft=Array.from($e.values()).flat(),Et=ft.some(Jn=>Jn.id===Be.id),St=[],Pt=!Ze&&!ye&&!Ve,Dt=Le??Ke?.receiver??"",Ye=Je?Oe(Dt,Je):[],mt=Be.routes??[],zt=Me?mt.filter(Jn=>ft.some(Da=>Da.id===Jn.id)):mt,Jt=zt.length>0,[Xt,En]=(0,o.A)(!1),ln=we?.groupsMap?.get(Be.id),cn=ln?(0,s.sumBy)(ln,Jn=>Jn.alerts.length):void 0,[Pn,wn]=(0,j.L7)(j.QI.ViewAutogeneratedPolicyTree),jn=se(Be),[kn,gt]=(0,o.A)(!jn),Lt=Be.group_by,Rt=Be.mute_time_intervals??[],Ut=Be.active_time_intervals??[],Gt={group_wait:Be.group_wait,group_interval:Be.group_interval,repeat_interval:Be.repeat_interval};Ye.forEach(Jn=>{St.push(Jn)});const[Ft,_t]=(0,u.useState)(I),tn=q(me,ye,je,Xe,Be,En,he);if(me&&(!wn||!Pn)||Me&&!Et)return null;const An=ye||jn,ia=zt.filter(Jn=>ft.some(Da=>Da.id===Jn.id)),ca=Me?ia:zt,ea=ca.slice(0,Ft),Ca=ca.length-ea.length,oa=Ca>0;return(0,n.jsxs)(f.B,{direction:"column",gap:1.5,children:[(0,n.jsxs)("div",{className:De.policyWrapper(ct),"data-testid":ye?"am-root-route-container":"am-route-container",children:[Ve&&(0,n.jsx)(fe,{}),Pt&&(0,n.jsx)(ae,{}),(0,n.jsx)("div",{className:De.policyItemWrapper,children:(0,n.jsxs)(f.B,{direction:"column",gap:1,children:[(0,n.jsx)("div",{children:(0,n.jsxs)(f.B,{direction:"row",alignItems:"center",gap:1,children:[Jt?(0,n.jsx)(p.K,{name:kn?"angle-down":"angle-right",onClick:gt,"aria-label":kn?(0,l.t)("alerting.policies.aria-label-collapse","Collapse"):(0,l.t)("alerting.policies.aria-label-expand","Expand")}):null,An&&(0,n.jsx)(n.Fragment,{children:jn?(0,n.jsx)(ie,{}):(0,n.jsx)(ce,{})}),!An&&(0,n.jsx)(n.Fragment,{children:Ze?(0,n.jsx)(X.s,{matchers:ze??[],formatter:(0,U.VE)(Fe)}):(0,n.jsx)("span",{className:De.metadata,children:(0,n.jsx)(l.x6,{i18nKey:"alerting.policies.no-matchers",children:"No matchers"})})}),(0,n.jsx)(N.h,{}),St.length>0&&(0,n.jsx)(de,{errors:St}),je&&(0,n.jsx)(A.rS,{}),(0,n.jsxs)(f.B,{direction:"row",gap:.5,children:[!me&&!Ge&&(0,n.jsx)(_._,{actions:[j.QI.CreateNotificationPolicy],children:(0,n.jsx)(D.A,{shouldWrap:je,wrap:oe,children:ye?(0,n.jsx)(c.$n,{variant:"secondary",icon:"plus",size:"sm",disabled:je,type:"button",onClick:()=>nt(Be,"child"),children:(0,n.jsx)(l.x6,{i18nKey:"alerting.policies.new-child",children:"New child policy"})}):(0,n.jsx)(x.m,{overlay:(0,n.jsxs)(v.W,{children:[(0,n.jsx)(v.W.Item,{label:(0,l.t)("alerting.policy.label-new-sibling-above","New sibling above"),icon:"arrow-up",onClick:()=>nt(Be,"above")}),(0,n.jsx)(v.W.Item,{label:(0,l.t)("alerting.policy.label-new-sibling-below","New sibling below"),icon:"arrow-down",onClick:()=>nt(Be,"below")}),(0,n.jsx)(v.W.Divider,{}),(0,n.jsx)(v.W.Item,{label:(0,l.t)("alerting.policy.label-new-child-policy","New child policy"),icon:"plus",onClick:()=>nt(Be,"child")})]}),children:(0,n.jsx)(c.$n,{size:"sm",variant:"secondary",disabled:je,icon:"angle-down",type:"button",children:(0,n.jsx)(l.x6,{i18nKey:"alerting.policies.new-policy",children:"Add new policy"})})})})}),tn.length>0&&(0,n.jsx)(x.m,{overlay:(0,n.jsx)(v.W,{children:tn}),children:(0,n.jsx)(C.A,{"aria-label":ye?(0,l.t)("alerting.policies.aria-label-more-default","more actions for default policy"):(0,l.t)("alerting.policies.aria-label-more","more actions for policy"),"data-testid":"more-actions"})})]})]})}),(0,n.jsx)(ee,{matchingInstancesPreview:we,numberOfAlertInstances:cn,contactPoint:Le??void 0,groupBy:Lt,muteTimings:Rt,activeTimings:Ut,timingOptions:Gt,inheritedProperties:Ke,alertManagerSourceName:Fe,receivers:tt,matchingAlertGroups:ln,matchers:ze,isDefaultPolicy:ye,onShowAlertInstances:xe})]})})]}),(0,n.jsx)("div",{className:De.childPolicies,children:kn&&(0,n.jsxs)(n.Fragment,{children:[ea.map(Jn=>{const Da=(0,S.W$)(Be,Jn,Ke),Fa=se(Jn)||me,Xn=Ge||je||me;return(0,n.jsx)(J,{currentRoute:Jn,receivers:tt,contactPointsState:Je,readOnly:Xn,inheritedProperties:Da,onAddPolicy:nt,onEditPolicy:Xe,onDeletePolicy:he,onShowAlertInstances:xe,alertManagerSourceName:Fe,routesMatchingFilters:Ue,matchingInstancesPreview:we,isAutoGenerated:Fa,provisioned:je},Jn.id)}),oa&&(0,n.jsx)(c.$n,{size:"sm",icon:"angle-down",variant:"secondary",className:De.moreButtons,onClick:()=>_t(Ft+I),children:(0,n.jsxs)(l.x6,{i18nKey:"alerting.policies.n-more-policies",count:Ca,children:[{count:Ca}," additional policies"]})})]})}),Xt&&(0,n.jsx)(Y,{onClose:En})]})};function ee({numberOfAlertInstances:He,isDefaultPolicy:tt,timingOptions:Je,groupBy:Ge,muteTimings:je=[],activeTimings:Fe=[],matchingInstancesPreview:Be,inheritedProperties:Ke,matchingAlertGroups:Ue,onShowAlertInstances:we,matchers:Xe,contactPoint:nt,alertManagerSourceName:he,receivers:xe}){const me=(0,g.of)(_e),ye=Ke&&Ke.group_by,De=Ke&&Object.keys(Ke).length>0,Le=(0,s.isArray)(Ge)&&Ge[0]==="...",Ve=!Le&&(0,s.isArray)(Ge)&&Ge.length>0,ze=tt&&(0,s.isArray)(Ge)&&Ge.length===0,Ze=!!je.length,Me=!!Fe.length;return(0,n.jsx)("div",{className:me.metadataRow,children:(0,n.jsxs)(f.B,{direction:"row",alignItems:"center",gap:1,children:[Be.enabled&&(0,n.jsxs)(L.P,{icon:"layers-alt",onClick:()=>{Ue&&we(Ue,Xe,(0,U.VE)(he))},"data-testid":"matching-instances",children:[(0,n.jsx)(m.E,{color:"primary",children:He??"-"}),(0,n.jsx)("span",{children:(0,n.jsx)(l.x6,{i18nKey:"alerting.policies.metadata.n-instances",count:He??0,children:"instance"})})]}),nt&&(0,n.jsxs)(L.P,{icon:"at","data-testid":"contact-point",children:[(0,n.jsxs)("span",{children:[(0,n.jsx)(l.x6,{i18nKey:"alerting.policies.metadata.delivered-to",children:"Delivered to"})," "]}),(0,n.jsx)(Re,{alertManagerSourceName:he,receivers:xe,contactPoint:nt})]}),!ye&&(0,n.jsxs)(n.Fragment,{children:[Ve&&(0,n.jsxs)(L.P,{icon:"layer-group","data-testid":"grouping",children:[(0,n.jsxs)("span",{children:[(0,n.jsx)(l.x6,{i18nKey:"alerting.policies.metadata.grouped-by",children:"Grouped by"})," "]}),(0,n.jsx)(m.E,{color:"primary",children:Ge.join(", ")})]}),ze&&(0,n.jsx)(L.P,{icon:"layer-group",children:(0,n.jsx)("span",{children:(0,n.jsx)(l.x6,{i18nKey:"alerting.policies.metadata.grouping.single-group",children:"Single group"})})}),Le&&(0,n.jsx)(L.P,{icon:"layer-group",children:(0,n.jsx)("span",{children:(0,n.jsx)(l.x6,{i18nKey:"alerting.policies.metadata.grouping.none",children:"Not grouping"})})})]}),Ze&&(0,n.jsxs)(L.P,{icon:"calendar-slash","data-testid":"mute-timings",children:[(0,n.jsxs)("span",{children:[(0,n.jsx)(l.x6,{i18nKey:"alerting.policies.metadata.mute-time",children:"Muted when"})," "]}),(0,n.jsx)(le,{timings:je,alertManagerSourceName:he})]}),Me&&(0,n.jsxs)(L.P,{icon:"calendar-alt","data-testid":"active-timings",children:[(0,n.jsxs)("span",{children:[(0,n.jsx)(l.x6,{i18nKey:"alerting.policies.metadata.active-time",children:"Active when"})," "]}),(0,n.jsx)(le,{timings:Fe,alertManagerSourceName:he})]}),Je&&(0,n.jsx)(Ee,{timingOptions:Je}),De&&(0,n.jsxs)(L.P,{icon:"corner-down-right-alt","data-testid":"inherited-properties",children:[(0,n.jsx)("span",{children:(0,n.jsx)(l.x6,{i18nKey:"alerting.policies.metadata.inherited",children:"Inherited"})}),(0,n.jsx)(ve,{properties:Ke})]})]})})}const q=(He,tt,Je,Ge,je,Fe,Be)=>{const[[Ke,Ue],[we,Xe],[nt,he]]=(0,j.Hl)([j.QI.UpdateNotificationPolicyTree,j.QI.DeleteNotificationPolicy,j.QI.ExportNotificationPolicies]),xe=[],me=he&&nt&&tt&&!He,ye=Ke&&Ue,De=we&&Xe&&!tt&&!He;return ye&&xe.push((0,n.jsx)(u.Fragment,{children:(0,n.jsx)(D.A,{shouldWrap:Je,wrap:oe,children:(0,n.jsx)(v.W.Item,{icon:"edit",disabled:Je||He,label:(0,l.t)("alerting.use-create-dropdown-menu-actions.label-edit","Edit"),onClick:()=>Ge(je,tt)})})},"edit-policy")),me&&xe.push((0,n.jsx)(v.W.Item,{icon:"download-alt",label:(0,l.t)("alerting.use-create-dropdown-menu-actions.label-export","Export"),onClick:Fe},"export-policy")),De&&xe.push((0,n.jsxs)(u.Fragment,{children:[(0,n.jsx)(v.W.Divider,{}),(0,n.jsx)(D.A,{shouldWrap:Je,wrap:oe,children:(0,n.jsx)(v.W.Item,{destructive:!0,icon:"trash-alt",disabled:Je||He,label:(0,l.t)("alerting.use-create-dropdown-menu-actions.label-delete","Delete"),onClick:()=>Be(je)})})]},"delete-policy")),xe},ne="__grafana_autogenerated__";function se(He){return He.object_matchers?He.object_matchers.some(tt=>tt[0]===ne&&tt[1]===O.ho.equal&&tt[2]==="true")??!1:!1}const oe=He=>(0,n.jsx)(y.m,{content:(0,l.t)("alerting.provisioned-tooltip.content-provisioned-items-cannot-edited","Provisioned items cannot be edited in the UI"),placement:"top",children:(0,n.jsx)("span",{children:He})}),de=({errors:He})=>(0,n.jsx)(K.B,{arrow:!0,placement:"top",content:(0,n.jsx)(f.B,{direction:"column",gap:.5,children:He.map(tt=>(0,n.jsx)(u.Fragment,{children:tt},(0,s.uniqueId)()))}),children:(0,n.jsx)("span",{children:(0,n.jsx)(h.E,{icon:"exclamation-circle",color:"red",text:r()("error",He.length,!0)})})}),fe=()=>{const He=(0,g.of)(_e);return(0,n.jsx)(y.m,{placement:"top",content:(0,l.t)("alerting.continue-matching-indicator.content-route-continue-matching-other-policies","This route will continue matching other policies"),children:(0,n.jsx)("div",{className:He.gutterIcon,"data-testid":"continue-matching",children:(0,n.jsx)(d.I,{name:"arrow-down"})})})},ae=()=>{const He=(0,g.of)(_e);return(0,n.jsx)(y.m,{placement:"top",content:(0,l.t)("alerting.all-matches-indicator.content-this-policy-matches-all-labels","This policy matches all labels"),children:(0,n.jsx)("div",{className:He.gutterIcon,"data-testid":"matches-all",children:(0,n.jsx)(d.I,{name:"exclamation-triangle"})})})};function ce(){const He=(0,g.of)(_e);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m.E,{element:"h2",variant:"body",weight:"medium",children:(0,n.jsx)(l.x6,{i18nKey:"alerting.policies.default-policy.title",children:"Default policy"})}),(0,n.jsx)("span",{className:He.metadata,children:(0,n.jsx)(l.x6,{i18nKey:"alerting.policies.default-policy.description",children:"All alert instances will be handled by the default policy if no other matching policies are found."})})]})}function ie(){return(0,n.jsx)(m.E,{element:"h3",variant:"body",weight:"medium",children:(0,n.jsx)(l.x6,{i18nKey:"alerting.policies.generated-policies",children:"Auto-generated policies"})})}const ve=({properties:He})=>(0,n.jsx)(K.B,{arrow:!0,placement:"top",content:(0,n.jsx)(f.B,{direction:"row",gap:.5,children:Object.entries(He).map(([tt,Je])=>Je?(0,n.jsx)(T.J,{label:Se(tt),value:Te(tt,Je)},tt):null)}),children:(0,n.jsx)("div",{children:(0,n.jsx)(m.E,{color:"primary",children:r()("property",Object.keys(He).length,!0)})})}),le=({timings:He,alertManagerSourceName:tt})=>{const[,Je]=(0,j.L7)(j.QI.ViewTimeInterval);return(0,n.jsx)("div",{children:He.map((Ge,je)=>{const Fe=Je?E.Y:m.E;return(0,n.jsxs)(u.Fragment,{children:[(0,n.jsx)(Fe,{href:(0,B.i7)(Ge,tt),color:Je?"primary":"secondary",variant:"bodySmall",inline:Je?!1:void 0,children:Ge}),je<He.length-1&&", "]},Ge)})})},Ee=({timingOptions:He})=>{const tt=He.group_wait,Je=He.group_interval,Ge=He.repeat_interval;if(!tt&&!Je&&!Ge)return null;const je=[];return tt&&je.push((0,n.jsx)(y.m,{placement:"top",content:(0,l.t)("alerting.policies.metadata.timingOptions.groupWait.description","How long to initially wait to send a notification for a group of alert instances."),children:(0,n.jsx)("span",{children:(0,n.jsxs)(l.x6,{i18nKey:"alerting.policies.metadata.timingOptions.groupWait.label",children:["Wait ",(0,n.jsx)(P.S,{content:tt})," to group instances"]})})})),Je&&je.push((0,n.jsx)(y.m,{placement:"top",content:(0,l.t)("alerting.policies.metadata.timingOptions.groupInterval.description","How long to wait before sending a notification about new alerts that are added to a group of alerts for which an initial notification has already been sent."),children:(0,n.jsx)("span",{children:(0,n.jsxs)(l.x6,{i18nKey:"alerting.policies.metadata.timingOptions.groupInterval.label",children:["Wait ",(0,n.jsx)(P.S,{content:Je})," before sending updates"]})})})),Ge&&je.push((0,n.jsx)(y.m,{placement:"top",content:(0,l.t)("alerting.policies.metadata.timingOptions.repeatInterval.description","How often notifications are sent if the group of alerts has not changed since the last notification."),children:(0,n.jsx)("span",{children:(0,n.jsxs)(l.x6,{i18nKey:"alerting.policies.metadata.timingOptions.repeatInterval.label",children:["Repeated every ",(0,n.jsx)(P.S,{content:Ge})]})})})),(0,n.jsx)(L.P,{icon:"hourglass","data-testid":"timing-options",children:je.map((Fe,Be)=>(0,n.jsxs)("span",{children:[Fe,Be<je.length-1&&" \xB7 "]},(0,s.uniqueId)()))})},Re=({alertManagerSourceName:He,contactPoint:tt,receivers:Je})=>{const Ge=Je.find(Be=>Be.name===tt);if(!Ge)return(0,n.jsx)(m.E,{color:"secondary",variant:"bodySmall",children:tt});const je=Ge.grafana_managed_receiver_configs,Fe="id"in Ge&&Ge.id?(0,B.bg)(Ge.id,He):(0,B.bI)(Ge.name,He);return(0,n.jsx)(K.B,{disabled:!je,arrow:!0,placement:"top",header:(0,n.jsx)(L.P,{icon:"at",children:(0,n.jsx)(m.E,{color:"primary",children:tt})}),content:(0,n.jsx)(m.E,{variant:"bodySmall",color:"secondary",children:(0,n.jsx)(M.yz,{receivers:Ge.grafana_managed_receiver_configs||[],limit:3})}),children:(0,n.jsx)(E.Y,{href:Fe,color:"primary",variant:"bodySmall",inline:!1,children:tt})},(0,s.uniqueId)())};function Oe(He,tt){return Object.entries(tt[He]?.notifiers??[]).reduce((je=[],[Fe,Be])=>{const Ke=Be.filter(Ue=>Ue.lastNotifyAttemptError).map(Ue=>(0,n.jsx)(T.J,{icon:"at",label:(0,l.t)("alerting.contact-point-errors.label-contact-point","Contact Point \u203A {{name}}",{name:Ue.name}),value:Ue.lastNotifyAttemptError},(0,s.uniqueId)()));return je.concat(Ke)},[])}const Se=He=>{switch(He){case"receiver":return"Contact Point";case"group_by":return"Group by";case"group_interval":return"Group interval";case"group_wait":return"Group wait";case"repeat_interval":return"Repeat interval";default:return He}},Te=(He,tt)=>{const Je=He==="group_by"&&Array.isArray(tt)&&tt[0]==="...",Ge=He==="group_by"&&Array.isArray(tt)&&tt.length===0;return Je?(0,n.jsx)(m.E,{variant:"bodySmall",color:"secondary",children:(0,n.jsx)(l.x6,{i18nKey:"alerting.policies.metadata.grouping.none",children:"Not grouping"})}):Ge?(0,n.jsx)(m.E,{variant:"bodySmall",color:"secondary",children:(0,n.jsx)(l.x6,{i18nKey:"alerting.policies.metadata.grouping.single-group",children:"Single group"})}):Array.isArray(tt)?tt.join(", "):tt},_e=He=>({matcher:tt=>{const{color:Je,borderColor:Ge}=(0,b.MC)(tt);return{wrapper:(0,a.css)({color:"#fff",background:Je,padding:`${He.spacing(.33)} ${He.spacing(.66)}`,fontSize:He.typography.bodySmall.fontSize,border:`solid 1px ${Ge}`,borderRadius:He.shape.radius.default})}},childPolicies:(0,a.css)({marginLeft:He.spacing(4),position:"relative","&:before":{content:'""',position:"absolute",height:"calc(100% - 10px)",borderLeft:`solid 1px ${He.colors.border.weak}`,marginTop:0,marginLeft:"-20px"}}),policyItemWrapper:(0,a.css)({padding:He.spacing(1.5)}),metadataRow:(0,a.css)({borderBottomLeftRadius:He.shape.borderRadius(2),borderBottomRightRadius:He.shape.borderRadius(2)}),policyWrapper:(tt=!1)=>(0,a.css)({flex:1,position:"relative",background:He.colors.background.secondary,borderRadius:He.shape.radius.default,border:`solid 1px ${He.colors.border.weak}`,...tt&&{borderColor:He.colors.primary.border,background:He.colors.primary.transparent}}),metadata:(0,a.css)({color:He.colors.text.secondary,fontSize:He.typography.bodySmall.fontSize,fontWeight:He.typography.bodySmall.fontWeight}),break:(0,a.css)({width:"100%",height:0,marginBottom:He.spacing(2)}),gutterIcon:(0,a.css)({position:"absolute",top:0,transform:"translateY(50%)",left:`-${He.spacing(4)}`,color:He.colors.text.secondary,background:He.colors.background.primary,width:"25px",height:"25px",textAlign:"center",border:`solid 1px ${He.colors.border.weak}`,borderRadius:He.shape.radius.default,padding:0}),moreButtons:(0,a.css)({marginTop:He.spacing(.5),marginBottom:He.spacing(1.5)})})},88114:(te,R,e)=>{"use strict";e.d(R,{Im:()=>i,nv:()=>s,rw:()=>a});var n=e(11257);const a=[n.w.AlertingRoutesRead],s=[n.w.AlertingRoutesWrite],i=[...a,...s]},46202:(te,R,e)=>{"use strict";e.d(R,{g0:()=>U,a1:()=>j,yV:()=>P,F:()=>O});var n=e(2543),a=e(47078),s=e.n(a),i=e(84266),r=e(85618),u=e(91984),o=e(80218),l=e(43100),g=e(5709);const f=["RoutingTree"],p=g.H.enhanceEndpoints({addTagTypes:f}).injectEndpoints({endpoints:T=>({listNamespacedRoutingTree:T.query({query:L=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${L.namespace}/routingtrees`,params:{pretty:L.pretty,allowWatchBookmarks:L.allowWatchBookmarks,continue:L.continue,fieldSelector:L.fieldSelector,labelSelector:L.labelSelector,limit:L.limit,resourceVersion:L.resourceVersion,resourceVersionMatch:L.resourceVersionMatch,sendInitialEvents:L.sendInitialEvents,timeoutSeconds:L.timeoutSeconds,watch:L.watch}}),providesTags:["RoutingTree"]}),replaceNamespacedRoutingTree:T.mutation({query:L=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${L.namespace}/routingtrees/${L.name}`,method:"PUT",body:L.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1RoutingTree,params:{pretty:L.pretty,dryRun:L.dryRun,fieldManager:L.fieldManager,fieldValidation:L.fieldValidation}}),invalidatesTags:["RoutingTree"]})}),overrideExisting:!1});var c=e(78045),x=e(42824),v=e(22628),m=e(56476),y=e(48442),h=e(67923);const d=s()(W,{maxSize:1}),{useListNamespacedRoutingTreeQuery:E,useReplaceNamespacedRoutingTreeMutation:b,useLazyListNamespacedRoutingTreeQuery:D}=p,{useGetAlertmanagerConfigurationQuery:C}=u.m,P=({alertmanager:T},{skip:L}={})=>{const A=(0,m.dM)(T),N=E({namespace:(0,r.Ge)()},{skip:L||!A,selectFromResult:z=>({...z,currentData:z.currentData?d(z.currentData.items):void 0,data:z.data?d(z.data.items):void 0})}),V=C(T,{skip:L||A,selectFromResult:z=>({...z,currentData:z.currentData?.alertmanager_config?.route?[M(z.currentData.alertmanager_config.route)]:void 0,data:z.data?.alertmanager_config?.route?[M(z.data.alertmanager_config.route)]:void 0})});return A?N:V},M=s()(T=>({...T,[i.uz]:{provisioned:!!(T.provenance&&T.provenance!==v.rh)}}));function O({alertmanager:T}){const L=(0,m.dM)(T),[A]=b(),[N]=(0,l.d)(),[V]=D(),z=(0,o.Yb)(async H=>{const Q=(0,r.Ge)(),Z=await V({namespace:Q}),[Y]=Z.data?d(Z.data.items):[];if(!Y)throw new Error(`no root route found for namespace ${Q}`);const X=(0,x.QM)(Y),I=(0,h.AB)(T,H,X),J=K(I);return A({name:v.DM,namespace:Q,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1RoutingTree:(0,h.HO)(J)}).unwrap()}),w=(0,o.Yb)(async H=>{const Q=(0,c.LY)({update:H,alertmanager:T});return N(Q)});return L?z:w}function j({alertmanager:T}){const L=(0,m.dM)(T),[A]=(0,l.d)(),[N]=D(),[V]=b(),z=(0,o.Yb)(async H=>{const Q=(0,r.Ge)(),Z=await N({namespace:Q}),[Y]=Z.data?d(Z.data.items):[];if(!Y)throw new Error(`no root route found for namespace ${Q}`);const X=(0,x.QM)(Y),I=(0,h.AS)(H,X),J=K(I);return V({name:v.DM,namespace:Q,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1RoutingTree:J}).unwrap()}),w=(0,o.Yb)(async H=>{const Q=(0,c.Z8)({id:H});return A(Q)});return L?z:w}function U({alertmanager:T}){const L=(0,m.dM)(T),[A]=(0,l.d)(),[N]=D(),[V]=b(),z=(0,o.Yb)(async({partialRoute:H,referenceRouteIdentifier:Q,insertPosition:Z})=>{const Y=(0,r.Ge)(),X=await N({namespace:Y}),[I]=X.data?d(X.data.items):[];if(!I)throw new Error(`no root route found for namespace ${Y}`);const J=(0,x.QM)(I),ee=(0,h.I8)(T??"",H,Q,J,Z),q=K(ee);return V({name:v.DM,namespace:Y,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1RoutingTree:(0,h.HO)(q)}).unwrap()}),w=(0,o.Yb)(async({partialRoute:H,referenceRouteIdentifier:Q,insertPosition:Z})=>{const Y=(0,c.tD)({partialRoute:H,referenceRouteIdentifier:Q,insertPosition:Z,alertmanager:T});return A(Y)});return L?z:w}function W(T){return T?.map(L=>({...L.spec.defaults,routes:L.spec.routes?.map(S),[i.uz]:{provisioned:(0,m.Uo)(L),resourceVersion:L.metadata.resourceVersion,name:L.metadata.name}}))}function B(T){return Object.values(i.ho).includes(T)}function S(T){return{...T,routes:T.routes?.map(S),matchers:void 0,object_matchers:T.matchers?.map(({label:L,type:A,value:N})=>{if(!B(A))throw new Error(`Invalid matcher operator from API: ${A}`);return[L,A,N]})}}function _(T){const{object_matchers:L,...A}=T;return{...A,receiver:T.receiver??void 0,matchers:L?.map(([N,V,z])=>({label:N,type:V,value:z})),routes:T.routes?.map(_)}}function K(T){const A={...(0,n.pick)(T,y.Rs),receiver:T.receiver??""},N=T.routes?.map(_)??[];return{spec:{defaults:A,routes:N},metadata:{name:v.DM,resourceVersion:T[i.uz]?.resourceVersion}}}},28141:(te,R,e)=>{"use strict";e.d(R,{k:()=>g,v:()=>o});var n=e(74848),a=e(96540),s=e(92745),i=e(8207),r=e(45861),u=e(54384);const o=({resourceName:f,title:p,onClose:c,...x})=>{const v=(0,s.t)("alerting.manage-permissions.title","Manage permissions");return(0,n.jsx)(i._,{onClose:c,title:p||v,subtitle:f,children:(0,n.jsx)(u.x,{...x,canSetPermissions:!0})})},l=({onClick:f})=>(0,n.jsx)(r.$n,{variant:"secondary",onClick:f,icon:"unlock",children:(0,n.jsx)(s.x6,{i18nKey:"alerting.manage-permissions.button",children:"Manage permissions"})}),g=({resource:f,resourceId:p,resourceName:c,title:x,renderButton:v})=>{const[m,y]=(0,a.useState)(!1),h=()=>y(!1),d=()=>y(!0);return(0,n.jsxs)(n.Fragment,{children:[v?v({onClick:d}):(0,n.jsx)(l,{onClick:d}),m&&(0,n.jsx)(o,{resource:f,resourceId:p,resourceName:c,title:x,onClose:h})]})}},56652:(te,R,e)=>{"use strict";e.r(R),e.d(R,{AlertmanagerTemplateFunction:()=>a,GomplateFunctions:()=>s,availableAlertManagerFunctions:()=>i,builtinFunctions:()=>u,conf:()=>g,keywords:()=>o,language:()=>l});var n=(f=>(f.Delimiter="delimiter",f.Keyword="keyword",f.Function="type.identifier",f.String="string",f.Variable="variable.name",f.Number="number",f.Comment="comment",f.Operator="operator",f.Identifier="idenfifier",f))(n||{}),a=(f=>(f.toUpper="toUpper",f.toLower="toLower",f.title="title",f.join="join",f.match="match",f.safeHtml="safeHtml",f.reReplaceAll="reReplaceAll",f.stringSlice="stringSlice",f))(a||{});const s={coll:[{keyword:"coll.Dict",definition:"Creates a map with string keys from key/value pairs. All keys are converted to strings. If an odd number of arguments is provided, the last is used as the key with an empty string value.",usage:"function(key string, val any, ...)",example:'{{ coll.Dict "name" "Frank" "age" 42 | data.ToYAML }}'},{keyword:"coll.Slice",definition:"Creates a slice (like an array or list). Useful when needing to range over a bunch of variables.",usage:"function(in ...any)",example:'{{ range coll.Slice "Bart" "Lisa" "Maggie" }}Hello, {{ . }}{{ end }}'},{keyword:"coll.Append",definition:"Appends a value to the end of a list. Creates a new list rather than modifying the input.",usage:"function(value any, list []any)",example:"{{ coll.Slice 1 1 2 3 | append 5 }}"}],data:[{keyword:"data.JSON",definition:"Converts a JSON string into an object. Works for JSON Objects and Arrays.",usage:"function(json string)",example:"{{ ($json | data.JSON).hello }}"},{keyword:"data.ToJSON",definition:"Converts an object to a JSON document.",usage:"function(obj any)",example:'{{ (`{"foo":{"hello":"world"}}` | json).foo | data.ToJSON }}'},{keyword:"data.ToJSONPretty",definition:"Converts an object to a pretty-printed (indented) JSON document.",usage:"function(indent string, obj any)",example:'{{ `{"hello":"world"}` | data.JSON | data.ToJSONPretty "  " }}'}],tmpl:[{keyword:"tmpl.Exec",definition:"Execute (render) the named template. This is equivalent to using the `template` action, except the result is returned as a string. This allows for post-processing of templates.",usage:"function(name string, [context any])",example:'{{ tmpl.Exec "T1" | strings.ToUpper }}'},{keyword:"tmpl.Inline",definition:"Render the given string as a template, just like a nested template. If the template is given a name, it can be re-used later with the `template` keyword. A context can be provided, otherwise the default gomplate context will be used.",usage:"function(partial string, context any)",example:'{{ tmpl.Inline "{{print `hello world`}}" }}'}],time:[{keyword:"time.Now",definition:"Returns the current local time, as a time.Time. This wraps Go's time.Now.",usage:"function()",example:'{{ (time.Now).UTC.Format "Day 2 of month 1 in year 2006 (timezone MST)" }}'}]},i=[...Object.values(a),...Object.keys(s).map(f=>f)],u=["and","call","html","index","slice","js","len","not","or","print","printf","println","urlquery",...["eq","ne","lt","le","gt","ge"]],o=["define","if","else","end","range","break","continue","template","block","with"],l={defaultToken:"",keywords:o,functions:[...u,...i],operators:["|"],tokenizer:{root:[[/"/,"string","@string"],[/`/,"string","@rawstring"],[/\d*\d+[eE]([\-+]?\d+)?/,"number.float"],[/\d*\.\d+([eE][\-+]?\d+)?/,"number.float"],[/0[xX][0-9a-fA-F']*[0-9a-fA-F]/,"number.hex"],[/0[0-7']*[0-7]/,"number.octal"],[/0[bB][0-1']*[0-1]/,"number.binary"],[/\d[\d']*/,"number"],[/\d/,"number"],[/[;,.]/,"delimiter"],[/{{-?/,"delimiter"],[/-?}}/,"delimiter"],[/\.([A-Za-z]+)?/,"variable.name"],[/[a-zA-Z_]\w*/,{cases:{"@keywords":{token:"keyword"},"@functions":{token:"type.identifier"},"@default":"idenfifier"}}],[/\/\*.*\*\//,"comment"]],string:[[/[^\\"]+/,"string"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],rawstring:[[/[^\`]/,"string"],[/`/,"string","@pop"]]}},g={comments:{blockComment:["/*","*/"]},brackets:[["{{","}}"],["(",")"]],autoClosingPairs:[{open:"{{",close:"}}"},{open:"(",close:")"},{open:"`",close:"`"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{{",close:"}}"},{open:"(",close:")"},{open:"`",close:"`"},{open:'"',close:'"'},{open:"'",close:"'"}]}},6135:(te,R,e)=>{"use strict";e.d(R,{FI:()=>n,J4:()=>a});const n="grafana_alerting";var a=(r=>(r.OnCall="oncall",r))(a||{});const s=(r,u)=>u.includes(r),i=(r,u)=>{if(!r.grafana_managed_receiver_configs)return!1;const o=r.grafana_managed_receiver_configs.length===1,l=s(r.grafana_managed_receiver_configs[0]?.settings?.url??"",u.map(g=>g.integration_url));return o&&l}},53226:(te,R,e)=>{"use strict";e.d(R,{U0:()=>x,VY:()=>h});var n=e(74848),a=e(1932),s=e(96540),i=e(92745),r=e(68143),u=e(99887),o=e(182),l=e(64762),g=e(77788),f=e(3986),p=e(72930),c=e(6135),x=(d=>(d.NewIntegration="new_oncall_integration",d.ExistingIntegration="existing_oncall_integration",d))(x||{}),v=(d=>(d.IntegrationType="integration_type",d.IntegrationName="integration_name",d))(v||{}),m=(d=>(d.Disabled="disabled",d.V1="v1",d.V2="v2",d))(m||{});function y(){const{installed:d,loading:E,error:b}=(0,f._)((0,o.BO)()),{data:D=[],error:C,isLoading:P}=g.WG.endpoints.features.useQuery(void 0,{skip:!d}),M=(0,s.useMemo)(()=>d?D.includes(g.Pc)?"v2":"v1":"disabled",[d,D]),O=(0,s.useMemo)(()=>M==="v2",[M]);return{isOnCallEnabled:d,integrationStatus:M,isAlertingV2IntegrationEnabled:O,isOnCallStatusLoading:E||P,onCallError:b??C}}function h(){const d=(0,l._2)(),{isOnCallEnabled:E,integrationStatus:b,isAlertingV2IntegrationEnabled:D,isOnCallStatusLoading:C,onCallError:P}=y(),{useCreateIntegrationMutation:M,useGrafanaOnCallIntegrationsQuery:O,useLazyValidateIntegrationNameQuery:j}=g.WG,[U,{isFetching:W}]=j(),[B]=M(),{data:S=[],isLoading:_,isError:K}=O(void 0,{skip:!D}),T=(0,s.useMemo)(()=>({integration_name:async V=>{try{return await U(V).unwrap(),!0}catch(z){if((0,r.NF)(z)&&z.status===409)return(0,i.t)("alerting.irm-integration.integration-name-exists","Integration of this name already exists in IRM");throw d.error((0,i.t)("alerting.irm-integration.validation-failed","Failed to validate IRM integration name. Is the OnCall API available?")),z}},url:V=>D?S.map(z=>z.integration_url).includes(V)?!0:(0,i.t)("alerting.irm-integration.integration-required","Selection of existing IRM integration is required"):!0}),[S,U,D,d]),L=(0,s.useCallback)(V=>D?(0,a.jM)(V,z=>{z.grafana_managed_receiver_configs?.forEach(w=>{w.type===c.J4.OnCall&&(w.settings.integration_type="existing_oncall_integration")})}):V,[D]),A=(0,s.useCallback)(async V=>{if(!D)return V;const H=(V.grafana_managed_receiver_configs?.filter(Q=>Q.type===c.J4.OnCall)??[]).filter(Q=>Q.settings.integration_type==="new_oncall_integration").map(async Q=>{const Z=await B({integration:c.FI,verbal_name:Q.settings.integration_name}).unwrap();Q.settings.url=Z.integration_url});return await Promise.all(H),(0,a.jM)(V,Q=>{Q.grafana_managed_receiver_configs?.forEach(Z=>{Z.type===c.J4.OnCall&&(delete Z.settings.integration_type,delete Z.settings.integration_name)})})},[D,B]),N=(0,s.useCallback)(V=>{if(V.type===c.J4.OnCall&&D){const z=V.options.filter(Q=>Q.propertyName!=="url"),w={value:"new_oncall_integration",label:(0,i.t)("alerting.irm-integration.new-integration","New IRM integration"),description:(0,i.t)("alerting.irm-integration.new-integration-description","A new IRM integration without escalation chains will be automatically created")},H={value:"existing_oncall_integration",label:(0,i.t)("alerting.irm-integration.existing-integration","Existing IRM integration"),description:(0,i.t)("alerting.irm-integration.existing-integration-description","Use an existing IRM integration")};return z.unshift((0,p.u)("integration_type",(0,i.t)("alerting.irm-integration.connection-method","How to connect to IRM"),"",{required:!0,element:"radio",defaultValue:w,selectOptions:[w,H]}),(0,p.u)("integration_name",(0,i.t)("alerting.irm-integration.integration-name","Integration name"),(0,i.t)("alerting.irm-integration.integration-name-description","The name of the new IRM integration"),{required:!0,showWhen:{field:"integration_type",is:"new_oncall_integration"}}),(0,p.u)("url",(0,i.t)("alerting.irm-integration.integration","IRM Integration"),(0,i.t)("alerting.irm-integration.integration-description","The IRM integration to send alerts to"),{element:"select",required:!0,showWhen:{field:"integration_type",is:"existing_oncall_integration"},selectOptions:S.map(Q=>({label:Q.display_name,description:Q.integration_url,value:Q.integration_url}))})),{...V,options:z}}return V},[S,D]);return{integrationStatus:b,onCallNotifierMeta:{enabled:!!E,order:-1,description:E?(0,i.t)("alerting.irm-integration.enabled-description","Seamless way to handle alerts and manage incidents"):(0,i.t)("alerting.irm-integration.disabled-description","Enable IRM through a Webhook integration"),badge:(0,n.jsx)(u.E,{color:"blue",text:(0,i.t)("alerting.irm-integration.recommended","Recommended")})},extendOnCallNotifierFeatures:N,extendOnCallReceivers:L,createOnCallIntegrations:A,onCallFormValidators:T,isLoadingOnCallIntegration:_||C,isValidating:W,hasOnCallError:!!P||K}}},29855:(te,R,e)=>{"use strict";e.d(R,{G_:()=>b,sb:()=>D});var n=e(74848),a=e(22803),s=e(20382),i=e(96540),r=e(49785),u=e(70713),o=e(92745),l=e(63142),g=e(8207),f=e(54314),p=e(60208),c=e(45861),x=e(45967),v=e(30703),m=e(50992),y=e(89640),h=e(20437),d=e(29609);const E=[{label:"Yaml",value:"yaml"}],b=({onClose:U})=>{const[W,B]=(0,i.useState)("yaml"),{setValue:S}=(0,r.xW)(),_=(0,l.of)(j),K=T=>{for(const L in T)S(L,T[L]);U()};return(0,n.jsx)(g._,{title:(0,o.t)("alerting.rule-inspector.title-inspect-alert-rule","Inspect Alert rule"),subtitle:(0,n.jsx)("div",{className:_.subtitle,children:(0,n.jsx)(D,{tabs:E,setActiveTab:B,activeTab:W})}),onClose:U,children:W==="yaml"&&(0,n.jsx)(C,{onSubmit:K})})};function D({tabs:U,activeTab:W,setActiveTab:B}){return(0,n.jsx)(f.U,{children:U.map((S,_)=>(0,n.jsx)(p.o,{label:S.label,value:S.value,onChangeTab:()=>B(S.value),active:W===S.value},`${S.value}-${_}`))})}const C=({onSubmit:U})=>{const W=(0,l.of)(O),{getValues:B}=(0,r.xW)(),S=(0,h.l1)(B()),[_,K]=(0,i.useState)((0,s.Bh)(S)),T=()=>{const L=(0,s.Hh)(_),A=B(),N=M(L);U({...A,...N})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:W.applyButton,children:[(0,n.jsx)(c.$n,{type:"button",onClick:T,children:(0,n.jsx)(o.x6,{i18nKey:"alerting.inspector-yaml-tab.apply",children:"Apply"})}),(0,n.jsx)(x.m,{content:(0,n.jsx)(P,{}),theme:"info",placement:"left-start",interactive:!0,children:(0,n.jsx)(v.I,{name:"exclamation-triangle",size:"xl"})})]}),(0,n.jsx)("div",{className:W.content,children:(0,n.jsx)(u.Ay,{disableWidth:!0,children:({height:L})=>(0,n.jsx)(m.B,{width:"100%",height:L,language:"yaml",value:_,onBlur:K,monacoOptions:{minimap:{enabled:!1}}})})})]})};function P(){return(0,n.jsx)("div",{children:(0,n.jsxs)(o.x6,{i18nKey:"alerting.yaml-content-info.body",children:["The YAML content in the editor only contains alert rule configuration ",(0,n.jsx)("br",{}),"To configure Prometheus, you need to provide the rest of the"," ",(0,n.jsx)(y.Y,{href:"https://prometheus.io/docs/prometheus/latest/configuration/alerting_rules/",external:!0,children:"configuration file content."})]})})}function M(U){return d.p.dataSource.alertingRule(U)?(0,h.Qk)(U):d.p.dataSource.recordingRule(U)?(0,h.XI)(U):{}}const O=U=>({content:(0,a.css)({flexGrow:1,height:"100%",paddingBottom:"16px",marginBottom:U.spacing(2)}),applyButton:(0,a.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",flexGrow:0,marginBottom:U.spacing(2)})}),j=()=>({subtitle:(0,a.css)({display:"flex",alignItems:"center",justifyContent:"space-between"})})},89144:(te,R,e)=>{"use strict";e.d(R,{j:()=>p});var n=e(74848),a=e(22803),s=e(70713),i=e(17503),r=e(92745),u=e(63142),o=e(45229),l=e(5929),g=e(51993),f=e(55376);const p=({data:x,thresholds:v,thresholdsType:m})=>{const y=(0,u.of)(c),h=(0,i.jq)(x.series),d=(0,f.yW)(x),E=m?{mode:m}:void 0;return(0,n.jsx)("div",{className:y.wrapper,children:(0,n.jsx)(s.Ay,{disableHeight:!0,children:({width:b})=>(0,n.jsx)("div",{style:{width:b},children:h?(0,n.jsx)(l.y,{statusMessage:d,data:x.series,eventBus:o.A,height:300,width:b,timeRange:x.timeRange,timeZone:"browser",onChangeTime:()=>{},splitOpenFn:()=>{},loadingState:x.state,thresholdsConfig:v,thresholdsStyle:E}):(0,n.jsxs)("div",{className:y.instantVectorResultWrapper,children:[(0,n.jsx)("header",{className:y.title,children:(0,n.jsx)(r.x6,{i18nKey:"alerting.viz-wrapper.table",children:"Table"})}),(0,n.jsx)(g.GX,{series:x.series})]})})})})},c=x=>({wrapper:(0,a.css)({width:"100%",position:"relative"}),instantVectorResultWrapper:(0,a.css)({border:`solid 1px ${x.colors.border.medium}`,borderRadius:x.shape.radius.default,padding:0,display:"flex",flexDirection:"column",flexWrap:"nowrap"}),title:(0,a.css)({label:"panel-title",padding:x.spacing(),textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontSize:x.typography.h6.fontSize,fontWeight:x.typography.h6.fontWeight})})},42970:(te,R,e)=>{"use strict";e.d(R,{p_:()=>v,qQ:()=>x,vL:()=>u,wz:()=>o});var n=e(2543),a=e.n(n),s=e(68220),i=e(44022),r=e(4651);function u(d){const E=new s.TS,b=[],D=d.map(C=>C.refId);if(E.createNodes(D),d.forEach(C=>{if(!(0,i.f)(C.model))return;const P=C.refId;g(C.model).forEach(O=>{if(P&&O)try{E.link(O,P)}catch(j){b.push({source:P,target:O,error:j})}})}),b.length>0)throw new l("failed to create DAG from queries",{cause:b});return E}function o(d,E=[]){try{return[u(d),E]}catch(b){if(b instanceof l){const D=b.cause;E.push(...D);const C=(0,n.reject)(d,P=>D.some(M=>M.source===P.refId));return o(C,E)}}return[new s.TS,E]}class l extends Error{constructor(E,b){super(E,b),this.cause=b?.cause??[]}}function g(d){const E=d.type===r.Tz.math,b=d.type===r.Tz.classic,D=d.type===r.Tz.sql;return E?f(d.expression??""):b?d.conditions?.map(C=>C.query.params[0])??[]:D?p(d.expression??""):[d.expression]}function f(d){const E=new RegExp(/\$\{(?<var>[a-zA-Z0-9_ ]+?)\}/gm),b=new RegExp(/\$(?<var>[a-zA-Z0-9_]+)/gm),D=Array.from(d.matchAll(E)).map(P=>P.groups?.var),C=Array.from(d.matchAll(b)).map(P=>P.groups?.var);return(0,n.compact)((0,n.uniq)([...D,...C]))}function p(d){if(!d)return[];const C=d.split(`
`).filter(j=>!j.trim().startsWith("--")).join(" ").replace(/\s+/g," ").replace(/\/\*[\s\S]*?\*\//g,""),P=[],M=/from\s+([^;]*?)(?:\s+(?:join|where|group|having|order|limit)|\s*$)/gi;for(const j of C.matchAll(M)){const W=j[1].trim().split(",").map(B=>B.trim());for(const B of W)P.push(c(B))}const O=/join\s+([a-zA-Z0-9_."]+)/gi;for(const j of C.matchAll(O))P.push(c(j[1]));return(0,n.compact)((0,n.uniq)(P))}function c(d){let E=d.replace(/['"]/g,"");return E.includes(" as ")?E=E.split(" as ")[0]:E.includes(" ")&&(E=E.split(" ")[0]),E.includes(".")&&(E=E.split(".").pop()||""),E.trim()}const x=(0,n.memoize)(m,(d,E)=>d+h(E)),v=(0,n.memoize)(y,(d,E)=>d+h(E));function m(d,E){const b=E.getNode(d);if(!b)return[];const D=[];function C(P){const M=P.inputEdges;M.length>0?M.forEach(O=>{O.inputNode&&C(O.inputNode)}):D.push(P)}return C(b),D.map(P=>P.name)}function y(d,E){const b=E.getNode(d);if(!b)return[];const D=[];function C(P){P.outputEdges.forEach(O=>{O.outputNode&&(D.push(O.outputNode),C(O.outputNode))})}return C(b),D.map(P=>P.name)}function h(d){return Object.keys(d.nodes).map(E=>{const b=d.nodes[E],D=b.outputEdges.map(P=>P.outputNode?.name).join(", "),C=b.inputEdges.map(P=>P.inputNode?.name).join(", ");return`${b.name}:${D}:${C}`}).join(" ")}},54513:(te,R,e)=>{"use strict";e.d(R,{Y:()=>Q});var n=e(96540),a=e(28105),s=e(2543),i=e(39741),r=e(62467),u=e(66847),o=e(1005),l=e(81160),g=e(24726),f=e(41119),p=e(47520),c=e(17548),x=e(22592),v=e(77154),m=e(92745),y=e(78282),h=e(36580),d=e(97534),E=e(83873),b=e(44022),D=e(77526),C=e(39050),P=e(42970),M=e(4651);const O={from:21600,to:0},j=(Z,Y)=>{const X=U(Z,Y);if(!X)return O;const{from:I,to:J}=B(X,Y);return!I.length&&!J.length?O:{from:Math.max(...I),to:Math.min(...J)}},U=(Z,Y)=>{switch(Z.type){case M.Tz.classic:return W(Z);case M.Tz.math:case M.Tz.sql:return S(Z,Y);case M.Tz.resample:case M.Tz.reduce:case M.Tz.threshold:return _(Z)}},W=Z=>Z.conditions?.map(Y=>Y.query.params[0]),B=(Z,Y)=>{const X=[],I=[O.to];for(const J of Z){const ee=Y.find(q=>q.refId===J);!ee||!ee.relativeTimeRange||(X.push(ee.relativeTimeRange.from),I.push(ee.relativeTimeRange.to))}return{from:X,to:I}},S=(Z,Y)=>Y.filter(X=>X.queryType==="query"&&Z.expression?.includes(X.refId)).map(X=>X.refId),_=Z=>Z.expression?[Z.expression]:void 0;class K{constructor(Y=(0,E.AI)(),X=(0,y.l)()){this.backendSrv=Y,this.dataSourceSrv=X,this.subject=new i.m(1),this.lastResult={}}get(){return this.subject.asObservable()}async run(Y,X){const I=await this.prepareQueries(Y);if(I.length===0)return;const ee=I.some(q=>q.refId===X)?X:"";this.subscription=T(this.backendSrv,I,ee).subscribe({next:q=>{const ne=z(q,(de,fe)=>{const ae=this.lastResult[de],ce=(0,f.N$)(fe,ae);return(0,C.B)(ce,ae)}),[se,oe]=(0,P.wz)(Y);oe.forEach(de=>{ne[de.source]=w(de)}),this.lastResult=ne,this.subject.next(this.lastResult)},error:q=>{this.lastResult=V(this.lastResult,q),this.subject.next(this.lastResult)}})}async prepareQueries(Y){const X=[];for(const q of Y){const ne=q.model.refId;if((0,b.f)(q.model))continue;const se=await this.dataSourceSrv.get(q.datasourceUid);se instanceof h.iy&&se.filterQuery&&!se.filterQuery(q.model)&&X.push(ne)}const[I]=(0,P.wz)(Y),J=Object.keys(I.nodes);return X.forEach(q=>{const ne=(0,P.p_)(q,I);X.push(...ne)}),Y.filter(q=>!J.includes(q.refId)).forEach(q=>{X.push(q.refId)}),(0,s.reject)(Y,q=>X.includes(q.refId))}cancel(){if(!this.subscription)return;this.subscription.unsubscribe();let Y=!1;const X=z(this.lastResult,(I,J)=>(J.state===a.Gu.Loading&&(Y=!0),{...J,state:a.Gu.Done}));Y&&this.subject.next(X)}destroy(){this.subject&&this.subject.complete(),this.cancel()}}const T=(Z,Y,X)=>{const I=L(Y,a.Gu.Loading),J={data:{data:Y,condition:X},url:"/api/v1/eval",method:"POST",requestId:(0,g.A)()};return(0,p.k)({whileLoading:I,source:Z.fetch(J).pipe(N(I),(0,u.W)(ee=>(0,r.of)(V(I,ee))),(0,D.N)(Z,J.requestId),(0,o.u)())})},L=(Z,Y)=>Z.reduce((X,I)=>(X[I.refId]={state:Y,series:[],timeRange:A(I,Z)},X),{}),A=(Z,Y)=>{if((0,b.f)(Z.model)){const X=j(Z.model,Y);return c.relativeToTimeRange(X)}return Z.relativeTimeRange?c.relativeToTimeRange(Z.relativeTimeRange):(console.warn(`Query with refId: ${Z.refId} did not have any relative time range, using default.`),(0,x.E2)())},N=Z=>(0,l.T)(Y=>{const{data:X}=Y,I={};for(const[J,ee]of Object.entries(X.results)){const{error:q,status:ne,frames:se=[]}=ee,oe=q?[{message:q,refId:J,status:ne}]:[];I[J]={errors:oe,timeRange:Z[J].timeRange,state:a.Gu.Done,series:se.map(v.or)}}return I}),V=(Z,Y)=>{const X=(0,d.u)(Y);return z(Z,(I,J)=>J.state===a.Gu.Error?J:{...J,state:a.Gu.Error,error:X})},z=(Z,Y)=>{const X={};for(const[I,J]of Object.entries(Z))X[I]=Y(I,J);return X},w=Z=>({series:[],state:a.Gu.Error,errors:[{message:H(Z)}],timeRange:(0,x.E2)()});function H(Z){return Z.source===Z.target?(0,m.t)("alerting.dag.self-reference","You can't link an expression to itself"):(0,m.t)("alerting.dag.missing-reference",'Expression "{{source}}" failed to run because "{{target}}" is missing or also failed.',{source:Z.source,target:Z.target})}function Q(){const[Z,Y]=(0,n.useState)({}),X=(0,n.useRef)(new K);(0,n.useEffect)(()=>{const ne=X.current;return ne.get().subscribe(se=>{Y(se)}),()=>{ne.destroy()}},[]);const I=(0,n.useCallback)(()=>{Y({})},[]),J=(0,n.useCallback)(()=>{X.current.cancel()},[]),ee=(0,n.useCallback)((ne,se)=>{X.current.run(ne,se)},[]),q=(0,n.useMemo)(()=>Object.values(Z).some(ne=>ne.state===a.Gu.Loading),[Z]);return{queryPreviewData:Z,runQueries:ee,cancelQueries:J,isPreviewLoading:q,clearPreviewData:I}}},55376:(te,R,e)=>{"use strict";e.d(R,{Cl:()=>m,I3:()=>c,YG:()=>C,an:()=>E,lb:()=>h,xb:()=>v,yW:()=>D,yr:()=>d,zy:()=>y});var n=e(2543),a=e.n(n),s=e(17503),i=e(33553),r=e(28105),u=e(739),o=e(65642),l=e(2954),g=e(44022),f=e(4651),p=e(42970);function c(P,M,O){return P.map(j=>{if(M===O||!(0,g.f)(j.model))return j;const U=j.model.type==="math",W=j.model.type==="reduce",B=j.model.type==="resample",S=j.model.type==="classic_conditions",_=j.model.type==="threshold";if(U)return{...j,model:{...j.model,expression:x(j.model.expression??"",M,O)}};if(B||W||_){const K=j.model.expression===M;return{...j,model:{...j.model,expression:K?O:j.model.expression}}}if(S){const K=j.model.conditions?.map(T=>({...T,query:{...T.query,params:T.query.params.map(L=>L===M?O:L)}}));return{...j,model:{...j.model,conditions:K}}}return j})}function x(P,M,O){const j=new RegExp("(\\$"+M+"\\b)|(\\${"+M+"})","gm"),U="${"+O+"}";return P.replace(j,U)}function v(P,M){return P.find(O=>O.refId===M)!==void 0}function m(P){return P.includes("/")||P.includes("\\")}function y(P){if(P.series.length===0)return;const M=(0,s.jq)(P.series);let O;return M&&(O=new Error("You cannot use time series data as an alert condition, consider adding a reduce expression.")),O}function h(P){if(P.errors?.length)return new Error(P.errors[0].message)}function d(P){const O=(P[0]?.meta?.notices??[]).find(j=>j.severity==="warning")?.text;return O?new Error(O):void 0}function E(P,M){const O={},j=[f.Tz.threshold,f.Tz.classic];if(!M)return O;for(const B of P){if(!(0,g.f)(B.model)||!j.includes(B.model.type)||!Array.isArray(B.model.conditions)||B.model.refId!==M)continue;const S=B.model.conditions.some(b);B.model.conditions.forEach(_=>{const K=_.evaluator.params,T=_.query?.params[0]??B.model.expression;if(!T)return;const L=b(_);try{const A=(0,p.vL)(P),N=(0,p.qQ)(T,A);P.filter(z=>N.includes(z.refId)).forEach(z=>{const w=z.refId,Q=!!(!(0,g.f)(z?.model)&&w);w&&!O[w]&&(O[w]={config:{mode:i.O.Absolute,steps:[]},mode:u.Ly.Line}),w&&Q&&!L&&!S?U(w,K[0]):w&&Q&&L&&(W(w,K,_.evaluator.type),O[w].mode=u.Ly.LineAndArea)})}catch(A){console.error("Failed to parse thresholds",A);return}})}function U(B,S){O[B].config.steps.push({value:-1/0,color:"transparent"},{value:S,color:o.$W.theme2.colors.error.main})}function W(B,S,_){_===l.p.IsWithinRange&&O[B].config.steps.push({value:-1/0,color:"transparent"},{value:S[0],color:o.$W.theme2.colors.error.main},{value:S[1],color:o.$W.theme2.colors.error.main},{value:S[1],color:"transparent"}),_===l.p.IsOutsideRange&&O[B].config.steps.push({value:-1/0,color:o.$W.theme2.colors.error.main},{value:S[0],color:o.$W.theme2.colors.error.main},{value:S[0],color:"transparent"},{value:S[1],color:o.$W.theme2.colors.error.main}),_===l.p.IsWithinRangeIncluded&&O[B].config.steps.push({value:-1/0,color:"transparent"},{value:S[0],color:o.$W.theme2.colors.error.main},{value:S[1],color:o.$W.theme2.colors.error.main},{value:S[1],color:"transparent"}),_===l.p.IsOutsideRangeIncluded&&O[B].config.steps.push({value:-1/0,color:o.$W.theme2.colors.error.main},{value:S[0],color:o.$W.theme2.colors.error.main},{value:S[0],color:"transparent"},{value:S[1],color:o.$W.theme2.colors.error.main}),O[B].config.steps.sort((K,T)=>K.value-T.value),O[B].config.steps=O[B].config.steps.filter(K=>K.value!==void 0)}return O}function b(P){return P.evaluator.type===l.p.IsWithinRange||P.evaluator.type===l.p.IsOutsideRange||P.evaluator.type===l.p.IsOutsideRangeIncluded||P.evaluator.type===l.p.IsWithinRangeIncluded}function D(P){const M="Failed to fetch data";if(P.state!==r.Gu.Error)return;const O=P.errors;return O?.length?O.map(j=>j.message??M).join(", "):P.error?.message??M}function C(P,M){const O=M.filter(B=>!(0,g.f)(B.model)).map(B=>B.refId),j=P.filter(B=>!(0,g.f)(B.model)).map(B=>B.refId),[U,W]=(0,n.xor)(j,O);return[U,W]}},94380:(te,R,e)=>{"use strict";e.d(R,{A:()=>z});var n=e(74848),a=e(32899),s=e(92745),i=e(87063),r=e(88559),u=e(45229),o=e(64762),l=e(70327),g=e(96137),f=e(67598),p=e(80218),c=e(71639);function x(){const[w]=(0,c.D)(),[H]=l.hK.endpoints.upsertRuleGroupForNamespace.useMutation(),Q=(0,s.t)("alerting.rules.pause-rule.success","Rule evaluation paused"),Z=(0,s.t)("alerting.rules.resume-rule.success","Rule evaluation resumed");return(0,p.Yb)(async(Y,X,I)=>{const J=(0,f.Rc)(Y),ee=(0,g.LH)({uid:X,pause:I}),{newRuleGroupDefinition:q,rulerConfig:ne}=await w(J,[ee]);return H({rulerConfig:ne,namespace:Y.namespace.uid,payload:q,notificationOptions:{successMessage:I?Q:Z}}).unwrap()})}var v=e(77256);const y=({uid:w,isPaused:H,groupIdentifier:Q,onPauseChange:Z})=>{const Y=(0,o._2)(),[X,I]=x(),[J,ee]=H?["play","Resume evaluation"]:["pause","Pause evaluation"],q=async ne=>{try{await X.execute(Q,w,ne)}catch(se){Y.error(`Failed to ${ne?"pause":"resume"} the rule: ${(0,v.JZ)(se)}`);return}Z?.()};return(0,n.jsx)(i.W.Item,{label:ee,icon:J,disabled:(0,p.VP)(I),onClick:()=>{q(!H)}})};var h=e(27691),d=e(96540),E=e(54092),b=e(46907),D=e(24619),C=e(29609);function P(w,H){const Q=(0,d.useRef)([]),Z=M(w,H),{links:Y}=(0,b.U)(Z);if(!w)return Q.current;const X=(0,C.uo)(w),I=w.type;if(!X||!I)return Q.current;const{pluginId:J}=X;return Y.filter(ee=>ee.pluginId===J)}function M(w,H){return(0,d.useMemo)(()=>{if(!w)return{extensionPointId:""};const Q=w.type,{namespace:Z,groupName:Y}=H,X="uid"in Z?Z.uid:Z.name;switch(Q){case D.JS.Alerting:return{extensionPointId:E.S.AlertingAlertingRuleAction,context:{name:w.name,namespace:X,group:Y,expression:w.query,labels:w.labels??{},annotations:w.annotations??{}}};case D.JS.Recording:return{extensionPointId:E.S.AlertingRecordingRuleAction,context:{name:w.name,namespace:X,group:Y,expression:w.query,labels:w.labels??{}}};default:return{extensionPointId:""}}},[H,w])}var O=e(16692),j=e(94646),U=e(92367),W=e(45967),B=e(3986),S=e(182),_=e(28405);const K=(0,S.Wx)(),T=({title:w="",severity:H="",url:Q=""})=>{const Z=createBridgeURL(K,"/incidents/declare",{title:w,severity:H,url:Q}),{loading:Y,installed:X,settings:I}=usePluginBridge(K);return jsxs(Fragment,{children:[Y===!0&&jsx(Button,{icon:"fire",size:"sm",type:"button",disabled:!0,children:jsx(Trans,{i18nKey:"alerting.declare-incident-button.declare-incident",children:"Declare Incident"})}),X===!1&&jsx(Tooltip,{content:t("alerting.declare-incident-button.content-grafana-incident-installed-configured-correctly","Grafana Incident is not installed or is not configured correctly"),children:jsx(Button,{icon:"fire",size:"sm",type:"button",disabled:!0,children:jsx(Trans,{i18nKey:"alerting.declare-incident-button.declare-incident",children:"Declare Incident"})})}),I&&jsx(LinkButton,{icon:"fire",size:"sm",type:"button",href:Z,children:jsx(Trans,{i18nKey:"alerting.declare-incident-button.declare-incident",children:"Declare Incident"})})]})},L=({title:w="",severity:H="",url:Q=""})=>{const Z=(0,_.h)(K,"/incidents/declare",{title:w,severity:H,url:Q}),{loading:Y,installed:X,settings:I}=(0,B._)(K);return(0,n.jsxs)(n.Fragment,{children:[Y===!0&&(0,n.jsx)(i.W.Item,{label:(0,s.t)("alerting.declare-incident-menu-item.label-declare-incident","Declare incident"),icon:"fire",disabled:!0}),X===!1&&(0,n.jsx)(W.m,{content:(0,s.t)("alerting.declare-incident-menu-item.content-grafana-incident-installed-configured-correctly","Grafana Incident is not installed or is not configured correctly"),children:(0,n.jsx)(i.W.Item,{label:(0,s.t)("alerting.declare-incident-menu-item.label-declare-incident","Declare incident"),icon:"fire",disabled:!0})}),I&&(0,n.jsx)(i.W.Item,{label:(0,s.t)("alerting.declare-incident-menu-item.label-declare-incident","Declare incident"),url:Z,icon:"fire"})]})},A=({promRule:w,rulerRule:H,identifier:Q,groupIdentifier:Z,handleSilence:Y,handleDelete:X,handleDuplicateRule:I,onPauseChange:J,buttonSize:ee,fill:q})=>{const[ne,se,oe,de,fe]=(0,O.Gy)(H,Z,[O.j5.Pause,O.j5.Delete,O.j5.Duplicate,O.j5.Silence,O.j5.ModifyExport]),[ae,ce,ie,ve,le]=(0,O.M6)(C.R$.grafana.rule(w)?w:O.hT,[O.j5.Pause,O.j5.Delete,O.j5.Duplicate,O.j5.Silence,O.j5.ModifyExport]),[Ee,Re]=ne,[Oe,Se]=ae,Te=Ee&&Re||Oe&&Se,[_e,He]=se,[tt,Je]=ce,Ge=_e&&He||tt&&Je,[je,Fe]=oe,[Be,Ke]=ie,Ue=je&&Fe||Be&&Ke,[we,Xe]=de,[nt,he]=ve,xe=we&&Xe||nt&&he,[me,ye]=fe,[De,Le]=le,Ve=me&&ye||De&&Le,ze=P(w,Z),Ze=ze.length>0,Me=(!(0,v.y$)()||(0,v.ES)())&&C.R$.alertingRule(w)&&w.state===D.cF.Firing,$e=(0,v.S2)(Q),at=[Te,xe,Me,Ue].some(Boolean)&&[Ve].some(Boolean),ct=(0,C.xE)(H??w),ft=C.p.grafana.rule(H)&&(0,C.hC)(H)||C.R$.grafana.rule(w)&&w.isPaused,Et=(0,n.jsxs)(n.Fragment,{children:[Te&&ct&&Z.groupOrigin==="grafana"&&(0,n.jsx)(y,{uid:ct,isPaused:ft,groupIdentifier:Z,onPauseChange:J}),xe&&(0,n.jsx)(i.W.Item,{label:(0,s.t)("alerting.alert-menu.silence-notifications","Silence notifications"),icon:"bell-slash",onClick:Y}),Me&&(0,n.jsx)(L,{title:w.name,url:""}),Ue&&(0,n.jsx)(i.W.Item,{label:(0,s.t)("alerting.alert-menu.duplicate","Duplicate"),icon:"copy",onClick:()=>I(Q)}),at&&(0,n.jsx)(i.W.Divider,{}),$e&&(0,n.jsx)(i.W.Item,{label:(0,s.t)("alerting.alert-menu.copy-link","Copy link"),icon:"share-alt",onClick:()=>V($e)}),Ve&&(0,n.jsx)(i.W.Item,{label:(0,s.t)("alerting.alert-menu.export","Export"),icon:"download-alt",childItems:[(0,n.jsx)(N,{identifier:Q},"export-with-modifications")]}),Ze&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.W.Divider,{}),ze.map(St=>(0,n.jsx)(i.W.Item,{label:St.title,icon:St.icon,onClick:St.onClick},St.id))]}),Ge&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.W.Divider,{}),(0,n.jsx)(i.W.Item,{label:(0,s.t)("alerting.common.delete","Delete"),icon:"trash-alt",destructive:!0,onClick:()=>{(0,C.aw)(Q)&&X(Q,Z)}})]})]});return(0,n.jsx)(r.m,{overlay:(0,n.jsx)(i.W,{children:Et}),placement:"bottom",children:(0,n.jsx)(h.A,{size:ee,fill:q})})},N=({identifier:w})=>{const H=window.location.pathname+window.location.search,Q=(0,U.G)(`/alerting/${encodeURIComponent(j.$9(w))}/modify-export`,{returnTo:H});return(0,n.jsx)(i.W.Item,{label:(0,s.t)("alerting.alert-menu.with-modifications","With modifications"),icon:"file-edit-alt",url:Q},"with-modifications")};function V(w){navigator.clipboard?.writeText(w).then(()=>{u.A.emit(a.r1.alertSuccess,["URL copied to clipboard"])})}const z=A},87281:(te,R,e)=>{"use strict";e.d(R,{z:()=>u});var n=e(74848),a=e(70255),s=e(1749),i=e(89640),r=e(77256);const u=({name:l,...g})=>{const{currentData:f,isLoading:p,isSuccess:c}=s.P.endpoints.listReceiver.useQuery({fieldSelector:`spec.title=${l}`}),x=f?.items.at(0)?.metadata.name;return p?o:c&&x?(0,n.jsx)(i.Y,{href:(0,r.vV)(x,{alertmanager:"grafana"}),inline:!1,...g,children:l}):l},o=(0,n.jsx)(a.A,{height:8,width:64})},53567:(te,R,e)=>{"use strict";e.d(R,{w:()=>v});var n=e(74848),a=e(96540),s=e(92745),i=e(36490),r=e(71599),u=e(8535),o=e(74869),l=e(75756),g=e(80276),f=e(11018),p=e(67598),c=e(29609);const x=(0,o.wS)(),v=(m=!1)=>{const[y,h]=(0,a.useState)(),[d]=(0,l.Y)(),{waitForRemoval:E}=(0,g.IH)(),b=(0,o.f2)(),D=(0,a.useCallback)(()=>{h(void 0)},[]),C=(0,a.useCallback)((O,j)=>{h({ruleIdentifier:O,groupIdentifier:j})},[]),P=(0,a.useCallback)(async()=>{if(!y)return;const{ruleIdentifier:O,groupIdentifier:j}=y,U=(0,p.Rc)(j),W=U.dataSourceName;await d.execute(U,O),(0,u.JD)((0,f.Lc)({rulesSourceName:W})),x&&(0,c.X4)(O)?await E(O):await(0,u.JD)((0,f.eB)({rulesSourceName:W})),D(),m&&i.Ny.replace("/alerting/list")},[d,D,y,m,E]);return[(0,a.useMemo)(()=>(0,n.jsx)(r.u,{isOpen:!!y,title:(0,s.t)("alerting.delete-rule-modal.title","Delete rule"),body:b?(0,s.t)("alerting.delete-rule-modal.with-soft-delete","Are you sure you want to delete this rule? This rule will be recoverable from the Recently deleted page by a user with an admin role."):(0,s.t)("alerting.delete-rule-modal.without-soft-delete","Deleting this rule will permanently remove it from your alert rule list. Are you sure you want to delete this rule?"),confirmText:(0,s.t)("alerting.use-delete-modal.modal.confirmText-yes-delete","Yes, delete"),icon:"exclamation-triangle",onConfirm:P,onDismiss:D}),[y,P,D,b]),C,D]}},41517:(te,R,e)=>{"use strict";e.d(R,{X:()=>u});var n=e(74848),a=e(92745),s=e(34999),i=e(41654),r=e(45861);function u(){return(0,n.jsx)(s.F,{severity:"info",title:(0,a.t)("alerting.federated-rule-warning.title-federated-group","This rule is part of a federated rule group."),bottomSpacing:0,topSpacing:2,children:(0,n.jsxs)(i.B,{direction:"column",children:[(0,n.jsx)(a.x6,{i18nKey:"alerting.federated-rule-warning.experimental",children:"Federated rule groups are currently an experimental feature."}),(0,n.jsx)(r.$n,{fill:"text",icon:"book",children:(0,n.jsx)("a",{href:"https://grafana.com/docs/metrics-enterprise/latest/tenant-management/tenant-federation/#cross-tenant-alerting-and-recording-rule-federation",children:(0,n.jsx)(a.x6,{i18nKey:"alerting.federated-rule-warning.read-documentation",children:"Read documentation"})})})]})})}},54552:(te,R,e)=>{"use strict";e.d(R,{K:()=>i,k:()=>r});var n=e(74848),a=e(96540);const s=a.createContext(void 0),i=({children:u,rule:o,identifier:l})=>{const g={rule:o,identifier:l};return(0,n.jsx)(s.Provider,{value:g,children:u})},r=()=>{const u=a.useContext(s);if(u===void 0)throw new Error("useAlertRule must be used within a AlertRuleContext");return u}},22973:(te,R,e)=>{"use strict";e.d(R,{gQ:()=>_t,rf:()=>Fa,Ay:()=>Aa,lf:()=>Ca,P5:()=>oa});var n=e(74848),a=e(22803),s=e(2543),i=e(96540),r=e(49185),u=e(92745),o=e(41654),l=e(34999),g=e(13941),f=e(63142),p=e(89640),c=e(66404),x=e(45861),v=e(36303),m=e(47327),y=e(70958),h=e(85311),d=e(3969),E=e(86791),b=e(24619),D=e(74268),C=e(28390),P=e(74869),M=e(80218),O=e(44109),j=e(11940),U=e(80276),W=e(39187),B=e(17305),S=e(95443),_=e(52161),K=e(39659),T=e(77256),L=e(29442),A=e(29609),N=e(7840),V=e(36826),z=e(1972),w=e(2401),H=e(88589),Q=e(14050),Z=e(87281),Y=e(41517),X=e(30703);function I(){return(0,n.jsx)(c.E,{variant:"bodySmall",color:"warning",children:(0,n.jsxs)(o.B,{direction:"row",alignItems:"center",gap:.25,wrap:"nowrap",flex:"0 0 auto",children:[(0,n.jsx)(X.I,{name:"pause",size:"xs"})," ",(0,n.jsx)(u.x6,{i18nKey:"alerting.paused-badge.paused",children:"Paused"})]})})}var J=e(54552);const ee=({color:xt,includeState:dt})=>{const bt=(0,f.of)(q,{color:xt,includeState:dt});return(0,n.jsx)(o.B,{direction:"row",gap:.5,children:(0,n.jsx)("div",{className:bt.dot})})},q=(xt,dt)=>{const bt=xt.spacing(1.25),Mt=`calc(${bt} / 2.5)`,Bt=dt.color==="error",Kt=dt.color==="success",Qt=dt.color==="warning";return{dot:(0,a.css)({width:bt,height:bt,borderRadius:xt.shape.radius.circle,backgroundColor:xt.colors.secondary.main,outline:`solid ${Mt} ${xt.colors.secondary.transparent}`,margin:Mt},Kt&&(0,a.css)({backgroundColor:xt.colors.success.main,outlineColor:xt.colors.success.transparent}),Qt&&(0,a.css)({backgroundColor:xt.colors.warning.main,outlineColor:xt.colors.warning.transparent}),Bt&&(0,a.css)({backgroundColor:xt.colors.error.main,outlineColor:xt.colors.error.transparent}))}},ne=({health:xt})=>{const dt=Ca(xt),bt=dt?"error":"success",Mt=dt?"Recording error":"Recording";return(0,n.jsx)(oe,{color:bt,text:Mt})},se=({state:xt,health:dt})=>{let bt,Mt;switch(xt){case b.cF.Inactive:Mt="success",bt="Normal";break;case b.cF.Firing:Mt="error",bt="Firing";break;case b.cF.Pending:Mt="warning",bt="Pending";break;case b.cF.Recovering:Mt="warning",bt="Recovering";break;case b.cF.Unknown:Mt="info",bt="Unknown";break}return Ca(dt)&&(Mt="error",bt="Error"),dt==="nodata"&&(Mt="warning",bt="No data"),(0,n.jsx)(oe,{color:Mt,text:bt})};function oe({color:xt,text:dt}){return(0,n.jsxs)(o.B,{direction:"row",gap:.5,wrap:"nowrap",flex:"0 0 auto",children:[(0,n.jsx)(ee,{color:xt}),(0,n.jsx)(c.E,{variant:"bodySmall",color:xt,children:dt})]})}var de=e(3845),fe=e(45746),ae=e(43173),ce=e(58138);const ie=(0,i.lazy)(()=>e.e(2835).then(e.bind(e,32835))),ve=(0,i.lazy)(()=>Promise.all([e.e(8706),e.e(4302)]).then(e.bind(e,54302))),le=({rule:xt})=>{const dt=ae.$.unifiedAlerting.alertStateHistoryBackend,bt=ae.$.unifiedAlerting.alertStateHistoryPrimary,Bt=[dt,bt].some(Qt=>Qt===ce.Q.Loki)?ce.Q.Loki:ce.Q.Annotations,Kt=xt.grafana_alert.uid;return(0,n.jsxs)(i.Suspense,{fallback:"Loading...",children:[Bt===ce.Q.Loki&&(0,n.jsx)(ve,{ruleUID:Kt}),Bt===ce.Q.Annotations&&(0,n.jsx)(ie,{ruleUID:Kt})]})};var Ee=e(95943),Re=e(66773);const Oe=({rule:xt})=>(0,n.jsx)(Re.s,{rule:xt,pagination:{itemsPerPage:Ee.FG},enableFiltering:!0});var Se=e(17548),Te=e(83175),_e=e(27074),He=e(99887),tt=e(44022),Je=e(4651),Ge=e(2954),je=e(49779),Fe=e(51993),Be=e(55376),Ke=e(89144);function Ue({data:xt,thresholds:dt}){return xt?(0,n.jsx)(Ke.j,{data:xt,thresholds:dt?.config,thresholdsType:dt?.mode}):null}var we=e(20382),Xe=e(20437),nt=e(65232);const he=({expression:xt})=>(0,n.jsx)(nt.m,{options:{readOnly:!0,minimap:{enabled:!1},scrollBeyondLastColumn:0,scrollBeyondLastLine:!1,lineNumbers:"off",cursorWidth:0,overviewRulerLanes:0},defaultLanguage:"sql",height:80,defaultValue:xt,width:"100%"});function xe(xt){return"rawSql"in xt}const me=null,ye=i.lazy(()=>e.e(3659).then(e.bind(e,33659))),De=i.lazy(()=>e.e(4964).then(e.bind(e,24964)));function Le({model:xt,dataSource:dt}){return(0,_.bS)(dt.type)&&(0,Xe.Bu)(xt)?(0,n.jsx)(ye,{query:xt.expr}):dt.type===_.ol.Loki&&(0,Xe.Bu)(xt)?(0,n.jsx)(De,{query:xt.expr??""}):xe(xt)?(0,n.jsx)(he,{expression:xt.rawSql}):(0,n.jsx)("pre",{children:(0,n.jsx)("code",{children:(0,we.Bh)(xt)})})}var Ve=e(16692);function ze({rule:xt,queries:dt,condition:bt,evalDataByQuery:Mt={}}){const Bt=(0,s.keyBy)(Object.values(ae.$.datasources),kt=>kt.uid),Kt=dt.filter(kt=>!(0,tt.f)(kt.model)),Qt=dt.filter(kt=>(0,tt.f)(kt.model)),Zt=(0,f.of)(Xt),nn=(0,Be.an)(dt,bt);return(0,n.jsxs)(o.B,{gap:1,direction:"column",flex:"1 1 320px",children:[(0,n.jsx)("div",{className:Zt.maxWidthContainer,children:(0,n.jsx)(o.B,{gap:1,wrap:"wrap","data-testid":"queries-container",children:Kt.map(({model:kt,relativeTimeRange:bn,refId:Ln,datasourceUid:Yn},Hn)=>{const It=Bt[Yn];return(0,n.jsx)(Ze,{rule:xt,refId:Ln,model:kt,relativeTimeRange:bn,dataSource:It,thresholds:nn[Ln],queryData:Mt[Ln]},Hn)})})}),(0,n.jsx)("div",{className:Zt.maxWidthContainer,children:(0,n.jsx)(o.B,{gap:1,wrap:"wrap","data-testid":"expressions-container",children:Qt.map(({model:kt,refId:bn,datasourceUid:Ln},Yn)=>(0,tt.f)(kt)&&(0,n.jsx)(ct,{refId:bn,isAlertCondition:bt===bn,model:kt,evalData:Mt[bn]},Yn))})})]})}function Ze({refId:xt,rule:dt,thresholds:bt,model:Mt,dataSource:Bt,queryData:Kt,relativeTimeRange:Qt}){const Zt=(0,f.of)(at),nn=(0,tt.f)(Mt),[kt,bn]=(0,Ve.mh)(dt,Ve.j5.Explore),Ln=kt&&bn,Yn=[];if(Bt){const It=Bt.name??"[[Data source not found]]",yt=Bt.meta.info.logos.small;Yn.push((0,n.jsx)($e,{name:It,imgUrl:yt},"datasource"))}Qt&&Yn.push((0,n.jsx)(c.E,{color:"secondary",children:(0,n.jsxs)(u.x6,{i18nKey:"alerting.query-preview.relative-time-range",values:{from:Se.secondsToHms(Qt.from)},children:[(0,n.jsx)("code",{children:"{{from}}"})," to now"]})},"timerange"));let Hn;return!nn&&Ln&&(Hn=Bt&&Me(Bt,Mt)),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ft,{refId:xt,headerItems:Yn,exploreLink:Hn,children:(0,n.jsx)("div",{className:Zt.queryPreviewWrapper,children:(0,n.jsx)(v.Xw,{children:Mt&&Bt&&(0,n.jsx)(Le,{model:Mt,dataSource:Bt})})})}),Bt&&(0,n.jsx)(Ue,{data:Kt,thresholds:bt})]})}function Me(xt,dt){const{uid:bt,type:Mt}=xt,{refId:Bt,...Kt}=dt;return Te.kM.renderUrl(`${ae.$.appSubUrl}/explore`,{left:JSON.stringify({datasource:xt.uid,queries:[{refId:"A",...Kt,datasource:{type:Mt,uid:bt}}],range:{from:"now-1h",to:"now"}})})}function $e({name:xt,imgUrl:dt}){const bt=(0,f.of)(at);return(0,n.jsxs)("div",{className:bt.dataSource,children:[(0,n.jsx)("img",{src:dt,width:16,alt:xt}),xt]},"datasource")}const at=xt=>({queryPreviewWrapper:(0,a.css)({margin:xt.spacing(1)}),contentBox:(0,a.css)({flex:"1 0 100%"}),dataSource:(0,a.css)({border:`1px solid ${xt.colors.border.weak}`,borderRadius:xt.shape.radius.default,padding:xt.spacing(.5,1),display:"flex",alignItems:"center",gap:xt.spacing(1)})});function ct({refId:xt,model:dt,evalData:bt,isAlertCondition:Mt}){const Bt=(0,f.of)(Et);function Kt(){switch(dt.type){case Je.Tz.math:return(0,n.jsx)(En,{model:dt});case Je.Tz.reduce:return(0,n.jsx)(Dt,{model:dt});case Je.Tz.resample:return(0,n.jsx)(mt,{model:dt});case Je.Tz.classic:return(0,n.jsx)(St,{model:dt});case Je.Tz.threshold:return(0,n.jsx)(Jt,{model:dt});case Je.Tz.sql:return(0,n.jsx)(_e.l,{rawSql:dt.expression||"",datasourceType:dt.datasource?.type});default:return(0,n.jsxs)(u.x6,{i18nKey:"alerting.expression-preview.expression-not-supported",values:{type:dt.type},children:["Expression not supported: ","{{type}}"]})}}return(0,n.jsxs)(ft,{refId:xt,headerItems:[(0,n.jsx)(c.E,{color:"secondary",children:(0,s.startCase)(dt.type)},"expression-type")],isAlertCondition:Mt,children:[(0,n.jsxs)("div",{className:Bt.previewWrapper,children:[bt?.errors?.map(Qt=>(0,n.jsx)(l.F,{title:(0,u.t)("alerting.expression-preview.title-expression-failed","Expression failed"),severity:"error",bottomSpacing:1,children:Qt.message},(0,s.uniqueId)())),Kt()]}),(0,n.jsx)(je.h,{}),bt&&(0,n.jsx)(Fe.GX,{series:bt.series,isAlertCondition:Mt})]})}function ft({refId:xt,headerItems:dt=[],children:bt,isAlertCondition:Mt,exploreLink:Bt}){const Kt=(0,f.of)(Et);return(0,n.jsxs)("div",{className:(0,a.cx)(Kt.container),children:[(0,n.jsxs)("header",{className:Kt.header,children:[(0,n.jsx)("span",{className:Kt.refId,children:xt}),dt,(0,n.jsx)(je.h,{}),Mt&&(0,n.jsx)(He.E,{color:"green",icon:"check",text:(0,u.t)("alerting.query-box.text-alert-condition","Alert condition")}),Bt&&(0,n.jsx)(w.d,{component:(0,n.jsx)(x.z9,{size:"md",variant:"secondary",icon:"compass",href:Bt,children:(0,n.jsx)(u.x6,{i18nKey:"alerting.query-box.view-in-explore",children:"View in Explore"})})})]}),bt]})}const Et=xt=>({container:(0,a.css)({flex:"1 0 25%",border:`1px solid ${xt.colors.border.weak}`,maxWidth:"100%",borderRadius:xt.shape.radius.default,display:"flex",flexDirection:"column"}),header:(0,a.css)({display:"flex",alignItems:"center",gap:xt.spacing(1),padding:xt.spacing(1),backgroundColor:xt.colors.background.secondary}),textBlock:(0,a.css)({border:`1px solid ${xt.colors.border.weak}`,padding:xt.spacing(.5,1),backgroundColor:xt.colors.background.primary,borderRadius:xt.shape.radius.default}),refId:(0,a.css)({color:xt.colors.text.link,padding:xt.spacing(.5,1),border:`1px solid ${xt.colors.border.weak}`,borderRadius:xt.shape.radius.default}),previewWrapper:(0,a.css)({padding:xt.spacing(1)})});function St({model:xt}){const dt=(0,f.of)(Pt),bt=(0,s.keyBy)(Ge.A.reducerTypes,Kt=>Kt.value),Mt=(0,s.keyBy)(Ge.A.evalOperators,Kt=>Kt.value),Bt=(0,s.keyBy)(Ge.A.evalFunctions,Kt=>Kt.value);return(0,n.jsx)("div",{className:dt.container,children:xt.conditions?.map(({query:Kt,operator:Qt,reducer:Zt,evaluator:nn},kt)=>{const bn=cn(nn);return(0,n.jsxs)(i.Fragment,{children:[(0,n.jsx)("div",{className:dt.blue,children:kt===0?(0,u.t)("alerting.classic-condition-viewer.when","WHEN"):!!Qt?.type&&Mt[Qt?.type]?.text}),(0,n.jsx)("div",{className:dt.bold,children:Zt?.type&&bt[Zt.type]?.text}),(0,n.jsx)("div",{className:dt.blue,children:(0,n.jsx)(u.x6,{i18nKey:"alerting.classic-condition-viewer.of",children:"OF"})}),(0,n.jsx)("div",{className:dt.bold,children:Kt.params[0]}),(0,n.jsx)("div",{className:dt.blue,children:Bt[nn.type].text}),(0,n.jsx)("div",{className:dt.bold,children:bn?`(${nn.params[0]}; ${nn.params[1]})`:nn.params[0]})]},kt)})})}const Pt=xt=>({container:(0,a.css)({display:"grid",gridTemplateColumns:"repeat(6, max-content)",gap:xt.spacing(0,1)}),...ln(xt)});function Dt({model:xt}){const dt=(0,f.of)(Ye),{reducer:bt,expression:Mt,settings:Bt}=xt,Kt=Je.Cu.find(nn=>nn.value===bt),Qt=Bt?.mode??Je.Mt.Strict,Zt=Je.HZ.find(nn=>nn.value===Qt);return(0,n.jsxs)("div",{className:dt.container,children:[(0,n.jsx)("div",{className:dt.label,children:(0,n.jsx)(u.x6,{i18nKey:"alerting.reduce-condition-viewer.function",children:"Function"})}),(0,n.jsx)("div",{className:dt.value,children:Kt?.label}),(0,n.jsx)("div",{className:dt.label,children:(0,n.jsx)(u.x6,{i18nKey:"alerting.reduce-condition-viewer.input",children:"Input"})}),(0,n.jsx)("div",{className:dt.value,children:Mt}),(0,n.jsx)("div",{className:dt.label,children:(0,n.jsx)(u.x6,{i18nKey:"alerting.reduce-condition-viewer.mode",children:"Mode"})}),(0,n.jsx)("div",{className:dt.value,children:Zt?.label})]})}const Ye=xt=>({container:(0,a.css)({display:"grid",gap:xt.spacing(.5),gridTemplateRows:"1fr 1fr",gridTemplateColumns:"repeat(4, 1fr)","> :nth-child(6)":{gridColumn:"span 3"}}),...ln(xt)});function mt({model:xt}){const dt=(0,f.of)(zt),{expression:bt,window:Mt,downsampler:Bt,upsampler:Kt}=xt,Qt=Je.PN.find(nn=>nn.value===Bt),Zt=Je.iX.find(nn=>nn.value===Kt);return(0,n.jsxs)("div",{className:dt.container,children:[(0,n.jsx)("div",{className:dt.label,children:(0,n.jsx)(u.x6,{i18nKey:"alerting.resample-expression-viewer.input",children:"Input"})}),(0,n.jsx)("div",{className:dt.value,children:bt}),(0,n.jsx)("div",{className:dt.label,children:(0,n.jsx)(u.x6,{i18nKey:"alerting.resample-expression-viewer.resample-to",children:"Resample to"})}),(0,n.jsx)("div",{className:dt.value,children:Mt}),(0,n.jsx)("div",{className:dt.label,children:(0,n.jsx)(u.x6,{i18nKey:"alerting.resample-expression-viewer.downsample",children:"Downsample"})}),(0,n.jsx)("div",{className:dt.value,children:Qt?.label}),(0,n.jsx)("div",{className:dt.label,children:(0,n.jsx)(u.x6,{i18nKey:"alerting.resample-expression-viewer.upsample",children:"Upsample"})}),(0,n.jsx)("div",{className:dt.value,children:Zt?.label})]})}const zt=xt=>({container:(0,a.css)({display:"grid",gap:xt.spacing(.5),gridTemplateColumns:"repeat(4, 1fr)",gridTemplateRows:"1fr 1fr"}),...ln(xt)});function Jt({model:xt}){const dt=(0,f.of)(Xt),{expression:bt,conditions:Mt}=xt,Bt=Mt&&Mt[0]?.evaluator,Kt=Je.zd.find(bn=>bn.value===Bt?.type),Qt=Bt?cn(Bt):!1,Zt=Mt&&Mt[0]?.unloadEvaluator,nn=Je.zd.find(bn=>bn.value===Zt?.type),kt=Zt?cn(Zt):!1;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:dt.container,children:[(0,n.jsx)("div",{className:dt.label,children:(0,n.jsx)(u.x6,{i18nKey:"alerting.threshold-expression-viewer.input",children:"Input"})}),(0,n.jsx)("div",{className:dt.value,children:bt}),Bt&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:dt.blue,children:Kt?.label}),(0,n.jsx)("div",{className:dt.bold,children:Qt?`(${Bt.params[0]}; ${Bt.params[1]})`:Bt.params[0]})]})]}),(0,n.jsx)("div",{className:dt.container,children:Zt&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:dt.label,children:(0,n.jsxs)(u.x6,{i18nKey:"alerting.threshold-expression-viewer.stop-alerting-when",children:["Stop alerting (or pending state) when"," "]})}),(0,n.jsx)("div",{className:dt.value,children:bt}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:dt.blue,children:nn?.label}),(0,n.jsx)("div",{className:dt.bold,children:kt?`(${Zt.params[0]}; ${Zt.params[1]})`:Zt.params[0]})]})]})})]})}const Xt=xt=>{const{blue:dt,bold:bt,...Mt}=ln(xt);return{...Mt,maxWidthContainer:(0,a.css)({maxWidth:"100%"}),container:(0,a.css)({display:"flex",gap:xt.spacing(.5)}),blue:(0,a.css)(dt,{margin:"auto 0"}),bold:(0,a.css)(bt,{margin:"auto 0"})}};function En({model:xt}){const dt=(0,f.of)(Xt),{expression:bt}=xt;return(0,n.jsxs)("div",{className:dt.container,children:[(0,n.jsx)("div",{className:dt.label,children:(0,n.jsx)(u.x6,{i18nKey:"alerting.math-expression-viewer.input",children:"Input"})}),(0,n.jsx)("div",{className:dt.value,children:bt})]})}const ln=xt=>({blue:(0,a.css)({color:xt.colors.text.link}),bold:(0,a.css)({fontWeight:xt.typography.fontWeightBold}),label:(0,a.css)({display:"flex",alignItems:"center",padding:xt.spacing(.5,1),backgroundColor:xt.colors.background.secondary,fontSize:xt.typography.bodySmall.fontSize,lineHeight:xt.typography.bodySmall.lineHeight,fontWeight:xt.typography.fontWeightBold,borderRadius:xt.shape.radius.default}),value:(0,a.css)({padding:xt.spacing(.5,1),border:`1px solid ${xt.colors.border.weak}`,borderRadius:xt.shape.radius.default})});function cn(xt){return xt.type===Ge.p.IsWithinRange||xt.type===Ge.p.IsOutsideRange||xt.type===Ge.p.IsOutsideRangeIncluded||xt.type===Ge.p.IsWithinRangeIncluded}var Pn=e(55096),wn=e(1932),jn=e(15629);function kn(xt){if(!xt)return[];const{namespace:dt,rulerRule:bt}=xt,{rulesSource:Mt}=dt;if(A.p.grafana.rule(bt)){const Bt=bt.grafana_alert.data;return gt(Bt,bt.for??"",xt.group.interval)}if((0,_.Eb)(Mt)){const Bt=Rt(Mt,xt);return[Lt(Bt,Mt.uid)]}return[]}function gt(xt,dt,bt){const Mt=(0,jn.P8)(dt)??(0,jn.P8)(bt??"1m"),Bt=Math.floor(Mt/1e3);return xt.map(Kt=>(0,wn.jM)(Kt,Qt=>{const Zt=Qt.relativeTimeRange?.from??0,nn=Math.max(Bt*3,Zt+Bt*2);Qt.relativeTimeRange={from:nn,to:0}}))}function Lt(xt,dt){return{refId:xt.refId,datasourceUid:dt,queryType:"",model:xt,relativeTimeRange:{from:360,to:0}}}function Rt(xt,dt){if(!(0,_.cl)(xt.type))throw new Error(`Query for datasource type ${xt.type} is currently not supported by cloud alert rules.`);return{refId:"A",expr:dt.query}}var Ut=e(54513);const Gt=({rule:xt})=>{const{queryPreviewData:dt,runQueries:bt,isPreviewLoading:Mt}=(0,Ut.Y)(),Bt=(0,i.useMemo)(()=>kn(xt),[xt]),{allDataSourcesAvailable:Kt}=(0,Pn.g)(Bt),Qt=(0,i.useCallback)(()=>{if(Bt.length>0&&Kt){let nn;xt&&A.p.grafana.rule(xt.rulerRule)&&(nn=xt.rulerRule.grafana_alert.condition),bt(Bt,nn??"A")}},[Bt,Kt,xt,bt]);(0,i.useEffect)(()=>{Kt&&Qt()},[Kt,Qt]);const Zt=(0,A.YN)(xt.group);return Mt?(0,n.jsx)(u.x6,{i18nKey:"alerting.common.loading",children:"Loading..."}):(0,n.jsxs)(n.Fragment,{children:[A.p.grafana.rule(xt.rulerRule)&&!Zt&&(0,n.jsx)(ze,{rule:xt,condition:xt.rulerRule.grafana_alert.condition,queries:Bt,evalDataByQuery:dt}),!A.p.grafana.rule(xt.rulerRule)&&!Zt&&dt&&Object.keys(dt).length>0&&(0,n.jsx)(o.B,{direction:"column",gap:1,children:Bt.map(nn=>(0,n.jsx)(Ze,{rule:xt,refId:nn.refId,model:nn.model,dataSource:Object.values(ae.$.datasources).find(kt=>kt.uid===nn.datasourceUid),queryData:dt[nn.refId],relativeTimeRange:nn.relativeTimeRange},nn.refId))}),!Zt&&!Kt&&(0,n.jsx)(l.F,{title:(0,u.t)("alerting.rule-view.query.datasources-na.title","Query not available"),severity:"warning",children:(0,n.jsx)(u.x6,{i18nKey:"alerting.rule-view.query.datasources-na.description",children:"Cannot display the query preview. Some of the data sources used in the queries are not available."})})]})},Ft=()=>(0,n.jsx)(u.x6,{i18nKey:"alerting.routing.routing",children:"Routing"});var _t=(xt=>(xt.Query="query",xt.Instances="instances",xt.History="history",xt.Routing="routing",xt.Details="details",xt.VersionHistory="version-history",xt))(_t||{});const tn=(0,P.wS)(),xn=(0,P.sk)(),mn=tn||xn,An=()=>{const{rule:xt,identifier:dt}=(0,J.k)(),{pageNav:bt,activeTab:Mt}=Da(xt),[Bt,Kt]=(0,i.useState)(),{returnTo:Qt}=(0,W.h)("/alerting/list"),{annotations:Zt,promRule:nn,rulerRule:kt}=xt,bn=Ca(nn?.health),Ln=(0,A.YN)(xt.group),Yn=A.p.grafana.rule(kt)&&!!kt.grafana_alert.provenance,Hn=A.p.grafana.rule(kt)&&(0,A.hC)(kt),It=bn&&!Hn,yt=kt?(0,A.uo)(kt):(0,A.uo)(nn),Vt=Zt[S.YH.summary];return(0,n.jsxs)(V.d,{pageNav:bt,navId:"alert-list",isLoading:!1,renderTitle:fn=>(0,n.jsx)(ca,{name:fn,paused:Hn,state:A.R$.alertingRule(nn)?nn.state:void 0,health:nn?.health,ruleType:nn?.type,ruleOrigin:yt,returnToHref:Qt}),actions:(0,n.jsx)(d.l,{rule:xt,rulesSource:xt.namespace.rulesSource}),info:ia(xt),subTitle:(0,n.jsxs)(o.B,{direction:"column",children:[Vt,Hn&&(0,n.jsx)(h.A,{}),Ln&&(0,n.jsx)(Y.X,{}),Yn&&(0,n.jsx)(z.Yi,{resource:z.hk.AlertRule,bottomSpacing:0,topSpacing:2}),It&&(0,n.jsx)(l.F,{title:(0,u.t)("alerting.rule-viewer.title-something-wrong-evaluating-alert","Something went wrong when evaluating this alert rule"),bottomSpacing:0,topSpacing:2,children:(0,n.jsx)("pre",{style:{marginBottom:0},children:(0,n.jsx)("code",{children:xt.promRule?.lastError??"No error message"})})})]}),children:[mn&&(0,n.jsx)(ea,{ruleIdentifier:dt}),(0,n.jsx)(o.B,{direction:"column",gap:2,children:(0,n.jsxs)(g.J,{children:[Mt==="query"&&(0,n.jsx)(Gt,{rule:xt}),Mt==="instances"&&(0,n.jsx)(Oe,{rule:xt}),Mt==="history"&&A.p.grafana.rule(xt.rulerRule)&&(0,n.jsx)(le,{rule:xt.rulerRule}),Mt==="routing"&&(0,n.jsx)(Ft,{}),Mt==="details"&&(0,n.jsx)(fe.B,{rule:xt}),Mt==="version-history"&&A.p.grafana.rule(xt.rulerRule)&&(0,n.jsx)(de.f,{rule:xt.rulerRule})]})}),Bt&&(0,n.jsx)(Q.Z,{redirectTo:!0,identifier:Bt,isProvisioned:Yn,onDismiss:()=>Kt(void 0)})]})},ia=xt=>{const{labels:dt,annotations:bt,group:Mt,rulerRule:Bt}=xt,Kt=[],Qt=bt[S.YH.runbookURL],Zt=bt[S.YH.dashboardUID],nn=bt[S.YH.panelID],kt=Zt&&nn,bn=Zt,Ln=(0,K.rm)(dt)>0,Yn=Mt.interval,Hn=(0,f.of)(Xn);if(A.p.grafana.alertingRule(Bt)){const It=Bt.grafana_alert.notification_settings?.receiver;It&&Kt.push({label:(0,u.t)("alerting.create-metadata.label.contact-point","Notifications are delivered to"),value:(0,n.jsx)(Z.z,{name:It,variant:"bodySmall"})})}if(Qt){const It=(0,s.truncate)(Qt,{length:42}),yt=ps(Qt)?(0,n.jsx)(p.Y,{variant:"bodySmall",className:Hn.url,href:Qt,external:!0,children:It}):(0,n.jsx)(c.E,{variant:"bodySmall",children:It});Kt.push({label:(0,u.t)("alerting.create-metadata.label.runbook-url","Runbook URL"),value:yt})}if(kt?Kt.push({label:(0,u.t)("alerting.create-metadata.label.dashboard-and-panel","Dashboard and panel"),value:(0,n.jsx)(w.d,{title:xt.name,component:(0,n.jsx)(p.Y,{variant:"bodySmall",href:(0,T.D2)(Zt,nn),children:(0,n.jsx)(u.x6,{i18nKey:"alerting.create-metadata.view-panel",children:"View panel"})})})}):bn&&Kt.push({label:(0,u.t)("alerting.create-metadata.label.dashboard","Dashboard"),value:(0,n.jsx)(w.d,{title:xt.name,component:(0,n.jsx)(p.Y,{title:xt.name,variant:"bodySmall",href:(0,T.JM)(Zt),children:(0,n.jsx)(u.x6,{i18nKey:"alerting.create-metadata.view-dashboard",children:"View dashboard"})})})}),A.p.grafana.recordingRule(xt.rulerRule)){const It=xt.rulerRule?.grafana_alert.record?.metric??"";Kt.push({label:(0,u.t)("alerting.create-metadata.label.metric-name","Metric name"),value:(0,n.jsx)(c.E,{color:"primary",children:It})})}return Yn&&Kt.push({label:(0,u.t)("alerting.create-metadata.label.evaluation-interval","Evaluation interval"),value:(0,n.jsx)(c.E,{color:"primary",children:(0,n.jsxs)(u.x6,{i18nKey:"alerting.rule-viewer.evaluation-interval",children:["Every ",{interval:Yn}]})})}),Ln&&Kt.push({label:(0,u.t)("alerting.create-metadata.label.labels","Labels"),value:(0,n.jsx)(N.m,{labels:dt,size:"sm"})}),Kt},ca=({name:xt,paused:dt=!1,state:bt,health:Mt,ruleType:Bt,ruleOrigin:Kt,returnToHref:Qt=""})=>{const Zt=Bt===b.JS.Recording,{returnTo:nn}=(0,W.h)(Qt);return(0,n.jsxs)(o.B,{direction:"row",gap:1,minWidth:0,alignItems:"center",children:[Qt&&(0,n.jsx)(x.z9,{variant:"secondary",icon:"angle-left",href:nn}),Kt&&(0,n.jsx)(B.T,{pluginId:Kt.pluginId,size:"lg"}),(0,n.jsx)(c.E,{variant:"h1",truncate:!0,children:xt}),dt?(0,n.jsx)(I,{}):(0,n.jsxs)(n.Fragment,{children:[bt&&(0,n.jsx)(se,{state:bt,health:Mt}),Zt&&(0,n.jsx)(ne,{health:Mt})]})]})},ea=(0,v.Xc)(({ruleIdentifier:xt})=>{const[dt,{width:bt}]=(0,r.A)(),{hasRuler:Mt}=(0,j.w)((0,_.bt)(xt)),{result:Bt}=(0,O.FY)(xt),{waitForGroupConsistency:Kt,groupConsistent:Qt}=(0,U.zx)(),[Zt,nn]=(0,M.Yb)(kt=>Kt(kt));return(0,i.useEffect)(()=>{Bt&&Mt&&Zt.execute(Bt.groupIdentifier)},[Bt,Mt,Zt]),(0,M.bJ)(nn)?(0,n.jsx)(l.F,{title:(0,u.t)("alerting.prometheus-consistency-check.title-unable-to-check-the-rule-status","Unable to check the rule status"),bottomSpacing:0,topSpacing:2,children:(0,T.JZ)(nn.error)}):Qt===!1?(0,n.jsxs)(o.B,{direction:"column",gap:0,ref:dt,children:[(0,n.jsx)(m.G,{width:bt}),(0,n.jsx)(l.F,{title:(0,u.t)("alerting.rule-viewer.prometheus-consistency-check.alert-title","Update in progress"),severity:"info",children:(0,n.jsx)(u.x6,{i18nKey:"alerting.rule-viewer.prometheus-consistency-check.alert-message",children:"Alert rule has been added or updated. Changes may take up to a minute to appear on the Alert rules list view."})})]}):null},{errorLogger:D.vV}),Ca=xt=>xt==="error"||xt==="err";function oa(){const[xt,dt]=(0,y.s)(),bt=xt.tab;return[Jn(bt)?bt:"query",Kt=>{dt({tab:Kt})}]}function Jn(xt){return typeof xt=="string"&&Object.values(_t).includes(xt)}function Da(xt){const[dt,bt]=oa(),{annotations:Mt,promRule:Bt,rulerRule:Kt}=xt,Qt=Mt[S.YH.summary],nn=A.R$.alertingRule(Bt)?Fa(xt.instanceTotals):void 0,kt=(0,H.EL)(xt.namespace).name,bn=xt.group.name,Ln=A.p.grafana.alertingRule(Kt),Yn=A.p.grafana.recordingRule(Kt),Hn=A.R$.recordingRule(Bt);return{pageNav:{...C.defaultPageNav,text:xt.name,subTitle:Qt,children:[{text:(0,u.t)("alerting.use-page-nav.page-nav.text.query-and-conditions","Query and conditions"),active:dt==="query",onClick:()=>{bt("query")}},{text:(0,u.t)("alerting.use-page-nav.page-nav.text.instances","Instances"),active:dt==="instances",onClick:()=>{bt("instances")},tabCounter:nn,hideFromTabs:Hn},{text:(0,u.t)("alerting.use-page-nav.page-nav.text.history","History"),active:dt==="history",onClick:()=>{bt("history")},hideFromTabs:!Ln},{text:(0,u.t)("alerting.use-page-nav.page-nav.text.details","Details"),active:dt==="details",onClick:()=>{bt("details")}},{text:(0,u.t)("alerting.use-page-nav.page-nav.text.versions","Versions"),active:dt==="version-history",onClick:()=>{bt("version-history")},hideFromTabs:!Ln&&!Yn}],parentItem:{text:bn,url:(0,L.tx)([["namespace",kt],["group",bn]]),parentItem:{text:kt,url:(0,L.tx)([["namespace",kt]])}}},activeTab:dt}}const Fa=xt=>(0,s.chain)(xt).pick([E.$7.Alerting,E.$7.Pending,E.$7.Recovering,E.$7.Normal,E.$7.NoData,E.$7.Error]).values().sum().value(),Xn=()=>({url:(0,a.css)({wordBreak:"break-all"})});function ps(xt){const dt=xt.startsWith("/");let bt=!1;try{new URL(xt),bt=!0}catch{return!1}return dt||bt}const Aa=An},3845:(te,R,e)=>{"use strict";e.d(R,{f:()=>se,R:()=>ne});var n=e(74848),a=e(96540),s=e(92745),i=e(43173),r=e(34999),u=e(6975),o=e(50201),l=e(41654),g=e(66404),f=e(45967),p=e(45861),c=e(74268),x=e(70327),v=e(16692),m=e(52161),y=e(77256),h=e(8207),d=e(2543),E=e(80011),b=e(31286),D=e(30703),C=e(3271),P=e(34753),M=e(1199),O=e(61371);const j=({info:oe})=>{const{createdAt:de,createdBy:fe,version:ae,message:ce=""}=oe,ie=(0,E.fq)(de);return(0,n.jsxs)(s.x6,{i18nKey:"core.versionHistory.comparison.header.text",children:["Version ",{version:ae}," updated by ",{createdBy:fe}," (",{ageString:ie},") ",{message:ce}]})},U=({oldSummary:oe,newSummary:de,oldVersion:fe,newVersion:ae,preprocessVersion:ce=d.identity,showRestoreButton:ie=!1,onRestore:ve})=>{const le=(0,O.G4)(ce(fe),ce(ae)),Ee=Object.entries(le).length===0,[Re,Oe]=(0,a.useState)(Ee);return(0,n.jsxs)(l.B,{gap:2,direction:"column",children:[(0,n.jsx)(b.a,{children:(0,n.jsxs)(g.E,{variant:"h5",element:"h4",children:[(0,n.jsx)(j,{info:oe}),(0,n.jsx)(D.I,{name:"arrow-right"}),(0,n.jsx)(j,{info:de})]})}),(0,n.jsxs)(b.a,{children:[Ee&&(0,n.jsx)(o.p,{message:(0,s.t)("core.versionHistory.no-properties-changed","No relevant properties changed"),variant:"not-found",hideImage:!0,children:(0,n.jsx)(s.x6,{i18nKey:"core.versionHistory.view-json-diff",children:"View JSON diff to see all changes"})}),Object.entries(le).map(([Se,Te])=>(0,n.jsx)(P.D,{diffs:Te,title:Se},Se)),(0,n.jsx)(C.c,{})]}),(0,n.jsxs)(l.B,{gap:2,direction:"row",justifyContent:"space-between",children:[(0,n.jsxs)(p.$n,{variant:"secondary",onClick:()=>{Oe(!Re)},children:[Re&&(0,n.jsx)(s.x6,{i18nKey:"core.versionHistory.comparison.header.hide-json-diff",children:"Hide JSON diff "}),!Re&&(0,n.jsx)(s.x6,{i18nKey:"core.versionHistory.comparison.header.show-json-diff",children:"Show JSON diff "})]}),ie&&(0,n.jsx)(p.$n,{variant:"destructive",onClick:ve,icon:"history",children:(0,n.jsxs)(s.x6,{i18nKey:"alerting.alertVersionHistory.restore-version",children:["Restore to version ",{version:oe.version}]})})]}),Re&&(0,n.jsx)(M.M,{oldValue:JSON.stringify(fe,null,2),newValue:JSON.stringify(ae,null,2)})]})};var W=e(54148),B=e(83175),S=e(71599),_=e(44109),K=e(20437),T=e(23390),L=e(80218),A=e(94646),N=e(29609);function V(){const[oe]=(0,T.pU)();return(0,L.Yb)(async(de,fe)=>{const ae=(0,N.I2)(fe),ce=(0,A.mw)(ae,de);return oe.execute(ae,ce,de,{dataSourceName:m.hY,namespaceName:de.grafana_alert.namespace_uid,groupName:de.grafana_alert.rule_group})})}var z=e(21241);const w=({isOpen:oe,baseVersion:de,versionToRestore:fe,ruleIdentifier:ae,onDismiss:ce,onRestoreSucess:ie,onRestoreError:ve})=>{const{result:le}=(0,_.Ll)({ruleIdentifier:ae}),Ee=(0,W.Zp)(),[Re,{error:Oe}]=V(),Se=(0,s.t)("alerting.alertVersionHistory.restore-modal.title","Restore version"),Te=(0,s.t)("alerting.alertVersionHistory.restore-modal.error","Could not restore alert rule version "),_e=Oe?"Manually restore rule":(0,s.t)("alerting.alertVersionHistory.restore-modal.confirm","Yes, restore configuration"),He=de&&fe?(0,O.G4)((0,z.L0)(de),(0,z.L0)(fe)):void 0;async function tt(){if(!(!fe||!le))return Re.execute(fe,le).then(()=>{ce(),ie()}).catch(Ge=>{ve(Ge)})}async function Je(){if(!fe||!le)return;const Ge=(0,K.QX)({...le,rule:fe}),je=B.kM.renderUrl(`/alerting/${ae.uid}/edit`,{isManualRestore:!0,defaults:JSON.stringify(Ge),returnTo:window.location.pathname+window.location.search});Ee(je)}return(0,n.jsx)(S.u,{isOpen:oe,title:Se,confirmText:_e,confirmButtonVariant:Oe?"primary":"destructive",body:(0,n.jsxs)(l.B,{direction:"column",gap:2,children:[!Oe&&(0,n.jsx)(s.x6,{i18nKey:"alerting.alertVersionHistory.restore-modal.body",children:"Are you sure you want to restore the alert rule definition to this version? All unsaved changes will be lost."}),(0,n.jsx)(g.E,{variant:"h6",children:(0,n.jsx)(s.x6,{i18nKey:"alerting.alertVersionHistory.restore-modal.summary",children:"Summary of changes to be applied:"})}),(0,n.jsx)("div",{children:He&&Object.entries(He).map(([Ge,je])=>(0,n.jsx)(P.D,{diffs:je,title:Ge},Ge))}),Oe&&(0,n.jsxs)(r.F,{severity:"warning",title:Te,children:[(0,n.jsx)(s.x6,{i18nKey:"alerting.alertVersionHistory.restore-manually",children:"Your alert rule could not be restored. This may be due to changes to other entities such as contact points, data sources etc. Please manually restore the rule version"}),(0,n.jsx)("pre",{style:{marginBottom:0},children:(0,n.jsx)("code",{children:(0,y.JZ)(Oe)})})]})]}),onConfirm:Oe?Je:tt,onDismiss:ce})},H=({oldVersion:oe,newVersion:de,ruleIdentifier:fe,isNewLatest:ae,setShowDrawer:ce,onRestoreSuccess:ie,onRestoreError:ve,canRestore:le})=>{const[Ee,Re]=(0,a.useState)(!1),Oe=(0,a.useCallback)(()=>ce(!1),[ce]),Se=(0,z.Lw)(oe),Te=(0,z.Lw)(de);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h._,{onClose:()=>ce(!1),title:(0,s.t)("alerting.alertVersionHistory.comparing-versions","Comparing versions"),children:(0,n.jsx)(U,{oldSummary:Se,oldVersion:oe,newSummary:Te,newVersion:de,preprocessVersion:z.L0,showRestoreButton:ae&&le,onRestore:()=>Re(!0)})}),Ee&&(0,n.jsx)(w,{ruleIdentifier:fe,baseVersion:de,versionToRestore:oe,isOpen:Ee,onDismiss:Oe,onRestoreSucess:ie,onRestoreError:ve})]})};var Q=e(32635),Z=e(99887),Y=e(27594),X=e(85835),I=e(49914);const J=20;function ee({onVersionsChecked:oe,onCompareSingleVersion:de,ruleVersions:fe,disableSelection:ae,checkedVersions:ce,onRestoreSuccess:ie,onRestoreError:ve,canRestore:le}){const[Ee,Re]=(0,a.useState)(!1),[Oe,Se]=(0,a.useState)(),Te=Oe?.grafana_alert?.uid??"",_e=(0,a.useMemo)(()=>({ruleSourceName:m.hY,uid:Te}),[Te]),He=je=>{Re(!0),Se(je)},tt=()=>{Re(!1)},Je=(0,s.t)("alerting.alertVersionHistory.unknown","Unknown"),Ge=[{disableGrow:!0,id:"id",header:(0,s.t)("core.versionHistory.table.version","Version"),cell:({row:je})=>{const Fe=String(je.original.grafana_alert.version),Be=ce.has(String(Fe??!1))??!1;return(0,n.jsx)(l.B,{direction:"row",children:(0,n.jsx)(Q.S,{label:Fe,checked:Be,disabled:ae&&!Be,onChange:()=>{oe(Fe)}})})}},{id:"createdBy",header:(0,s.t)("core.versionHistory.table.updatedBy","Updated By"),disableGrow:!0,cell:({row:je})=>(0,n.jsx)(I.m,{user:je.original.grafana_alert.updated_by})},{id:"created",header:(0,s.t)("core.versionHistory.table.updated","Date"),disableGrow:!0,cell:({row:je})=>{const Fe=je.original.grafana_alert.updated;return Fe?(0,E.LE)(Fe)+" ("+(0,E.fq)(Fe)+")":Je}},{id:"diff",disableGrow:!0,cell:({rows:je,row:Fe})=>{const Ke=Fe.index===fe.length-1?{}:je[Fe.index+1]?.original,Ue=Fe.original,we=(0,X.h)(Ke,Ue),Xe=`+${we.added}`,nt=`-${we.removed}`;return(0,n.jsxs)(l.B,{alignItems:"baseline",gap:.5,children:[(0,n.jsx)(g.E,{color:"success",variant:"bodySmall",children:Xe}),(0,n.jsx)(g.E,{color:"error",variant:"bodySmall",children:nt})]})}},{id:"actions",disableGrow:!0,cell:({row:je})=>{const Fe=je.index===0,Be=(0,s.t)("alerting.alertVersionHistory.compare-with-latest","Compare with latest version");return(0,n.jsxs)(l.B,{direction:"row",alignItems:"center",justifyContent:"flex-end",children:[Fe&&(0,n.jsx)(Z.E,{text:(0,s.t)("alerting.alertVersionHistory.latest","Latest"),color:"blue"}),!Fe&&le&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.$n,{variant:"secondary",size:"sm",icon:"code-branch",onClick:()=>{de(je.original)},tooltip:Be,children:(0,n.jsx)(s.x6,{i18nKey:"alerting.alertVersionHistory.compare",children:"Compare"})}),(0,n.jsx)(p.$n,{variant:"secondary",size:"sm",icon:"history",onClick:()=>{je.original.grafana_alert.version&&He(je.original)},children:(0,n.jsx)(s.x6,{i18nKey:"alerting.alertVersionHistory.restore",children:"Restore"})})]})]})}}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Y.j,{pageSize:J,columns:Ge,data:fe,getRowId:je=>`${je.grafana_alert.version}`}),(0,n.jsx)(w,{ruleIdentifier:_e,baseVersion:fe[0],versionToRestore:Oe,isOpen:Ee,onDismiss:tt,onRestoreSucess:ie,onRestoreError:ve})]})}const{useGetAlertVersionHistoryQuery:q}=x.hK,ne=["id","uid","updated","updated_by","version"];function se({rule:oe}){const de=oe.grafana_alert.uid,{isLoading:fe,currentData:ae=[],error:ce}=q({uid:de}),ie=(0,a.useMemo)(()=>({ruleSourceName:m.hY,uid:de}),[de]),[ve,le]=(0,a.useState)(),[Ee,Re]=(0,a.useState)(),[Oe,Se]=(0,a.useState)(!1),[Te,_e]=(0,a.useState)(new Set),He=(0,a.useMemo)(()=>Te.size>1,[Te]),tt={namespace:{uid:oe.grafana_alert.namespace_uid},groupName:oe.grafana_alert.rule_group,groupOrigin:"grafana"},[Je,Ge]=(0,v.mW)(oe,tt,v.j5.Restore),je=Ge&&Je&&!!i.$.featureToggles.alertingRuleVersionHistoryRestore,Fe=(0,a.useCallback)(nt=>{(0,c.cg)({origin:nt,latest:Ee===ae[0],oldVersion:ve?.grafana_alert.version||0,newVersion:Ee?.grafana_alert.version||0})},[ve,Ee,ae]),Be=(0,a.useCallback)((nt,he)=>{(0,c.XW)({origin:nt,latest:Ee===ae[0],oldVersion:ve?.grafana_alert.version||0,newVersion:Ee?.grafana_alert.version||0,error:he})},[ve,Ee,ae]);if(ce)return(0,n.jsx)(r.F,{title:(0,s.t)("alerting.alertVersionHistory.errorloading","Failed to load alert rule versions"),children:(0,y.JZ)(ce)});if(fe)return(0,n.jsx)(u._,{text:(0,s.t)("alerting.common.loading","Loading...")});if(!ae.length)return(0,c.fH)(c.le.noAlertRuleVersionsFound,{ruleUid:de}),(0,n.jsx)(o.p,{variant:"not-found",message:(0,s.t)("alerting.alertVersionHistory.noVersionsFound","No versions found for this rule")});const Ke=()=>{const[nt,he]=ae.filter(xe=>{const me=xe.grafana_alert.version;if(!(!me&&me!==0))return Te.has(String(xe.grafana_alert.version))}).sort((xe,me)=>{const ye=xe.grafana_alert.version,De=me.grafana_alert.version;return ye===void 0||De===void 0?0:ye-De});(0,c.Rh)({latest:he===ae[0],oldVersion:nt?.grafana_alert.version||0,newVersion:he?.grafana_alert.version||0}),Ue(nt,he)},Ue=(nt,he)=>{le(nt),Re(he),Se(!0)};function we(nt){_e(he=>{const xe=new Set(he);return xe.has(nt)?xe.delete(nt):xe.add(nt),xe}),le(void 0),Re(void 0)}const Xe=ae[0].grafana_alert.version===Ee?.grafana_alert.version;return(0,n.jsxs)(l.B,{direction:"column",gap:2,children:[(0,n.jsx)(g.E,{variant:"body",children:(0,n.jsx)(s.x6,{i18nKey:"alerting.alertVersionHistory.description",children:"Each time you edit the alert rule, a new version is created. Select two versions below and compare their differences."})}),(0,n.jsx)(l.B,{children:(0,n.jsx)(f.m,{content:(0,s.t)("core.versionHistory.comparison.select","Select two versions to start comparing"),placement:"bottom",children:(0,n.jsx)(p.$n,{type:"button",disabled:!He,onClick:Ke,icon:"code-branch",children:(0,n.jsx)(s.x6,{i18nKey:"alerting.alertVersionHistory.compareVersions",children:"Compare versions"})})})}),Oe&&ve&&Ee&&(0,n.jsx)(H,{oldVersion:ve,newVersion:Ee,ruleIdentifier:ie,isNewLatest:Xe,setShowDrawer:Se,onRestoreSuccess:()=>Fe("comparison-drawer"),onRestoreError:nt=>Be("comparison-drawer",nt),canRestore:je}),(0,n.jsx)(ee,{onCompareSingleVersion:nt=>Ue(nt,ae[0]),onVersionsChecked:we,ruleVersions:ae,disableSelection:He,checkedVersions:Te,onRestoreSuccess:()=>Fe("version-list"),onRestoreError:nt=>Be("version-list",nt),canRestore:je})]})}},45746:(te,R,e)=>{"use strict";e.d(R,{$:()=>S,B:()=>B});var n=e(74848),a=e(22803),s=e(74226),i=e(2543),r=e(80011),u=e(92745),o=e(41654),l=e(66404),g=e(63142),f=e(30703),p=e(20941),c=e(89640),x=e(42227),v=e(11504),m=e(77256),y=e(29609),h=e(15629),d=e(9368),E=e(31286),b=e(45967),D=e(47931),C=e(10427);const P=({id:T,label:L,value:A,monospace:N,showCopyButton:V,copyValue:z,tooltipValue:w})=>{const H=(0,u.t)("alerting.copy-to-clipboard",'Copy "{{label}}" to clipboard',{label:L});return(0,n.jsx)(E.a,{children:(0,n.jsxs)(o.B,{direction:"column",gap:0,children:[(0,n.jsx)(l.E,{color:"secondary",id:T,children:L}),(0,n.jsxs)(l.E,{"aria-labelledby":T,color:"primary",variant:N?"code":"body",children:[(0,n.jsx)(C.A,{shouldWrap:!!w,wrap:Q=>(0,n.jsx)(b.m,{content:w,children:Q}),children:(0,n.jsx)("span",{children:A})}),V&&(0,n.jsx)(D.b,{"aria-label":H,fill:"text",variant:"secondary",icon:"copy",size:"sm",getText:()=>z})]})]})})};var M=e(42004),O=e(87281),j=e(49914),U=(T=>(T.GrafanaManagedAlertRule="Grafana-managed alert rule",T.GrafanaManagedRecordingRule="Grafana-managed recording rule",T.CloudAlertRule="Cloud alert rule",T.CloudRecordingRule="Cloud recording rule",T.Unknown="Unknown",T))(U||{});const W=({title:T,children:L})=>(0,n.jsxs)(o.B,{direction:"column",gap:1,children:[(0,n.jsx)(l.E,{variant:"h4",children:T}),(0,n.jsx)(o.B,{direction:"column",gap:2,children:L})]}),B=({rule:T})=>{const L=(0,g.of)(K),A=(0,v.G)(T),N=y.p.grafana.alertingRule(T.rulerRule)?T.rulerRule.keep_firing_for:void 0;let V="Unknown";y.p.grafana.alertingRule(T.rulerRule)?V="Grafana-managed alert rule":y.p.grafana.recordingRule(T.rulerRule)?V="Grafana-managed recording rule":y.p.dataSource.alertingRule(T.rulerRule)?V="Cloud alert rule":y.p.dataSource.recordingRule(T.rulerRule)&&(V="Cloud recording rule");const z=y.p.grafana.recordingRule(T.rulerRule)?T.rulerRule.grafana_alert.record?.target_datasource_uid:null,w=(0,x.ps)(z),H=z&&z!=="grafana",Q=T.promRule?.evaluationTime,Z=T.promRule?.lastEvaluation,Y=y.R$.alertingRule(T.promRule)?(0,y.Rh)(T.promRule):void 0,X=Number.isFinite(Q),I=y.p.grafana.rule(T.rulerRule)?T.rulerRule.grafana_alert.updated:void 0,J=y.p.grafana.rule(T.rulerRule)&&(0,y.hC)(T.rulerRule),ee=y.p.grafana.rule(T.rulerRule)&&!(0,i.isUndefined)(T.rulerRule.grafana_alert.missing_series_evals_to_resolve)?String(T.rulerRule.grafana_alert.missing_series_evals_to_resolve):void 0,q=(0,n.jsxs)(o.B,{children:[(0,n.jsx)(l.E,{color:"warning",children:(0,n.jsx)(f.I,{name:"pause-circle"})}),(0,n.jsx)(l.E,{children:(0,n.jsx)(u.x6,{i18nKey:"alerting.alert.evaluation-paused",children:"Alert evaluation currently paused"})})]});return(0,n.jsxs)("div",{className:L.metadata,children:[(0,n.jsxs)(W,{title:(0,u.t)("alerting.alert.rule","Rule"),children:[(0,n.jsx)(P,{id:"rule-type",label:(0,u.t)("alerting.alert.rule-type","Rule type"),value:V}),y.p.grafana.rule(T.rulerRule)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(P,{id:"rule-type",label:(0,u.t)("alerting.alert.rule-identifier","Rule identifier"),value:T.rulerRule.grafana_alert.uid,monospace:!0,showCopyButton:!0,copyValue:T.rulerRule.grafana_alert.uid}),(0,n.jsx)(P,{id:"last-updated-by",label:(0,u.t)("alerting.alert.last-updated-by","Last updated by"),value:(0,n.jsx)(j.m,{user:T.rulerRule.grafana_alert.updated_by})}),I&&(0,n.jsx)(P,{id:"date-of-last-update",label:(0,u.t)("alerting.alert.last-updated-at","Last updated at"),value:(0,r.LE)(I)+` (${(0,r.fq)(I)})`})]}),H&&(0,n.jsx)(P,{id:"target-datasource-uid",label:(0,u.t)("alerting.alert.target-datasource-uid","Target data source"),value:(0,n.jsx)(p.N,{href:`/connections/datasources/edit/${w?.uid}`,children:(0,n.jsxs)(o.B,{direction:"row",gap:1,children:[(0,n.jsx)("img",{style:{width:"16px"},src:w?.meta.info.logos.small,alt:"datasource logo"}),w?.name]})})})]}),(0,n.jsxs)(W,{title:(0,u.t)("alerting.alert.evaluation","Evaluation"),children:[J?q:(0,n.jsxs)(n.Fragment,{children:[X&&Z&&(0,n.jsx)(P,{id:"last-evaluated",label:(0,u.t)("alerting.alert.last-evaluated","Last evaluated"),value:(0,h.mo)(Z)?"-":(0,s.B)(new Date(Z),{addSuffix:!0}),tooltipValue:(0,h.mo)(Z)?void 0:(0,r.LE)(Z)}),X&&(0,n.jsx)(P,{id:"last-evaluation-duration",label:(0,u.t)("alerting.alert.last-evaluation-duration","Last evaluation duration"),value:`${Q} ms`}),ee&&(0,n.jsx)(P,{id:"missing-series-resolve",label:(0,u.t)("alerting.alert.missing-series-resolve","Missing series evaluations to resolve"),value:ee,tooltipValue:(0,u.t)("alerting.alert.description-missing-series-evaluations","The number of consecutive evaluation intervals a dimension must be missing before the alert instance becomes stale, and is then automatically resolved and evicted. Defaults to 2 if empty.")})]}),A&&(0,n.jsx)(P,{id:"pending-period",label:(0,u.t)("alerting.alert.pending-period","Pending period"),value:A}),N&&(0,n.jsx)(P,{id:"keep-firing-for",label:(0,u.t)("alerting.alert.keep-firing-for","Keep firing for"),value:N})]}),y.p.grafana.alertingRule(T.rulerRule)&&!(0,i.isEmpty)(T.rulerRule.grafana_alert.notification_settings)&&(0,n.jsx)(_,{rulerRule:T.rulerRule}),y.p.grafana.rule(T.rulerRule)&&T.rulerRule.grafana_alert.no_data_state&&T.rulerRule.grafana_alert.exec_err_state&&(0,n.jsxs)(W,{title:(0,u.t)("alerting.alert.alert-state","Alert state"),children:[X&&(0,n.jsx)(P,{id:"alert-state-no-data",label:(0,u.t)("alerting.alert.state-no-data","Alert state if no data or all values are null"),value:T.rulerRule.grafana_alert.no_data_state}),A&&(0,n.jsx)(P,{id:"alert-state-exec-err",label:(0,u.t)("alerting.alert.state-error-timeout","Alert state if execution error or timeout"),value:T.rulerRule.grafana_alert.exec_err_state})]}),Y&&(0,n.jsx)(W,{title:(0,u.t)("alerting.alert.annotations","Annotations"),children:Object.keys(Y).length===0?(0,n.jsx)("div",{children:(0,n.jsx)(l.E,{color:"secondary",italic:!0,children:(0,n.jsx)(u.x6,{i18nKey:"alerting.alert.no-annotations",children:"No annotations"})})}):Object.entries(Y).map(([ne,se])=>{const oe=`annotation-${ne.replace(/\s/g,"-")}`;return(0,n.jsx)(P,{id:oe,label:ne,value:(0,n.jsx)(S,{value:se})},ne)})})]})};function S({value:T}){const L=T&&T.startsWith("http"),A=(0,n.jsx)(d.Y,{input:T,delimiter:["{{","}}"]});return L?(0,n.jsx)(c.Y,{href:T,external:!0,children:T}):(0,n.jsx)(l.E,{color:"primary",children:A})}const _=({rulerRule:T})=>{const L=T.grafana_alert.notification_settings;return L?(0,n.jsxs)(W,{title:(0,u.t)("alerting.alert.notification-configuration.group-title","Notification configuration"),children:[(0,n.jsx)(P,{id:"receiver",label:(0,u.t)("alerting.alert.notification-configuration.contact-point","Contact point"),value:(0,n.jsx)(O.z,{name:L.receiver})}),L.mute_time_intervals&&(0,n.jsx)(P,{id:"mute-timings",label:(0,u.t)("alerting.alert.notification-configuration.mute-timings","Mute timings"),value:(0,n.jsx)(n.Fragment,{children:L.mute_time_intervals.map((A,N)=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.Y,{href:(0,m.NJ)(A,{alertmanager:"grafana"}),children:A}),N<L.mute_time_intervals.length-1&&", "]},A))})}),L.active_time_intervals&&(0,n.jsx)(P,{id:"active-time-intervals",label:(0,u.t)("alerting.alert.notification-configuration.active-timings","Active time intervals"),value:(0,n.jsx)(n.Fragment,{children:L.active_time_intervals.map((A,N)=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.Y,{href:(0,m.NJ)(A,{alertmanager:"grafana"}),children:A}),N<L.active_time_intervals.length-1&&", "]},A))})}),L.group_by&&(0,n.jsx)(P,{id:"group-by",label:(0,u.t)("alerting.alert.notification-configuration.group-by","Grouped by"),value:L.group_by.join(", ")}),(L.group_interval||L.group_wait||L.repeat_interval)&&(0,n.jsx)(P,{id:"timing-options",label:(0,u.t)("alerting.alert.notification-configuration.timing-options","Timings"),value:(0,n.jsx)(M.OJ,{timingOptions:{group_interval:L.group_interval,group_wait:L.group_wait,repeat_interval:L.repeat_interval}})})]}):null},K=T=>({metadata:(0,a.css)({display:"grid",gap:T.spacing(4),gridTemplateColumns:"1fr 1fr 1fr",[T.breakpoints.down("lg")]:{gridTemplateColumns:"1fr 1fr"},[T.breakpoints.down("sm")]:{gridTemplateColumns:"1fr"}})})},49914:(te,R,e)=>{"use strict";e.d(R,{m:()=>g});var n=e(74848),a=e(22803),s=e(92745),i=e(63142),r=e(45967),u=e(30703),o=e(99887),l=e(21241);const g=({user:p})=>{const c=(0,s.t)("alerting.alertVersionHistory.unknown","Unknown"),x=(0,l.J8)(),v=(0,i.of)(f),m=(0,n.jsx)(r.m,{content:(0,s.t)("alerting.alertVersionHistory.unknown-change-description","This update was made prior to the implementation of alert rule version history. The user who made the change is not tracked, but future changes will include the user"),children:(0,n.jsxs)("span",{children:[(0,n.jsxs)("span",{className:v.underline,children:[c," "]}),(0,n.jsx)(u.I,{name:"question-circle"})]})});if(!p)return m;const y=x[p.uid];return y||!p?(0,n.jsx)(r.m,{content:y.tooltipContent,children:(0,n.jsx)("span",{children:(0,n.jsx)(o.E,{className:v.badge,text:y.name,color:y.badgeColor,icon:y.icon})})}):p.name?p.name:p.uid?(0,s.t)("alerting.alertVersionHistory.user-id","User ID {{uid}}",{uid:p.uid}):m},f=()=>({badge:(0,a.css)({cursor:"help"}),underline:(0,a.css)({textDecoration:"underline dotted",textUnderlineOffset:"5px",cursor:"help"})})},21241:(te,R,e)=>{"use strict";e.d(R,{J8:()=>s,L0:()=>i,Lw:()=>r});var n=e(92745),a=e(3845);const s=()=>{const u={name:(0,n.t)("alerting.alertVersionHistory.provisioning","Provisioning"),tooltipContent:(0,n.t)("alerting.alertVersionHistory.provisioning-change-description","Version update was made via provisioning"),badgeColor:"purple"};return{__alerting__:{name:(0,n.t)("alerting.alertVersionHistory.alerting","Alerting"),tooltipContent:(0,n.t)("alerting.alertVersionHistory.alerting-change-description","This update was made by the alerting system due to other changes. For example, when renaming a contact point that is used for simplified routing, this will update affected rules"),badgeColor:"orange",icon:"bell"},service:u,__provisioning__:u}};function i(u){const{grafana_alert:o,...l}=u,g={for:(0,n.t)("alerting.alertVersionHistory.pendingPeriod","Pending period"),annotations:(0,n.t)("alerting.alertVersionHistory.annotations","Annotations"),labels:(0,n.t)("alerting.alertVersionHistory.labels","Labels")},f={title:(0,n.t)("alerting.alertVersionHistory.name","Name"),namespace_uid:(0,n.t)("alerting.alertVersionHistory.namespace_uid","Folder UID"),data:(0,n.t)("alerting.alertVersionHistory.queryAndAlertCondition","Query and alert condition"),notification_settings:(0,n.t)("alerting.alertVersionHistory.contactPointRouting","Contact point routing"),no_data_state:(0,n.t)("alerting.alertVersionHistory.noDataState","Alert state when no data"),exec_err_state:(0,n.t)("alerting.alertVersionHistory.execErrorState","Alert state when execution error"),is_paused:(0,n.t)("alerting.alertVersionHistory.paused","Paused state"),rule_group:(0,n.t)("alerting.alertVersionHistory.rule_group","Rule group"),condition:(0,n.t)("alerting.alertVersionHistory.condition","Alert condition"),intervalSeconds:(0,n.t)("alerting.alertVersionHistory.intervalSeconds","Evaluation interval")},p=Object.entries(l).reduce((x,[v,m])=>{const h=g[v]||v;return{...x,[h]:m}},{}),c=Object.entries(o).reduce((x,[v,m])=>{const y=v;if(a.R.includes(y))return x;const h=f[y]||v;return{...x,[h]:m}},{});return{...p,...c}}function r(u){const o=(0,n.t)("alerting.alertVersionHistory.unknown","Unknown"),l=s(),g=(()=>{const f=u?.grafana_alert.updated_by,p=f?.uid,c=f?.name;return f?p&&l[p]?l[p].name:c||(p?(0,n.t)("alerting.alertVersionHistory.user-id","User ID {{uid}}",{uid:p}):o):o})();return{createdAt:u.grafana_alert.updated||o,createdBy:g,version:u.grafana_alert.version||o}}},75983:(te,R,e)=>{"use strict";e.d(R,{D:()=>D});var n=e(74848),a=e(96540),s=e(71642),i=e(25229),r=e(54092),u=e(29609),o=e(7840),l=e(6106),g=e(92745),f=e(46907),p=e(88559),c=e(76319),x=e(20806),v=e(9860);const m=({rule:P,instance:M,extensionPointId:O})=>{const[j,U]=(0,a.useState)(),W=(0,a.useMemo)(()=>({instance:M,rule:P}),[M,P]),{links:B}=(0,f.U)({context:W,extensionPointId:O,limitPerPlugin:3});if(B.length===0)return null;const S=(0,n.jsx)(v.w,{extensions:B,onSelect:U});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.m,{placement:"bottom-start",overlay:S,children:(0,n.jsx)(c.K,{name:"ellipsis-v","aria-label":(0,g.t)("alerting.alert-instance-extension-point.aria-label-actions","Actions"),variant:"secondary"})}),!!j&&!!j.path&&(0,n.jsx)(x.s,{path:j.path,title:j.title,onDismiss:()=>U(void 0)})]})};var y=e(75640),h=e(83750),d=e(40165);const E=({instance:P})=>{const M=(0,y.Hx)(P.annotations),O=(0,y.gO)(M);return(0,n.jsxs)("div",{children:[P.value&&(0,n.jsx)(d.X,{label:(0,g.t)("alerting.alert-instance-details.label-value","Value"),horizontal:!0,children:P.value}),M.map(([j,U])=>(0,n.jsx)(h.s,{annotationKey:j,value:U,valueLink:O.get(j)},j))]})};var b=e(65420);const D=({rule:P,instances:M,pagination:O,footerRow:j})=>{const U=(0,a.useMemo)(()=>M.length>1?(0,s.yO)(M.map(B=>B.labels)):{},[M]),W=(0,a.useMemo)(()=>M.map(B=>({data:{rule:P,alert:{...B,commonLabels:U}},id:(0,u.RI)(B)})),[U,M,P]);return(0,n.jsx)(l.E,{cols:C,isExpandable:!0,items:W,renderExpandedContent:({data:B})=>(0,n.jsx)(E,{instance:B.alert}),pagination:O,footerRow:j})},C=[{id:"state",label:"State",renderCell:({data:{alert:{state:P}}})=>(0,n.jsx)(b.C,{state:P}),size:"95px"},{id:"labels",label:"Labels",renderCell:({data:{alert:{labels:P,commonLabels:M}}})=>(0,n.jsx)(o.m,{labels:P,commonLabels:M,size:"sm"})},{id:"created",label:"Created",renderCell:({data:{alert:{activeAt:P}}})=>(0,n.jsx)(n.Fragment,{children:P.startsWith("0001")?"-":(0,i.KQ)(P).format("YYYY-MM-DD HH:mm:ss")}),size:"150px"},{id:"actions",label:"",renderCell:({data:{alert:P,rule:M}})=>(0,n.jsx)(m,{rule:M,instance:P,extensionPointId:r.S.AlertInstanceAction},"alert-instance-extension-point"),size:"40px"}]},65420:(te,R,e)=>{"use strict";e.d(R,{C:()=>l});var n=e(74848),a=e(96540),s=e(92745),i=e(45967),r=e(30703),u=e(29609),o=e(67834);const l=(0,a.memo)(({state:g,isPaused:f=!1,size:p="md",muted:c=!1})=>f?(0,n.jsx)(i.m,{content:(0,s.t)("alerting.alert-state-tag.content-alert-evaluation-is-currently-paused","Alert evaluation is currently paused"),placement:"top",children:(0,n.jsxs)(o.O,{state:"warning",size:p,muted:c,children:[(0,n.jsx)(r.I,{name:"pause",size:"xs"})," ",(0,n.jsx)(s.x6,{i18nKey:"alerting.alert-state-tag.paused",children:"Paused"})]})}):(0,n.jsx)(o.O,{state:(0,u.Wy)(g),size:p,muted:c,children:(0,u.XI)(g)}));l.displayName="AlertStateTag"},14050:(te,R,e)=>{"use strict";e.d(R,{Z:()=>l});var n=e(74848),a=e(96540),s=e(54148),i=e(92745),r=e(71599),u=e(45861),o=e(94646);function l({identifier:f,isProvisioned:p,redirectTo:c=!1,onDismiss:x}){const v=(0,s.zy)(),[m,y]=(0,a.useState)(p?"confirm":"redirect");if(m==="redirect"){const h=o.$9(f),d=v.pathname+v.search,E=new URLSearchParams({copyFrom:h,returnTo:c?d:""});return(0,n.jsx)(s.C5,{to:"/alerting/new?"+E.toString(),replace:!1})}return(0,n.jsx)(r.u,{isOpen:m==="confirm",title:(0,i.t)("alerting.redirect-to-clone-rule.title-copy-provisioned-alert-rule","Copy provisioned alert rule"),body:(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:(0,n.jsxs)(i.x6,{i18nKey:"alerting.redirect-to-clone-rule.body-not-provisioned",children:["The new rule will ",(0,n.jsx)("strong",{children:"not"})," be marked as a provisioned rule."]})}),(0,n.jsx)("p",{children:(0,n.jsx)(i.x6,{i18nKey:"alerting.redirect-to-clone-rule.body-evaluation-group",children:"You will need to set a new evaluation group for the copied rule because the original one has been provisioned and cannot be used for rules created in the UI."})})]}),confirmText:(0,i.t)("alerting.redirect-to-clone-rule.confirmText-copy","Copy"),onConfirm:()=>y("redirect"),onDismiss:x})}const g=(0,a.forwardRef)(({text:f,ruleIdentifier:p,isProvisioned:c,className:x},v)=>{const[m,y]=(0,a.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.$n,{title:(0,i.t)("alerting.clone-rule-button.title-copy","Copy"),className:x,size:"sm",variant:"secondary",icon:"copy",onClick:()=>y(!0),ref:v,children:f},"clone"),m&&(0,n.jsx)(l,{identifier:p,isProvisioned:c,onDismiss:()=>y(!1)})]})});g.displayName="CloneRuleButton"},3969:(te,R,e)=>{"use strict";e.d(R,{l:()=>M});var n=e(74848),a=e(2543),s=e.n(a),i=e(96540),r=e(92745),u=e(45861),o=e(41654),l=e(94380),g=e(53567),f=e(90186),p=e(2218),c=e(96784),x=e(52763),v=e(16692),m=e(11018),y=e(52161),h=e(67598),d=e(77256),E=e(94646),b=e(29609),D=e(92367),C=e(14050);const P=O=>window.matchMedia(`(max-width: ${O}px)`).matches,M=({compact:O,showViewButton:j,rule:U,rulesSource:W})=>{const B=(0,x.wA)(),S=!O,[_,K]=(0,g.w)(S),[T,L]=(0,i.useState)(!1),[A,N]=(0,i.useState)(void 0),{namespace:V,group:z,rulerRule:w}=U,{hasActiveFilters:H}=(0,c.dI)(),Q=b.p.grafana.rule(U.rulerRule)&&!!U.rulerRule.grafana_alert.provenance,[Z,Y]=(0,v.mh)(U,v.j5.Update),X=Z&&Y,I=[],J=O?"sm":"md",ee=(0,y.EV)(W),q=E.UP(ee,U),ne=h.HA.fromCombinedRule(U);if(j&&I.push((0,n.jsx)(u.z9,{title:(0,r.t)("alerting.rule-actions-buttons.title-view","View"),size:J,variant:"secondary",icon:"eye",href:(0,d.w$)(W,U),children:(0,n.jsx)(r.x6,{i18nKey:"common.view",children:"View"})},"view")),w&&X){const de=E.P1(ee,V.name,z.name,w),fe=(0,D.G)(`/alerting/${encodeURIComponent(E.$9(de))}/edit`);I.push((0,n.jsx)(u.z9,{title:(0,r.t)("alerting.rule-actions-buttons.title-edit","Edit"),size:J,variant:"secondary",icon:"pen",href:fe,children:(0,n.jsx)(r.x6,{i18nKey:"common.edit",children:"Edit"})},"edit"))}if(!U.promRule&&!U.rulerRule)return null;const se=(0,b.xE)(U.rulerRule??U.promRule),oe=(0,a.isString)(se)&&(b.p.grafana.alertingRule(U.rulerRule)||b.R$.grafana.alertingRule(U.promRule));return(0,n.jsxs)(o.B,{gap:1,alignItems:"center",wrap:"nowrap",children:[I,(0,n.jsx)(l.A,{rulerRule:U.rulerRule,promRule:U.promRule,identifier:q,groupIdentifier:ne,handleDelete:()=>{if(U.rulerRule){const de=E.co(ne,U.rulerRule);K(de,ne)}},handleSilence:()=>L(!0),handleDuplicateRule:()=>N({identifier:q,isProvisioned:Q}),onPauseChange:()=>{const de=H?void 0:f.Ys+1;B((0,m.Lc)({rulesSourceName:y.hY,limitAlerts:de}))},buttonSize:J}),_,oe&&T&&(0,n.jsx)(p.A,{ruleUid:se,onClose:()=>L(!1)}),A?.identifier&&(0,n.jsx)(C.Z,{identifier:A.identifier,isProvisioned:A.isProvisioned,onDismiss:()=>N(void 0)})]})}},90186:(te,R,e)=>{"use strict";e.d(R,{Ys:()=>ee,DI:()=>q});var n=e(74848),a=e(22803),s=e(80011),i=e(25229),r=e(92745),u=e(63142),o=e(45967),l=e(55555),g=e(11504),f=e(75640),p=e(29609),c=e(15629),x=e(7840),v=e(40165),m=e(83750);function y(oe){const de=(0,u.of)(h),{annotations:fe}=oe,ae=(0,f.gO)(fe);return fe.length===0?null:(0,n.jsx)("div",{className:de.annotations,children:fe.map(([ce,ie])=>(0,n.jsx)(m.s,{annotationKey:ce,value:ie,valueLink:ae.get(ce)},ce))})}const h=()=>({annotations:(0,a.css)({marginTop:"46px"})});var d=e(96540),E=e(63704),b=e(41071),D=e(45861),C=e(41654),P=e(16692),M=e(58138),O=e(95443),j=e(52161),U=e(77256);const B=({rule:oe,rulesSource:de})=>{const{group:fe}=oe,{StateHistoryModal:ae,showStateHistoryModal:ce}=(0,M.G)(),ie=(0,b.i)(),[ve,le]=(0,P.mh)(oe,P.j5.Explore),Ee=[],Re=(0,p.YN)(fe);if((0,j.Eb)(de)&&ve&&le&&!Re&&Ee.push((0,n.jsx)(D.z9,{size:"sm",variant:"primary",icon:"chart-line",target:"_blank",href:(0,U.Yp)(de,oe.query),children:(0,n.jsx)(r.x6,{i18nKey:"alerting.rule-details-buttons.see-graph",children:"See graph"})},"explore")),oe.annotations[O.YH.runbookURL]&&Ee.push((0,n.jsx)(D.z9,{size:"sm",variant:"primary",icon:"book",target:"_blank",href:E.sQ.sanitizeUrl(oe.annotations[O.YH.runbookURL]),children:(0,n.jsx)(r.x6,{i18nKey:"alerting.rule-details-buttons.view-runbook",children:"View runbook"})},"runbook")),oe.annotations[O.YH.dashboardUID]){const Oe=oe.annotations[O.YH.dashboardUID];if(Oe){Ee.push((0,n.jsx)(D.z9,{size:"sm",variant:"primary",icon:"apps",href:`d/${encodeURIComponent(Oe)}`,onClick:()=>{ie(oe.name)},children:(0,n.jsx)(r.x6,{i18nKey:"alerting.rule-details-buttons.go-to-dashboard",children:"Go to dashboard"})},"dashboard"));const Se=oe.annotations[O.YH.panelID];Se&&Ee.push((0,n.jsx)(D.z9,{size:"sm",variant:"primary",icon:"apps",href:`d/${encodeURIComponent(Oe)}?viewPanel=${encodeURIComponent(Se)}`,onClick:()=>{ie(oe.name)},children:(0,n.jsx)(r.x6,{i18nKey:"alerting.rule-details-buttons.go-to-panel",children:"Go to panel"})},"panel"))}}return p.p.grafana.alertingRule(oe.rulerRule)&&Ee.push((0,n.jsxs)(d.Fragment,{children:[(0,n.jsx)(D.$n,{size:"sm",icon:"history",onClick:()=>p.p.grafana.rule(oe.rulerRule)&&ce(oe.rulerRule),children:(0,n.jsx)(r.x6,{i18nKey:"alerting.rule-details-buttons.show-state-history",children:"Show state history"})}),ae]},"history")),Ee.length?(0,n.jsx)(C.B,{children:Ee}):null};var S=e(78282),_=e(4651);function K(oe){const{rulesSource:de,rule:fe}=oe,ae=(0,u.of)(T),ce=(0,d.useMemo)(()=>{if((0,j.Eb)(de))return[{name:de.name,icon:de.meta.info.logos.small}];if(p.p.grafana.rule(fe.rulerRule)){const{data:ie}=fe.rulerRule.grafana_alert,ve=ie.reduce((le,Ee)=>{const Re=(0,S.l)().getInstanceSettings(Ee.datasourceUid);return!Re||Re.uid===_.Uj||(le[Re.name]={name:Re.name,icon:Re.meta.info.logos.small}),le},{});return Object.values(ve)}return[]},[fe,de]);return ce.length===0?null:(0,n.jsx)(v.X,{label:(0,r.t)("alerting.rule-details-data-sources.label-data-source","Data source"),children:ce.map(({name:ie,icon:ve},le)=>(0,n.jsxs)("div",{children:[ve&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("img",{alt:`${ie} datasource logo`,className:ae.dataSourceIcon,src:ve})," "]}),ie]},ie))})}function T(oe){const de=oe.spacing(2);return{dataSourceIcon:(0,a.css)({width:de,height:de})}}var L=e(28848),A=e(29317),N=e(35748),V=e(56103),z=e(35458),w=e(77236),H=e(16591);const Q=({language:oe,expr:de})=>{const fe=(0,d.useMemo)(()=>[(0,V.D)({onlyIn:ce=>"type"in ce&&ce.type==="code_block",getSyntax:()=>oe},{...L.languages,[oe]:oe==="logql"?w.Ay:N.n6})],[oe]),ae=(0,d.useMemo)(()=>(0,z.mO)(de),[de]);return(0,n.jsx)(A.Editor,{"data-testid":"expression-editor",plugins:fe,value:ae})},Z=({expression:oe,rulesSource:de})=>{const fe=(0,u.of)(Y);return(0,n.jsx)(H.L,{className:(0,a.cx)(fe.well,"slate-query-field"),children:(0,j.Eb)(de)?(0,n.jsx)(Q,{expr:oe,language:de.type===j.ol.Loki?"logql":"promql"}):oe})},Y=oe=>({well:(0,a.css)({fontFamily:oe.typography.fontFamilyMonospace})});function X(oe){const{annotations:de,rulesSource:fe,rule:ae}=oe,ce=I();return(0,j.Eb)(fe)?(0,n.jsx)(v.X,{label:(0,r.t)("alerting.rule-details-expression.label-expression","Expression"),horizontal:!0,className:(0,a.cx)({[ce.exprRow]:!!de.length}),children:(0,n.jsx)(Z,{expression:ae.query,rulesSource:fe})}):null}const I=()=>({exprRow:(0,a.css)({marginBottom:"46px"})});var J=e(66773);const ee=15,q=({rule:oe})=>{const de=(0,u.of)(se),{namespace:{rulesSource:fe}}=oe,ae=(0,f.Hx)(oe.annotations),ce=p.p.any.alertingRule(oe.rulerRule)||p.R$.alertingRule(oe.promRule);return(0,n.jsxs)("div",{children:[(0,n.jsx)(B,{rule:oe,rulesSource:fe}),(0,n.jsxs)("div",{className:de.wrapper,children:[(0,n.jsxs)("div",{className:de.leftSide,children:[(0,n.jsx)(ne,{rule:oe}),!!oe.labels&&!!Object.keys(oe.labels).length&&(0,n.jsx)(v.X,{label:(0,r.t)("alerting.rule-details.label-labels","Labels"),horizontal:!0,children:(0,n.jsx)(x.m,{labels:oe.labels})}),(0,n.jsx)(X,{rulesSource:fe,rule:oe,annotations:ae}),(0,n.jsx)(y,{annotations:ae})]}),(0,n.jsx)("div",{className:de.rightSide,children:(0,n.jsx)(K,{rulesSource:fe,rule:oe})})]}),ce&&(0,n.jsx)(v.X,{label:(0,r.t)("alerting.rule-details.label-instances","Instances"),horizontal:!0,children:(0,n.jsx)(J.s,{rule:oe,itemsDisplayLimit:ee})})]})},ne=({rule:oe})=>{const de=oe.group.interval,fe=oe.promRule?.lastEvaluation,ae=oe.promRule?.evaluationTime,ce=p.p.grafana.recordingRule(oe.rulerRule)?oe.rulerRule?.grafana_alert.record?.metric:void 0,ie=(0,g.G)(oe),ve=p.p.grafana.alertingRule(oe.rulerRule)?oe.rulerRule.keep_firing_for:void 0;return(0,n.jsxs)(n.Fragment,{children:[ce&&(0,n.jsx)(v.X,{label:(0,r.t)("alerting.evaluation-behavior-summary.label-metric","Metric"),horizontal:!0,children:ce}),de&&(0,n.jsx)(v.X,{label:(0,r.t)("alerting.evaluation-behavior-summary.label-evaluate","Evaluate"),horizontal:!0,children:(0,n.jsxs)(r.x6,{i18nKey:"alerting.evaluation-behavior-summary.evaluate",values:{interval:de},children:["Every ",{interval:de}]})}),ie&&(0,n.jsx)(v.X,{label:(0,r.t)("alerting.evaluation-behavior-summary.label-pending-period","Pending period"),horizontal:!0,children:ie}),ve&&(0,n.jsx)(v.X,{label:(0,r.t)("alerting.rule-details.keep-firing-for","Keep firing for"),horizontal:!0,children:ve}),fe&&!(0,c.mo)(fe)&&(0,n.jsx)(v.X,{label:(0,r.t)("alerting.evaluation-behavior-summary.label-last-evaluation","Last evaluation"),horizontal:!0,children:(0,n.jsx)(o.m,{placement:"top",content:`${(0,s.LE)(fe,{format:"YYYY-MM-DD HH:mm:ss"})}`,theme:"info",children:(0,n.jsx)("span",{children:(0,r.t)("alerting.rule-details.last-evaluation-ago","{{time}} ago",{time:(0,i.KQ)(fe).locale("en").fromNow(!0)})})})}),fe&&!(0,c.mo)(fe)&&ae!==void 0&&(0,n.jsx)(v.X,{label:(0,r.t)("alerting.evaluation-behavior-summary.label-evaluation-time","Evaluation time"),horizontal:!0,children:(0,n.jsx)(o.m,{placement:"top",content:`${ae}s`,theme:"info",children:(0,n.jsx)("span",{children:(0,l.g)({timeInMs:ae,humanize:!0})})})})]})},se=oe=>({wrapper:(0,a.css)({display:"flex",flexDirection:"row",[oe.breakpoints.down("md")]:{flexDirection:"column"}}),leftSide:(0,a.css)({flex:1}),rightSide:(0,a.css)({[oe.breakpoints.up("md")]:{paddingLeft:"90px",width:"300px"}})})},66773:(te,R,e)=>{"use strict";e.d(R,{s:()=>M});var n=e(74848),a=e(22803),s=e(2543),i=e(96540),r=e(92745),u=e(63142),o=e(45861),l=e(87133),g=e(94018),f=e(72636),p=e(77824),c=e(24619);const x=({className:U,onStateFilterChange:W,stateFilter:B,filterType:S,itemPerStateStats:_})=>{const K=(0,u.of)(v),T=z=>function(){return _&&_[z]?(0,n.jsx)(g.v,{name:_[z].toFixed(0),colorIndex:9,className:K.tag}):null},L=Object.values(c.Gi).map(z=>({label:z,value:z,component:T(z)})),N=[c.cF.Firing,c.cF.Pending].map(z=>({label:(0,s.capitalize)(z),value:z,component:T(z)})),V=S==="grafana"?L:N;return(0,n.jsxs)("div",{className:U,"data-testid":"alert-instance-state-filter",children:[(0,n.jsx)(f.J,{children:(0,n.jsx)(r.x6,{i18nKey:"alerting.alert-instance-state-filter.state",children:"State"})}),(0,n.jsx)(p.z,{options:V,value:B,onChange:W,onClick:z=>{z===B&&W(void 0)}})]})};function v(U){return{tag:(0,a.css)({fontSize:"11px",fontWeight:"normal",padding:U.spacing(.25,.5),verticalAlign:"middle",marginLeft:U.spacing(.5)})}}var m=e(86017),y=e(77256),h=e(21834),d=e(52161),E=e(63895),b=e(29609),D=e(75983),C=e(46672);function P({stats:U,onClick:W,href:B}){const S=(0,u.of)(j);return(0,n.jsxs)("div",{className:S.footerRow,children:[(0,n.jsx)("div",{children:(0,n.jsxs)(r.x6,{i18nKey:"alerting.rule-details-matching-instances.showing-count",values:{visibleItems:U.visibleItemsCount,totalItems:U.totalItemsCount},children:["Showing ","{{visibleItems}}"," out of ","{{totalItems}}"," instances"]})}),(0,n.jsx)(o.z9,{size:"sm",variant:"secondary","data-testid":"show-all",onClick:W,href:B,children:(0,n.jsxs)(r.x6,{i18nKey:"alerting.rule-details-matching-instances.button-show-all",count:U.totalItemsCount,children:["Show all ","{{totalItems}}"," alert instances"]})})]})}function M(U){const{rule:W,itemsDisplayLimit:B=Number.POSITIVE_INFINITY,pagination:S,enableFiltering:_=!1}=U,{promRule:K,namespace:T,instanceTotals:L}=W,[A,N]=(0,i.useState)(),[V,z]=(0,i.useState)(),[w]=(0,i.useState)(Math.floor(Math.random()*100)),H=`queryString-${w}`,Q=(0,u.of)(j),Z=(0,d.z2)(T.rulesSource)?d.hY:"prometheus",Y=(0,i.useMemo)(()=>b.R$.alertingRule(K)&&K.alerts?.length?O(A,V,(0,y.Cp)(h.xB.Importance,K.alerts)):[],[K,V,A]);if(!b.R$.alertingRule(K))return null;const X=Y.slice(0,B),I=(0,s.countBy)(K.alerts,fe=>(0,c.lh)(fe.state)),J=(0,s.sum)([L.alerting,L.inactive,L.pending,L.recovering,L.nodata]),ee=J-X.length,q={totalItemsCount:J,visibleItemsCount:X.length},ne=(0,y.w$)(T.rulesSource,U.rule,window.location.pathname+window.location.search),se=(0,C.kc)(L),oe=()=>z(void 0),de=ee?(0,n.jsx)(P,{stats:q,onClick:_?oe:void 0,href:_?void 0:ne}):void 0;return(0,n.jsxs)(n.Fragment,{children:[_&&(0,n.jsx)("div",{className:(0,a.cx)(Q.flexRow,Q.spaceBetween),children:(0,n.jsxs)("div",{className:Q.flexRow,children:[(0,n.jsx)(l.X,{defaultQueryString:A,onFilterChange:fe=>N(fe)},H),(0,n.jsx)(x,{filterType:Z,stateFilter:V,onStateFilterChange:z,itemPerStateStats:I})]})}),!_&&(0,n.jsx)("div",{className:Q.stats,children:se}),(0,n.jsx)(D.D,{rule:W,instances:X,pagination:S,footerRow:de})]})}function O(U,W,B){let S=[...B];if(U){const _=U?(0,E.Zc)(U):[];S=S.filter(({labels:K})=>(0,m.Av)(K,_))}return W&&(S=S.filter(_=>(0,c.lh)(_.state)===W)),S}const j=U=>({flexRow:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"flex-end",width:"100%",flexWrap:"wrap",marginBottom:U.spacing(1),gap:U.spacing(1)}),spaceBetween:(0,a.css)({justifyContent:"space-between"}),footerRow:(0,a.css)({display:"flex",flexDirection:"column",gap:U.spacing(1),justifyContent:"space-between",alignItems:"center",width:"100%"}),instancesContainer:(0,a.css)({marginBottom:U.spacing(2)}),stats:(0,a.css)({display:"flex",gap:U.spacing(1),padding:U.spacing(1,0)})})},46672:(te,R,e)=>{"use strict";e.d(R,{M_:()=>v,j7:()=>y,kc:()=>h});var n=e(74848),a=e(2543),s=e.n(a),i=e(55127),r=e.n(i),u=e(96540),o=e(92745),l=e(41654),g=e(99887),f=e(86791),p=e(24619),c=e(45311);const x={recording:0,alerting:0,[p.cF.Pending]:0,[p.cF.Inactive]:0,[p.cF.Recovering]:0,paused:0,error:0,nodata:0},v=u.memo(({namespaces:d})=>{const E=(0,u.useDeferredValue)(d),b=(0,u.useMemo)(()=>m(E),[E]),D=(0,c.U)(b),C=h(b),P=!!C.length;return C.unshift((0,n.jsxs)(u.Fragment,{children:[D," ",r()("rule",D)]},"total")),(0,n.jsx)(l.B,{direction:"row",children:P&&(0,n.jsx)("div",{children:(0,n.jsx)(l.B,{gap:.5,children:C})})})});v.displayName="RuleStats";function m(d){const E={...x};return d.forEach(({groups:b})=>{b.forEach(D=>{const C=(0,a.omitBy)(D.totals,a.isUndefined);for(const P in C)E[P]+=C[P]})}),E}const y=({group:d})=>{const E=d.totals,b=d?.interval,D=h(E),C=!!D.length;return(0,n.jsxs)(l.B,{direction:"row",children:[C&&(0,n.jsx)("div",{children:(0,n.jsx)(l.B,{gap:.5,children:D})}),b&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{children:"|"}),(0,n.jsx)(g.E,{text:b,icon:"clock-nine",color:"blue"})]})]})};function h(d){const E=[];if(d[f.$7.Alerting]&&E.push((0,n.jsx)(g.E,{color:"red",text:(0,o.t)("alerting.rule-stats.firing","{{alertingStats}} firing",{alertingStats:d[f.$7.Alerting]})},"firing")),d.error&&E.push((0,n.jsx)(g.E,{color:"red",text:(0,o.t)("alerting.rule-stats.error","{{count}} errors",{count:d.error})},"errors")),d.nodata&&E.push((0,n.jsx)(g.E,{color:"blue",text:(0,o.t)("alerting.rule-stats.nodata","{{nodataStats}} no data",{nodataStats:d.nodata})},"nodata")),d[f.$7.Pending]){const b=d[f.$7.Pending];E.push((0,n.jsx)(g.E,{color:"orange",text:(0,o.t)("alerting.rule-stats.pending","{{pendingStats}} pending",{pendingStats:b})},"pending"))}if(d[f.$7.Recovering]){const b=d[f.$7.Recovering];E.push((0,n.jsx)(g.E,{color:"orange",text:(0,o.t)("alerting.rule-stats.recovering","{{recoveringStats}} recovering",{recoveringStats:b})},"recovering"))}if(d[f.$7.Normal]&&d.paused){const b=d[f.$7.Normal],D=d.paused;E.push((0,n.jsx)(g.E,{color:"green",text:(0,o.t)("alerting.rule-stats.paused","{{normalStats}} normal ({{pausedStats}} paused)",{normalStats:b,pausedStats:D})},"paused"))}if(d[f.$7.Normal]&&!d.paused){const b=d[f.$7.Normal];E.push((0,n.jsx)(g.E,{color:"green",text:(0,o.t)("alerting.rule-stats.inactive","{{normalStats}} normal",{normalStats:b})},"inactive"))}if(d.recording){const b=d.recording;E.push((0,n.jsx)(g.E,{color:"purple",text:(0,o.t)("alerting.rule-stats.recording","{{recordingStats}} recording",{recordingStats:b})},"recording"))}return E}},22971:(te,R,e)=>{"use strict";e.d(R,{sF:()=>ne,ZI:()=>ce});var n=e(74848),a=e(22803),s=e(96540),i=e(70255),r=e(92745),u=e(63142),o=e(34213),l=e(45967),g=e(95943),f=e(70327),p=e(55143),c=e(74869),x=e(80218),v=e(23265),m=e(11940),y=e(74048),h=e(98127),d=e(17305),E=e(76267),b=e(95443),D=e(52161),C=e(29609),P=e(6106),M=e(57487),O=e(1972),j=e(40360),U=e(9368),W=e(3969),B=e(43173),S=e(30703),_=e(182);function K({rule:ve}){const le=(0,u.of)(T),Ee=C.p.grafana.rule(ve.rulerRule);return(0,s.useMemo)(()=>Ee?(0,_.qf)(ve.group.interval).exceedsLimit:!1,[ve.group.interval,Ee])?(0,n.jsx)(l.m,{theme:"error",content:(0,n.jsx)("div",{children:(0,n.jsxs)(r.x6,{i18nKey:"alerting.rule-config-status.tooltip-min-interval",values:{minInterval:B.$.unifiedAlerting.minInterval,ruleInterval:ve.group.interval},children:["A minimum evaluation interval of ",(0,n.jsx)("span",{className:le.globalLimitValue,children:"{{minInterval}}"})," has been configured in Grafana and will be used instead of the ","{{ruleInterval}}"," interval configured for the Rule Group."]})}),children:(0,n.jsx)(S.I,{name:"stopwatch-slash",className:le.icon})}):null}function T(ve){return{globalLimitValue:(0,a.css)({fontWeight:ve.typography.fontWeightBold}),icon:(0,a.css)({fill:ve.colors.warning.text})}}var L=e(90186),A=e(22973);const N=({rule:ve})=>{const le=(0,u.of)(V);return(0,A.lf)(ve.health)?(0,n.jsx)(l.m,{theme:"error",content:ve.lastError||"No error message provided.",children:(0,n.jsxs)("div",{className:le.warn,children:[(0,n.jsx)(S.I,{name:"exclamation-triangle"}),(0,n.jsx)("span",{children:(0,n.jsx)(r.x6,{i18nKey:"alerting.rule-health.error",children:"error"})})]})}):(0,n.jsx)(n.Fragment,{children:ve.health})},V=ve=>({warn:(0,a.css)({display:"inline-flex",flexDirection:"row",alignItems:"center",gap:ve.spacing(1),color:ve.colors.warning.text})});var z=e(74529),w=e(41654),H=e(68079),Q=e(24619),Z=e(67834),Y=e(65420);const X=({rule:ve,isDeleting:le,isCreating:Ee,isPaused:Re})=>{const Oe=(0,u.of)(I),{promRule:Se,rulerRule:Te}=ve,_e=()=>Re&&C.p.grafana.recordingRule(Te)?(0,n.jsx)(l.m,{content:(0,r.t)("alerting.rule-state.recording-rule-state.content-recording-rule-evaluation-is-currently-paused","Recording rule evaluation is currently paused"),placement:"top",children:(0,n.jsxs)(Z.O,{state:"warning",children:[(0,n.jsx)(S.I,{name:"pause",size:"xs"}),(0,n.jsx)(r.x6,{i18nKey:"alerting.rule-state.paused",children:"Paused"})]})}):(0,n.jsx)(r.x6,{i18nKey:"alerting.rule-state.recording-rule",children:"Recording rule"}),He=(0,s.useMemo)(()=>{if(C.R$.alertingRule(Se)&&Se.alerts?.length&&Se.state!==Q.cF.Inactive){const tt=Se.activeAt?new Date(Se.activeAt):(0,C.Om)(Se);if(tt)return(0,n.jsxs)("span",{title:String(tt),className:Oe.for,children:[(0,n.jsxs)(r.x6,{i18nKey:"alerting.rule-state.for",values:{duration:(0,z.dU)({start:tt,end:new Date},!1)},children:["for ","{{duration}}"]})," "]})}return null},[Se,Oe]);return le?(0,n.jsxs)(w.B,{gap:1,children:[(0,n.jsx)(H.y,{}),(0,n.jsx)(r.x6,{i18nKey:"alerting.rule-state.deleting",children:"Deleting"})]}):Ee?(0,n.jsxs)(w.B,{gap:1,children:[(0,n.jsx)(H.y,{}),(0,n.jsx)(r.x6,{i18nKey:"alerting.rule-state.creating",children:"Creating"})]}):C.R$.alertingRule(Se)?(0,n.jsxs)(w.B,{gap:1,children:[(0,n.jsx)(Y.C,{state:Se.state,isPaused:Re}),!Re&&He]}):Se&&C.R$.recordingRule(Se)?(0,n.jsx)(_e,{}):(0,n.jsx)(r.x6,{i18nKey:"alerting.rule-state.na",children:"n/a"})},I=ve=>({for:(0,a.css)({fontSize:ve.typography.bodySmall.fontSize,color:ve.colors.text.secondary,whiteSpace:"nowrap",paddingTop:"2px"})}),J=(0,c.wS)(),{useLazyGetRuleGroupForNamespaceQuery:ee}=f.hK,{useLazyDiscoverDsFeaturesQuery:q}=p.L,ne=({rules:ve,className:le,showGuidelines:Ee=!1,emptyMessage:Re="No rules found.",showGroupColumn:Oe=!1,showSummaryColumn:Se=!1,showNextEvaluationColumn:Te=!1})=>{const _e=(0,u.of)(oe),He=(0,a.cx)(_e.wrapper,le,{[_e.wrapperMargin]:Ee}),{pageItems:tt,page:Je,numberOfPages:Ge,onPageChange:je}=(0,y.W)(ve,1,g.FG),{result:Fe,status:Be}=se(tt),Ke=Be==="loading",Ue=(0,s.useMemo)(()=>Fe.map((nt,he)=>({id:`${nt.namespace.name}-${nt.group.name}-${nt.name}-${he}`,data:nt})),[Fe]),we=de(Se,Oe,Te,Ke);if(!tt.length)return(0,n.jsx)("div",{className:(0,a.cx)(He,_e.emptyMessage),children:Re});const Xe=Ee?M.B:P.E;return(0,n.jsxs)("div",{className:He,"data-testid":"rules-table",children:[(0,n.jsx)(Xe,{cols:we,isExpandable:!0,items:Ue,renderExpandedContent:({data:nt})=>(0,n.jsx)(L.DI,{rule:nt})}),(0,n.jsx)(o.d,{currentPage:Je,numberOfPages:Ge,onNavigate:je,hideWhenSinglePage:!0,className:_e.pagination})]})};function se(ve){const[le]=ee(),[Ee]=q(),[Re,Oe]=(0,x.Yb)(async()=>Promise.all(ve.map(async Te=>{const _e=await Ee({rulesSourceName:(0,D.EV)(Te.namespace.rulesSource)},!0).unwrap();if(_e.rulerConfig&&Te.namespace.rulesSource!==D.hY){const He=await le({namespace:Te.namespace.name,group:Te.group.name,rulerConfig:_e.rulerConfig},!0).unwrap();(0,v.yh)(Te,He)}return Te})),ve);return(0,s.useEffect)(()=>{J?Re.execute():Re.reset()},[ve,Re]),Oe}const oe=ve=>({wrapperMargin:(0,a.css)({[ve.breakpoints.up("md")]:{marginLeft:"36px"}}),emptyMessage:(0,a.css)({padding:ve.spacing(1)}),wrapper:(0,a.css)({width:"auto",borderRadius:ve.shape.radius.default}),skeletonWrapper:(0,a.css)({flex:1}),pagination:(0,a.css)({display:"flex",margin:0,paddingTop:ve.spacing(1),paddingBottom:ve.spacing(.25),justifyContent:"center",borderLeft:`1px solid ${ve.colors.border.medium}`,borderRight:`1px solid ${ve.colors.border.medium}`,borderBottom:`1px solid ${ve.colors.border.medium}`,float:"none"})});function de(ve,le,Ee,Re){return(0,s.useMemo)(()=>{const Oe=[{id:"state",label:(0,r.t)("alerting.use-columns.columns.label.state","State"),renderCell:({data:Se})=>(0,n.jsx)(fe,{rule:Se}),size:"165px"},{id:"name",label:(0,r.t)("alerting.use-columns.columns.label.name","Name"),renderCell:({data:Se})=>Se.name,size:Ee?4:5},{id:"metadata",label:"",renderCell:({data:Se})=>{const{promRule:Te,rulerRule:_e}=Se,He=(0,C.uo)(Te??_e);return He?(0,n.jsx)(d.T,{pluginId:He.pluginId}):C.p.grafana.rule(_e)&&_e.grafana_alert.provenance?(0,n.jsx)(O.rS,{}):null},size:"100px"},{id:"warnings",label:"",renderCell:({data:Se})=>(0,n.jsx)(K,{rule:Se}),size:"45px"},{id:"health",label:(0,r.t)("alerting.use-columns.columns.label.health","Health"),renderCell:({data:{promRule:Se,group:Te}})=>Se?(0,n.jsx)(N,{rule:Se}):null,size:"75px"}];return ve&&Oe.push({id:"summary",label:(0,r.t)("alerting.use-columns.label.summary","Summary"),renderCell:({data:Se})=>(0,n.jsx)(U.Y,{input:Se.annotations[b.YH.summary]??""}),size:Ee?4:5}),Ee&&Oe.push({id:"nextEvaluation",label:(0,r.t)("alerting.use-columns.label.next-evaluation","Next evaluation"),renderCell:({data:Se})=>{const Te=(0,E.C)(Se.promRule?.lastEvaluation,Se.group.interval);return Te&&(0,n.jsx)(l.m,{placement:"top",content:`${Te?.fullDate}`,theme:"info",children:(0,n.jsx)("span",{children:Te?.humanized})})},size:2}),le&&Oe.push({id:"group",label:(0,r.t)("alerting.use-columns.label.group","Group"),renderCell:({data:Se})=>{const{namespace:Te,group:_e}=Se;return _e.name==="default"?(0,n.jsx)(j.c,{namespace:Te.name}):(0,n.jsx)(j.c,{namespace:Te.name,group:_e.name})},size:5}),Oe.push({id:"actions",label:(0,r.t)("alerting.use-columns.label.actions","Actions"),renderCell:({data:Se})=>(0,n.jsx)(ae,{rule:Se,isLoadingRuler:Re}),size:"215px"}),Oe},[Ee,ve,le,Re])}function fe({rule:ve}){const{isDeleting:le,isCreating:Ee,isPaused:Re}=ie(ve);return(0,n.jsx)(X,{rule:ve,isDeleting:le,isCreating:Ee,isPaused:Re})}function ae({rule:ve,isLoadingRuler:le}){const Ee=(0,u.of)(oe),{isDeleting:Re,isCreating:Oe}=ie(ve);return le?(0,n.jsx)(i.A,{containerClassName:Ee.skeletonWrapper}):(0,n.jsx)(W.l,{compact:!0,showViewButton:!Re&&!Oe,rule:ve,rulesSource:ve.namespace.rulesSource})}function ce(ve){const le=(0,h.$)(Oe=>Oe.rulerRules),Ee=(0,D.EV)(ve);return!!le[Ee]?.result}function ie(ve){const le=ve.namespace.rulesSource,Ee=ce(le),{hasRuler:Re}=(0,m.y)(le),{promRule:Oe,rulerRule:Se}=ve;if(J&&!C.p.grafana.rule(Se))return{isDeleting:!1,isCreating:!1,isPaused:!1};const Te=!!(Re&&Ee&&Oe&&!Se),_e=!!(Re&&Ee&&Se&&!Oe),He=C.p.grafana.rule(Se)&&(0,C.hC)(Se);return{isDeleting:Te,isCreating:_e,isPaused:He}}},83903:(te,R,e)=>{"use strict";e.d(R,{y:()=>r});var n=e(74848),a=e(84266),s=e(67834);const i={[a.Or.Active]:"bad",[a.Or.Unprocessed]:"neutral",[a.Or.Suppressed]:"info"},r=({state:u})=>(0,n.jsx)(s.O,{state:i[u],children:u})},2218:(te,R,e)=>{"use strict";e.d(R,{A:()=>f});var n=e(74848),a=e(96540),s=e(92745),i=e(8207),r=e(41654),u=e(24158),o=e(52161),l=e(5358);const f=a.memo(({ruleUid:p,onClose:c})=>(0,n.jsx)(i._,{title:(0,s.t)("alerting.silence-grafana-rule-drawer.title-silence-alert-rule","Silence alert rule"),subtitle:"Configure silences to stop notifications from a particular alert rule.",onClose:c,size:"md",children:(0,n.jsx)(r.B,{direction:"column",children:(0,n.jsx)(l.b9,{accessType:"instance",children:(0,n.jsx)(u.SilencesEditor,{ruleUid:p,alertManagerSourceName:o.hY,onSilenceCreated:c,onCancel:c})})})}),(p,c)=>p.ruleUid===c.ruleUid)},24158:(te,R,e)=>{"use strict";e.r(R),e.d(R,{SilencesEditor:()=>Ee,default:()=>Se});var n=e(74848),a=e(22803),s=e(2543),i=e(96540),r=e(49785),u=e(54148),o=e(40996),l=e(74529),g=e(25229),f=e(92745),p=e(68143),c=e(36490),x=e(43173),v=e(6975),m=e(34999),y=e(63142),h=e(16780),d=e(37386),E=e(63527),b=e(87105),D=e(41654),C=e(45861),P=e(62421),M=e(95443),O=e(52161),j=e(84266),U=e(16692),W=e(5358),B=e(86017),S=e(77256),_=e(88547),K=e(36826),T=e(58750),L=e(3271),A=e(18857),N=e(76319),V=e(70327);const z=({className:Te,required:_e,ruleUid:He})=>{const tt=(0,y.of)(w),Je=(0,r.xW)(),{control:Ge,register:je,formState:{errors:Fe}}=Je,{fields:Be=[],append:Ke,remove:Ue}=(0,r.jz)({name:"matchers"}),[we,{data:Xe}]=V.hK.endpoints.getAlertRule.useLazyQuery();return(0,i.useEffect)(()=>{He&&we({uid:He})},[we,He]),(0,n.jsx)("div",{className:Te,children:(0,n.jsx)(d.D,{label:(0,f.t)("alerting.matchers-field.label-refine-affected-alerts","Refine affected alerts"),required:_e,children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:(0,a.cx)(tt.matchers,tt.indent),children:[Xe&&(0,n.jsxs)("div",{children:[(0,n.jsx)(d.D,{label:(0,f.t)("alerting.matchers-field.label-alert-rule","Alert rule"),disabled:!0,children:(0,n.jsx)(E.p,{id:"alert-rule-name",defaultValue:Xe.grafana_alert.title,disabled:!0})}),(0,n.jsx)(L.c,{})]}),Be.map((nt,he)=>(0,n.jsxs)("div",{className:tt.row,"data-testid":"matcher",children:[(0,n.jsx)(d.D,{label:(0,f.t)("alerting.matchers-field.label-label","Label"),invalid:!!Fe?.matchers?.[he]?.name,error:Fe?.matchers?.[he]?.name?.message,children:(0,n.jsx)(E.p,{...je(`matchers.${he}.name`,{required:{value:_e,message:(0,f.t)("alerting.matchers-field.message.required","Required.")}}),defaultValue:nt.name,placeholder:(0,f.t)("alerting.matchers-field.placeholder-label","label"),id:`matcher-${he}-label`})}),(0,n.jsx)(d.D,{label:(0,f.t)("alerting.matchers-field.label-operator","Operator"),children:(0,n.jsx)(r.xI,{control:Ge,render:({field:{onChange:xe,ref:me,...ye}})=>(0,n.jsx)(A.l6,{...ye,onChange:De=>xe(De.value),className:tt.matcherOptions,options:B.xH,"aria-label":(0,f.t)("alerting.matchers-field.aria-label-operator","operator"),id:`matcher-${he}-operator`}),defaultValue:nt.operator||B.xH[0].value,name:`matchers.${he}.operator`,rules:{required:{value:_e,message:(0,f.t)("alerting.matchers-field.message.required","Required.")}}})}),(0,n.jsx)(d.D,{label:(0,f.t)("alerting.matchers-field.label-value","Value"),invalid:!!Fe?.matchers?.[he]?.value,error:Fe?.matchers?.[he]?.value?.message,children:(0,n.jsx)(E.p,{...je(`matchers.${he}.value`,{required:{value:_e,message:(0,f.t)("alerting.matchers-field.message.required","Required.")}}),defaultValue:nt.value,placeholder:(0,f.t)("alerting.matchers-field.placeholder-value","value"),id:`matcher-${he}-value`})}),(Be.length>1||!_e)&&(0,n.jsx)(N.K,{"aria-label":(0,f.t)("alerting.matchers-field.aria-label-remove-matcher","Remove matcher"),className:tt.removeButton,name:"trash-alt",onClick:()=>Ue(he),children:(0,n.jsx)(f.x6,{i18nKey:"alerting.matchers-field.remove",children:"Remove"})})]},`${nt.id}`))]}),(0,n.jsx)(C.$n,{className:tt.indent,tooltip:(0,f.t)("alerting.matchers-field.tooltip-refine-which-alert-instances-silenced-selecting","Refine which alert instances are silenced by selecting label matchers"),type:"button",icon:"plus",variant:"secondary",onClick:()=>{const nt={name:"",value:"",operator:j.ho.equal};Ke(nt)},children:(0,n.jsx)(f.x6,{i18nKey:"alerting.matchers-field.add-matcher",children:"Add matcher"})})]})})})},w=Te=>({wrapper:(0,a.css)({marginTop:Te.spacing(2)}),row:(0,a.css)({marginTop:Te.spacing(1),display:"flex",alignItems:"flex-start",flexDirection:"row",backgroundColor:Te.colors.background.secondary,padding:`${Te.spacing(1)} ${Te.spacing(1)} 0 ${Te.spacing(1)}`,"& > * + *":{marginLeft:Te.spacing(2)}}),removeButton:(0,a.css)({marginLeft:Te.spacing(1),marginTop:Te.spacing(2.5)}),matcherOptions:(0,a.css)({minWidth:"140px"}),matchers:(0,a.css)({maxWidth:`${Te.breakpoints.values.sm}px`,margin:`${Te.spacing(1)} 0`,paddingTop:Te.spacing(.5)}),indent:(0,a.css)({marginLeft:Te.spacing(2)})}),H=z;var Q=e(56265);const Z=()=>{const{control:Te,getValues:_e}=(0,r.xW)(),{field:{onChange:He,value:tt},fieldState:{invalid:Je}}=(0,r.as)({name:"startsAt",control:Te,rules:{validate:nt=>_e().endsAt>nt}}),{field:{onChange:Ge,value:je},fieldState:{invalid:Fe}}=(0,r.as)({name:"endsAt",control:Te,rules:{validate:nt=>_e().startsAt<nt}}),{field:{onChange:Be,value:Ke}}=(0,r.as)({name:"timeZone",control:Te}),Ue=Je||Fe,we=(0,g.KQ)(tt),Xe=(0,g.KQ)(je);return(0,n.jsx)(d.D,{className:Y.timeRange,label:(0,f.t)("alerting.silence-period.label-silence-start-and-end","Silence start and end"),error:Ue?"To is before or the same as from":"",invalid:Ue,children:(0,n.jsx)(Q.b,{value:{from:we,to:Xe,raw:{from:we,to:Xe}},timeZone:Ke,onChange:nt=>{He((0,g.KQ)(nt.from)),Ge((0,g.KQ)(nt.to))},onChangeTimeZone:nt=>Be(nt),hideTimeZone:!1,hideQuickRanges:!0,placeholder:(0,f.t)("alerting.silence-period.placeholder-select-time-range","Select time range")})})},Y={timeRange:(0,a.css)({width:"400px"})};var X=e(45214),I=e(45967),J=e(30703),ee=e(99887),q=e(91984),ne=e(15629),se=e(7840),oe=e(6106),de=e(83903);const fe=(Te,_e,He)=>{const[tt,Je]=(0,i.useState)();(0,o.A)(Te,_e,[tt]),(0,X.A)(()=>{Je(He)},[He])},ae=({amSourceName:Te,matchers:_e,ruleUid:He})=>{const tt=[...He?[{name:M.kW,value:He,operator:j.ho.equal}]:[],..._e].map(B.Wc),Je=q.m.endpoints.getAlertmanagerAlerts.useLazyQuery,Ge=(0,y.of)(ie),je=ce(),Fe=He||_e.some(nt=>nt.value&&nt.name),[Be,{currentData:Ke=[],isFetching:Ue,isError:we}]=Je();if(fe(()=>{Fe&&Be({amSourceName:Te,filter:{matchers:tt}})},500,[Te,tt]),we)return(0,n.jsx)(m.F,{title:(0,f.t)("alerting.silenced-instances-preview.title-preview-not-available","Preview not available"),severity:"error",children:(0,n.jsx)(f.x6,{i18nKey:"alerting.silenced-instances-preview.error-generating-preview",children:"Error occurred when generating preview of affected alerts. Are your matchers valid?"})});const Xe=Ke.map(nt=>({id:nt.fingerprint,data:nt}));return(0,n.jsxs)("div",{children:[(0,n.jsxs)("h4",{className:Ge.title,children:[(0,n.jsx)(f.x6,{i18nKey:"alerting.silences.affected-instances",children:"Affected alert instances"}),(0,n.jsx)(I.m,{content:(0,n.jsxs)("div",{children:[(0,n.jsx)(f.x6,{i18nKey:"alerting.silences.preview-affected-instances",children:"Preview the alert instances affected by this silence."}),(0,n.jsx)("br",{}),(0,n.jsx)(f.x6,{i18nKey:"alerting.silences.only-firing-instances",children:"Only alert instances in the firing state are displayed."})]}),children:(0,n.jsxs)("span",{children:["\xA0",(0,n.jsx)(J.I,{name:"info-circle",size:"sm"})]})}),Xe.length>0?(0,n.jsx)(ee.E,{className:Ge.badge,color:"blue",text:Xe.length}):null]}),!Fe&&(0,n.jsx)("span",{children:(0,n.jsx)(f.x6,{i18nKey:"alerting.silenced-instances-preview.valid-matcher-affected-alerts",children:"Add a valid matcher to see affected alerts"})}),Ue&&(0,n.jsx)(v._,{text:(0,f.t)("alerting.silenced-instances-preview.text-loading-affected-alert-rule-instances","Loading affected alert rule instances...")}),!Ue&&!we&&Fe&&(0,n.jsx)("div",{className:Ge.table,children:Xe.length>0?(0,n.jsx)(oe.E,{items:Xe,isExpandable:!1,cols:je,pagination:{itemsPerPage:10}}):(0,n.jsx)("span",{children:(0,n.jsx)(f.x6,{i18nKey:"alerting.silenced-instances-preview.no-firing-alert-instances-found",children:"No firing alert instances found"})})})]})};function ce(){const Te=(0,y.of)(ie);return[{id:"state",label:(0,f.t)("alerting.use-columns.label.state","State"),renderCell:function({data:He}){return(0,n.jsx)(de.y,{state:He.status.state})},size:"120px",className:Te.stateColumn},{id:"labels",label:(0,f.t)("alerting.use-columns.label.labels","Labels"),renderCell:function({data:He}){return(0,n.jsx)(se.m,{labels:He.labels,size:"sm"})},size:"auto"},{id:"created",label:(0,f.t)("alerting.use-columns.label.created","Created"),renderCell:function({data:He}){return(0,n.jsx)(n.Fragment,{children:(0,ne.mo)(He.startsAt)?"-":(0,g.KQ)(He.startsAt).format("YYYY-MM-DD HH:mm:ss")})},size:"180px"}]}const ie=Te=>({table:(0,a.css)({maxWidth:`${Te.breakpoints.values.lg}px`}),moreMatches:(0,a.css)({marginTop:Te.spacing(1)}),title:(0,a.css)({display:"flex",alignItems:"center"}),badge:(0,a.css)({marginLeft:Te.spacing(1)}),stateColumn:(0,a.css)({display:"flex",alignItems:"center"})});var ve=e(39947);const le=()=>{const{id:Te=""}=(0,u.g)(),{selectedAlertmanager:_e=""}=(0,W.VI)(),{data:He,isLoading:tt,error:Je}=P.F.endpoints.getSilence.useQuery({id:Te,datasourceUid:(0,O.w5)(_e),ruleMetadata:!0,accessControl:!0}),Ge=He?.matchers?.find(Ue=>Ue.name===M.kW)?.value,je=_e===O.hY,Fe=(0,i.useMemo)(()=>{if(!He)return;const Ue=He.matchers?.filter(we=>we.name!==M.kW);return(0,ve.Ee)({...He,matchers:Ue})},[He]);return Te&&tt?(0,n.jsx)(v._,{text:(0,f.t)("alerting.existing-silence-editor.text-loading-existing-silence-information","Loading existing silence information...")}):(0,p.NF)(Je)&&Je.status===404?(0,n.jsx)(m.F,{title:(0,f.t)("alerting.existing-silence-editor.title-silence-not-found",'Existing silence "{{silenceId}}" not found',{silenceId:Te}),severity:"warning"}):(je?He?.accessControl?.write:!0)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(T.M,{currentAlertmanager:_e}),(0,n.jsx)(Ee,{ruleUid:Ge,formValues:Fe,alertManagerSourceName:_e})]}):(0,n.jsx)(m.F,{title:(0,f.t)("alerting.existing-silence-editor.title-permission-editrecreate-silence","You do not have permission to edit/recreate this silence"),severity:"error"})},Ee=({formValues:Te=(0,ve.Di)(),alertManagerSourceName:_e,onSilenceCreated:He,onCancel:tt,ruleUid:Je})=>{const[Ge,je]=(0,U.L7)(U.QI.PreviewSilencedInstances),Fe=Ge&&je,[Be,{isLoading:Ke}]=P.F.endpoints.createSilence.useMutation(),Ue=(0,r.mN)({defaultValues:Te}),we=(0,y.of)(Re),{register:Xe,handleSubmit:nt,formState:he,watch:xe,setValue:me,clearErrors:ye}=Ue,[De,Le,Ve,ze]=xe(["duration","startsAt","endsAt","matchers"]),Ze=()=>{c.Ny.push((0,S.nL)("/alerting/silences",_e))},Me=He||Ze,$e=tt||Ze,at=async St=>{const{id:Pt,startsAt:Dt,endsAt:Ye,comment:mt,createdBy:zt,matchers:Jt}=St;Je&&Jt.push({name:M.kW,value:Je,operator:j.ho.equal});const Xt=Jt.map(B.Wc).filter(ln=>ln.name&&ln.value),En=(0,s.pickBy)({id:Pt,startsAt:Dt,endsAt:Ye,comment:mt,createdBy:zt,matchers:Xt},ln=>!!ln);await Be({datasourceUid:(0,O.w5)(_e),payload:En}).unwrap().then(ln=>{Me?.(ln)})},[ct,ft]=(0,i.useState)(De);(0,o.A)(()=>{if((0,l.vd)(Le)&&(0,l.vd)(Ve))if(De!==ct)me("endsAt",(0,g.KQ)((0,l.Ri)(new Date(Le),(0,l.E9)(De))).toISOString()),ft(De);else{const St=new Date(Le).valueOf();if(new Date(Ve).valueOf()>St){const Dt=(0,l.dU)({start:new Date(Le),end:new Date(Ve)});me("duration",Dt),ft(Dt)}}},700,[ye,De,Ve,ct,me,Le]);const Et=!!(x.$.bootData.user.isSignedIn&&x.$.bootData.user.name);return(0,n.jsx)(r.Op,{...Ue,children:(0,n.jsxs)("form",{onSubmit:nt(at),children:[(0,n.jsxs)(h.n,{className:we.formContainer,children:[(0,n.jsxs)("div",{className:we.silencePeriod,children:[(0,n.jsx)(Z,{}),(0,n.jsx)(d.D,{label:(0,f.t)("alerting.silences-editor.label-duration","Duration"),invalid:!!he.errors.duration,error:he.errors.duration&&(he.errors.duration.type==="required"?"Required field":he.errors.duration.message),children:(0,n.jsx)(E.p,{...Xe("duration",{validate:St=>Object.keys((0,l.E9)(St)).length===0?"Invalid duration. Valid example: 1d 4h (Available units: y, M, w, d, h, m, s)":void 0}),id:"duration"})})]}),(0,n.jsx)(H,{required:!Je,ruleUid:Je}),(0,n.jsx)(d.D,{label:(0,f.t)("alerting.silences-editor.label-comment","Comment"),required:!0,error:he.errors.comment?.message,invalid:!!he.errors.comment,children:(0,n.jsx)(b.f,{...Xe("comment",{required:{value:!0,message:(0,f.t)("alerting.silences-editor.message.required","Required.")}}),rows:5,placeholder:(0,f.t)("alerting.silences-editor.comment-placeholder-details-about-the-silence","Details about the silence"),id:"comment"})}),!Et&&(0,n.jsx)(d.D,{label:(0,f.t)("alerting.silences-editor.label-created-by","Created By"),required:!0,error:he.errors.createdBy?.message,invalid:!!he.errors.createdBy,children:(0,n.jsx)(E.p,{...Xe("createdBy",{required:{value:!0,message:(0,f.t)("alerting.silences-editor.message.required","Required.")}}),placeholder:(0,f.t)("alerting.silences-editor.placeholder-whos-creating-the-silence","Who's creating the silence")})}),Fe&&(0,n.jsx)(ae,{amSourceName:_e,matchers:ze,ruleUid:Je})]}),(0,n.jsxs)(D.B,{gap:1,children:[Ke&&(0,n.jsx)(C.$n,{disabled:!0,icon:"spinner",variant:"primary",children:(0,n.jsx)(f.x6,{i18nKey:"alerting.silences-editor.saving",children:"Saving..."})}),!Ke&&(0,n.jsx)(C.$n,{type:"submit",children:(0,n.jsx)(f.x6,{i18nKey:"alerting.silences-editor.save-silence",children:"Save silence"})}),(0,n.jsx)(C.z9,{onClick:$e,variant:"secondary",children:(0,n.jsx)(f.x6,{i18nKey:"alerting.common.cancel",children:"Cancel"})})]})]})})},Re=Te=>({formContainer:(0,a.css)({maxWidth:Te.breakpoints.values.md}),alertRule:(0,a.css)({paddingBottom:Te.spacing(2)}),silencePeriod:(0,a.css)({display:"flex",flexDirection:"row",justifyContent:"flex-start",gap:Te.spacing(1),maxWidth:Te.breakpoints.values.sm,paddingTop:Te.spacing(2)})});function Oe(){const Te={id:"silence-edit",text:(0,f.t)("alerting.existing-silence-editor-page.page-nav.text.edit-silence","Edit silence"),subTitle:"Recreate existing silence to stop notifications from a particular alert rule"};return(0,n.jsx)(K.y,{navId:"silences",pageNav:Te,accessType:"instance",children:(0,n.jsx)(le,{})})}const Se=(0,_.S)(Oe)},39947:(te,R,e)=>{"use strict";e.d(R,{Di:()=>p,Ee:()=>f,LP:()=>g});var n=e(74529),a=e(22592),s=e(25229),i=e(43173),r=e(86017),u=e(95443),o=e(63895),l=e(84266);const g=c=>{const x={},v=c.get("comment"),y=c.getAll("matcher").filter(d=>!d.startsWith(u.kW)),h=(0,o.ou)(y);return h.length&&(x.matchers=h.map(r.MU)),v&&(x.comment=v),x},f=c=>{const x=new Date,m=Date.parse(c.endsAt)<Date.now()?{start:x,end:(0,n.Ri)(x,{hours:2})}:{start:new Date(c.startsAt),end:new Date(c.endsAt)};return{id:c.id,startsAt:m.start.toISOString(),endsAt:m.end.toISOString(),comment:c.comment,createdBy:c.createdBy,duration:(0,n.dU)(m),isRegex:!1,matchers:c.matchers?.map(r.MU)||[],matcherName:"",matcherValue:"",timeZone:a.lE}},p=c=>{const x=new Date,v=(0,n.Ri)(x,{hours:2});return{id:"",startsAt:x.toISOString(),endsAt:v.toISOString(),comment:`created ${(0,s.KQ)().format("YYYY-MM-DD HH:mm")}`,createdBy:i.$.bootData.user.name,duration:"2h",isRegex:!1,matcherName:"",matcherValue:"",timeZone:a.lE,matchers:[{name:"",value:"",operator:l.ho.equal}],...c}}},17349:(te,R,e)=>{"use strict";e.d(R,{X:()=>a});var n=e(11257);const a=[n.w.AlertingTemplatesRead,n.w.AlertingTemplatesWrite,n.w.AlertingTemplatesDelete]},74869:(te,R,e)=>{"use strict";e.d(R,{VB:()=>o,f2:()=>u,sk:()=>r,wS:()=>i});var n=e(43173),a=e(1487),s=e(77256);const i=()=>n.$.featureToggles.alertingPrometheusRulesPrimary??!1,r=()=>{const l=(0,a.H)("alertingListViewV2");return n.$.featureToggles.alertingListViewV2PreviewToggle&&l!==void 0?l:n.$.featureToggles.alertingListViewV2},u=()=>((0,s.qc)()&&n.$.featureToggles.alertingRuleRecoverDeleted&&n.$.featureToggles.alertRuleRestore)??!1,o=()=>(u()&&n.$.featureToggles.alertingRulePermanentlyDelete)??!1},75756:(te,R,e)=>{"use strict";e.d(R,{Y:()=>u});var n=e(92745),a=e(70327),s=e(96137),i=e(80218),r=e(71639);function u(){const[o]=(0,r.D)(),[l]=a.hK.endpoints.upsertRuleGroupForNamespace.useMutation(),[g]=a.hK.endpoints.deleteRuleGroupFromNamespace.useMutation();return(0,i.Yb)(async(f,p)=>{const{groupName:c,namespaceName:x}=f,v=(0,s.KH)({identifier:p}),{newRuleGroupDefinition:m,rulerConfig:y}=await o(f,[v]),h=(0,n.t)("alerting.rules.delete-rule.success","Rule successfully deleted");return m.rules.length===0?g({rulerConfig:y,namespace:x,group:c,notificationOptions:{successMessage:h}}).unwrap():l({rulerConfig:y,namespace:x,payload:m,notificationOptions:{successMessage:h}}).unwrap()})}},71639:(te,R,e)=>{"use strict";e.d(R,{D:()=>c,_:()=>p});var n=e(86791),a=e(70327),s=e(55143),i=e(62939),r=e(96137),u=e(84523),o=e(52161);const l=!0,{useLazyGetRuleGroupForNamespaceQuery:g}=a.hK,{useLazyDiscoverDsFeaturesQuery:f}=s.L,p=v=>new Error(`DataSource ${v} does not support ruler API or does not have the ruler API enabled.`);function c(){const[v,m]=g(),[y]=f();return[async(d,E)=>{const{dataSourceName:b,groupName:D,namespaceName:C}=d,P=b==="grafana"?n.l$:(0,o.w5)(b),{rulerConfig:M}=await y({uid:P},l).unwrap();if(!M)throw p(b);const O=await v({rulerConfig:M,namespace:C,group:D,notificationOptions:{showErrorAlert:!1}}).unwrap().catch(i.R),j=O??x(D);return{newRuleGroupDefinition:E.reduce((W,B)=>(O&&r.Qn.match(B)&&(B.payload.interval=O.interval),(0,r.i3)(W,B)),j),rulerConfig:M}},m]}const x=v=>({name:v,interval:u.T6,rules:[]})},23390:(te,R,e)=>{"use strict";e.d(R,{d:()=>p,pU:()=>c});var n=e(1932),a=e(2543),s=e.n(a),i=e(92745),r=e(70327),u=e(96137),o=e(29609),l=e(80218),g=e(75756),f=e(71639);function p(){const[m]=(0,f.D)(),[y]=r.hK.endpoints.upsertRuleGroupForNamespace.useMutation(),h=(0,i.t)("alerting.rules.add-rule.success","Rule added successfully");return(0,l.Yb)(async(d,E,b)=>{const{namespaceName:D}=d,C=(0,u.Qn)({rule:E,interval:b,groupName:d.groupName}),{newRuleGroupDefinition:P,rulerConfig:M}=await m(d,[C]);return y({rulerConfig:M,namespace:D,payload:P,notificationOptions:{successMessage:h}}).unwrap()})}function c(){const[m]=(0,f.D)(),[y]=x(),[h]=r.hK.endpoints.upsertRuleGroupForNamespace.useMutation(),d=(0,i.t)("alerting.rules.update-rule.success","Rule updated successfully");return(0,l.Yb)(async(E,b,D,C,P)=>{const{namespaceName:M}=E,O=v(b,D),j=(0,a.isEqual)(E,C);if(C&&!j)return y.execute(E,C,b,D,P);const U=(0,u.Wu)({identifier:b,rule:O}),{newRuleGroupDefinition:W,rulerConfig:B}=await m(E,[U]);return h({rulerConfig:B,namespace:M,payload:W,notificationOptions:{successMessage:d}}).unwrap()})}function x(){const[m]=(0,f.D)(),[y]=(0,g.Y)(),[h]=r.hK.endpoints.upsertRuleGroupForNamespace.useMutation(),d=(0,i.t)("alerting.rules.update-rule.success","Rule updated successfully");return(0,l.Yb)(async(E,b,D,C,P)=>{const M=v(D,C),O=(0,u.Qn)({rule:M,interval:P}),{newRuleGroupDefinition:j,rulerConfig:U}=await m(b,[O]),W=await h({rulerConfig:U,namespace:b.namespaceName,payload:j,notificationOptions:{successMessage:d}}).unwrap();return(0,o.A4)(D)||await y.execute(E,D),W})}function v(m,y){const h=(0,o.A4)(m);return(0,n.jM)(y,d=>{const E=o.p.grafana.rule(d);h&&E&&(d.grafana_alert.uid=m.uid)})}},11504:(te,R,e)=>{"use strict";e.d(R,{G:()=>s});var n=e(96540),a=e(29609);function s(i){return(0,n.useMemo)(()=>(0,a.fC)(i),[i])}},16692:(te,R,e)=>{"use strict";e.d(R,{$m:()=>d,Ej:()=>O,Es:()=>A,Gy:()=>B,Hl:()=>w,L7:()=>z,M6:()=>N,QI:()=>y,RY:()=>E,aw:()=>P,e2:()=>M,hT:()=>L,iI:()=>V,j5:()=>h,mW:()=>W,mh:()=>j});var n=e(96540),a=e(15130),s=e(76070),i=e(66513),r=e(88114),u=e(18404),o=e(84266),l=e(11257),g=e(91984),f=e(5358),p=e(54),c=e(67598),x=e(77256),v=e(29609),m=e(12770),y=(J=>(J.ViewExternalConfiguration="view-external-configuration",J.UpdateExternalConfiguration="update-external-configuration",J.CreateContactPoint="create-contact-point",J.ViewContactPoint="view-contact-point",J.UpdateContactPoint="edit-contact-points",J.DeleteContactPoint="delete-contact-point",J.ExportContactPoint="export-contact-point",J.CreateNotificationTemplate="create-notification-template",J.ViewNotificationTemplate="view-notification-template",J.UpdateNotificationTemplate="edit-notification-template",J.DeleteNotificationTemplate="delete-notification-template",J.DecryptSecrets="decrypt-secrets",J.CreateNotificationPolicy="create-notification-policy",J.ViewNotificationPolicyTree="view-notification-policy-tree",J.UpdateNotificationPolicyTree="update-notification-policy-tree",J.DeleteNotificationPolicy="delete-notification-policy",J.ExportNotificationPolicies="export-notification-policies",J.ViewAutogeneratedPolicyTree="view-autogenerated-policy-tree",J.CreateSilence="create-silence",J.ViewSilence="view-silence",J.UpdateSilence="update-silence",J.PreviewSilencedInstances="preview-silenced-alerts",J.ViewTimeInterval="view-time-interval",J.CreateTimeInterval="create-time-interval",J.UpdateTimeInterval="update-time-interval",J.DeleteTimeInterval="delete-time-interval",J.ExportTimeIntervals="export-time-intervals",J.ViewAlertGroups="view-alert-groups",J))(y||{}),h=(J=>(J.Duplicate="duplicate-alert-rule",J.View="view-alert-rule",J.Update="update-alert-rule",J.Delete="delete-alert-rule",J.Explore="explore-alert-rule",J.Silence="silence-alert-rule",J.ModifyExport="modify-export-rule",J.Pause="pause-alert-rule",J.Restore="restore-alert-rule",J.DeletePermanently="delete-alert-rule-permanently",J))(h||{}),d=(J=>(J.Pause="pause-folder",J.Delete="delete-folder",J))(d||{}),E=(J=>(J.CreateAlertRule="create-alert-rule",J.ViewAlertRule="view-alert-rule",J.UpdateAlertRule="update-alert-rule",J.DeleteAlertRule="delete-alert-rule",J.ExportGrafanaManagedRules="export-grafana-managed-rules",J.ReadConfigurationStatus="read-configuration-status",J.CreateExternalAlertRule="create-external-alert-rule",J.ViewExternalAlertRule="view-external-alert-rule",J.UpdateExternalAlertRule="update-external-alert-rule",J.DeleteExternalAlertRule="delete-external-alert-rule",J))(E||{});const b=!0,D=!1,C=()=>({"pause-folder":[b,(0,x.qc)()],"delete-folder":[b,(0,x.qc)()]}),P=J=>C()[J],M=()=>({"create-alert-rule":I(b,l.w.AlertingRuleCreate),"view-alert-rule":I(b,l.w.AlertingRuleRead),"update-alert-rule":I(b,l.w.AlertingRuleUpdate),"delete-alert-rule":I(b,l.w.AlertingRuleDelete),"export-grafana-managed-rules":I(b,l.w.AlertingRuleRead),"read-configuration-status":[b,a.TP.hasPermission(l.w.AlertingInstanceRead)||a.TP.hasPermission(l.w.AlertingNotificationsRead)],"create-external-alert-rule":I(b,l.w.AlertingRuleExternalWrite),"view-external-alert-rule":I(b,l.w.AlertingRuleExternalRead),"update-external-alert-rule":I(b,l.w.AlertingRuleExternalWrite),"delete-external-alert-rule":I(b,l.w.AlertingRuleExternalWrite)}),O=J=>M()[J];function j(J,ee){const q=S(J);return(0,n.useMemo)(()=>q[ee],[q,ee])}function U(J,ee){const q=S(J);return useMemo(()=>ee.map(ne=>q[ne]),[q,ee])}function W(J,ee,q){const ne=_(J,ee);return(0,n.useMemo)(()=>ne[q],[ne,q])}function B(J,ee,q){const ne=_(J,ee);return(0,n.useMemo)(()=>q.map(se=>ne[se]),[ne,q])}function S(J){const ee=(0,n.useMemo)(()=>c.HA.fromCombinedRule(J),[J]);return _(J.rulerRule,ee)}function _(J,ee){const q=(0,c.rO)(ee),{isEditable:ne,isRemovable:se,isRulerAvailable:oe=!1,loading:de}=(0,m.g)(q,J),[fe,ae]=O("export-grafana-managed-rules"),ce=Q(J);return(0,n.useMemo)(()=>{const ve=J?(0,v.Nv)(J):!1,le=!1,Ee=v.p.grafana.rule(J),Re=(0,v.Tm)(J),Oe=ve||le||Re,Se=de?D:oe,Te=Oe?D:Se,_e=Re?D:Se,He=(0,p.Wd)(q);return{"duplicate-alert-rule":I(_e,He.create),"view-alert-rule":I(b,He.read),"update-alert-rule":[Te,ne??!1],"delete-alert-rule":[Te,se??!1],"explore-alert-rule":I(b,l.w.DataSourcesExplore),"silence-alert-rule":ce,"modify-export-rule":[Ee,ae],"pause-alert-rule":[Te&&Ee,ne??!1],"restore-alert-rule":[Te&&Ee,ne??!1],"delete-alert-rule-permanently":[Te&&Ee,(se&&(0,x.qc)())??!1]}},[J,de,oe,q,ne,se,ce,ae])}function K(J){const{isEditable:ee,isRemovable:q,loading:ne}=T(J),[se,oe]=O("export-grafana-managed-rules"),de=Y(),fe=Z(J?.folderUid);return(0,n.useMemo)(()=>{const ce=J?(0,v.bL)(J):!1,ie=!1,ve=v.R$.grafana.alertingRule(J),le=(0,v.Tm)(J),Ee=ce||ie||le,Re=ne?D:b,Oe=Ee?D:Re,Se=le?D:Re,Te=(0,p.Wd)("grafana");return{"duplicate-alert-rule":I(Se,Te.create),"view-alert-rule":I(b,Te.read),"update-alert-rule":[Oe,ee??!1],"delete-alert-rule":[Oe,q??!1],"explore-alert-rule":I(b,l.w.DataSourcesExplore),"silence-alert-rule":[de,fe&&ve],"modify-export-rule":[ve,oe],"pause-alert-rule":[Oe&&ve,ee??!1],"restore-alert-rule":[Oe&&ve,ee??!1],"delete-alert-rule-permanently":[Oe&&ve,(q&&(0,x.qc)())??!1]}},[J,ne,ee,q,fe,oe,de])}function T(J){const ee=J?.folderUid,{folder:q,loading:ne}=(0,u.a)(ee);return(0,n.useMemo)(()=>{if(!J||!ee)return{isEditable:!1,isRemovable:!1,loading:!1};if(!q)return{isEditable:!1,isRemovable:!1,loading:ne};const se=(0,p.Wd)("grafana"),oe=a.TP.hasPermissionInMetadata(se.update,q),de=a.TP.hasPermissionInMetadata(se.delete,q);return{isEditable:oe,isRemovable:de,loading:ne}},[J,ee,q,ne])}const L=Symbol("ability-skip-token");function A(J,ee){const q=K(J===L?void 0:J);return(0,n.useMemo)(()=>q[ee],[q,ee])}function N(J,ee){const q=K(J===L?void 0:J);return(0,n.useMemo)(()=>ee.map(ne=>q[ne]),[q,ee])}function V(){const{selectedAlertmanager:J,hasConfigurationAPI:ee,isGrafanaAlertmanager:q}=(0,f.VI)(),ne=(0,p.lV)(J),se=(0,p.jy)(J);return{"view-external-configuration":I(b,l.w.AlertingNotificationsExternalRead),"update-external-configuration":I(ee,l.w.AlertingNotificationsExternalWrite),"create-contact-point":I(ee,ne.create,...q?[l.w.AlertingReceiversCreate]:[]),"view-contact-point":I(b,ne.read,...q?s.PE:[]),"edit-contact-points":I(ee,ne.update,...q?[l.w.AlertingReceiversWrite]:[]),"delete-contact-point":I(ee,ne.delete,...q?[l.w.AlertingReceiversWrite]:[]),"export-contact-point":[q,q],"create-notification-template":I(ee,ne.create,...q?[l.w.AlertingTemplatesWrite]:[]),"view-notification-template":I(b,ne.read,...q?[l.w.AlertingTemplatesRead]:[]),"edit-notification-template":I(ee,ne.update,...q?[l.w.AlertingTemplatesWrite]:[]),"delete-notification-template":I(ee,ne.delete),"create-notification-policy":I(ee,ne.create,...q?r.nv:[]),"view-notification-policy-tree":I(b,ne.read,...q?r.rw:[]),"update-notification-policy-tree":I(ee,ne.update,...q?r.nv:[]),"delete-notification-policy":I(ee,ne.delete,...q?r.nv:[]),"export-notification-policies":I(q,ne.read),"decrypt-secrets":I(q,ne.provisioning.readSecrets),"view-autogenerated-policy-tree":[q,(0,x.qc)()],"create-silence":I(b,se.create),"view-silence":I(b,se.read),"update-silence":I(b,se.update),"preview-silenced-alerts":I(b,se.read),"create-time-interval":I(ee,ne.create,...q?i.Zr:[]),"view-time-interval":I(b,ne.read,...q?i.xK:[]),"update-time-interval":I(ee,ne.update,...q?i.Zr:[]),"delete-time-interval":I(ee,ne.delete,...q?i.Zr:[]),"export-time-intervals":I(q,ne.read),"view-alert-groups":I(b,se.read)}}function z(J){const ee=V();return(0,n.useMemo)(()=>ee[J],[ee,J])}function w(J){const ee=V();return(0,n.useMemo)(()=>J.map(q=>ee[q]),[ee,J])}const{useGetGrafanaAlertingConfigurationStatusQuery:H}=g.m;function Q(J){const ee=v.p.grafana.rule(J)?J.grafana_alert.namespace_uid:void 0,{loading:q,folder:ne}=(0,u.a)(ee),se=J&&v.p.grafana.rule(J),oe=v.p.grafana.recordingRule(J),de=Y(),fe=Z(ee);return J?!se||oe||q||!ne?[!1,!1]:[de,fe]:[!1,!1]}function Z(J){const q=X(J)[l.w.AlertingSilenceCreate]??!1;return a.TP.hasPermission(l.w.AlertingInstanceCreate)||q}function Y(){const{currentData:J,isLoading:ee}=H(void 0),q=J?.alertmanagersChoice===o.nA.External,ne=J?.alertmanagersChoice===o.nA.All;return ee?!1:!q||ne}function X(J){const{folder:ee}=(0,u.a)(J);return ee?.accessControl??{}}const I=(J,...ee)=>[J,ee.some(q=>q&&a.TP.hasPermission(q))]},93395:(te,R,e)=>{"use strict";e.d(R,{W:()=>s});var n=e(96540),a=e(52161);function s(i){return(0,n.useMemo)(()=>(0,a.sq)(i),[i])}},55096:(te,R,e)=>{"use strict";e.d(R,{g:()=>i});var n=e(96540),a=e(36580),s=e(78282);function i(r){return{allDataSourcesAvailable:(0,n.useMemo)(()=>r.filter(o=>!(0,a.s9)(o.datasourceUid)).every(o=>!!(0,s.l)().getInstanceSettings(o.datasourceUid)),[r])}}},80218:(te,R,e)=>{"use strict";e.d(R,{Gz:()=>f,VP:()=>g,Yb:()=>i,bJ:()=>u});var n=e(74848),a=e(96540),s=e(77256);function i(c,x){const[v,m]=(0,a.useState)({status:"not-executed",error:void 0,result:x}),y=(0,a.useRef)(),h=(0,a.useRef)(),d=r({execute(...E){h.current=E;const b=c(...E);return y.current=b,m(D=>({...D,status:"loading"})),b.then(D=>{b===y.current&&m(C=>({...C,status:"success",error:void 0,result:D}))},D=>{b===y.current&&m(C=>({...C,status:"error",error:D}))}),b},reset(){m({status:"not-executed",error:void 0,result:x}),y.current=void 0,h.current=void 0}});return[(0,a.useMemo)(()=>({reset(){d.current.reset()},execute:(...E)=>d.current.execute(...E)}),[]),v,{promise:y.current,lastArgs:h.current}]}function r(c){const x=(0,a.useRef)(c);return x.current=c,(0,a.useMemo)(()=>Object.freeze({get current(){return x.current}}),[])}function u(c){return c.status==="error"}function o(c){return c.status==="success"}function l(c){return c.status==="not-executed"}function g(c){return c.status==="loading"}function f(...c){return{uninitialized:c.every(l),loading:c.some(g),error:c.find(u)?.error,success:c.some(o)}}function p({state:c}){return jsxs(Fragment,{children:[l(c)&&"uninitialized",g(c)&&"loading",o(c)&&"success",o(c)&&`result: ${JSON.stringify(c.result,null,2)}`,u(c)&&`error: ${stringifyErrorLike(c.error)}`]})}},44109:(te,R,e)=>{"use strict";e.d(R,{FY:()=>v,Ll:()=>y,O3:()=>h,ZU:()=>x,we:()=>c});var n=e(10378),a=e(96540),s=e(16817),i=e(52161),r=e(70327),u=e(55143),o=e(67598),l=e(94646),g=e(29609),f=e(23265),p=e(18404);function c(d,E,b){const D=(0,i.oh)(E),{dsFeatures:C,isLoadingDsFeatures:P}=h(E),{currentData:M,isLoading:O,error:j}=r.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:E,ruleName:d,namespace:b?.namespace,groupName:b?.groupName}),[U]=r.hK.endpoints.getRuleGroupForNamespace.useLazyQuery(),{loading:W,error:B,value:S}=(0,s.A)(async()=>{if(!D)throw new Error("Unable to obtain data source settings");if(j)throw new Error("Unable to obtain Prometheus rules");const _=M||[],K=[];if(C?.rulerConfig){const A=C.rulerConfig,N=_.map(V=>V.groups.map(z=>({namespace:V,group:z}))).flat();await Promise.allSettled(N.map(async V=>{const z=await U({rulerConfig:A,namespace:V.namespace.name,group:V.group.name}).unwrap();K.push(z)}))}return _.map(A=>(0,f.O6)(D,A,K)).flatMap(A=>A.groups.flatMap(N=>N.rules))},[D,C,O,j,M,U]);return{loading:P||W,error:B,rules:S}}function x({ruleIdentifier:d,limitAlerts:E}){const{ruleSourceName:b}=d,D=m(d),{dsFeatures:C,isLoadingDsFeatures:P}=h(b),{loading:M,error:O,result:j}=v(d),{currentData:U=[],isLoading:W,error:B}=r.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:d.ruleSourceName,namespace:j?.namespace,groupName:j?.group,ruleName:j?.ruleName,limitAlerts:E},{skip:!j||M,refetchOnMountOrArgChange:!0}),S=(0,i.z2)(b),_=(0,p.a)(S?j?.namespace:void 0),K=S&&_.folder?(0,p.W)(_.folder):j?.namespace,[T,{currentData:L,isLoading:A,error:N}]=r.hK.endpoints.getRuleGroupForNamespace.useLazyQuery();(0,a.useEffect)(()=>{!C?.rulerConfig||!j||T({rulerConfig:C.rulerConfig,namespace:j.namespace,group:j.group})},[C,T,j]);const V=(0,a.useMemo)(()=>{if(!D||!j)return;const z=L&&K?{[K]:[L]}:{};return(0,f.gt)(D,U,z).flatMap(Z=>Z.groups).flatMap(Z=>Z.rules).find(Z=>l.LC(l.UP(b,Z),d))},[d,b,U,L,D,j,K]);return{loading:M||P||W||A,error:O??B??N,result:V}}function v(d){const E=(0,g.A4)(d)&&d.uid!==""?{uid:d.uid}:n.hT,{isLoading:b,currentData:D,error:C,isUninitialized:P}=r.hK.endpoints.getAlertRule.useQuery(E,{refetchOnMountOrArgChange:!0});return(0,a.useMemo)(()=>{if((0,g.Mj)(d)||(0,g.X4)(d))try{return{result:{datasource:d.ruleSourceName,namespace:d.namespace,group:d.groupName,ruleName:d.ruleName,groupIdentifier:o.HA.fromRuleIdentifier(d)},loading:!1}}catch(M){return{loading:!1,error:M}}return(0,g.A4)(d)?b||P?{loading:!0}:C?{loading:!1,error:C}:D?{result:{datasource:d.ruleSourceName,namespace:D.grafana_alert.namespace_uid,group:D.grafana_alert.rule_group,ruleName:D.grafana_alert.title,groupIdentifier:{namespace:{uid:D.grafana_alert.namespace_uid},groupName:D.grafana_alert.rule_group,groupOrigin:"grafana"}},loading:!1}:{loading:!1,error:new Error(`Unable to obtain rule location for rule ${d.uid}`)}:{loading:!1,error:new Error("Unsupported rule identifier")}},[d,b,P,C,D])}function m(d){return(0,g.A4)(d)?"grafana":(0,i.oh)(d.ruleSourceName)}function y({ruleIdentifier:d}){const E=m(d),{data:b,isLoading:D}=u.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:d.ruleSourceName}),{loading:C,error:P,result:M}=v(d),[O,{currentData:j,isLoading:U,isUninitialized:W,error:B}]=r.hK.endpoints.getRuleGroupForNamespace.useLazyQuery();(0,a.useEffect)(()=>{!b?.rulerConfig||!M||O({rulerConfig:b.rulerConfig,namespace:M.namespace,group:M.group})},[b,O,M]);const S=(0,a.useMemo)(()=>{const{ruleSourceName:_}=d;if(!j||!E||!M)return;const K=j.rules.find(T=>{const L=l.P1(_,M.namespace,M.group,T);return l.LC(L,d)});if(K)return{ruleSourceName:_,group:j,namespace:M.namespace,rule:K}},[d,j,E,M]);return{loading:C||D||U||W,error:P??B,result:S}}function h(d){const{currentData:E,isLoading:b}=u.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:d});return{isLoadingDsFeatures:b,dsFeatures:E}}},23265:(te,R,e)=>{"use strict";e.d(R,{Jr:()=>d,NW:()=>P,O6:()=>m,Tj:()=>M,Ug:()=>C,dy:()=>x,gt:()=>v,kU:()=>S,yh:()=>y});var n=e(2543),a=e.n(n),s=e(96540),i=e(86791),r=e(24619),u=e(70327),o=e(55143),l=e(95443),g=e(52161),f=e(94646),p=e(29609),c=e(98127);function x(K,T){const L=(0,c.$)(z=>z.promRules),A=(0,c.$)(z=>z.rulerRules),N=(0,s.useRef)({}),V=(0,s.useMemo)(()=>{if(K){const z=(0,g.Zw)(K);if(!z)throw new Error(`Unknown rules source: ${K}`);return[z]}return(0,g.lS)()},[K]);return(0,s.useMemo)(()=>V.map(z=>{const w=(0,g.Eb)(z)?z.name:z,H=A[w]?.result;let Q=L[w]?.result;w===g.hY&&T&&(Q=T);const Z=N.current[w];if(Z&&Z.promRules===Q&&Z.rulerRules===H)return Z.result;const Y={};Object.entries(H||{}).forEach(([I,J])=>{const ee={rulesSource:z,name:I,groups:[]};p.p.grafana.rule(J[0].rules[0])&&(ee.uid=J[0].rules[0].grafana_alert.namespace_uid),Y[I]=ee,b(ee,J)}),Q?.forEach(({name:I,groups:J})=>{const ee=Y[I]=Y[I]||{rulesSource:z,name:I,groups:[]};D(ee,J)});const X=Object.values(Y);return N.current[w]={promRules:Q,rulerRules:H,result:X},X}).flat(),[L,A,V,T])}function v(K,T,L){const A={};return Object.entries(L||{}).forEach(([N,V])=>{const z={rulesSource:K,name:N,groups:[]};A[N]=z,b(z,V)}),T?.forEach(({name:N,groups:V})=>{const z=A[N]=A[N]||{rulesSource:K,name:N,groups:[]};D(z,V)}),Object.values(A)}function m(K,T,L){const A={rulesSource:K,name:T.name,groups:[]};return b(A,L),D(A,T.groups),A.groups.forEach(N=>{N.rules=N.rules.filter(V=>V.promRule)}),A}function y(K,T){if(!K.promRule)return;const A=T.rules.map(V=>U(V,K.namespace,K.group)).reduce((V,z)=>{const w=V.get(_(z));return w?w.push(z):V.set(_(z),[z]),V},new Map),N=W(K.promRule,A,K.namespace.rulesSource);N&&(K.rulerRule=N.rulerRule,K.query=N.query,K.labels=N.labels,K.annotations=N.annotations)}function h(K,T,L){return b(K,L),D(K,T),K}function d(K){return K.map(T=>{const L={...T,groups:[]};return L.groups.push({name:"default",rules:E(T.groups.flatMap(A=>A.rules)),totals:O(T.groups)}),L})}function E(K){return K.sort((T,L)=>T.name.localeCompare(L.name))}function b(K,T=[]){K.groups=T.map(L=>{const A=L.rules.filter(z=>p.p.any.recordingRule(z)).length,N=L.rules.filter(z=>p.p.grafana.alertingRule(z)&&(0,p.hC)(z)).length,V={name:L.name,interval:L.interval,source_tenants:L.source_tenants,rules:[],totals:{paused:N,recording:A}};return V.rules=L.rules.map(z=>U(z,K,V)),V})}function D(K,T){const L=new Map;K.groups.forEach(A=>L.set(A.name,A)),T.forEach(A=>{let N=L.get(A.name);N||(N={name:A.name,rules:[],totals:M(A)},K.groups.push(N),L.set(A.name,N)),N.totals={...N.totals,...M(A)};const V=new Map;N.rules.forEach(z=>{const w=V.get(_(z));w?w.push(z):V.set(_(z),[z])}),(A.rules??[]).forEach(z=>{const w=W(z,V,K.rulesSource);w?(w.promRule=z,w.instanceTotals=p.R$.alertingRule(z)?C(z):{},w.filteredInstanceTotals=p.R$.alertingRule(z)?P(z):{}):N.rules.push(j(z,K,N))})})}function C(K){const T=(0,n.countBy)(K.alerts,"state");if(K.totals){const{normal:L,...A}=K.totals;return{...A,inactive:L}}return{alerting:T[i.$7.Alerting]||T.firing,pending:T[i.$7.Pending],recovering:T[i.$7.Recovering],inactive:T[i.$7.Normal],nodata:T[i.$7.NoData],error:T[i.$7.Error]||T.err||void 0}}function P(K){if(K.totalsFiltered){const{normal:T,...L}=K.totalsFiltered;return{...L,inactive:T}}return{}}function M(K){if(K.totals){const{firing:N,...V}=K.totals;return{...V,alerting:N}}const T=(0,n.countBy)(K.rules,N=>p.R$.alertingRule(N)&&N.state),L=(0,n.countBy)(K.rules,N=>N.health),A=K.rules.filter(N=>p.R$.recordingRule(N)).length;return{alerting:T[r.cF.Firing],error:L.error,nodata:L.nodata,inactive:T[r.cF.Inactive],pending:T[r.cF.Pending],recovering:T[r.cF.Recovering],recording:A}}function O(K){const T={};return K.forEach(L=>{const A=L.totals;Object.entries(A).forEach(([N,V])=>{T[N]||(T[N]=0),V!=null&&(T[N]+=V)})}),T}function j(K,T,L){return{name:K.name,query:K.query,labels:K.labels||{},annotations:p.R$.alertingRule(K)?(0,p.Rh)(K):{},promRule:K,namespace:T,group:L,instanceTotals:p.R$.alertingRule(K)?C(K):{},filteredInstanceTotals:p.R$.alertingRule(K)?P(K):{}}}function U(K,T,L){const A={labels:K.labels||{},rulerRule:K,namespace:T,group:L,instanceTotals:{},filteredInstanceTotals:{},uid:p.p.grafana.rule(K)?K.grafana_alert.uid:void 0};return p.p.dataSource.alertingRule(K)?{...A,name:K.alert,query:K.expr,annotations:K.annotations||{}}:p.p.dataSource.recordingRule(K)?{...A,name:K.record,query:K.expr,annotations:{}}:{...A,name:K.grafana_alert.title,query:"",annotations:K.annotations||{}}}function W(K,T,L){const A=_(K),N=T.get(A);if(!N)return;if((0,g.z2)(L))return N[0];const V=N.find(w=>!w.promRule&&B(w,K,!0));if(V)return V;const z=N.find(w=>!w.promRule&&B(w,K,!1));if(z)return z}function B(K,T,L=!0){const A=p.R$.alertingRule(T)?(0,p.Rh)(T):{},N=T.labels??{},V=L?(0,f.h1)(T.query):"",z=K.annotations,w=K.labels,H=L?(0,f.h1)(K.query):"";return K.name===T.name?(0,n.isEqual)([H,w,z],[V,N,A]):!1}function S(K,T,L){const A=!K,{currentData:N,isLoading:V,error:z}=u.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:g.hY,dashboardUid:K??void 0,panelId:T},{skip:A,pollingInterval:L?l.HH:void 0}),{currentData:w,isLoading:H,error:Q}=u.hK.endpoints.rulerRules.useQuery({rulerConfig:o.b,filter:{dashboardUID:K??void 0,panelId:T}},{pollingInterval:L?l.HH:void 0,skip:A}),Z=(0,s.useRef)({}),Y=(0,g.Zw)(g.hY),X=(0,s.useMemo)(()=>{if(!Y)return[];const I=Z.current[g.hY];if(I&&I.promRules===N&&I.rulerRules===w)return I.result;const J={};Object.entries(w||{}).forEach(([q,ne])=>{const se={rulesSource:Y,name:q,groups:[]};p.p.grafana.rule(ne[0].rules[0])&&(se.uid=ne[0].rules[0].grafana_alert.namespace_uid),J[q]=se,b(se,ne)}),N?.forEach(({name:q,groups:ne})=>{const se=J[q]=J[q]||{rulesSource:Y,name:q,groups:[]};D(se,ne)});const ee=Object.values(J);return Z.current[g.hY]={promRules:N,rulerRules:w,result:ee},ee},[N,w,Y]);return{loading:V||H,error:z??Q,result:X}}function _(K){return K.uid?K.uid??"":K.name}},96784:(te,R,e)=>{"use strict";e.d(R,{dI:()=>C,i7:()=>P});var n=e(84139),a=e(1932),s=e(2543),i=e.n(s),r=e(96540),u=e(78282),o=e(24619),l=e(74268),g=e(56369),f=e(86017),p=e(95443),c=e(52161),x=e(63895),v=e(29609),m=e(23265),y=e(20962);const h=25,d=1/0,E=5,b=/[^ -~]/m,D=/^[\x21-\x2F\x3A-\x40\x5B-\x60\x7B-\x7E]+$/m;function C(){const[K,T]=(0,y.l)(),L=K.get("search")??"",A=(0,r.useMemo)(()=>(0,g.XY)(L),[L]),N=(0,r.useMemo)(()=>Object.values(A).some(H=>!(0,s.isEmpty)(H)),[A]),V=(0,r.useMemo)(()=>(0,s.chain)(A).omitBy(s.isEmpty).keys().filter(_).value(),[A]),z=(0,r.useCallback)(H=>{const Q=(0,g.kL)(L,H);T({search:Q})},[L,T]),w=(0,r.useCallback)(H=>{T({search:H})},[T]);return(0,r.useEffect)(()=>{const H={dataSource:K.get("dataSource")??void 0,alertState:K.get("alertState")??void 0,ruleType:K.get("ruleType")??void 0,labels:(0,x.S6)(K.get("queryString")??"").map(f.MU)};Object.values(H).some(Z=>!(0,s.isEmpty)(Z))&&(T({dataSource:void 0,alertState:void 0,ruleType:void 0,queryString:void 0}),z((0,a.jM)(A,Z=>{if(Z.dataSourceNames??=H.dataSource?[H.dataSource]:[],H.alertState&&(0,o.Si)(H.alertState)&&(Z.ruleState??=H.alertState),H.ruleType&&(0,v.nf)(H.ruleType)&&(Z.ruleType??=H.ruleType),Z.labels.length===0&&H.labels.length>0){const Y=H.labels.map(({name:X,operator:I,value:J})=>`${X}${I}${J}`);Z.labels.push(...Y)}})))},[K,z,A,T]),{filterState:A,hasActiveFilters:N,activeFilters:V,searchQuery:L,setSearchQuery:w,updateFilters:z}}const P=(K,T)=>{const L=(0,r.useDeferredValue)(K),A=(0,r.useDeferredValue)(T);return(0,r.useMemo)(()=>{const N=M(L,A);return N.forEach(V=>{V.groups.forEach(z=>{z.rules.forEach(w=>{v.R$.alertingRule(w.promRule)&&(w.instanceTotals=(0,m.Ug)(w.promRule),w.filteredInstanceTotals=(0,m.NW)(w.promRule))}),z.totals=(0,m.Tj)({rules:z.rules.map(w=>w.promRule).filter(w=>!!w)})})}),N},[L,A])},M=(K,T={dataSourceNames:[],labels:[],freeFormWords:[]})=>{let L=K;const A=T.dataSourceNames;A.length&&(L=L.filter(({rulesSource:z})=>(0,c.Eb)(z)?A.includes(z.name):!0));const N=T.namespace;N&&(L=W(L,z=>z.name,N));const V=[];try{L.reduce(O(T),[]).forEach(w=>{V.push(w)})}catch(z){(0,l.vV)(new Error("Failed to filter rules",{cause:z}),{search:JSON.stringify(T)})}return V},O=K=>(T,L)=>{const A=K.groupName;let N=L.groups;return A&&(N=W(N,V=>V.name,A)),N=N.reduce(j(K),[]),N.length&&T.push({...L,groups:N}),T},j=K=>{const T=K.ruleName??K.freeFormWords.join(" ");return(L,A)=>{let N=A.rules;return T&&(N=W(N,V=>V.name,T)),N=N.filter(V=>{const z=V.promRule,w=(0,s.chain)(K).pick(["ruleType","dataSourceNames","ruleHealth","labels","ruleState","dashboardUid","plugins","contactPoint"]).omitBy(s.isEmpty).mapValues(()=>!1).value();if("ruleType"in w&&K.ruleType===z?.type&&(w.ruleType=!0),"plugins"in w&&K.plugins==="hide"&&(w.plugins=V.rulerRule&&!(0,v.Tm)(V.rulerRule)),"contactPoint"in w){const H=K.contactPoint;v.p.grafana.rule(V.rulerRule)&&V.rulerRule.grafana_alert.notification_settings?.receiver===H&&(w.contactPoint=!0)}if("dataSourceNames"in w&&(v.p.grafana.rule(V.rulerRule)?B(V.rulerRule,K)&&(w.dataSourceNames=!0):w.dataSourceNames=!0),"ruleHealth"in K&&z){const H=(0,v.f6)(z.health);K.ruleHealth===H&&(w.ruleHealth=!0)}if("labels"in w){const H=(0,s.compact)(K.labels.map(U)),Q=H.length>0&&(0,f.Av)(V.labels,H),Z=H.length>0&&z&&z.type===o.JS.Alerting&&z.alerts&&z.alerts.some(Y=>(0,f.Av)(Y.labels,H));(Q||Z)&&(w.labels=!0)}if("ruleState"in w){const H=V.promRule;H&&v.R$.alertingRule(H)&&H.state===K.ruleState&&(w.ruleState=!0)}return"dashboardUid"in w&&V.annotations[p.YH.dashboardUID]===K.dashboardUid&&(w.dashboardUid=!0),Object.values(w).every(H=>H===!0)}),N.length&&L.push({...A,rules:N}),L}};function U(K){try{return(0,x.qR)(K)}catch{return{name:K,value:"",isRegex:!0,isEqual:!0}}}function W(K,T,L){let A=K;const N=new n.A({intraMode:1}),V=N.split(L).length;if(b.test(L)||D.test(L)||L.length>h||V>E)return K.filter(X=>T(X).toLowerCase().includes(L.toLowerCase()));const w=K.map(T),H=V<5?4:0,[Q,Z,Y]=N.search(w,L,H,d);return Z&&Y?A=Y.map(X=>A[Z.idx[X]]):Q&&(A=Q.map(X=>A[X])),A}const B=(K,T)=>T.dataSourceNames?.length?!!K.grafana_alert.data.find(L=>{if(!L.datasourceUid)return!1;const A=(0,u.l)().getInstanceSettings(L.datasourceUid);return A?.name&&T?.dataSourceNames?.includes(A.name)}):!0,S=new Set(["freeFormWords","namespace","groupName","ruleName","ruleState","ruleType","dataSourceNames","labels","ruleHealth","dashboardUid","plugins","contactPoint"]),_=K=>S.has(K)},18404:(te,R,e)=>{"use strict";e.d(R,{W:()=>i,a:()=>s});var n=e(10378),a=e(18346);function s(u){const o=(0,a.kH)(u||n.hT);return{loading:o.isLoading,folder:o.data}}function i({title:u,parents:o}){return o&&o?.length?[...o.map(l=>l.title),u].map(r).join("/"):r(u)}function r(u){return u.replaceAll("/","\\/")}},11940:(te,R,e)=>{"use strict";e.d(R,{w:()=>r,y:()=>i});var n=e(55143),a=e(52161);const{useDiscoverDsFeaturesQuery:s}=n.L;function i(u){const o=(0,a.EV)(u),{currentData:l}=s({rulesSourceName:o});return{hasRuler:!!l?.rulerConfig,rulerConfig:l?.rulerConfig}}function r(u){const{currentData:o}=s({uid:u.uid});return{hasRuler:!!o?.rulerConfig,rulerConfig:o?.rulerConfig}}},12770:(te,R,e)=>{"use strict";e.d(R,{g:()=>u});var n=e(15130),a=e(55143),s=e(54),i=e(29609),r=e(18404);function u(o,l){const{currentData:g,isLoading:f,error:p}=a.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:o}),c=l&&i.p.grafana.rule(l)?l.grafana_alert.namespace_uid:void 0,x=(0,s.Wd)(o),{folder:v,loading:m}=(0,r.a)(c);if(p)return{isEditable:!1,isRemovable:!1,loading:!1,isRulerAvailable:!1,error:p};if(!l)return{isEditable:!1,isRemovable:!1,loading:!1};if(i.p.grafana.rule(l)){if(!c)throw new Error(`Rule ${l.grafana_alert.title} does not have a folder uid, cannot determine if it is editable.`);if(!v)return{isRulerAvailable:!0,isEditable:!1,isRemovable:!1,loading:m};const E=n.TP.hasPermissionInMetadata(x.update,v),b=n.TP.hasPermissionInMetadata(x.delete,v);return{isRulerAvailable:!0,isEditable:E,isRemovable:b,loading:m||f}}const y=!!g?.rulerConfig,h=n.TP.hasPermission(x.update),d=n.TP.hasPermission(x.delete);return{isRulerAvailable:y,isEditable:h&&y,isRemovable:d&&y,loading:f}}},74048:(te,R,e)=>{"use strict";e.d(R,{W:()=>i});var n=e(2543),a=e.n(n),s=e(96540);function i(r,u=1,o){const[l,g]=(0,s.useState)(u),f=(0,s.useMemo)(()=>(0,n.chunk)(r,o),[r,o]),p=f.length,c=f[l-1]??[],x=(l-1)*o+1,v=(0,n.clamp)(l*o,r.length),m=(0,s.useCallback)(d=>{g((0,n.clamp)(d,1,f.length))},[g,f]),y=(0,s.useCallback)(()=>m(l+1),[l,m]),h=(0,s.useCallback)(()=>m(l-1),[l,m]);return(0,s.useEffect)(()=>g(1),[p]),{page:l,onPageChange:m,numberOfPages:p,pageItems:c,pageStart:x,pageEnd:v,nextPage:y,previousPage:h}}},21764:(te,R,e)=>{"use strict";e.d(R,{S:()=>a});var n=e(23265);function a({dashboardUID:s,panelId:i,poll:r=!1}){const{result:u,loading:o,error:l}=(0,n.kU)(s,i,r);return{rules:u?u.flatMap(f=>f.groups).flatMap(f=>f.rules):[],errors:l?[l]:[],loading:o}}},3986:(te,R,e)=>{"use strict";e.d(R,{_:()=>s});var n=e(16817),a=e(95027);function s(i){const{loading:r,error:u,value:o}=(0,n.A)(()=>(0,a.x)(i,{showErrorAlert:!1})),l=o&&!u&&!r,g=o?.enabled;return r&&!o?{loading:!0}:!l||!g?{loading:!1,installed:!1}:{loading:r,installed:!0,settings:o}}},43100:(te,R,e)=>{"use strict";e.d(R,{d:()=>v});var n=e(34632),a=e(91984),s=e(72748),i=e(78045),r=e(55614),u=e(15518),o=e(5358);function l(...m){return{error:m.find(y=>y.error),isUninitialized:m.every(y=>y.isUninitialized),isSuccess:m.every(y=>y.isSuccess),isError:m.some(y=>y.isError),isLoading:m.some(y=>y.isLoading)}}const g=new Error("no active Alertmanager"),{useLazyGetAlertmanagerConfigurationQuery:f,useUpdateAlertmanagerConfigurationMutation:p}=a.m,c={alertmanager_config:{receivers:[],route:{},time_intervals:[],mute_time_intervals:[],inhibit_rules:[],templates:[]},template_files:{}},x=(0,n.A)(c,s.f1,u.NF,r.r0,i.B8);function v(){const{selectedAlertmanager:m}=(0,o.VI)(),[y,h]=f(),[d,E]=p(),b=l(h,E);if(!m)throw g;return[async C=>{const P=await y(m).unwrap(),M=x(P,C);return d({selectedAlertmanager:m,config:M}).unwrap()},b]}},80276:(te,R,e)=>{"use strict";e.d(R,{IH:()=>C,zx:()=>D});var n=e(2543),a=e.n(n),s=e(96540),i=e(86791),r=e(74268),u=e(70327),o=e(55143),l=e(94646),g=e(29609),f=e(80218);const{useLazyPrometheusRuleNamespacesQuery:p,useLazyGetRuleGroupForNamespaceQuery:c}=u.hK,{useLazyDiscoverDsFeaturesQuery:x}=o.L,v=3*1e3,m=90*1e3,{setInterval:y,clearInterval:h}=window;function d(){const[M]=p();return{matchingPromRuleExists:(0,s.useCallback)(async j=>{const{ruleSourceName:U,namespace:W,groupName:B,ruleName:S}=j;return(await M({ruleSourceName:U,namespace:W,groupName:B,ruleName:S}).unwrap()).find(L=>L.name===W)?.groups.find(L=>L.name===B)?.rules.some(L=>{const A=l.Lg(U,W,B,L);return l.LC(A,j)})??!1},[M])}}const E=!0;function b(){const[M]=x(),[O]=p(),[j]=c();return{isGroupInSync:(0,s.useCallback)(async W=>{const B=W.groupOrigin==="datasource"?W.rulesSource.uid:i.l$,S=await M({uid:B},E).unwrap();if(!S.rulerConfig)throw new Error("Datasource does not support ruler. Unable to determine group consistency");const _=W.groupOrigin==="datasource"?W.namespace.name:W.namespace.uid,K={ruleSourceName:S.name,namespace:_,groupName:W.groupName,limitAlerts:0,excludeAlerts:!0},T={namespace:_,group:W.groupName,rulerConfig:S.rulerConfig,notificationOptions:{showSuccessAlert:!1,showErrorAlert:!1}},[L,A]=await Promise.allSettled([O(K).unwrap(),j(T).unwrap()]);if(L.status==="rejected"&&A.status==="rejected")return(0,r.vV)(new Error("Error fetching Prometheus and Ruler rule groups",{cause:[L.reason,A.reason]})),!0;if(L.status==="rejected"&&A.status==="fulfilled")return(0,r.vV)(new Error("Error fetching Prometheus rule groups",{cause:L.reason})),!0;if(A.status==="rejected"&&L.status==="fulfilled")return L.value.flatMap(V=>V.groups).every(V=>V.name!==W.groupName);if(L.status==="fulfilled"&&A.status==="fulfilled"){const N=L.value.flatMap(z=>z.groups).find(z=>z.name===W.groupName),V=A.value;if(N&&V){if(!(N.rules.length===V.rules.length))return!1;const w=N.rules.map(Q=>Q.name),H=V.rules.map(g.qz);for(const[Q,Z]of(0,n.zip)(w,H))if(Q!==Z)return!1;return!0}}return!1},[M,O,j])}}function D(){const{isGroupInSync:M}=b(),[O,j]=(0,s.useState)(),U=(0,s.useRef)(),W=(0,s.useRef)();(0,s.useEffect)(()=>()=>{B(),S()},[]);function B(){W.current&&(clearTimeout(W.current),W.current=void 0)}function S(){U.current&&(clearTimeout(U.current),U.current=void 0)}async function _(K){B(),S();const T=new Promise((A,N)=>{W.current=setTimeout(()=>{S();const V=new Error("Timeout while waiting for rule group consistency");(0,r.vV)(V,{groupOrigin:K.groupOrigin}),N(V)},m)}),L=new Promise((A,N)=>{function V(){performance.mark("waitForGroupConsistency:finished");const w=performance.measure("waitForGroupConsistency","waitForGroupConsistency:started","waitForGroupConsistency:finished");(0,r.l$)("alerting:wait-for-group-consistency",{duration:w.duration},{groupOrigin:K.groupOrigin})}function z(){M(K).then(w=>{j(w),w?(V(),A()):U.current=setTimeout(z,v)}).catch(w=>{N(w)}).finally(()=>{B()})}performance.mark("waitForGroupConsistency:started"),z()});return Promise.race([T,L])}return{waitForGroupConsistency:_,groupConsistent:O}}function C(){const{matchingPromRuleExists:M}=d(),O=(0,s.useRef)(),j=(0,s.useRef)();(0,s.useEffect)(()=>()=>{U(),W()},[]);const U=()=>{O.current&&(h(O.current),O.current=void 0)},W=()=>{j.current&&(h(j.current),j.current=void 0)};async function B(_){U();const K=new Promise((L,A)=>{setTimeout(()=>{U(),A(new Error("Timeout while waiting for rule removal"))},m)}),T=new Promise((L,A)=>{O.current=y(()=>{M(_).then(N=>{N===!1&&(U(),L())}).catch(N=>{U(),A(N)})},v)});return Promise.race([K,T])}async function S(_){W();const K=new Promise((L,A)=>{setTimeout(()=>{W(),A(new Error("Timeout while waiting for rule creation"))},m)}),T=new Promise((L,A)=>{j.current=y(()=>{M(_).then(N=>{N===!0&&(W(),L())}).catch(N=>{W(),A(N)})},v)});return Promise.race([K,T])}return{waitForRemoval:B,waitForCreation:S}}function P(M){const{matchingPromRuleExists:O}=d(),{waitForCreation:j}=C(),[U,W]=useAsync(async B=>isCloudRuleIdentifier(B)?j(B):Promise.resolve());return useEffect(()=>{isCloudRuleIdentifier(M)&&O(M).then(B=>{B||U.execute(M)})},[U,M,O]),{isConsistent:W.status==="success"||W.status==="not-executed",error:W.error}}},39187:(te,R,e)=>{"use strict";e.d(R,{h:()=>u,w:()=>o});var n=e(63704),a=e(43173),s=e(36490),i=e(74268),r=e(20962);function u(g){const f={returnTo:g},[p]=(0,r.l)(),c=p.get("returnTo");if(!c)return f;const x=n.sQ.sanitizeUrl(c),v=`${window.location.origin}/${a.$.appSubUrl}`,m=l(x,v);if(!m)return(0,i.FF)("Malformed returnTo parameter",{returnTo:c}),f;const{protocol:y,origin:h,pathname:d,search:E}=m;return["http:","https:"].includes(y)===!1||h!==window.location.origin?((0,i.FF)("Malformed returnTo parameter",{returnTo:c}),f):{returnTo:`${d}${E}`}}function o(g=!0){const{pathname:f,search:p}=s.Ny.getLocation();return f+(g?p:"")}function l(g,f){try{return new URL(g,f)}catch{return null}}},58138:(te,R,e)=>{"use strict";e.d(R,{G:()=>p,Q:()=>f});var n=e(74848),a=e(22803),s=e(96540),i=e(92745),r=e(43173),u=e(63142),o=e(22787);const l=(0,s.lazy)(()=>e.e(2835).then(e.bind(e,32835))),g=(0,s.lazy)(()=>Promise.all([e.e(8706),e.e(4302)]).then(e.bind(e,54302)));var f=(x=>(x.Loki="loki",x.Annotations="annotations",x))(f||{});function p(){const[x,v]=(0,s.useState)(!1),[m,y]=(0,s.useState)(),h=(0,u.of)(c),d=r.$.unifiedAlerting.alertStateHistoryBackend,E=r.$.unifiedAlerting.alertStateHistoryPrimary,D=[d,E].some(O=>O==="loki")?"loki":"annotations",C=(0,s.useCallback)(()=>{y(void 0),v(!1)},[]),P=(0,s.useCallback)(O=>{y(O),v(!0)},[]);return{StateHistoryModal:(0,s.useMemo)(()=>m?(0,n.jsx)(o.a,{isOpen:x,onDismiss:C,closeOnBackdropClick:!0,closeOnEscape:!0,title:(0,i.t)("alerting.use-state-history-modal.state-history-modal.title-state-history","State history"),className:h.modal,contentClassName:h.modalContent,children:(0,n.jsxs)(s.Suspense,{fallback:"Loading...",children:[D==="loki"&&(0,n.jsx)(g,{ruleUID:m.grafana_alert.uid}),D==="annotations"&&(0,n.jsx)(l,{ruleUID:m.grafana_alert.uid??""})]})}):null,[m,x,C,D,h]),showStateHistoryModal:P,hideStateHistoryModal:C}}const c=x=>({modal:(0,a.css)({width:"80%",height:"80%",minWidth:"800px"}),modalContent:(0,a.css)({height:"100%",width:"100%",padding:x.spacing(2)})})},20962:(te,R,e)=>{"use strict";e.d(R,{l:()=>i});var n=e(96540),a=e(54148),s=e(36490);function i(){const{search:r}=(0,a.zy)(),u=(0,n.useMemo)(()=>new URLSearchParams(r),[r]),o=(0,n.useCallback)((l,g)=>{s.Ny.partial(l,g)},[]);return[u,o]}},98127:(te,R,e)=>{"use strict";e.d(R,{$:()=>s});var n=e(25508),a=e(52763);function s(i,r){return(0,a.d4)((0,n.Mz)(u=>u.unifiedAlerting,u=>i(u)),r)}},17305:(te,R,e)=>{"use strict";e.d(R,{T:()=>l});var n=e(74848),a=e(16817),s=e(92745),i=e(99887),r=e(45967),u=e(58851),o=e(95027);function l({pluginId:g,size:f="md"}){const{value:p,loading:c}=(0,a.A)(()=>(0,o.x)(g));if(c||!p)return null;const x=p.info.logos?.small,v=p.name,m=(0,u.cs)(f),y=x?(0,n.jsx)("img",{src:x,alt:v,height:m}):(0,n.jsx)(i.E,{text:g,color:"orange"});return(0,n.jsx)(r.m,{content:(0,s.t)("alerting.plugin-origin-badge.tooltip-managed-by-plugin","This rule is managed by the {{pluginName}} plugin",{pluginName:v}),children:y})}},1487:(te,R,e)=>{"use strict";e.d(R,{H:()=>s,J:()=>i});var n=e(78012);const a="grafana.alerting.previewToggles";function s(r){return n.M.getObject(a,{})[r]}function i(r,u){const o=n.M.getObject(a,{});o[r]=u,n.M.setObject(a,o)}},72748:(te,R,e)=>{"use strict";e.d(R,{$8:()=>o,X9:()=>r,f1:()=>g,ov:()=>u});var n=e(65307),a=e(2543),s=e.n(a),i=e(86017);const r=(0,n.VP)("muteTiming/add"),u=(0,n.VP)("muteTiming/update"),o=(0,n.VP)("muteTiming/delete"),l={alertmanager_config:{},template_files:{}},g=(0,n.vy)(l,f=>{f.addCase(r,(p,{payload:c})=>{const{interval:x}=c;p.alertmanager_config.time_intervals=(p.alertmanager_config.time_intervals??[]).concat(x)}).addCase(u,(p,{payload:c})=>{const{interval:x,originalName:v}=c,m=x.name!==v,y=p.alertmanager_config.time_intervals??[],h=p.alertmanager_config.mute_time_intervals??[],d=y.findIndex(({name:b})=>b===v);d!==-1&&(y[d]=x);const E=h.findIndex(({name:b})=>b===v);E!==-1&&(h[E]=x),m&&p.alertmanager_config.route&&(p.alertmanager_config.route=(0,i.$m)(x.name,v,p.alertmanager_config.route))}).addCase(o,(p,{payload:c})=>{const{name:x}=c,{alertmanager_config:v}=p,{time_intervals:m=[],mute_time_intervals:y=[]}=v;(0,a.remove)(m,h=>h.name===x),(0,a.remove)(y,h=>h.name===x),v.route=(0,i._n)(x,v.route??{})})})},78045:(te,R,e)=>{"use strict";e.d(R,{B8:()=>l,LY:()=>i,Z8:()=>r,tD:()=>u});var n=e(65307),a=e(42824),s=e(67923);const i=(0,n.VP)("routes/update"),r=(0,n.VP)("routes/delete"),u=(0,n.VP)("routes/add"),o={alertmanager_config:{},template_files:{}},l=(0,n.vy)(o,g=>{g.addCase(i,(f,{payload:p})=>{const{update:c,alertmanager:x}=p,{alertmanager_config:v}=f;if(!v.route)return;const m=(0,a.QM)(v.route),y=(0,s.AB)(x,c,m);v.route=(0,s.dn)(y)}).addCase(r,(f,{payload:p})=>{const{id:c}=p,{alertmanager_config:x}=f;if(!x.route)return;const v=(0,a.QM)(x.route),m=(0,s.AS)(c,v);f.alertmanager_config.route=(0,s.dn)(m)}).addCase(u,(f,{payload:p})=>{const{partialRoute:c,referenceRouteIdentifier:x,insertPosition:v,alertmanager:m}=p,{alertmanager_config:y}=f;if(!y.route)return;const h=(0,a.QM)(y.route),d=(0,s.I8)(m,c,x,h,v);f.alertmanager_config.route=(0,s.dn)(d)})})},55614:(te,R,e)=>{"use strict";e.d(R,{FB:()=>r,JI:()=>o,jS:()=>u,r0:()=>g});var n=e(65307),a=e(2543),s=e.n(a),i=e(42801);const r=(0,n.VP)("notificationTemplate/add"),u=(0,n.VP)("notificationTemplate/update"),o=(0,n.VP)("notificationTemplate/delete"),l={alertmanager_config:{},template_files:{}},g=(0,n.vy)(l,f=>{f.addCase(r,(p,{payload:c})=>{const{alertmanager_config:x={},template_files:v={}}=p,{template:m}=c;if(v[m.title]!==void 0)throw new Error("target template already exists");const h=(0,i.o)(m.title,m.content);v[m.title]=h,x.templates=(0,a.toArray)(x.templates).concat(m.title)}).addCase(u,(p,{payload:c})=>{const{alertmanager_config:x={},template_files:v={}}=p,{name:m,template:y}=c,h=m!==y.title;if(!(v[m]!==void 0))throw new Error(`Expected notification template ${m} to exist, but did not find it in the config`);const E=(0,i.o)(y.title,y.content);if(h){const b=m,D=y.title;if(v[D]!==void 0)throw new Error(`Duplicate template name ${D}`);(0,a.unset)(v,b),(0,a.remove)(x.templates??[],P=>P===b),x.templates=(0,a.toArray)(x.templates).concat(y.title)}v[y.title]=E}).addCase(o,(p,{payload:c})=>{const{name:x}=c,{alertmanager_config:v={},template_files:m={}}=p;(0,a.unset)(m,x),(0,a.remove)(v.templates??[],y=>y===x)})})},15518:(te,R,e)=>{"use strict";e.d(R,{BD:()=>r,FS:()=>o,NF:()=>g,Xm:()=>u});var n=e(65307),a=e(2543),s=e.n(a),i=e(48442);const r=(0,n.VP)("receiver/add"),u=(0,n.VP)("receiver/update"),o=(0,n.VP)("receiver/delete"),l={alertmanager_config:{},template_files:{}},g=(0,n.vy)(l,f=>{f.addCase(r,(p,{payload:c})=>{const x=p.alertmanager_config.receivers=p.alertmanager_config.receivers??[];if(x.some(m=>m.name===c.name))throw new Error(`Duplicate receiver name ${c.name}`);x.push(c)}).addCase(u,(p,{payload:c})=>{const{name:x,receiver:v}=c,m=x!==v.name,y=p.alertmanager_config.receivers??[],h=y.findIndex(b=>b.name===x);if(!(h>-1))throw new Error(`Expected receiver ${x} to exist, but did not find it in the config`);if(m&&y.some(D=>D.name===v.name))throw new Error(`Duplicate receiver name ${v.name}`);y[h]=v;const E=p.alertmanager_config.route;E&&m&&(p.alertmanager_config.route=(0,i.Wn)(E,x,v.name))}).addCase(o,(p,{payload:c})=>{(0,a.remove)(p.alertmanager_config.receivers??[],x=>x.name===c)})})},96137:(te,R,e)=>{"use strict";e.d(R,{Ct:()=>E,KH:()=>f,KL:()=>x,LH:()=>g,Qn:()=>o,Wu:()=>l,bw:()=>v,fO:()=>c,i3:()=>y,lF:()=>p});var n=e(65307),a=e(2543),s=e.n(a),i=e(52161),r=e(94646),u=e(29609);const o=(0,n.VP)("ruleGroup/rules/add"),l=(0,n.VP)("ruleGroup/rules/update"),g=(0,n.VP)("ruleGroup/rules/pause"),f=(0,n.VP)("ruleGroup/rules/delete"),p=(0,n.VP)("ruleGroup/update"),c=(0,n.VP)("ruleGroup/move"),x=(0,n.VP)("ruleGroup/rename"),v=(0,n.VP)("ruleGroup/rules/reorder"),m={name:"initial",rules:[]},y=(0,n.vy)(m,D=>{D.addCase(o,(C,{payload:P})=>{const{rule:M}=P;C.rules.push(M)}).addCase(l,(C,{payload:P})=>{const{identifier:M,rule:O}=P,j=b(C.rules,M);C.rules[j]=O}).addCase(f,(C,{payload:P})=>{const{identifier:M}=P,O=b(C.rules,M);C.rules.splice(O,1)}).addCase(g,(C,{payload:P})=>{const{uid:M,pause:O}=P,j={ruleSourceName:i.hY,uid:M},U=b(C.rules,j),W=C.rules[U];if(u.p.grafana.rule(W))W.grafana_alert.is_paused=O;else throw new Error("Matching rule is not a Grafana-managed rule")}).addCase(v,(C,{payload:P})=>{const{swaps:M}=P;d(C.rules,M)}).addMatcher((0,n.i0)(x,c,o),(C,{payload:P})=>{const{groupName:M}=P;C.name=M??C.name}).addMatcher((0,n.i0)(p,x,c,o),(C,{payload:P})=>{const{interval:M}=P;C.interval=M??C.interval}).addDefaultCase((C,P)=>{throw new Error(`Unknown action for rule group reducer: ${P.type}`)})}),h=D=>{const C=(0,u.A4)(D),P=(0,u.X4)(D);return M=>{const O=u.p.grafana.rule(M),j=u.p.dataSource.rule(M);if(C&&O)return M.grafana_alert.uid===D.uid;if(j&&P)return(0,r.Ns)(M)===D.rulerRuleHash}};function d(D,C){for(const P of C)E(D,P);return D}function E(D,[C,P]){if(!((0,a.inRange)(C,D.length)&&(0,a.inRange)(P,D.length)))throw new Error("Invalid operation: index out of bounds");const[O]=D.splice(C,1);D.splice(P,0,O)}function b(D,C){const P=D.findIndex(h(C));if(P===-1)throw new Error("no rule matching identifier found");return P}},84523:(te,R,e)=>{"use strict";e.d(R,{BH:()=>U,IJ:()=>D,JG:()=>M,T6:()=>E,_u:()=>W,b0:()=>O,ir:()=>j});var n=e(2543),a=e.n(n),s=e(47551),i=e(43173),r=e(78282),u=e(24619),o=e(67817),l=e(54),g=e(95443),f=e(52161),p=e(20437),c=e(29609),x=e(15629),v=e(6194);const m=(0,x.P8)(i.$.unifiedAlerting?.minInterval??"10s"),y=(0,x.P8)("1m"),h=1/0,d="0s",E=(0,x.an)((0,n.clamp)(m,y,h));function b(){const S=i.$.unifiedAlerting?.defaultRecordingRulesTargetDatasourceUID;if(S)try{const _=(0,r.l)().getInstanceSettings(S);if(_&&(0,f.Gb)(_))return S}catch{}}const D=S=>{const{canCreateGrafanaRules:_,canCreateCloudRules:K}=(0,l.Q9)(),T=(()=>{if(S===o.Z.grafanaRecording)return o.Z.grafanaRecording;if(_)return o.Z.grafana;if(K)return o.Z.cloudAlerting})();return Object.freeze({name:"",uid:"",labels:[{key:"",value:""}],annotations:g.kl,dataSourceName:f.hY,type:T,group:"",folder:void 0,queries:[],recordingRulesQueries:[],condition:"",noDataState:u.Q8.NoData,execErrState:u.Q8.Error,evaluateFor:E,keepFiringFor:d,evaluateEvery:E,manualRouting:C(),contactPoints:{},overrideGrouping:!1,overrideTimings:!1,muteTimeIntervals:[],editorSettings:P(S),targetDatasourceUid:b(),namespace:"",expression:"",forTime:1,forTimeUnit:"m"})},C=()=>localStorage.getItem(p.Q8)!=="false";function P(S){if(S===o.Z.grafanaRecording||!(i.$.featureToggles.alertingQueryAndExpressionsStepMode??!1))return;const K=localStorage.getItem(p.Os),T=localStorage.getItem(p.Q8);return{simplifiedQueryEditor:K!=="false",simplifiedNotificationEditor:T!=="false"}}function M(S,_){let K;try{K=JSON.parse(S)}catch{return{...D(_),queries:(0,p.qO)()}}return(0,v.bx)((0,v.A2)((0,v.i_)({...D(_),...K,annotations:(0,v.JE)(K.annotations??[]),queries:K.queries??(0,p.qO)(),type:K.type??_??o.Z.grafana,evaluateEvery:E})))}function O(S){const _=B.parse(S);return(0,v.i_)({...D(S.type),..._})}function j(S){return(0,v.i_)((0,p.QX)(S))}function U(S){return{...D(S),condition:"C",queries:(0,p.qO)((0,c.pq)(S)),type:S,evaluateEvery:E}}function W(S=""){return S==="recording"?o.Z.cloudRecording:S==="grafana-recording"?o.Z.grafanaRecording:o.Z.grafana}const B=s.z.looseObject({name:s.z.string().optional(),type:s.z.enum(o.Z).catch(o.Z.grafana),dataSourceName:s.z.string().optional().default(""),group:s.z.string().optional(),labels:s.z.array(s.z.object({key:s.z.string(),value:s.z.string()})).optional().default([]),annotations:s.z.array(s.z.object({key:s.z.string(),value:s.z.string()})).optional().default([]),queries:s.z.array(s.z.any()).optional(),condition:s.z.string().optional(),noDataState:s.z.enum(u.Q8).optional().default(u.Q8.NoData).catch(u.Q8.NoData),execErrState:s.z.enum(u.Q8).optional().default(u.Q8.Error).catch(u.Q8.Error),folder:s.z.union([s.z.object({title:s.z.string(),uid:s.z.string()}),s.z.undefined()]).optional(),evaluateEvery:s.z.string().optional(),evaluateFor:s.z.string().optional().default("0s"),keepFiringFor:s.z.string().optional(),isPaused:s.z.boolean().optional().default(!1),manualRouting:s.z.boolean().optional(),contactPoints:s.z.record(s.z.string(),s.z.object({selectedContactPoint:s.z.string(),overrideGrouping:s.z.boolean(),groupBy:s.z.array(s.z.string()),overrideTimings:s.z.boolean(),groupWaitValue:s.z.string(),groupIntervalValue:s.z.string(),repeatIntervalValue:s.z.string(),muteTimeIntervals:s.z.array(s.z.string()),activeTimeIntervals:s.z.array(s.z.string())})).optional(),editorSettings:s.z.object({simplifiedQueryEditor:s.z.boolean(),simplifiedNotificationEditor:s.z.boolean()}).optional(),metric:s.z.string().optional(),targetDatasourceUid:s.z.string().optional(),namespace:s.z.string().optional(),expression:s.z.string().optional(),missingSeriesEvalsToResolve:s.z.number().optional()})},6194:(te,R,e)=>{"use strict";e.d(R,{A2:()=>p,JE:()=>y,Nx:()=>c,Oy:()=>x,bx:()=>f,i_:()=>m});var n=e(2543),a=e.n(n),s=e(43173),i=e(44022),r=e(4651),u=e(82779),o=e(95443),l=e(52161),g=e(20437);function f(h){if(!(s.$.featureToggles.alertingQueryAndExpressionsStepMode??!1))return{...h,editorSettings:{simplifiedQueryEditor:!1,simplifiedNotificationEditor:!0}};const E=h.queries.filter(C=>!(0,i.f)(C.model)),b=h.queries.filter(C=>x(C)),D=c(E,b);return{...h,editorSettings:{simplifiedQueryEditor:D,simplifiedNotificationEditor:!0}}}function p(h){return{...h,queries:h.queries?.map(d=>{if((0,i.f)(d.model))return d;const E=d.model.datasource?.type?(0,l.cl)(d.model.datasource.type):!1,b="instant"in d.model&&d.model.instant!==void 0?d.model.instant:E;return{...d,model:{...d.model,instant:b,range:!b}}})}}function c(h,d){if(h.length!==1||d.length>2)return!1;const E=h.at(0),b=d.find(_=>_.model.type===r.Tz.reduce),D=d.find(_=>_.model.type===r.Tz.threshold),C=b?(0,u.OC)(b.model):!1,P=D?.model.conditions?.every(_=>(0,n.isEmpty)(_.unloadEvaluator))??!0,M=b&&C,O=D&&P,j=D?.model.expression===b?.refId,U=b?.model.expression===E?.refId;if(M&&U&&O&&j)return!0;const W=E?(0,g.mY)(E):!1,B=d.length===1&&D,S=D?.model.expression===E?.refId;return!!(W&&B&&O&&S)}function x(h){return(0,i.f)(h.model)}function v(h){return!isExpressionQuery(h.model)}const m=h=>({...h,queries:h.queries?.map(d=>(0,n.omit)(d,"model.hide"))});function y(h){const d=[...h];return o.kl.map(b=>b.key).forEach((b,D)=>{const C=d.findIndex(P=>P.key===b);if(C===-1){const P={key:b,value:""};d.splice(D,0,P)}else C!==D&&d.splice(D,0,d.splice(C,1)[0])}),d}},76267:(te,R,e)=>{"use strict";e.d(R,{C:()=>o});var n=e(79197),a=e(48497),s=e(74529),i=e(25229),r=e(80011),u=e(15629);function o(g,f){if(!g||!f||!(0,s.vd)(g))return;let p;try{p=(0,u.M9)(f)}catch{return}if((0,u.mo)(g))return;const c=Date.parse(g||""),x=(0,n.A)(c,p);return(0,a.Y)(x,new Date)?{humanized:`within ${f}`,fullDate:`within ${f}`}:{humanized:`in ${(0,i.KQ)(x).locale("en").fromNow(!0)}`,fullDate:(0,r.LE)(x,{format:"YYYY-MM-DD HH:mm:ss"})}}function l(g){if(!g)return null;if(!isNullDate(g))return formatDistanceToNowStrict(new Date(g))}},56369:(te,R,e)=>{"use strict";e.d(R,{Jc:()=>Q,kL:()=>Y,XY:()=>Z});var n=e(24619),a=e(29609);const s=1,i=2,r=3,u=4,o=5,l=6,g=7,f=8,p=9,c=10,x=11,v=12,m=13,y=14,h=15,d=0,E=1,b=2,D=3,C=4,P=5,M=6,O=7,j=8,U=9,W=10;var B=e(2543),S=e(48820);const _=S.U1.deserialize({version:14,states:"!vOQOPOOO{OPO'#CkOOOO'#Ck'#CkOQOPO'#CoOOOO'#Cl'#ClQQOPOOO!yOQO'#C^O#OOPO'#CmO#TOPO,59VOOOO,59Z,59ZOOOO-E6j-E6jOOOO,58x,58xOOOO,59X,59XOOOO-E6k-E6k",stateData:"$t~ORUOTUOUUOVUOWUOXUOYUOZUO[UO]UO^UOdPOfQO~OeVOR_XT_XU_XV_XW_XX_XY_XZ_X[_X]_X^_Xd_Xf_X~OSZO~Od[O~OeVOR_aT_aU_aV_aW_aX_aY_aZ_a[_a]_a^_ad_af_a~OR~T~U~V~W~Y~Z~[~]~^~R^][ZYXWVUTd~",goto:"}dPPePPPPPPPPPPPPejpPvVRORTQTORYTQWPR]WSSOTRXR",nodeNames:"\u26A0 AlertRuleSearch FilterExpression DataSourceToken FilterValue NameSpaceToken LabelToken GroupToken RuleToken StateToken TypeToken HealthToken DashboardToken PluginsToken ContactPointToken FreeFormExpression",maxTerm:22,skippedNodes:[0],repeatNodeCount:2,tokenData:"$ nRRtqr#crs&ost#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]+q!]#V#c#V#W-T#W#X@m#X#Z#c#Z#[!/S#[#]!7|#]#`#c#`#a!B`#a#b#c#b#c!KY#c#d#c#d#e#,W#e#f#c#f#g#8S#g#h#?d#h#i#H^#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#jcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cQ$zcSQqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uQ&YP;=`<%l$uQ&`P;=`;NQ$uR&fP;=`<%l#cR&lP;=`;NQ#cR&rrX^(|pq(|qr(|st(|tu(|uv(|vw(|wx(|xy(|yz(|z{(|{|(||!P(|!P!Q(|!Q![(|![!](|!]#y(|#y#z(|#z$f(|$f$g(|$g#BY(|#BY#BZ(|#BZ$Ch(|$IS$I_(|$I|$JO(|$JT$JU(|$JU$KV(|$KV$KW(|$KW&FU(|&FU&FV(|&FV;'S(|;'S;(d+e;(d;(e+k<%lO(|R)PsX^(|pq(|qr(|rs+^st(|tu(|uv(|vw(|wx(|xy(|yz(|z{(|{|(||!P(|!P!Q(|!Q![(|![!](|!]#y(|#y#z(|#z$f(|$f$g(|$g#BY(|#BY#BZ(|#BZ$Ch(|$IS$I_(|$I|$JO(|$JT$JU(|$JU$KV(|$KV$KW(|$KW&FU(|&FU&FV(|&FV;'S(|;'S;(d+e;(d;(e+k<%lO(|R+eOSQfPR+hP;=`<%l(|R+nP;=`;NQ(|R+xcSQePqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR-[eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#d.m#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR.teSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#b#c#b#c0V#c$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR0^eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i1o#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR1veSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U3X#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR3`eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#V#c#V#W4q#W$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR4xeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i6Z#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR6beSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]!r#c!r!s7s!s$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR7zeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#d9]#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR9deSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#]#c#]#^:u#^$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR:|eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#b#c#b#c<_#c$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR<feSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i=w#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR>OcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]?Z!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR?bcSQ^Pqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR@teSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#UBV#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRB^fSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#g#c#g#hCr#h#i! n#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRCyeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#[#c#[#]E[#]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cREceSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#U#c#U#VFt#V$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRF{eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#dH^#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRHeeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#UIv#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRI}eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#f#c#f#gK`#g$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRKgeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#W#c#W#XLx#X$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRMPcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]N[!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRNccSQ[Pqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR! ueSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U!#W#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!#_eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#g#c#g#h!$p#h$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!$weSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#d!&Y#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!&aeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#i#c#i#j!'r#j$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!'yeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#f#c#f#g!)[#g$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!)ceSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#V#c#V#W!*t#W$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!*{eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y!,^#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!,ecSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]!-p!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!-wcSQRPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR!/ZeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#f#c#f#g!0l#g$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!0seSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#d!2U#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!2]eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#i#c#i#j!3n#j$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!3ueSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#d#c#d#e!5W#e$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!5_cSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]!6j!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!6qcSQVPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR!8TeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y!9f#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!9meSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U!;O#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!;VeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#`#c#`#a!<h#a$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!<oeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i!>Q#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!>XeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#[#c#[#]!?j#]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!?qcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]!@|!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!ATcSQZPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR!BgeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U!Cx#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!DPeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#U#c#U#V!Eb#V$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!EieSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y!Fz#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!GReSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#`#c#`#a!Hd#a$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!HkcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]!Iv!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!I}cSQUPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR!KaeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U!Lr#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!LyeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#a#c#a#b!N[#b$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!NceSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y# t#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR# {eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#g#c#g#h##^#h$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR##eeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#d#c#d#e#$v#e$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#$}eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U#&`#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#&geSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#V#c#V#W#'x#W$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#(PeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y#)b#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#)icSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#*t!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#*{cSQTPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR#,_eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#`#c#`#a#-p#a$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#-weSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#i#c#i#j#/Y#j$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#/aeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#Z#c#Z#[#0r#[$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#0yeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#]#c#]#^#2[#^$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#2ceSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#b#c#b#c#3t#c$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#3{eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#g#c#g#h#5^#h$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#5ecSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#6p!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#6wcSQ]Pqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR#8ZeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#i#c#i#j#9l#j$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#9seSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#`#c#`#a#;U#a$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#;]eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y#<n#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#<ucSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#>Q!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#>XcSQWPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR#?keSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i#@|#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#ATeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U#Bf#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#BmeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i#DO#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#DVeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y#Eh#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#EocSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#Fz!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#GRcSQXPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR#HeeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#m#c#m#n#Iv#n$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#I}eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#d#c#d#e#K`#e$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#KgeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y#Lx#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#MPcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#N[!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#NccSQYPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$u",tokenizers:[0,1],topRules:{AlertRuleSearch:[0,1]},dialects:{dataSourceFilter:141,nameSpaceFilter:143,labelFilter:145,groupFilter:147,ruleFilter:149,stateFilter:84,typeFilter:151,healthFilter:153,dashboardFilter:155,pluginsFilter:157,contactPointFilter:159},tokenPrec:161}),K={[r]:"datasource",[o]:"namespace",[l]:"label",[f]:"rule",[g]:"group",[p]:"state",[c]:"type",[x]:"health",[v]:"dashboard",[m]:"plugins",[y]:"contactPoint"};var T=(I=>(I.dataSource="dataSourceFilter",I.nameSpace="nameSpaceFilter",I.label="labelFilter",I.group="groupFilter",I.rule="ruleFilter",I.state="stateFilter",I.type="typeFilter",I.health="healthFilter",I.dashboard="dashboardFilter",I.plugins="pluginsFilter",I.contactPoint="contactPointFilter",I))(T||{});function L(I,J,ee){z(I,J,q=>{if(q.type.id===i){const ne=A(I,q);if(ne.type&&ne.value){const se=ee[ne.type];se&&se(ne.value)}}else if(q.type.id===h){const ne=ee[h];ne&&ne(N(I,q))}})}function A(I,J){if(J.type.id!==i)throw new Error("Invalid node provided. Only FilterExpression nodes are supported");const ee=J.firstChild;if(!ee)return{type:void 0,value:void 0};const q=J.getChild(u),ne=q?(0,B.trim)(N(I,q),'"'):void 0;return{type:ee.type.id,value:ne}}function N(I,J){return I.slice(J.from,J.to).trim().replace(/\"/g,"")}function V(I,J,ee){const q=[];z(I,J,se=>{se.type.id===i&&se.firstChild&&q.push(se.firstChild),se.type.id===h&&q.push(se)});const ne=[];return q.forEach(se=>{const oe=ee.findIndex(de=>de.type===se.type.id);if(oe!==-1){if(se.parent?.type.is(i)){const de=K[se.type.id],fe=ee.splice(oe,1)[0];ne.push(`${de}:${w(fe.value)}`)}if(se.type.is(h)){const de=ee.splice(oe,1)[0];ne.push(de.value)}}}),ee.forEach(se=>{se.type===h?ne.push(se.value):ne.push(`${K[se.type]}:${w(se.value)}`)}),ne.join(" ")}function z(I,J,ee){const q=J.join(" "),se=_.configure({dialect:q}).parse(I).cursor();do ee(se.node);while(se.next())}function w(I){return/\s/.test(I)?`"${I}"`:I}const H=[T.dataSource,T.nameSpace,T.label,T.group,T.rule,T.state,T.type,T.health,T.dashboard,T.plugins,T.contactPoint];var Q=(I=>(I.Ok="ok",I.Error="error",I.NoData="nodata",I.Unknown="unknown",I))(Q||{});function Z(I){const J={labels:[],freeFormWords:[],dataSourceNames:[]},ee={[r]:q=>J.dataSourceNames.push(q),[o]:q=>J.namespace=q,[g]:q=>J.groupName=q,[f]:q=>J.ruleName=q,[l]:q=>J.labels.push(q),[p]:q=>J.ruleState=X(q),[c]:q=>(0,a.nf)(q)?J.ruleType=q:void 0,[x]:q=>J.ruleHealth=(0,a.f6)(q),[v]:q=>J.dashboardUid=q,[m]:q=>J.plugins=q==="hide"?q:void 0,[y]:q=>J.contactPoint=q,[h]:q=>J.freeFormWords.push(q)};return L(I,H,ee),J}function Y(I,J){const ee=[];return J.dataSourceNames&&ee.push(...J.dataSourceNames.map(q=>({type:r,value:q}))),J.namespace&&ee.push({type:o,value:J.namespace}),J.groupName&&ee.push({type:g,value:J.groupName}),J.ruleName&&ee.push({type:f,value:J.ruleName}),J.ruleState&&ee.push({type:p,value:J.ruleState}),J.ruleType&&ee.push({type:c,value:J.ruleType}),J.ruleHealth&&ee.push({type:x,value:J.ruleHealth}),J.labels&&ee.push(...J.labels.map(q=>({type:l,value:q}))),J.dashboardUid&&ee.push({type:v,value:J.dashboardUid}),J.plugins&&ee.push({type:m,value:J.plugins}),J.freeFormWords&&ee.push(...J.freeFormWords.map(q=>({type:h,value:q}))),J.contactPoint&&ee.push({type:y,value:J.contactPoint}),V(I,H,ee)}function X(I){if(I==="normal")return n.cF.Inactive;if((0,n.Si)(I))return I}},5358:(te,R,e)=>{"use strict";e.d(R,{Kh:()=>v,VI:()=>p,b9:()=>f});var n=e(74848),a=e(96540),s=e(36490),i=e(29043),r=e(84266),u=e(93395),o=e(95443),l=e(52161);const g=a.createContext(void 0),f=({children:m,accessType:y,alertmanagerSourceName:h})=>{const d=s.Ny.getSearch(),E=s.Ny.partial,b=(0,u.W)(y),D=b.availableInternalDataSources.concat(b.availableExternalDataSources),C=a.useCallback(T=>{c(D,T)&&(T===l.hY?(i.A.delete(o.Oq),E({[o.DD]:void 0})):(i.A.set(o.Oq,T),E({[o.DD]:T})))},[D,E]),P=d.get(o.DD),M=i.A.get(o.Oq),O=l.hY;a.useEffect(()=>{P&&P!==M&&i.A.set(o.Oq,P)},[P,M]);const j=h??P??M??O,U=c(D,j)?j:void 0,W=(0,l.r3)(U)?.jsonData,B=U===l.hY,S=W?v(W):!1,K={selectedAlertmanager:U,hasConfigurationAPI:B||S,isGrafanaAlertmanager:B,selectedAlertmanagerConfig:W,availableAlertManagers:D,setSelectedAlertmanager:C};return(0,n.jsx)(g.Provider,{value:K,children:m})};function p(){const m=a.useContext(g);if(m===void 0)throw new Error("useAlertmanager must be used within a AlertmanagerContext");return m}function c(m,y){return m.map(d=>d.name).includes(y)}const x=[r.Oz.mimir,r.Oz.cortex,void 0];function v(m){return x.includes(m.implementation)}},11018:(te,R,e)=>{"use strict";e.d(R,{nO:()=>W,D3:()=>U,yo:()=>P,nV:()=>M,JH:()=>O,Lc:()=>C,mB:()=>b,eB:()=>D,uQ:()=>S,bO:()=>B,RW:()=>j});var n=e(65307),a=e(2543),s=e(25992),i=e(36490),r=e(74268),u=e(47938),o=e(91984),l=e(68143);function g(_){return(0,l.AI)().get("/api/annotations",{alertUID:_}).then(K=>K?.sort(f))}function f(_,K){const T=(N,V)=>N>V?-1:V>N?1:0,L=T(_.timeEnd,K.timeEnd);if(L)return L;const A=T(_.time,K.time);return A||T(_.id,K.id)}var p=e(55143),c=e(78467),x=e(77295),v=e(86017),m=e(52161),y=e(77256),h=e(36200),d=e(29609),E=e(15629);const b=(0,n.zD)("unifiedalerting/fetchPromRules",async({rulesSourceName:_,filter:K,limitAlerts:T,matcher:L,state:A,identifier:N},V)=>{const z=(0,r.U7)("unifiedalerting/fetchPromRules",c.sA,{dataSourceName:_,thunk:"unifiedalerting/fetchPromRules"});return await(0,h.$I)(z(_,K,T,L,A,N))}),D=(0,n.zD)("unifiedalerting/fetchRulerRules",async({rulesSourceName:_,filter:K},{dispatch:T,getState:L})=>{const{data:A}=await T(p.L.endpoints.discoverDsFeatures.initiate({rulesSourceName:_}));if(!A?.rulerConfig)return null;const N=(0,r.Ke)("unifiedalerting/fetchRulerRules",x.iy,{dataSourceName:_,thunk:"unifiedalerting/fetchRulerRules"});return await(0,h.$I)(N(A.rulerConfig,K))});function C({rulesSourceName:_,identifier:K,filter:T,limitAlerts:L,matcher:A,state:N}){return async V=>{const{data:z}=await V(p.L.endpoints.discoverDsFeatures.initiate({rulesSourceName:_}));await Promise.all([V(b({rulesSourceName:_,identifier:K,filter:T,limitAlerts:L,matcher:A,state:N})),z?.rulerConfig?V(D({rulesSourceName:_})):Promise.resolve()])}}function P(_=!1,K={}){return async(T,L)=>{const A=performance.now();await Promise.allSettled((0,m.gR)().map(async N=>{const{data:V}=await T(p.L.endpoints.discoverDsFeatures.initiate({rulesSourceName:N})),{promRules:z,rulerRules:w}=L().unifiedAlerting;if(!V)return;const H=_||!z[N]?.loading,Q=(_||!w[N]?.loading)&&!!V?.rulerConfig;await Promise.allSettled([H&&T(b({rulesSourceName:N,...K})),Q&&T(D({rulesSourceName:N}))])})),(0,s.l$)("unifiedalerting/fetchAllPromAndRulerRulesAction",{loadTimeMs:performance.now()-A})}}function M(_=!1,K={}){return async(T,L)=>{const{promRules:A}=L().unifiedAlerting;(0,m.gR)().map(N=>{(_||!A[N]?.loading)&&T(b({rulesSourceName:N,...K}))})}}const O=(0,n.zD)("unifiedalerting/fetchGrafanaAnnotations",_=>(0,h.$I)(g(_))),j=(0,n.zD)("unifiedalerting/updateAMConfig",({alertManagerSourceName:_,oldConfig:K,newConfig:T,successMessage:L,redirectPath:A,redirectSearch:N},V)=>(0,h.v5)((0,h.$I)((async()=>{const z=await V.dispatch(o.m.endpoints.getAlertmanagerConfiguration.initiate(_,{forceRefetch:!0})).unwrap(),w=(0,a.isEmpty)(z.alertmanager_config)&&(0,a.isEmpty)(z.template_files),H=JSON.stringify(z)!==JSON.stringify(K);if(!w&&H)throw new Error("A newer Alertmanager configuration is available. Please reload the page and try again to not overwrite recent changes.");if(await(0,u.vk)(_,(0,v.MZ)(T)),V.dispatch(o.m.util.invalidateTags(["AlertmanagerConfiguration","ContactPoint","ContactPointsStatus","Receiver"])),A){const Q=new URLSearchParams(N??"");i.Ny.push((0,y.nL)(A,_,Q))}})()),{successMessage:L})),U=(0,n.zD)("unifiedalerting/fetchAlertGroups",_=>(0,h.$I)((0,u.f4)(_))),W=(0,n.zD)("unifiedalerting/deleteAlertManagerConfig",async(_,K)=>(0,h.v5)((0,h.$I)((async()=>{await(0,u.nd)(_),await K.dispatch(o.m.util.invalidateTags(["AlertmanagerConfiguration"]))})()),{errorMessage:"Failed to reset Alertmanager configuration",successMessage:"Alertmanager configuration reset."})),B=(0,n.zD)("unifiedalerting/testReceivers",({alertManagerSourceName:_,receivers:K,alert:T})=>(0,h.v5)((0,h.$I)((0,u.By)(_,K,T)),{errorMessage:"Failed to send test alert.",successMessage:"Test alert sent."})),S=(_,K)=>_.filter(T=>{const{forDuration:L}=(0,d.jg)(T,K),A=L?(0,E.P8)(L):null,N=(0,E.P8)(K);return A?A!==0&&A<N:!1})},18771:(te,R,e)=>{"use strict";e.d(R,{H:()=>a});var n=e(22803);const a=s=>(0,n.css)({float:"none",display:"flex",justifyContent:"flex-start",margin:s.spacing(2,0)})},2869:(te,R,e)=>{"use strict";e.d(R,{W:()=>n});var n=(a=>(a.Incident="grafana-incident-app",a.OnCall="grafana-oncall-app",a.Irm="grafana-irm-app",a.MachineLearning="grafana-ml-app",a.Labels="grafana-labels-app",a.Slo="grafana-slo-app",a))(n||{})},67817:(te,R,e)=>{"use strict";e.d(R,{Z:()=>n});var n=(a=>(a.grafana="grafana-alerting",a.grafanaRecording="grafana-recording",a.cloudAlerting="cloud-alerting",a.cloudRecording="cloud-recording",a))(n||{})},72649:(te,R,e)=>{"use strict";e.d(R,{y:()=>n});var n=(a=>(a.seconds="s",a.minutes="m",a.hours="h",a.days="d",a.weeks="w",a))(n||{})},54:(te,R,e)=>{"use strict";e.d(R,{C0:()=>v,HL:()=>u,Q9:()=>m,VQ:()=>o,Wd:()=>x,jy:()=>p,lV:()=>c,nU:()=>l,q0:()=>y});var n=e(65642),a=e(15130),s=e(11257),i=e(52161);function r(h){return(0,i.z2)(h)?"grafana":"external"}const u={read:{grafana:s.w.AlertingInstanceRead,external:s.w.AlertingInstancesExternalRead},create:{grafana:s.w.AlertingInstanceCreate,external:s.w.AlertingInstancesExternalWrite},update:{grafana:s.w.AlertingInstanceUpdate,external:s.w.AlertingInstancesExternalWrite},delete:{grafana:s.w.AlertingInstanceUpdate,external:s.w.AlertingInstancesExternalWrite}},o={read:{grafana:s.w.AlertingNotificationsRead,external:s.w.AlertingNotificationsExternalRead},create:{grafana:s.w.AlertingNotificationsWrite,external:s.w.AlertingNotificationsExternalWrite},update:{grafana:s.w.AlertingNotificationsWrite,external:s.w.AlertingNotificationsExternalWrite},delete:{grafana:s.w.AlertingNotificationsWrite,external:s.w.AlertingNotificationsExternalWrite}},l={read:{grafana:s.w.AlertingSilenceRead,external:s.w.AlertingInstanceRead},create:{grafana:s.w.AlertingSilenceCreate,external:s.w.AlertingInstancesExternalWrite},update:{grafana:s.w.AlertingSilenceUpdate,external:s.w.AlertingInstancesExternalWrite}},g={read:s.w.AlertingProvisioningRead,readSecrets:s.w.AlertingProvisioningReadSecrets,write:s.w.AlertingProvisioningWrite},f={read:{grafana:s.w.AlertingRuleRead,external:s.w.AlertingRuleExternalRead},create:{grafana:s.w.AlertingRuleCreate,external:s.w.AlertingRuleExternalWrite},update:{grafana:s.w.AlertingRuleUpdate,external:s.w.AlertingRuleExternalWrite},delete:{grafana:s.w.AlertingRuleDelete,external:s.w.AlertingRuleExternalWrite}};function p(h){const d=r(h);return{read:u.read[d],create:u.create[d],update:u.update[d],delete:u.delete[d]}}function c(h){const d=r(h);return{read:o.read[d],create:o.create[d],update:o.update[d],delete:o.delete[d],provisioning:g}}function x(h){const d=r(h);return{read:f.read[d],create:f.create[d],update:f.update[d],delete:f.delete[d]}}function v(h){return()=>a.TP.evaluatePermission(h)}function m(){return{canCreateGrafanaRules:a.TP.hasPermission(s.w.FoldersRead)&&a.TP.hasPermission(f.create.grafana),canCreateCloudRules:a.TP.hasPermission(s.w.DataSourcesRead)&&a.TP.hasPermission(f.create.external),canEditRules:h=>a.TP.hasPermission(x(h).update)}}function y(){const{unifiedAlertingEnabled:h}=(0,n.zj)(),d=a.TP.hasPermission(x(i.hY).read),E=a.TP.hasPermission(x(i.hY).update);return h&&d&&E}},86017:(te,R,e)=>{"use strict";e.d(R,{$P:()=>W,$m:()=>f,Av:()=>E,Dm:()=>O,EU:()=>b,LF:()=>M,MN:()=>c,MU:()=>v,MZ:()=>l,NL:()=>d,UL:()=>U,VE:()=>D,Wc:()=>m,_n:()=>g,mP:()=>B,uH:()=>j,xH:()=>h});var n=e(2543),a=e.n(n),s=e(84266),i=e(182),r=e(52161),u=e(39659),o=e(63895);function l(S){return S.alertmanager_config.receivers||(S.alertmanager_config.receivers=[{name:"default "}]),S.alertmanager_config.route||(S.alertmanager_config.route={receiver:S.alertmanager_config.receivers[0].name}),S.template_files||(S.template_files={}),S}function g(S,_){return{..._,mute_time_intervals:_.mute_time_intervals?.filter(T=>T!==S)??[],active_time_intervals:_.active_time_intervals?.filter(T=>T!==S)??[],routes:_.routes?.map(T=>g(S,T))}}function f(S,_,K){return{...K,mute_time_intervals:K.mute_time_intervals?.map(T=>T===_?S:T),active_time_intervals:K.active_time_intervals?.map(T=>T===_?S:T),routes:K.routes?.map(T=>f(S,_,T))}}function p(S){return S.map(([_,K,T])=>[_,K,unquoteWithUnescape(T)])}function c(S){return S.isEqual?S.isRegex?s.ho.regex:s.ho.equal:S.isRegex?s.ho.notRegex:s.ho.notEqual}function x(S){switch(S){case s.ho.equal:return{isEqual:!0,isRegex:!1};case s.ho.notEqual:return{isEqual:!1,isRegex:!1};case s.ho.regex:return{isEqual:!0,isRegex:!0};case s.ho.notRegex:return{isEqual:!1,isRegex:!0}}}function v(S){return{name:S.name,value:S.value,operator:c(S)}}function m(S){return{name:S.name,value:S.value,...x(S.operator)}}function y(S){return`{ ${S.map(v).reduce((T,L)=>{const A=`${L.name}${L.operator}"${L.value}"`;return T?`${T}, ${A}`:A},"")} }`}const h=[{label:s.ho.equal,description:"Equals",value:s.ho.equal},{label:s.ho.notEqual,description:"Does not equal",value:s.ho.notEqual},{label:s.ho.regex,description:"Matches regex",value:s.ho.regex},{label:s.ho.notRegex,description:"Does not match regex",value:s.ho.notRegex}];function d(S){const _=c(S);return[S.name,_,S.value]}function E(S,_){const K=(0,u.Dd)(S),T=_.map(d);return(0,o.ry)(T,K)}function b(...S){const _=S.map(o.Zc).flat(),K=(0,n.uniqWith)(_,n.isEqual);return y(K)}function D(S){return S===r.hY?"default":"unquote"}function C(){return getAllDataSources().filter(S=>S.type===DataSourceType.Alertmanager)}function P(S){return C().find(_=>S===_.uid)}function M(S){const{times:_,weekdays:K,days_of_month:T,months:L,years:A,location:N}=S,V=O(_,N),z=j(K),w=U(T),H=W(L),Q=B(A);return[V,z,w,H,Q].join(", ")}function O(S,_){return"Times: "+(S?S?.map(({start_time:K,end_time:T})=>`${K} - ${T} [${_??"UTC"}]`).join(" and "):"All")}function j(S){return"Weekdays: "+(S?.map(_=>{if(_.includes(":"))return _.split(":").map(K=>{const T=K.slice(0,3);return T[0].toLocaleUpperCase()+T.slice(1)}).join("-");{const K=_.slice(0,3);return K[0].toLocaleUpperCase()+K.slice(1)}}).join(", ")??"All")}function U(S){return"Days of the month: "+(S?.join(", ")??"All")}function W(S){return"Months: "+(S?.join(", ")??"All")}function B(S){return"Years: "+(S?.join(", ")??"All")}},42824:(te,R,e)=>{"use strict";e.d(R,{DY:()=>C,Mk:()=>h,QM:()=>v,Rg:()=>f,SJ:()=>y,YE:()=>m,Yl:()=>c,gY:()=>d,hH:()=>b,ie:()=>E});var n=e(84266),a=e(86017),s=e(52161),i=e(63895),r=e(67923),u=e(15629);const o=(P,M)=>Object.entries(P??{}).reduce((O,[j,U])=>[...O,{name:j,value:U,operator:M?n.ho.regex:n.ho.equal}],[]),l=P=>P.value,g=P=>(P??[]).map(l),f={name:"",value:"",operator:n.ho.equal},p=["grafana_folder","alertname"],c=[{label:"grafana_folder",value:"grafana_folder",isFixed:!0},{label:"alertname",value:"alertname",isFixed:!0},{label:"Disable (...)",value:"..."}],x={id:"",overrideGrouping:!1,groupBy:p,object_matchers:[],routes:[],continue:!1,receiver:"",overrideTimings:!1,groupWaitValue:"",groupIntervalValue:"",repeatIntervalValue:"",muteTimeIntervals:[],activeTimeIntervals:[]};function v(P,M="0"){const O=(0,r.KR)(P),j=P.routes??[];return{id:`${M}-${O}`,...P,routes:j.map((U,W)=>v(U,`${M}-${W}`))}}const m=P=>{if(!P)return x;const M=P.id;if(Object.keys(P).length===0)return{...x,id:M};const O=[];P.routes?.forEach(W=>{const B=m(W);O.push(B)});const j=P.object_matchers?.map(W=>({name:W[0],operator:W[1],value:W[2]}))??[],U=P.matchers?.flatMap(W=>(0,i.So)(W).flatMap(a.MU)).map(({name:W,operator:B,value:S})=>({name:(0,i.Ig)(W),operator:B,value:(0,i.Ig)(S)}))??[];return{id:M,object_matchers:[...U,...j,...o(P.match,!1),...o(P.match_re,!0)],continue:P.continue??!1,receiver:P.receiver??"",overrideGrouping:Array.isArray(P.group_by)&&P.group_by.length>0,groupBy:P.group_by??void 0,overrideTimings:[P.group_wait,P.group_interval,P.repeat_interval].some(Boolean),groupWaitValue:P.group_wait??"",groupIntervalValue:P.group_interval??"",repeatIntervalValue:P.repeat_interval??"",routes:O,muteTimeIntervals:P.mute_time_intervals??[],activeTimeIntervals:P.active_time_intervals??[]}},y=(P,M,O)=>{const j=(0,r.eM)(M.id??"",O),{overrideGrouping:U,groupBy:W,overrideTimings:B,groupWaitValue:S,groupIntervalValue:_,repeatIntervalValue:K,receiver:T}=M,L=void 0,A=U?W:L,V=B&&S?S:L,w=B&&_?_:L,Q=B&&K?K:L,Z=M.object_matchers?.filter(I=>I.name&&I.operator&&I.value!==null&&I.value!==void 0).map(({name:I,operator:J,value:ee})=>[I,J,ee]),Y=M.routes?.map(I=>y(P,I,O)),X={...j??{},continue:M.continue,group_by:A,object_matchers:Z,match:void 0,match_re:void 0,group_wait:V,group_interval:w,repeat_interval:Q,routes:Y,mute_time_intervals:M.muteTimeIntervals,active_time_intervals:M.activeTimeIntervals,receiver:T};return P!==s.hY?(X.matchers=M.object_matchers?.map(i.b2),X.object_matchers=void 0):(X.object_matchers=(0,i.J$)(X),X.matchers=void 0),M.receiver&&(X.receiver=M.receiver),X},h=P=>({label:P,value:P}),d=P=>(P??[]).map(h),E=P=>P?g(P):[];function b(P){return!P||P.length===0?!0:(0,u.TN)(P)||"Invalid duration format. Must be {number}{time_unit}"}const D=P=>P.map(M=>{const[O,j,U]=M;return`${O}${j}${U}`}),C=(P,M="")=>{if(P.length===0)return!0;const O=b(P),j=b(M);if(O!==!0)return O;if(j!==!0)return j;const U=(0,u.P8)(P),W=(0,u.P8)(M);return W!==0&&U<W?"Repeat interval should be higher or equal to Group interval":!0}},75640:(te,R,e)=>{"use strict";e.d(R,{Hx:()=>r,gO:()=>u});var n=e(96540),a=e(95443),s=e(77256);function i(o){return{dashboardUID:o.find(([l])=>l===a.YH.dashboardUID)?.[1],panelId:o.find(([l])=>l===a.YH.panelID)?.[1]}}function r(o){return(0,n.useMemo)(()=>Object.entries(o||{}).filter(([l,g])=>!!g.trim()),[o])}function u(o){const l=new Map,{panelId:g,dashboardUID:f}=i(o);return f&&l.set(a.YH.dashboardUID,(0,s.JM)(f)),f&&g&&l.set(a.YH.panelID,(0,s.D2)(f,g)),l}},51740:(te,R,e)=>{"use strict";e.d(R,{U:()=>g,r:()=>l});var n=e(43173),a=e(72930);const s=(0,a.u)("basic_auth","Basic auth","Sets the `Authorization` header with the configured username and password. Password and password_file are mutually exclusive.",{element:"subform",subformOptions:[(0,a.u)("username","Username",""),(0,a.u)("password","Password",""),(0,a.u)("password_file","Password file","")]}),i=(0,a.u)("tls_config","TLS config","Configures the TLS settings.",{element:"subform",subformOptions:[(0,a.u)("ca_file","CA file","CA certificate to validate the server certificate with."),(0,a.u)("cert_file","Cert file","Certificate for client cert authentication to the server."),(0,a.u)("key_file","Key file","Key file for client cert authentication to the server."),(0,a.u)("server_name","Server name","ServerName extension to indicate the name of the server."),(0,a.u)("insecure_skip_verify","Skip verify","Disable validation of the server certificate.",{element:"checkbox"})]}),r=(0,a.u)("oauth2","OAuth2","Configures the OAuth2 settings.",{element:"subform",subformOptions:[(0,a.u)("client_id","Client ID","The OAuth2 client ID",{required:!0}),(0,a.u)("client_secret","Client secret","The OAuth2 client secret",{required:!0}),(0,a.u)("token_url","Token URL","The OAuth2 token exchange URL",{required:!0}),(0,a.u)("scopes","Scopes","Comma-separated list of scopes",{element:"string_array"}),(0,a.u)("endpoint_params","Additional parameters","",{element:"key_value_map"})]}),u=(0,a.u)("http_config","HTTP Config","Note that `basic_auth`, `bearer_token` and `bearer_token_file` options are mutually exclusive.",{element:"subform",subformOptions:[(0,a.u)("bearer_token","Bearer token","Sets the `Authorization` header with the configured bearer token."),(0,a.u)("bearer_token_file","Bearer token file","Sets the `Authorization` header with the bearer token read from the configured file."),(0,a.u)("proxy_url","Proxy URL","Optional proxy URL."),s,i,r]}),o={name:"Jira",description:"Send notifications to Jira Service Management",type:"jira",info:"",heading:"Jira settings",options:[(0,a.u)("api_url","API URL","The host to send Jira API requests to",{required:!0}),(0,a.u)("project","Project Key","The project key where issues are created",{required:!0}),(0,a.u)("summary","Summary","Issue summary template",{placeholder:'{{ template "jira.default.summary" . }}'}),(0,a.u)("description","Description","Issue description template",{placeholder:'{{ template "jira.default.description" . }}'}),(0,a.u)("labels","Labels"," Labels to be added to the issue",{element:"string_array"}),(0,a.u)("priority","Priority","Priority of the issue",{placeholder:'{{ template "jira.default.priority" . }}'}),(0,a.u)("issue_type","Issue Type","Type of the issue (e.g. Bug)",{required:!0}),(0,a.u)("reopen_transition","Reopen transition",'Name of the workflow transition to reopen an issue. The target status should not have the category "done"'),(0,a.u)("resolve_transition","Resolve transition",'Name of the workflow transition to resolve an issue. The target status must have the category "done"'),(0,a.u)("wont_fix_resolution","Won't fix resolution",'If "Reopen transition" is defined, ignore issues with that resolution'),(0,a.u)("reopen_duration","Reopen duration",'If "Reopen transition" is defined, reopen the issue when it is not older than this value (rounded down to the nearest minute)',{placeholder:"Use duration format, for example: 1.2s, 100ms"}),(0,a.u)("fields","Fields","Other issue and custom fields",{element:"key_value_map"}),u]},l=[{name:"Email",description:"Send notification over SMTP",type:"email",info:"",heading:"Email settings",options:[(0,a.u)("to","To",'The email address to send notifications to. You can enter multiple addresses using a "," separator',{required:!0}),(0,a.u)("from","From","The sender address."),(0,a.u)("smarthost","SMTP host","The SMTP host through which emails are sent."),(0,a.u)("hello","Hello","The hostname to identify to the SMTP server."),(0,a.u)("auth_username","Username","SMTP authentication information"),(0,a.u)("auth_password","Password","SMTP authentication information"),(0,a.u)("auth_secret","Secret","SMTP authentication information"),(0,a.u)("auth_identity","Identity","SMTP authentication information"),(0,a.u)("require_tls","Require TLS","The SMTP TLS requirement",{element:"checkbox"}),(0,a.u)("html","Email HTML body","The HTML body of the email notification.",{placeholder:'{{ template "email.default.html" . }}',element:"textarea"}),(0,a.u)("text","Email text body","The text body of the email notification.",{element:"textarea"}),(0,a.u)("headers","Headers","Further headers email header key/value pairs. Overrides any headers previously set by the notification implementation.",{element:"key_value_map"}),i]},{name:"PagerDuty",description:"Send notifications to PagerDuty",type:"pagerduty",info:"",heading:"PagerDuty settings",options:[(0,a.u)("routing_key","Routing key","The PagerDuty integration key (when using PagerDuty integration type `Events API v2`)"),(0,a.u)("service_key","Service key","The PagerDuty integration key (when using PagerDuty integration type `Prometheus`)."),(0,a.u)("url","URL","The URL to send API requests to"),(0,a.u)("client","Client","The client identification of the Alertmanager.",{placeholder:'{{ template "pagerduty.default.client" . }}'}),(0,a.u)("client_url","Client URL","A backlink to the sender of the notification.",{placeholder:'{{ template "pagerduty.default.clientURL" . }}'}),(0,a.u)("description","Description","A description of the incident.",{placeholder:'{{ template "pagerduty.default.description" .}}'}),(0,a.u)("severity","Severity","Severity of the incident.",{placeholder:"error"}),(0,a.u)("details","Details","A set of arbitrary key/value pairs that provide further detail about the incident.",{element:"key_value_map"}),(0,a.u)("images","Images","Images to attach to the incident.",{element:"subform_array",subformOptions:[(0,a.u)("href","URL","",{required:!0}),(0,a.u)("source","Source","",{required:!0}),(0,a.u)("alt","Alt","",{required:!0})]}),(0,a.u)("links","Links","Links to attach to the incident.",{element:"subform_array",subformOptions:[(0,a.u)("href","URL","",{required:!0}),(0,a.u)("text","Text","",{required:!0})]}),u]},{name:"Pushover",description:"Send notifications to Pushover",type:"pushover",info:"",heading:"Pushover settings",options:[(0,a.u)("user_key","User key","The recipient user\u2019s user key.",{required:!0}),(0,a.u)("token","Token","Your registered application\u2019s API token, see https://pushover.net/app",{required:!0}),(0,a.u)("title","Title","Notification title.",{placeholder:'{{ template "pushover.default.title" . }}'}),(0,a.u)("message","Message","Notification message.",{placeholder:'{{ template "pushover.default.message" . }}'}),(0,a.u)("url","URL","A supplementary URL shown alongside the message.",{placeholder:'{{ template "pushover.default.url" . }}'}),(0,a.u)("priority","Priority","Priority, see https://pushover.net/api#priority",{placeholder:'{{ if eq .Status "firing" }}2{{ else }}0{{ end }}'}),(0,a.u)("retry","Retry","How often the Pushover servers will send the same notification to the user. Must be at least 30 seconds.",{placeholder:"1m"}),(0,a.u)("expire","Expire","How long your notification will continue to be retried for, unless the user acknowledges the notification.",{placeholder:"1h"}),(0,a.u)("ttl","TTL","The number of seconds before a message expires and is deleted automatically. Examples: 10s, 5m30s, 8h.",{validationRule:"^(\\d+[s|m|h])+$|^$",element:"input"}),u]},{name:"Slack",description:"Send notifications to Slack",type:"slack",info:"",heading:"Slack settings",options:[(0,a.u)("api_url","Webhook URL","The Slack webhook URL."),(0,a.u)("channel","Channel","The #channel or @user to send notifications to.",{required:!0}),(0,a.u)("icon_emoji","Emoji icon",""),(0,a.u)("icon_url","Icon URL",""),(0,a.u)("link_names","Names link","",{element:"checkbox"}),(0,a.u)("username","Username","",{placeholder:'{{ template "slack.default.username" . }}'}),(0,a.u)("callback_id","Callback ID","",{placeholder:'{{ template "slack.default.callbackid" . }}'}),(0,a.u)("color","Color","",{placeholder:'{{ if eq .Status "firing" }}danger{{ else }}good{{ end }}'}),(0,a.u)("fallback","Fallback","",{placeholder:'{{ template "slack.default.fallback" . }}'}),(0,a.u)("footer","Footer","",{placeholder:'{{ template "slack.default.footer" . }}'}),(0,a.u)("mrkdwn_in","Mrkdwn fields","An array of field names that should be formatted by mrkdwn syntax.",{element:"string_array"}),(0,a.u)("pretext","Pre-text","",{placeholder:'{{ template "slack.default.pretext" . }}'}),(0,a.u)("short_fields","Short fields","",{element:"checkbox"}),(0,a.u)("text","Message body","",{element:"textarea",placeholder:'{{ template "slack.default.text" . }}'}),(0,a.u)("title","Title","",{placeholder:'{{ template "slack.default.title" . }}'}),(0,a.u)("title_link","Title link","",{placeholder:'{{ template "slack.default.titlelink" . }}'}),(0,a.u)("image_url","Image URL",""),(0,a.u)("thumb_url","Thumbnail URL",""),(0,a.u)("actions","Actions","",{element:"subform_array",subformOptions:[(0,a.u)("text","Text","",{required:!0}),(0,a.u)("type","Type","",{required:!0}),(0,a.u)("url","URL","Either url or name and value are mandatory."),(0,a.u)("name","Name",""),(0,a.u)("value","Value",""),(0,a.u)("confirm","Confirm","",{element:"subform",subformOptions:[(0,a.u)("text","Text","",{required:!0}),(0,a.u)("dismiss_text","Dismiss text",""),(0,a.u)("ok_text","OK text",""),(0,a.u)("title","Title","")]}),(0,a.u)("style","Style","")]}),(0,a.u)("fields","Fields","",{element:"subform_array",subformOptions:[(0,a.u)("title","Title","",{required:!0}),(0,a.u)("value","Value","",{required:!0}),(0,a.u)("short","Short","",{element:"checkbox"})]}),u]},...n.$.featureToggles?.alertingJiraIntegration?[o]:[],{name:"OpsGenie",description:"Send notifications to OpsGenie",type:"opsgenie",info:"",heading:"OpsGenie settings",options:[(0,a.u)("api_key","API key","The API key to use when talking to the OpsGenie API."),(0,a.u)("api_url","API URL","The host to send OpsGenie API requests to."),(0,a.u)("message","Message","Alert text limited to 130 characters."),(0,a.u)("description","Description","A description of the incident.",{placeholder:'{{ template "opsgenie.default.description" . }}'}),(0,a.u)("source","Source","A backlink to the sender of the notification.",{placeholder:'{{ template "opsgenie.default.source" . }}'}),(0,a.u)("details","Details","A set of arbitrary key/value pairs that provide further detail about the incident.",{element:"key_value_map"}),(0,a.u)("tags","Tags","Comma separated list of tags attached to the notifications."),(0,a.u)("note","Note","Additional alert note."),(0,a.u)("priority","Priority","Priority level of alert. Possible values are P1, P2, P3, P4, and P5."),(0,a.u)("responders","Responders","List of responders responsible for notifications.",{element:"subform_array",subformOptions:[(0,a.u)("type","Type",'"team", "user", "escalation" or schedule".',{required:!0}),(0,a.u)("id","ID","Exactly one of these fields should be defined."),(0,a.u)("name","Name","Exactly one of these fields should be defined."),(0,a.u)("username","Username","Exactly one of these fields should be defined.")]}),u]},{name:"VictorOps",description:"Send notifications to VictorOps",type:"victorops",info:"",heading:"VictorOps settings",options:[(0,a.u)("api_key","API key","The API key to use when talking to the VictorOps API."),(0,a.u)("api_url","API URL","The VictorOps API URL."),(0,a.u)("routing_key","Routing key","A key used to map the alert to a team.",{required:!0}),(0,a.u)("message_type","Message type","Describes the behavior of the alert (CRITICAL, WARNING, INFO)."),(0,a.u)("entity_display_name","Entity display name","Contains summary of the alerted problem.",{placeholder:'{{ template "victorops.default.entity_display_name" . }}'}),(0,a.u)("state_message","State message","Contains long explanation of the alerted problem.",{placeholder:'{{ template "victorops.default.state_message" . }}'}),(0,a.u)("monitoring_tool","Monitoring tool","The monitoring tool the state message is from.",{placeholder:'{{ template "victorops.default.monitoring_tool" . }}'}),u]},{name:"Webhook",description:"Send notifications to a webhook",type:"webhook",info:"",heading:"Webhook settings",options:[(0,a.u)("url","URL","The endpoint to send HTTP POST requests to.",{required:!0}),(0,a.u)("max_alerts","Max alerts","The maximum number of alerts to include in a single webhook message. Alerts above this threshold are truncated. When leaving this at its default value of 0, all alerts are included.",{placeholder:"0",inputType:"number",validationRule:"(^\\d+$|^$)",setValueAs:f=>{const p=Number(f);return Number.isFinite(p)?p:0}}),(0,a.u)("timeout","Timeout","The maximum time to wait for a webhook request to complete, before failing the request and allowing it to be retried. The default value of 0s indicates that no timeout should be applied. NOTE: This will have no effect if set higher than the group_interval.",{placeholder:"Use duration format, for example: 1.2s, 100ms"}),u]},{name:"Discord",description:"Sends notifications to Discord",type:"discord",info:"",heading:"Discord settings",options:[(0,a.u)("title","Title","Templated title of the message",{placeholder:'{{ template "discord.default.title" . }}'}),(0,a.u)("message","Message Content","Mention a group using @ or a user using <@ID> when notifying in a channel",{placeholder:'{{ template "discord.default.message" . }}'}),(0,a.u)("webhook_url","Webhook URL","",{placeholder:"Discord webhook URL",required:!0}),u]},{name:"Cisco Webex Teams",description:"Sends notifications to Cisco Webex Teams",type:"webex",info:"",heading:"Cisco Webex Teams settings",options:[(0,a.u)("api_url","API URL","The Webex Teams API URL",{placeholder:"https://webexapis.com/v1/messages"}),(0,a.u)("room_id","Room ID","ID of the Webex Teams room where to send the messages",{required:!0}),(0,a.u)("message","Message","Message template",{placeholder:'{{ template "webex.default.message" .}}'}),{...u,required:!0}]},{name:"Telegram",description:"Sends notifications to Telegram",type:"telegram",info:"",heading:"Telegram settings",options:[(0,a.u)("api_url","API URL","The Telegram API URL",{placeholder:"https://api.telegram.org"}),(0,a.u)("bot_token","Bot token","Telegram bot token",{required:!0}),(0,a.u)("chat_id","Chat ID","ID of the chat where to send the messages",{required:!0,setValueAs:f=>typeof f=="string"?parseInt(f,10):f}),(0,a.u)("message","Message","Message template",{placeholder:'{{ template "webex.default.message" .}}'}),(0,a.u)("disable_notifications","Disable notifications","Disable telegram notifications",{element:"checkbox"}),(0,a.u)("parse_mode","Parse mode","Parse mode for telegram message",{element:"select",defaultValue:{label:"None",value:""},selectOptions:[{label:"None",value:""},{label:"MarkdownV2",value:"MarkdownV2"},{label:"Markdown",value:"Markdown"},{label:"HTML",value:"HTML"}]}),u]},{name:"Amazon SNS",description:"Sends notifications to Amazon SNS",type:"sns",info:"",heading:"Amazon SNS settings",options:[(0,a.u)("api_url","API URL","The Amazon SNS API URL"),(0,a.u)("sigv4","SigV4 authentication","Configures AWS's Signature Verification 4 signing process to sign requests",{element:"subform",subformOptions:[(0,a.u)("region","Region","The AWS region. If blank, the region from the default credentials chain is used"),(0,a.u)("access_key","Access key",'The AWS API access_key. If blank the environment variable "AWS_ACCESS_KEY_ID" is used'),(0,a.u)("secret_key","Secret key",'The AWS API secret_key. If blank the environment variable "AWS_ACCESS_SECRET_ID" is used'),(0,a.u)("profile","Profile","Named AWS profile used to authenticate"),(0,a.u)("role_arn","Role ARN","AWS Role ARN, an alternative to using AWS API keys")]}),(0,a.u)("topic_arn","SNS topic ARN","If you don't specify this value, you must specify a value for the phone_number or target_arn. If you are using a FIFO SNS topic you should set a message group interval longer than 5 minutes to prevent messages with the same group key being deduplicated by the SNS default deduplication window"),(0,a.u)("phone_number","Phone number","Phone number if message is delivered via SMS in E.164 format. If you don't specify this value, you must specify a value for the topic_arn or target_arn"),(0,a.u)("target_arn","Target ARN","The  mobile platform endpoint ARN if message is delivered via mobile notifications. If you don't specify this value, you must specify a value for the topic_arn or phone_number"),(0,a.u)("subject","Subject","Subject line when the message is delivered",{placeholder:'{{ template "sns.default.subject" .}}'}),(0,a.u)("message","Message","The message content of the SNS notification",{placeholder:'{{ template "sns.default.message" .}}'}),(0,a.u)("attributes","Attributes","SNS message attributes",{element:"key_value_map"}),u]},{name:"WeChat",description:"Sends notifications to WeChat",type:"wechat",info:"",heading:"WeChat settings",options:[(0,a.u)("api_url","API URL","The WeChat API URL"),(0,a.u)("api_secret","API Secret","The API key to use when talking to the WeChat API"),(0,a.u)("corp_id","Corp ID","The corp id for authentication"),(0,a.u)("message","Message","API request data as defined by the WeChat API",{placeholder:'{{ template "wechat.default.message" . }}'}),(0,a.u)("message_type","Message type","Type of the message type",{element:"select",defaultValue:{label:"Text",value:"text"},selectOptions:[{label:"Text",value:"text"},{label:"Markdown",value:"markdown"}]}),(0,a.u)("agent_id","Agent ID","",{placeholder:'{{ template "wechat.default.agent_id" . }}'}),(0,a.u)("to_user","to user","",{placeholder:'{{ template "wechat.default.to_user" . }}'}),(0,a.u)("to_party","to party","",{placeholder:'{{ template "wechat.default.to_party" . }}'}),(0,a.u)("to_tag","to tag","",{placeholder:'{{ template "wechat.default.to_tag" . }}'})]},{name:"Microsoft Teams",description:"Sends notifications to Microsoft Teams",type:"msteams",info:"",heading:"Microsoft Teams settings",options:[(0,a.u)("webhook_url","Webhook URL","The incoming webhook URL."),(0,a.u)("title","Title","Message title template.",{placeholder:'{{ template "teams.default.title" . }}'}),(0,a.u)("text","Text","Message body template.",{placeholder:'{{ template "teams.default.text" . }}'})]}],g=[(0,a.u)("smtp_from","SMTP from","The default SMTP From header field."),(0,a.u)("smtp_smarthost","SMTP smarthost","The default SMTP smarthost used for sending emails, including port number. Port number usually is 25, or 587 for SMTP over TLS (sometimes referred to as STARTTLS). Example: smtp.example.org:587"),(0,a.u)("smtp_hello","SMTP hello","The default hostname to identify to the SMTP server.",{placeholder:"localhost"}),(0,a.u)("smtp_auth_username","SMTP auth username","SMTP Auth using CRAM-MD5, LOGIN and PLAIN. If empty, Alertmanager doesn't authenticate to the SMTP server."),(0,a.u)("smtp_auth_password","SMTP auth password","SMTP Auth using LOGIN and PLAIN."),(0,a.u)("smtp_auth_identity","SMTP auth identity","SMTP Auth using PLAIN."),(0,a.u)("smtp_auth_secret","SMTP auth secret","SMTP Auth using CRAM-MD5."),(0,a.u)("smtp_require_tls","SMTP require TLS","The default SMTP TLS requirement. Note that Go does not support unencrypted connections to remote SMTP endpoints.",{element:"checkbox"}),(0,a.u)("slack_api_url","Slack API URL",""),(0,a.u)("victorops_api_key","VictorOps API key",""),(0,a.u)("victorops_api_url","VictorOps API URL","",{placeholder:"https://alert.victorops.com/integrations/generic/20131114/alert/"}),(0,a.u)("pagerduty_url","PagerDuty URL","https://events.pagerduty.com/v2/enqueue"),(0,a.u)("opsgenie_api_key","OpsGenie API key",""),(0,a.u)("opsgenie_api_url","OpsGenie API URL","",{placeholder:"https://api.opsgenie.com/"}),(0,a.u)("wechat_api_url","WeChat API URL","",{placeholder:"https://qyapi.weixin.qq.com/cgi-bin/"}),(0,a.u)("wechat_api_secret","WeChat API secret",""),(0,a.u)("wechat_api_corp_id","WeChat API corp id",""),(0,a.u)("webex_api_url","Cisco Webex Teams API URL",""),(0,a.u)("telegram_api_url","The Telegram API URL",""),u,(0,a.u)("resolve_timeout","Resolve timeout","ResolveTimeout is the default value used by alertmanager if the alert does not include EndsAt, after this time passes it can declare the alert as resolved if it has not been updated. This has no impact on alerts from Prometheus, as they always include EndsAt.",{placeholder:"5m"})]},182:(te,R,e)=>{"use strict";e.d(R,{BO:()=>l,Wx:()=>o,ZP:()=>u,k7:()=>i,qf:()=>r});var n=e(43173),a=e(2869),s=e(15629);function i(){return Object.values(n.$.datasources)}function r(g){if(!(0,s.TN)(n.$.unifiedAlerting.minInterval))return{globalLimit:0,exceedsLimit:!1};const f=(0,s.P8)(n.$.unifiedAlerting.minInterval);if(!g||!(0,s.TN)(g))return{globalLimit:f,exceedsLimit:!1};const p=(0,s.P8)(g),c=f>p&&p>0;return{globalLimit:f,exceedsLimit:c}}function u(){return a.W.Irm in n.$.apps}function o(){return u()?a.W.Irm:a.W.Incident}function l(){return u()?a.W.Irm:a.W.OnCall}},95443:(te,R,e)=>{"use strict";e.d(R,{DD:()=>s,H8:()=>x,HH:()=>a,J3:()=>c,Oq:()=>i,U3:()=>u,UU:()=>n,YH:()=>p,cB:()=>o,kW:()=>m,kl:()=>v,wG:()=>r});const n="ruler not supported",a=3e4,s="alertmanager",i="alerting-alertmanager",r=2e4,u=2e4,o=2e4,l="timeseries",g="table",f="stat";var p=(y=>(y.description="description",y.summary="summary",y.runbookURL="runbook_url",y.alertId="__alertId__",y.dashboardUID="__dashboardUid__",y.panelID="__panelId__",y))(p||{});const c={description:"Description",summary:"Summary",runbook_url:"Runbook URL",__dashboardUid__:"Dashboard UID",__panelId__:"Panel ID",__alertId__:"Alert ID"},x={description:"Description of what the alert rule does.",summary:"Short summary of what happened and why.",runbook_url:"Webpage where you keep your runbook for the alert.",__dashboardUid__:"",__panelId__:"",__alertId__:""},v=[{key:"summary",value:""},{key:"description",value:""},{key:"runbook_url",value:""}],m="__alert_rule_uid__"},52161:(te,R,e)=>{"use strict";e.d(R,{$e:()=>X,AL:()=>H,EV:()=>V,Eb:()=>w,Gb:()=>Oe,Iz:()=>ne,TG:()=>A,Zw:()=>J,at:()=>le,bD:()=>U,bS:()=>ce,bt:()=>ae,cl:()=>ve,cy:()=>K,gR:()=>L,hP:()=>de,hY:()=>h,iV:()=>B,k5:()=>se,lS:()=>N,o_:()=>Re,of:()=>M,oh:()=>Y,ol:()=>b,qi:()=>D,r3:()=>I,r6:()=>E,sq:()=>T,v0:()=>z,vv:()=>d,w5:()=>q,y9:()=>oe,yc:()=>Q,z2:()=>Z});var n=e(78282),a=e(15130),s=e(66513),i=e(88114),r=e(84266),u=e(11257),o=e(86791),l=e(42581),g=e(91984),f=e(76070),p=e(17349),c=e(93395),x=e(5358),v=e(54),m=e(182),y=e(29609);const h="grafana",d="-- Grafana --",E={uid:o.l$,name:h,ruleSourceType:"grafana"};var b=(Se=>(Se.Alertmanager="alertmanager",Se.Loki="loki",Se.Prometheus="prometheus",Se.AmazonPrometheus="grafana-amazonprometheus-datasource",Se.AzurePrometheus="grafana-azureprometheus-datasource",Se))(b||{});function D(){const Se=a.TP.hasPermission(u.w.AlertingRuleExternalRead),Te=a.TP.hasPermission(u.w.AlertingRuleExternalWrite);return!Se&&!Te?[]:(0,m.k7)().filter(_e=>ve(_e.type)).filter(_e=>de(_e)).sort((_e,He)=>_e.name.localeCompare(He.name))}function C(Se){return Z(Se)?"grafana":Se.uid??Se.id}function P(Se){return D().find(Te=>Te.name===Se)}function M(Se){return D().find(Te=>Te.uid===Se)}function O(){return(0,m.k7)().filter(j).sort((Se,Te)=>Se.name.localeCompare(Te.name))}function j(Se){return Se.type==="alertmanager"}function U(Se){return Se.type==="alertmanager"}function W(){return O().filter(Se=>Se.jsonData.handleGrafanaManagedAlerts)}function B(Se){return Se.jsonData.handleGrafanaManagedAlerts===!0}const S={name:h,imgUrl:l,hasConfigurationAPI:!0};function _(){return[S,...O().map(Se=>({name:Se.name,displayName:Se.name,imgUrl:Se.meta.info.logos.small,meta:Se.meta}))]}function K(Se){const Te=(0,c.W)(Se),_e=Te.availableExternalDataSources.filter(Ge=>Ge.handleGrafanaManagedAlerts),He=Te.availableInternalDataSources,{currentData:tt}=g.m.endpoints.getGrafanaAlertingConfigurationStatus.useQuery();switch(tt?.alertmanagersChoice){case r.nA.Internal:return He;case r.nA.External:return _e;default:return[...He,..._e]}}function T(Se){const Te=[],_e=[],He={instance:v.HL.read,notification:v.VQ.read,silence:v.nU.read};if([...Object.values(He).flatMap(Ge=>Ge.grafana),...f.w6,...i.Im,...p.X,...s.GK].some(Ge=>a.TP.hasPermission(Ge))&&Te.push(S),a.TP.hasPermission(He[Se].external)){const Ge=O().map(je=>({name:je.name,displayName:je.name,imgUrl:je.meta.info.logos.small,meta:je.meta,hasConfigurationAPI:(0,x.Kh)(je.jsonData),handleGrafanaManagedAlerts:je.jsonData.handleGrafanaManagedAlerts}));_e.push(...Ge)}return{availableInternalDataSources:Te,availableExternalDataSources:_e}}function L(){const Se=D().map(Te=>Te.name);return a.TP.hasPermission(u.w.AlertingRuleRead)&&Se.push(h),Se}function A(){return D().map(Se=>({name:Se.name,uid:Se.uid,ruleSourceType:"datasource"}))}function N(){const Se=D();return a.TP.hasPermission(u.w.AlertingRuleRead)&&Se.unshift(h),Se}function V(Se){return w(Se)?Se.name:Se}function z(Se){return w(Se)?Se.uid:h}function w(Se){return Se!==h}function H(Se){return Se!==h&&I(Se)?.jsonData?.implementation===r.Oz.prometheus}function Q(Se){return Se.readOnly===!0}function Z(Se){return Se===h}function Y(Se){return(0,m.k7)().find(Te=>Te.name===Se)}function X(Se){return(0,m.k7)().find(Te=>Te.uid===Se)}function I(Se){return(0,m.k7)().filter(j).find(Te=>Te.name===Se)}function J(Se){return Se===h?h:Y(Se)}function ee(Se){if(Se===h)return h;const Te=Y(Se);if(!Te)throw new Error(`Datasource "${Se}" not found`);return String(Te.id)}function q(Se){if(Se===h)return h;const Te=Y(Se);if(!Te)throw new Error(`Datasource "${Se}" not found`);return Te.uid}function ne(Se){if("uid"in Se)return Se.uid;if(Se.rulesSourceName===h)return o.l$;const Te=P(Se.rulesSourceName);if(Te)return Te.uid}function se(){return(0,n.l)().getList({alerting:!0})[0]}function oe(){const Se=(0,n.l)().getInstanceSettings("default");return Se?.meta.alerting??!1?Se:se()}function de(Se){return Se.jsonData.manageAlerts!==!1}function fe(Se){return Se.jsonData.allowAsRecordingRulesTarget!==!1}function ae(Se){return(0,y.A4)(Se)?{uid:o.l$,name:h,ruleSourceType:"grafana"}:{uid:q(Se.ruleSourceName),name:Se.ruleSourceName,ruleSourceType:"datasource"}}function ce(Se){return ie.find(Te=>Te===Se)!==void 0}const ie=["prometheus","grafana-amazonprometheus-datasource","grafana-azureprometheus-datasource"];function ve(Se){return le.find(Te=>Te===Se)!==void 0}const le=["loki",...ie];function Ee(Se){return Se===h||ve(Se)}const Re=[h,...le];function Oe(Se){return ce(Se.type)&&fe(Se)}},85835:(te,R,e)=>{"use strict";e.d(R,{h:()=>i});var n=e(2543),a=e.n(n),s=e(61371);function i(r,u,o=n.identity){const l=o(r),g=o(u),f=(0,s.G4)(l,g),p=(0,n.chain)(f).values().flatMap().filter(x=>x.op==="add"||x.op==="replace"||x.op==="move").sumBy(x=>x.endLineNumber-x.startLineNumber+1).value(),c=(0,n.chain)(f).values().flatMap().filter(x=>x.op==="remove"||x.op==="replace").sumBy(x=>x.endLineNumber-x.startLineNumber+1).value();return{added:p,removed:c}}},67598:(te,R,e)=>{"use strict";e.d(R,{HA:()=>o,Rc:()=>r,rO:()=>i});var n=e(52161),a=e(29609);function s(l){if(a.p.grafana.rule(l.rulerRule)&&(0,n.z2)(l.namespace.rulesSource))return{namespace:{uid:l.rulerRule.grafana_alert.namespace_uid},groupName:l.group.name,groupOrigin:"grafana"};const g=(0,n.EV)(l.namespace.rulesSource);return{rulesSource:{uid:(0,n.w5)(g),name:g,ruleSourceType:"datasource"},namespace:{name:l.namespace.name},groupName:l.group.name,groupOrigin:"datasource"}}function i(l){return l.groupOrigin==="grafana"?n.hY:l.rulesSource.name}function r(l){return{dataSourceName:i(l),namespaceName:"uid"in l.namespace?l.namespace.uid:l.namespace.name,groupName:l.groupName}}function u(l){return{rulesSource:{ruleSourceType:"datasource",name:l.ruleSourceName,uid:(0,n.w5)(l.ruleSourceName)},namespace:{name:l.namespace},groupName:l.groupName,groupOrigin:"datasource"}}const o={fromCombinedRule:s,fromRuleIdentifier:u}},22628:(te,R,e)=>{"use strict";e.d(R,{DM:()=>i,T:()=>s,a3:()=>n,rh:()=>a});const n="grafana.com/provenance",a="none";var s=(r=>(r.Provenance="grafana.com/provenance",r.InUseRoutes="grafana.com/inUse/routes",r.InUseRules="grafana.com/inUse/rules",r.AccessWrite="grafana.com/access/canWrite",r.AccessAdmin="grafana.com/access/canAdmin",r.AccessDelete="grafana.com/access/canDelete",r))(s||{});const i="user-defined"},33998:(te,R,e)=>{"use strict";e.d(R,{LQ:()=>l,g2:()=>u,j2:()=>g,jX:()=>f});var n=e(2543),a=e.n(n),s=e(92745),i=e(68143),r=e(77256);const u="alerting.notifications.conflict",o="alerting.notifications.routes.conflictingMatchers";function l(p){const c=(0,r.E2)(p);return c?{[u]:g(c),[o]:(0,s.t)("alerting.policies.update-errors.routes.conflictingMatchers","Cannot add or update route: matchers conflict with an external routing tree if we merged matchers {{-matchers}}. This would make the route unreachable.",{matchers:p.data.details?.causes?.map(v=>v.message).join(", ")??(0,s.t)("alerting.policies.update-errors.routes.unknownMatchers","<unknown matchers>")})}[c]:p.data.message}function g(p){return{[u]:(0,s.t)("alerting.policies.update-errors.conflict","The notification policy tree has been updated by another user.")}[p]}function f(p){return(0,i.NF)(p)&&(0,n.get)(p.data,"kind")==="Status"&&(0,n.get)(p.data,"status")==="Failure"}},56476:(te,R,e)=>{"use strict";e.d(R,{Au:()=>o,O:()=>f,Uo:()=>i,dM:()=>s,gw:()=>u,jw:()=>l,zl:()=>g});var n=e(52161),a=e(22628);const s=p=>p===n.hY,i=p=>{const c=u(p,a.T.Provenance);return!!(c&&c!==a.rh)},r="grafana.com/access/",u=(p,c)=>p.metadata?.annotations?.[c],o=p=>u(p,a.T.AccessWrite)==="true",l=p=>u(p,a.T.AccessAdmin)==="true",g=p=>u(p,a.T.AccessDelete)==="true",f=p=>p.replaceAll(/\\/g,"\\\\").replaceAll(/\=/g,"\\=").replaceAll(/,/g,"\\,")},39659:(te,R,e)=>{"use strict";e.d(R,{Dd:()=>i,F2:()=>g,M4:()=>s,lL:()=>o,rm:()=>l,w0:()=>f,x4:()=>u,zm:()=>r});var n=e(2543),a=e.n(n);function s(p){return Object.entries(p).map(([c,x])=>`${c}=${x}`).sort()}function i(p){return Object.entries(p)}function r(p){const c={};return p.forEach(x=>{c[x[0]]=x[1]}),c}function u(p){const c={};return p.forEach(x=>{x.key&&(c[x.key]=x.value)}),c}const o="__grafana_origin";function l(p){return(0,n.isEmpty)(p)?0:Object.keys(p).filter(c=>!g(c)).length}function g(p){return p.startsWith("__")&&p.endsWith("__")||p===o}const f=([p,c])=>g(p)},63895:(te,R,e)=>{"use strict";e.d(R,{Ig:()=>b,J$:()=>v,J9:()=>x,S6:()=>f,So:()=>l,Zc:()=>p,b2:()=>E,ou:()=>c,qR:()=>o,ry:()=>O,t8:()=>D,yk:()=>d});var n=e(2543),a=e.n(n),s=e(38388),i=e(84266),r=e(39659);const u=[i.ho.regex,i.ho.notRegex,i.ho.notEqual,i.ho.equal];function o(B){if(B.startsWith("{")&&B.endsWith("}"))throw new Error("this function does not support PromQL-style matcher syntax, call parsePromQLStyleMatcher() instead");const S=u.map(A=>[A,B.indexOf(A)]).filter(([A,N])=>N>-1).sort((A,N)=>A[1]-N[1]);if(!S.length)throw new Error(`Invalid matcher: ${B}`);const[_,K]=S[0],T=B.slice(0,K).trim(),L=B.slice(K+_.length);if(!T)throw new Error(`Invalid matcher: ${B}`);return{name:T,value:L,isRegex:_===i.ho.regex||_===i.ho.notRegex,isEqual:_===i.ho.equal||_===i.ho.regex}}function l(B){return C(B)?g(B):[o(B)]}function g(B){if(!C(B))throw new Error("not a PromQL style matcher");return f(B)}function f(B){const S=/,(?=(?:[^"]*"[^"]*")*[^"]*$)/,_=B.replace(/^\{/,"").replace(/\}$/,"").trim().split(S);return(0,n.compact)(_).flatMap(o).map(K=>({...K,name:b(K.name),value:b(K.value)}))}function p(B){try{return f(B)}catch{return[]}}function c(B){return(0,n.chain)(B).map(S=>S.trim()).compact().flatMap(p).uniqBy("name").value()}const x=B=>{const S=Object.entries(B).filter(([K])=>!(0,r.F2)(K)),_=new URLSearchParams;return S.forEach(([K,T])=>_.append("matcher",`${K}=${T}`)),_},v=B=>{let S=[];return B.matchers&&B.matchers.forEach(_=>{const K=l(_).map(P);S=S.concat(K)}),B.object_matchers&&S.push(...B.object_matchers),B.match_re&&Object.entries(B.match_re).forEach(([_,K])=>{S.push([_,i.ho.regex,K])}),B.match&&Object.entries(B.match).forEach(([_,K])=>{S.push([_,i.ho.equal,K])}),S};function m(B){return`"${B.replace(/[\\"]/g,_=>`\\${_}`)}"`}const y=/[\{\}\!\=\~\,\\\"\'\`\s]+/;function h(B){return y.test(B)?m(B):B}function d(B){return h(b(B))}const E=({name:B,operator:S,value:_})=>{const K=h(B),T=m(_);return`${K}${S}${T}`};function b(B){return/^"(.*)"$/.test(B)?B.replace(/^"(.*)"$/,"$1").replace(/\\"/g,'"').replace(/\\\\/g,"\\"):B}const D={default:([B,S,_])=>`${B} ${S} ${_||""}`,unquote:([B,S,_])=>{const K=b(B),T=b(_)||'""';return`${K} ${S} ${T}`}};function C(B){return B.startsWith("{")&&B.endsWith("}")}function P(B){const S=M(B);return[B.name,S,B.value]}function M(B){return B.isEqual?B.isRegex?i.ho.regex:i.ho.equal:B.isRegex?i.ho.notRegex:i.ho.notEqual}function O(B,S){for(const _ of B)if(!U(_,S))return!1;return!0}const j={[i.ho.equal]:(B,S)=>B===S,[i.ho.notEqual]:(B,S)=>B!==S,[i.ho.regex]:(B,S)=>{const _=(0,s.bQ)(`^(?:${S})$`);return new RegExp(_.cleaned,_.flags).test(B)},[i.ho.notRegex]:(B,S)=>{const _=(0,s.bQ)(`^(?:${S})$`);return!new RegExp(_.cleaned,_.flags).test(B)}};function U(B,S){const[_,K,T]=B;let L="";const A=Object.fromEntries(S)[_];A&&(L=A);const N=j[K];if(!N)throw new Error(`no such operator: ${K}`);try{return N(L,T)}catch(V){return console.warn(V),!1}}function W(B,S){const[_,K]=S,[T,L,A]=B;if(_!==T)return!1;const N=j[L];if(!N)throw new Error(`no such operator: ${L}`);return N(K,A)}},77256:(te,R,e)=>{"use strict";e.d(R,{BK:()=>T,Cp:()=>X,D2:()=>w,E2:()=>ne,ES:()=>ee,GD:()=>L,Ht:()=>W,JM:()=>z,JZ:()=>oe,KT:()=>_,NH:()=>A,NJ:()=>Q,S2:()=>j,Sl:()=>U,Yp:()=>C,bI:()=>M,bg:()=>P,i7:()=>O,i9:()=>Z,nL:()=>K,qc:()=>J,qy:()=>S,u7:()=>q,vV:()=>H,w$:()=>E,y$:()=>I});var n=e(2543),a=e.n(n),s=e(41607),i=e(92745),r=e(43173),u=e(68143),o=e(15130),l=e(47797),g=e(94646),f=e(29609),p=e(21834),c=e(24619),x=e(95443),v=e(52161),m=e(33998),y=e(63895),h=e(29442),d=e(92367);function E(de,fe,ae){const ce=(0,v.EV)(de),ie=g.UP(ce,fe);return h.PP.detailsPageLink(ce,ie,ae?{returnTo:ae}:void 0)}function b(de,fe,ae){const ce=de.rulesSource.name,ie=ruleId.fromRule(ce,de.namespace.name,de.groupName,fe);return rulesNav.detailsPageLink(ce,ie,ae?{returnTo:ae}:void 0)}function D(de){const fe=de.ruleSourceName,ae=ruleId.fromRuleWithLocation(de),ce=encodeURIComponent(ruleId.stringifyIdentifier(ae)),ie=encodeURIComponent(fe);return createRelativeUrl(`/alerting/${ie}/${ce}/view`)}function C(de,fe){const{uid:ae,type:ce}=de;return(0,d.G)("/explore",{left:JSON.stringify({datasource:de.uid,queries:[{refId:"A",datasource:{uid:ae,type:ce},expr:fe}],range:{from:"now-1h",to:"now"}})})}function P(de,fe=""){return(0,d.G)(`/alerting/notifications/receivers/${encodeURIComponent(de)}/edit`,{alertmanager:fe})}function M(de,fe=""){return(0,d.G)("/alerting/notifications",{search:de,tab:"contact_points",alertmanager:fe})}function O(de,fe=""){return(0,d.G)("/alerting/routes/mute-timing/edit",{muteName:de,alertmanager:fe})}function j(de){if((0,f.X4)(de)||(0,f.Mj)(de))return(0,d.z)(`/alerting/${encodeURIComponent(de.ruleSourceName)}/${encodeURIComponent((0,g.PH)(de.ruleName))}/find`);if((0,f.A4)(de))return(0,d.z)(`/alerting/grafana/${de.uid}/view`)}function U(de){return de.reduce((fe,{key:ae,value:ce})=>(fe[ae]=ce,fe),{})}const W=de=>{const fe=de.queryString===void 0?void 0:String(de.queryString),ae=de.alertState===void 0?void 0:String(de.alertState),ce=de.dataSource===void 0?void 0:String(de.dataSource),ie=de.ruleType===void 0?void 0:String(de.ruleType),ve=de.groupBy===void 0?void 0:String(de.groupBy).split(",");return{queryString:fe,alertState:ae,dataSource:ce,groupBy:ve,ruleType:ie}},B=de=>({queryString:de.get("queryString")??void 0,contactPoint:de.get("contactPoint")??void 0}),S=de=>{const fe=de.queryString===void 0?void 0:String(de.queryString),ae=de.silenceState===void 0?void 0:String(de.silenceState);return{queryString:fe,silenceState:ae}};function _(de){return Object.entries(de).map(([fe,ae])=>({key:fe,value:ae}))}function K(de,fe,ae){const ce=new URLSearchParams(ae);return fe&&ce.set(x.DD,fe),`${de}?${ce.toString()}`}function T(de,fe){const ae=new URLSearchParams;return ae.append("alertmanager",de),(0,y.J9)(fe).forEach((ie,ve)=>ae.append(ve,ie)),(0,d.G)("/alerting/silence/new",ae)}function L(de){return(0,d.G)(`/datasources/edit/${de}`)}function A(de){return(0,d.G)(`/dashboards/f/${de}`)}function N(de,fe){return createRelativeUrl(`/dashboards/f/${de}/${fe}/alerting`)}function V(de){return createRelativeUrl(`/dashboards/f/${de}/settings`)}function z(de){return(0,d.G)(`/d/${encodeURIComponent(de)}`)}function w(de,fe){const ae=new URLSearchParams({viewPanel:fe});return(0,d.G)(`/d/${encodeURIComponent(de)}`,ae)}function H(de,fe){return(0,d.G)(`/alerting/notifications/receivers/${encodeURIComponent(de)}/edit`,fe)}function Q(de,fe){return(0,d.G)("/alerting/routes/mute-timing/edit",{...fe,muteName:de})}function Z(de,fe,ae,ce=1e3){const ie=new Date().getTime(),ve=()=>de().catch(le=>{if(fe(le)&&new Date().getTime()-ie<ae)return new Promise(Ee=>setTimeout(Ee,ce)).then(ve);throw le});return ve()}const Y={[c.Gi.Alerting]:1,[c.cF.Firing]:1,[c.Gi.Error]:1,[c.Gi.Pending]:2,[c.Gi.Recovering]:2,[c.cF.Pending]:2,[c.cF.Recovering]:2,[c.cF.Inactive]:2,[c.Gi.NoData]:3,[c.Gi.Normal]:4,[c.cF.Unknown]:5};function X(de,fe){if(de===p.xB.Importance)return(0,n.sortBy)(fe,ce=>[Y[(0,c.lh)(ce.state)],(0,f.RI)(ce).toLocaleLowerCase()]);if(de===p.xB.TimeAsc)return(0,n.sortBy)(fe,ce=>[new Date(ce.activeAt)||new Date,(0,f.RI)(ce).toLocaleLowerCase()]);if(de===p.xB.TimeDesc)return(0,n.sortBy)(fe,ce=>[new Date(ce.activeAt)||new Date,(0,f.RI)(ce).toLocaleLowerCase()]).reverse();const ae=(0,n.sortBy)(fe,ce=>(0,f.RI)(ce).toLocaleLowerCase());return de===p.xB.AlphaDesc&&ae.reverse(),ae}function I(){return r.$.buildInfo.edition===s.r.OpenSource}function J(){return o.TP.hasRole("Admin")||o.TP.isGrafanaAdmin}function ee(){return r.$.buildInfo.env==="development"}function q(de){return!!(de&&typeof de=="object"&&"message"in de)}function ne(de){if((0,m.jX)(de)&&de.data.details)return de.data.details.uid;if(q(de)&&(0,n.isString)(de.cause))return de.cause}function se(de,fe){return de?ne(de)===fe:!1}function oe(de){if((0,u.NF)(de)){if((0,m.jX)(de)){const ce=(0,m.LQ)(de);if(ce)return ce}if(de.message)return de.message;if("message"in de.data&&typeof de.data.message=="string"){const ce=(0,l.do)(de),ie=(0,l.q6)(de),ve=(0,l.ee)(de);return(0,i.t)("alerting.errors.failedWith","{{-config}} failed with {{status}}: {{-message}}",{config:ve,status:ce,message:ie})}return de.statusText?de.statusText:String(de.status)||"Unknown error"}if(!q(de))return String(de);const ae=ne(de);if(typeof ae=="string"){const ce=(0,m.j2)(ae);if(ce)return ce}return de.cause?`${de.message}, cause: ${oe(de.cause)}`:de.message}},29442:(te,R,e)=>{"use strict";e.d(R,{Mo:()=>r,PP:()=>o,TN:()=>u,tx:()=>i});var n=e(39187),a=e(94646),s=e(92367);const i=(l,g)=>{const f=new URLSearchParams([["search",l.map(([p,c])=>`${p}:"${c}"`).join(" ")]]);return(0,s.G)("/alerting/list",f,{skipSubPath:g?.skipSubPath})},r=(l={},g)=>(0,s.G)("/alerting/list",l,{skipSubPath:g?.skipSubPath}),u={detailsPageLink:(l,g,f,p)=>{const c=p?.includeReturnTo?{returnTo:(0,n.w)()}:{};return(0,s.G)(`/alerting/${l}/namespaces/${encodeURIComponent(g)}/groups/${encodeURIComponent(f)}/view`,c)},detailsPageLinkFromGroupIdentifier:l=>{const{groupOrigin:g,namespace:f,groupName:p}=l;return g==="grafana"?u.detailsPageLink("grafana",f.uid,p):u.detailsPageLink(l.rulesSource.uid,f.name,p)},editPageLink:(l,g,f,p)=>{const c=p?.includeReturnTo?{returnTo:(0,n.w)()}:{};return(0,s.G)(`/alerting/${l}/namespaces/${encodeURIComponent(g)}/groups/${encodeURIComponent(f)}/edit`,c,{skipSubPath:p?.skipSubPath})},newAlertRuleLink:(l,g,f)=>{const p=(0,n.w)(),c=JSON.stringify({folder:{title:l,uid:g},group:f});return(0,s.G)("/alerting/new",{defaults:c,returnTo:p})},newRecordingRuleLink:(l,g,f)=>{const p=(0,n.w)(),c=JSON.stringify({folder:{title:l,uid:g},group:f});return(0,s.G)("/alerting/new/grafana-recording",{defaults:c,returnTo:p})}},o={detailsPageLink:(l,g,f,p)=>(0,s.G)(`/alerting/${encodeURIComponent(l)}/${encodeURIComponent((0,a.$9)(g))}/view`,f,{skipSubPath:p?.skipSubPath})}},48442:(te,R,e)=>{"use strict";e.d(R,{Rs:()=>i,W$:()=>f,Wn:()=>c,_I:()=>p,rJ:()=>o});var n=e(2543),a=e.n(n),s=e(63895);const i=["receiver","group_by","group_wait","group_interval","repeat_interval"];function r(x,v){const m=matchLabelsSet(x,v),y=new Map(v.map(h=>[h,{match:!1,matcher:null}]));return x.forEach(h=>{const d=v.find(E=>isLabelMatch(h,E));d&&y.set(d,{match:!0,matcher:h})}),{matches:m,labelsMatch:y}}function u(x,v){let m=[];const y=r(x.object_matchers??[],v);if(!y.matches)return[];if(x.routes)for(const h of x.routes){const d=u(h,v);if(m=m.concat(d),d.length&&!h.continue)break}return m.length===0&&m.push({route:x,labelsMatch:y.labelsMatch}),m}function o(x){function v(y){y.object_matchers=(0,s.J$)(y),delete y.matchers,delete y.match,delete y.match_re,y.routes?.forEach(v)}const m=structuredClone(x);return v(m),m}function l(x){function v(y){y.object_matchers=y.object_matchers?.map(([h,d,E])=>[unquoteWithUnescape(h),d,unquoteWithUnescape(E)]),y.routes?.forEach(v)}const m=structuredClone(x);return v(m),m}function g(x,v,m){const y=[];return m.reduce((h,d)=>{const E=d.alerts.filter(b=>{const D=Object.entries(b.labels);return u(x,D).some(C=>C.route===v)});return E.length&&h.push({...d,alerts:E}),h},y)}function f(x,v,m){const h={...(0,n.pick)(x,i),...m};return(0,n.reduce)(h,(E,b,D)=>{const C=b!=null,O=[void 0,"",null].some(W=>v[D]===W)&&C,j=D==="group_by"&&C&&(0,n.isArray)(v[D])&&v[D]?.length===0;return(O||j)&&(E[D]=b),E},{})}function p(x){return{...x,routes:x.routes?.map(v=>{const m=f(x,v);return p({...v,...m})})}}function c(x,v,m){const y={...x};return y.receiver===v&&(y.receiver=m),y.routes&&(y.routes=y.routes.map(h=>c(h,v,m))),y}},72930:(te,R,e)=>{"use strict";e.d(R,{u:()=>n});function n(a,s,i,r={}){return{propertyName:a,label:s,description:i,element:"input",inputType:"",required:!1,secure:!1,placeholder:"",validationRule:"",showWhen:{field:"",is:""},dependsOn:"",...r}}},36200:(te,R,e)=>{"use strict";e.d(R,{$I:()=>p,BU:()=>D,CZ:()=>v,J7:()=>g,ML:()=>C,Vf:()=>E,Xw:()=>f,jA:()=>o,p0:()=>m,t4:()=>b,v5:()=>c});var n=e(65307),a=e(32899),s=e(68143),i=e(73427),r=e(74268),u=e(77256);const o=Object.freeze({loading:!1,result:void 0,error:void 0,dispatched:!1});function l(P,M=o,O){if(P.pending.match(O))return{result:M.result,loading:!0,error:M.error,dispatched:!0,requestId:O.meta.requestId};if(P.fulfilled.match(O)){if(M.requestId===void 0||M.requestId===O.meta.requestId)return{...M,result:O.payload,loading:!1,error:void 0}}else if(P.rejected.match(O)&&M.requestId===O.meta.requestId)return{...M,loading:!1,error:O.error};return M}function g(P,M){return(0,n.Z0)({name:P,initialState:o,reducers:{},extraReducers:O=>O.addDefaultCase((j,U)=>l(M,j,U))})}function f(P,M,O){return(0,n.Z0)({name:P,initialState:{},reducers:{},extraReducers:j=>j.addDefaultCase((U,W)=>{if((0,n.$S)(M)(W)){const B=W,S=O(B.meta.arg);return{...U,[S]:l(M,U[S],B)}}return U})})}function p(P){return P.catch(M=>{throw{message:v(M),code:M.statusCode}})}function c(P,M){return P.then(O=>(M.successMessage&&i.lE.emit(a.r1.alertSuccess,[M.successMessage]),O)).catch(O=>{const j=v(O);throw i.lE.emit(a.r1.alertError,[`${M.errorMessage??"Error"}: ${j}`]),O})}const x="Unknown Error";function v(P){if((0,s.NF)(P))if(P.data?.message){let M=P.data?.message;return typeof P.data?.error=="string"&&(M+=`; ${P.data.error}`),M}else{if(Array.isArray(P.data)&&P.data.length&&P.data[0]?.message)return P.data.map(M=>M?.message).filter(M=>!!M).join(" ");if(P.statusText)return P.statusText}return(0,u.u7)(P)?P.message:((0,r.fH)(r.le.unknownMessageFromError,{error:JSON.stringify(P)}),x)}function m(P){return Object.values(P).every(y)}function y(P){return P.dispatched&&!P.loading}function h(P){return Object.values(P).every(d)}function d(P){return P.dispatched&&!P.loading&&!P.error}function E(P){return Object.values(P).some(C)}function b(P){return Object.values(P).some(M=>M.dispatched)}function D(P){return Object.values(P).some(d)}function C(P){return P?P.dispatched&&P.loading:!1}},67923:(te,R,e)=>{"use strict";e.d(R,{AB:()=>l,AS:()=>g,HO:()=>x,I8:()=>f,KR:()=>m,dn:()=>c,eM:()=>v});var n=e(1932),a=e(2543),s=e.n(a),i=e(46635),r=e(84266),u=e(42824),o=e(33998);const l=(d,E,b)=>{if(!v(E.id??"",b))throw new Error(`No such route with ID '${E.id}'`,{cause:o.g2});function C(P){let M=P;if(P.id===E.id){const O=(0,u.SJ)(d,E,b);M={...P,...O}}return{...M,routes:P.routes?.map(C)}}return C(b)},g=(d,E)=>{if(d===E.id)throw new Error("You cant remove the root policy");function b(D){return{...D,routes:D.routes?.reduce((C=[],P)=>(P.id===d||C.push(b(P)),C),[])}}return b(E)},f=(d,E,b,D,C)=>{const P=(0,u.SJ)(d,E,D);return(0,n.jM)(D,M=>{const[O,j,U]=p(M,b);if(O===void 0||j===void 0||U===void 0)throw new Error(`could not find reference route "${b}" in tree`,{cause:o.g2});C==="child"&&(O.routes?O.routes.push(P):O.routes=[P]),C==="above"&&(j.routes=i.insertBeforeImmutably(j.routes??[],P,U)),C==="below"&&(j.routes=i.insertAfterImmutably(j.routes??[],P,U))})};function p(d,E){let b,D,C;function P(M,O,j){b||(M.id===E&&(b=M,D=j,C=O),M.routes&&M.routes.forEach((U,W)=>P(U,W,M)))}return P(d,0,d),[b,D,C]}function c(d){return(0,a.omit)({...d,routes:d.routes?.map(E=>c(E))},"id")}function x(d){return(0,n.jM)(d,E=>{E.spec.routes=E.spec.routes.map(c)})}function v(d,E){return E.id===d?E:E.routes?.find(b=>v(d,b))}function m(d){const E=JSON.stringify(y(d));let b=0;for(let D=0;D<E.length;D++){const C=E.charCodeAt(D);b=(b<<5)-b+C,b=b&b}return b.toString(36)}function y(d){return{receiver:d.receiver??"",group_by:d.group_by?[...d.group_by].sort():[],continue:d.continue??!1,object_matchers:d.object_matchers?[...d.object_matchers].sort():[],matchers:d.matchers?[...d.matchers].sort():[],match:d.match?h(d.match):{},match_re:d.match_re?h(d.match_re):{},group_wait:d.group_wait??"",group_interval:d.group_interval??"",repeat_interval:d.repeat_interval??"",routes:d.routes??[],mute_time_intervals:d.mute_time_intervals?[...d.mute_time_intervals].sort():[],active_time_intervals:d.active_time_intervals?[...d.active_time_intervals].sort():[],provenance:d.provenance??"",[r.uz]:{}}}function h(d){const E={};return Object.keys(d).sort().forEach(b=>{E[b]=d[b]}),E}},20437:(te,R,e)=>{"use strict";e.d(R,{Bu:()=>I,J6:()=>Q,Os:()=>b,Q8:()=>E,QX:()=>_,Qk:()=>T,XI:()=>L,Z9:()=>O,l1:()=>D,mY:()=>J,mp:()=>H,qO:()=>A,zQ:()=>K});var n=e(22592),a=e(17548),s=e(39796),i=e(43173),r=e(78282),u=e(36580),o=e(36674),l=e(8285),g=e(4651),f=e(2954),p=e(84523),c=e(6194),x=e(67817),v=e(95443),m=e(52161),y=e(77256),h=e(29609),d=e(15629);const E="grafana.alerting.manualRouting",b="grafana.alerting.simplifiedQueryEditor";function D(ee){const{name:q,expression:ne,forTime:se,forTimeUnit:oe,keepFiringForTime:de,keepFiringForTimeUnit:fe,type:ae}=ee,ce=(0,y.Sl)(j(ee.annotations)),ie=(0,y.Sl)(U(ee.labels));if(ae===x.Z.cloudAlerting){let ve;return de&&fe&&(ve=`${de}${fe}`),{alert:q,for:`${se}${oe}`,keep_firing_for:ve,annotations:ce,labels:ie,expr:ne}}else if(ae===x.Z.cloudRecording)return{record:q,labels:ie,expr:ne};throw new Error(`unexpected rule type: ${ae}`)}function C(ee,q){const ne=[...(0,y.KT)(ee||{})];return q&&ne.push({key:"",value:""}),ne}function P(ee,q){if(q?.grafana?.selectedContactPoint&&ee)return{receiver:q?.grafana?.selectedContactPoint,mute_time_intervals:q?.grafana?.muteTimeIntervals,active_time_intervals:q?.grafana?.activeTimeIntervals,group_by:q?.grafana?.overrideGrouping?q?.grafana?.groupBy:void 0,group_wait:q?.grafana?.overrideTimings&&q?.grafana?.groupWaitValue?q?.grafana?.groupWaitValue:void 0,group_interval:q?.grafana?.overrideTimings&&q?.grafana?.groupIntervalValue?q?.grafana?.groupIntervalValue:void 0,repeat_interval:q?.grafana?.overrideTimings&&q?.grafana?.repeatIntervalValue?q?.grafana?.repeatIntervalValue:void 0}}function M(ee){return{simplified_query_and_expressions_section:ee.simplifiedQueryEditor,simplified_notifications_section:ee.simplifiedNotificationEditor}}function O(ee){const{name:q,condition:ne,noDataState:se,execErrState:oe,evaluateFor:de,keepFiringFor:fe,queries:ae,isPaused:ce,contactPoints:ie,manualRouting:ve,type:le,metric:Ee,targetDatasourceUid:Re,missingSeriesEvalsToResolve:Oe}=ee;if(!ne)throw new Error("You cannot create an alert rule without specifying the alert condition");const Se=P(ve,ie),Te=ee.editorSettings?{editor_settings:M(ee.editorSettings)}:void 0,_e=(0,y.Sl)(j(ee.annotations)),He=(0,y.Sl)(U(ee.labels)),tt=(0,h.Mu)(le),Je=(0,h.pq)(le);if(tt)return{grafana_alert:{title:q,condition:ne,data:ae.map(Y),is_paused:!!ce,no_data_state:se,exec_err_state:oe,notification_settings:Se,metadata:Te,missing_series_evals_to_resolve:Oe?Number(Oe):0},annotations:_e,labels:He,for:de,keep_firing_for:fe};if(Je)return{grafana_alert:{title:q,condition:ne,data:ae.map(Y),is_paused:!!ce,record:{metric:Ee??q,from:ne,target_datasource_uid:Re}},annotations:_e,labels:He};throw new Error(`Failed to convert form values to Grafana rule: unknown type ${le}`)}const j=ee=>ee.map(W).filter(({key:q,value:ne})=>!!q&&!!ne),U=ee=>ee.map(W).filter(({key:q})=>!!q),W=({key:ee,value:q})=>({key:ee.trim(),value:q.trim()});function B(ee){const q=ee.notification_settings?{selectedContactPoint:ee.notification_settings.receiver,muteTimeIntervals:ee.notification_settings.mute_time_intervals??[],activeTimeIntervals:ee.notification_settings.active_time_intervals??[],overrideGrouping:Array.isArray(ee.notification_settings.group_by)&&ee.notification_settings.group_by.length>0,overrideTimings:[ee.notification_settings.group_wait,ee.notification_settings.group_interval,ee.notification_settings.repeat_interval].some(Boolean),groupBy:ee.notification_settings.group_by||[],groupWaitValue:ee.notification_settings.group_wait||"",groupIntervalValue:ee.notification_settings.group_interval||"",repeatIntervalValue:ee.notification_settings.repeat_interval||""}:void 0;return q?{[m.hY]:q}:void 0}function S(ee){if(i.$.featureToggles.alertingQueryAndExpressionsStepMode)return ee.metadata?.editor_settings?{simplifiedQueryEditor:ee.metadata.editor_settings.simplified_query_and_expressions_section,simplifiedNotificationEditor:ee.metadata.editor_settings.simplified_notifications_section}:{simplifiedQueryEditor:!1,simplifiedNotificationEditor:!!ee.notification_settings}}function _(ee){const{ruleSourceName:q,namespace:ne,group:se,rule:oe}=ee,de=h.p.grafana.recordingRule(oe),fe=(0,p.IJ)(de?x.Z.grafanaRecording:void 0);if((0,m.z2)(q))if(de){const ae=oe.grafana_alert;return{...fe,name:ae.title,type:x.Z.grafanaRecording,group:se.name,evaluateEvery:se.interval||fe.evaluateEvery,queries:ae.data,condition:ae.condition,annotations:(0,c.JE)(C(oe.annotations,!1)),labels:C(oe.labels,!0),folder:{title:ne,uid:ae.namespace_uid},isPaused:ae.is_paused,metric:ae.record?.metric,targetDatasourceUid:ae.record?.target_datasource_uid||fe.targetDatasourceUid}}else if(h.p.grafana.rule(oe)){const ae=oe.grafana_alert,ce=B(ae);if(ae.no_data_state!==void 0&&ae.exec_err_state!==void 0)return{...fe,name:ae.title,type:x.Z.grafana,group:se.name,evaluateEvery:se.interval||fe.evaluateEvery,evaluateFor:oe.for||"0",keepFiringFor:oe.keep_firing_for||"0",noDataState:ae.no_data_state,execErrState:ae.exec_err_state,queries:ae.data,condition:ae.condition,annotations:(0,c.JE)(C(oe.annotations,!1)),labels:C(oe.labels,!0),folder:{title:ne,uid:ae.namespace_uid},isPaused:ae.is_paused,contactPoints:ce,manualRouting:!!ce,editorSettings:S(ae),missingSeriesEvalsToResolve:ae.missing_series_evals_to_resolve};throw new Error("Unexpected type of rule for grafana rules source")}else throw new Error("Unexpected type of rule for grafana rules source");else if(h.p.dataSource.alertingRule(oe)){const ce={refId:"A",datasourceUid:(0,r.l)().getInstanceSettings(q)?.uid??"",queryType:"",relativeTimeRange:(0,n.Cn)(),expr:oe.expr,model:{refId:"A",hide:!1,expr:oe.expr}},ie=T(oe);return{...fe,...ie,queries:[ce],annotations:(0,c.JE)(C(oe.annotations,!1)),type:x.Z.cloudAlerting,dataSourceName:q,namespace:ne,group:se.name}}else if(h.p.dataSource.recordingRule(oe)){const ae=L(oe);return{...fe,...ae,type:x.Z.cloudRecording,dataSourceName:q,namespace:ne,group:se.name}}else throw new Error("Unexpected type of rule for cloud rules source")}function K(ee,q){const ne=h.p.grafana.recordingRule(ee),se=(0,p.IJ)(ne?x.Z.grafanaRecording:void 0),oe=ee.grafana_alert,de=ee.for,fe=ee.keep_firing_for,ae=ee.annotations,ce=ee.labels,ie={...se,name:oe.title,queries:oe.data,condition:oe.condition,annotations:(0,c.JE)(C(ae,!1)),labels:C(ce,!0),folder:{title:q,uid:oe.namespace_uid},isPaused:oe.is_paused};if(h.p.grafana.recordingRule(ee))return{...ie,type:x.Z.grafanaRecording,group:oe.rule_group,metric:oe.record?.metric};const ve=B(oe);if(oe.no_data_state!==void 0&&oe.exec_err_state!==void 0)return{...ie,type:x.Z.grafana,group:oe.rule_group,evaluateFor:de||"0",keepFiringFor:fe||"0",noDataState:oe.no_data_state,execErrState:oe.exec_err_state,contactPoints:ve,manualRouting:!!ve,editorSettings:S(oe)};throw new Error("Unexpected type of rule for grafana rules source")}function T(ee){const q=(0,p.IJ)(),[ne,se]=ee.for?(0,d.P1)(ee.for):[0,"s"],[oe,de]=ee.keep_firing_for?(0,d.P1)(ee.keep_firing_for):[q.keepFiringForTime,q.keepFiringForTimeUnit];return{name:ee.alert,expression:ee.expr,forTime:ne,forTimeUnit:se,keepFiringForTime:oe,keepFiringForTimeUnit:de,annotations:C(ee.annotations,!1),labels:C(ee.labels,!0)}}function L(ee){return{name:ee.record,expression:ee.expr,labels:C(ee.labels,!0)}}const A=(ee=!1)=>{const q=(0,m.y9)();if(!q)return[...ee?z("A"):V("A","B")];const ne=(0,n.Cn)(),se=ee?z("B"):V("B","C"),oe=q?(0,m.cl)(q.type):!1;return[{refId:"A",datasourceUid:q.uid,queryType:"",relativeTimeRange:ne,model:{refId:"A",instant:oe?!0:void 0}},...se]},N=ee=>{const q=getDefaultRelativeTimeRange();return[{refId:"A",datasourceUid:ee[0]?.uid||"",queryType:"",relativeTimeRange:q,model:{refId:"A"}}]},V=(...ee)=>{const q=ee[0],ne=ee[1],se={refId:ee[0],type:g.Tz.reduce,datasource:{uid:g.Uj,type:u.dR.type},conditions:[{type:"query",evaluator:{params:[],type:f.p.IsAbove},operator:{type:"and"},query:{params:[q]},reducer:{params:[],type:"last"}}],reducer:"last",expression:"A"},oe={refId:ne,type:g.Tz.threshold,datasource:{uid:g.Uj,type:u.dR.type},conditions:[{type:"query",evaluator:{params:[0],type:f.p.IsAbove},operator:{type:"and"},query:{params:[ne]},reducer:{params:[],type:"last"}}],expression:q};return[{refId:q,datasourceUid:g.Uj,queryType:"",model:se},{refId:ne,datasourceUid:g.Uj,queryType:"",model:oe}]},z=ee=>{const q={refId:ee,type:g.Tz.reduce,datasource:{uid:g.Uj,type:u.dR.type},conditions:[{type:"query",evaluator:{params:[],type:f.p.IsAbove},operator:{type:"and"},query:{params:[ee]},reducer:{params:[],type:"last"}}],reducer:"last",expression:"A"};return[{refId:ee,datasourceUid:g.Uj,queryType:"",model:q}]},w=async(ee,q,ne,se,oe,de)=>{const fe=[];for(const ae of ee){const ce=await(0,r.l)().get(ae.datasource?.uid?ae.datasource:se),ie={uid:ce.uid,type:ce.type},ve=a.relativeToTimeRange(q),{interval:le,intervalMs:Ee}=Z(ve,de??ce.interval,oe),Re={__interval:{text:le,value:le},__interval_ms:{text:Ee,value:Ee},...ne},Oe=ce.interpolateVariablesInQueries?ce.interpolateVariablesInQueries([ae],Re)[0]:ae;if(ie.uid===g.Uj){const Se={refId:Oe.refId,queryType:"",relativeTimeRange:q,datasourceUid:g.Uj,model:Oe};fe.push(Se)}else{const Se=(0,r.l)().getInstanceSettings(ie);if(Se&&Se.meta.alerting){const Te={refId:Oe.refId,queryType:Oe.queryType??"",relativeTimeRange:q,datasourceUid:Se.uid,model:{...Oe,maxDataPoints:oe,intervalMs:Ee}};fe.push(Te)}}}return fe},H=async(ee,q)=>{const{targets:ne}=ee;if(!ee.id||!q.uid)return;const se=a.timeRangeToRelative(a.convertRawToRange(q.time)),oe=await w(ne,se,ee.scopedVars||{},ee.datasource??void 0,ee.maxDataPoints??void 0,ee.interval??void 0);if(!oe.length||!oe.find(ie=>ie.datasourceUid!==g.Uj))return;if(!oe.find(ie=>ie.datasourceUid===g.Uj)){const[ie,ve]=V((0,s.M)(oe),"-");oe.push(ie);const[le,Ee]=V(ie.refId,(0,s.M)(oe));oe.push(Ee)}const{folderTitle:de,folderUid:fe}=q.meta,ae=fe&&de?{kind:"folder",uid:fe,title:de}:void 0;return{type:x.Z.grafana,folder:ae,queries:oe,name:ee.title,condition:oe[oe.length-1].refId,annotations:[{key:v.YH.dashboardUID,value:q.uid},{key:v.YH.panelID,value:String(ee.id)}]}},Q=async ee=>{if(!ee.state.key)return;const q=o.jh.getTimeRange(ee),ne=(0,l.un)(ee);if(!ne)return;const{queries:se,datasource:oe,maxDataPoints:de,minInterval:fe}=ne.state,ae=(0,l.YQ)(ee);if(!ae||!ae.state.uid)return;const ce=await w(se,a.timeRangeToRelative(a.convertRawToRange(q.state.value.raw)),{__sceneObject:{value:ee}},oe,de,fe);if(!ce.length||!ce.find(Re=>Re.datasourceUid!==g.Uj))return;if(!ce.find(Re=>Re.datasourceUid===g.Uj)){const[Re,Oe]=V((0,s.M)(ce),"-");ce.push(Re);const[Se,Te]=V(Re.refId,(0,s.M)(ce));ce.push(Te)}const{folderTitle:ie,folderUid:ve}=ae.state.meta,le=ve&&ie?{kind:"folder",uid:ve,title:ie}:void 0;return{type:x.Z.grafana,folder:le,queries:ce,name:ee.state.title,condition:ce[ce.length-1].refId,annotations:[{key:v.YH.dashboardUID,value:ae.state.uid},{key:v.YH.panelID,value:String((0,l.Cs)(ee))}]}};function Z(ee,q,ne){return ne?a.calculateInterval(ee,ne,q):q&&a.intervalToMs(q)>1e3?{interval:q,intervalMs:a.intervalToMs(q)}:{interval:"1s",intervalMs:1e3}}function Y(ee){const q=ee.model;return X(q)&&q.instant&&q.range?{...ee,model:{...q,range:!0,instant:!1}}:ee}function X(ee){return"expr"in ee&&"instant"in ee&&"range"in ee}function I(ee){return"expr"in ee}function J(ee){const q=ee.datasourceUid??ee.model.datasource?.uid;if(!q)return;const ne=(0,r.l)().getInstanceSettings(q)?.type;if(!ne||!(0,m.cl)(ne))return;const{model:se}=ee,oe="instant"in se&&se.instant!==void 0?se.instant:!0,de="queryType"in se&&se.queryType!==void 0?se.queryType==="instant":!0;return(0,m.bS)(ne)?oe:de}},94646:(te,R,e)=>{"use strict";e.d(R,{$9:()=>M,LC:()=>m,Lg:()=>c,Ns:()=>j,P1:()=>g,PH:()=>b,Tn:()=>B,UP:()=>x,VY:()=>K,c:()=>D,co:()=>f,h1:()=>S,jY:()=>W,mw:()=>p,qg:()=>C,uE:()=>T,vL:()=>U,x6:()=>P});var n=e(2543),a=e.n(n),s=e(36490),i=e(24619),r=e(74268),u=e(74869),o=e(52161),l=e(29609);function g(L,A,N,V){return l.p.grafana.rule(V)?{uid:V.grafana_alert.uid,ruleSourceName:"grafana"}:{ruleSourceName:L,namespace:A,groupName:N,ruleName:(0,l.qz)(V),rulerRuleHash:j(V)}}function f(L,A){if(L.groupOrigin==="grafana"){if(l.p.grafana.rule(A))return{uid:A.grafana_alert.uid,ruleSourceName:"grafana"};throw(0,r.vV)(new Error("Rule is not a Grafana Ruler rule")),new Error("Rule is not a Grafana Ruler rule")}return g(L.rulesSource.name,L.namespace.name,L.groupName,A)}function p(L,A){const{dataSourceName:N,namespaceName:V,groupName:z}=L;return g(N,V,z,A)}function c(L,A,N,V){return{ruleSourceName:L,namespace:A,groupName:N,ruleName:V.name,ruleHash:W(V)}}function x(L,A){const N=A.namespace.name,V=A.group.name;if(A.rulerRule)return g(L,N,V,A.rulerRule);if(A.promRule)return c(L,N,V,A.promRule);throw new Error("Could not create an id for a rule that is missing both `rulerRule` and `promRule`.")}function v(L){return g(L.ruleSourceName,L.namespace,L.group.name,L.rule)}function m(L,A){return(0,l.A4)(L)&&(0,l.A4)(A)?L.uid===A.uid:(0,l.X4)(L)&&(0,l.X4)(A)?L.groupName===A.groupName&&L.namespace===A.namespace&&L.ruleName===A.ruleName&&L.rulerRuleHash===A.rulerRuleHash&&L.ruleSourceName===A.ruleSourceName:(0,l.Mj)(L)&&(0,l.Mj)(A)?L.groupName===A.groupName&&L.namespace===A.namespace&&L.ruleName===A.ruleName&&L.ruleHash===A.ruleHash&&L.ruleSourceName===A.ruleSourceName:(0,l.X4)(L)&&(0,l.Mj)(A)?L.groupName===A.groupName&&L.namespace===A.namespace&&L.ruleName===A.ruleName&&L.rulerRuleHash===A.ruleHash&&L.ruleSourceName===A.ruleSourceName:(0,l.Mj)(L)&&(0,l.X4)(A)?L.groupName===A.groupName&&L.namespace===A.namespace&&L.ruleName===A.ruleName&&L.ruleHash===A.rulerRuleHash&&L.ruleSourceName===A.ruleSourceName:!1}const y="cri",h="pri";function d(L){return L.replace(/\$/g,"_DOLLAR_")}function E(L){return L.replace(/\_DOLLAR\_/g,"$")}function b(L){return L.replace(/\//g,"").replace(/\\/g,"")}function D(L){return L.replace(/\x1f/g,"/").replace(/\x1e/g,"\\")}function C(L,A=!1){const V=(A?decodeURIComponent(L):L).split("$");if(V.length===1)return{uid:L,ruleSourceName:"grafana"};if(V.length===6){const[z,w,H,Q,Z,Y]=V.map(E).map(D);if(z===y)return{ruleSourceName:w,namespace:H,groupName:Q,ruleName:Z,rulerRuleHash:Y};if(z===h)return{ruleSourceName:w,namespace:H,groupName:Q,ruleName:Z,ruleHash:Y}}throw new Error(`Failed to parse rule location: ${L}`)}function P(L,A=!1){if(L)try{return C(L,A)}catch{return}}function M(L){return(0,l.A4)(L)?L.uid:(0,l.X4)(L)?[y,L.ruleSourceName,L.namespace,L.groupName,L.ruleName,L.rulerRuleHash].map(String).map(d).map(b).join("$"):[h,L.ruleSourceName,L.namespace,L.groupName,L.ruleName,L.ruleHash].map(String).map(d).map(b).join("$")}function O(L){let A=0;if(L.length===0)return A;for(let N=0;N<L.length;N++){const V=L.charCodeAt(N);A=(A<<5)-A+V,A=A&A}return A}function j(L){if(l.p.grafana.rule(L))return L.grafana_alert.uid;const N=!(0,u.wS)(),V=U(L,N);return O(JSON.stringify(V)).toString()}function U(L,A){const N=A?S(L.expr):"",V=_(L.labels);if(l.p.dataSource.recordingRule(L))return[L.record,i.JS.Recording,N,V];if(l.p.dataSource.alertingRule(L))return[L.alert,i.JS.Alerting,N,_(L.annotations),V];throw new Error("Only recording and alerting ruler rules can be hashed")}function W(L){const N=!(0,u.wS)(),V=B(L,N);return O(JSON.stringify(V)).toString()}function B(L,A){const N=A?S(L.query):"",V=_(L.labels);if(l.R$.recordingRule(L))return[L.name,i.JS.Recording,N,V];if(l.R$.alertingRule(L))return[L.name,i.JS.Alerting,N,_(L.annotations),V];throw new Error("Only recording and alerting rules can be hashed")}function S(L){return L.length>1&&L[0]==="("&&L[L.length-1]===")"&&(L=L.slice(1,-1)),L=L.replace(/\s|\n/g,""),L.split("").sort().join("")}function _(L){return JSON.stringify(Object.entries(L||{}).sort((A,N)=>A[0].localeCompare(N[0])))}function K(L){return(0,l.A4)(L)?o.hY:L.ruleSourceName}function T(L){const{pathname:A=""}=s.Ny.getLocation(),{id:N}=L;return N?(0,n.nth)(A.split("/"),-2):void 0}},45311:(te,R,e)=>{"use strict";e.d(R,{U:()=>s});var n=e(2543),a=e.n(n);function s(i){const r=(0,n.pick)(i,["alerting","pending","inactive","recording","recovering"]);return(0,n.sum)(Object.values(r))}},29609:(te,R,e)=>{"use strict";e.d(R,{$7:()=>U,A4:()=>W,BL:()=>Te,H2:()=>He,I2:()=>le,Mj:()=>_,Mu:()=>Oe,Nv:()=>T,O9:()=>ce,OF:()=>_e,Om:()=>oe,R$:()=>O,RI:()=>j,Rh:()=>H,TU:()=>ee,Tm:()=>X,Wy:()=>ne,X4:()=>B,XI:()=>I,YN:()=>de,aw:()=>K,bL:()=>L,dS:()=>q,f6:()=>N,fC:()=>V,hC:()=>m,j_:()=>Ee,jg:()=>ae,nf:()=>S,oI:()=>A,p:()=>M,pq:()=>Se,qz:()=>fe,s_:()=>Je,uo:()=>Q,vE:()=>tt,x6:()=>E,xE:()=>Ge});var n=e(2543),a=e.n(n),s=e(76190),i=e(43173),r=e(24619),u=e(56369),o=e(67817),l=e(95443),g=e(52161),f=e(39659),p=e(15629);function c(je){return typeof je=="object"&&"grafana_alert"in je}function x(je){return c(je)&&!v(je)}function v(je){return c(je)&&"record"in je.grafana_alert}function m(je){return!!je.grafana_alert.is_paused}function y(je){return typeof je=="object"&&"alert"in je}function h(je){return typeof je=="object"&&!c(je)}function d(je){return typeof je=="object"&&"record"in je}function E(je){return je.rules.every(Fe=>h(Fe))}function b(je){return typeof je=="object"&&je.type===r.JS.Alerting}function D(je){return typeof je=="object"&&je.type===r.JS.Recording}function C(je){return b(je)&&"folderUid"in je&&"uid"in je}function P(je){return D(je)&&"folderUid"in je&&"uid"in je}const M={grafana:{rule:c,alertingRule:x,recordingRule:v},dataSource:{rule:h,alertingRule:y,recordingRule:d},any:{recordingRule:je=>d(je)||v(je),alertingRule:je=>y(je)||x(je)}},O={rule:je=>b(je)||D(je),alertingRule:b,recordingRule:D,grafana:{rule:je=>C(je)||P(je),alertingRule:C,recordingRule:P}};function j(je){return JSON.stringify(je.labels)}function U(je){return je.error&&je.error?.message?.includes(l.UU)}function W(je){return"uid"in je}function B(je){return"rulerRuleHash"in je}function S(je){return Object.values(r.JS).includes(je)}function _(je){return"ruleHash"in je}function K(je){return W(je)||B(je)}function T(je){return c(je)&&!!je.grafana_alert.provenance}function L(je){return O.grafana.rule(je)&&!!je.provenance}function A(je){return je.rules.some(Fe=>T(Fe))}function N(je){switch(je){case"ok":return u.Jc.Ok;case"nodata":return u.Jc.NoData;case"error":case"err":return u.Jc.Error;case"unknown":return u.Jc.Unknown;default:return}}function V(je){if(!M.any.recordingRule(je.rulerRule)){if(y(je.rulerRule))return je.rulerRule.for;if(b(je.promRule)){const Fe=(je.promRule.duration??0)*1e3;return(0,p.an)(Fe)}}}function z(je){return M.any.alertingRule(je)?je.for:void 0}function w(je){if(!M.any.recordingRule(je.rulerRule)&&x(je.rulerRule))return je.rulerRule.keep_firing_for}function H(je){return je?.annotations??{}}function Q(je){if(!je)return;const Fe=je.labels?.[f.lL];if(!Fe)return;const Be=Fe.match(/^plugin\/(?<pluginId>.+)$/);if(!Be?.groups)return;const Ke=Be.groups.pluginId;if(Z(Ke))return{pluginId:Ke}}function Z(je){return!!i.$.apps[je]}function Y(je){return je.rules.some(Fe=>X(Fe))}function X(je){return!!Q(je)}function I(je){return je===r.cF.Inactive?"Normal":(0,n.capitalize)(je)}const J=je=>je.reduce((Fe,{dataSourceName:Be,name:Ke,groups:Ue})=>(Ue.forEach(({name:we,rules:Xe})=>{Xe.forEach(nt=>{b(nt)&&Fe.push({dataSourceName:Be,namespaceName:Ke,groupName:we,rule:nt})})}),Fe),[]),ee=je=>b(je.promRule)?je.promRule:null,q=je=>je.reduce((Fe,{rulesSource:Be,name:Ke,groups:Ue})=>(Ue.forEach(({name:we,rules:Xe})=>{Xe.forEach(nt=>{nt.promRule&&b(nt.promRule)&&Fe.push({dataSourceName:(0,g.EV)(Be),namespaceName:Ke,groupName:we,...nt,namespace:{...nt.namespace,uid:nt.promRule.folderUid}})})}),Fe),[]);function ne(je){let Fe;return Object.values(s.O).includes(je)?Fe=je:Fe=(0,r.lh)(je),se[Fe]}const se={[r.cF.Inactive]:"good",[r.cF.Firing]:"bad",[r.cF.Pending]:"warning",[r.cF.Recovering]:"warning",[r.Gi.Alerting]:"bad",[r.Gi.Error]:"bad",[r.Gi.NoData]:"info",[r.Gi.Normal]:"good",[r.Gi.Pending]:"warning",[r.Gi.Recovering]:"warning",[s.O.NoData]:"info",[s.O.Paused]:"warning",[s.O.Alerting]:"bad",[s.O.OK]:"good",[s.O.Unknown]:"info"};function oe(je){return je?.alerts?je.alerts.reduce((Fe,Be)=>{const Ke=(0,r.lh)(Be.state)!==r.Gi.Normal;if(Be.activeAt&&Ke){const Ue=new Date(Be.activeAt);if(Fe===null||Fe.getTime()>Ue.getTime())return Ue}return Fe},null):null}function de(je){return Array.isArray(je.source_tenants)}function fe(je){return M.grafana.rule(je)?je.grafana_alert.title:M.dataSource.alertingRule(je)?je.alert:M.dataSource.recordingRule(je)?je.record:""}const ae=(je,Fe)=>{const Be={alertName:"",forDuration:"0s",evaluationsToFire:0};return c(je)?{alertName:je.grafana_alert.title,forDuration:je.for,evaluationsToFire:je.for?ce(je.for,Fe):null}:y(je)?{alertName:je.alert,forDuration:je.for??"0s",evaluationsToFire:ce(je.for??"0s",Fe)}:Be},ce=(je,Fe)=>{const Be=(0,p.P8)(Fe),Ke=(0,p.P8)(je);return Ke===0&&Be!==0?1:Be===0||Ke/Be<1?0:Math.ceil(Ke/Be)+1};function ie(je,Fe){return je===0?1:Fe===0||je/Fe<1?0:Math.ceil(je/Fe)+1}function ve(je){const Fe=isGrafanaRulesSource(je.namespace.rulesSource)?je.namespace.rulesSource:je.namespace.rulesSource.name,Be=c(je.rulerRule)?je.rulerRule.grafana_alert.namespace_uid:je.namespace.name;return{dataSourceName:Fe,namespaceName:Be,groupName:je.group.name}}function le(je){const Fe=je.ruleSourceName,Be=c(je.rule)?je.rule.grafana_alert.namespace_uid:je.namespace,Ke=je.group.name;return{dataSourceName:Fe,namespaceName:Be,groupName:Ke}}function Ee(je){const Fe=je.dataSourceName,Be=je.folder?.uid??je.namespace,Ke=je.group;if(!Fe)throw new Error("no datasource name in form values");return{dataSourceName:Fe,namespaceName:Be,groupName:Ke}}function Re(je){return isGrafanaRulesSource(je)?je:je.name}function Oe(je){return je===o.Z.grafana}function Se(je){return je===o.Z.grafanaRecording}function Te(je){return je===o.Z.cloudAlerting}function _e(je){return je===o.Z.cloudRecording}function He(je){return Oe(je)||Se(je)}function tt(je){return Se(je)||_e(je)}function Je(je){return Te(je)||_e(je)}function Ge(je){if(!je)return;let Fe;return"grafana_alert"in je&&M.grafana.rule(je)?Fe=je.grafana_alert.uid:"uid"in je&&O.grafana.rule(je)&&(Fe=je.uid),Fe}},42801:(te,R,e)=>{"use strict";e.d(R,{a:()=>i,o:()=>s});var n=e(2543),a=e.n(n);function s(r,u){let o=u.trim();if(!o.match(/\{\{\s*define/)){const l=o.split(`
`).map(g=>"  "+g).join(`
`);o=`{{ define "${r}" }}
${l}
{{ end }}`}return o}function i(r){const u=(o,l)=>`{{ define "${l}_NEW_${(0,n.now)()}" }}`;return r.replace(/\{\{\s*define\s*\"(?<defineName>.*)\"\s*\}\}/g,u)}},15629:(te,R,e)=>{"use strict";e.d(R,{M9:()=>g,P1:()=>a,P8:()=>p,TN:()=>r,an:()=>f,mo:()=>c,sc:()=>i,yl:()=>x});var n=e(72649);function a(v){const m=v.match(/(\d+)(\w+)/);if(m)return[Number(m[1]),m[2]];throw new Error(`Invalid interval description: ${v}`)}function s(v){const{sec:m,count:y}=rangeUtil.describeInterval(v);return m*y}const i=Object.entries(n.y).map(([v,m])=>({label:v[0].toUpperCase()+v.slice(1),value:m}));function r(v){try{return g(v),!0}catch{return!1}}const u={ms:1,s:1e3,m:60*1e3,h:60*60*1e3,d:24*60*60*1e3,w:7*24*60*60*1e3,y:365*24*60*60*1e3},o=new RegExp(/^(?:(?<value>\d+)(?<type>ms|s|m|h|d|w|y))|0$/),l=new Error(`Must be of format "(number)(unit)", for example "1m", or just "0". Available units: ${Object.values(n.y).join(", ")}`);function g(v){let m=v;const y=[];function h(E){const b=o.exec(E),D=b?.groups?.value&&b?.groups?.type;if(!b||!D)throw l;b&&b.groups?.value&&b.groups?.type&&(m=m.replace(b[0],""),y.push([Number(b.groups.value),b.groups.type])),m&&h(m)}if(h(v),!y.length)throw l;return y.reduce((E,[b,D])=>{const C=b*u[D];return E+C},0)}function f(v){const m=Math.floor(v/1e3),y=Math.floor(m/60),h=Math.floor(y/60),d=Math.floor(h/24),E=Math.floor(d/7),b=Math.floor(d/365);return v===0?"0s":[[b,"y"],[E%52,"w"],[d%365-7*(E%52),"d"],[h%24,"h"],[y%60,"m"],[m%60,"s"],[v%1e3,"ms"]].filter(([C])=>C>0).map(([C,P])=>C+P).join("")}const p=v=>{try{return g(v)}catch{return 0}},c=v=>v.includes("0001-01-01T00");function x(v){return v%(1e3*60*60)===0?v/(1e3*60*60)+"h":v%(1e3*60)===0?v/(1e3*60)+"m":v%1e3===0?v/1e3+"s":v.toFixed()+"ms"}},92367:(te,R,e)=>{"use strict";e.d(R,{G:()=>a,z:()=>s});var n=e(43173);function a(i,r,u={skipSubPath:!1}){const l=new URLSearchParams(r).toString();return`${u.skipSubPath?"":n.$.appSubUrl}${i}${l?`?${l}`:""}`}function s(i,r){const o=new URLSearchParams(r).toString();try{return`${new URL(n.$.appSubUrl+i,n.$.appUrl).href}${o?`?${o}`:""}`}catch{return a(i,r)}}},88547:(te,R,e)=>{"use strict";e.d(R,{S:()=>s});var n=e(36303),a=e(74268);function s(i,r={}){return(0,n.Xc)(i,{...r,style:"page",errorLogger:a.vV})}},78767:(te,R,e)=>{"use strict";e.d(R,{Xm:()=>i,rJ:()=>s,vJ:()=>a,vy:()=>r});var n=e(68143);function a(u){return(0,n.AI)().post("/api/annotations",u)}function s(u){return(0,n.AI)().put(`/api/annotations/${u.id}`,u)}function i(u){return(0,n.AI)().delete(`/api/annotations/${u.id}`)}async function r(){return(await(0,n.AI)().get("/api/annotations/tags")).result.tags.map(({tag:o,count:l})=>({term:o,count:l}))}},76478:(te,R,e)=>{"use strict";e.d(R,{A:()=>M});var n=e(74848),a=e(96540),s=e(75505),i=e(28105),r=e(62392),u=e(51898),o=e(92745),l=e(35137),g=e(68079),f=e(45861),p=e(34999),c=e(22429),x=e(75421),v=e(82612),m=e(87033),y=e(90696),h=e(16515),d=e(88907),E=e(55386),b=e(45967),D=e(30703),C=e(18857);class P extends a.PureComponent{constructor(j){super(j),this.updateFields=()=>{const U=this.props.response?.panelData,W=U?.series?.[0]??U?.annotations?.[0];if(W&&W.fields){const B=W.fields.map(S=>{const _=(0,h.Ct)(S,W);let K="";for(let T=0;T<W.length;T++){if(T>0&&(K+=", "),T>2){K+="...";break}K+=S.values[T]}return K.length>50&&(K=K.substring(0,50)+"..."),{label:`${_} (${S.type})`,value:_,description:K}});this.setState({fieldNames:B})}},this.onFieldSourceChange=(U,W)=>{const B=this.props.mappings||{},S=B[U]||{};this.props.change({...B,[U]:{...S,source:W.value||d.V.Field}})},this.onFieldNameChange=(U,W)=>{const B=this.props.mappings||{};if(!W){const _={...this.props.mappings};delete _[U],this.props.change(_);return}const S=B[U]||{};this.props.change({...B,[U]:{...S,value:W.value,source:d.V.Field}})},this.state={fieldNames:[]}}componentDidMount(){this.updateFields()}componentDidUpdate(j){j.response!==this.props.response&&this.updateFields()}renderRow(j,U,W){const{fieldNames:B}=this.state;let S=[...B];const _=U.value;let K=B.find(L=>_===L.value);_&&!K&&S.push({label:_,value:_});let T=W?W[j.key]:"";if(T&&j.key.startsWith("time")){const L=(0,E.j_)("dateTimeAsIso");T=(0,E.cN)(L(T))}return T==null&&(T=""),(0,n.jsxs)("tr",{children:[(0,n.jsxs)("td",{children:[j.label||j.key," ",j.help&&(0,n.jsx)(b.m,{content:j.help,children:(0,n.jsx)(D.I,{name:"info-circle"})})]}),(0,n.jsx)("td",{children:(0,n.jsx)(C.l6,{value:K,options:S,placeholder:j.placeholder||j.key,onChange:L=>{this.onFieldNameChange(j.key,L)},noOptionsMessage:(0,o.t)("annotations.annotation-field-mapper.noOptionsMessage-unknown-field-names","Unknown field names"),allowCustomValue:!0,isClearable:!0})}),(0,n.jsx)("td",{children:`${T}`})]},j.key)}render(){const j=this.props.response?.events?.[0],U=this.props.mappings||{};return(0,n.jsxs)("table",{className:"filter-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:(0,n.jsx)(o.x6,{i18nKey:"annotations.annotation-field-mapper.annotation",children:"Annotation"})}),(0,n.jsx)("th",{children:(0,n.jsx)(o.x6,{i18nKey:"annotations.annotation-field-mapper.from",children:"From"})}),(0,n.jsx)("th",{children:(0,n.jsx)(o.x6,{i18nKey:"annotations.annotation-field-mapper.first-value",children:"First value"})})]})}),(0,n.jsx)("tbody",{children:y.kj.map(W=>this.renderRow(W,U[W.key]||{},j))})]})}}class M extends a.PureComponent{constructor(){super(...arguments),this.state={},this.onRunQuery=async()=>{const{datasource:j,annotation:U}=this.props;if((0,y.E7)(j))return;const W=(0,c.UA)().getCurrent();if(!W)return;this.setState({running:!0});const B=await(0,s.s)((0,m.b)({range:(0,x.jG)().timeRange(),panel:new v.a9({}),dashboard:W},j,U));this.setState({running:!1,response:B})},this.onQueryChange=j=>{this.props.annotation.query&&this.props.annotation.query.spec&&(j={...this.props.annotation.query.spec,...j}),this.props.onChange({...this.props.annotation,target:j,...this.props.annotation.query&&{query:{kind:this.props.annotation.query.kind,spec:{...j}}},...this.props.annotation.legacyOptions?{legacyOptions:this.props.annotation.legacyOptions}:{}})},this.onMappingChange=j=>{this.props.onChange({...this.props.annotation,mappings:j})},this.onAnnotationChange=j=>{this.props.onChange({...j,...this.props.annotation.legacyOptions?{legacyOptions:this.props.annotation.legacyOptions}:{}})}}componentDidMount(){this.verifyDataSource()}componentDidUpdate(j){this.props.annotation!==j.annotation&&!(0,y.E7)(this.props.datasource)&&this.verifyDataSource()}verifyDataSource(){const{datasource:j,annotation:U}=this.props,B={...y.CU,...j.annotations}.prepareAnnotation(U);B!==U?this.props.onChange(B):this.onRunQuery()}getStatusSeverity(j){const{events:U,panelData:W}=j;return W?.errors||W?.error?"error":U?.length?"success":"warning"}renderStatusText(j,U){const{events:W,panelData:B}=j;if(U||j?.panelData?.state===i.Gu.Loading||!j)return(0,n.jsx)("p",{children:"loading..."});if(B?.errors)return(0,n.jsx)(n.Fragment,{children:B.errors.map((T,L)=>(0,n.jsx)("p",{children:T.message},L))});if(B?.error)return(0,n.jsx)("p",{children:B.error.message??"There was an error fetching data"});if(!W?.length)return(0,n.jsx)("p",{children:(0,n.jsx)(o.x6,{i18nKey:"annotations.standard-annotation-query-editor.no-events-found",children:"No events found"})});const S=B?.series?.[0]??B?.annotations?.[0],_=W.length,K=S?.fields.length;return(0,n.jsx)("p",{children:(0,n.jsxs)(o.x6,{i18nKey:"annotations.standard-annotation-query-editor.events-found",children:[{numEvents:_}," events (from ",{numFields:K}," fields)"]})})}renderStatus(){const{response:j,running:U}=this.state;return j?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.$,{v:2}),(0,n.jsx)("div",{children:U?(0,n.jsx)(g.y,{}):(0,n.jsx)(f.$n,{"data-testid":u.Tp.components.Annotations.editor.testButton,variant:"secondary",size:"xs",onClick:this.onRunQuery,children:(0,n.jsx)(o.x6,{i18nKey:"annotations.standard-annotation-query-editor.test-annotation-query",children:"Test annotation query"})})}),(0,n.jsx)(l.$,{v:2,layout:"block"}),(0,n.jsx)(p.F,{"data-testid":u.Tp.components.Annotations.editor.resultContainer,severity:this.getStatusSeverity(j),title:(0,o.t)("annotations.standard-annotation-query-editor.title-query-result","Query result"),children:this.renderStatusText(j,U)})]}):null}render(){const{datasource:j,annotation:U,datasourceInstanceSettings:W}=this.props,{response:B}=this.state;let S=j.annotations?.QueryEditor||j.components?.QueryEditor;if(!S)return(0,n.jsx)("div",{children:(0,n.jsx)(o.x6,{i18nKey:"annotations.standard-annotation-query-editor.no-query-editor",children:"Annotations are not supported. This datasource needs to export a QueryEditor"})});let _=U.target;U.query&&U.query.spec&&(_={...U.query.spec});let K={...j.annotations?.getDefaultQuery?.(),..._??{refId:"Anno"}},T=U;return U.query&&U.legacyOptions&&(T={...U.legacyOptions,...U}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.p,{instanceSettings:W,children:(0,n.jsx)(S,{query:K,datasource:j,onChange:this.onQueryChange,onRunQuery:this.onRunQuery,data:B?.panelData,range:(0,x.jG)().timeRange(),annotation:T,onAnnotationChange:this.onAnnotationChange},j?.name)}),(0,y.JX)(j)&&(0,n.jsxs)(n.Fragment,{children:[this.renderStatus(),(0,n.jsx)(P,{response:B,mappings:U.mappings,change:this.onMappingChange})]})]})}}},87033:(te,R,e)=>{"use strict";e.d(R,{b:()=>f});var n=e(62467),a=e(69862),s=e(81160),i=e(17548),r=e(1906),u=e(71393),o=e(90696);let l=100;function g(){return"AQ"+l++}function f(p,c,x){const v={...o.CU,...c.annotations},m={...v.getDefaultQuery?.(),...x},y=v.prepareAnnotation(m);if(!y)return(0,n.of)({});const h=v.prepareQuery(y);if(!h)return(0,n.of)({});const d=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,E=i.calculateInterval(p.range,d,c.interval),b={__interval:{text:E.interval,value:E.interval},__interval_ms:{text:E.intervalMs.toString(),value:E.intervalMs},__annotation:{text:y.name,value:y}},D={startTime:Date.now(),requestId:g(),range:p.range,maxDataPoints:d,scopedVars:b,...E,app:r.Jk.Dashboard,timezone:p.dashboard.timezone,targets:[{...h,refId:"Anno"}]};return(0,u.BN)(c,D).pipe((0,a.Z)(C=>{const P=C?.series.length?C.series:C.annotations;return P?.length?v.processEvents(y,P).pipe((0,s.T)(M=>({panelData:C,events:M}))):(0,n.of)({panelData:C,events:[]})}))}},90696:(te,R,e)=>{"use strict";e.d(R,{CU:()=>p,E7:()=>E,JX:()=>d,kj:()=>x});var n=e(2543),a=e.n(n),s=e(62467),i=e(69862),r=e(81160),u=e(96702),o=e(95004),l=e(16515),g=e(88907),f=e(65642);const p={prepareAnnotation:b=>{if((0,n.isString)(b?.query)){const{query:D,...C}=b;return{...C,target:{refId:"annotation_query",query:D},mappings:{}}}return b},prepareQuery:b=>b.target,processEvents:(b,D)=>y(D,b.mappings)};function c(){return b=>b.pipe((0,i.Z)(D=>{if(!D?.length)return(0,s.of)(void 0);if(D.length===1)return(0,s.of)(D[0]);const C={interpolate:P=>P};return(0,s.of)(D).pipe(u.c.mergeTransformer.operator({},C),(0,r.T)(P=>P[0]))}))}const x=[{key:"time",field:b=>b.fields.find(D=>D.type===o.PU.time),placeholder:"time, or the first time field"},{key:"timeEnd",label:"end time",help:"When this field is defined, the annotation will be treated as a range"},{key:"title"},{key:"text",field:b=>b.fields.find(D=>D.type===o.PU.string),placeholder:"text, or the first text field"},{key:"tags",split:",",help:"The results will be split on comma (,)"},{key:"id"}],v=[{key:"color"},{key:"isRegion"},{key:"source"}],m=[...f.$W.publicDashboardAccessToken?v:[],...x,{key:"userId"},{key:"login"},{key:"email"},{key:"prevState"},{key:"newState"},{key:"data"},{key:"panelId"},{key:"alertId"},{key:"dashboardId"},{key:"dashboardUID"}];function y(b,D){return(0,s.of)(b).pipe(c(),(0,r.T)(C=>{if(!C?.length)return[];let P=!1,M=!1;const O={};for(const W of C.fields){const B=(0,l.Ct)(W,C);O[B.toLowerCase()]=W}D||(D={});const j=[];for(const W of m){const B=D[W.key]||{};if(B.source===g.V.Skip)continue;const S={key:W.key,split:W.split};if(B.source===g.V.Text)S.text=B.value;else{const _=(B.value||W.key).toLowerCase();S.field=O[_],!S.field&&W.field&&(S.field=W.field(C))}(S.field||S.text)&&(j.push(S),S.key==="time"?P=!0:S.key==="text"&&(M=!0))}if(!P||!M)return console.error("Cannot process annotation fields. No time or text present."),[];const U=[];for(let W=0;W<C.length;W++){const B={type:"default",color:"red"};for(const S of j){let _;if(S.text)_=S.text;else if(S.field&&(_=S.field.values[W],_!==void 0&&S.regex)){const K=S.regex.exec(_);K&&(_=K[1]?K[1]:K[0])}_!=null&&(S.split&&typeof _=="string"&&(_=_.split(",")),B[S.key]=_)}U.push(B)}return U}))}const h=["loki","elasticsearch","grafana-opensearch-datasource"];function d(b){const{type:D}=b;return!(D==="datasource"||h.includes(D))}function E(b){const{type:D}=b;return h.includes(D)}},54115:(te,R,e)=>{"use strict";e.d(R,{H1:()=>y,ws:()=>v});var n=e(16126),a=e(81160),s=e(69862),i=e(65474),r=e(33160),u=e(66847),o=e(38619),l=e(68143),g=e(33184),f=e(43173),p=e(73427),c=e(85618),x=e(75735);class v{constructor(E,b=!0){this.parseListOptionsSelector=h;const D=b?`namespaces/${(0,c.Ge)()}/`:"";this.gvr=E,this.url=`/apis/${E.group}/${E.version}/${D}${E.resource}`}async get(E){return(0,l.AI)().get(`${this.url}/${E}`)}watch(E){const b={watch:!0,labelSelector:this.parseListOptionsSelector(E?.labelSelector),fieldSelector:this.parseListOptionsSelector(E?.fieldSelector)};if(E?.name&&(b.fieldSelector=`metadata.name=${E.name}`),this.gvr.group==="provisioning.grafana.app"){let C="";return b.fieldSelector?.startsWith("metadata.name=")&&(C=b.fieldSelector.substring(13)),(0,g.oF)().getStream({scope:o.qD.Watch,namespace:this.gvr.group,path:`${this.gvr.version}/${this.gvr.resource}${C}/${f.$.bootData.user.uid}`}).pipe((0,n.p)(P=>(0,o.Z7)(P)),(0,a.T)(P=>P.message))}const D=new TextDecoder;return(0,l.AI)().chunked({url:this.url,params:b,method:"GET"}).pipe((0,n.p)(C=>C.ok&&C.data instanceof Uint8Array),(0,a.T)(C=>D.decode(C.data).split(`
`)),(0,s.Z)(C=>(0,i.H)(C)),(0,n.p)(C=>C.length>0),(0,a.T)(C=>{try{return JSON.parse(C)}catch(P){return console.warn("Invalid JSON in watch stream:",P,C),null}}),(0,n.p)(C=>C!==null),(0,r.L)({count:3,delay:1e3}),(0,u.W)(C=>{throw console.error("Watch stream error:",C),C}))}async subresource(E,b,D){return(0,l.AI)().get(`${this.url}/${E}/${b}`,D)}async list(E){const b=E||{};return b.labelSelector=this.parseListOptionsSelector(b?.labelSelector),b.fieldSelector=this.parseListOptionsSelector(b?.fieldSelector),(0,l.AI)().get(this.url,E)}async create(E,b){if(!E.metadata.name&&!E.metadata.generateName){const D=p.TP.user.login,C=D?D.replace(/[^a-zA-Z]/g,"").slice(0,2):"";E.metadata.generateName=C||"g"}return m(E.metadata),(0,l.AI)().post(this.url,E,{params:b})}async update(E,b){m(E.metadata);const D=`${this.url}/${E.metadata.name}`;return(0,l.AI)().put(D,E,{params:b})}async delete(E,b){return(0,l.AI)().delete(`${this.url}/${E}`,void 0,{showSuccessAlert:b})}}function m(d){d.annotations||(d.annotations={}),d.annotations[x.Pd]=f.$.buildInfo.versionString}class y{async get(E){if(this.apiVersions)return this.apiVersions[E];const b=await(0,l.AI)().get("/apis"),D={};return b.groups.forEach(C=>{if(C.name.includes("datasource.grafana.app")){const P=C.name.split(".")[0];D[P]=C.preferredVersion.version,P.endsWith("-datasource")||(P.includes("-")?D[`${P}-datasource`]=C.preferredVersion.version:D[`grafana-${P}-datasource`]=C.preferredVersion.version)}}),this.apiVersions=D,D[E]}}const h=d=>Array.isArray(d)?d.map(E=>{const b=String(E.key),D=E.operator;switch(D){case"=":case"!=":return`${b}${D}${E.value}`;case"in":case"notin":return`${b} ${D} (${E.value.join(",")})`;case"":case"!":return`${D}${b}`;default:return null}}).filter(Boolean).join(","):d},66402:(te,R,e)=>{"use strict";e.d(R,{F:()=>s,N:()=>a});function n(i){return i!==null&&typeof i=="object"}function a(i){if(!n(i))return!1;const r=i.metadata;return n(r)?typeof i.apiVersion=="string"&&typeof i.kind=="string"&&typeof r.name=="string"&&typeof r.resourceVersion=="string"&&typeof r.creationTimestamp=="string"&&n(i.spec):!1}function s(i){if(!n(i))return!1;const r=i.metadata;return n(r)?typeof r.resourceVersion=="string"&&Array.isArray(i.items):!1}},75735:(te,R,e)=>{"use strict";e.d(R,{AI:()=>v,D1:()=>b,Jw:()=>l,LH:()=>o,Ms:()=>g,Pd:()=>x,Qu:()=>s,Sf:()=>u,UL:()=>h,Y5:()=>D,Y_:()=>f,ew:()=>i,fY:()=>r,hX:()=>m,hc:()=>n,hm:()=>d,qw:()=>y,w2:()=>E,xU:()=>a});const n="grafana.app/createdBy",a="grafana.app/updatedTimestamp",s="grafana.app/updatedBy",i="grafana.app/folder",r="grafana.app/message";var u=(C=>(C.Repo="repo",C.Terraform="terraform",C.Kubectl="kubectl",C.Plugin="plugin",C))(u||{});const o="grafana.app/managedBy",l="grafana.app/managerId",g="grafana.app/managerAllowsEdits",f="grafana.app/sourcePath",p="grafana.app/sourceChecksum",c="grafana.app/sourceTimestamp",x="grafana.app/saved-from-ui",v="grafana.app/grant-permissions",m="grafana.app/slug",y="grafana.app/dashboard-is-snapshot",h="grafana.app/dashboard-snapshot-original-url",d="grafana.app/dashboard-gnet-id",E="grafana.app/folderTitle",b="grafana.app/folderUrl",D="grafana.app/deprecatedInternalID"},69874:(te,R,e)=>{"use strict";e.d(R,{getAuthProviderStatus:()=>p,getRegisteredAuthProviders:()=>l,initAuthConfig:()=>c});var n=e(65642),a=e(73427),s=e(83873),i=e(11257);const r=[],u={};function o(v,m){r.find(y=>y.id===v.id)||(r.push(v),m&&(u[v.id]=m))}function l(){return r}function g(v){return r.find(m=>m.id===v)}function f(v){const m=[];for(const[y,h]of Object.entries(v)){const d=r.find(E=>`auth.${E.id}`===y);if(d){const E={...h,providerId:d.id,displayName:h.name||d.displayName};m.push(E)}}return m}async function p(v){if(u[v]){const m=u[v];return m()}return{configured:!1,enabled:!1}}function c(){if(n.Ay.featureToggles.ssoSettingsLDAP)return;o({id:"ldap",type:"LDAP",protocol:"LDAP",displayName:"LDAP",configPath:"ldap"},x)}async function x(){if(a.TP.hasPermission(i.w.SettingsRead)){const m=(await(0,s.AI)().get("/api/admin/settings"))["auth.ldap"]||{};return{configured:m.enabled==="true",enabled:m.enabled==="true",hide:m.enabled!=="true"}}return{configured:!1,enabled:!1}}},21875:(te,R,e)=>{"use strict";e.d(R,{Ay:()=>v,MH:()=>o,Nh:()=>l,Oy:()=>c,SH:()=>g,TO:()=>r,jA:()=>i,sr:()=>u});var n=e(65307);const a={settings:{},providerStatuses:{},isLoading:!1,providers:[]},s=(0,n.Z0)({name:"authConfig",initialState:a,reducers:{settingsUpdated:(m,y)=>({...m,settings:y.payload}),providerStatusesLoaded:(m,y)=>({...m,providerStatuses:y.payload}),loadingBegin:m=>({...m,isLoading:!0}),loadingEnd:m=>({...m,isLoading:!1}),setError:(m,y)=>({...m,updateError:y.payload}),resetError:m=>({...m,updateError:void 0}),setWarning:(m,y)=>({...m,warning:y.payload}),resetWarning:m=>({...m,warning:void 0}),providersLoaded:(m,y)=>({...m,providers:y.payload})}}),{settingsUpdated:i,providerStatusesLoaded:r,loadingBegin:u,loadingEnd:o,setError:l,resetError:g,setWarning:f,resetWarning:p,providersLoaded:c}=s.actions,v={authConfig:s.reducer}},18346:(te,R,e)=>{"use strict";e.d(R,{cU:()=>C,vZ:()=>P,Ko:()=>M,uz:()=>O,G2:()=>j,kH:()=>U,CE:()=>A,aF:()=>B,wt:()=>S,Vc:()=>_,vR:()=>L,e8:()=>K,iB:()=>T});var n=e(75816),a=e(28105),s=e(32899),i=e(92138),r=e(92745),u=e(68143),o=e(43173),l=e(36490),g=e(87161),f=e(73892),p=e(45229),c=e(73427),x=e(13956),v=e(60171),m=e(79718),y=e(8535),h=e(44220),d=e(75735);function E(N){return("meta"in N?N.meta.k8s?.annotations:N.metadata.annotations)?.[d.LH]===d.Sf.Repo}function b(N){return N.metadata.annotations?.[d.LH]===d.Sf.Repo}var D=e(27044);const C=(0,n.xP)({tagTypes:["getFolder"],reducerPath:"browseDashboardsAPI",baseQuery:(0,f.W)({baseURL:"/api"}),endpoints:N=>({listFolders:N.query({providesTags:V=>V&&V.length>0?V.map(z=>({type:"getFolder",id:z.uid})):[{type:"getFolder",id:"EMPTY_RESULT"}],query:({parentUid:V,limit:z,page:w,permission:H})=>({url:"/folders",params:{parentUid:V,limit:z,page:w,permission:H}})}),getFolder:N.query({providesTags:(V,z,w)=>[{type:"getFolder",id:w}],query:V=>({url:`/folders/${V}`,params:{accesscontrol:!0}})}),newFolder:N.mutation({invalidatesTags:["getFolder"],query:({title:V,parentUid:z})=>({method:"POST",url:"/folders",body:{title:V,parentUid:z}}),onQueryStarted:({parentUid:V},{queryFulfilled:z,dispatch:w})=>{z.then(async({data:H})=>{await c.TP.fetchUserPermissions(),w((0,h.bw)({parentUID:V,pageSize:D.md}))})}}),saveFolder:N.mutation({invalidatesTags:["getFolder"],query:({uid:V,title:z,version:w})=>({method:"PUT",url:`/folders/${V}`,body:{title:z,version:w}}),onQueryStarted:({parentUid:V},{queryFulfilled:z,dispatch:w})=>{z.then(()=>{w((0,h.bw)({parentUID:V,pageSize:D.md}))})}}),moveFolder:N.mutation({invalidatesTags:["getFolder"],query:({folder:V,destinationUID:z})=>({url:`/folders/${V.uid}/move`,method:"POST",body:{parentUID:z}}),onQueryStarted:({folder:V,destinationUID:z},{queryFulfilled:w,dispatch:H})=>{const{parentUid:Q}=V;w.then(()=>{H((0,h.bw)({parentUID:Q,pageSize:D.md})),H((0,h.bw)({parentUID:z,pageSize:D.md}))})}}),deleteFolder:N.mutation({query:({uid:V})=>({url:`/folders/${V}`,method:"DELETE",params:{forceDeleteRules:!1}}),onQueryStarted:({parentUid:V},{queryFulfilled:z,dispatch:w})=>{z.then(()=>{w((0,h.bw)({parentUID:V,pageSize:D.md}))})}}),getAffectedItems:N.query({keepUnusedDataFor:0,queryFn:async V=>{const w=Object.keys(V.folder).filter(Z=>V.folder[Z]).map(Z=>(0,u.AI)().get(`/api/folders/${Z}/counts`)),H=await Promise.all(w),Q={folder:Object.values(V.folder).filter(a.zz).length,dashboard:Object.values(V.dashboard).filter(a.zz).length,libraryPanel:0,alertRule:0};for(const Z of H)Q.folder+=Z.folder??0,Q.dashboard+=Z.dashboard,Q.alertRule+=Z.alertrule,Q.libraryPanel+=Z.librarypanel;return{data:Q}}}),moveItems:N.mutation({invalidatesTags:["getFolder"],queryFn:async({selectedItems:V,destinationUID:z},w,H,Q)=>{const Z=Object.keys(V.dashboard).filter(X=>V.dashboard[X]),Y=Object.keys(V.folder).filter(X=>V.folder[X]);for(const X of Y){if(o.$.featureToggles.provisioning){const I=await(0,y.JD)(g.Z.endpoints.getFolder.initiate({name:X}));if(b(I.data)){p.A.publish({type:s.r1.alertWarning.name,payload:["Cannot move provisioned folder"]});continue}}await Q({url:`/folders/${X}/move`,method:"POST",body:{parentUID:z}})}for(const X of Z){const I=await(0,x.n)().getDashboardDTO(X),J=(0,v.HG)(I)?I.spec:I.dashboard,ee=(0,v.HG)(I)?I.metadata:void 0;if(o.$.featureToggles.provisioning&&E(I)){p.A.publish({type:s.r1.alertWarning.name,payload:["Cannot move provisioned dashboard"]});continue}await(0,x.n)().saveDashboard({dashboard:J,folderUid:z,overwrite:!1,message:"",k8s:ee})}return{data:void 0}},onQueryStarted:({destinationUID:V,selectedItems:z},{queryFulfilled:w,dispatch:H})=>{const Q=Object.keys(z.dashboard).filter(Y=>z.dashboard[Y]),Z=Object.keys(z.folder).filter(Y=>z.folder[Y]);w.then(()=>{H((0,h.bw)({parentUID:V,pageSize:D.md})),H((0,h.Zw)([...Z,...Q]))})}}),deleteItems:N.mutation({invalidatesTags:["getFolder"],queryFn:async({selectedItems:V},z,w,H)=>{const Q=Object.keys(V.dashboard).filter(Y=>V.dashboard[Y]),Z=Object.keys(V.folder).filter(Y=>V.folder[Y]);for(const Y of Z){if(o.$.featureToggles.provisioning){const X=await(0,y.JD)(g.Z.endpoints.getFolder.initiate({name:Y}));if(b(X.data)){p.A.publish({type:s.r1.alertWarning.name,payload:["Cannot delete provisioned folder. To remove it, delete it from the repository and synchronise to apply the changes."]});continue}}await H({url:`/folders/${Y}`,method:"DELETE",params:{forceDeleteRules:!1}})}for(const Y of Q){if(o.$.featureToggles.provisioning){const X=await(0,x.n)().getDashboardDTO(Y);if(E(X)){p.A.publish({type:s.r1.alertWarning.name,payload:["Cannot delete provisioned dashboard. To remove it, delete it from the repository and synchronise to apply the changes."]});continue}}await(0,x.n)().deleteDashboard(Y,!0),o.$.featureToggles.kubernetesDashboards&&p.A.publish({type:s.r1.alertSuccess.name,payload:["Dashboard deleted"]})}return{data:void 0}},onQueryStarted:({selectedItems:V},{queryFulfilled:z,dispatch:w})=>{const H=Object.keys(V.dashboard).filter(Z=>V.dashboard[Z]),Q=Object.keys(V.folder).filter(Z=>V.folder[Z]);z.then(()=>{w((0,h.Zw)([...Q,...H]))})}}),saveDashboard:N.mutation({queryFn:async V=>{try{if((0,v.mi)(V))return{data:await(0,x.n)("v2").saveDashboard(V)};if((0,v.rL)(V))return{data:await(0,x.n)().saveDashboard(V)};throw new Error("Invalid dashboard version")}catch(z){return(0,f.s)(z)}},onQueryStarted:({folderUid:V},{queryFulfilled:z,dispatch:w})=>{m.t.ignoreNextSave(),z.then(async()=>{await c.TP.fetchUserPermissions(),w((0,h.bw)({parentUID:V,pageSize:D.md}))})}}),importDashboard:N.mutation({query:({dashboard:V,overwrite:z,inputs:w,folderUid:H})=>({method:"POST",url:"/dashboards/import",body:{dashboard:V,overwrite:z,inputs:w,folderUid:H}}),onQueryStarted:async({dashboard:V,folderUid:z},{queryFulfilled:w,dispatch:H})=>{let Q;if(V.uid)try{const Z=await(0,x.n)().getDashboardDTO(V.uid);Q=(0,v.HG)(Z)?Z.metadata?.name:Z.meta?.folderUid}catch(Z){(0,u.NF)(Z)&&(Z.status!==404?console.error("Error fetching dashboard",Z):Z.isHandled=!0)}w.then(async Z=>{H((0,h.bw)({parentUID:z,pageSize:D.md})),Q&&Q!==z&&H((0,h.bw)({parentUID:Q,pageSize:D.md}));const Y=i.I.stripBaseFromUrl(Z.data.importedUrl);l.Ny.push(Y)})}}),listDeletedDashboards:N.query({queryFn:async()=>{try{return{data:await(0,x.n)().listDeletedDashboards({})}}catch(V){return(0,f.s)(V)}}}),restoreDashboard:N.mutation({queryFn:async({dashboard:V})=>{try{const H=(await(0,x.n)().restoreDashboard(V)).spec.title;return H&&p.A.publish({type:s.r1.alertSuccess.name,payload:[(0,r.t)("browse-dashboards.restore.success","Dashboard {{name}} restored",{name:H})]}),{data:void 0}}catch(z){return(0,f.s)(z)}}})})}),{endpoints:P,useDeleteFolderMutation:M,useDeleteItemsMutation:O,useGetAffectedItemsQuery:j,useGetFolderQuery:U,useLazyGetFolderQuery:W,useMoveFolderMutation:B,useMoveItemsMutation:S,useNewFolderMutation:_,useSaveDashboardMutation:K,useSaveFolderMutation:T,useRestoreDashboardMutation:L,useListDeletedDashboardsQuery:A}=C},27044:(te,R,e)=>{"use strict";e.d(R,{aw:()=>p,md:()=>g,uT:()=>f});var n=e(43173),a=e(68143),s=e(99090),i=e(55860),r=e(93854),u=e(11257),o=e(73427),l=e(62963);const g=50;async function f(c,x,v=1,m=g){if(c&&!n.$.featureToggles.nestedFolders)return[];const y=(0,a.AI)();let h=[];return o.TP.hasPermission(u.w.FoldersRead)&&(h=await y.get("/api/folders",{parentUid:c,page:v,limit:m})),h.map(d=>({kind:"folder",uid:d.uid,title:d.title,parentTitle:x,parentUID:c,managedBy:d.managedBy,url:(0,l.I2)(d.uid)?void 0:(0,l._0)(d.uid)}))}async function p(c,x=1,v=g){const y=await(0,i.S)().search({kind:["dashboard"],query:"*",location:c||"general",from:(x-1)*v,limit:v});return y.view.map(h=>{const d=(0,r.hI)(h,y.view);return d.parentUID===s.TF&&(d.parentUID=void 0),d})}},78059:(te,R,e)=>{"use strict";e.d(R,{x:()=>l});var n=e(74848),a=e(70255),s=e(92745),i=e(34999),r=e(66404),u=e(18346);function o(g,f,p,c){const x=g+f+p+c,v=[];g&&v.push((0,s.t)("browse-dashboards.counts.folder","{{count}} folder",{count:g})),f&&v.push((0,s.t)("browse-dashboards.counts.dashboard","{{count}} dashboard",{count:f})),p&&v.push((0,s.t)("browse-dashboards.counts.libraryPanel","{{count}} library panel",{count:p})),c&&v.push((0,s.t)("browse-dashboards.counts.alertRule","{{count}} alert rule",{count:c}));let m=(0,s.t)("browse-dashboards.counts.total","{{count}} item",{count:x});return v.length>0&&(m+=`: ${v.join(", ")}`),m}const l=({selectedItems:g})=>{const{data:f,isFetching:p,isLoading:c,error:x}=(0,u.G2)(g);return x?(0,n.jsx)(i.F,{severity:"error",title:(0,s.t)("browse-dashboards.descendant-count.title-unable-to-retrieve-descendant-information","Unable to retrieve descendant information")}):(0,n.jsxs)(r.E,{element:"p",color:"secondary",children:[f&&o(f.folder,f.dashboard,f.libraryPanel,f.alertRule),(p||c)&&(0,n.jsx)(a.A,{width:200})]})}},62963:(te,R,e)=>{"use strict";e.d(R,{I2:()=>i,_0:()=>r,eM:()=>s});var n=e(43173),a=e(73427);function s(u,o){return u+o.uid}function i(u){return u===n.$.sharedWithMeFolderUID}function r(u){const{orgId:o}=a.TP.user,g=`${n.$.appSubUrl??""}/dashboards/f/${u}/`;return o?`${g}?orgId=${o}`:g}},44220:(te,R,e)=>{"use strict";e.d(R,{Ii:()=>o,Zw:()=>r,bw:()=>u});var n=e(99090),a=e(52763),s=e(27044),i=e(78034);const r=(0,a.zD)("browseDashboards/refreshParents",async(l,{getState:g,dispatch:f})=>{const{browseDashboards:p}=g(),{rootItems:c,childrenByParentUID:x}=p,v=new Set;for(const m of l){const y=(0,i.R)(c?.items??[],x,m);v.add(y?.parentUID)}for(const m of v)f(u({parentUID:m,pageSize:s.md}))}),u=(0,a.zD)("browseDashboards/refetchChildren",async({parentUID:l,pageSize:g})=>{const f=l===n.TF?void 0:l;let p=1,c="folder",x=await(0,s.uT)(f,void 0,p,g),v=x.length<g;if(c==="folder"&&v){c="dashboard",p=1;const m=await(0,s.aw)(f,p,g);v=m.length<g,x=x.concat(m)}return{children:x,lastPageOfKind:v,page:p,kind:c}}),o=(0,a.zD)("browseDashboards/fetchNextChildrenPage",async({parentUID:l,excludeKinds:g=[],pageSize:f},p)=>{const c=!g.includes("dashboard"),x=l===n.TF?void 0:l,v=p.getState().browseDashboards,m=x?v.childrenByParentUID[x]:v.rootItems;let y=1,h;if(m?m.lastFetchedKind==="dashboard"&&!m.lastKindHasMoreItems?console.warn(`fetchNextChildrenPage called for ${x} but that collection is fully loaded`):m.lastFetchedKind==="folder"&&m.lastKindHasMoreItems?(y=m.lastFetchedPage+1,h="folder"):c&&(y=m.lastFetchedKind==="folder"?1:m.lastFetchedPage+1,h="dashboard"):(y=1,h="folder"),!h)return;let d=h==="folder"?await(0,s.uT)(x,void 0,y,f):await(0,s.aw)(x,y,f),E=d.length<f;if(h==="folder"&&E&&c){h="dashboard",y=1;const b=await(0,s.aw)(x,y,f);E=b.length<f,d=d.concat(b)}return{children:d,lastPageOfKind:E,page:y,kind:h}})},80231:(te,R,e)=>{"use strict";e.d(R,{Am:()=>g,Ms:()=>d,QE:()=>h,V6:()=>E,Zg:()=>D,eC:()=>m,ku:()=>l,q0:()=>y,xK:()=>b});var n=e(96540),a=e(25508),s=e(52763),i=e(27044),r=e(62963),u=e(44220),o=e(78034);const l=P=>P.browseDashboards.rootItems,g=P=>P.browseDashboards.childrenByParentUID,f=P=>P.browseDashboards.openFolders,p=P=>P.browseDashboards.selectedItems,c=(0,a.Mz)(l,g,f,(P,M)=>M,(P,M,O,j)=>C(j,P,M,O)),x=(0,a.Mz)(p,P=>Object.values(P).some(M=>Object.values(M).some(O=>O))),v=(0,a.Mz)(p,g,(P,M)=>{const O={dashboard:{...P.dashboard},folder:{...P.folder}};for(const j of Object.keys(P.folder))if(P.folder[j]){const W=M[j];if(W)for(const B of W.items)B.kind==="dashboard"&&(O.dashboard[B.uid]=!1),B.kind==="folder"&&(O.folder[B.uid]=!1)}return O});function m(P){return(0,s.d4)(M=>(P?M.browseDashboards.childrenByParentUID[P]:M.browseDashboards.rootItems)?"fulfilled":"pending")}function y(P){return(0,s.d4)(M=>c(M,P))}function h(){return(0,s.d4)(P=>x(P))}function d(){return(0,s.d4)(p)}function E(){return(0,s.d4)(P=>P.browseDashboards.childrenByParentUID)}function b(){return(0,s.d4)(P=>v(P))}function D(P=[]){const M=(0,s.wA)(),O=(0,n.useRef)(!1);return(0,n.useCallback)(U=>{if(O.current)return Promise.resolve();O.current=!0;const W=M((0,u.Ii)({parentUID:U,excludeKinds:P,pageSize:i.md}));return W.finally(()=>O.current=!1),W},[M,P])}function C(P,M,O,j,U=0,W=[],B=[]){function S(V,z,w){if(W.includes(V.kind)||B.includes(V.uid))return[];const H=C(V.uid,M,O,j,w+1,W,B),Q=!!j[V.uid],Z=O[V.uid]?.items.length===0;Q&&Z&&!W.includes("empty-folder")&&H.push({isOpen:!1,level:w+1,item:{kind:"ui",uiKind:"empty-folder",uid:V.uid+"empty-folder"},parentUID:z});const Y={item:V,parentUID:z,level:w,isOpen:Q},X=[Y,...H];return(0,r.I2)(Y.item.uid)&&X.push({item:{kind:"ui",uiKind:"divider",uid:"shared-with-me-divider"},parentUID:z,level:w+1,isOpen:!1}),X}const _=P&&j[P]||U===0,K=P?O[P]:M;let L=((P?_&&K?.items:K?.items)||[]).flatMap(V=>S(V,P,U));const A=W.includes("dashboard")&&K?.lastFetchedKind==="dashboard";return(U===0&&!K||_&&K&&!(K.isFullyLoaded||A))&&(L=L.concat((0,o.T)(i.md,P,U))),L}},87186:(te,R,e)=>{"use strict";e.d(R,{xN:()=>C,Ay:()=>P,cT:()=>D,wn:()=>E,t$:()=>b});var n={};e.r(n),e.d(n,{clearFolders:()=>c,fetchNextChildrenPageFulfilled:()=>l,refetchChildrenFulfilled:()=>o,setAllSelection:()=>p,setFolderOpenState:()=>g,setItemSelectionState:()=>f});var a=e(65307),s=e(44220),i=e(75735),r=e(62963),u=e(78034);function o(M,O){const{children:j,page:U,kind:W,lastPageOfKind:B}=O.payload,{parentUID:S}=O.meta.arg,_={items:j,lastFetchedKind:W,lastFetchedPage:U,lastKindHasMoreItems:!B,isFullyLoaded:W==="dashboard"&&B};S?M.childrenByParentUID[S]=_:M.rootItems=_}function l(M,O){const j=O.payload;if(!j)return;const{children:U,page:W,kind:B,lastPageOfKind:S}=j,{parentUID:_,excludeKinds:K=[]}=O.meta.arg,A={items:((_?M.childrenByParentUID[_]:M.rootItems)?.items??[]).concat(U),lastFetchedKind:B,lastFetchedPage:W,lastKindHasMoreItems:!S,isFullyLoaded:(K.includes("dashboard")||B==="dashboard")&&S};if(!_){M.rootItems=A;return}if(M.childrenByParentUID[_]=A,M.selectedItems.folder[_])for(const V of U)M.selectedItems[V.kind][V.uid]=!0}function g(M,O){const{folderUID:j,isOpen:U}=O.payload;M.openFolders[j]=U}function f(M,O){const{item:j,isSelected:U}=O.payload;if((0,r.I2)(j.uid)||j.managedBy===i.Sf.Repo)return;function W(B,S){if(M.selectedItems[B][S]=U,B!=="folder")return;let _=M.childrenByParentUID[S];for(const K of _?.items??[])W(K.kind,K.uid)}if(W(j.kind,j.uid),!U){let B=j.parentUID;for(;B;){const S=(0,u.R)(M.rootItems?.items??[],M.childrenByParentUID,B);if(!S)break;M.selectedItems[S.kind][S.uid]=!1,B=S.parentUID}}M.selectedItems.$all=M.rootItems?.items?.every(B=>M.selectedItems[B.kind][B.uid])??!1}function p(M,O){const{isSelected:j,folderUID:U}=O.payload;if(!(U&&(0,r.I2)(U)))if(M.selectedItems.$all=j,j){let B=function(S){if(S&&(0,r.I2)(S))return;const _=S?M.childrenByParentUID[S]:M.rootItems;if(_)for(const K of _.items)(0,r.I2)(K.uid)||K.managedBy===i.Sf.Repo||(M.selectedItems[K.kind][K.uid]=j,K.kind==="folder"&&B(K.uid))};var W=B;B(U)}else for(const B in M.selectedItems){if(!(B==="dashboard"||B==="panel"||B==="folder"))continue;const S=M.selectedItems[B];for(const _ in S)S[_]=j}}function c(M,O){const j=Array.isArray(O.payload)?O.payload:[O.payload];for(const U of j)U?(M.childrenByParentUID[U]=void 0,M.openFolders[U]=!1):M.rootItems=void 0}const{fetchNextChildrenPageFulfilled:x,refetchChildrenFulfilled:v,...m}=n,y={rootItems:void 0,childrenByParentUID:{},openFolders:{},selectedItems:{dashboard:{},folder:{},panel:{},$all:!1}},h=(0,a.Z0)({name:"browseDashboards",initialState:y,reducers:m,extraReducers:M=>{M.addCase(s.Ii.fulfilled,x),M.addCase(s.bw.fulfilled,v)}}),d=h.reducer,{setFolderOpenState:E,setItemSelectionState:b,setAllSelection:D,clearFolders:C}=h.actions,P={browseDashboards:d}},78034:(te,R,e)=>{"use strict";e.d(R,{R:()=>n,T:()=>a});function n(s,i,r){for(const u of s)if(u.uid===r)return u;for(const u in i){const o=i[u];if(o){for(const l of o.items)if(l.uid===r)return l}}}function a(s,i,r){return new Array(s).fill(null).map((u,o)=>({parentUID:i,level:r,isOpen:!1,item:{kind:"ui",uiKind:"pagination-placeholder",uid:`${i}-pagination-${o}`}}))}},26437:(te,R,e)=>{"use strict";e.d(R,{b:()=>a,q:()=>n});const n="connections",a={Base:`/${n}`,DataSources:`/${n}/datasources`,DataSourcesNew:`/${n}/datasources/new`,DataSourcesEdit:`/${n}/datasources/edit/:uid`,DataSourcesDashboards:`/${n}/datasources/edit/:uid/dashboards`,AddNewConnection:`/${n}/add-new-connection`,DataSourcesDetails:`/${n}/datasources/:id`,ConnectDataOutdated:`/${n}/connect-data`,YourConnectionsOutdated:`/${n}/your-connections`}},70191:(te,R,e)=>{"use strict";e.d(R,{k:()=>r});var n=e(60455),a=e.n(n),s=e(79609),i=e(62635);const r=(u,o,l)=>{let g={},f={};if(u.type===s.CC.Regex&&u.expression){const p=new RegExp(u.expression,"gi"),x=(typeof o=="string"?o:(0,i.MA)(o)).matchAll(p);for(const v of x)v.groups?f=v.groups:f[u.mapValue||l]=v[1]||v[0]}else u.type===s.CC.Logfmt&&o!==void 0&&(f=a().parse(o));return Object.keys(f).forEach(p=>{const c=typeof f[p]=="string"?f[p]:(0,i.MA)(f[p]);g[p]={value:c}}),g}},52860:(te,R,e)=>{"use strict";e.d(R,{F0:()=>l,bQ:()=>g,lW:()=>f});var n=e(41053),a=e(75505),s=e(78282),i=e(27963),r=e(6219);const u=({sourceUID:p,...c})=>{const x=(0,s.l)().getInstanceSettings(p),v=c.type==="query"?(0,s.l)().getInstanceSettings(c.targetUID):void 0;if((c?.orgId===void 0||c?.orgId===null||c?.orgId===0)&&r.kb.logWarning("Invalid correlation config: Missing org id."),x&&x?.uid!==void 0&&v?.uid!==void 0&&c.type==="query")return{...c,source:x,target:v};if(x&&x?.uid!==void 0&&v?.uid===void 0&&c.type==="external")return{...c,source:x};r.kb.logWarning("Invalid correlation config: Missing source or target.",{source:JSON.stringify(x),target:JSON.stringify(v)})},o=p=>!!p,l=p=>({...p,correlations:p.correlations.map(u).filter(o)});function g(p){return p.data}const f=()=>{const{backend:p}=(0,i.Il)(),[c,x]=(0,n.A)(b=>(0,a.s)(p.fetch({url:"/api/datasources/correlations",params:{page:b.page},method:"GET",showErrorAlert:!1})).then(g).then(l),[p]),[v,m]=(0,n.A)(({sourceUID:b,...D})=>p.post(`/api/datasources/uid/${b}/correlations`,D).then(C=>{const P=u(C.result);if(P!==void 0)return P;throw new Error("invalid sourceUID")}),[p]),[y,h]=(0,n.A)(({sourceUID:b,uid:D})=>p.delete(`/api/datasources/uid/${b}/correlations/${D}`),[p]),[d,E]=(0,n.A)(({sourceUID:b,uid:D,...C})=>p.patch(`/api/datasources/uid/${b}/correlations/${D}`,C).then(P=>{const M=u(P.result);if(M!==void 0)return M;throw new Error("invalid sourceUID")}),[p]);return{create:{execute:m,...v},update:{execute:E,...d},get:{execute:x,...c},remove:{execute:h,...y}}}},6219:(te,R,e)=>{"use strict";e.d(R,{$q:()=>v,J6:()=>x,cA:()=>f,kb:()=>h,tZ:()=>y});var n=e(75505),a=e(79609),s=e(43173),i=e(68143),r=e(78282),u=e(25992),o=e(44720),l=e(46072),g=e(52860);const f=(d,E,b)=>(d.forEach(D=>{const C=D.refId;if(!C)return;let P=b[C];if(P===void 0&&D.meta?.preferredVisualisationType==="rawPrometheus"){const O=(0,o.a)(C);P=b[O]}const M=E.filter(O=>O.source.uid===P);p(D,c(M,D))}),d),p=(d,E)=>{d.fields.forEach(b=>{b.config.links=b.config.links?.filter(D=>D.origin!==a.x0.Correlations)||[],E.map(D=>{if(D.config.field===b.name){if(D.type==="query"){const C=D.config.target||{};b.config.links.push({internal:{query:{...C,datasource:{uid:D.target.uid}},datasourceUid:D.target.uid,datasourceName:D.target.name},url:"",title:D.label||D.target.name,origin:a.x0.Correlations,meta:{transformations:D.config.transformations}})}else if(D.type==="external"){const C=D.config.target;b.config.links.push({url:C.url,title:D.label||"External URL",origin:a.x0.Correlations,meta:{transformations:D.config?.transformations}})}}})})},c=(d,E)=>d.map(b=>{if(b.source.meta?.id==="loki"&&s.$.featureToggles.lokiLogsDataplane===!0&&b.config.field==="Line"){const D=(0,l.Os)(E);D!=null&&D.bodyField.name!==void 0&&(b.config.field=D?.bodyField.name)}return b}),x=async d=>(0,n.s)((0,i.AI)().fetch({url:"/api/datasources/correlations",method:"GET",showErrorAlert:!1,params:{sourceUID:d}})).then(g.bQ).then(g.F0),v=async(d,E)=>(0,i.AI)().post(`/api/datasources/uid/${d}/correlations`,E),m=async d=>d.datasourceInstance?.meta.mixed?await(0,r.l)().get(d.queries[0].datasource):d.datasourceInstance,y=async(d,E)=>Promise.all([m(d),m(E)]).then(b=>b[0]?.name!==void 0&&b[1]?.name!==void 0?`${b[0]?.name} to ${b[1]?.name}`:""),h=(0,u.DW)("features.correlations")},11968:(te,R,e)=>{"use strict";e.d(R,{U:()=>u});var n=e(36674),a=e(29043),s=e(7817),i=e(6262),r=e(65333);function u(o){const l=a.A.getObject(i.us);if(l){console.log("asd",l);const g=new s.G(l.dashboard);for(const f of g.panels){const p=(0,r.tt)(f);o.addPanel(p.state.body)}if(l.dashboard.time){const f=new n.JZ({from:l.dashboard.time.from,to:l.dashboard.time.to}),p=o.state.$timeRange;p&&p.setState({value:f.state.value,from:f.state.from,to:f.state.to})}}a.A.delete(i.us)}},89314:(te,R,e)=>{"use strict";e.d(R,{x:()=>p});var n=e(74848),a=e(96540),s=e(49785),i=e(92745),r=e(37386),u=e(63527),o=e(87105),l=e(77824);function g(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.x6,{i18nKey:"dashboard-scene.branch-validation-error.invalid-branch-name",children:"Invalid branch name."}),(0,n.jsxs)("ul",{style:{padding:"0 20px"},children:[(0,n.jsx)("li",{children:(0,n.jsx)(i.x6,{i18nKey:"dashboard-scene.branch-validation-error.cannot-start-with",children:"It cannot start with '/' or end with '/', '.', or whitespace."})}),(0,n.jsx)("li",{children:(0,n.jsx)(i.x6,{i18nKey:"dashboard-scene.branch-validation-error.it-cannot-contain-or",children:"It cannot contain '//' or '..'."})}),(0,n.jsx)("li",{children:(0,n.jsx)(i.x6,{i18nKey:"dashboard-scene.branch-validation-error.cannot-contain-invalid-characters",children:"It cannot contain invalid characters: '~', '^', ':', '?', '*', '[', '\\\\', or ']'."})}),(0,n.jsx)("li",{children:(0,n.jsx)(i.x6,{i18nKey:"dashboard-scene.branch-validation-error.least-valid-character",children:"It must have at least one valid character."})})]})]})}var f=e(92784);const p=(0,a.memo)(({readOnly:c=!1,workflow:x,workflowOptions:v,isGitHub:m,isNew:y,resourceType:h,hidePath:d=!1})=>{const{control:E,register:b,formState:{errors:D}}=(0,s.xW)(),C=h==="dashboard"?"File path inside the repository (.json or .yaml)":"Folder path inside the repository";return(0,n.jsxs)(n.Fragment,{children:[!d&&(0,n.jsx)(r.D,{noMargin:!0,label:(0,i.t)("provisioned-resource-form.save-or-delete-resource-shared-fields.label-path","Path"),description:(0,i.t)("provisioned-resource-form.save-or-delete-resource-shared-fields.description-inside-repository",C),children:(0,n.jsx)(u.p,{id:"dashboard-path",type:"text",...b("path"),readOnly:!y})}),(0,n.jsx)(r.D,{noMargin:!0,label:(0,i.t)("provisioned-resource-form.save-or-delete-resource-shared-fields.label-comment","Comment"),children:(0,n.jsx)(o.f,{id:"provisioned-resource-form-comment",...b("comment"),disabled:c,placeholder:(0,i.t)("provisioned-resource-form.save-or-delete-resource-shared-fields.comment-placeholder-describe-changes-optional","Add a note to describe your changes (optional)"),rows:5})}),m&&!c&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.D,{noMargin:!0,label:(0,i.t)("provisioned-resource-form.save-or-delete-resource-shared-fields.label-workflow","Workflow"),children:(0,n.jsx)(s.xI,{control:E,name:"workflow",render:({field:{ref:P,...M}})=>(0,n.jsx)(l.z,{id:"provisioned-resource-form-workflow",...M,options:v})})}),x==="branch"&&(0,n.jsx)(r.D,{noMargin:!0,label:(0,i.t)("provisioned-resource-form.save-or-delete-resource-shared-fields.label-branch","Branch"),description:(0,i.t)("provisioned-resource-form.save-or-delete-resource-shared-fields.description-branch-name-in-git-hub","Branch name in GitHub"),invalid:!!D.ref,error:D.ref&&(0,n.jsx)(g,{}),children:(0,n.jsx)(u.p,{id:"provisioned-resource-form-branch",...b("ref",{validate:f.e})})})]})]})})},57558:(te,R,e)=>{"use strict";e.d(R,{p:()=>g});var n=e(92745),a=e(36674),s=e(33143),i=e(55793),r=e(25953),u=e(97335),o=e(92769);function l(p){return p instanceof r.X?"panel":p instanceof u.o?"row":p instanceof o.V?"tab":"element"}class g extends a.Bs{static{this.Component=f}get info(){return(0,n.t)("dashboard.conditional-rendering.root.info","Set rules to control {{type}} visibility by matching any or all rules.",{type:this.getItemType()})}constructor(c){super(c),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this.forEachChild(c=>{c.isActive||this._subs.add(c.activate())})}evaluate(){return this.state.rootGroup.evaluate()}notifyChange(){this.parent?.forceRender(),this.parent?.publishEvent(new s.N4(this),!0)}deleteItem(c){a.jh.getAncestor(c,i.M).removeItem(c.state.key)}serialize(){return this.state.rootGroup.serialize()}getItem(){return this.parent}getItemType(){return l(this.getItem())}static createEmpty(){return new g({rootGroup:i.M.createEmpty()})}}function f({model:p}){const{rootGroup:c}=p.useState();return c.render(!1)}},70903:(te,R,e)=>{"use strict";e.d(R,{G:()=>p});var n=e(74848),a=e(92745),s=e(36674),i=e(41654),r=e(66404),u=e(45967),o=e(30703),l=e(34999),g=e(76319),f=e(57558);class p extends s.Bs{constructor(v){super(v),this.supportedItemTypes=void 0,this.addActivationHandler(()=>this._baseActivationHandler())}_baseActivationHandler(){this.forEachChild(v=>{v.isActive||this._subs.add(v.activate())})}onDelete(){this._getConditionalLogicRoot().deleteItem(this)}render(v=!0){return(0,n.jsx)(c,{model:this,withWrapper:v},this.state.key)}getItem(){return this._getConditionalLogicRoot().getItem()}getItemType(){return this._getConditionalLogicRoot().getItemType()}isItemSupported(){return this.supportedItemTypes?this.supportedItemTypes.includes(this.getItemType()):!0}notifyChange(){this._getConditionalLogicRoot().notifyChange()}setStateAndNotify(v){this.setState(v),this.notifyChange()}_getConditionalLogicRoot(){return s.jh.getAncestor(this,f.p)}}function c({model:x,withWrapper:v}){const m=(0,n.jsx)(x.Component,{model:x},x.state.key);return v?(0,n.jsxs)(i.B,{direction:"column",children:[(0,n.jsxs)(i.B,{direction:"row",gap:1,children:[(0,n.jsx)(r.E,{variant:"bodySmall",children:x.title}),x.info&&(0,n.jsx)(u.m,{content:x.info,children:(0,n.jsx)(o.I,{name:"info-circle"})})]}),(0,n.jsxs)(i.B,{direction:"row",gap:1,justifyContent:"stretch",alignItems:"center",children:[(0,n.jsxs)(i.B,{flex:1,direction:"column",gap:1,children:[m,!x.isItemSupported()&&(0,n.jsx)(l.F,{severity:"error",title:"",children:(0,n.jsx)(a.x6,{i18nKey:"dashboard.conditional-rendering.conditions.shared.unsupported-item-type",children:"This condition is not supported by the element, hence it will be ignored."})})]}),(0,n.jsx)(g.K,{"aria-label":(0,a.t)("dashboard.conditional-rendering.conditions.shared.delete-condition","Delete Condition"),name:"trash-alt",onClick:()=>x.onDelete()})]})]},x.state.key):m}},73816:(te,R,e)=>{"use strict";e.d(R,{t:()=>l});var n=e(74848),a=e(96540),s=e(92745),i=e(36674),r=e(43243),u=e(25953),o=e(70903);class l extends o.G{constructor(p){super(p),this.supportedItemTypes=["panel"],this.addActivationHandler(()=>this._activationHandler())}static{this.Component=g}static{this.serializer={id:"ConditionalRenderingData",name:"Data",deserialize:this.deserialize}}get title(){return(0,s.t)("dashboard.conditional-rendering.conditions.data.label","Query result")}get info(){return(0,s.t)("dashboard.conditional-rendering.conditions.data.info","Show or hide the {{type}} based on query results.",{type:this.getItemType()})}_activationHandler(){if(!this.isItemSupported())return;const p=this.getItem();if(p instanceof u.X){const c=i.jh.getData(p.state.body);if(!c)return;this._subs.add(c.subscribeToState(()=>this.notifyChange()))}}evaluate(){if(!this.isItemSupported())return!0;const p=this._hasData();return this.state.value&&p||!this.state.value&&!p}serialize(){return{kind:"ConditionalRenderingData",spec:{value:this.state.value}}}_hasData(){const p=this.getItem();let c;if(p instanceof u.X&&(c=i.jh.getData(p.state.body).state.data),!c)return!1;const x=c?.series??[];for(let v=0;v<x.length;v++)if(x[v].length>0)return!0;return!1}static deserialize(p){return new l({value:p.spec.value})}static createEmpty(){return new l({value:!0})}}function g({model:f}){const{value:p}=f.useState(),c=(0,a.useMemo)(()=>[{label:(0,s.t)("dashboard.conditional-rendering.conditions.data.enable","Has data"),value:1},{label:(0,s.t)("dashboard.conditional-rendering.conditions.data.disable","No data"),value:0}],[]),x=(0,a.useMemo)(()=>c.find(v=>!!v.value===p)??c[0],[c,p]);return(0,n.jsx)(r.G,{options:c,value:x,onChange:({value:v})=>f.setStateAndNotify({value:!!v})})}},46415:(te,R,e)=>{"use strict";e.d(R,{h:()=>l});var n=e(74848),a=e(92745),s=e(41654),i=e(45967),r=e(30703),u=e(25797),o=e(51156);function l(g){if(!g)return null;const f=(0,a.t)("dashboard.conditional-rendering.root.title","Show / hide rules");return new u.C({title:f,id:"conditional-rendering-options",renderTitle:()=>(0,n.jsxs)(s.B,{direction:"row",gap:1,alignItems:"center",children:[(0,n.jsx)("div",{children:f}),(0,n.jsx)(i.m,{content:g.info,children:(0,n.jsx)(r.I,{name:g.evaluate()?"eye":"eye-slash"})})]}),isOpenDefault:!0}).addItem(new o.v({title:f,render:()=>(0,n.jsx)(g.Component,{model:g})}))}},55793:(te,R,e)=>{"use strict";e.d(R,{M:()=>C});var n=e(74848),a=e(92745),s=e(36674),i=e(41654),r=e(70903),u=e(73816),o=e(96540),l=e(59695);const g=({itemType:M,hasVariables:O,onAdd:j})=>{const U=(0,o.useMemo)(()=>{const W=[{label:(0,a.t)("dashboard.conditional-rendering.conditions.group.add.data","Query result"),value:"data"},{label:(0,a.t)("dashboard.conditional-rendering.conditions.group.add.variable","Template variable"),value:"variable",isDisabled:!O},{label:(0,a.t)("dashboard.conditional-rendering.conditions.group.add.time-range-size","Time range less than"),value:"timeRangeSize"}];return M!=="panel"&&W.shift(),W},[M,O]);return(0,n.jsx)(l.i,{isFullWidth:!0,size:"sm",icon:"plus",variant:"secondary",label:(0,a.t)("dashboard.conditional-rendering.conditions.group.add.button","Add rule"),options:U,onChange:({value:W})=>j(W)})};var f=e(22803),p=e(63142),c=e(37386),x=e(77824);const v=({value:M,onChange:O})=>{const j=(0,p.of)(m),U=(0,o.useMemo)(()=>[{label:(0,a.t)("dashboard.conditional-rendering.conditions.group.condition.all","Match all"),value:"and"},{label:(0,a.t)("dashboard.conditional-rendering.conditions.group.condition.any","Match any"),value:"or"}],[]);return(0,n.jsx)(c.D,{label:(0,a.t)("dashboard.conditional-rendering.conditions.group.condition.label","Match rules"),className:j.container,children:(0,n.jsx)(x.z,{fullWidth:!0,options:U,value:M,onChange:O})})},m=()=>({container:(0,f.css)({margin:0})});var y=e(2543);const h=({itemType:M,value:O,onChange:j})=>{const U=(0,p.of)(d),W=(0,o.useMemo)(()=>[{label:(0,a.t)("dashboard.conditional-rendering.conditions.group.visibility.show","Show"),value:"show"},{label:(0,a.t)("dashboard.conditional-rendering.conditions.group.visibility.hide","Hide"),value:"hide"}],[]);return(0,n.jsx)(c.D,{label:(0,a.t)("dashboard.conditional-rendering.conditions.group.visibility.label","{{type}} visibility",{type:(0,y.capitalize)(M)}),className:U.container,children:(0,n.jsx)(x.z,{fullWidth:!0,options:W,value:O,onChange:j})})},d=()=>({container:(0,f.css)({margin:0})});var E=e(91135),b=e(75904),D=e(84655);class C extends r.G{static{this.Component=P}static{this.serializer={id:"ConditionalRenderingGroup",name:"Group",deserialize:this.deserialize}}get title(){return(0,a.t)("dashboard.conditional-rendering.conditions.group.label","Group")}get info(){}evaluate(){if(this.state.value.length===0)return!0;const O=this.state.condition==="and"?this.state.value.every(j=>j.evaluate()):this.state.value.some(j=>j.evaluate());return this.state.visibility==="show"?O:!O}changeVisibility(O){this.setStateAndNotify({visibility:O})}changeCondition(O){this.setStateAndNotify({condition:O})}addItem(O){const j=O==="data"?u.t.createEmpty():O==="variable"?b.H.createEmpty(s.jh.getVariables(this).state.variables[0].state.name):E.K.createEmpty();this.setState({value:[...this.state.value,j]}),this.isActive&&!j.isActive&&j.activate(),this.notifyChange()}removeItem(O){this.setStateAndNotify({value:this.state.value.filter(j=>j.state.key!==O)})}serialize(){if(this.state.value.some(O=>O instanceof C))throw new Error("ConditionalRenderingGroup cannot contain nested ConditionalRenderingGroups");return{kind:"ConditionalRenderingGroup",spec:{visibility:this.state.visibility,condition:this.state.condition,items:this.state.value.map(O=>O.serialize()).filter(O=>O.kind!=="ConditionalRenderingGroup")}}}static deserialize(O){return new C({condition:O.spec.condition,visibility:O.spec.visibility,value:O.spec.items.map(j=>{const U=D.k.getIfExists(j.kind);if(!U)throw new Error(`No serializer found for conditional rendering kind: ${j.kind}`);return U.deserialize(j)})})}static createEmpty(){return new C({condition:"and",visibility:"show",value:[]})}}function P({model:M}){const{condition:O,visibility:j,value:U}=M.useState(),{variables:W}=s.jh.getVariables(M).useState();return(0,n.jsxs)(i.B,{direction:"column",gap:2,children:[(0,n.jsx)(h,{itemType:M.getItemType(),value:j,onChange:B=>M.changeVisibility(B)}),U.length>1&&(0,n.jsx)(v,{value:O,onChange:B=>M.changeCondition(B)}),U.map(B=>B.render()),(0,n.jsx)(g,{itemType:M.getItemType(),hasVariables:W.length>0,onAdd:B=>M.addItem(B)})]})}},91135:(te,R,e)=>{"use strict";e.d(R,{K:()=>p});var n=e(74848),a=e(22803),s=e(96540),i=e(17548),r=e(92745),u=e(36674),o=e(63142),l=e(37386),g=e(18857),f=e(70903);class p extends f.G{static{this.Component=c}static{this.serializer={id:"ConditionalRenderingTimeRangeSize",name:"Time Range Size",deserialize:this.deserialize}}get title(){return(0,r.t)("dashboard.conditional-rendering.conditions.time-range-size.label","Time range less than")}get info(){return(0,r.t)("dashboard.conditional-rendering.conditions.time-range-size.info","Show or hide the {{type}} if the dashboard time range is shorter than the selected time frame.",{type:this.getItemType()})}constructor(y){super(y),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this._subs.add(u.jh.getTimeRange(this).subscribeToState(()=>this.notifyChange()))}evaluate(){try{if(!v.test(this.state.value))return!0;const y=i.intervalToSeconds(this.state.value),h=u.jh.getTimeRange(this);if(h.state.value.to.unix()-h.state.value.from.unix()<=y)return!0}catch{return!1}return!1}serialize(){return{kind:"ConditionalRenderingTimeRangeSize",spec:{value:this.state.value}}}static deserialize(y){return new p({value:y.spec.value})}static createEmpty(){return new p({value:"7d"})}}function c({model:m}){const{value:y}=m.useState(),[h,d]=(0,s.useState)(v.test(y)),E=(0,o.of)(x);(0,s.useEffect)(()=>d(v.test(y)),[y]);const b=(0,s.useMemo)(()=>[{label:(0,r.t)("dashboard.conditional-rendering.conditions.time-range-size.values.minutes","{{value}} minutes",{value:5}),value:"5m"},{label:(0,r.t)("dashboard.conditional-rendering.conditions.time-range-size.values.minutes","{{value}} minutes",{value:15}),value:"15m"},{label:(0,r.t)("dashboard.conditional-rendering.conditions.time-range-size.values.minutes","{{value}} minutes",{value:30}),value:"30m"},{label:(0,r.t)("dashboard.conditional-rendering.conditions.time-range-size.values.hour","{{value}} hour",{value:1}),value:"1h"},{label:(0,r.t)("dashboard.conditional-rendering.conditions.time-range-size.values.hours","{{value}} hours",{value:3}),value:"3h"},{label:(0,r.t)("dashboard.conditional-rendering.conditions.time-range-size.values.hours","{{value}} hours",{value:6}),value:"6h"},{label:(0,r.t)("dashboard.conditional-rendering.conditions.time-range-size.values.hours","{{value}} hours",{value:12}),value:"12h"},{label:(0,r.t)("dashboard.conditional-rendering.conditions.time-range-size.values.hours","{{value}} hours",{value:24}),value:"24h"},{label:(0,r.t)("dashboard.conditional-rendering.conditions.time-range-size.values.days","{{value}} days",{value:2}),value:"2d"},{label:(0,r.t)("dashboard.conditional-rendering.conditions.time-range-size.values.days","{{value}} days",{value:7}),value:"7d"},{label:(0,r.t)("dashboard.conditional-rendering.conditions.time-range-size.values.days","{{value}} days",{value:30}),value:"30d"},{label:(0,r.t)("dashboard.conditional-rendering.conditions.time-range-size.values.days","{{value}} days",{value:90}),value:"90d"},{label:(0,r.t)("dashboard.conditional-rendering.conditions.time-range-size.values.months","{{value}} months",{value:6}),value:"6M"},{label:(0,r.t)("dashboard.conditional-rendering.conditions.time-range-size.values.year","{{value}} year",{value:1}),value:"1y"},{label:(0,r.t)("dashboard.conditional-rendering.conditions.time-range-size.values.years","{{value}} years",{value:2}),value:"2y"},{label:(0,r.t)("dashboard.conditional-rendering.conditions.time-range-size.values.years","{{value}} years",{value:5}),value:"5y"}],[]),D=(0,s.useMemo)(()=>b.find(C=>C.value===y)?b:[{label:y,value:y},...b],[b,y]);return(0,n.jsx)(l.D,{invalid:!h,error:(0,r.t)("dashboard.conditional-rendering.conditions.time-range-size.invalid-message","Invalid interval"),className:E.container,children:(0,n.jsx)(g.l6,{isClearable:!1,allowCustomValue:!0,onCreateOption:C=>m.setStateAndNotify({value:C}),value:y,options:D,onChange:({value:C})=>m.setStateAndNotify({value:C})})})}const x=()=>({container:(0,a.css)({margin:0})}),v=/^(\d+(?:\.\d+)?)[Mwdhmsy]$/},75904:(te,R,e)=>{"use strict";e.d(R,{H:()=>f});var n=e(74848),a=e(96540),s=e(92745),i=e(36674),r=e(41654),u=e(31286),o=e(43243),l=e(63527),g=e(70903);class f extends g.G{constructor(){super(...arguments),this._variableDependency=new i.Sh(this,{onAnyVariableChanged:x=>{x.state.name===this.state.value.name&&this.notifyChange()}})}static{this.Component=p}static{this.serializer={id:"ConditionalRenderingVariable",name:"Variable",deserialize:this.deserialize}}get title(){return(0,s.t)("dashboard.conditional-rendering.conditions.variable.label","Template variable")}get info(){return(0,s.t)("dashboard.conditional-rendering.conditions.variable.info","Show or hide the {{type}} dynamically based on the variable value.",{type:this.getItemType()})}evaluate(){if(!this.state.value.name)return!0;const x=i.jh.getVariables(this).getByName(this.state.value.name);if(!x)return!1;const v=x.getValue()??"",m=Array.isArray(v)?v.includes(this.state.value.value):v===this.state.value.value;return this.state.value.operator==="!="?!m:m}serialize(){return{kind:"ConditionalRenderingVariable",spec:{variable:this.state.value.name,operator:this.state.value.operator==="="?"equals":"notEquals",value:this.state.value.value}}}static deserialize(x){return new f({value:{name:x.spec.variable,operator:x.spec.operator==="equals"?"=":"!=",value:x.spec.value}})}static createEmpty(x){return new f({value:{name:x,operator:"=",value:""}})}}function p({model:c}){const{value:x}=c.useState(),v=(0,a.useMemo)(()=>i.jh.getVariables(c),[c]),m=(0,a.useMemo)(()=>v.state.variables.map(h=>({value:h.state.name,label:h.state.label??h.state.name})),[v.state.variables]),y=(0,a.useMemo)(()=>[{value:"=",description:(0,s.t)("dashboard.conditional-rendering.conditions.variable.operator.equals","Equals")},{value:"!=",description:(0,s.t)("dashboard.conditional-rendering.conditions.variable.operator.not-equals","Not equals")}],[]);return(0,n.jsxs)(r.B,{direction:"column",gap:.5,children:[(0,n.jsxs)(r.B,{direction:"row",gap:.5,grow:1,children:[(0,n.jsx)(u.a,{flex:1,children:(0,n.jsx)(o.G,{placeholder:(0,s.t)("dashboard.conditional-rendering.conditions.variable.name","Name"),options:m,value:x.name,onChange:h=>c.setStateAndNotify({value:{...x,name:h.value}})})}),(0,n.jsx)(o.G,{width:"auto",minWidth:10,options:y,value:x.operator,onChange:h=>c.setStateAndNotify({value:{...x,operator:h.value}})})]}),(0,n.jsx)(l.p,{placeholder:(0,s.t)("dashboard.conditional-rendering.conditions.variable.value","Value"),value:x.value,onChange:h=>c.setStateAndNotify({value:{...x,value:h.currentTarget.value}})})]})}},84655:(te,R,e)=>{"use strict";e.d(R,{k:()=>u});var n=e(42954),a=e(73816),s=e(55793),i=e(91135),r=e(75904);const u=new n.O(()=>[s.M.serializer,r.H.serializer,a.t.serializer,i.K.serializer])},41116:(te,R,e)=>{"use strict";e.d(R,{H:()=>f});var n=e(74848),a=e(57558),s=e(22803),i=e(92745),r=e(63142),u=e(45967),o=e(30703);const l=()=>{const p=(0,r.of)(g);return(0,n.jsx)("div",{className:p.container,children:(0,n.jsx)(u.m,{content:(0,i.t)("dashboard.conditional-rendering.overlay.tooltip","Element is hidden due to conditional rendering."),children:(0,n.jsx)(o.I,{name:"eye-slash"})})})},g=p=>({container:(0,s.css)({display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",width:"100%",height:"100%",bottom:0,right:0,zIndex:1,[p.transitions.handleMotion("no-preference","reduce")]:{transition:"all 0.2s ease"},"&:before":(0,s.css)({content:'""',opacity:.6,position:"absolute",width:"100%",height:"100%",top:0,left:0,backgroundColor:p.colors.background.canvas,pointerEvents:"none"}),"& > svg":(0,s.css)({height:"48px",width:"48px",maxWidth:"75%",maxHeight:"75%"}),".dashboard-visible-hidden-element:hover > &":(0,s.css)({width:"30px",height:"30px",top:"unset",left:"unset",right:0,bottom:0})})});function f(p){const c=p.useState();if(!("conditionalRendering"in c)||!(c.conditionalRendering instanceof a.p))return[!1,void 0,null];const x=c.conditionalRendering.evaluate()??!0;return[!x,x?void 0:"dashboard-visible-hidden-element",x?null:(0,n.jsx)(l,{})]}},33143:(te,R,e)=>{"use strict";e.d(R,{N4:()=>De,BF:()=>Le,WG:()=>Ve,jO:()=>xe,ck:()=>me,su:()=>ye,cc:()=>ze,wT:()=>he,JU:()=>Ze,dt:()=>nt});var n=e(88544),a=e(68388),s=e(92745),i=e(36674),r=e(72746),u=e(74848),o=e(96540),l=e(51898),g=e(63527),f=e(34999),p=e(89640),c=e(25797),x=e(51156),v=e(31819),m=e(9931),y=e(18615),h=e(8285),d=e(1131),E=e(87308);class b{constructor($e){this._row=$e,this.isEditableDashboardElement=!0}getEditableElementInfo(){return{typeName:(0,s.t)("dashboard.edit-pane.elements.row","Row"),instanceName:i.jh.interpolate(this._row,this._row.state.title,void 0,"text"),icon:"list-ul"}}getOutlineChildren(){return this._row.state.children}useEditPaneOptions(){const $e=this._row,at=(0,o.useMemo)(()=>new c.C({title:(0,s.t)("dashboard.default-layout.row-options.title","Row options"),id:"row-options",isOpenDefault:!0}).addItem(new x.v({title:(0,s.t)("dashboard.default-layout.row-options.form.title","Title"),render:()=>(0,u.jsx)(D,{row:$e})})),[$e]),ct=(0,o.useMemo)(()=>{const ft=(0,h.YQ)($e);return new c.C({title:(0,s.t)("dashboard.default-layout.row-options.repeat.title","Repeat options"),id:"row-repeat-options",isOpenDefault:!0}).addItem(new x.v({title:(0,s.t)("dashboard.default-layout.row-options.repeat.variable.title","Variable"),render:()=>(0,u.jsx)(C,{row:$e,dashboard:ft})}))},[$e]);return[at,ct]}onDelete(){const $e=(0,h.h$)(this._row);$e instanceof d.D&&$e.removeRow(this._row)}}function D({row:Me}){const{title:$e}=Me.useState();return(0,u.jsx)(g.p,{value:$e,onChange:at=>Me.setState({title:at.currentTarget.value})})}function C({row:Me,dashboard:$e}){const{$behaviors:at,children:ct}=Me.useState();let ft=at?.find(Pt=>Pt instanceof E.L);const St=(0,o.useMemo)(()=>ct.reduce((Pt,Dt)=>[...Pt,...i.jh.findDescendents(Dt,i.Eb)],[]),[ct]).some(Pt=>{const Dt=(0,h.un)(Pt);return Dt?.state.datasource?.uid===m.K||Dt?.state.datasource?.uid===y.uv&&Dt?.state.queries.some(Ye=>Ye.datasource?.uid===m.K)});return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(v.U,{sceneContext:$e,repeat:ft?.state.variableName,onChange:Pt=>{Pt?(ft?.removeBehavior(),ft=new E.L({variableName:Pt}),Me.setState({$behaviors:[...Me.state.$behaviors??[],ft]})):ft?.removeBehavior()}}),St?(0,u.jsxs)(f.F,{"data-testid":l.Tp.pages.Dashboard.Rows.Repeated.ConfigSection.warningMessage,severity:"warning",title:"",topSpacing:3,bottomSpacing:0,children:[(0,u.jsx)("p",{children:(0,u.jsxs)(s.x6,{i18nKey:"dashboard.default-layout.row-options.form.repeat-for.warning.text",children:["Panels in this row use the ",{SHARED_DASHBOARD_QUERY:m.K}," data source. These panels will reference the panel in the original row, not the ones in the repeated rows."]})}),(0,u.jsx)(p.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/create-dashboard/#configure-repeating-rows",children:(0,u.jsx)(s.x6,{i18nKey:"dashboard.default-layout.row-options.form.repeat-for.learn-more",children:"Learn more"})})]}):void 0]})}var P=e(95395);function M(Me){return"isEditableDashboardElement"in Me}var O=e(31286),j=e(41654);class U{constructor($e){this.variable=$e,this.isEditableDashboardElement=!0}getEditableElementInfo(){return{typeName:(0,s.t)("dashboard.edit-pane.elements.local-variable","Local variable"),icon:"dollar-alt",instanceName:`\xA0$${this.variable.state.name} = ${this.variable.getValueText()}`,isHidden:!0}}useEditPaneOptions(){const $e=this.variable;return(0,o.useMemo)(()=>{const at=new c.C({title:"",id:"local-variable-options"});return at.addItem(new x.v({title:"",skipField:!0,render:()=>(0,u.jsx)(O.a,{paddingBottom:1,children:(0,u.jsx)(j.B,{children:(0,u.jsxs)(j.B,{children:[(0,u.jsxs)("span",{children:["$",$e.state.name]}),(0,u.jsx)("span",{children:"="}),(0,u.jsx)("span",{children:$e.getValueText()})]})})})})),[at]},[$e])}}var W=e(7389),B=e(36490),S=e(37386),_=e(87105),K=e(45861),T=e(20246),L=e(29),A=e(44741),N=e(21285);function V(Me){return(0,o.useMemo)(()=>new c.C({title:(0,s.t)("dashboard.edit-pane.variable.selection-options.category","Selection options"),id:"selection-options-category",isOpenDefault:!0}).addItem(new x.v({title:(0,s.t)("dashboard.edit-pane.variable.selection-options.multi-value","Multi-value"),render:()=>(0,u.jsx)(z,{variable:Me})})).addItem(new x.v({title:(0,s.t)("dashboard.edit-pane.variable.selection-options.include-all","Include All value"),description:(0,s.t)("dashboard.edit-pane.variable.selection-options.include-all-description","Enables a single option that represent all values"),render:()=>(0,u.jsx)(w,{variable:Me})})).addItem(new x.v({title:(0,s.t)("dashboard.edit-pane.variable.selection-options.custom-all-value","Custom all value"),description:(0,s.t)("dashboard.edit-pane.variable.selection-options.custom-all-value-description","A wildcard regex or other value to represent All"),useShowIf:()=>Me.useState().includeAll??!1,render:()=>(0,u.jsx)(Q,{variable:Me})})).addItem(new x.v({title:(0,s.t)("dashboard.edit-pane.variable.selection-options.allow-custom-values","Allow custom values"),description:(0,s.t)("dashboard.edit-pane.variable.selection-options.allow-custom-values-description","Enables users to enter values"),render:()=>(0,u.jsx)(H,{variable:Me})})),[Me])}function z({variable:Me}){const{isMulti:$e}=Me.useState();return(0,u.jsx)(N.d,{value:$e,onChange:at=>Me.setState({isMulti:at.currentTarget.checked})})}function w({variable:Me}){const{includeAll:$e}=Me.useState();return(0,u.jsx)(N.d,{value:$e,onChange:at=>Me.setState({includeAll:at.currentTarget.checked})})}function H({variable:Me}){const{allowCustomValue:$e}=Me.useState();return(0,u.jsx)(N.d,{value:$e,onChange:at=>Me.setState({allowCustomValue:at.currentTarget.checked})})}function Q({variable:Me}){const{allValue:$e}=Me.useState(),at=(0,o.useRef)(null),ct=(0,o.useCallback)(ft=>{const Et=ft.currentTarget.value;Et!==Me.state.allValue&&(Me.setState({allValue:Et}),Me.hasAllValue()&&Me.publishEvent(new i.oh(Me),!0))},[Me]);return(0,u.jsx)(g.p,{ref:at,defaultValue:$e??"",onBlur:ct})}class Z{constructor($e){this.variable=$e,this.isEditableDashboardElement=!0,this.typeName="Variable"}getEditableElementInfo(){if(this.variable instanceof i.xc)return{typeName:(0,s.t)("dashboard.edit-pane.elements.local-variable","Local variable"),icon:"dollar-alt",instanceName:this.variable.state.name,isHidden:!0};const $e=(0,A.IO)(this.variable.state.type);return{typeName:(0,s.t)("dashboard.edit-pane.elements.variable","{{type}} variable",{type:$e.name}),icon:"dollar-alt",instanceName:this.variable.state.name,isHidden:this.variable.state.hide===W.zL.hideVariable}}useEditPaneOptions($e){const at=this.variable;if(at instanceof i.xc)return ne(at);const ft=[(0,o.useMemo)(()=>new c.C({title:"",id:"variable-options"}).addItem(new x.v({title:"",skipField:!0,render:()=>(0,u.jsx)(Y,{variable:at,isNewElement:$e})})).addItem(new x.v({title:(0,s.t)("dashboard.edit-pane.variable.label","Label"),description:(0,s.t)("dashboard.edit-pane.variable.label-description","Optional display name"),render:()=>(0,u.jsx)(X,{variable:at})})).addItem(new x.v({title:(0,s.t)("dashboard.edit-pane.variable.description","Description"),render:()=>(0,u.jsx)(I,{variable:at})})).addItem(new x.v({title:"",skipField:!0,render:()=>(0,u.jsx)(J,{variable:at})})),[at,$e])],Et=ee(at);return ft.push(Et),at instanceof i.n8&&ft.push(V(at)),ft}onDelete(){const $e=this.variable.parent;$e instanceof i.Pj&&ze.removeVariable({source:$e,removedObject:this.variable})}onChangeName($e){this.variable.setState({name:$e});const at=(0,A.c$)(this.variable,$e);if(at.errorMessage)return at}}function Y({variable:Me,isNewElement:$e}){const{name:at}=Me.useState(),ct=(0,T.z4)({autoFocus:$e}),[ft,Et]=(0,o.useState)(),[St,Pt]=(0,o.useState)(Me.state.name),Dt=mt=>{const zt=(0,A.c$)(Me,mt.currentTarget.value);zt.errorMessage!==ft?Et(zt.errorMessage):Pt(Me.state.name),Me.setState({name:mt.currentTarget.value})},Ye=()=>{ft&&(Me.setState({name:St}),Et(void 0))};return(0,u.jsx)(S.D,{label:(0,s.t)("dashboard.edit-pane.variable.name","Name"),invalid:!!ft,error:ft,children:(0,u.jsx)(g.p,{ref:ct,value:at,onChange:Dt,required:!0,onBlur:Ye,"data-testid":l.Tp.components.PanelEditor.ElementEditPane.variableNameInput})})}function X({variable:Me}){const{label:$e}=Me.useState();return(0,u.jsx)(g.p,{value:$e,onChange:at=>Me.setState({label:at.currentTarget.value}),"data-testid":l.Tp.components.PanelEditor.ElementEditPane.variableLabelInput})}function I({variable:Me}){const{description:$e}=Me.useState();return(0,u.jsx)(_.f,{id:"description-text-area",value:$e??"",placeholder:(0,s.t)("dashboard.edit-pane.variable.description-placeholder","Descriptive text"),onChange:at=>Me.setState({description:at.currentTarget.value})})}function J({variable:Me}){const{hide:$e=W.zL.dontHide}=Me.useState(),at=ct=>{Me.setState({hide:ct})};return(0,u.jsx)(L.D,{hide:$e,type:Me.state.type,onChange:at})}function ee(Me){return(0,o.useMemo)(()=>{const $e=(0,A.IO)(Me.state.type),at=(0,s.t)("dashboard.edit-pane.variable.type-category","{{type}} options",{type:$e.name}),ct=new c.C({title:at,id:"variable-type",isOpenDefault:!0});return $e.getOptions?$e.getOptions(Me).forEach(Et=>ct.addItem(Et)):ct.addItem(new x.v({title:"",skipField:!0,render:()=>(0,u.jsx)(q,{variable:Me})})),ct},[Me])}function q({variable:Me}){const $e=()=>{const at=Me.parent;if(!(at instanceof i.Pj))return;const ct=at.state.variables.indexOf(Me);B.Ny.partial({editview:"variables",editIndex:ct})};return(0,u.jsx)(O.a,{display:"flex",direction:"column",paddingBottom:1,children:(0,u.jsx)(K.$n,{tooltip:(0,s.t)("dashboard.edit-pane.variable.open-editor-tooltip","For more variable options open variable editor"),onClick:$e,size:"sm",fullWidth:!0,children:(0,u.jsx)(s.x6,{i18nKey:"dashboard.edit-pane.variable.open-editor",children:"Open variable editor"})})})}function ne(Me){return(0,o.useMemo)(()=>{const $e=new c.C({title:"",id:"local-variable-options"});return $e.addItem(new x.v({title:"",skipField:!0,render:()=>(0,u.jsx)(O.a,{paddingBottom:1,children:(0,u.jsx)(j.B,{children:(0,u.jsxs)(j.B,{children:[(0,u.jsxs)("span",{children:["$",Me.state.name]}),(0,u.jsx)("span",{children:"="}),(0,u.jsx)("span",{children:Me.getValueText()})]})})})})),[$e]},[Me])}var se=e(22803),oe=e(42941),de=e(63142),fe=e(66404),ae=e(8073);class ce{constructor($e){this.set=$e,this.isEditableDashboardElement=!0,this.typeName="Variable"}getEditableElementInfo(){return{typeName:(0,s.t)("dashboard.edit-pane.elements.variable-set","Variables"),icon:"x",instanceName:(0,s.t)("dashboard.edit-pane.elements.variable-set","Variables")}}getOutlineChildren(){return this.set.state.variables}useEditPaneOptions(){const $e=this.set;return[(0,o.useMemo)(()=>new c.C({title:"",id:"variables"}).addItem(new x.v({title:"",skipField:!0,render:()=>(0,u.jsx)(ie,{set:$e})})),[$e])]}}function ie({set:Me}){const{variables:$e}=Me.useState(),at=(0,de.of)(le),[ct,ft]=(0,oe.A)(!1),Et=Me.parent instanceof r.H$,St=Dt=>{const{editPane:Ye}=(0,h.YQ)(Me).state;Ye.selectObject(Dt,Dt.state.key)},Pt=Dt=>{const{variables:Ye}=Me.state,mt=(0,A.e_)(Dt,Ye),zt=(0,A.No)(Dt,{name:mt});ze.addVariable({source:Me,addedObject:zt}),ft(!1)};return ct?(0,u.jsx)(ve,{onAddVariable:Pt}):(0,u.jsxs)(j.B,{direction:"column",gap:0,children:[$e.map(Dt=>(0,u.jsxs)("div",{className:at.variableItem,onClick:()=>St(Dt),children:[(0,u.jsxs)(fe.E,{children:["$",Dt.state.name]}),(0,u.jsx)(j.B,{direction:"row",gap:1,alignItems:"center",children:(0,u.jsx)(K.$n,{variant:"primary",size:"sm",fill:"outline",children:(0,u.jsx)(s.x6,{i18nKey:"dashboard.edit-pane.variables.select-variable",children:"Select"})})})]},Dt.state.name)),Et&&(0,u.jsx)(O.a,{paddingBottom:1,display:"flex",children:(0,u.jsx)(K.$n,{fullWidth:!0,icon:"plus",size:"sm",variant:"secondary",onClick:ft,"data-testid":l.Tp.components.PanelEditor.ElementEditPane.addVariableButton,children:(0,u.jsx)(s.x6,{i18nKey:"dashboard.edit-pane.variables.add-variable",children:"Add variable"})})})]})}function ve({onAddVariable:Me}){const $e=(0,A.B$)(),at=(0,de.of)(le);return(0,u.jsxs)(j.B,{direction:"column",gap:0,children:[(0,u.jsx)(O.a,{paddingBottom:1,display:"flex",children:(0,u.jsx)(s.x6,{i18nKey:"dashboard.edit-pane.variables.select-type",children:"Choose variable type"})}),$e.map(ct=>(0,u.jsxs)(ae.Z,{isCompact:!0,onClick:()=>Me(ct.value),title:(0,s.t)("dashboard.edit-pane.variables.select-type-card-tooltip","Click to select type"),"data-testid":l.Tp.components.PanelEditor.ElementEditPane.variableType(ct.value),children:[(0,u.jsx)(ae.Z.Heading,{children:ct.label}),(0,u.jsx)(ae.Z.Description,{className:at.cardDescription,children:ct.description})]},ct.value))]})}function le(Me){return{variableItem:(0,se.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",gap:Me.spacing(1),padding:Me.spacing(.5),borderRadius:Me.shape.radius.default,cursor:"pointer",[Me.transitions.handleMotion("no-preference","reduce")]:{transition:Me.transitions.create(["color"],{duration:Me.transitions.duration.short})},"&:last-child":{marginBottom:Me.spacing(2)},button:{visibility:"hidden"},"&:hover":{color:Me.colors.text.link,button:{visibility:"visible"}}}),cardDescription:(0,se.css)({fontSize:Me.typography.bodySmall.fontSize,marginTop:Me.spacing(0)})}}var Ee=e(44802),Re=e(30703);const Oe=({dashboard:Me})=>(0,u.jsx)(K.$n,{size:"sm",variant:"secondary",tooltip:(0,s.t)("dashboard.toolbar.new.edit-dashboard-v2-schema.tooltip","Edit dashboard v2 schema"),icon:(0,u.jsx)(Re.I,{name:"brackets-curly",size:"lg",type:"default"}),onClick:()=>Me.openV2SchemaEditor()});class Se{constructor($e){this.dashboard=$e,this.isEditableDashboardElement=!0}getEditableElementInfo(){return{typeName:(0,s.t)("dashboard.edit-pane.elements.dashboard","Dashboard"),icon:"apps",instanceName:(0,s.t)("dashboard.edit-pane.elements.dashboard","Dashboard")}}getOutlineChildren(){const{$variables:$e,body:at}=this.dashboard.state;return[$e,...at.getOutlineChildren()]}useEditPaneOptions(){const $e=this.dashboard,{body:at}=$e.useState(),ct=(0,o.useMemo)(()=>{const Et="dashboard-title-input",St="dashboard-description-input";return new c.C({title:"",id:"dashboard-options"}).addItem(new x.v({title:(0,s.t)("dashboard.options.title-option","Title"),id:Et,render:()=>(0,u.jsx)(Te,{id:Et,dashboard:$e})})).addItem(new x.v({title:(0,s.t)("dashboard.options.description","Description"),id:St,render:()=>(0,u.jsx)(_e,{id:St,dashboard:$e})}))},[$e]),ft=(0,Ee.W)(at);return[ct,...ft]}renderActions(){return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(Oe,{dashboard:this.dashboard}),(0,u.jsx)(K.$n,{variant:"secondary",size:"sm",onClick:()=>this.dashboard.onOpenSettings(),tooltip:(0,s.t)("dashboard.toolbar.dashboard-settings.tooltip","Dashboard settings"),icon:"sliders-v-alt",iconPlacement:"right",children:(0,u.jsx)(s.x6,{i18nKey:"dashboard.actions.open-settings",children:"Settings"})})]})}}function Te({dashboard:Me,id:$e}){const{title:at}=Me.useState(),ct=(0,o.useRef)("");return(0,u.jsx)(g.p,{id:$e,value:at,onChange:ft=>{Me.setState({title:ft.currentTarget.value})},onFocus:ft=>{ct.current=ft.currentTarget.value},onBlur:ft=>{ct.current===ft.currentTarget.value||Ze(ft)||ze.changeTitle({source:Me,oldTitle:ct.current,newTitle:ft.currentTarget.value})}})}function _e({dashboard:Me,id:$e}){const{description:at}=Me.useState(),ct=(0,o.useRef)("");return(0,u.jsx)(_.f,{id:$e,value:at,onChange:ft=>Me.setState({description:ft.currentTarget.value}),onFocus:ft=>{ct.current=ft.currentTarget.value},onBlur:ft=>{ct.current===ft.currentTarget.value||Ze(ft)||ze.changeDescription({source:Me,oldDescription:ct.current,newDescription:ft.currentTarget.value})}})}var He=e(73427),tt=e(87745),Je=e(22175),Ge=e(25953),je=e(93389),Fe=e(3688),Be=e(1682),Ke=e(24726);class Ue{constructor($e){this._panels=$e,this.isEditableDashboardElement=!0,this.key=(0,Ke.A)()}getEditableElementInfo(){return{typeName:(0,s.t)("dashboard.edit-pane.elements.panels","Panels"),icon:"folder",instanceName:""}}useEditPaneOptions(){return[new c.C({title:"",id:""})]}onConfirmDelete(){He.lE.publish(new tt.bY({title:(0,s.t)("dashboard.edit-pane.elements.multiple-panels","Multiple panels"),text:(0,s.t)("dashboard.edit-pane.elements.multiple-panels-delete-text","Are you sure you want to delete these panels? All queries will be removed."),onConfirm:()=>this.onDelete()}))}onDelete(){this._panels.forEach($e=>{$e.onDelete()})}}class we{constructor($e){this.panel=$e,this.isEditableDashboardElement=!0,this.typeName="Panel"}getEditableElementInfo(){return{typeName:(0,s.t)("dashboard.edit-pane.elements.panel","Panel"),icon:"chart-line",instanceName:i.jh.interpolate(this.panel,this.panel.state.title,void 0,"text")}}useEditPaneOptions($e){const at=this.panel,ct=at.parent,ft=(0,o.useMemo)(()=>new c.C({title:"",id:"panel-options"}).addItem(new x.v({title:"",render:()=>(0,u.jsx)(Xe,{panel:this.panel})})).addItem(new x.v({title:(0,s.t)("dashboard.viz-panel.options.title-option","Title"),id:"PanelFrameTitle",value:at.state.title,popularRank:1,render:St=>(0,u.jsx)(Je.m,{id:St.props.id,panel:at,isNewElement:$e})})).addItem(new x.v({title:(0,s.t)("dashboard.viz-panel.options.description","Description"),id:"description-text-area",value:at.state.description,render:St=>(0,u.jsx)(Je.dF,{id:St.props.id,panel:at})})).addItem(new x.v({title:(0,s.t)("dashboard.viz-panel.options.transparent-background","Transparent background"),id:"transparent-background",render:St=>(0,u.jsx)(Je.R4,{id:St.props.id,panel:at})})),[at,$e]),Et=(0,o.useMemo)(()=>(0,Fe.y)(ct)&&ct.getOptions?ct.getOptions():[],[ct]);return[ft,...Et]}onDelete(){Be.b4.getLayoutManagerFor(this.panel).removePanel?.(this.panel)}onConfirmDelete(){He.lE.publish(new tt.bY({title:(0,s.t)("dashboard.viz-panel.delete-panel-title","Delete panel?"),text:(0,s.t)("dashboard.viz-panel.delete-panel-text","Deleting this panel will also remove all queries. Are you sure you want to continue?"),yesText:(0,s.t)("dashboard.viz-panel.delete-panel-yes","Delete"),onConfirm:()=>{this.onDelete()}}))}onDuplicate(){Be.b4.getLayoutManagerFor(this.panel).duplicatePanel?.(this.panel)}onCopy(){(0,h.YQ)(this.panel).copyPanel(this.panel)}onChangeName($e){(0,Je.dJ)(this.panel,$e)}createMultiSelectedElement($e){return new Ue($e)}scrollIntoView(){(this.panel.parent instanceof Ge.X||this.panel.parent instanceof je.U)&&this.panel.parent.scrollIntoView()}}const Xe=({panel:Me})=>(0,u.jsx)(j.B,{alignItems:"center",width:"100%",children:(0,u.jsx)(K.$n,{onClick:()=>{B.Ny.partial({editPanel:(0,h.Cs)(Me)})},icon:"sliders-v-alt",fullWidth:!0,size:"sm",tooltip:(0,s.t)("dashboard.viz-panel.options.configure-button-tooltip","Edit queries and visualization options"),children:(0,u.jsx)(s.x6,{i18nKey:"dashboard.new-panel.configure-button",children:"Configure"})})});function nt(){return(0,n.A)("grafana.dashboards.edit-pane.isCollapsed",!1)}function he(Me){if(Me){if(M(Me))return Me;if(Me instanceof i.Eb)return new we(Me);if(Me instanceof i.tI)return new b(Me);if(Me instanceof r.H$)return new Se(Me);if(Me instanceof i.Pj)return new ce(Me);if(Me instanceof i.xc)return new U(Me);if((0,A.VD)(Me))return new Z(Me)}}class xe extends a.x{static{this.type="new-object-added-to-canvas"}}class me extends a.x{static{this.type="object-removed-from-canvas"}}class ye extends a.x{static{this.type="objects-reordered-on-canvas"}}class De extends a.x{static{this.type="conditional-rendering-changed"}}class Le extends a.x{static{this.type="dashboard-edit-action"}}class Ve extends a.x{static{this.type="dashboard-state-changed"}}const ze={edit(Me){Me.source.publishEvent(new Le(Me),!0)},addElement(Me){const{addedObject:$e,source:at,perform:ct,undo:ft}=Me,Et=he($e);if(!Et)throw new Error("Added object is not an editable element");const St=Et.getEditableElementInfo().typeName;ze.edit({description:(0,s.t)("dashboard.edit-actions.add","Add {{typeName}}",{typeName:St}),addedObject:$e,source:at,perform:ct,undo:ft})},removeElement(Me){const{removedObject:$e,source:at,perform:ct,undo:ft}=Me,Et=he($e);if(!Et)throw new Error("Removed object is not an editable element");const St=Et.getEditableElementInfo().typeName;ze.edit({description:(0,s.t)("dashboard.edit-actions.remove","Remove {{typeName}}",{typeName:St}),removedObject:$e,source:at,perform:ct,undo:ft})},addVariable({source:Me,addedObject:$e}){const at=[...Me.state.variables];ze.addElement({source:Me,addedObject:$e,perform(){Me.setState({variables:[...at,$e]})},undo(){Me.setState({variables:[...at]})}})},removeVariable({source:Me,removedObject:$e}){const at=[...Me.state.variables];ze.removeElement({source:Me,removedObject:$e,perform(){Me.setState({variables:at.filter(ct=>ct!==$e)})},undo(){Me.setState({variables:at})}})},changeTitle({source:Me,oldTitle:$e,newTitle:at}){ze.edit({description:(0,s.t)("dashboard.title.action","Change dashboard title"),source:Me,perform:()=>{Me.setState({title:at})},undo:()=>{Me.setState({title:$e})}})},changeDescription({source:Me,oldDescription:$e,newDescription:at}){ze.edit({description:(0,s.t)("dashboard.description.action","Change dashboard description"),source:Me,perform:()=>{Me.setState({description:at})},undo:()=>{Me.setState({description:$e})}})},moveElement(Me){const{movedObject:$e,source:at,perform:ct,undo:ft}=Me,Et=he($e);if(!Et)throw new Error("Moved object is not an editable element");const St=Et.getEditableElementInfo().typeName;ze.edit({description:(0,s.t)("dashboard.edit-actions.move","Move {{typeName}}",{typeName:St}),movedObject:$e,source:at,perform:ct,undo:ft})}};function Ze(Me){return Me.relatedTarget&&(Me.relatedTarget.id===P.Qk||Me.relatedTarget.id===P.aS)}},34273:(te,R,e)=>{"use strict";e.d(R,{W:()=>s});var n=e(95004);function a(){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r="abcdefghijklmnopqrstuvwxyz",u=i.length,o=new Map;return l=>{const g=o.get(l);if(g!=null)return g;const f=[...l].map(p=>p.toLowerCase()&&p!==p.toUpperCase()?r.charAt(Math.floor(Math.random()*u)):p.toUpperCase()&&p!==p.toUpperCase()?i.charAt(Math.floor(Math.random()*u)):p).join("");return o.set(l,f),f}}function s(i,r){if(!(r.labels||r.names||r.values))return i;const u=new Set(["time","value","exemplar","traceid","id","uid","uuid","__name__","le","name"]),o=a();return i.map(l=>{let{schema:g,data:f}=l;if(g&&f){if(r.labels){for(const p of g.fields)if(p.labels){const c={};for(const[x,v]of Object.entries(p.labels))c[x]=o(v);p.labels=c}}if(r.names)for(const p of g.fields)p.name?.length&&!u.has(p.name.toLowerCase())&&(p.name=o(p.name));r.values&&g.fields.forEach((p,c)=>{if(p.type===n.PU.string&&f){const x=f.values[c].map(v=>o(String(v)));f.values[c]=x}})}return{schema:g,data:f}})}},41644:(te,R,e)=>{"use strict";e.d(R,{m6:()=>U,sP:()=>T});var n=e(92138),a=e(92745),s=e(68143),i=e(36490),r=e(43173),u=e(36674),o=e(64975),l=e(5114),g=e(47797),f=e(60017),p=e(75735),c=e(50803),x=e(95407),v=e(60171),m=e(48600),y=e(22429),h=e(83127),d=e(95710),E=e(6262),b=e(84019),D=e(31119),C=e(65333),P=e(17788),M=e(75570);const O=500,j="loadDashboardScene",U="__grafana_home_uid__";class W extends l.Q{constructor(){super(...arguments),this.cache={}}getCache(){return this.cache}async fetchHomeDashboard(){const A=await(0,s.AI)().get("/api/dashboards/home");if((0,E.U)(A)){const N=n.I.stripBaseFromUrl(A.redirectUri);return i.Ny.replace(N),null}return(0,v.aK)(A.dashboard)&&(A.dashboard=(0,c.Sb)(A.dashboard,{name:"",generation:0,resourceVersion:"0",creationTimestamp:""})),A?.meta&&(A.meta.canSave=!1,A.meta.canShare=!1,A.meta.canStar=!1),A}async loadHomeDashboard(){const A=await this.fetchHomeDashboard();return A?(0,C.wM)(A):null}async loadSnapshot(A){try{const N=await this.loadSnapshotScene(A);this.setState({dashboard:N,isLoading:!1})}catch(N){const V=(0,g.do)(N),z=(0,g.q6)(N),w=(0,g.rE)(N);if(this.setState({isLoading:!1,loadError:{status:V,message:z,messageId:w}}),N instanceof x.P)throw N}}async loadProvisioningDashboard(A,N){const z=new URLSearchParams(window.location.search).get("ref")??void 0,w=`${o.C}/repositories/${A}/files/${N}`;return(0,s.AI)().get(w,z?{ref:z}:void 0).then(H=>{const Q=H.resource.dryRun;return Q?Q.apiVersion.startsWith("dashboard.grafana.app")?this.processDashboardFromProvisioning(A,N,Q,{file:w,ref:z,repo:A}):Promise.reject("unexpected resource type: "+Q.apiVersion):Promise.reject("failed to read provisioned dashboard")})}processDashboardFromProvisioning(A,N,V,z){if(V.apiVersion.split("/")[1]==="v2alpha1")return{...V,kind:"DashboardWithAccessInfo",access:{canStar:!1,isSnapshot:!1,canShare:!1,canDelete:!0,canSave:!0,canEdit:!0}};let w=V.metadata.annotations;return w||(V.metadata.annotations={}),w[p.LH]="repo",w[p.Jw]=A,w[p.Y_]=z.ref?N+"#"+z.ref:N,{meta:{canStar:!1,isSnapshot:!1,canShare:!1,canDelete:!0,canSave:!0,canEdit:!0,k8s:V.metadata,provisioning:z},dashboard:V.spec}}async loadDashboard(A){try{(0,f.j)(j);const N=await this.loadScene(A);if(!N)return;r.$.featureToggles.preserveDashboardStateWhenNavigating&&A.uid&&(0,P.Gq)(N),this.setState({dashboard:N,isLoading:!1});const V=(0,f.z)(j),z=u.jh.getQueryController(N);(0,d.Dd)(N,V?.duration),z?.startProfile("DashboardScene"),A.route!==E.Z4.New&&(0,h.B)({meta:N.state.meta,uid:N.state.uid,title:N.state.title,id:N.state.id})}catch(N){const V=(0,g.do)(N),z=(0,g.q6)(N),w=(0,g.rE)(N);if(this.setState({isLoading:!1,loadError:{status:V,message:z,messageId:w}}),(0,s.NF)(N)||console.error("Error loading dashboard:",N),N instanceof x.P)throw N}}async loadScene(A){if(this.setState({dashboard:void 0,isLoading:!0}),A.route===E.Z4.Home)return await this.loadHomeDashboard();const N=await this.fetchDashboard(A);return N?this.transformResponseToScene(N,A):null}getDashboardFromCache(A){const N=this.dashboardCache;return N&&N.cacheKey===A&&Date.now()-N?.ts<O?N.dashboard:null}clearState(){(0,y.UA)().setCurrent(void 0),this.setState({dashboard:void 0,loadError:void 0,isLoading:!1,panelEditor:void 0})}setDashboardCache(A,N){this.dashboardCache={dashboard:N,ts:Date.now(),cacheKey:A}}clearDashboardCache(){this.dashboardCache=void 0}getSceneFromCache(A){return this.cache[A]}setSceneCache(A,N){this.cache[A]=N}clearSceneCache(){this.cache={}}}class B extends W{transformResponseToScene(A,N){const V=this.getSceneFromCache(N.uid);if(V&&V.state.version===A?.dashboard.version&&V.state.meta.created===A?.meta.created)return V;if(A?.dashboard){const z=(0,C.wM)(A);return N.uid&&this.setSceneCache(N.uid,z),z}throw new Error("Dashboard not found")}async loadSnapshotScene(A){const N=await m.np.loadSnapshot(A);if(N?.dashboard)return(0,C.wM)(N);throw new Error("Snapshot not found")}async fetchDashboard({type:A,slug:N,uid:V,route:z,urlFolderUid:w}){const H=z===E.Z4.Home?U:V,Q=this.getDashboardFromCache(H);if(Q)return Q;let Z;try{switch(z){case E.Z4.Home:const Y=await this.fetchHomeDashboard();if(!Y)return null;Z=Y;break;case E.Z4.New:Z=await(0,b.X)(w);break;case E.Z4.Provisioning:return this.loadProvisioningDashboard(N||"",V);case E.Z4.Public:return await m.np.loadDashboard("public","",V);default:Z=await m.np.loadDashboard(A||"db",N||"",V),z===E.Z4.Embedded&&(Z.meta.isEmbedded=!0)}if(Z.meta.url&&z===E.Z4.Normal){const Y=n.I.stripBaseFromUrl(Z.meta.url),X=i.Ny.getLocation().pathname;Y!==X&&(i.Ny.replace({...i.Ny.getLocation(),pathname:Y}),console.log("not correct url correcting",Y,X))}Z.meta.folderUid&&await(0,M.Q)(Z.meta.folderUid),this.setDashboardCache(H,Z)}catch(Y){if((0,s.NF)(Y)&&Y.cancelled)return null;throw Y}return Z}async reloadDashboard(A){const N=this.state.dashboard;if(!N||!N.state.uid)return;const V=N.state.uid;try{this.setState({isLoading:!0});const z=await m.np.loadDashboard("db",N.state.meta.slug,V,A),w=this.getSceneFromCache(V);if(w&&w.state.version===z?.dashboard.version&&w.state.version===this.state.dashboard?.state.version){this.setState({isLoading:!1});return}if(!z?.dashboard){this.setState({isLoading:!1,loadError:{status:404,message:(0,a.t)("dashboard-scene.dashboard-scene-page-state-manager.message.dashboard-not-found","Dashboard not found")}});return}const H=(0,C.wM)(z);r.$.featureToggles.preserveDashboardStateWhenNavigating&&V&&(0,P.Gq)(H),this.setSceneCache(V,H),this.setState({dashboard:H,isLoading:!1})}catch(z){const w=(0,g.do)(z),H=(0,g.q6)(z);if(this.setState({isLoading:!1,loadError:{message:H,status:w}}),z instanceof x.P)throw z}}}class S extends W{constructor(){super(...arguments),this.dashboardLoader=new m.t0}async loadSnapshotScene(A){const N=await this.dashboardLoader.loadSnapshot(A);if(N?.spec)return(0,D.dj)(N);throw new Error("Snapshot not found")}transformResponseToScene(A,N){const V=this.getSceneFromCache(N.uid);if(V&&V.state.version===A?.metadata.generation)return V;if(A){const z=(0,D.dj)(A);return N.uid&&this.setSceneCache(N.uid,z),z}throw new Error("Dashboard not found")}async fetchDashboard({type:A,slug:N,uid:V,route:z,urlFolderUid:w}){const H=z===E.Z4.Home?U:V,Q=this.getDashboardFromCache(H);if(Q)return Q;let Z;try{switch(z){case E.Z4.New:Z=await(0,b.V)(w);break;case E.Z4.Provisioning:return await this.loadProvisioningDashboard(N||"",V);case E.Z4.Public:return await this.dashboardLoader.loadDashboard("public","",V);default:if(Z=await this.dashboardLoader.loadDashboard(A||"db",N||"",V),z===E.Z4.Embedded)throw new Error("Method not implemented.")}if(Z.access.url&&z===E.Z4.Normal){const Y=n.I.stripBaseFromUrl(Z.access.url),X=i.Ny.getLocation().pathname;Y!==X&&(i.Ny.replace({...i.Ny.getLocation(),pathname:Y}),console.log("not correct url correcting",Y,X))}Z.metadata.annotations?.[p.ew]&&await(0,M.Q)(Z.metadata.annotations?.[p.ew]),this.setDashboardCache(H,Z)}catch(Y){if((0,s.NF)(Y)&&Y.cancelled)return null;throw Y}return Z}async reloadDashboard(A){const N=this.state.dashboard;if(!N||!N.state.uid)return;const V=N.state.uid;try{this.setState({isLoading:!0});const z=await this.dashboardLoader.loadDashboard("db",N.state.meta.slug,V,A),w=this.getSceneFromCache(V);if(w&&w.state.version===z?.metadata.generation&&w.state.version===this.state.dashboard?.state.version){this.setState({isLoading:!1});return}if(!z?.spec){this.setState({isLoading:!1,loadError:{status:404,message:(0,a.t)("dashboard-scene.dashboard-scene-page-state-manager-v2.message.dashboard-not-found","Dashboard not found")}});return}const H=(0,D.dj)(z);r.$.featureToggles.preserveDashboardStateWhenNavigating&&V&&(0,P.Gq)(H),this.setSceneCache(V,H),this.setState({dashboard:H,isLoading:!1})}catch(z){const w=(0,g.do)(z),H=(0,g.q6)(z);if(this.setState({isLoading:!1,loadError:{message:H,status:w}}),z instanceof x.P)throw z}}}class _ extends W{constructor(A){super(A),this.v1Manager=new B(A),this.v2Manager=new S(A),this.activeManager=this.v1Manager}async withVersionHandling(A){try{return await A(this.activeManager)}catch(N){if(N instanceof x.P){const V=N.data.storedVersion==="v2alpha1"?this.v2Manager:this.v1Manager;return this.activeManager=V,await A(V)}else throw N}finally{this.setState(this.activeManager.state)}}async fetchDashboard(A){return this.withVersionHandling(N=>N.fetchDashboard(A))}async reloadDashboard(A){return this.withVersionHandling(N=>N.reloadDashboard.call(this,A))}getDashboardFromCache(A){return this.activeManager.getDashboardFromCache(A)}transformResponseToScene(A,N){return A?(0,v.HG)(A)?(this.activeManager=this.v2Manager,this.v2Manager.transformResponseToScene(A,N)):this.v1Manager.transformResponseToScene(A,N):null}async loadSnapshotScene(A){try{return await this.v1Manager.loadSnapshotScene(A)}catch(N){if(N instanceof x.P&&N.data.storedVersion==="v2alpha1")return await this.v2Manager.loadSnapshotScene(A);throw new Error("Snapshot not found")}}async loadSnapshot(A){return this.withVersionHandling(N=>N.loadSnapshot(A))}clearDashboardCache(){this.v1Manager.clearDashboardCache(),this.v2Manager.clearDashboardCache()}clearSceneCache(){this.v1Manager.clearSceneCache(),this.v2Manager.clearSceneCache(),this.cache={}}getSceneFromCache(A){return this.activeManager.getSceneFromCache(A)}setSceneCache(A,N){this.activeManager.setSceneCache(A,N)}getCache(){return this.activeManager.getCache()}setDashboardCache(A,N){(0,v.HG)(N)?this.v2Manager.setDashboardCache(A,N):this.v1Manager.setDashboardCache(A,N)}async loadDashboard(A){if(A.route===E.Z4.New){const N=r.$.featureToggles.dashboardNewLayouts?"v2":"v1";this.setActiveManager(N)}return this.withVersionHandling(N=>N.loadDashboard.call(this,A))}setActiveManager(A){A==="v1"?this.activeManager=this.v1Manager:this.activeManager=this.v2Manager}resetActiveManager(){this.setActiveManager("v1")}}const K={v1:void 0,v2:void 0,unified:void 0};function T(L){return L==="v1"?(K.v1||(K.v1=new B({})),K.v1):L==="v2"?(K.v2||(K.v2=new S({})),K.v2):(K.unified||(K.unified=new _({})),K.unified)}},75570:(te,R,e)=>{"use strict";e.d(R,{Q:()=>r});var n=e(6890),a=e(83873),s=e(66198),i=e(8535);async function r(u){try{const o=await a.IB.getFolderByUid(u);i.M_.dispatch((0,n.Vz)((0,s.R4)(o)))}catch(o){console.warn("Error fetching parent folder",u,"for dashboard",o)}}},80849:(te,R,e)=>{"use strict";e.d(R,{p:()=>l});var n=e(74848),a=e(51898),s=e(92745),i=e(31286),r=e(41654),u=e(66404),o=e(45861);function l(g){return(0,n.jsx)(i.a,{alignItems:"center",padding:4,children:(0,n.jsxs)(r.B,{direction:"column",alignItems:"center",gap:2,children:[(0,n.jsx)(u.E,{element:"h3",textAlignment:"center",children:(0,n.jsx)(s.x6,{i18nKey:"transformations.empty.add-transformation-header",children:"Start transforming data"})}),(0,n.jsx)(u.E,{element:"p",textAlignment:"center","data-testid":a.Tp.components.Transforms.noTransformationsMessage,children:(0,n.jsxs)(s.x6,{i18nKey:"transformations.empty.add-transformation-body",children:["Transformations allow data to be changed in various ways before your visualization is shown.",(0,n.jsx)("br",{}),"This includes joining data together, renaming fields, making calculations, formatting data for display, and more."]})}),(0,n.jsx)(o.$n,{icon:"plus",variant:"primary",size:"md",onClick:g.onShowPicker,"data-testid":a.Tp.components.Transforms.addTransformationButton,children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.empty-transformations-message.add-transformation",children:"Add transformation"})})]})})}},89451:(te,R,e)=>{"use strict";e.d(R,{L:()=>xt});var n=e(2543),a=e(92745),s=e(36490),i=e(43173),r=e(36674),u=e(68373),o=e(77731),l=e(30124),g=e(33143),f=e(3204),p=e(17862),c=e(29700),x=e(3688),v=e(70030),m=e(8285);class y extends r.Bs{constructor(bt){super({source:bt.source,data:bt.source.resolve().state.data}),this.addActivationHandler(()=>{this._subs.add(this.state.source.resolve().subscribeToState((Mt,Bt)=>{Mt.data!==Bt.data&&this.setState({data:Mt.data})}))})}setContainerWidth(bt){this.state.source.resolve().setContainerWidth?.(bt)}isDataReadyToDisplay(){return this.state.source.resolve().isDataReadyToDisplay?.()??!0}cancelQuery(){this.state.source.resolve().cancelQuery?.()}getResultsStream(){return this.state.source.resolve().getResultsStream()}}var h=e(74848),d=e(22803),E=e(51898),b=e(63142),D=e(54314),C=e(92807),P=e(13941),M=e(32881),O=e(65642),j=e(73427),U=e(54),W=e(52161),B=e(34999),S=e(6975),_=e(60208),K=e(22971),T=e(21764),L=e(77256),A=e(54148),N=e(16817),V=e(83175),z=e(25992),w=e(45861),H=e(74268),Q=e(20437);const Z=({panel:dt,className:bt})=>{const Mt=(0,A.zy)(),{loading:Bt,value:Kt}=(0,N.A)(()=>(0,Q.J6)(dt),[dt]);if(Bt)return(0,h.jsx)(w.$n,{disabled:!0,children:(0,h.jsx)(a.x6,{i18nKey:"dashboard-scene.scenes-new-rule-from-panel-button.new-alert-rule",children:"New alert rule"})});if(!Kt)return(0,h.jsx)(B.F,{severity:"info",title:(0,a.t)("dashboard-scene.scenes-new-rule-from-panel-button.title-no-alerting-capable-query-found","No alerting capable query found"),children:(0,h.jsx)(a.x6,{i18nKey:"dashboard-scene.scenes-new-rule-from-panel-button.body-no-alerting-capable-query-found",children:"Cannot create alerts from this panel because no query to an alerting capable datasource is found."})});const Qt=async()=>{(0,z.fH)(H.le.alertRuleFromPanel);const Zt=await(0,Q.J6)(dt),nn=V.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(Zt),returnTo:Mt.pathname+Mt.search});s.Ny.push(nn)};return(0,h.jsx)(w.$n,{icon:"bell",onClick:Qt,className:bt,"data-testid":"create-alert-rule-button",children:(0,h.jsx)(a.x6,{i18nKey:"dashboard-scene.scenes-new-rule-from-panel-button.new-alert-rule",children:"New alert rule"})})};var Y=(dt=>(dt.Queries="queries",dt.Transformations="transformations",dt.Alert="alert",dt))(Y||{});class X extends r.Bs{constructor(){super(...arguments),this.tabId=Y.Alert}static{this.Component=I}renderTab(bt){return(0,h.jsx)(ee,{model:this,...bt},this.getTabLabel())}getTabLabel(){return(0,a.t)("dashboard-scene.panel-data-alerting-tab.tab-label","Alert")}getDashboardUID(){return this.getDashboard().state.uid}getDashboard(){return(0,m.YQ)(this)}getLegacyPanelId(){return(0,m.Cs)(this.state.panelRef.resolve())}getCanCreateRules(){const bt=(0,U.Wd)("grafana");return i.$.unifiedAlerting&&this.getDashboard().state.meta.canSave&&j.TP.hasPermission(bt.create)}}function I({model:dt}){const bt=(0,b.of)(J),{errors:Mt,loading:Bt,rules:Kt}=(0,T.S)({dashboardUID:dt.getDashboardUID(),panelId:dt.getLegacyPanelId()}),Qt=Mt.length?(0,h.jsx)(B.F,{title:(0,a.t)("dashboard-scene.panel-data-alerting-tab-rendered.alert.title-errors-loading-rules","Errors loading rules"),severity:"error",children:Mt.map((Ln,Yn)=>(0,h.jsx)("div",{children:(0,h.jsxs)(a.x6,{i18nKey:"dashboard-scene.panel-data-alerting-tab-rendered.error-failed-to-load",values:{errorToDisplay:(0,L.JZ)(Ln)},children:["Failed to load Grafana rules state: ","{{errorToDisplay}}"]})},Yn))}):null;if(Bt&&!Kt.length)return(0,h.jsxs)(h.Fragment,{children:[Qt,(0,h.jsx)(S._,{text:(0,a.t)("dashboard-scene.panel-data-alerting-tab-rendered.text-loading-rules","Loading rules...")})]});const Zt=dt.state.panelRef.resolve(),nn=dt.getCanCreateRules();if(Kt.length)return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(K.sF,{rules:Kt}),nn&&(0,h.jsx)(Z,{className:bt.newButton,panel:Zt})]});const kt=!dt.getDashboardUID(),bn=dt.getDashboard();return(0,h.jsxs)("div",{className:bt.noRulesWrapper,children:[!kt&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("p",{children:(0,h.jsx)(a.x6,{i18nKey:"dashboard.panel-edit.alerting-tab.no-rules",children:"There are no alert rules linked to this panel."})}),nn&&(0,h.jsx)(Z,{panel:Zt})]}),kt&&!!bn.state.meta.canSave&&(0,h.jsx)(B.F,{severity:"info",title:(0,a.t)("dashboard-scene.panel-data-alerting-tab-rendered.title-dashboard-not-saved","Dashboard not saved"),children:(0,h.jsx)(a.x6,{i18nKey:"dashboard.panel-edit.alerting-tab.dashboard-not-saved",children:"Dashboard must be saved before alerts can be added."})})]})}const J=dt=>({newButton:(0,d.css)({marginTop:dt.spacing(3)}),noRulesWrapper:(0,d.css)({margin:dt.spacing(2),backgroundColor:dt.colors.background.secondary,padding:dt.spacing(3)})});function ee(dt){const{model:bt}=dt,{rules:Mt}=(0,T.S)({dashboardUID:bt.getDashboardUID(),panelId:bt.getLegacyPanelId(),poll:!1});return(0,h.jsx)(_.o,{label:bt.getTabLabel(),icon:"bell",counter:Mt.length,active:dt.active,onChangeTab:dt.onChangeTab})}var q=e(48480),ne=e(1906),se=e(78282),oe=e(41654),de=e(1404),fe=e(7078),ae=e(29328),ce=e(52900),ie=e(82779),ve=e(23117),le=e(65966),Ee=e(32154),Re=e(57204),Oe=e(73601),Se=e(18615),Te=e(98838),_e=e(4651),He=e(28998),tt=e(81657),Je=e(22175);class Ge extends r.Bs{constructor(bt){super(bt),this.tabId=Y.Queries,this.onOpenInspector=()=>{const Mt=this.state.panelRef.resolve(),Bt=(0,m.Cs)(Mt);s.Ny.partial({inspect:Bt,inspectTab:"query"})},this.onChangeDataSource=async(Mt,Bt)=>{const{dsSettings:Kt}=this.state,Qt=this.queryRunner,Zt=Kt?await(0,se.l)().get({uid:Kt.uid}):void 0,nn=await(0,se.l)().get({uid:Mt.uid}),kt=Qt.state.queries,bn=Bt||await(0,Re.y)(nn,Mt.uid,kt,Zt);Qt.setState({datasource:(0,q.p$)(Mt),queries:bn}),Bt&&Qt.runQueries(),this.loadDataSource()},this.onQueryOptionsChange=Mt=>{const Bt=this.state.panelRef.resolve(),Kt=this.queryRunner,Qt={},Zt={};Mt.maxDataPoints!==Kt.state.maxDataPoints&&(Qt.maxDataPoints=Mt.maxDataPoints??void 0),Mt.minInterval!==Kt.state.minInterval&&(Qt.minInterval=Mt.minInterval??void 0);const nn=Mt.timeRange?.from??void 0,kt=Mt.timeRange?.shift??void 0,bn=Mt.timeRange?.hide;nn!==void 0||kt!==void 0?(Zt.$timeRange=new tt.v({timeFrom:nn,timeShift:kt,hideTimeOverride:bn}),Zt.hoverHeader=(0,Je.$7)(Bt.state.title,Zt.$timeRange)):(Zt.$timeRange=void 0,Zt.hoverHeader=(0,Je.$7)(Bt.state.title,void 0)),Mt.cacheTimeout!==Kt?.state.cacheTimeout&&(Qt.cacheTimeout=Mt.cacheTimeout),Mt.queryCachingTTL!==Kt?.state.queryCachingTTL&&(Qt.queryCachingTTL=Mt.queryCachingTTL),Bt.setState(Zt),Kt.setState(Qt),Kt.runQueries()},this.onQueriesChange=Mt=>{this.queryRunner.setState({queries:Mt})},this.onRunQueries=()=>{this.queryRunner.runQueries()},this.addQueryClick=()=>{const Mt=this.getQueries();this.onQueriesChange((0,de.U7)(Mt,this.newQuery()))},this.onAddQuery=Mt=>{const Bt=this.getQueries(),Kt=this.state.dsSettings;this.onQueriesChange((0,de.U7)(Bt,Mt,Kt?(0,q.p$)(Kt):{type:void 0,uid:void 0}))},this.onAddExpressionOfType=Mt=>{const Bt=this.getQueries(),Qt={...ae.Ex.newQuery(),type:Mt},Zt=(0,ie.rV)(Qt);this.onQueriesChange((0,de.U7)(Bt,Zt))},this.addActivationHandler(()=>this.onActivate())}static{this.Component=je}getTabLabel(){return(0,a.t)("dashboard-scene.panel-data-queries-tab.tab-label","Queries")}getItemsCount(){return this.getQueries().length}renderTab(bt){return(0,h.jsx)(Be,{model:this,...bt},this.getTabLabel())}onActivate(){this.loadDataSource()}async loadDataSource(){if(!this.state.panelRef.resolve().state.$data)return;let Bt=this.queryRunner.state.datasource;try{let Kt,Qt;if(Bt)Kt=await(0,se.l)().get(Bt),Qt=(0,se.l)().getInstanceSettings(Bt);else{const nn=(0,m.YQ)(this).state.uid??"",kt=(0,o.CW)(nn);kt?.datasourceUid!==null&&(Qt=(0,se.l)().getInstanceSettings({uid:kt?.datasourceUid}),Qt&&(Kt=await(0,se.l)().get({uid:kt?.datasourceUid,type:Qt.type}),this.queryRunner.setState({datasource:{...(0,q.p$)(Qt),uid:kt?.datasourceUid}})))}Kt&&Qt&&(this.setState({datasource:Kt,dsSettings:Qt}),(0,fe.tw)((0,q.p$)(Qt)||{default:!0}))}catch(Kt){const Qt=await(0,se.l)().get(i.$.defaultDatasource),Zt=(0,se.l)().getInstanceSettings(i.$.defaultDatasource);Qt&&Zt&&(this.setState({datasource:Qt,dsSettings:Zt}),this.queryRunner.setState({datasource:(0,q.p$)(Zt)})),console.error(Kt)}}buildQueryOptions(){const bt=this.state.panelRef.resolve(),Mt=(0,m.un)(bt),Bt=r.jh.getTimeRange(bt);let Kt={from:void 0,shift:void 0,hide:void 0};Bt instanceof tt.v&&(Kt={from:Bt.state.timeFrom,shift:Bt.state.timeShift,hide:Bt.state.hideTimeOverride});let Qt=Mt.state.queries;const Zt=this.state.dsSettings;return{cacheTimeout:Zt?.meta.queryOptions?.cacheTimeout?Mt.state.cacheTimeout:void 0,queryCachingTTL:Zt?.cachingConfig?.enabled?Mt.state.queryCachingTTL:void 0,dataSource:{default:Zt?.isDefault,...Zt?(0,q.p$)(Zt):{type:void 0,uid:void 0}},queries:Qt,maxDataPoints:Mt.state.maxDataPoints,minInterval:Mt.state.minInterval,timeRange:Kt}}getQueries(){return this.queryRunner.state.queries}newQuery(){const{dsSettings:bt,datasource:Mt}=this.state;let Bt;return bt?.meta.mixed?Mt?.meta.mixed?Bt=(0,se.l)().getInstanceSettings(i.$.defaultDatasource):Bt=Mt:Bt=bt,{...Mt?.getDefaultQuery?.(ne.Jk.PanelEditor),datasource:{uid:Bt?.uid,type:Bt?.type}}}isExpressionsSupported(bt){return(bt.meta.backend||bt.meta.alerting||bt.meta.mixed)===!0}renderExtraActions(){return ve.m.getAllExtraRenderAction().map((bt,Mt)=>bt({onAddQuery:this.onAddQuery,onChangeDataSource:this.onChangeDataSource,key:Mt})).filter(Boolean)}get queryRunner(){return(0,m.un)(this.state.panelRef.resolve())}}function je({model:dt}){const{datasource:bt,dsSettings:Mt}=dt.useState(),{data:Bt,queries:Kt}=dt.queryRunner.useState(),{openDrawer:Qt,queryLibraryEnabled:Zt}=(0,Te.Y)();if(!bt||!Mt||!Bt)return null;const nn=!(0,Oe.k)(Mt.name),kt=async bn=>{const Ln=Kt.map(Hn=>Hn.datasource?Hn:{...Hn,datasource:bt.getRef()}),Yn=(0,de.U7)(Ln,bn);if(dt.onQueriesChange(Yn),bn.datasource?.uid){const yt={uid:new Set(Yn.map(fn=>fn.datasource?.uid).filter(fn=>fn!==_e.Uj)).size>1?Se.uv:bn.datasource.uid};if(bt.uid!==yt.uid){const fn=(0,He.tR)().getInstanceSettings(yt);fn&&await dt.onChangeDataSource(fn)}}};return(0,h.jsxs)("div",{"data-testid":E.Tp.components.QueryTab.content,children:[(0,h.jsx)(Ee.K,{data:Bt,dsSettings:Mt,dataSource:bt,options:dt.buildQueryOptions(),onDataSourceChange:dt.onChangeDataSource,onOptionsChange:dt.onQueryOptionsChange,onOpenQueryInspector:dt.onOpenInspector}),(0,h.jsx)(le.L,{data:Bt,queries:Kt,dsSettings:Mt,onAddQuery:dt.onAddQuery,onQueriesChange:dt.onQueriesChange,onRunQueries:dt.onRunQueries}),(0,h.jsxs)(oe.B,{gap:2,children:[nn&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(w.$n,{icon:"plus",onClick:dt.addQueryClick,variant:"secondary","data-testid":E.Tp.components.QueryTab.addQuery,children:(0,h.jsx)(a.x6,{i18nKey:"dashboard-scene.panel-data-queries-tab-rendered.add-query",children:"Add query"})}),Zt&&(0,h.jsx)(w.$n,{icon:"plus",onClick:()=>Qt(Fe(bt,Kt),kt),variant:"secondary","data-testid":E.Tp.components.QueryTab.addQueryFromLibrary,children:(0,h.jsx)(a.x6,{i18nKey:"dashboards.panel-queries.add-query-from-library",children:"Add query from library"})})]}),i.$.expressionsEnabled&&dt.isExpressionsSupported(Mt)&&(0,h.jsx)(ce.m,{handleOnSelect:dt.onAddExpressionOfType,children:(0,h.jsx)(w.$n,{icon:"plus",variant:"secondary","data-testid":E.Tp.components.QueryTab.addExpression,children:(0,h.jsx)(a.x6,{i18nKey:"dashboard-scene.panel-data-queries-tab-rendered.expression",children:"Expression\xA0"})})}),dt.renderExtraActions()]})]})}function Fe(dt,bt){if(dt.uid==="-- Mixed --"){const Mt=(0,se.l)();return bt.map(Bt=>Mt.getInstanceSettings(Bt.datasource)?.name).filter(Bt=>Bt!==void 0)}else return[dt.name]}function Be(dt){const{model:bt}=dt,Mt=bt.queryRunner.useState();return(0,h.jsx)(_.o,{label:bt.getTabLabel(),icon:"database",counter:Mt.queries.length,active:dt.active,onChangeTab:dt.onChangeTab})}var Ke=e(89332),Ue=e(96540),we=e(93256),Xe=e(71599),nt=e(47350),he=e(80849),xe=e(8642),me=e(76319),ye=e(9284),De=e(34176);function Le(dt){const{isOpen:bt,series:Mt,onClose:Bt,onTransformationAdd:Kt}=dt,[Qt,Zt]=(0,Ue.useState)({search:"",showIllustrations:!0}),nn=It=>Zt({...Qt,search:It.currentTarget.value}),kt=It=>Zt({...Qt,showIllustrations:It}),bn=It=>Zt({...Qt,selectedFilter:It}),Ln=(0,Ue.useMemo)(()=>xe.h.list().sort((It,yt)=>It.name>yt.name?1:yt.name>It.name?-1:0),[]),Yn=Ln.filter(It=>Qt.selectedFilter&&Qt.selectedFilter!==De.e&&!It.categories?.has(Qt.selectedFilter)?!1:It.name.toLocaleLowerCase().includes(Qt.search.toLocaleLowerCase())||It.description?.toLocaleLowerCase().includes(Qt.search.toLocaleLowerCase())),Hn=(0,h.jsxs)(h.Fragment,{children:[Yn.length," / ",Ln.length," \xA0\xA0",(0,h.jsx)(me.K,{name:"times",onClick:()=>{Zt({...Qt,search:""})},tooltip:(0,a.t)("dashboard-scene.transformations-drawer.search-box-suffix.tooltip-clear-search","Clear search")})]});if(bt)return(0,h.jsx)(ye.R,{data:Mt,onTransformationAdd:Kt,xforms:Yn,search:Qt.search,noTransforms:!1,suffix:Qt.search!==""?Hn:(0,h.jsx)(h.Fragment,{}),selectedFilter:Qt.selectedFilter,onSearchChange:nn,onSearchKeyDown:()=>{},showIllustrations:Qt.showIllustrations,onShowIllustrationsChange:kt,onSelectedFilterChange:bn,onClose:Bt})}class Ve extends r.Bs{constructor(){super(...arguments),this.tabId=Y.Transformations}static{this.Component=ze}getTabLabel(){return(0,a.t)("dashboard-scene.panel-data-transformations-tab.tab-label","Transformations")}renderTab(bt){return(0,h.jsx)($e,{model:this,...bt},this.getTabLabel())}getQueryRunner(){return(0,m.un)(this.state.panelRef.resolve())}getDataTransformer(){const bt=this.state.panelRef.resolve().state.$data;if(!bt||!(bt instanceof r.Es))throw new Error("Could not find SceneDataTransformer for panel");return bt}onChangeTransformations(bt){const Mt=this.getDataTransformer();Mt.setState({transformations:bt}),Mt.reprocessTransformations()}}function ze({model:dt}){const bt=(0,b.of)(Me),Mt=dt.getQueryRunner().useState(),{data:Bt,transformations:Kt}=dt.getDataTransformer().useState(),Qt=Kt,[Zt,nn]=(0,Ue.useState)(!1),[kt,bn]=(0,Ue.useState)(!1),Ln=()=>nn(!0),Yn=()=>nn(!1);if(!Bt||!Mt.data)return;const Hn=(0,h.jsx)(Le,{onClose:Yn,onTransformationAdd:It=>{It.value!==void 0&&(dt.onChangeTransformations([...Qt,{id:It.value,options:{}}]),Yn())},isOpen:Zt,series:Bt.series});return Qt.length<1?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(he.p,{onShowPicker:Ln}),Hn]}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Ze,{data:Mt.data,transformations:Qt,model:dt}),(0,h.jsxs)(we.e,{children:[(0,h.jsx)(w.$n,{icon:"plus",variant:"secondary",onClick:Ln,"data-testid":E.Tp.components.Transforms.addTransformationButton,children:(0,h.jsx)(a.x6,{i18nKey:"dashboard-scene.panel-data-transformations-tab-rendered.add-another-transformation",children:"Add another transformation"})}),(0,h.jsx)(w.$n,{"data-testid":E.Tp.components.Transforms.removeAllTransformationsButton,className:bt.removeAll,icon:"times",variant:"secondary",onClick:()=>bn(!0),children:(0,h.jsx)(a.x6,{i18nKey:"dashboard-scene.panel-data-transformations-tab-rendered.delete-all-transformations",children:"Delete all transformations"})})]}),(0,h.jsx)(Xe.u,{isOpen:kt,title:(0,a.t)("dashboard-scene.panel-data-transformations-tab-rendered.title-delete-all-transformations","Delete all transformations?"),body:(0,a.t)("dashboard-scene.panel-data-transformations-tab-rendered.body-delete-all-transformations","By deleting all transformations, you will go back to the main selection screen."),confirmText:(0,a.t)("dashboard-scene.panel-data-transformations-tab-rendered.confirmText-delete-all","Delete all"),onConfirm:()=>{dt.onChangeTransformations([]),bn(!1)},onDismiss:()=>bn(!1)}),Hn]})}function Ze({transformations:dt,model:bt,data:Mt}){const Bt=dt.map((Qt,Zt)=>({id:`${Zt} - ${Qt.id}`,transformation:Qt})),Kt=Qt=>{if(!Qt||!Qt.destination)return;const Zt=Qt.source.index,nn=Qt.destination.index;if(Zt===nn)return;const kt=Array.from(Bt),[bn]=kt.splice(Zt,1);kt.splice(nn,0,bn),bt.onChangeTransformations(kt.map(Ln=>Ln.transformation))};return(0,h.jsx)(Ke.JY,{onDragEnd:Kt,children:(0,h.jsx)(Ke.gL,{droppableId:"transformations-list",direction:"vertical",children:Qt=>(0,h.jsxs)("div",{ref:Qt.innerRef,...Qt.droppableProps,children:[(0,h.jsx)(nt.A,{onChange:(Zt,nn)=>{const kt=dt.slice();kt[Zt]=nn,bt.onChangeTransformations(kt)},onRemove:Zt=>{const nn=dt.slice();nn.splice(Zt,1),bt.onChangeTransformations(nn)},configs:Bt,data:Mt}),Qt.placeholder]})})})}const Me=dt=>({removeAll:(0,d.css)({marginLeft:dt.spacing(2)})});function $e(dt){const{model:bt}=dt,Mt=bt.getDataTransformer().useState();return(0,h.jsx)(_.o,{label:bt.getTabLabel(),icon:"process",counter:Mt.transformations.length,active:dt.active,onChangeTab:dt.onChangeTab})}class at extends r.Bs{constructor(){super(...arguments),this._urlSync=new r.So(this,{keys:["tab"]}),this.onChangeTab=bt=>{this.setState({tab:bt.tabId})}}static{this.Component=ct}static createFor(bt){const Mt=bt.getRef(),Bt=[new Ge({panelRef:Mt}),new Ve({panelRef:Mt})];return ft(bt.state.pluginId)&&Bt.push(new X({panelRef:Mt})),new at({panelRef:Mt,tabs:Bt,tab:Y.Queries})}getUrlState(){return{tab:this.state.tab}}updateFromUrl(bt){bt.tab&&typeof bt.tab=="string"&&this.setState({tab:bt.tab})}}function ct({model:dt}){const{tab:bt,tabs:Mt}=dt.useState(),Bt=(0,b.of)(Et);if(!Mt||!Mt.length)return;const Kt=Mt.find(Qt=>Qt.tabId===bt);return(0,h.jsxs)("div",{className:Bt.dataPane,"data-testid":E.Tp.components.PanelEditor.DataPane.content,children:[(0,h.jsx)(D.U,{className:Bt.tabsBar,children:Mt.map(Qt=>Qt.renderTab({active:Qt.tabId===bt,onChangeTab:()=>dt.onChangeTab(Qt)}))}),(0,h.jsx)(C.P,{backgroundColor:"primary",children:(0,h.jsx)(P.J,{className:Bt.tabContent,children:(0,h.jsx)(M.mc,{children:Kt&&(0,h.jsx)(Kt.Component,{model:Kt})})})})]})}function ft(dt){const{unifiedAlertingEnabled:bt=!1}=(0,O.zj)(),Mt=j.TP.hasPermission((0,U.Wd)(W.hY).read);return bt&&Mt?dt==="graph"||dt==="timeseries":!1}function Et(dt){return{dataPane:(0,d.css)({display:"flex",flexDirection:"column",flexGrow:1,minHeight:0,height:"100%",width:"100%"}),tabContent:(0,d.css)({padding:dt.spacing(2),border:`1px solid ${dt.colors.border.weak}`,borderLeft:"none",borderBottom:"none",borderTopRightRadius:dt.shape.radius.default,flexGrow:1}),tabsBar:(0,d.css)({flexShrink:0,paddingLeft:dt.spacing(2)})}}var St=e(7895),Pt=e(68079),Dt=e(66483),Ye=e(12161),mt=e(17732),zt=e(82754);function Jt({model:dt}){const bt=(0,m.YQ)(dt),{optionsPane:Mt}=dt.useState(),Bt=(0,b.of)(ln),[Kt,Qt]=(0,g.dt)(),{containerProps:Zt,primaryProps:nn,secondaryProps:kt,splitterProps:bn,splitterState:Ln,onToggleCollapse:Yn}=(0,zt.L)({direction:"row",dragPosition:"end",initialSize:330,usePixels:!0,collapsed:Kt,collapseBelowPixels:250});return(0,Ue.useEffect)(()=>{Qt(Ln.collapsed)},[Ln.collapsed,Qt]),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Dt.c,{dashboard:bt}),(0,h.jsxs)("div",{...Zt,className:(0,d.cx)(Zt.className,Bt.content),"data-testid":E.Tp.components.PanelEditor.General.content,children:[(0,h.jsx)("div",{...nn,className:(0,d.cx)(nn.className,Bt.body),children:(0,h.jsx)(Xt,{model:dt})}),(0,h.jsx)("div",{...bn}),(0,h.jsxs)("div",{...kt,className:(0,d.cx)(kt.className,Bt.optionsPane),children:[Ln.collapsed&&(0,h.jsx)("div",{className:Bt.expandOptionsWrapper,children:(0,h.jsx)(St.I,{tooltip:(0,a.t)("dashboard-scene.panel-editor-renderer.tooltip-open-options-pane","Open options pane"),icon:"arrow-to-right",onClick:Yn,variant:"canvas",className:Bt.rotate180,"aria-label":(0,a.t)("dashboard-scene.panel-editor-renderer.aria-label-open-options-pane","Open options pane")})}),!Ln.collapsed&&Mt&&(0,h.jsx)(Mt.Component,{model:Mt}),!Ln.collapsed&&!Mt&&(0,h.jsx)(Pt.y,{})]})]})]})}function Xt({model:dt}){const bt=(0,m.YQ)(dt),{dataPane:Mt,showLibraryPanelSaveModal:Bt,showLibraryPanelUnlinkModal:Kt,tableView:Qt}=dt.useState(),Zt=dt.getPanel(),nn=(0,m.iL)(Zt),{controls:kt}=bt.useState(),bn=(0,b.of)(ln),{containerProps:Ln,primaryProps:Yn,secondaryProps:Hn,splitterProps:It,splitterState:yt,onToggleCollapse:Vt}=(0,zt.L)({direction:"column",dragPosition:"start",initialSize:.5,collapseBelowPixels:150});return Ln.className=(0,d.cx)(Ln.className,bn.container),Mt||(Yn.style.flexGrow=1),(0,h.jsxs)("div",{className:(0,d.cx)(bn.pageContainer,kt&&bn.pageContainerWithControls),children:[kt&&(0,h.jsx)("div",{className:bn.controlsWrapper,children:(0,h.jsx)(kt.Component,{model:kt})}),(0,h.jsxs)("div",{...Ln,children:[(0,h.jsx)("div",{...Yn,children:(0,h.jsx)(En,{panel:Zt,tableView:Qt})}),Bt&&nn&&(0,h.jsx)(mt.Z,{libraryPanel:nn,onDismiss:dt.onDismissLibraryPanelSaveModal,onConfirm:dt.onConfirmSaveLibraryPanel,onDiscard:dt.onDiscard}),Kt&&nn&&(0,h.jsx)(Ye.l,{onDismiss:dt.onDismissUnlinkLibraryPanelModal,onConfirm:dt.onConfirmUnlinkLibraryPanel,isOpen:!0}),Mt&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{...It}),(0,h.jsxs)("div",{...Hn,children:[yt.collapsed&&(0,h.jsx)("div",{className:bn.expandDataPane,children:(0,h.jsx)(w.$n,{tooltip:(0,a.t)("dashboard-scene.viz-and-data-pane.tooltip-open-query-pane","Open query pane"),icon:"arrow-to-right",onClick:Vt,variant:"secondary",size:"sm",className:bn.openDataPaneButton,"aria-label":(0,a.t)("dashboard-scene.viz-and-data-pane.aria-label-open-query-pane","Open query pane")})}),!yt.collapsed&&(0,h.jsx)(Mt.Component,{model:Mt})]})]})]})]})}function En({panel:dt,tableView:bt}){const Mt=(0,b.of)(ln),Bt=bt??dt;return(0,h.jsx)("div",{className:Mt.vizWrapper,children:(0,h.jsx)(Bt.Component,{model:Bt})})}function ln(dt){return{pageContainer:(0,d.css)({display:"grid",gridTemplateAreas:`
        "panels"`,gridTemplateColumns:"1fr",gridTemplateRows:"1fr",height:"100%"}),pageContainerWithControls:(0,d.css)({gridTemplateAreas:`
        "controls"
        "panels"`,gridTemplateRows:"auto 1fr"}),container:(0,d.css)({gridArea:"panels",height:"100%"}),canvasContent:(0,d.css)({label:"canvas-content",display:"flex",flexDirection:"column",flexBasis:"100%",flexGrow:1,minHeight:0,width:"100%"}),content:(0,d.css)({position:"absolute",width:"100%",height:"100%"}),body:(0,d.css)({label:"body",flexGrow:1,display:"flex",flexDirection:"column",minHeight:0}),optionsPane:(0,d.css)({flexDirection:"column",borderLeft:`1px solid ${dt.colors.border.weak}`,background:dt.colors.background.primary,marginTop:dt.spacing(2),borderTop:`1px solid ${dt.colors.border.weak}`,borderTopLeftRadius:dt.shape.radius.default}),expandOptionsWrapper:(0,d.css)({display:"flex",flexDirection:"column",padding:dt.spacing(2,1)}),expandDataPane:(0,d.css)({display:"flex",flexDirection:"row",padding:dt.spacing(1),borderTop:`1px solid ${dt.colors.border.weak}`,borderRight:`1px solid ${dt.colors.border.weak}`,background:dt.colors.background.primary,flexGrow:1,justifyContent:"space-around"}),rotate180:(0,d.css)({rotate:"180deg"}),controlsWrapper:(0,d.css)({display:"flex",flexDirection:"column",flexGrow:0,gridArea:"controls"}),openDataPaneButton:(0,d.css)({width:dt.spacing(8),justifyContent:"center",svg:{rotate:"-90deg"}}),vizWrapper:(0,d.css)({height:"100%",width:"100%",paddingLeft:dt.spacing(2)})}}var cn=e(42941),Pn=e(69168),wn=e(27489),jn=e(37386),kn=e(12737),gt=e(41097),Lt=e(52193),Rt=e(25531),Ut=e(56424),Gt=e(7094);const Ft=Ue.memo(({panel:dt,searchQuery:bt,listMode:Mt,data:Bt})=>{const{options:Kt,fieldConfig:Qt,_pluginInstanceState:Zt}=dt.useState(),nn=(0,Ue.useMemo)(()=>(0,Je.yH)(dt),[dt]),kt=(0,Ue.useMemo)(()=>{const It=dt.getPlugin();if(It)return(0,Ut.Z4)({panel:dt,data:Bt,plugin:It,eventBus:dt.getPanelContext().eventBus,instanceState:Zt})},[Bt,dt,Kt,Qt,Zt]),bn=(0,Ue.useMemo)(()=>{if(dt instanceof r.Eb&&(0,m.ME)(dt)){const It=(0,m.iL)(dt);return It instanceof Gt.u?(0,Ut.tN)(It):void 0}},[dt]),Ln=(0,Ue.useMemo)(()=>(0,Rt.v)(Qt,dt.getPlugin()?.fieldConfigRegistry,Bt?.series??[],bt,It=>{dt.onFieldConfigChange(It,!0)}),[Bt,bt,dt,Qt]),Yn=bt.length>0,Hn=[];if(Yn)Hn.push((0,u.Po)([nn,...bn?[bn]:[],...kt??[]],Ln,bt));else switch(Mt){case u.gs.All:bn&&Hn.push(bn.render()),Hn.push(nn.render());for(const It of kt??[])Hn.push(It.render());for(const It of Ln)Hn.push(It.render());break;case u.gs.Overrides:for(const It of Ln)Hn.push(It.render());default:break}return Hn});Ft.displayName="PanelOptions";var _t=e(78685),tn=e(77824),xn=e(95943),mn=e(62667),An=e(82472),ia=e(72165),ca=e(33380);const ea="dashboards_panel_plugin_picker_clicked",Ca={TOGGLE_DROPDOWN:"toggle_panel_plugin_picker",SELECT_PANEL_PLUGIN:"select_panel_plugin",CHANGE_TAB:"change_tab",SEARCH:"search"};function oa({panel:dt,data:bt,onChange:Mt,onClose:Bt}){const Kt=(0,b.of)(Jn),[Qt,Zt]=(0,Ue.useState)(""),nn=(0,Ue.useMemo)(()=>(0,n.debounce)((Dn,Wn)=>{Dn&&(0,wn.rR)(ea,{item:Ca.SEARCH,query:Dn,result_count:Wn,creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"})},300),[]),kt=Dn=>{Zt(Dn)},bn=xn.wV,Ln=mn.__.Visualizations,Yn=(0,Ue.useMemo)(()=>new ca.R(dt),[dt]),Hn=(0,Ue.useMemo)(()=>new Set([mn.__.Visualizations,mn.__.Suggestions]),[]),[It,yt]=(0,_t.A)(bn,Ln),Vt=Dn=>{(0,wn.rR)(ea,{item:Ca.CHANGE_TAB,tab:mn.__[Dn],creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"}),yt(Dn)};(0,Ue.useEffect)(()=>{It&&!Hn.has(It)&&yt(Ln)},[Ln,It,yt,Hn]);const fn=[{label:(0,a.t)("dashboard-scene.panel-viz-type-picker.radio-options.label.visualizations","Visualizations"),value:mn.__.Visualizations},{label:(0,a.t)("dashboard-scene.panel-viz-type-picker.radio-options.label.suggestions","Suggestions"),value:mn.__.Suggestions}];return(0,h.jsxs)("div",{className:Kt.wrapper,children:[(0,h.jsxs)("div",{className:Kt.searchRow,children:[(0,h.jsx)(kn.Z,{className:Kt.filter,value:Qt,onChange:kt,autoFocus:!0,placeholder:(0,a.t)("dashboard-scene.panel-viz-type-picker.placeholder-search-for","Search for...")}),(0,h.jsx)(w.$n,{title:(0,a.t)("dashboard-scene.panel-viz-type-picker.title-close","Close"),variant:"secondary",icon:"angle-up",className:Kt.closeButton,"data-testid":E.Tp.components.PanelEditor.toggleVizPicker,onClick:Bt})]}),(0,h.jsx)(jn.D,{className:Kt.customFieldMargin,children:(0,h.jsx)(tn.z,{options:fn,value:It,onChange:Vt,fullWidth:!0})}),(0,h.jsxs)(C.P,{children:[It===mn.__.Visualizations&&(0,h.jsx)(ia.G,{pluginId:dt.state.pluginId,searchQuery:Qt,trackSearch:nn,onChange:Mt}),It===mn.__.Suggestions&&(0,h.jsx)(An.a,{onChange:Mt,trackSearch:nn,searchQuery:Qt,panel:Yn,data:bt})]})]})}const Jn=dt=>({wrapper:(0,d.css)({display:"flex",flexDirection:"column",flexGrow:1,padding:dt.spacing(2,1),height:"100%",gap:dt.spacing(2),border:`1px solid ${dt.colors.border.weak}`,borderRight:"none",borderBottom:"none",borderTopLeftRadius:dt.shape.radius.default}),searchRow:(0,d.css)({display:"flex",marginBottom:dt.spacing(1)}),closeButton:(0,d.css)({marginLeft:dt.spacing(1)}),customFieldMargin:(0,d.css)({marginBottom:dt.spacing(1)}),filter:(0,d.css)({minHeight:dt.spacing(4)})});class Da extends r.Bs{constructor(){super(...arguments),this._cachedPluginOptions={},this.onToggleVizPicker=()=>{(0,wn.rR)(ea,{item:Ca.TOGGLE_DROPDOWN,open:!this.state.isVizPickerOpen}),this.setState({isVizPickerOpen:!this.state.isVizPickerOpen})},this.onChangePanelPlugin=bt=>{const Mt=this.state.panelRef.resolve(),{options:Bt,fieldConfig:Kt,pluginId:Qt}=Mt.state,Zt=bt.pluginId;(0,wn.rR)(ea,{item:Ca.SELECT_PANEL_PLUGIN,plugin_id:Zt});let nn={defaults:{...Kt.defaults,custom:{}},overrides:(0,Pn.aW)(Kt.overrides,Pn.nx)};this._cachedPluginOptions[Qt]={options:Bt,fieldConfig:Kt};const kt=this._cachedPluginOptions[Zt]?.options,bn=this._cachedPluginOptions[Zt]?.fieldConfig;bn&&(nn=(0,Pn.H9)(nn,bn)),Mt.changePluginType(Zt,kt,nn),bt.options&&Mt.onOptionsChange(bt.options,!0),bt.fieldConfig&&Mt.onFieldConfigChange(bt.fieldConfig,!0),this.onToggleVizPicker()},this.onSetSearchQuery=bt=>{this.setState({searchQuery:bt})},this.onSetListMode=bt=>{this.setState({listMode:bt})},this.onOpenPanelJSON=bt=>{s.Ny.partial({inspect:bt.state.key,inspectTab:"json"})}}getOptionRadioFilters(){return[{label:u.gs.All,value:u.gs.All},{label:u.gs.Overrides,value:u.gs.Overrides}]}static{this.Component=({model:bt})=>{const{isVizPickerOpen:Mt,searchQuery:Bt,listMode:Kt,panelRef:Qt}=bt.useState(),Zt=Qt.resolve(),{pluginId:nn}=Zt.useState(),{data:kt}=r.jh.getData(Zt).useState(),bn=(0,b.of)(Fa),Yn=!(Bt.length>0)&&!Zt.getPlugin()?.fieldConfigRegistry.isEmpty(),[Hn,It]=(0,cn.A)(!1),yt=Kt===u.gs.Overrides;return(0,h.jsxs)(h.Fragment,{children:[!Mt&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:bn.top,children:[(0,h.jsx)(jn.D,{label:(0,a.t)("dashboard.panel-edit.visualization-button-label","Visualization"),className:bn.vizField,children:(0,h.jsxs)(oe.B,{gap:1,children:[(0,h.jsx)(Xn,{pluginId:nn,onOpen:bt.onToggleVizPicker}),(0,h.jsx)(w.$n,{icon:"search",variant:"secondary",onClick:It,tooltip:(0,a.t)("dashboard.panel-edit.visualization-button-tooltip","Search options")}),Yn&&(0,h.jsx)(St.I,{icon:"filter",tooltip:(0,a.t)("dashboard.panel-edit.only-overrides-button-tooltip","Show only overrides"),variant:yt?"active":"canvas",onClick:()=>{bt.onSetListMode(yt?u.gs.All:u.gs.Overrides)}})]})}),Hn&&(0,h.jsx)(kn.Z,{className:bn.searchOptions,value:Bt,placeholder:(0,a.t)("dashboard.panel-edit.placeholder-search-options","Search options"),onChange:bt.onSetSearchQuery,autoFocus:!0,onBlur:()=>{Bt.length===0&&It(!1)}})]}),(0,h.jsx)(C.P,{children:(0,h.jsx)(Ft,{panel:Zt,searchQuery:Bt,listMode:Kt,data:kt})})]}),Mt&&(0,h.jsx)(oa,{panel:Zt,onChange:bt.onChangePanelPlugin,onClose:bt.onToggleVizPicker,data:kt})]})}}}function Fa(dt){return{top:(0,d.css)({display:"flex",flexDirection:"column",padding:dt.spacing(1,2,2,2),gap:dt.spacing(2)}),searchOptions:(0,d.css)({minHeight:dt.spacing(4)}),searchWrapper:(0,d.css)({padding:dt.spacing(2,2,2,0)}),vizField:(0,d.css)({marginBottom:dt.spacing(0)}),rotateIcon:(0,d.css)({rotate:"180deg"})}}function Xn({pluginId:dt,onOpen:bt}){const Mt=(0,b.of)(ps);let Bt=(0,Ue.useMemo)(()=>(0,Lt.A4)().filter(Kt=>Kt.id===dt)[0],[dt]);return Bt||(Bt=(0,gt.$)(`Panel plugin not found (${dt})`,!0).meta),(0,h.jsx)(St.I,{className:Mt.vizButton,tooltip:(0,a.t)("dashboard-scene.visualization-button.tooltip-click-to-change-visualization","Click to change visualization"),imgSrc:Bt.info.logos.small,onClick:bt,"data-testid":E.Tp.components.PanelEditor.toggleVizPicker,"aria-label":(0,a.t)("dashboard-scene.visualization-button.aria-label-change-visualization","Change visualization"),variant:"canvas",isOpen:!1,fullWidth:!0,children:Bt.name})}function ps(dt){return{vizButton:(0,d.css)({textAlign:"left"})}}class Aa extends r.Bs{constructor(bt){super(bt),this._changesHaveBeenMade=!1,this.debounceSaveModelDiff=!0,this.onDiscard=()=>{this.setState({isDirty:!1});const Kt=this.state.panelRef.resolve();this.state.isNewPanel?(0,m.YQ)(this).removePanel(Kt):this._layoutItem.setState(this._layoutItemState),s.Ny.partial({editPanel:null})},this.onSaveLibraryPanel=()=>{this.setState({showLibraryPanelSaveModal:!0})},this.onConfirmSaveLibraryPanel=()=>{(0,l.DW)(this.state.panelRef.resolve()),this.setState({isDirty:!1}),s.Ny.partial({editPanel:null})},this.onDismissLibraryPanelSaveModal=()=>{this.setState({showLibraryPanelSaveModal:!1})},this.onUnlinkLibraryPanel=()=>{this.setState({showLibraryPanelUnlinkModal:!0})},this.onDismissUnlinkLibraryPanelModal=()=>{this.setState({showLibraryPanelUnlinkModal:!1})},this.onConfirmUnlinkLibraryPanel=()=>{const Kt=(0,m.iL)(this.getPanel());Kt&&(Kt.unlink(),this.setState({showLibraryPanelUnlinkModal:!1}))},this.onToggleTableView=()=>{if(this.state.tableView){this.setState({tableView:void 0});return}const Qt=this.state.panelRef.resolve().state.$data;Qt&&this.setState({tableView:r.d0.table().setTitle("").setOption("showTypeIcons",!0).setOption("showHeader",!0).setData(new y({source:Qt.getRef()})).build()})};const Bt=this.state.panelRef.resolve().parent;if(!Bt||!(0,x.y)(Bt))throw new Error("Panel must have a parent of type DashboardLayoutItem");this._layoutItem=Bt,this.setOriginalState(this.state.panelRef),this.addActivationHandler(this._activationHandler.bind(this))}static{this.Component=Jt}_activationHandler(){const bt=this.state.panelRef.resolve();bt.state.pluginId===c.r&&bt.changePluginType("timeseries"),this._subs.add(this._layoutItem.subscribeToEvent(g.BF,({payload:Bt})=>{Bt.perform()}));const Mt=(0,m.sf)(bt);return this.waitForPlugin(),()=>{this._layoutItem.editingCompleted?.(this.state.isDirty||this._changesHaveBeenMade),Mt&&Mt()}}waitForPlugin(bt=0){const Mt=this.getPanel(),Bt=Mt.getPlugin();if(!Bt||Bt.meta.id!==Mt.state.pluginId){bt<100?setTimeout(()=>this.waitForPlugin(bt+1),bt*10):this.setState({pluginLoadErrror:"Failed to load panel plugin"});return}this.gotPanelPlugin(Bt)}setOriginalState(bt){const Mt=bt.resolve();this._originalSaveModel=(0,v.Z6)(Mt),this._layoutItemState=r.Go.cloneSceneObjectState(this._layoutItem.state)}_setupChangeDetection(){const bt=this.state.panelRef.resolve(),Mt=()=>{const{hasChanges:Qt}=(0,p.yO)(this._originalSaveModel,(0,v.Z6)(bt));this.setState({isDirty:Qt})},Bt=this.debounceSaveModelDiff?(0,n.debounce)(Mt,250):Mt,Kt=Qt=>{f.l.isUpdatingPersistedState(Qt)&&Bt()};this._subs.add(this._layoutItem.subscribeToEvent(r.bZ,Kt))}getPanel(){return this.state.panelRef?.resolve()}gotPanelPlugin(bt){const Mt=this.getPanel();this.state.isInitializing?(this.setOriginalState(this.state.panelRef),this._layoutItem.editingStarted?.(),this._setupChangeDetection(),this._updateDataPane(bt),this._subs.add(Mt.subscribeToState((Bt,Kt)=>{Bt.pluginId!==Kt.pluginId&&this.waitForPlugin()})),this.setState({optionsPane:new Da({panelRef:this.state.panelRef,searchQuery:"",listMode:u.gs.All}),isInitializing:!1})):this._updateDataPane(bt)}_updateDataPane(bt){const Mt=bt.meta.skipDataQuery,Bt=this.state.panelRef.resolve();if(Mt&&(this.state.dataPane&&(s.Ny.partial({tab:null},!0),this.setState({dataPane:void 0})),Bt.state.$data&&Bt.setState({$data:void 0})),!Mt&&(this.state.dataPane||this.setState({dataPane:at.createFor(this.getPanel())}),!Bt.state.$data)){let Kt=(0,o.CW)((0,m.YQ)(this).state.uid)?.datasourceUid;Kt||(Kt=i.$.defaultDatasource),Bt.setState({$data:new r.Es({$data:new r.dt({datasource:{uid:Kt},queries:[{refId:"A"}]}),transformations:[]})})}}getUrlKey(){return this.getPanelId().toString()}getPanelId(){return(0,m.Cs)(this.state.panelRef.resolve())}getPageNav(bt,Mt){const Bt=(0,m.YQ)(this);return{text:(0,a.t)("dashboard-scene.panel-editor.text.edit-panel","Edit panel"),parentItem:Bt.getPageNav(bt,Mt)}}dashboardSaved(){this.setOriginalState(this.state.panelRef),this.setState({isDirty:!1}),this._changesHaveBeenMade=!0}}function xt(dt,bt=!1){return new Aa({isInitializing:!0,panelRef:dt.getRef(),isNewPanel:bt})}},17732:(te,R,e)=>{"use strict";e.d(R,{Z:()=>x});var n=e(74848),a=e(96540),s=e(16817),i=e(40996),r=e(92745),u=e(63142),o=e(22787),l=e(63527),g=e(30703),f=e(45861),p=e(30124),c=e(37666);const x=({libraryPanel:v,isUnsavedPrompt:m,onDismiss:y,onConfirm:h,onDiscard:d})=>{const[E,b]=(0,a.useState)(""),D=(0,s.A)(async()=>{const U=await(0,p.xV)(v.state.uid);return U.length>0?U.map(W=>W.title):[]},[v.state.uid]),[C,P]=(0,a.useState)([]);(0,i.A)(()=>D.value?P(D.value.filter(U=>U.toLowerCase().includes(E.toLowerCase()))):P([]),300,[D.value,E]);const M=(0,u.of)(c.o),O=(0,a.useCallback)(()=>{d()},[d]),j=m?"Unsaved library panel changes":"Save library panel";return(0,n.jsx)(o.a,{title:j,icon:"save",onDismiss:y,isOpen:!0,children:(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:M.textInfo,children:(0,n.jsxs)(r.x6,{i18nKey:"dashboard-scene.save-library-viz-panel-modal.affected-dashboards",count:v.state._loadedPanel?.meta?.connectedDashboards,children:["This update will affect ",(0,n.jsxs)("strong",{children:["{{count}}"," dashboards."]})," The following dashboards using the panel will be affected:"]})}),(0,n.jsx)(l.p,{className:M.dashboardSearch,prefix:(0,n.jsx)(g.I,{name:"search"}),placeholder:(0,r.t)("dashboard-scene.save-library-viz-panel-modal.placeholder-search-affected-dashboards","Search affected dashboards"),value:E,onChange:U=>b(U.currentTarget.value)}),D.loading?(0,n.jsx)("p",{children:(0,n.jsx)(r.x6,{i18nKey:"dashboard-scene.save-library-viz-panel-modal.loading-connected-dashboards",children:"Loading connected dashboards..."})}):(0,n.jsxs)("table",{className:M.myTable,children:[(0,n.jsx)("thead",{children:(0,n.jsx)("tr",{children:(0,n.jsx)("th",{children:(0,n.jsx)(r.x6,{i18nKey:"dashboard-scene.save-library-viz-panel-modal.dashboard-name",children:"Dashboard name"})})})}),(0,n.jsx)("tbody",{children:C.map((U,W)=>(0,n.jsx)("tr",{children:(0,n.jsx)("td",{children:U})},`dashrow-${W}`))})]}),(0,n.jsxs)(o.a.ButtonRow,{children:[(0,n.jsx)(f.$n,{variant:"secondary",onClick:y,fill:"outline",children:(0,n.jsx)(r.x6,{i18nKey:"dashboard-scene.save-library-viz-panel-modal.cancel",children:"Cancel"})}),m&&(0,n.jsx)(f.$n,{variant:"destructive",onClick:O,children:(0,n.jsx)(r.x6,{i18nKey:"dashboard-scene.save-library-viz-panel-modal.discard",children:"Discard"})}),(0,n.jsx)(f.$n,{onClick:()=>{h()},children:(0,n.jsx)(r.x6,{i18nKey:"dashboard-scene.save-library-viz-panel-modal.update-all",children:"Update all"})})]})]})})}},22175:(te,R,e)=>{"use strict";e.d(R,{$7:()=>S,R4:()=>U,dF:()=>j,dJ:()=>B,m:()=>O,yH:()=>P});var n=e(74848),a=e(96540),s=e(1906),i=e(51898),r=e(92745),u=e(43173),o=e(96822),l=e(63527),g=e(87105),f=e(21285),p=e(22055),c=e(76623),x=e(25797),v=e(51156),m=e(82345),y=e(33143),h=e(81657),d=e(20246),E=e(3688),b=e(70030),D=e(1682),C=e(8285);function P(_){const K=new x.C({title:(0,r.t)("dashboard-scene.get-panel-frame-options.descriptor.title.panel-options","Panel options"),id:"Panel options",isOpenDefault:!0}),T=D.b4.getPanelLinks(_),L=T?.state.rawLinks??[],A=(0,C.YQ)(_),N=_.parent;return K.addItem(new v.v({title:(0,r.t)("dashboard-scene.get-panel-frame-options.title.title","Title"),id:"PanelFrameTitle",value:_.state.title,popularRank:1,render:function(z){return(0,n.jsx)(O,{id:z.props.id,panel:_})},addon:u.$.featureToggles.dashgpt&&(0,n.jsx)(c.h,{onGenerate:V=>B(_,V),panel:(0,b.Z6)(_),dashboard:(0,b.Uy)(A)})})).addItem(new v.v({title:(0,r.t)("dashboard-scene.get-panel-frame-options.title.description","Description"),id:"description-text-area",value:_.state.description,render:function(z){return(0,n.jsx)(j,{id:z.props.id,panel:_})},addon:u.$.featureToggles.dashgpt&&(0,n.jsx)(p.t,{onGenerate:V=>_.setState({description:V}),panel:(0,b.Z6)(_)})})).addItem(new v.v({title:(0,r.t)("dashboard-scene.get-panel-frame-options.title.transparent-background","Transparent background"),id:"transparent-background",render:function(z){return(0,n.jsx)(U,{id:z.props.id,panel:_})}})).addCategory(new x.C({title:(0,r.t)("dashboard-scene.get-panel-frame-options.title.panel-links","Panel links"),id:"Panel links",isOpenDefault:!1,itemsCount:L?.length}).addItem(new v.v({title:(0,r.t)("dashboard-scene.get-panel-frame-options.title.panel-links","Panel links"),render:()=>(0,n.jsx)(M,{panelLinks:T??void 0})}))),(0,E.y)(N)&&N.getOptions?.().forEach(V=>K.addCategory(V)),K}function M({panelLinks:_}){const{rawLinks:K}=_?_.useState():{rawLinks:[]};return(0,n.jsx)(o.e,{links:K,onChange:T=>_?.setState({rawLinks:T}),getSuggestions:m.Fq,data:[]})}function O({panel:_,isNewElement:K,id:T}){const{title:L}=_.useState(),A=_.getPanelContext().app!==s.Jk.PanelEditor,[N,V]=a.useState(_.state.title);let z=(0,d.z4)({autoFocus:A&&K});return(0,n.jsx)(l.p,{ref:z,"data-testid":i.Tp.components.PanelEditor.OptionsPane.fieldInput("Title"),id:T,value:L,onFocus:()=>V(L),onBlur:()=>B(_,L,N),onChange:w=>W(_,w.currentTarget.value)})}function j({panel:_,id:K}){const{description:T}=_.useState(),[L,A]=a.useState(_.state.description);return(0,n.jsx)(g.f,{id:K,value:T,onChange:N=>_.setState({description:N.currentTarget.value}),onFocus:()=>A(_.state.description),onBlur:()=>{y.cc.edit({description:(0,r.t)("dashboard.edit-actions.panel-description","Change panel description"),source:_,perform:()=>_.setState({description:T}),undo:()=>_.setState({description:L})})}})}function U({panel:_,id:K}){const{displayMode:T="default"}=_.useState(),L=()=>{const A=T==="default"?"transparent":"default";y.cc.edit({description:(0,r.t)("dashboard.edit-actions.panel-background","Change panel background"),source:_,perform:()=>_.setState({displayMode:A}),undo:()=>_.setState({displayMode:T})})};return(0,n.jsx)(f.d,{value:T==="transparent",id:K,onChange:L})}function W(_,K){_.setState({title:K,hoverHeader:S(K,_.state.$timeRange)})}function B(_,K,T=_.state.title){K!==T&&y.cc.edit({description:(0,r.t)("dashboard.edit-actions.panel-title","Change panel title"),source:_,perform:()=>W(_,K),undo:()=>W(_,T)})}function S(_,K){return!(_!==""||K instanceof h.v&&!K.state.hideTimeOverride&&(K.state.timeFrom||K.state.timeShift))}},82754:(te,R,e)=>{"use strict";e.d(R,{L:()=>s});var n=e(96540),a=e(93008);function s({direction:i,initialSize:r,dragPosition:u,collapseBelowPixels:o,collapsed:l,handleSize:g,usePixels:f}){const[p,c]=(0,n.useState)({collapsed:l??!1,snapSize:l?0:void 0}),x=(0,n.useCallback)((b,D,C)=>{b<=0&&D<=0&&C<=0||(p.collapsed&&C>o&&c({collapsed:!1}),!p.collapsed&&C<o&&c({collapsed:!0}))},[p,o]),v=(0,n.useCallback)((b,D,C)=>{if(b<=0&&D<=0&&C<=0)return;const P=p.snapSize===0;if(p.collapsed&&!P)c({snapSize:0,collapsed:p.collapsed});else if(p.collapsed&&P)if(f){const M=Math.max(C,r??200);c({snapSize:M,collapsed:!p.collapsed})}else{const M=Math.max(1-(r??.5),1-b);c({snapSize:M,collapsed:!p.collapsed})}},[p,r,f]),m=(0,n.useCallback)(()=>{c({collapsed:!p.collapsed})},[p.collapsed]),{containerProps:y,primaryProps:h,secondaryProps:d,splitterProps:E}=(0,a.h)({direction:i,dragPosition:u,handleSize:g,initialSize:r,usePixels:f,onResizing:x,onSizeChanged:v});return d.style.overflow="hidden",d.style.minWidth="unset",d.style.minHeight="unset",p.snapSize?f?d.style.flexBasis=`${p.snapSize}px`:(h.style={...h.style,flexGrow:1-p.snapSize},d.style.flexGrow=p.snapSize):p.snapSize===0&&(d.style.minWidth="min-content",d.style.minHeight="min-content",d.style.overflow="unset",f?d.style.flexBasis="0px":(h.style.flexGrow=1,d.style.flexGrow=0)),{containerProps:y,primaryProps:h,secondaryProps:d,splitterProps:E,splitterState:p,onToggleCollapse:m}}},3204:(te,R,e)=>{"use strict";e.d(R,{l:()=>P});var n=e(2543),a=e(36674),s=e(81041);const i=()=>new s.c(new URL(e.p+e.u(7061),e.b));var r=e(73816),u=e(55793),o=e(91135),l=e(75904),g=e(49e3),f=e(34960),p=e(72746),c=e(7094),x=e(32540),v=e(81657),m=e(25953),y=e(8835),h=e(93389),d=e(97335),E=e(97883),b=e(92769),D=e(37365),C=e(44741);class P{constructor(j){this._dashboard=j}static isUpdatingPersistedState({payload:j}){return Object.keys(j.partialUpdate).length===0?!1:!!(j.changedObject instanceof a.Eb||j.changedObject instanceof h.U||j.changedObject instanceof v.v||j.changedObject instanceof a.dt&&!Object.prototype.hasOwnProperty.call(j.partialUpdate,"data")||j.changedObject instanceof a.Es&&!Object.prototype.hasOwnProperty.call(j.partialUpdate,"data")||j.changedObject instanceof x.$||j.changedObject instanceof a.WM&&(Object.prototype.hasOwnProperty.call(j.partialUpdate,"intervals")||Object.prototype.hasOwnProperty.call(j.partialUpdate,"refresh"))||j.changedObject instanceof c.u&&Object.prototype.hasOwnProperty.call(j.partialUpdate,"name")||j.changedObject instanceof a.Gg.K2||j.changedObject instanceof a.kh||j.changedObject instanceof h.U||j.changedObject instanceof a.hy||j.changedObject instanceof p.H$&&Object.keys(j.partialUpdate).some(U=>p.vk.includes(U))||j.changedObject instanceof a.JZ||j.changedObject instanceof f.x&&Object.prototype.hasOwnProperty.call(j.partialUpdate,"hideTimeControls")||j.changedObject instanceof a.Pj||j.changedObject instanceof g.g&&!Object.prototype.hasOwnProperty.call(j.partialUpdate,"data")||j.changedObject instanceof a.Gg.en||(0,C.c7)(j.changedObject)||j.changedObject instanceof E.V||j.changedObject instanceof d.o||j.changedObject instanceof D.K||j.changedObject instanceof b.V||j.changedObject instanceof y.X2||j.changedObject instanceof m.X||j.changedObject instanceof l.H||j.changedObject instanceof o.K||j.changedObject instanceof u.M||j.changedObject instanceof r.t)}detectSaveModelChanges(){const j=this._dashboard.getSaveModel(),U=this._dashboard.getInitialSaveModel(),W=typeof j=="object"?JSON.parse(JSON.stringify(j)):j,B=typeof U=="object"?JSON.parse(JSON.stringify(U)):U;this._changesWorker?.postMessage({initial:B,changed:W})}hasMetadataChanges(){return this._dashboard.state.meta.folderUid!==this._dashboard.getInitialState()?.meta.folderUid}updateIsDirty(j){j||this.hasMetadataChanges()?this._dashboard.state.isDirty||this._dashboard.setState({isDirty:!0}):this._dashboard.state.isDirty&&this._dashboard.setState({isDirty:!1})}init(){this._changesWorker=i()}startTrackingChanges(){this._changesWorker||this.init(),this._changesWorker.onmessage=U=>{this.updateIsDirty(!!U.data.hasChanges)};const j=M(this.detectSaveModelChanges.bind(this));this._changeTrackerSub=this._dashboard.subscribeToEvent(a.bZ,U=>{P.isUpdatingPersistedState(U)&&j()})}stopTrackingChanges(){this._changeTrackerSub?.unsubscribe()}terminate(){this.stopTrackingChanges(),this._changesWorker?.terminate(),this._changesWorker=void 0}}function M(O){return(0,n.debounce)(O,250)}},17862:(te,R,e)=>{"use strict";e.d(R,{AM:()=>l,Cj:()=>f,yO:()=>m});var n=e(50803),a=e(60171),s=e(84500),i=e(61371);function r(y,h){try{let d=y;for(const E of h)d=d[E];return d}catch{return}}function u(y,h){return typeof y==typeof h&&(typeof y=="string"&&y===h||Array.isArray(y)&&y.length===h.length&&y.every((d,E)=>d===h[E]))}function o(y,h){return y===h||y&&h&&y.selected===h.selected&&u(y.text,h.text)&&u(y.value,h.value)}function l(y,h,d,E,b){const D=g(y),C=h,P=p(C.timeSettings,D.timeSettings),M=x(C,D,E),O=C.timeSettings.autoRefresh!==D.timeSettings.autoRefresh;d||(C.timeSettings.from=D.timeSettings.from,C.timeSettings.to=D.timeSettings.to),b||(C.timeSettings.autoRefresh=D.timeSettings.autoRefresh);const j=(0,i.G4)(y,C),U=Object.values(j).reduce((W,B)=>W+B.length,0);return{changedSaveModel:C,initialSaveModel:D,diffs:j,diffCount:U,hasChanges:U>0,hasTimeChanges:P,hasVariableValueChanges:M,hasRefreshChange:O,hasMigratedToV2:!(0,a.aK)(y)}}function g(y){if((0,a.aK)(y))return y;const h={dashboard:y,meta:{}};return n.Op.ensureV2Response(h).spec}function f(y,h,d,E,b){const D=y,C=h,P=p(C.time,D.time),M=v(C,D,E),O=C.refresh!==D.refresh;d||(C.time=D.time),b||(C.refresh=D.refresh);const j=(0,i.G4)(D,C),U=Object.values(j).reduce((W,B)=>W+B.length,0);return{changedSaveModel:C,initialSaveModel:D,diffs:j,diffCount:U,hasChanges:U>0,hasTimeChanges:P,isNew:C.version===0,hasVariableValueChanges:M,hasRefreshChange:O}}function p(y={},h={}){return y.from!==h.from||y.to!==h.to}function c(y,h){if(y===void 0&&h===void 0)return console.warn("Adhoc variable filter property is undefined"),!0;if(y===void 0&&h!==void 0||h===void 0&&y!==void 0)return console.warn("Adhoc variable filter property is undefined"),!1;if(y?.length!==h?.length)return!1;for(let d=0;d<(y?.length??0);d++){const E=y?.[d],b=h?.[d];if(E?.key!==b?.key||E?.operator!==b?.operator||E?.value!==b?.value)return!1}return!0}function x(y,h,d){const E=h.variables??[],b=y.variables??[];let D=!1;for(const C of b){const P=j=>j.kind==="QueryVariable"||j.kind==="CustomVariable"||j.kind==="DatasourceVariable"||j.kind==="ConstantVariable"||j.kind==="IntervalVariable"||j.kind==="TextVariable"||j.kind==="GroupByVariable",M=j=>j.kind==="QueryVariable"||j.kind==="CustomVariable"||j.kind==="DatasourceVariable"||j.kind==="IntervalVariable"||j.kind==="GroupByVariable",O=E.find(({spec:j,kind:U})=>j.name===C.spec.name&&U===C.kind);O&&((P(C)&&P(O)&&!o(C.spec.current,O.spec.current)||C.kind==="AdhocVariable"&&O.kind==="AdhocVariable"&&!c(C.spec.filters,O.spec.filters))&&(D=!0),d||(C.kind==="AdhocVariable"?C.spec.filters=O.spec.filters:(P(C)&&P(O)&&(C.spec.current=O.spec.current),M(C)&&M(O)&&(C.spec.options=O.spec.options))))}return D}function v(y,h,d){const E=h.templating?.list??[],b=y.templating?.list??[];let D=!1;for(const C of b){const P=E.find(({name:M,type:O})=>M===C.name&&O===C.type);if(P&&(P.current&&delete P.current.selected,o(C.current,P.current)?C.type==="adhoc"&&!c((0,s.Gs)(C?.filters),(0,s.Gs)(P?.filters))&&(D=!0):D=!0,!d)){const M=C;M.type==="adhoc"?M.filters=P.filters:(C.current=P.current,C.options=P.options)}}return D}function m(y,h){const d=(0,i.G4)(h,y),E=Object.values(d).reduce((b,D)=>b+D.length,0);return{changedSaveModel:y,initialSaveModel:h,diffs:d,diffCount:E,hasChanges:E>0}}},99454:(te,R,e)=>{"use strict";e.d(R,{a:()=>s,r:()=>a});var n=e(92745);function a(i,r){return r&&r!==i?.branch?"write":i?.workflows?.[0]}function s(i,r){return i?i.type==="local"?[{label:"Save",value:"write"}]:(!r&&i.branch&&(r=i.branch),i.workflows.map(u=>{switch(u){case"write":return{label:r?`Push to ${r}`:"Save",value:u};case"branch":return{label:(0,n.t)("dashboard-scene.get-workflow-options.label.push-to-a-new-branch","Push to a new branch"),value:u}}return{label:u,value:u}})):[]}},2522:(te,R,e)=>{"use strict";e.d(R,{S:()=>g});var n=e(96540),a=e(74101),s=e(75735),i=e(55266),r=e(99454);function u({timestamp:f,pathFromAnnotation:p,slug:c,folderPath:x=""}){let v="";if(p){const y=p.indexOf("#");return y>0?p.substring(0,y):p}return v=`${c||`new-dashboard-${f}`}.json`,x?`${x}/${v}`:v}var o=e(57512);function l({meta:f,defaultTitle:p,defaultDescription:c,loadedFromRef:x}){const v=f.k8s?.annotations,m=v?.[s.LH],y=v?.[s.Jw],h=v?.[s.Y_],{repository:d,folder:E,isLoading:b}=(0,i.T)({name:m==="repo"?y:void 0,folderName:f.folderUid}),D=(0,o.g)(),C=E?.metadata?.annotations?.[s.Y_],P=u({timestamp:D,pathFromAnnotation:h,slug:f.slug,folderPath:C});return b||!d?null:{values:{ref:`dashboard/${D}`,path:P,repo:y||d?.name||"",comment:"",folder:{uid:f.folderUid,title:""},title:p,description:c??"",workflow:(0,r.r)(d,x)},isNew:!f.k8s?.name,isGitHub:d?.type==="github",repository:d}}function g(f){const{meta:p,title:c,description:x}=f.useState(),[v]=(0,a.z)(),[m,y]=(0,n.useState)(!1),h=v.get("ref")??void 0,d=l({meta:p,defaultTitle:c,defaultDescription:x,loadedFromRef:h});if(!d)return{isReady:!1,isLoading:m,setIsLoading:y,defaultValues:null,repository:void 0,loadedFromRef:h,workflowOptions:[],isNew:!1,isGitHub:!1,readOnly:!0};const{values:E,isNew:b,isGitHub:D,repository:C}=d,P=(0,r.a)(C,h),M=!C?.workflows?.length;return{isReady:!0,defaultValues:E,repository:C,loadedFromRef:h,workflowOptions:P,isNew:b,isGitHub:D,readOnly:M,isLoading:m,setIsLoading:y}}},57512:(te,R,e)=>{"use strict";e.d(R,{g:()=>i});var n=e(97677),a=e.n(n),s=e(25229);function i(){const r=new n.Chance;return`${(0,s.KQ)().format("YYYY-MM-DD")}-${r.string({length:5,alpha:!0})}`}},7498:(te,R,e)=>{"use strict";e.d(R,{C:()=>C,S:()=>P});var n=e(65474),a=e(81160),s=e(739),i=e(76190),r=e(41119),u=e(28105),o=e(43173),l=e(36674),g=e(6890),f=e(64762),p=e(73427),c=e(47797),x=e(70327),v=e(78467),m=e(95443),y=e(52161),h=e(29609),d=e(8535),E=e(11257),b=e(24619),D=e(8285);class C extends l.VE{constructor(O){super({isEnabled:!0,...O,isHidden:!0}),this.hasAlertRules=!0,this.topic=s.QR.AlertStates,this.handleError=j=>{const U=(0,f.gi)("AlertStatesDataLayer",(0,c.q6)(j));(0,d.JD)((0,g.dx)(U))}}onEnable(){const O=l.jh.getTimeRange(this);this._timeRangeSub=O.subscribeToState(()=>{this.runWithTimeRange(O)})}onDisable(){this._timeRangeSub?.unsubscribe()}runLayer(){const O=l.jh.getTimeRange(this);this.runWithTimeRange(O)}async runWithTimeRange(O){const j=(0,D.YQ)(this),{uid:U,id:W}=j.state;if(this.querySub&&this.querySub.unsubscribe(),!this.canWork(O))return;const B=async()=>{const K=await(0,d.JD)(x.hK.endpoints.prometheusRuleNamespaces.initiate({ruleSourceName:y.hY,dashboardUid:U},{forceRefetch:!0}));if(K.error)throw new Error("Unexpected alert rules response.");return K.data},_=(0,n.H)(B()).pipe((0,a.T)(K=>(0,v.Kw)(K))).pipe((0,a.T)(K=>{this.hasAlertRules=!1;const T={};return K.forEach(L=>L.rules.forEach(A=>{if(h.R$.alertingRule(A)&&A.annotations?.[m.YH.panelID]){this.hasAlertRules=!0;const N=Number(A.annotations[m.YH.panelID]),V=P(A.state);T[N]?V===i.O.Alerting&&T[N].state!==i.O.Alerting?T[N].state=i.O.Alerting:V===i.O.Pending&&T[N].state!==i.O.Alerting&&T[N].state!==i.O.Pending&&(T[N].state=i.O.Pending):T[N]={state:V,id:Object.keys(T).length,panelId:N,dashboardId:W}}})),Object.values(T)}));this.querySub=_.subscribe({next:K=>{const T=(0,r.Vc)(K);this.publishResults({state:u.Gu.Done,series:[{...T,meta:{...T.meta,dataTopic:s.QR.AlertStates}}],timeRange:O.state.value})},error:K=>{this.handleError(K),this.publishResults({state:u.Gu.Error,series:[],errors:[{message:(0,c.q6)(K)}],timeRange:O.state.value})}})}canWork(O){const j=(0,D.YQ)(this),{uid:U}=j.state;return!(!U||o.$.publicDashboardAccessToken||O.state.value.raw.to!=="now"||this.hasAlertRules===!1||!(p.TP.hasPermission(E.w.AlertingRuleRead)&&p.TP.hasPermission(E.w.AlertingRuleExternalRead)))}}function P(M){return M===b.cF.Firing?i.O.Alerting:M===b.cF.Pending?i.O.Pending:i.O.OK}},49e3:(te,R,e)=>{"use strict";e.d(R,{g:()=>o});var n=e(22592),a=e(27359),s=e(739),i=e(43173),r=e(36674),u=e(42942);class o extends r.tV.g{async resolveDataSource(g){return i.$.publicDashboardAccessToken?new u.X:super.resolveDataSource(g)}processEvents(g,f){if(i.$.publicDashboardAccessToken){const p={series:[],timeRange:(0,n.E2)(),state:f.state},c=(0,a.I)(f.events);return c.meta={...c.meta,dataTopic:s.QR.Annotations},p.annotations=[c],p}else return super.processEvents(g,f)}}},34960:(te,R,e)=>{"use strict";e.d(R,{x:()=>M});var n=e(74848),a=e(22803),s=e(7389),i=e(51898),r=e(36674),u=e(63142),o=e(31286),l=e(41654),g=e(92745),f=e(21285);function p({panelEditor:W}){const{tableView:B,dataPane:S}=W.useState();return(0,n.jsx)(n.Fragment,{children:S&&(0,n.jsx)(f.K,{label:(0,g.t)("dashboard-scene.panel-edit-controls.table-view-label-table-view","Table view"),showLabel:!0,id:"table-view",value:!!B,onClick:W.onToggleTableView,"aria-label":(0,g.t)("dashboard-scene.panel-edit-controls.table-view-aria-label-toggletableview","Toggle table view"),"data-testid":i.Tp.components.PanelEditor.toggleTableView})})}var c=e(8285),x=e(63704),v=e(45967),m=e(4137),y=e(82345),h=e(86871);function d({links:W,dashboard:B}){r.jh.getTimeRange(B).useState();const S=B.state.uid;return!W||!S?null:(0,n.jsx)(n.Fragment,{children:W.map((_,K)=>{const T=(0,y.mQ)().getAnchorInfo(_),L=`${_.title}-$${K}`;if(_.type==="dashboards")return(0,n.jsx)(m.aK,{link:_,linkInfo:T,dashboardUID:S},L);const A=h.G[_.icon],N=(0,n.jsx)(m.Zx,{icon:A,href:(0,x.Jf)(T.href),target:_.targetBlank?"_blank":void 0,rel:"noreferrer","data-testid":i.Tp.components.DashboardLinks.link,children:T.title});return(0,n.jsx)("div",{"data-testid":i.Tp.components.DashboardLinks.container,children:_.tooltip?(0,n.jsx)(v.m,{content:T.tooltip,children:N}):N},L)})})}var E=e(56887);function b({dashboard:W}){const B=r.jh.getVariables(W).useState();return(0,n.jsx)(n.Fragment,{children:B.variables.map(S=>(0,n.jsx)(D,{variable:S},S.state.key))})}function D({variable:W}){const B=(0,r.gn)(W,{shouldActivateOrKeepAlive:!0}),{isSelected:S,onSelect:_,isSelectable:K}=(0,E.y)(W.state.key),T=(0,u.of)(P);if(B.hide===s.zL.hideVariable)return W.UNSAFE_renderAsHidden?(0,n.jsx)(W.Component,{model:W}):null;const L=A=>{if(K){if(A.target instanceof Element&&!A.target.closest("label")){A.stopPropagation();return}K&&_&&(A.stopPropagation(),_(A))}};return(0,n.jsxs)("div",{className:(0,a.cx)(T.container,S&&"dashboard-selected-element",K&&!S&&"dashboard-selectable-element"),onPointerDown:L,"data-testid":i.Tp.pages.Dashboard.SubMenu.submenuItem,children:[(0,n.jsx)(C,{variable:W,className:(0,a.cx)(K&&T.labelSelectable)}),(0,n.jsx)(W.Component,{model:W})]})}function C({variable:W,className:B}){const{state:S}=W;if(W.state.hide===s.zL.hideLabel)return null;const _=S.label||S.name,K=`var-${S.key}`;return(0,n.jsx)(r.Zx,{htmlFor:K,isLoading:S.loading,onCancel:()=>W.onCancel?.(),label:_,error:S.error,layout:"horizontal",description:S.description??void 0,className:B})}const P=W=>({container:(0,a.css)({display:"flex","> :nth-child(2)":(0,a.css)({borderTopLeftRadius:"unset",borderBottomLeftRadius:"unset"})}),labelWrapper:(0,a.css)({display:"flex",alignItems:"center"}),labelSelectable:(0,a.css)({cursor:"pointer"})});class M extends r.Bs{constructor(B){super({timePicker:B.timePicker??new r.KE({}),refreshPicker:B.refreshPicker??new r.WM({}),...B}),this._variableDependency=new r.Sh(this,{onAnyVariableChanged:this._onAnyVariableChanged.bind(this)}),this._urlSync=new r.So(this,{keys:["_dash.hideTimePicker","_dash.hideVariables","_dash.hideLinks"]}),this.addActivationHandler(()=>{let S;return this.state.hideTimeControls&&(S=this.state.refreshPicker.activate()),()=>{S&&S()}})}static{this.Component=O}getUrlState(){return{}}updateFromUrl(B){const{hideTimeControls:S,hideVariableControls:_,hideLinksControls:K}=this.state,T=L=>B[L]==="true"||B[L]==="";!S&&T("_dash.hideTimePicker")&&this.setState({hideTimeControls:!0}),!_&&T("_dash.hideVariables")&&this.setState({hideVariableControls:!0}),!K&&T("_dash.hideLinks")&&this.setState({hideLinksControls:!0})}_onAnyVariableChanged(){(0,c.YQ)(this).state.links?.length>0&&this.forceRender()}hasControls(){const B=r.jh.getVariables(this)?.state.variables.some(A=>A.state.hide!==s.zL.hideVariable),S=r.jh.getDataLayers(this).some(A=>A.state.isEnabled&&!A.state.isHidden),_=(0,c.YQ)(this).state.links?.length>0,K=this.state.hideLinksControls||!_,T=this.state.hideVariableControls||!S&&!B,L=this.state.hideTimeControls;return!(T&&K&&L)}}function O({model:W}){const{refreshPicker:B,timePicker:S,hideTimeControls:_,hideVariableControls:K,hideLinksControls:T}=W.useState(),L=(0,c.YQ)(W),{links:A,editPanel:N}=L.useState(),V=(0,u.of)(U),z=window.location.search.includes("scene-debugger");return W.hasControls()?(0,n.jsxs)("div",{"data-testid":i.Tp.pages.Dashboard.Controls,className:(0,a.cx)(V.controls,N&&V.controlsPanelEdit),children:[(0,n.jsxs)(l.B,{grow:1,wrap:"wrap",children:[!K&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(b,{dashboard:L}),(0,n.jsx)(j,{dashboard:L})]}),(0,n.jsx)(o.a,{grow:1}),!T&&!N&&(0,n.jsx)(d,{links:A,dashboard:L}),N&&(0,n.jsx)(p,{panelEditor:N})]}),!_&&(0,n.jsxs)(l.B,{justifyContent:"flex-end",children:[(0,n.jsx)(S.Component,{model:S}),(0,n.jsx)(B.Component,{model:B})]}),z&&(0,n.jsx)(r.or,{scene:W},"scene-debugger")]}):(0,n.jsx)(o.a,{padding:1})}function j({dashboard:W}){const B=r.jh.getDataLayers(W,!0);return(0,n.jsx)(n.Fragment,{children:B.map(S=>(0,n.jsx)(S.Component,{model:S},S.state.key))})}function U(W){return{controls:(0,a.css)({display:"flex",alignItems:"flex-start",flex:"100%",gap:W.spacing(1),padding:W.spacing(2),flexDirection:"row",flexWrap:"nowrap",position:"relative",width:"100%",marginLeft:"auto",[W.breakpoints.down("sm")]:{flexDirection:"column-reverse",alignItems:"stretch"}}),controlsPanelEdit:(0,a.css)({paddingRight:0}),embedded:(0,a.css)({background:"unset",position:"unset"})}}},88632:(te,R,e)=>{"use strict";e.d(R,{s:()=>s});var n=e(74848),a=e(36674);class s extends a.ps{constructor(r){super({...r,name:r.name??"Data layers",annotationLayers:r.annotationLayers??[]}),this.addActivationHandler(()=>this._onActivate())}_onActivate(){return this._subs.add(this.subscribeToState((r,u)=>{r.annotationLayers!==u.annotationLayers&&(this.querySub?.unsubscribe(),this.subscribeToAllLayers(this.getAllLayers()))})),this.subscribeToAllLayers(this.getAllLayers()),()=>{this.querySub?.unsubscribe()}}addAnnotationLayer(r){this.setState({annotationLayers:[...this.state.annotationLayers,r]})}getAllLayers(){const r=[...this.state.annotationLayers];return this.state.alertStatesLayer&&r.push(this.state.alertStatesLayer),r}static{this.Component=({model:r})=>{const{annotationLayers:u}=r.useState();return(0,n.jsx)(n.Fragment,{children:u.map(o=>(0,n.jsx)(o.Component,{model:o},o.state.key))})}}}},36605:(te,R,e)=>{"use strict";e.d(R,{L:()=>r});var n=e(36674),a=e(9931),s=e(18615),i=e(8285);class r extends n.Bs{constructor(o){super(o),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){const o=this.parent;let l,g,f;if(!(o instanceof n.dt))throw new Error("DashboardDatasourceBehaviour must be attached to a SceneQueryRunner");if(!this.containsDashboardDSQueries(o))return;try{f=(0,i.YQ)(o)}catch{return}const p=o.state.queries.find(d=>d.panelId!==void 0);if(!p)return;const c=p.panelId,x=(0,i.XA)(c),v=(0,i.EX)(f,x);if(!(v instanceof n.Eb))return;const m=(0,i.iL)(v);if(m&&!m.state.isLoaded){l=m.subscribeToState(d=>{this.handleLibPanelStateUpdates(d,o,v)});return}const y=(0,i.un)(v);if(!y)throw new Error("Could not find SceneQueryRunner for panel");const h=y.parent;return h instanceof n.Es&&h.state.transformations.length&&(g=h.subscribeToState((d,E)=>{d.data!==E.data&&o.runQueries()})),this.prevRequestId&&this.prevRequestId!==y.state.data?.request?.requestId&&o.runQueries(),()=>{this.prevRequestId=y?.state.data?.request?.requestId,l&&l.unsubscribe(),g&&g.unsubscribe()}}containsDashboardDSQueries(o){return o.state.datasource?.uid===a.K?!0:o.state.datasource?.uid===s.uv&&o.state.queries.some(l=>l.datasource?.uid===a.K)}handleLibPanelStateUpdates(o,l,g){if(o&&o?.isLoaded){if(!((0,i.un)(g)instanceof n.dt))throw new Error("Could not find SceneQueryRunner for library panel");l.runQueries()}}}},88499:(te,R,e)=>{"use strict";e.d(R,{M:()=>i});var n=e(36674),a=e(8285);class s{constructor(u,o){this._sceneObject=o,this.state={name:u,type:"dashboard_macro"}}getValue(u){const o=(0,a.YQ)(this._sceneObject);switch(u){case"uid":return o.state.uid||"";case"title":case"name":case"id":default:return o.state.title}}getValueText(){return""}}function i(){const r=n.Go.registerVariableMacro("__dashboard",s);return()=>r()}},44804:(te,R,e)=>{"use strict";e.d(R,{s:()=>o});var n=e(2543),a=e.n(n),s=e(36674),i=e(60379),r=e(41644),u=e(72746);class o extends s.Bs{constructor(g){super(g),this._log=(0,i.h)("DashboardReloadBehavior"),this.reloadDashboard=(0,n.debounce)(this.reloadDashboard).bind(this);const f=!!this.state.uid&&!!this.state.reloadOnParamsChange;this.addActivationHandler(()=>{f&&(this._dashboardScene=s.jh.getAncestor(this,u.H$),this._variableDependency=new s.Sh(this,{onAnyVariableChanged:p=>{this._log.logger("onAnyVariableChanged",p.state.name,JSON.stringify(p.getValue())),this.reloadDashboard()},dependsOnScopes:!0}))})}getCurrentState(){const g=s.jh.getScopes(this)??[],f=s.jh.getTimeRange(this).state.value;return{scopes:g.map(p=>p.metadata.name),from:f.from.toISOString(),to:f.to.toISOString(),...s.Go.getUrlState(this._dashboardScene?.state.$variables),version:this._dashboardScene?.state.version}}isEditing(){return!!this._dashboardScene?.state.isEditing}isWaitingForVariables(){const g=s.jh.getVariables(this.parent);return g.state.variables.some(f=>g.isVariableLoadingOrWaitingToUpdate(f))}reloadDashboard(){if(this.isEditing()||this.isWaitingForVariables()){this._log.logger("DashboardReloadBehavior reloadDashboard isEditing or waiting for variables, skipping reload");return}const g=this.getCurrentState(),f=this._prevState??{};f.from=g.from,f.to=g.to;const p=!(0,n.isEqual)(g,this._prevState);this._log.logger(`DashboardReloadBehavior reloadDashboard stateChanged ${p?"true":"false"}`,this._prevState,g),p&&(this._prevState=g,setTimeout(()=>{(0,r.sP)().reloadDashboard(g)}))}}},72746:(te,R,e)=>{"use strict";e.d(R,{H$:()=>yi,vk:()=>Qc});var n=e(92138),a=e(1906),s=e(92745),i=e(36490),r=e(43173),u=e(75234),o=e(36674),l=e(45229),g=e(95943),f=e(84057),p=e(29043),c=e(10605),x=e(22429),v=e(7817),m=e(82612),y=e(79718),h=e(88813),d=e(87745),E=e(75735),b=e(3688),D=e(3371),C=e(8285);function P(Ie){return"onDelete"in Ie}var M=e(73427);class O{constructor(pe){this._elements=pe,this.isEditableDashboardElement=!0}useEditPaneOptions(){return[]}getEditableElementInfo(){return{typeName:(0,s.t)("dashboard.edit-pane.elements.objects","Objects"),icon:"folder",instanceName:""}}onConfirmDelete(){M.lE.publish(new d.bY({title:(0,s.t)("dashboard.edit-pane.elements.multiple-elements","Multiple elements"),text:(0,s.t)("dashboard.edit-pane.elements.multiple-elements-delete-text","Are you sure you want to delete these elements?"),onConfirm:()=>this.onDelete()}))}onDelete(){this._elements.forEach(pe=>pe.onDelete())}}var j=e(33143);class U{constructor(pe){this._isNewElement=!1,this.selectedObjects=new Map(pe),this._isMultiSelection=pe.length>1,this.isMultiSelection&&(this.sameType=this.checkSameType())}markAsNewElement(){this._isNewElement=!0}isNewElement(){return this._isNewElement}checkSameType(){const pe=this.selectedObjects.values(),Ce=pe.next().value?.resolve().constructor.name;if(!Ce)return!1;for(let ke of pe??[])if(ke.resolve().constructor.name!==Ce)return!1;return!0}hasValue(pe){return this.selectedObjects.has(pe)}removeValue(pe){this.selectedObjects.delete(pe),this.selectedObjects.size<2&&(this.sameType=void 0,this._isMultiSelection=!1)}getStateWithValue(pe,Ce,ke){const ut=Ce.getRef();let vt=[{id:pe}],At=[[pe,ut]];const jt=this.getSelectionEntries()??[],$t=jt.map(([Yt])=>({id:Yt}));return ke&&(At=[[pe,ut],...jt],vt=[{id:pe},...$t]),{selection:At,contextItems:vt}}getStateWithoutValueAt(pe){this.removeValue(pe);const Ce=this.getSelectionEntries()??[],ke=Ce.map(([ut])=>({id:ut}));return{entries:Ce,contextItems:ke}}getSelection(){return this.isMultiSelection?this.getSceneObjects():this.getFirstObject()}getSelectionEntries(){return Array.from(this.selectedObjects.entries())}getFirstObject(){return this.selectedObjects.values().next().value?.resolve()}get isMultiSelection(){return this._isMultiSelection}getSceneObjects(){return Array.from(this.selectedObjects.values()??[]).map(pe=>pe.resolve())}createSelectionElement(){const pe=this.getSceneObjects();if(pe.length===0)return;const Ce=(0,j.wT)(pe[0]);if(!Ce)return;if(pe.length===1)return Ce;if(this.sameType&&Ce.createMultiSelectedElement){const ut=pe.map(vt=>(0,j.wT)(vt));return Ce.createMultiSelectedElement(ut)}const ke=[];for(const ut of pe){const vt=(0,j.wT)(ut);vt&&P(vt)&&ke.push(vt)}if(ke.length)return new O(ke)}}class W extends o.Bs{constructor(){super({selectionContext:{enabled:!1,selected:[],onSelect:(pe,Ce)=>this.selectElement(pe,Ce),onClear:()=>this.clearSelection()},undoStack:[],redoStack:[]}),this.addActivationHandler(this.onActivate.bind(this))}onActivate(){const pe=(0,C.YQ)(this);this._subs.add(pe.subscribeToEvent(j.BF,({payload:Ce})=>{this.handleEditAction(Ce)})),this._subs.add(pe.subscribeToEvent(j.jO,({payload:Ce})=>{this.newObjectAddedToCanvas(Ce)})),this._subs.add(pe.subscribeToEvent(j.ck,({payload:Ce})=>{this.clearSelection()})),this._subs.add(pe.subscribeToEvent(j.su,({payload:Ce})=>{this.forceRender()})),this._subs.add(pe.subscribeToEvent(j.N4,({payload:Ce})=>{this.forceRender()}))}handleEditAction(pe){if(this.state.redoStack.length>0&&this.setState({redoStack:[]}),this.performAction(pe),this.setState({undoStack:[...this.state.undoStack,pe]}),pe.source instanceof o.Eb){const Ce=pe.source.parent;(0,b.y)(Ce)&&Ce.editingCompleted&&Ce.editingCompleted(!0)}}undoAction(){const pe=this.state.undoStack.slice(),Ce=pe.pop();Ce&&(Ce.undo(),Ce.source.publishEvent(new j.WG({source:Ce.source}),!0),Ce.addedObject&&this.clearSelection(),Ce.movedObject&&this.selectObject(Ce.movedObject,Ce.movedObject.state.key,{force:!0}),Ce.removedObject&&this.newObjectAddedToCanvas(Ce.removedObject),this.setState({undoStack:pe,redoStack:[...this.state.redoStack,Ce]}))}performAction(pe){pe.perform(),pe.source.publishEvent(new j.WG({source:pe.source}),!0),pe.addedObject&&this.newObjectAddedToCanvas(pe.addedObject),pe.movedObject&&this.selectObject(pe.movedObject,pe.movedObject.state.key,{force:!0}),pe.removedObject&&this.clearSelection()}redoAction(){const pe=this.state.redoStack.slice(),Ce=pe.pop();Ce&&(this.performAction(Ce),this.setState({redoStack:pe,undoStack:[...this.state.undoStack,Ce]}))}enableSelection(){this.setState({selectionContext:{...this.state.selectionContext,enabled:!0}})}disableSelection(){this.setState({selectionContext:{...this.state.selectionContext,selected:[],enabled:!1},selection:void 0})}selectElement(pe,Ce){if((0,D.uc)(pe.id)){if(Ce.multi)return;this.clearSelection();return}let ke=o.jh.findByKey(this,pe.id);if(ke){if(ke instanceof o.Eb&&(0,D.ag)((0,D.Dq)(pe.id))){const ut=(0,C.Uv)(this,pe.id);ut&&(ke=ut)}this.selectObject(ke,pe.id,Ce)}}getSelection(){return this.state.selection?.getSelection()}selectObject(pe,Ce,{multi:ke,force:ut}={}){if(!ut){if(ke){if(this.state.selection?.hasValue(Ce)){this.removeMultiSelectedObject(Ce);return}}else if(this.state.selection?.getFirstObject()===pe){this.clearSelection();return}}const vt=this.state.selection??new U([[Ce,pe.getRef()]]),{selection:At,contextItems:jt}=vt.getStateWithValue(Ce,pe,!!ke);this.updateSelection(new U(At),jt)}removeMultiSelectedObject(pe){if(!this.state.selection)return;const{entries:Ce,contextItems:ke}=this.state.selection.getStateWithoutValueAt(pe);if(Ce.length===0){this.clearSelection();return}this.updateSelection(new U([...Ce]),ke)}updateSelection(pe,Ce){document.activeElement instanceof HTMLElement&&document.activeElement.blur(),this.setState({selection:pe,selectionContext:{...this.state.selectionContext,selected:Ce}})}clearSelection(){this.state.selection&&this.updateSelection(void 0,[])}newObjectAddedToCanvas(pe){this.selectObject(pe,pe.state.key),this.state.selection?.markAsNewElement()}}var B=e(3204),S=e(74848),_=e(54314),K=e(60208),T=e(8207),L=e(30906),A=e(55266);function N(Ie){const Ce=new URLSearchParams(window.location.search).get("folderUid")||void 0,{repository:ke,isInstanceManaged:ut}=(0,A.T)({folderName:Ce});return r.$.featureToggles.provisioning?Ie.isManagedRepository()||!!ke||ut:!1}var V=e(76459),z=e.n(V),w=e(96540),H=e(49785),Q=e(51898),Z=e(45861),Y=e(34999),X=e(41654),I=e(37386),J=e(63527),ee=e(87105),q=e(21285),ne=e(31286),se=e(72636),oe=e(91156),de=e(89223),fe=e(87161),ae=e(8535);async function ce(Ie){if(!Ie||!r.$.featureToggles.provisioning)return{};const Ce=(await(0,ae.JD)(fe.Z.endpoints.getFolder.initiate({name:Ie})).unwrap()).metadata.annotations?.[E.Jw];return Ce?{k8s:{annotations:{[E.Jw]:Ce,[E.LH]:E.Sf.Repo}}}:{}}var ie=e(68143);function ve(Ie){return(0,ie.NF)(Ie)&&Ie.data&&Ie.data.status==="version-mismatch"}function le(Ie){return(0,ie.NF)(Ie)&&Ie.data&&Ie.data.status==="name-exists"}function Ee(Ie){return(0,ie.NF)(Ie)&&Ie.data&&Ie.data.status==="plugin-dashboard"}function Re({cancelButton:Ie,saveButton:pe}){return r.$.featureToggles.restoreDashboards?(0,S.jsxs)(Y.F,{title:(0,s.t)("save-dashboards.name-exists.title","Dashboard name already exists"),severity:"error",children:[(0,S.jsx)("p",{children:(0,S.jsx)(s.x6,{i18nKey:"save-dashboards.name-exists.message-info",children:"A dashboard with the same name in the selected folder already exists, including recently deleted dashboards."})}),(0,S.jsx)("p",{children:(0,S.jsx)(s.x6,{i18nKey:"save-dashboards.name-exists.message-suggestion",children:"Please choose a different name or folder."})})]}):(0,S.jsxs)(Y.F,{title:(0,s.t)("dashboard-scene.name-already-exists-error.title-name-already-exists","Name already exists"),severity:"error",children:[(0,S.jsx)("p",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.name-already-exists-error.body-name-already-exists",children:"A dashboard with the same name in selected folder already exists. Would you still like to save this dashboard?"})}),(0,S.jsx)(ne.a,{paddingTop:2,children:(0,S.jsxs)(X.B,{alignItems:"center",children:[Ie,pe(!0)]})})]})}function Oe({overwrite:Ie,isLoading:pe,isValid:Ce,onSave:ke}){return(0,S.jsx)(Z.$n,{disabled:!Ce||pe,icon:pe?"spinner":void 0,onClick:()=>ke(Ie),variant:Ie?"destructive":"primary","data-testid":Q.Tp.components.Drawer.DashboardSaveDrawer.saveButton,children:pe?(0,s.t)("dashboard-scene.save-button.saving","Saving..."):Ie?(0,s.t)("dashboard-scene.save-button.save-and-overwrite","Save and overwrite"):(0,s.t)("dashboard-scene.save-button.save","Save")})}var Se=e(41053),Te=e(27489),_e=e(64762),He=e(38206),tt=e(18346),Je=e(52763),Ge=e(77731);function je(Ie=!1){const pe=(0,Je.wA)(),Ce=(0,_e._2)(),[ke]=(0,tt.e8)(),[ut,vt]=(0,Se.A)(async(At,jt)=>{{let $t=jt.rawDashboardJSON??At.getSaveModel();jt.saveAsCopy&&($t=At.getSaveAsModel({isNew:jt.isNew,title:jt.title,description:jt.description,copyTags:jt.copyTags}));const Yt=await ke({dashboard:$t,folderUid:jt.folderUid,message:jt.message,overwrite:jt.overwrite,showErrorAlert:!1,k8s:jt.k8s});if("error"in Yt)throw Yt.error;const qt=Yt.data;At.saveCompleted($t,qt,jt.folderUid),l.A.publish(new d.Eu),Ce.success((0,s.t)("dashboard-scene.use-save-dashboard.message-dashboard-saved","Dashboard saved")),(0,Ge.ko)(qt.uid),Ie?(0,Te.rR)("grafana_dashboard_copied",{name:$t.title,url:qt.url}):(0,Te.rR)(`grafana_dashboard_${qt.uid?"saved":"created"}`,{name:$t.title,url:qt.url});const hn=i.Ny.getLocation(),Cn=n.I.stripBaseFromUrl(qt.url);return Cn!==hn.pathname&&setTimeout(()=>{i.Ny.push({pathname:Cn,search:hn.search})}),At.state.meta.isStarred&&pe((0,He.TU)({id:qt.uid,title:At.state.title,url:Cn})),Yt.data}},[pe,Ce]);return{state:ut,onSaveDashboard:vt}}function Fe({dashboard:Ie,changeInfo:pe}){const{changedSaveModel:Ce}=pe,{register:ke,handleSubmit:ut,setValue:vt,formState:At,getValues:jt,watch:$t}=(0,H.mN)({mode:"onBlur",defaultValues:{title:pe.isNew?Ce.title:`${Ce.title} Copy`,description:Ce.description??"",folder:{uid:Ie.state.meta.folderUid,title:Ie.state.meta.folderTitle},copyTags:!1}}),{errors:Yt,isValid:qt}=At,hn=$t(),{state:Cn,onSaveDashboard:Nn}=je(!1),[In,un]=(0,w.useState)({}),[Sn,fa]=(0,w.useState)(!1),zn=async pa=>{const Un=jt();(await Nn(Ie,{overwrite:pa,folderUid:Un.folder.uid,rawDashboardJSON:Ce,saveAsCopy:!0,isNew:pe.isNew,copyTags:Un.copyTags,title:Un.title,description:Un.description})).status==="success"?Ie.closeModal():un({title:Un.title,folderUid:Un.folder.uid})},sa=(0,S.jsx)(Z.$n,{variant:"secondary",onClick:()=>Ie.closeModal(),fill:"outline",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-dashboard-as-form.cancel-button.cancel",children:"Cancel"})}),Bn=pa=>{const Un=!qt&&Sn?!0:qt;return(0,S.jsx)(Oe,{isValid:Un,isLoading:Cn.loading,onSave:zn,overwrite:pa})};function qn(pa){const Un=hn.title.trim()===In.title&&hn.folder.uid===In.folderUid;return le(pa)&&Un?(0,S.jsx)(Re,{cancelButton:sa,saveButton:Bn}):(0,S.jsxs)(S.Fragment,{children:[pa&&Un&&(0,S.jsx)(Y.F,{title:(0,s.t)("dashboard-scene.save-dashboard-as-form.render-footer.title-failed-to-save-dashboard","Failed to save dashboard"),severity:"error",children:pa.message&&(0,S.jsx)("p",{children:pa.message})}),(0,S.jsxs)(X.B,{alignItems:"center",children:[sa,Bn(!1)]})]})}return(0,S.jsxs)("form",{onSubmit:ut(()=>zn(!1)),children:[(0,S.jsx)(I.D,{label:(0,S.jsx)(Be,{onChange:vt}),invalid:!!Yt.title,error:Yt.title?.message,children:(0,S.jsx)(J.p,{...ke("title",{required:"Required",validate:Ue}),"aria-label":(0,s.t)("dashboard-scene.save-dashboard-as-form.aria-label-save-dashboard-title-field","Save dashboard title field"),"data-testid":Q.Tp.components.Drawer.DashboardSaveDrawer.saveAsTitleInput,onChange:z()(async pa=>{vt("title",pa.target.value,{shouldValidate:!0})},400)})}),(0,S.jsx)(I.D,{label:(0,S.jsx)(Ke,{onChange:vt}),invalid:!!Yt.description,error:Yt.description?.message,children:(0,S.jsx)(ee.f,{...ke("description",{required:!1}),"aria-label":(0,s.t)("dashboard-scene.save-dashboard-as-form.aria-label-save-dashboard-description-field","Save dashboard description field"),autoFocus:!0})}),(0,S.jsx)(I.D,{label:(0,s.t)("dashboard-scene.save-dashboard-as-form.label-folder","Folder"),children:(0,S.jsx)(oe.d,{onChange:async(pa,Un)=>{vt("folder",{uid:pa,title:Un});const cs=Ie.state.meta.folderUid;fa(pa!==cs);const wr=await ce(pa);Ie.setState({meta:{...wr,folderUid:pa}})},value:hn.folder?.uid})}),!pe.isNew&&(0,S.jsx)(I.D,{label:(0,s.t)("dashboard-scene.save-dashboard-as-form.label-copy-tags","Copy tags"),children:(0,S.jsx)(q.d,{...ke("copyTags")})}),(0,S.jsx)(ne.a,{paddingTop:2,children:qn(Cn.error)})]})}function Be(Ie){return(0,S.jsx)(X.B,{justifyContent:"space-between",children:(0,S.jsx)(se.J,{htmlFor:"description",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.title-field-label.title",children:"Title"})})})}function Ke(Ie){return(0,S.jsx)(X.B,{justifyContent:"space-between",children:(0,S.jsx)(se.J,{htmlFor:"description",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.description-label.description",children:"Description"})})})}async function Ue(Ie,pe){if(Ie===pe.folder.title?.trim())return"Dashboard name cannot be the same as folder name";try{return await de.P.validateNewDashboardName(pe.folder.uid??"general",Ie),!0}catch(Ce){return Ce instanceof Error?Ce.message:"Dashboard name is invalid"}}var we=e(32635);function Xe({dashboard:Ie,drawer:pe,changeInfo:Ce}){const{hasChanges:ke,hasMigratedToV2:ut,changedSaveModel:vt}=Ce,{state:At,onSaveDashboard:jt}=je(!1),[$t,Yt]=(0,w.useState)({folderUid:Ie.state.meta.folderUid,k8s:{...Ie.serializer.getK8SMetadata()}}),qt=async un=>{(await jt(Ie,{...$t,rawDashboardJSON:vt,overwrite:un})).status==="success"&&(Ie.closeModal(),pe.state.onSaveSuccess?.())},hn=(0,S.jsx)(Z.$n,{variant:"secondary",onClick:()=>Ie.closeModal(),fill:"outline",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-dashboard-form.cancel-button.cancel",children:"Cancel"})}),Cn=un=>(0,S.jsx)(Oe,{isValid:ke,isLoading:At.loading,onSave:qt,overwrite:un}),Nn=un=>un&&un.length>500;function In(un){if(Nn($t.message)){const Sn=$t.message?.length??0;return(0,S.jsx)(Y.F,{title:(0,s.t)("save-dashboards.message-length.title","Message too long"),severity:"error",children:(0,S.jsx)("p",{children:(0,S.jsxs)(s.x6,{i18nKey:"save-dashboards.message-length.info",children:["The message is ",{messageLength:Sn}," characters, which exceeds the maximum length of 500 characters. Please shorten it before saving."]})})})}return ve(un)?(0,S.jsxs)(Y.F,{title:(0,s.t)("dashboard-scene.save-dashboard-form.render-footer.title-someone-else-has-updated-this-dashboard","Someone else has updated this dashboard"),severity:"error",children:[(0,S.jsx)("p",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-dashboard-form.render-footer.would-still-dashboard",children:"Would you still like to save this dashboard?"})}),(0,S.jsx)(ne.a,{paddingTop:2,children:(0,S.jsxs)(X.B,{alignItems:"center",children:[hn,Cn(!0)]})})]}):le(un)?(0,S.jsx)(Re,{cancelButton:hn,saveButton:Cn}):Ee(un)?(0,S.jsxs)(Y.F,{title:(0,s.t)("dashboard-scene.save-dashboard-form.render-footer.title-plugin-dashboard","Plugin dashboard"),severity:"error",children:[(0,S.jsx)("p",{children:(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.save-dashboard-form.render-footer.body-plugin-dashboard",children:["Your changes will be lost when you update the plugin. Use ",(0,S.jsx)("strong",{children:"Save as"})," to create custom version."]})}),(0,S.jsx)(ne.a,{paddingTop:2,children:(0,S.jsxs)(X.B,{alignItems:"center",children:[hn,Cn(!0)]})})]}):(0,S.jsxs)(S.Fragment,{children:[un&&(0,S.jsx)(Y.F,{title:(0,s.t)("dashboard-scene.save-dashboard-form.render-footer.title-failed-to-save-dashboard","Failed to save dashboard"),severity:"error",children:(0,S.jsx)("p",{children:un.message})}),(0,S.jsxs)(X.B,{alignItems:"center",children:[hn,Cn(!1),!ke&&(0,S.jsx)("div",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-dashboard-form.render-footer.no-changes-to-save",children:"No changes to save"})})]})]})}return(0,S.jsxs)(X.B,{gap:2,direction:"column",children:[(0,S.jsx)(nt,{drawer:pe,changeInfo:Ce}),ut&&(0,S.jsx)(Y.F,{title:(0,s.t)("dashboard-scene.save-dashboard-form.title-dashboard-drastically-changed","Dashboard irreversibly changed"),severity:"warning",children:(0,S.jsx)("p",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-dashboard-form.body-dashboard-drastically-changed",children:"The dashboard will be saved using the new experimental Grafana dashboard schema. This action can\u2019t be reverted and could result in the irreversible loss of data. We recommend that you save this dashboard as a copy instead. If you\u2019re seeing this message in a production environment, contact Support to have the feature disabled."})})}),(0,S.jsx)(I.D,{label:(0,s.t)("dashboard-scene.save-dashboard-form.label-message","Message"),children:(0,S.jsx)(ee.f,{"aria-label":(0,s.t)("dashboard-scene.save-dashboard-form.aria-label-message","message"),value:$t.message??"",onChange:un=>{Yt({...$t,message:un.currentTarget.value})},placeholder:(0,s.t)("dashboard-scene.save-dashboard-form.placeholder-describe-changes-optional","Add a note to describe your changes (optional)."),autoFocus:!0,rows:5})}),In(At.error)]})}function nt({drawer:Ie,changeInfo:pe}){const{saveVariables:Ce=!1,saveTimeRange:ke=!1,saveRefresh:ut=!1}=Ie.useState(),{hasTimeChanges:vt,hasVariableValueChanges:At,hasRefreshChange:jt}=pe;return(0,S.jsxs)(X.B,{direction:"column",alignItems:"flex-start",children:[vt&&(0,S.jsx)(we.S,{id:"save-timerange",checked:ke,onChange:Ie.onToggleSaveTimeRange,label:(0,s.t)("dashboard-scene.save-dashboard-form-common-options.save-timerange-label-update-default-time-range","Update default time range"),description:(0,s.t)("dashboard-scene.save-dashboard-form-common-options.save-timerange-description-current-range-default","Will make current time range the new default"),"data-testid":Q.Tp.pages.SaveDashboardModal.saveTimerange}),jt&&(0,S.jsx)(we.S,{id:"save-refresh",label:(0,s.t)("dashboard-scene.save-dashboard-form-common-options.save-refresh-label-update-default-refresh-value","Update default refresh value"),description:(0,s.t)("dashboard-scene.save-dashboard-form-common-options.save-refresh-description-current-refresh-default","Will make the current refresh the new default"),checked:ut,onChange:Ie.onToggleSaveRefresh,"data-testid":Q.Tp.pages.SaveDashboardModal.saveRefresh}),At&&(0,S.jsx)(we.S,{id:"save-variables",label:(0,s.t)("dashboard-scene.save-dashboard-form-common-options.save-variables-label-update-default-variable-values","Update default variable values"),description:(0,s.t)("dashboard-scene.save-dashboard-form-common-options.save-variables-description-current-values-default","Will make the current values the new default"),checked:Ce,onChange:Ie.onToggleSaveVariables,"data-testid":Q.Tp.pages.SaveDashboardModal.saveVariables})]})}var he=e(22803),xe=e(4213),me=e.n(xe),ye=e(70713),De=e(89640),Le=e(50992),Ve=e(47931);function ze({dashboard:Ie,drawer:pe,changeInfo:Ce}){const ke=(0,w.useMemo)(()=>JSON.stringify(Ce.changedSaveModel,null,2),[Ce]),ut=(0,w.useCallback)(()=>{const vt=new Blob([ke],{type:"application/json;charset=utf-8"});(0,xe.saveAs)(vt,Ce.changedSaveModel.title+"-"+new Date().getTime()+".json")},[Ce.changedSaveModel,ke]);return(0,S.jsx)("div",{className:Ze.container,children:(0,S.jsxs)(X.B,{direction:"column",gap:2,grow:1,children:[(0,S.jsxs)("div",{children:[(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-provisioned-dashboard-form.cannot-be-saved",children:"This dashboard cannot be saved from the Grafana UI because it has been provisioned from another source. Copy the JSON or save it to a file below, then you can update your dashboard in the provisioning source."}),(0,S.jsx)("br",{}),(0,S.jsx)("i",{children:(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.save-provisioned-dashboard-form.see-docs",children:["See"," ",(0,S.jsx)(De.Y,{href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",external:!0,children:"documentation"})," ","for more information about provisioning."]})}),(0,S.jsx)("br",{})," ",(0,S.jsx)("br",{}),(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.save-provisioned-dashboard-form.file-path",values:{filePath:Ie.state.meta.provisionedExternalId},children:[(0,S.jsx)("strong",{children:"File path:"})," ","{{filePath}}"]})]}),(0,S.jsx)(nt,{drawer:pe,changeInfo:Ce}),(0,S.jsx)("div",{className:Ze.json,children:(0,S.jsx)(ye.Ay,{disableWidth:!0,children:({height:vt})=>(0,S.jsx)(Le.B,{width:"100%",height:vt,language:"json",showLineNumbers:!0,showMiniMap:ke.length>100,value:ke,readOnly:!0})})}),(0,S.jsx)(ne.a,{paddingTop:2,children:(0,S.jsxs)(X.B,{gap:2,children:[(0,S.jsx)(Z.$n,{variant:"secondary",onClick:pe.onClose,fill:"outline",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-provisioned-dashboard-form.cancel",children:"Cancel"})}),(0,S.jsx)(Ve.b,{icon:"copy",getText:()=>ke,children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-provisioned-dashboard-form.copy-json-to-clipboard",children:"Copy JSON to clipboard"})}),(0,S.jsx)(Z.$n,{type:"submit",onClick:ut,children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-provisioned-dashboard-form.save-json-to-file",children:"Save JSON to file"})})]})})]})})}const Ze={container:(0,he.css)({height:"100%",display:"flex"}),json:(0,he.css)({flexGrow:1,maxHeight:"800px"})};var Me=e(54148),$e=e(32899),at=e(77197),ct=e(91555),ft=e(33680);function Et(Ie){const[pe,Ce]=(0,ft.tj)(),[ke,ut]=(0,ft.XM)();return[(0,w.useCallback)(At=>(Ie?ke:pe)(At),[pe,Ie,ke]),Ie?ut:Ce]}var St=e(89314),Pt=e(52043),Dt=e(11480);function Ye({defaultValues:Ie,dashboard:pe,drawer:Ce,changeInfo:ke,isNew:ut,loadedFromRef:vt,isGitHub:At,workflowOptions:jt,readOnly:$t}){const Yt=(0,Me.Zp)(),qt=(0,u.J7)(),{isDirty:hn,editPanel:Cn}=pe.useState(),[Nn,In]=Et(ut?void 0:Ie.path),un=(0,H.mN)({defaultValues:Ie}),{handleSubmit:Sn,watch:fa,control:zn,reset:sa,register:Bn}=un,[qn]=fa(["workflow"]);(0,w.useEffect)(()=>{sa(Ie)},[Ie,sa]);const pa=ms=>{qt.publish({type:$e.r1.alertError.name,payload:[(0,s.t)("dashboard-scene.save-provisioned-dashboard-form.api-error","Error saving dashboard"),ms]})},Un=()=>{Cn?.onDiscard(),Ce.onClose(),i.Ny.partial({viewPanel:null,editPanel:null})},cs=ms=>{Cn?.onDiscard(),Ce.onClose();const Is=n.I.assureBaseUrl((0,Pt.u)({uid:ms.metadata.name,slug:at.A.slugifyForUrl(ms.spec.title??""),currentQueryParams:window.location.search}));Yt(Is)},wr=(ms,Is)=>{Cn?.onDiscard(),Ce.onClose(),Yt(`${ct.mL}/${Ie.repo}/dashboard/preview/${Is}?ref=${ms}`)};(0,Dt.J)({dashboard:pe,request:In,workflow:qn,handlers:{onBranchSuccess:({ref:ms,path:Is})=>wr(ms,Is),onWriteSuccess:Un,onNewDashboardSuccess:cs,onError:pa},isNew:ut});const Dr=async({title:ms,description:Is,repo:pr,path:tr,comment:Rs,ref:ns})=>{if(!pr||!tr){console.error("Missing required fields for saving:",{repo:pr,path:tr});return}qn==="write"&&(ns=vt);const xs=pe.getSaveResource({isNew:ut,title:ms,description:Is});Nn({ref:ns,name:pr,path:tr,message:Rs,body:xs})};return(0,S.jsx)(H.Op,{...un,children:(0,S.jsx)("form",{onSubmit:Sn(Dr),name:"save-provisioned-form",children:(0,S.jsxs)(X.B,{direction:"column",gap:2,children:[$t&&(0,S.jsx)(Y.F,{title:(0,s.t)("dashboard-scene.save-provisioned-dashboard-form.title-this-repository-is-read-only","This repository is read only"),children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-provisioned-dashboard-form.copy-json-message",children:"If you have direct access to the target, copy the JSON and paste it there."})}),ut&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(I.D,{noMargin:!0,label:(0,s.t)("dashboard-scene.save-provisioned-dashboard-form.label-title","Title"),invalid:!!un.formState.errors.title,error:un.formState.errors.title?.message,children:(0,S.jsx)(J.p,{id:"dashboard-title",...Bn("title",{required:(0,s.t)("dashboard-scene.save-provisioned-dashboard-form.title-required","Dashboard title is required"),validate:mt})})}),(0,S.jsx)(I.D,{noMargin:!0,label:(0,s.t)("dashboard-scene.save-provisioned-dashboard-form.label-description","Description"),invalid:!!un.formState.errors.description,error:un.formState.errors.description?.message,children:(0,S.jsx)(ee.f,{id:"dashboard-description",...Bn("description")})}),(0,S.jsx)(I.D,{noMargin:!0,label:(0,s.t)("dashboard-scene.save-provisioned-dashboard-form.label-target-folder","Target folder"),children:(0,S.jsx)(H.xI,{control:zn,name:"folder",render:({field:{ref:ms,value:Is,onChange:pr,...tr}})=>(0,S.jsx)(oe.d,{onChange:async(Rs,ns)=>{pr({uid:Rs,title:ns}),zt("folderUid",Rs);const xs=await ce(Rs);pe.setState({meta:{...xs,folderUid:Rs}})},value:Is.uid,...tr})})})]}),!ut&&!$t&&(0,S.jsx)(nt,{drawer:Ce,changeInfo:ke}),(0,S.jsx)(St.x,{resourceType:"dashboard",readOnly:$t,workflow:qn,workflowOptions:jt,isGitHub:At,isNew:ut}),(0,S.jsxs)(X.B,{gap:2,children:[(0,S.jsx)(Z.$n,{variant:"primary",type:"submit",disabled:In.isLoading||!hn||$t,children:In.isLoading?(0,s.t)("dashboard-scene.save-provisioned-dashboard-form.saving","Saving..."):(0,s.t)("dashboard-scene.save-provisioned-dashboard-form.save","Save")}),(0,S.jsx)(Z.$n,{variant:"secondary",onClick:Ce.onClose,fill:"outline",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.save-provisioned-dashboard-form.cancel",children:"Cancel"})})]})]})})})}async function mt(Ie,pe){if(Ie===pe.folder.title?.trim())return(0,s.t)("dashboard-scene.save-provisioned-dashboard-form.title-same-as-folder","Dashboard name cannot be the same as the folder name");try{return await de.P.validateNewDashboardName(pe.folder.uid??"general",Ie),!0}catch(Ce){return Ce instanceof Error?Ce.message:(0,s.t)("dashboard-scene.save-provisioned-dashboard-form.title-validation-failed","Dashboard title validation failed.")}}function zt(Ie,pe){if(!pe)return;const Ce=new URL(window.location.href);Ce.searchParams.set(Ie,pe),window.history.replaceState({},"",Ce)}var Jt=e(2522);function Xt({drawer:Ie,changeInfo:pe,dashboard:Ce}){const{isNew:ke,defaultValues:ut,loadedFromRef:vt,isGitHub:At,workflowOptions:jt,readOnly:$t}=(0,Jt.S)(Ce);return ut?(0,S.jsx)(Ye,{dashboard:Ce,drawer:Ie,changeInfo:pe,isNew:ke,defaultValues:ut,loadedFromRef:vt,isGitHub:At,workflowOptions:jt,readOnly:$t}):null}class En extends o.Bs{constructor(){super(...arguments),this.onClose=()=>{const pe=this.state.dashboardRef.resolve(),Ce=pe.getDashboardChanges();pe.setState({overlay:void 0,meta:Ce.isNew?pe.getInitialState()?.meta:pe.state.meta})},this.onToggleSaveTimeRange=()=>{this.setState({saveTimeRange:!this.state.saveTimeRange})},this.onToggleSaveVariables=()=>{this.setState({saveVariables:!this.state.saveVariables})},this.onToggleSaveRefresh=()=>{this.setState({saveRefresh:!this.state.saveRefresh})}}static{this.Component=({model:pe})=>{const{showDiff:Ce,saveAsCopy:ke,saveTimeRange:ut,saveVariables:vt,saveRefresh:At}=pe.useState(),jt=pe.state.dashboardRef.resolve().getDashboardChanges(ut,vt,At),{changedSaveModel:$t,initialSaveModel:Yt,diffs:qt,diffCount:hn,hasFolderChanges:Cn,hasMigratedToV2:Nn}=jt,In=hn+(Cn?1:0),un=pe.state.dashboardRef.resolve(),{meta:Sn}=un.useState(),{provisioned:fa,folderTitle:zn}=Sn,sa=un.managedResourceCannotBeEdited(),Bn=N(un),qn=(0,S.jsxs)(_.U,{children:[(0,S.jsx)(K.o,{label:(0,s.t)("dashboard-scene.save-dashboard-drawer.tabs.label-details","Details"),active:!Ce,onChangeTab:()=>pe.setState({showDiff:!1})}),In>0&&!sa&&(0,S.jsx)(K.o,{label:(0,s.t)("dashboard-scene.save-dashboard-drawer.tabs.label-changes","Changes"),active:Ce,onChangeTab:()=>pe.setState({showDiff:!0}),counter:In})]});let pa=(0,s.t)("dashboard-scene.save-dashboard-drawer.tabs.title","Save dashboard");ke?pa=(0,s.t)("dashboard-scene.save-dashboard-drawer.tabs.title-copy","Save dashboard copy"):(fa||Bn)&&(pa=(0,s.t)("dashboard-scene.save-dashboard-drawer.tabs.title-provisioned","Provisioned dashboard"));const Un=()=>Ce?(0,S.jsx)(L.l,{diff:qt,oldValue:Yt,newValue:$t,hasFolderChanges:Cn,hasMigratedToV2:Nn,oldFolder:un.getInitialState()?.meta.folderTitle,newFolder:zn}):Bn?(0,S.jsx)(Xt,{dashboard:un,changeInfo:jt,drawer:pe}):ke||jt.isNew?(0,S.jsx)(Fe,{dashboard:un,changeInfo:jt}):fa||sa?(0,S.jsx)(ze,{dashboard:un,changeInfo:jt,drawer:pe}):(0,S.jsx)(Xe,{dashboard:un,changeInfo:jt,drawer:pe});return(0,S.jsx)(T._,{title:pa,subtitle:un.state.title,onClose:pe.onClose,tabs:qn,children:Un()})}}}var ln=e(60171),cn=e(65635),Pn=e(95710),wn=e(17862),jn=e(3392),kn=e(13241),gt=e(70030),Lt=e(62265);class Rt{constructor(){this.elementPanelMap=new Map,this.defaultDsReferencesMap={panels:new Map,variables:new Set,annotations:new Set}}initializeElementMapping(pe){this.elementPanelMap.clear(),!(!pe||!pe.panels)&&pe.panels?.forEach(Ce=>{if(Ce.id){const ke=(0,C.XA)(Ce.id);this.elementPanelMap.set(ke,Ce.id)}})}getElementPanelMapping(){return this.elementPanelMap}initializeDSReferencesMapping(pe){return{}}getDSReferencesMapping(){return this.defaultDsReferencesMap}getPanelIdForElement(pe){return this.elementPanelMap.get(pe)}getElementIdForPanel(pe){for(const[ke,ut]of this.elementPanelMap.entries())if(ut===pe)return ke;const Ce=(0,C.XA)(pe);return this.elementPanelMap.set(Ce,pe),Ce}getSaveModel(pe){return(0,gt.Uy)(pe)}getSaveAsModel(pe,Ce){const ke=this.getSaveModel(pe);return{...ke,id:null,uid:"",title:Ce.title||"",description:Ce.description||void 0,tags:Ce.isNew||Ce.copyTags?ke.tags:[]}}getDashboardChangesFromScene(pe,Ce){const ke=this.getSaveModel(pe),ut=(0,wn.Cj)(this.initialSaveModel,ke,Ce.saveTimeRange,Ce.saveVariables,Ce.saveRefresh),vt=pe.getInitialState()?.meta.folderUid!==pe.state.meta.folderUid;return{...ut,hasFolderChanges:vt,hasChanges:ut.hasChanges||vt,hasMigratedToV2:!1}}onSaveComplete(pe,Ce){this.initialSaveModel={...pe,id:Ce.id,uid:Ce.uid,version:Ce.version},this.metadata={...this.metadata,k8s:{...this.metadata?.k8s,generation:Ce.version}}}getK8SMetadata(){return this.metadata?.k8s}getTrackingInformation(){const pe=this.initialSaveModel?.panels?.map(ut=>ut.type)||[],Ce=(0,Pn.GC)(pe),ke=(0,Pn.wM)(this.initialSaveModel?.templating?.list||[]);if(this.initialSaveModel)return{uid:this.initialSaveModel.uid,title:this.initialSaveModel.title,schemaVersion:this.initialSaveModel.schemaVersion,panels_count:this.initialSaveModel.panels?.length||0,settings_nowdelay:void 0,settings_livenow:!!this.initialSaveModel.liveNow,...Ce,...ke}}getSnapshotUrl(){return this.initialSaveModel?.snapshot?.originalUrl}async makeExportableExternally(pe){const Ce=this.getSaveModel(pe),ke=new v.G(Ce,void 0,{getVariablesFromState:()=>(0,kn.E)(window.__grafanaSceneContext)});return await(0,jn.E)(ke)}}class Ut{constructor(){this.elementPanelMap=new Map,this.defaultDsReferencesMap={panels:new Map,variables:new Set,annotations:new Set}}getElementPanelMapping(){return this.elementPanelMap}initializeElementMapping(pe){if(this.elementPanelMap.clear(),!pe||!pe.elements)return;Object.keys(pe.elements).forEach(ke=>{const ut=pe.elements[ke];ut.kind==="Panel"&&this.elementPanelMap.set(ke,ut.spec.id)})}initializeDSReferencesMapping(pe){if(pe===void 0||pe&&!(0,ln.aK)(pe))return;if(this.defaultDsReferencesMap={panels:new Map,variables:new Set,annotations:new Set},Object.keys(pe?.elements||{}).forEach(ke=>{const ut=pe?.elements[ke];if(ut?.kind==="Panel"){const vt=ut.spec.data.spec.queries;for(const At of vt)if(!At.spec.datasource){const jt=this.getElementIdForPanel(ut.spec.id);this.defaultDsReferencesMap.panels.has(jt)||this.defaultDsReferencesMap.panels.set(jt,new Set),this.defaultDsReferencesMap.panels.get(jt).add(At.spec.refId)}}}),pe?.variables)for(const ke of pe.variables)ke.kind==="QueryVariable"&&!ke.spec.datasource&&this.defaultDsReferencesMap.variables.add(ke.spec.name);if(pe?.annotations)for(const ke of pe.annotations)ke.spec.datasource||this.defaultDsReferencesMap.annotations.add(ke.spec.name)}getDSReferencesMapping(){return this.defaultDsReferencesMap}getPanelIdForElement(pe){return this.elementPanelMap.get(pe)}getElementIdForPanel(pe){for(const[ke,ut]of this.elementPanelMap.entries())if(ut===pe)return ke;const Ce=(0,C.XA)(pe);return this.elementPanelMap.set(Ce,pe),Ce}getSaveModel(pe){return(0,Lt.Xl)(pe)}getSaveAsModel(pe,Ce){const ke=this.getSaveModel(pe);return{...ke,title:Ce.title||"",description:Ce.description||"",tags:Ce.isNew||Ce.copyTags?ke.tags:[]}}getDashboardChangesFromScene(pe,Ce){const ke=this.getSaveModel(pe),ut=(0,wn.AM)(this.initialSaveModel,ke,Ce.saveTimeRange,Ce.saveVariables,Ce.saveRefresh),vt=pe.getInitialState()?.meta.folderUid!==pe.state.meta.folderUid,At=!pe.getInitialState()?.uid;return{...ut,hasFolderChanges:vt,hasChanges:ut.hasChanges||vt,isNew:At,hasMigratedToV2:!!ut.hasMigratedToV2}}onSaveComplete(pe,Ce){this.initialSaveModel={...pe},this.metadata&&(this.metadata={...this.metadata,generation:Ce.version})}getK8SMetadata(){return this.metadata}getTrackingInformation(pe){if(!this.initialSaveModel)return;const Ce="elements"in this.initialSaveModel?Object.values(this.initialSaveModel.elements).filter(vt=>vt.kind==="Panel").map(vt=>vt.spec.vizConfig.kind):[],ke=(0,Pn.GC)(Ce),ut="variables"in this.initialSaveModel?(0,Pn.z9)(this.initialSaveModel.variables):[];return{schemaVersion:cn.O2,uid:pe.state.uid,title:this.initialSaveModel.title,panels_count:Ce.length||0,settings_nowdelay:void 0,settings_livenow:!!this.initialSaveModel.liveNow,...ke,...ut}}getSnapshotUrl(){return this.metadata?.annotations?.[E.UL]}async makeExportableExternally(pe){return await(0,jn.j)(this.getSaveModel(pe))}}function Gt(Ie){return Ie==="v2"?new Ut:new Rt}var Ft=e(4974),_t=e(17340),tn=e(67350),xn=e(65333),mn=e(19161),An=e(64423),ia=e(19379),ca=e(84229),ea=e(80011),Ca=e(88632),oa=e(99392),Jn=e(33380);class Da{constructor(pe){this._scene=pe,this.events=new ia.o,this._subs=new An.yU;const Ce=o.jh.getTimeRange(pe);this.formatDate=this.formatDate.bind(this),this._subs.add(Ce.subscribeToState((ke,ut)=>{ke.value!==ut.value&&this.events.publish(new u.sR(ke.value))}))}get id(){return this._scene.state.id??null}get uid(){return this._scene.state.uid??null}get title(){return this._scene.state.title}get description(){return this._scene.state.description}get editable(){return this._scene.state.editable}get graphTooltip(){return this._getSyncMode()}get timepicker(){return{refresh_intervals:this._scene.state.controls.state.refreshPicker.state.intervals,hidden:this._scene.state.controls.state.hideTimeControls??!1}}get timezone(){return this.getTimezone()}get weekStart(){return o.jh.getTimeRange(this._scene).state.weekStart}get tags(){return this._scene.state.tags}get links(){return this._scene.state.links}get meta(){return this._scene.state.meta}get time(){const pe=o.jh.getTimeRange(this._scene);return{from:pe.state.from,to:pe.state.to}}get panels(){return Fa(this._scene,Ce=>Ce instanceof o.Eb).map(Ce=>new Jn.R(Ce))}get annotations(){const pe={list:[]};return this._scene.state.$data instanceof Ca.s&&(pe.list=(0,oa.O)(this._scene.state.$data.state.annotationLayers)),pe}getTimezone(){return o.jh.getTimeRange(this._scene).getTimeZone()}sharedTooltipModeEnabled(){return this._getSyncMode()>0}sharedCrosshairModeOnly(){return this._getSyncMode()===1}_getSyncMode(){if(this._scene.state.$behaviors){for(const pe of this._scene.state.$behaviors)if(pe instanceof o.Gg.K2)return pe.state.sync}return ca.y.Off}otherPanelInFullscreen(pe){return!1}formatDate(pe,Ce){return(0,ea.LE)(pe,{format:Ce,timeZone:this.getTimezone()})}getPanelById(pe){const Ce=(0,C.vL)(this._scene,(0,C.XA)(pe));return Ce?new Jn.R(Ce):null}removePanel(pe){const Ce=(0,C.vL)(this._scene,(0,C.XA)(pe.id));if(!Ce){console.error("Trying to remove a panel that was not found in scene",pe);return}this._scene.removePanel(Ce)}canEditAnnotations(pe){return this._scene.canEditDashboard()?pe?!!this._scene.state.meta.annotationsPermissions?.dashboard.canEdit:!!this._scene.state.meta.annotationsPermissions?.organization.canEdit:!1}panelInitialized(){}destroy(){this.events.removeAllListeners(),this._subs.unsubscribe()}hasUnsavedChanges(){return this._scene.state.isDirty}}function Fa(Ie,pe){let Ce=[];return Ie.forEachChild(ke=>{pe(ke)?Ce.push(ke):Ce=Ce.concat(Fa(ke,pe))}),Ce}var Xn=e(1682);function ps(Ie){let pe=5381;for(let Ce=0;Ce<Ie.length;Ce++)pe=pe*33^Ie.charCodeAt(Ce);return pe>>>0}var Aa=e(22079),xt=e(63142);class dt extends o.Bs{constructor(pe){super({...pe,jsonText:""}),this.onClose=()=>{this.state.dashboardRef.resolve().setState({overlay:void 0})},this.onSave=()=>{},this.addActivationHandler(()=>this.setState({jsonText:this.getJsonText()}))}getJsonText(){const pe=this.state.dashboardRef.resolve();return JSON.stringify((0,Lt.Xl)(pe),null,2)}static{this.Component=({model:pe})=>{const{jsonText:Ce}=pe.useState(),ke=(0,xt.of)(bt),ut=()=>(0,S.jsxs)("div",{className:ke.wrapper,children:[(0,S.jsx)(Le.B,{width:"100%",value:Ce,language:"json",showLineNumbers:!0,showMiniMap:!0,containerStyles:ke.codeEditor,onBlur:vt=>pe.setState({jsonText:vt})}),(0,S.jsx)(ne.a,{paddingTop:2,children:(0,S.jsx)(Z.$n,{onClick:pe.onSave,disabled:!0,children:"Update dashboard"})})]});return(0,S.jsx)(T._,{title:"[DEV] Schema V2 editor",subtitle:"Allows editing dashboard using v2 schema. Changes are not persisted in db.",onClose:pe.onClose,children:ut()})}}}const bt=Ie=>({wrapper:(0,he.css)({display:"flex",height:"100%",flexDirection:"column",gap:Ie.spacing(2)}),codeEditor:(0,he.css)({flexGrow:1})});var Mt=e(24438),Bt=e(7094);class Kt extends o.Bs{constructor(){super(...arguments),this.onClose=()=>{(0,C.YQ)(this).closeModal()},this.onAddLibraryPanel=pe=>{const Ce=(0,C.YQ)(this),ke=(0,C.O8)();ke.setState({title:pe.model.title,hoverHeader:!pe.model.title,$behaviors:[new Bt.u({uid:pe.uid,name:pe.name})]});const ut=this.state.panelToReplaceRef?.resolve();if(ut){const vt=ut.parent;vt&&(0,b.y)(vt)&&(ke.setState({key:ut.state.key}),vt.setElementBody(ke))}else Ce.addPanel(ke);this.onClose()}}static{this.Component=({model:pe})=>{const Ce=(0,s.t)("library-panel.add-widget.title","Add panel from panel library");return(0,S.jsx)(T._,{title:Ce,onClose:pe.onClose,children:(0,S.jsx)(Mt.j,{onClick:pe.onAddLibraryPanel,variant:Mt.s.Tight,showPanelFilter:!0})})}}}var Qt=e(36324);function Zt(Ie){return"isDashboardDropTarget"in Ie&&Ie.isDashboardDropTarget===!0}class nn extends o.Bs{constructor(){super({}),this._sourceDropTarget=null,this._lastDropTarget=null,this._pointerDistance=(0,Qt.b)(),this._isSelectedObject=!1,this._onPointerMove=this._onPointerMove.bind(this),this._stopDraggingSync=this._stopDraggingSync.bind(this),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){return()=>{document.body.removeEventListener("pointermove",this._onPointerMove),document.body.removeEventListener("pointerup",this._stopDraggingSync)}}startDraggingSync(pe,Ce){this._pointerDistance.set(pe),this._isSelectedObject=!1;const ke=o.jh.findObject(Ce,Zt);!ke||!Zt(ke)||(this._sourceDropTarget=ke,this._lastDropTarget=ke,document.body.addEventListener("pointermove",this._onPointerMove),document.body.addEventListener("pointerup",this._stopDraggingSync),this.setState({draggingPanel:Ce.getRef()}))}_stopDraggingSync(pe){const Ce=this.state.draggingPanel?.resolve();this._sourceDropTarget!==this._lastDropTarget&&setTimeout(()=>{this._sourceDropTarget?.draggedPanelOutside?.(Ce),this._lastDropTarget?.draggedPanelInside?.(Ce)}),document.body.removeEventListener("pointermove",this._onPointerMove),document.body.removeEventListener("pointerup",this._stopDraggingSync),this.setState({draggingPanel:void 0})}_onPointerMove(pe){if(!this._isSelectedObject&&this.state.draggingPanel&&this._pointerDistance.check(pe)){this._isSelectedObject=!0;const ke=this.state.draggingPanel?.resolve();this._getDashboard().state.editPane.selectObject(ke,ke.state.key,{force:!0,multi:!1})}const Ce=this._getDropTargetUnderMouse(pe)??this._sourceDropTarget;Ce&&Ce!==this._lastDropTarget&&(this._lastDropTarget?.setIsDropTarget?.(!1),this._lastDropTarget=Ce,Ce!==this._sourceDropTarget&&Ce.setIsDropTarget?.(!0))}_getDashboard(){if(!(this.parent instanceof yi))throw new Error("Parent is not a DashboardScene");return this.parent}_getDropTargetUnderMouse(pe){const Ce=document.elementsFromPoint(pe.clientX,pe.clientY);if(Ce.some(At=>At.getAttribute("data-dashboard-drop-target-key")===this._sourceDropTarget?.state.key))return null;const ut=Ce?.find(At=>At.getAttribute("data-dashboard-drop-target-key"))?.getAttribute("data-dashboard-drop-target-key");if(!ut)return null;const vt=o.jh.findByKey(this._getDashboard(),ut);return!vt||!Zt(vt)?null:vt}}var kt=e(75683),bn=e(69896),Ln=e(13791),Yn=e(92293),Hn=e(56887),It=e(94076),yt=e(82754),Vt=e(66483),fn=e(33149),Dn=e(78685),Wn=e(93008),Fn=e(7895),la=e(66404),Kn=e(30703),aa=e(92807);function Ia(Ie){const[pe,Ce]=(0,w.useState)({}),ke=$t=>{Ie.onChangeName&&Ce({isRenaming:!0,originalName:Ie.getEditableElementInfo().instanceName})},ut=()=>{pe.error&&Ie.onChangeName(pe.originalName),Ce({})},vt=(0,w.useMemo)(()=>$t=>{$t?.focus(),$t?.select()},[]),At=$t=>{const Yt=Ie.onChangeName($t.target.value);Yt?.errorMessage?Ce({...pe,error:Yt.errorMessage}):pe.error&&Ce({...pe,error:void 0})},jt=$t=>{$t.key==="Enter"&&ut()};return{isRenaming:pe.isRenaming,onNameDoubleClicked:ke,renameInputRef:vt,onChangeName:At,onInputBlur:ut,onInputKeyDown:jt}}function Zn({editPane:Ie}){const pe=(0,C.YQ)(Ie);return(0,S.jsx)(ne.a,{padding:1,gap:0,display:"flex",direction:"column",element:"ul",role:"tree",position:"relative",children:(0,S.jsx)(ma,{sceneObject:pe,editPane:Ie,depth:0})})}function ma({sceneObject:Ie,editPane:pe,depth:Ce}){const ke=(0,xt.of)(ka),{key:ut}=Ie.useState(),[vt,At]=(0,w.useState)(Ce>0),{isSelected:jt,onSelect:$t}=(0,Hn.y)(ut),Yt=(0,w.useMemo)(()=>(0,D.uc)(ut),[ut]),qt=(0,w.useMemo)(()=>(0,j.wT)(Ie),[Ie]),hn=(0,s.t)("dashboard.outline.tree-item.no-title","<no title>"),Cn=qt.getOutlineChildren?.()??[],Nn=qt.getEditableElementInfo(),In=Nn.instanceName===""?hn:Nn.instanceName,un=Ia(qt),Sn=!!qt.getOutlineChildren,fa=sa=>{sa.stopPropagation(),jt||$t?.(sa),qt.scrollIntoView?.()},zn=sa=>{sa.stopPropagation(),At(!vt)};return(0,S.jsxs)("li",{role:"treeitem","aria-selected":jt,className:ke.container,onClick:fa,style:{"--depth":Ce},children:[(0,S.jsxs)("div",{className:(0,he.cx)(ke.row,{[ke.rowSelected]:jt}),children:[(0,S.jsx)("div",{className:ke.indentation}),Sn&&(0,S.jsx)("button",{className:ke.angleButton,onClick:zn,"data-testid":Q.Tp.components.PanelEditor.Outline.node(In),children:(0,S.jsx)(Kn.I,{name:vt?"angle-right":"angle-down"})}),(0,S.jsxs)("button",{className:(0,he.cx)(ke.nodeName,{[ke.nodeNameClone]:Yt}),onDoubleClick:un.onNameDoubleClicked,"data-testid":Q.Tp.components.PanelEditor.Outline.item(In),children:[(0,S.jsx)(Kn.I,{size:"sm",name:Nn.icon}),un.isRenaming?(0,S.jsx)("input",{ref:un.renameInputRef,type:"text",value:Nn.instanceName,className:ke.outlineInput,onChange:un.onChangeName,onBlur:un.onInputBlur,onKeyDown:un.onInputKeyDown}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(X.B,{direction:"row",gap:.5,alignItems:"center",grow:1,children:[(0,S.jsx)("span",{children:In}),Nn.isHidden&&(0,S.jsx)(Kn.I,{name:"eye-slash",size:"sm",className:ke.hiddenIcon})]}),Yt&&(0,S.jsx)("span",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard.outline.repeated-item",children:"Repeat"})})]})]})]}),Sn&&!vt&&(0,S.jsx)("ul",{className:ke.nodeChildren,role:"group",children:Cn.length>0?Cn.map(sa=>(0,S.jsx)(ma,{sceneObject:sa,editPane:pe,depth:Ce+1},sa.state.key)):(0,S.jsx)(la.E,{color:"secondary",element:"li",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard.outline.tree-item.empty",children:"(empty)"})})})]})}function ka(Ie){return{container:(0,he.css)({display:"flex",gap:Ie.spacing(.5),flexGrow:1,flexDirection:"column",borderRadius:Ie.shape.radius.default,color:Ie.colors.text.secondary}),containerSelected:(0,he.css)({outline:`1px dashed ${Ie.colors.primary.border} !important`,outlineOffset:"0px",color:Ie.colors.text.primary}),row:(0,he.css)({display:"flex",gap:Ie.spacing(.5),borderRadius:Ie.shape.radius.default,"&:hover":{color:Ie.colors.text.primary,outline:`1px dashed ${Ie.colors.border.strong}`,backgroundColor:Ie.colors.emphasize(Ie.colors.background.primary,.05)}}),rowSelected:(0,he.css)({color:Ie.colors.text.primary,outline:`1px dashed ${Ie.colors.primary.border} !important`,backgroundColor:Ie.colors.emphasize(Ie.colors.background.primary,.05)}),indentation:(0,he.css)({marginLeft:`calc(var(--depth) * ${Ie.spacing(3)})`}),angleButton:(0,he.css)({boxShadow:"none",border:"none",background:"transparent",borderRadius:Ie.shape.radius.default,padding:0,color:"inherit",lineHeight:0}),nodeName:(0,he.css)({boxShadow:"none",border:"none",background:"transparent",padding:0,borderRadius:Ie.shape.radius.default,color:"inherit",display:"flex",flexGrow:1,alignItems:"center",gap:Ie.spacing(.5),overflow:"hidden","> span":{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}}),hiddenIcon:(0,he.css)({color:Ie.colors.text.secondary,marginLeft:Ie.spacing(1)}),nodeNameClone:(0,he.css)({color:Ie.colors.text.secondary,cursor:"not-allowed"}),outlineInput:(0,he.css)({border:`1px solid ${Ie.components.input.borderColor}`,height:Ie.spacing(3),borderRadius:Ie.shape.radius.default,"&:focus":{outline:"none",boxShadow:"none"}}),nodeChildren:(0,he.css)({display:"flex",flexDirection:"column",position:"relative",gap:Ie.spacing(.5),"&::before":{content:'""',position:"absolute",width:"1px",height:"100%",pointerEvents:"none",zIndex:1,background:Ie.colors.border.weak,marginLeft:`calc(11px + ${Ie.spacing(3)} * var(--depth))`}})}}var ta=e(76319),Ya=e(88559),_n=e(87063);function Ns({element:Ie,editPane:pe}){const Ce=Ie.getEditableElementInfo(),ke=(0,xt.of)(is),ut=Ie.onCopy?.bind(Ie),vt=Ie.onDuplicate?.bind(Ie),At=Ie.onDelete?.bind(Ie),jt=Ie.onConfirmDelete?.bind(Ie),$t=()=>pe.clearSelection(),Yt=pe.state.selection;return(0,S.jsxs)("div",{className:ke.wrapper,children:[(0,S.jsxs)(X.B,{direction:"row",gap:.5,children:[Yt&&(0,S.jsx)(ta.K,{name:"arrow-left",size:"lg",onClick:$t,tooltip:(0,s.t)("grafana.dashboard.edit-pane.go-back","Go back"),"aria-label":(0,s.t)("grafana.dashboard.edit-pane.go-back","Go back"),"data-testid":Q.Tp.components.EditPaneHeader.backButton}),(0,S.jsx)(la.E,{children:Ce.typeName})]}),(0,S.jsxs)(X.B,{direction:"row",gap:1,children:[Ie.renderActions&&Ie.renderActions(),(ut||vt)&&(0,S.jsx)(Ya.m,{overlay:(0,S.jsxs)(_n.W,{children:[ut?(0,S.jsx)(_n.W.Item,{icon:"copy",label:(0,s.t)("dashboard.layout.common.copy","Copy"),onClick:ut}):null,vt?(0,S.jsx)(_n.W.Item,{icon:"file-copy-alt",label:(0,s.t)("dashboard.layout.common.duplicate","Duplicate"),onClick:vt}):null]}),children:(0,S.jsx)(Z.$n,{tooltip:(0,s.t)("dashboard.layout.common.copy-or-duplicate","Copy or Duplicate"),tooltipPlacement:"bottom",variant:"secondary",size:"sm",icon:"copy","data-testid":Q.Tp.components.EditPaneHeader.copyDropdown,children:(0,S.jsx)(Kn.I,{name:"angle-down"})})}),(At||jt)&&(0,S.jsx)(Z.$n,{onClick:jt||At,size:"sm",variant:"destructive",fill:"outline",icon:"trash-alt",tooltip:(0,s.t)("dashboard.layout.common.delete","Delete"),"data-testid":Q.Tp.components.EditPaneHeader.deleteButton})]})]})}function is(Ie){return{wrapper:(0,he.css)({display:"flex",alignItems:"center",justifyContent:"space-between",padding:Ie.spacing(1,2),borderBottom:`1px solid ${Ie.colors.border.weak}`})}}function Ys({element:Ie,editPane:pe,isNewElement:Ce}){const ke=Ie.useEditPaneOptions?Ie.useEditPaneOptions(Ce):[],ut=(0,xt.of)(rr);return(0,S.jsxs)("div",{className:ut.wrapper,children:[(0,S.jsx)(Ns,{element:Ie,editPane:pe}),(0,S.jsx)(aa.P,{showScrollIndicators:!0,children:(0,S.jsx)("div",{className:ut.categories,children:ke.map(vt=>vt.render())})})]})}function rr(Ie){return{wrapper:(0,he.css)({display:"flex",flexDirection:"column",flex:"1 1 0",height:"100%"}),categories:(0,he.css)({display:"flex",flexDirection:"column",borderBottom:`1px solid ${Ie.colors.border.weak}`})}}function Js(Ie,pe){return(0,w.useMemo)(()=>{if(!Ie){const Ce=(0,C.YQ)(pe);return new U([[Ce.state.uid,Ce.getRef()]]).createSelectionElement()}return Ie.createSelectionElement()},[Ie,pe])}function vo({editPane:Ie,isCollapsed:pe,onToggleCollapse:Ce,openOverlay:ke}){const{selection:ut}=(0,o.gn)(Ie,{shouldActivateOrKeepAlive:!0}),vt=(0,xt.of)(Ka),At=(0,xt.of)(Z.my),jt=Js(ut,Ie),$t=ut?.getFirstObject(),Yt=ut?.isNewElement()??!1,[qt,hn]=(0,Dn.A)("grafana.dashboard.edit-pane.outline.collapsed",!0),[Cn=.4,Nn]=(0,Dn.A)("grafana.dashboard.edit-pane.outline.size",.4),In=(0,Wn.h)({direction:"column",handleSize:"sm",initialSize:1-Cn,dragPosition:"middle",onSizeChanged:un=>{Nn(1-un)}});return jt?pe?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{className:vt.expandOptionsWrapper,children:(0,S.jsx)(Fn.I,{tooltip:(0,s.t)("dashboard.edit-pane.open","Open options pane"),icon:"arrow-to-right",onClick:Ce,variant:"canvas",narrow:!0,className:vt.rotate180,"aria-label":(0,s.t)("dashboard.edit-pane.open","Open options pane")})}),ke&&(0,S.jsx)(fn.c,{className:vt.overlayWrapper,defaultSize:{height:"100%",width:"300px"},children:(0,S.jsx)(Ys,{element:jt,editPane:Ie,isNewElement:Yt},$t?.state.key)})]}):(qt?(In.primaryProps.style.flexGrow=1,In.primaryProps.style.minHeight="unset",In.secondaryProps.style.flexGrow=0,In.secondaryProps.style.minHeight="min-content"):(In.primaryProps.style.minHeight="unset",In.secondaryProps.style.minHeight="unset"),(0,S.jsx)("div",{className:vt.wrapper,children:(0,S.jsxs)("div",{...In.containerProps,children:[(0,S.jsx)("div",{...In.primaryProps,className:(0,he.cx)(In.primaryProps.className,vt.paneContent),children:(0,S.jsx)(Ys,{element:jt,editPane:Ie,isNewElement:Yt},$t?.state.key)}),(0,S.jsx)("div",{...In.splitterProps,className:(0,he.cx)(In.splitterProps.className,vt.splitter),"data-edit-pane-splitter":!0}),(0,S.jsxs)("div",{...In.secondaryProps,className:(0,he.cx)(In.secondaryProps.className,vt.paneContent),children:[(0,S.jsxs)("button",{type:"button",onClick:()=>hn(!qt),className:(0,he.cx)(At,vt.outlineCollapseButton),"data-testid":Q.Tp.components.PanelEditor.Outline.section,children:[(0,S.jsx)(la.E,{weight:"medium",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.dashboard-edit-pane-renderer.outline",children:"Outline"})}),(0,S.jsx)(Kn.I,{name:qt?"angle-up":"angle-down"})]}),!qt&&(0,S.jsx)("div",{className:vt.outlineContainer,children:(0,S.jsx)(aa.P,{showScrollIndicators:!0,children:(0,S.jsx)(Zn,{editPane:Ie})})})]})]})})):null}function Ka(Ie){return{wrapper:(0,he.css)({display:"flex",flexDirection:"column",flex:"1 1 0",marginTop:Ie.spacing(2),borderLeft:`1px solid ${Ie.colors.border.weak}`,borderTop:`1px solid ${Ie.colors.border.weak}`,background:Ie.colors.background.primary,borderTopLeftRadius:Ie.shape.radius.default}),overlayWrapper:(0,he.css)({right:0,bottom:0,top:Ie.spacing(2),position:"absolute !important",background:Ie.colors.background.primary,borderLeft:`1px solid ${Ie.colors.border.weak}`,borderTop:`1px solid ${Ie.colors.border.weak}`,boxShadow:Ie.shadows.z3,zIndex:Ie.zIndex.navbarFixed,flexGrow:1}),paneContent:(0,he.css)({overflow:"hidden",display:"flex",flexDirection:"column"}),rotate180:(0,he.css)({rotate:"180deg"}),tabsbar:(0,he.css)({padding:Ie.spacing(0,1),margin:Ie.spacing(.5,0)}),expandOptionsWrapper:(0,he.css)({display:"flex",flexDirection:"column",padding:Ie.spacing(2,1,2,0)}),splitter:(0,he.css)({"&::after":{background:"transparent",transform:"unset",width:"100%",height:"1px",top:"100%",left:"0"}}),outlineCollapseButton:(0,he.css)({display:"flex",padding:Ie.spacing(.5,2),gap:Ie.spacing(1),justifyContent:"space-between",alignItems:"center",background:Ie.colors.background.secondary,"&:hover":{background:Ie.colors.action.hover}}),outlineContainer:(0,he.css)({display:"flex",flexDirection:"column",flexGrow:1,overflow:"hidden"})}}function zi({dashboard:Ie,isEditing:pe,body:Ce,controls:ke}){const ut=(0,Yn.k)(),{editPane:vt}=Ie.state,At=(0,xt.of)(hc,ut??0),[jt,$t]=(0,j.dt)();if(!r.$.featureToggles.dashboardNewLayouts)return(0,S.jsx)(It.A,{onSetScrollRef:Ie.onSetScrollRef,children:(0,S.jsxs)("div",{className:At.canvasWrappperOld,children:[(0,S.jsx)(Vt.c,{dashboard:Ie}),(0,S.jsx)("div",{className:At.controlsWrapperSticky,children:ke}),(0,S.jsx)("div",{className:At.body,children:Ce})]})});const{containerProps:Yt,primaryProps:qt,secondaryProps:hn,splitterProps:Cn,splitterState:Nn,onToggleCollapse:In}=(0,yt.L)({direction:"row",dragPosition:"end",initialSize:330,handleSize:"sm",usePixels:!0,collapseBelowPixels:250,collapsed:jt});(0,w.useEffect)(()=>{$t(Nn.collapsed)},[Nn.collapsed,$t]),(0,w.useEffect)(()=>{pe?vt.enableSelection():vt.disableSelection()},[pe,vt]);const{selectionContext:un}=(0,o.gn)(vt,{shouldActivateOrKeepAlive:!0}),Sn={};pe||(qt.style.flexGrow=1,qt.style.width="100%",qt.style.minWidth="unset",Sn.overflow="unset");const fa=zn=>{zn&&Ie.onSetScrollRef(new It.X(zn))};return(0,S.jsx)("div",{...Yt,style:Sn,children:(0,S.jsxs)(Hn._.Provider,{value:un,children:[(0,S.jsxs)("div",{...qt,className:(0,he.cx)(qt.className,At.canvasWithSplitter),onPointerDown:zn=>{zn.shiftKey||vt.clearSelection()},children:[(0,S.jsx)(Vt.c,{dashboard:Ie}),(0,S.jsx)("div",{className:(0,he.cx)(!pe&&At.controlsWrapperSticky),children:ke}),(0,S.jsx)("div",{className:At.bodyWrapper,children:(0,S.jsx)("div",{className:(0,he.cx)(At.body,pe&&At.bodyEditing),"data-testid":Q.Tp.components.DashboardEditPaneSplitter.primaryBody,ref:fa,children:Ce})})]}),pe&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{...Cn,className:(0,he.cx)(Cn.className,At.splitter),"data-edit-pane-splitter":!0}),(0,S.jsx)("div",{...hn,className:(0,he.cx)(hn.className,At.editPane),children:(0,S.jsx)(vo,{editPane:vt,isCollapsed:jt,onToggleCollapse:In,openOverlay:un.selected.length>0})})]})]})})}function hc(Ie,pe){return{canvasWrappperOld:(0,he.css)({label:"canvas-wrapper-old",display:"flex",flexDirection:"column",flexGrow:1}),canvasWithSplitter:(0,he.css)({overflow:"unset",display:"flex",flexDirection:"column",flexGrow:1}),canvasWithSplitterEditing:(0,he.css)({overflow:"unset"}),bodyWrapper:(0,he.css)({label:"body-wrapper",display:"flex",flexDirection:"column",flexGrow:1,position:"relative"}),body:(0,he.css)({label:"body",display:"flex",flexGrow:1,gap:Ie.spacing(1),boxSizing:"border-box",flexDirection:"column",padding:Ie.spacing(.125,2,2,2)}),bodyEditing:(0,he.css)({position:"absolute",left:0,top:0,right:0,bottom:0,overflow:"auto",scrollbarWidth:"thin",scrollbarGutter:"stable",paddingRight:Ie.spacing(1)}),editPane:(0,he.css)({flexDirection:"column"}),splitter:(0,he.css)({"&:after":{display:"none"}}),controlsWrapperSticky:(0,he.css)({[Ie.breakpoints.up("md")]:{position:"sticky",zIndex:Ie.zIndex.activePanel,background:Ie.colors.background.canvas,top:pe}})}}var _i=e(46942),Ua=e.n(_i),es=e(93389),ts=e(1131),Xs=e(39765);const Gi="--panels-per-row";function Zs({dashboard:Ie,panelSearch:pe="",panelsPerRow:Ce}){const{body:ke}=Ie.state,ut=[],vt=(0,xt.of)(kr),[At,jt]=(0,w.useState)(""),$t=ke instanceof ts.D?ke.state.grid:null;if(!$t)return(0,S.jsx)(s.x6,{i18nKey:"panel-search.unsupported-layout",children:"Unsupported layout"});for(const Yt of $t.state.children)if(Yt instanceof es.U)Hi(Yt,Ie,pe,ut,jt);else if(Yt instanceof o.tI)for(const qt of Yt.state.children)qt instanceof es.U&&Hi(qt,Ie,pe,ut,jt);return ut.length>0?(0,S.jsx)("div",{className:Ua()(vt.grid,{[vt.perRow]:Ce!==void 0}),style:{[Gi]:Ce},children:ut.map(Yt=>(0,S.jsx)(Ho,{panel:Yt},Yt.state.key))}):(0,S.jsx)("p",{className:vt.noHits,children:(0,S.jsx)(s.x6,{i18nKey:"panel-search.no-matches",children:"No matches found"})})}function Ho({panel:Ie}){return(0,w.useEffect)(()=>{const pe=(0,C.zo)(Ie);return()=>{pe?.()}},[Ie]),(0,S.jsx)(Ie.Component,{model:Ie})}function kr(Ie){return{grid:(0,he.css)({display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gap:Ie.spacing(1),gridAutoRows:"320px"}),perRow:(0,he.css)({gridTemplateColumns:`repeat(var(${Gi}, 3), 1fr)`}),noHits:(0,he.css)({display:"grid",placeItems:"center"})}}function Hi(Ie,pe,Ce,ke,ut){const vt=o.jh.interpolate(pe,Ce).toLowerCase();if(Ie.state.variableName&&!Ie.isActive){const jt=Ie.state.body;jt.interpolate(jt.state.title,void 0,"text").toLowerCase().includes(vt)&&(Ie.subscribeToEvent(Xs.d,Yt=>{Yt.payload.source instanceof es.U&&ut(Yt.payload.source.state.key??"")}),Ie.activate())}const At=Ie.state.repeatedPanels??[Ie.state.body];for(const jt of At)jt.interpolate(jt.state.title,void 0,"text").toLowerCase().includes(vt)&&ke.push(jt);return ke}function Qi({model:Ie}){const{controls:pe,overlay:Ce,editview:ke,editPanel:ut,viewPanelScene:vt,panelSearch:At,panelsPerRow:jt,isEditing:$t,layoutOrchestrator:Yt}=Ie.useState(),{type:qt}=(0,Me.g)(),hn=(0,Me.zy)(),Cn=(0,w.useContext)(bn.j),Nn=(0,Je.d4)(sa=>sa.navIndex),In=Ie.getPageNav(hn,Nn),un=Ie.getBodyToRender(),Sn=(0,f.tc)(Nn,`dashboards/${qt==="snapshot"?"snapshots":"browse"}`),fa=ke!==void 0;if((0,w.useMemo)(()=>{(vt||fa||ut)&&Ie.rememberScrollPos()},[fa,ut,vt,Ie]),(0,w.useEffect)(()=>{!vt&&!fa&&!ut&&Ie.restoreScrollPos()},[fa,ut,vt,Ie]),(0,w.useEffect)(()=>{if(Cn&&$t)return Cn.setReadOnly(!0),()=>{Cn.setReadOnly(!1)}},[Cn,$t]),ke)return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ke.Component,{model:ke}),Ce&&(0,S.jsx)(Ce.Component,{model:Ce})]});function zn(){return!vt&&(At||jt)?(0,S.jsx)(Zs,{panelSearch:At,panelsPerRow:jt,dashboard:Ie}):(0,S.jsx)(un.Component,{model:un})}return(0,S.jsxs)(S.Fragment,{children:[Yt&&(0,S.jsx)(Yt.Component,{model:Yt}),(0,S.jsxs)(Ln.Y,{navModel:Sn,pageNav:In,layout:kt.k.Custom,children:[ut&&(0,S.jsx)(ut.Component,{model:ut}),!ut&&(0,S.jsx)(zi,{dashboard:Ie,isEditing:$t,controls:pe&&(0,S.jsx)(pe.Component,{model:pe}),body:zn()}),Ce&&(0,S.jsx)(Ce.Component,{model:Ce})]})]})}var ki=e(6262),fc=e(14252),or=e(61215),za=e(26689),pc=e(991),xr=e(68079),yo=e(18857),ir=e(15130),lr=e(11257),Qo=e(55386),Yi=e(5114),cr=e(2543),xo=e(77154),Ji=e(739),Cs=e(28105),Xi=e(8095),qs=e(34273);function Eo(Ie){const pe=[];if(Ie?.series)for(const Ce of Ie.series)pe.push((0,xo.Nw)(Ce));if(Ie?.annotations)for(const Ce of Ie.annotations){const ke=(0,xo.Nw)(Ce);ke.schema?.meta||(ke.schema.meta={}),ke.schema.meta.dataTopic=Ji.QR.Annotations,pe.push(ke)}return pe}function Po(Ie,pe){const Ce={panelType:Ie.state.pluginId,datasource:"??"},ke=r.$.buildInfo.versionString;let ut=`| Key | Value |
|--|--|
| Panel | ${Ce.panelType} @ ${Ie.state.pluginVersion??ke} |
| Grafana | ${ke} // ${r.$.buildInfo.edition} |
`;return pe&&(ut+="<details><summary>Panel debug snapshot dashboard</summary>\n\n```json\n"+pe+"\n```\n</details>"),ut}async function Ks(Ie,pe,Ce){let ke={type:""};const ut=Ie.parent;(0,C.ME)(Ie)?ke={...(0,gt.ZB)(ut),...(0,gt.Z6)(Ie)}:ke=(0,gt.ZB)(ut);const vt=(0,cr.cloneDeep)(bo),At={panelType:Ie.state.pluginId,datasource:"??"},jt=(0,C.un)(Ie);if(!jt.state.data)return;const $t=jt.state.data,Yt=jt?.state.datasource,qt=(0,qs.W)(Eo($t),pe),hn=r.$.buildInfo.versionString,Cn=jt.state.queries??[],Nn=$t.annotations?$t.annotations.reduce((un,Sn)=>Sn.length+un,0):0,In=`<table width="100%">
    <tr>
      <th width="2%">Panel</th>
      <td >${At.panelType} @ ${ke.pluginVersion??hn}</td>
    </tr>
    <tr>
      <th>Queries</th>
      <td>${Cn.map(un=>{const Sn=un.datasource??Yt;return`${un.refId}[${Sn?.type}]`}).join(", ")}</td>
    </tr>
    ${Zi(ke)}
    ${qi($t,qt)}
    ${dr($t)}
    <tr>
      <th>Grafana</th>
      <td>${hn} // ${r.$.buildInfo.edition}</td>
    </tr>
  </table>`.trim();if(vt.panels[0]={...ke,...vt.panels[0],targets:[{refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:Xi.nj.Snapshot,snapshot:qt}]},delete vt.panels[0].libraryPanel,ke.transformations?.length){const un=vt.panels[vt.panels.length-1];un.title=un.title+" (after transformations)";const Sn=(0,cr.cloneDeep)(un);Sn.id=100,Sn.title="Data (before transformations)",Sn.gridPos.w=24,Sn.targets[0].withTransforms=!1,vt.panels.push(Sn)}return Nn>0&&vt.panels.push({id:7,gridPos:{h:6,w:24,x:0,y:20},type:"table",title:"Annotations",datasource:{type:"datasource",uid:"-- Dashboard --"},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,topic:Ji.QR.Annotations,refId:"A"}]}),vt.panels[1].options.content=In,vt.panels[2].options.content=JSON.stringify(ke,null,2),vt.title=`Debug: ${ke.title} // ${(0,ea.LE)(new Date)}`,vt.tags=["debug",`debug-${At.panelType}`],vt.time={from:Ce.from.toISOString(),to:Ce.to.toISOString()},vt}function Zi(Ie){return Ie.transformations?`<tr>
      <th>Transform</th>
      <td>${Ie.transformations.map(pe=>pe.id).join(", ")}</td>
  </tr>`:""}function qi(Ie,pe){let Ce=Ie.series.length??0,ke=0,ut=0;for(const vt of Ie.series)ke+=vt.fields.length,ut+=vt.length;return`<tr><th>Data</th><td>${Ie.state!==Cs.Gu.Done?Ie.state:""} ${Ce} frames, ${ke} fields, ${ut} rows </td></tr>`}function dr(Ie){return Ie.annotations?.length?`<tr>
  <th>Annotations</th>
  <td>${Ie.annotations.reduce((pe,Ce)=>Ce.length+pe,0)}</td>
</tr>`:""}const bo={panels:[{id:2,title:"Reproduced with embedded data",datasource:{type:"grafana",uid:"grafana"},gridPos:{h:13,w:15,x:0,y:0}},{gridPos:{h:7,w:9,x:15,y:0},id:5,options:{content:"...",mode:"html"},title:"Debug info",type:"text"},{id:6,title:"Original Panel JSON",type:"text",gridPos:{h:13,w:9,x:15,y:7},options:{content:"...",mode:"code",code:{language:"json",showLineNumbers:!0,showMiniMap:!0}}},{id:3,title:"Data from panel above",type:"table",datasource:{type:"datasource",uid:"-- Dashboard --"},gridPos:{h:7,w:15,x:0,y:13},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,refId:"A"}]}],schemaVersion:37};var Ja=(Ie=>(Ie[Ie.Support=0]="Support",Ie[Ie.Data=1]="Data",Ie))(Ja||{}),Do=(Ie=>(Ie[Ie.PanelSnapshot=0]="PanelSnapshot",Ie[Ie.GithubComment=1]="GithubComment",Ie))(Do||{});class ko extends Yi.Q{constructor(pe){super({panel:pe,panelTitle:o.jh.interpolate(pe,pe.state.title,{},"text"),currentTab:0,showMessage:1,snapshotText:"",markdownText:"",randomize:{},snapshotUpdate:0,options:[{label:(0,s.t)("dashboard-scene.support-snapshot-service.label.git-hub-comment","GitHub comment"),description:"Copy and paste this message into a GitHub issue or comment",value:1},{label:(0,s.t)("dashboard-scene.support-snapshot-service.label.panel-support-snapshot","Panel support snapshot"),description:(0,s.t)("dashboard-scene.support-snapshot-service.description.dashboard-troubleshoot-visualization-issues","Dashboard JSON used to help troubleshoot visualization issues"),value:0}]}),this.onCurrentTabChange=Ce=>{this.setState({currentTab:Ce})},this.onShowMessageChange=Ce=>{this.setState({showMessage:Ce.value})},this.onGetMarkdownForClipboard=()=>{const{markdownText:Ce}=this.state,ke=Math.pow(1024,2)*1.5;return Ce.length>ke?(this.setState({error:{title:(0,s.t)("dashboard-scene.support-snapshot-service.title.copy-to-clipboard-failed","Copy to clipboard failed"),message:"Snapshot is too large, consider download and attaching a file instead"}}),""):Ce},this.onDownloadDashboard=()=>{const{snapshotText:Ce,panelTitle:ke}=this.state,ut=new Blob([Ce],{type:"text/plain"}),vt=`debug-${ke}-${(0,ea.LE)(new Date)}.json.txt`;me()(ut,vt)},this.onSetSnapshotText=Ce=>{this.setState({snapshotText:Ce})},this.onToggleRandomize=Ce=>{const{randomize:ke}=this.state;this.setState({randomize:{...ke,[Ce]:!ke[Ce]}})}}async buildDebugDashboard(){const{panel:pe,randomize:Ce,snapshotUpdate:ke}=this.state,ut=await Ks(pe,Ce,o.jh.getTimeRange(pe).state.value),vt=JSON.stringify(ut,null,2),At=Po(pe,vt),jt=(0,Qo.cN)((0,Qo.j_)("bytes")(vt?.length??0));let $t;if(ut)try{$t=(0,xn.wM)({dashboard:ut,meta:{isEmbedded:!0}}).state.body}catch(Yt){console.log("Error creating scene:",Yt)}this.setState({snapshot:ut,snapshotText:vt,markdownText:At,snapshotSize:jt,snapshotUpdate:ke+1,scene:$t})}}function Er({panel:Ie,onClose:pe}){const Ce=(0,xt.of)(Yr),ke=(0,w.useMemo)(()=>new ko(Ie),[Ie]),ut=Ie.getPlugin(),{currentTab:vt,loading:At,error:jt,options:$t,showMessage:Yt,snapshotSize:qt,markdownText:hn,snapshotText:Cn,randomize:Nn,panelTitle:In,scene:un}=ke.useState();if((0,w.useEffect)(()=>{ke.buildDebugDashboard()},[ke,ut,Nn]),!ut)return null;const Sn=[{label:(0,s.t)("dashboard-scene.help-wizard.tabs.label.snapshot","Snapshot"),value:Ja.Support},{label:(0,s.t)("dashboard-scene.help-wizard.tabs.label.data","Data"),value:Ja.Data}],fa=r.$.supportBundlesEnabled&&ir.TP.hasPermission(lr.w.ActionSupportBundlesCreate);return(0,S.jsxs)(T._,{title:(0,s.t)("dashboard-scene.help-wizard.title-get-help-with-this-panel","Get help with this panel"),size:"lg",onClose:pe,subtitle:(0,S.jsxs)(X.B,{direction:"column",gap:1,children:[(0,S.jsxs)(X.B,{direction:"row",gap:1,children:[(0,S.jsx)(pc.y,{featureState:a.Ay.beta}),(0,S.jsx)(De.Y,{href:"https://grafana.com/docs/grafana/latest/troubleshooting/",external:!0,children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.help-wizard.troubleshooting-docs",children:"Troubleshooting docs"})})]}),(0,S.jsx)("span",{className:"muted",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.help-wizard.troubleshooting-request-help",children:"To request troubleshooting help, send a snapshot of this panel to Grafana Labs Technical Support. The snapshot contains query response data and panel settings."})}),fa&&(0,S.jsx)("span",{className:"muted",children:(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene-help-wizard.support-bundle",children:["You can also retrieve a support bundle containing information concerning your Grafana instance and configured datasources in the ",(0,S.jsx)(De.Y,{href:"/support-bundles",children:"support bundles section"}),"."]})})]}),tabs:(0,S.jsx)(_.U,{children:Sn.map((zn,sa)=>(0,S.jsx)(K.o,{label:zn.label,active:zn.value===vt,onChangeTab:()=>ke.onCurrentTabChange(zn.value)},`${zn.value}-${sa}`))}),children:[At&&(0,S.jsx)(xr.y,{}),jt&&(0,S.jsx)(Y.F,{title:jt.title,children:jt.message}),vt===Ja.Data&&(0,S.jsxs)("div",{className:Ce.code,children:[(0,S.jsxs)("div",{className:Ce.opts,children:[(0,S.jsx)(I.D,{label:(0,s.t)("dashboard-scene.help-wizard.label-template","Template"),className:Ce.field,children:(0,S.jsx)(yo.l6,{options:$t,value:Yt,onChange:ke.onShowMessageChange})}),Yt===Do.GithubComment?(0,S.jsx)(Ve.b,{icon:"copy",getText:ke.onGetMarkdownForClipboard,children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.help-wizard.copy-to-clipboard",children:"Copy to clipboard"})}):(0,S.jsx)(Z.$n,{icon:"download-alt",onClick:ke.onDownloadDashboard,children:(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.help-wizard.download-snapshot",children:["Download (",{snapshotSize:qt},")"]})})]}),(0,S.jsx)(ye.Ay,{disableWidth:!0,children:({height:zn})=>(0,S.jsx)(Le.B,{width:"100%",height:zn,language:Yt===Do.GithubComment?"markdown":"json",showLineNumbers:!0,showMiniMap:!0,value:Yt===Do.GithubComment?hn:Cn,readOnly:!1,onBlur:ke.onSetSnapshotText})})]}),vt===Ja.Support&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(I.D,{label:(0,s.t)("dashboard-scene.help-wizard.label-randomize-data","Randomize data"),description:(0,s.t)("dashboard-scene.help-wizard.description-randomize-data","Modify the original data to hide sensitive information. Note the lengths will stay the same, and duplicate values will be equal."),children:(0,S.jsxs)(X.B,{children:[(0,S.jsx)(q.K,{label:(0,s.t)("dashboard-scene.help-wizard.randomize-labels-label-labels","Labels"),id:"randomize-labels",showLabel:!0,value:!!Nn.labels,onChange:()=>ke.onToggleRandomize("labels")}),(0,S.jsx)(q.K,{label:(0,s.t)("dashboard-scene.help-wizard.randomize-field-names-label-field-names","Field names"),id:"randomize-field-names",showLabel:!0,value:!!Nn.names,onChange:()=>ke.onToggleRandomize("names")}),(0,S.jsx)(q.K,{label:(0,s.t)("dashboard-scene.help-wizard.randomize-string-values-label-string-values","String values"),id:"randomize-string-values",showLabel:!0,value:!!Nn.values,onChange:()=>ke.onToggleRandomize("values")})]})}),(0,S.jsx)(I.D,{label:(0,s.t)("dashboard-scene.help-wizard.label-support-snapshot","Support snapshot"),description:(0,s.t)("dashboard-scene.help-wizard.description-support-snapshot","Panel: {{panelTitle}}",{panelTitle:In}),children:(0,S.jsxs)(X.B,{children:[(0,S.jsx)(Z.$n,{icon:"download-alt",onClick:ke.onDownloadDashboard,children:(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.help-wizard.download-dashboard",children:["Dashboard (",{snapshotSize:qt},")"]})}),(0,S.jsx)(Ve.b,{icon:"github",getText:ke.onGetMarkdownForClipboard,title:(0,s.t)("dashboard-scene.help-wizard.title-complete-git-hub-comment-clipboard","Copy a complete GitHub comment to the clipboard"),children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.help-wizard.copy-to-clipboard",children:"Copy to clipboard"})})]})}),(0,S.jsx)("div",{style:{height:"100%",overflow:"auto",display:"flex"},children:un&&(0,S.jsx)(un.Component,{model:un})})]})]})}const Yr=Ie=>({code:(0,he.css)({flexGrow:1,height:"100%",overflow:"scroll"}),field:(0,he.css)({width:"100%"}),opts:(0,he.css)({display:"flex",width:"100%",flexGrow:0,alignItems:"center",justifyContent:"flex-end","& button":{marginLeft:Ie.spacing(1)}})});var Ar=e(42836);class gc extends o.Bs{constructor(pe){super({...pe,options:{withTransforms:!1,withFieldConfig:!0}}),this.onOptionsChange=Ce=>{this.setState({options:Ce})}}getTabLabel(){return(0,s.t)("dashboard.inspect.data-tab","Data")}getTabValue(){return za.q.Data}static{this.Component=({model:pe})=>{const{options:Ce}=pe.useState(),ke=pe.state.panelRef.resolve(),ut=o.jh.getData(ke),{data:vt}=Yo(ut,Ce.withTransforms).useState(),At=o.jh.getTimeRange(ke);return vt||s.x6,(0,S.jsx)(Ar.q,{isLoading:vt?.state===Cs.Gu.Loading,data:vt?.series,options:Ce,hasTransformations:ls(ut),timeZone:At.getTimeZone(),panelPluginId:ke.state.pluginId,dataName:o.jh.interpolate(ke,ke.state.title),fieldConfig:ke.state.fieldConfig,onOptionsChange:pe.onOptionsChange})}}}function ls(Ie){return Ie instanceof o.Es?Ie.state.transformations.length>0:!1}function Yo(Ie,pe){return!pe&&Ie instanceof o.Es&&Ie.state.$data?Ie.state.$data:Ie}var el=e(98314),mc=e(89460),ba=e(8419),Ta=e(67497);class vc extends o.Bs{constructor(pe){super({...pe,source:"panel-json",jsonText:Jo("panel-json",pe.panelRef.resolve())}),this.onChangeSource=Ce=>{this.setState({source:Ce.value,jsonText:Jo(Ce.value,this.state.panelRef.resolve())})},this.onApplyChange=()=>{const Ce=this.state.panelRef.resolve(),ke=(0,C.YQ)(Ce),ut=JSON.parse(this.state.jsonText),vt=new m.a9(ut),At=(0,xn.tt)(vt),jt=o.Go.cloneSceneObjectState(At.state);if(!(Ce.parent instanceof es.U)){console.error("Cannot update state of panel",Ce,At);return}this.state.onClose(),ke.state.isEditing||ke.onEnterEditMode(),Ce.parent.setState(jt),(0,Ta.B9)(za.q.JSON,"apply",{panel_type_changed:Ce.state.pluginId!==vt.type,panel_id_changed:(0,C.Cs)(Ce)!==vt.id,panel_grid_pos_changed:Xo(Ce.parent.state,jt),panel_targets_changed:Zo((0,C.un)(Ce),(0,C.un)(jt.$data))})},this.onCodeEditorBlur=Ce=>{this.setState({jsonText:Ce})}}getTabLabel(){return(0,s.t)("dashboard.inspect.json-tab","JSON")}getTabValue(){return za.q.JSON}getOptions(){const pe=this.state.panelRef.resolve(),Ce=pe.state.$data??pe.parent?.state.$data,ke=[{label:(0,s.t)("dashboard.inspect-json.panel-json-label","Panel JSON"),description:(0,s.t)("dashboard.inspect-json.panel-json-description","The model saved in the dashboard JSON that configures how everything works."),value:"panel-json"}];return Ce&&(ke.push({label:(0,s.t)("dashboard.inspect-json.panel-data-label","Panel data"),description:(0,s.t)("dashboard.inspect-json.panel-data-description","The raw model passed to the panel visualization"),value:"panel-data"}),ke.push({label:(0,s.t)("dashboard.inspect-json.dataframe-label","DataFrame JSON (from Query)"),description:(0,s.t)("dashboard.inspect-json.dataframe-description","Raw data without transformations and field config applied. "),value:"data-frames"})),ke}isEditable(){if(this.state.source!=="panel-json")return!1;const pe=this.state.panelRef.resolve();return(0,C.ME)(pe)||(0,ln.aK)((0,C.YQ)(pe).getSaveModel())||pe.parent instanceof es.U&&pe.parent.isRepeated()?!1:(0,C.YQ)(pe).state.meta.canEdit}static{this.Component=({model:pe})=>{const{source:Ce,jsonText:ke}=pe.useState(),ut=(0,xt.of)(mc.A),vt=pe.getOptions();return(0,S.jsxs)("div",{className:ut.wrap,children:[(0,S.jsxs)("div",{className:ut.toolbar,"data-testid":Q.Tp.components.PanelInspector.Json.content,children:[(0,S.jsx)(I.D,{label:(0,s.t)("dashboard.inspect-json.select-source","Select source"),className:"flex-grow-1",children:(0,S.jsx)(yo.l6,{inputId:"select-source-dropdown",options:vt,value:vt.find(At=>At.value===Ce)??vt[0].value,onChange:pe.onChangeSource})}),pe.isEditable()&&(0,S.jsx)(Z.$n,{className:ut.toolbarItem,onClick:pe.onApplyChange,children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.inspect-json-tab.apply",children:"Apply"})})]}),(0,S.jsx)("div",{className:ut.content,children:(0,S.jsx)(ye.Ay,{disableWidth:!0,children:({height:At})=>(0,S.jsx)(Le.B,{width:"100%",height:At,language:"json",showLineNumbers:!0,showMiniMap:ke.length>100,value:ke,readOnly:!pe.isEditable(),onBlur:pe.onCodeEditorBlur})})})]})}}}function Jo(Ie,pe){let Ce={};switch(Ie){case"panel-json":{(0,Ta.B9)(za.q.JSON,"panelData");const ke=(0,C.ME)(pe),ut=pe.parent;if(ke){Ce=ur(pe);break}if((0,ln.aK)((0,C.YQ)(pe).getSaveModel())){Ce=(0,Lt.GB)(pe);break}else ut instanceof es.U&&(Ce=(0,gt.ZB)(ut));break}case"panel-data":{(0,Ta.B9)(za.q.JSON,"panelJSON");const ke=o.jh.getData(pe);ke.state.data&&(Ce=pe.applyFieldConfig(ke.state.data));break}case"data-frames":{(0,Ta.B9)(za.q.JSON,"dataFrame");const ke=o.jh.getData(pe);ke.state.data&&(ke instanceof o.Es&&ke.state.$data?.state.data?Ce=(0,el.B6)(ke.state.$data.state.data):Ce=(0,el.B6)(ke.state.data))}}return(0,ba.p)(Ce)}function ur(Ie){if(!(0,C.ME)(Ie))throw"Panel not a library panel";const pe=Ie.parent;if(!(pe instanceof es.U))throw"LibraryPanel not child of DashboardGridItem";const Ce={x:pe.state.x||0,y:pe.state.y||0,h:pe.state.height||0,w:pe.state.width||0},ke=Co(Ie),ut=(0,gt.Z6)(Ie.clone({$behaviors:void 0}),Ce,!1,pe);return{libraryPanel:{...ke},...ut}}function Co(Ie){if(!(0,C.ME)(Ie))throw new Error("Panel not a Library panel");const pe=(0,C.iL)(Ie);if(!pe)throw new Error("Library panel behavior not found");if(!pe.state._loadedPanel)throw new Error("Library panel not loaded");return pe.state._loadedPanel}function Xo(Ie,pe){return Ie.x!==pe.x||Ie.y!==pe.y||Ie.width!==pe.width||Ie.height!==pe.height}function Zo(Ie,pe){return Ie===void 0||pe===void 0?!1:!(0,cr.isEqual)(Ie.state.queries,pe.state.queries)}class Jr extends o.Bs{getTabLabel(){return(0,s.t)("dashboard.inspect.meta-tab","Meta data")}getTabValue(){return za.q.Meta}static{this.Component=({model:pe})=>{const{panelRef:Ce,dataSource:ke}=pe.state,ut=o.jh.getData(Ce.resolve()),vt=ke.components?.MetadataInspector;return!ut.state.data||!vt?null:(0,S.jsx)(vt,{datasource:ke,data:ut.state.data.series})}}}var tl=e(96065);class qo extends o.Bs{constructor(){super(...arguments),this.onRefreshQuery=()=>{const pe=(0,C.un)(this.state.panelRef.resolve());pe&&pe.runQueries()}}getTabLabel(){return(0,s.t)("dashboard.inspect.query-tab","Query")}getTabValue(){return za.q.Query}static{this.Component=({model:pe})=>{const Ce=o.jh.getData(pe.state.panelRef.resolve()).useState();return Ce.data?(0,S.jsx)(tl.e,{data:Ce.data,onRefreshQuery:pe.onRefreshQuery}):null}}}var Ss=e(55072);class Sa extends o.Bs{getTabLabel(){return(0,s.t)("dashboard.inspect.stats-tab","Stats")}getTabValue(){return za.q.Stats}static{this.Component=({model:pe})=>{const Ce=o.jh.getData(pe.state.panelRef.resolve()).useState(),ke=o.jh.getTimeRange(pe.state.panelRef.resolve());return Ce.data?(0,S.jsx)(Ss.N,{data:Ce.data,timeZone:ke.getTimeZone()}):null}}}class ei extends o.Bs{constructor(pe){super(pe),this.onClose=()=>{al((0,C.YQ)(this))},this.addActivationHandler(()=>this._activationHandler())}static{this.Component=nl}_activationHandler(){this.buildTabs(0)}async buildTabs(pe){const Ce=this.state.panelRef,ke=Ce.resolve()?.getPlugin(),ut=[];if(ke||(pe<2e3?setTimeout(()=>this.buildTabs(pe+100),100):this.setState({pluginNotLoaded:!0})),Ce){if((0,or.$)(ke)){const vt=o.jh.getData(Ce.resolve());ut.push(new gc({panelRef:Ce})),ut.push(new Sa({panelRef:Ce})),ut.push(new qo({panelRef:Ce}));const At=await(0,fc.BN)(vt.state.data);At&&ut.push(new Jr({panelRef:Ce,dataSource:At}))}ut.push(new vc({panelRef:Ce,onClose:this.onClose}))}this.setState({tabs:ut})}getDrawerTitle(){const pe=this.state.panelRef?.resolve();return pe?o.jh.interpolate(pe,`Inspect: ${pe.state.title}`):"Inspect panel"}}function nl({model:Ie}){const{tabs:pe,pluginNotLoaded:Ce,panelRef:ke}=Ie.useState(),ut=(0,Me.zy)(),vt=new URLSearchParams(ut.search);if(!pe)return null;const At=vt.get("inspectTab"),jt=pe.find(Yt=>Yt.getTabValue()===At)??pe[0],$t=ke.resolve();return At===za.q.Help?(0,S.jsx)(Er,{panel:$t,onClose:Ie.onClose}):(0,S.jsxs)(T._,{title:Ie.getDrawerTitle(),onClose:Ie.onClose,size:"md",tabs:(0,S.jsx)(_.U,{children:pe.map(Yt=>(0,S.jsx)(K.o,{label:Yt.getTabLabel(),active:Yt===jt,href:n.I.getUrlForPartial(ut,{inspectTab:Yt.getTabValue()})},Yt.state.key))}),children:[Ce&&(0,S.jsx)(Y.F,{title:(0,s.t)("dashboard-scene.panel-inspect-renderer.title-panel-plugin-not-loaded","Panel plugin not loaded"),children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.panel-inspect-renderer.body-panel-plugin-not-loaded",children:"Make sure the panel you want to inspect is visible and has been displayed before opening inspect."})}),jt&&jt.Component&&(0,S.jsx)(jt.Component,{model:jt})]})}function al(Ie){const pe=Ie.state.meta,Ce=!Ie.state.uid&&i.Ny.getLocation().pathname==="/dashboard/new";i.Ny.push((0,Pt.u)({uid:Ie.state.uid,slug:Ie.state.meta.slug,currentQueryParams:i.Ny.getLocation().search,updateQuery:{inspect:null,inspectTab:null},isHomeDashboard:!pe.url&&!pe.slug&&!Ce}))}var ti=e(89451),sl=e(48480),To=e(78282),Mo=e(49e3);class jr{constructor(pe){this._scene=pe}getKeys(){return["editIndex"]}getUrlState(){const pe=this._scene.state;return{editIndex:pe.editIndex!==void 0?String(pe.editIndex):void 0}}updateFromUrl(pe){let Ce={};typeof pe.editIndex=="string"?Ce={editIndex:Number(pe.editIndex)}:Ce={editIndex:void 0},Object.keys(Ce).length>0&&this._scene.setState(Ce)}}var yc=e(16817),ni=e(16780),So=e(38669),ai=e(76478),Oo=e(76792);const rl="New annotation",ws=({annotation:Ie,editIndex:pe,panels:Ce,onUpdate:ke,onBackToList:ut,onDelete:vt})=>{const At=(0,xt.of)(gs),jt=(0,w.useMemo)(()=>Ie.filter?Ie.filter.exclude?2:1:0,[Ie.filter]),{value:$t}=(0,yc.A)(()=>(0,To.l)().get(Ie.datasource),[Ie.datasource]),Yt=(0,To.l)().getInstanceSettings(Ie.datasource),qt=Bn=>{ke({...Ie,name:Bn.currentTarget.value},pe)},hn=Bn=>{const qn=(0,sl.p$)(Bn);Ie.datasource?.type!==qn.type?ke({datasource:qn,builtIn:Ie.builtIn,enable:Ie.enable,iconColor:Ie.iconColor,name:Ie.name,hide:Ie.hide,filter:Ie.filter,mappings:Ie.mappings,type:Ie.type},pe):ke({...Ie,datasource:qn},pe)},Cn=Bn=>{const qn=Bn.currentTarget;ke({...Ie,[qn.name]:qn.type==="checkbox"?qn.checked:qn.value},pe)},Nn=Bn=>{ke({...Ie,iconColor:Bn},pe)},In=Bn=>{let qn=Bn.value===0?void 0:{exclude:Bn.value===2,ids:Ie.filter?.ids??[]};ke({...Ie,filter:qn},pe)},un=Bn=>{if(!Array.isArray(Bn))return;const qn={exclude:jt===2,ids:[]};Bn.forEach(pa=>pa.value&&qn.ids.push(pa.value)),ke({...Ie,filter:qn},pe)},Sn=()=>{vt(pe),ut()},fa=Ie.name===rl,zn=(Bn,qn)=>Bn.label&&qn.label?Bn.label.toLowerCase().localeCompare(qn.label.toLowerCase()):-1,sa=(0,w.useMemo)(()=>Ce.filter(Bn=>r.$.panels[Bn.state.pluginId]).map(Bn=>({value:(0,C.Cs)(Bn),label:Bn.state.title??`Panel ${(0,C.Cs)(Bn)}`,description:Bn.state.description,imgUrl:r.$.panels[Bn.state.pluginId].info.logos.small})).sort(zn)??[],[Ce]);return(0,S.jsxs)("div",{children:[(0,S.jsxs)(ni.n,{className:At.settingsForm,children:[(0,S.jsx)(I.D,{label:(0,s.t)("dashboard-scene.annotation-settings-edit.label-name","Name"),children:(0,S.jsx)(J.p,{"data-testid":Q.Tp.pages.Dashboard.Settings.Annotations.Settings.name,name:"name",id:"name",autoFocus:fa,value:Ie.name,onChange:qt})}),(0,S.jsx)(I.D,{label:(0,s.t)("dashboard-scene.annotation-settings-edit.label-data-source","Data source"),htmlFor:"data-source-picker",children:(0,S.jsx)(Oo.s,{annotations:!0,variables:!0,current:Ie.datasource,onChange:hn})}),!$t?.meta.annotations&&(0,S.jsx)(Y.F,{title:(0,s.t)("dashboard-scene.annotation-settings-edit.title-annotation-support-source","No annotation support for this data source"),severity:"error",children:(0,S.jsx)(s.x6,{i18nKey:"errors.dashboard-settings.annotations.datasource",children:"The selected data source does not support annotations. Please select a different data source."})}),(0,S.jsx)(I.D,{label:(0,s.t)("dashboard-scene.annotation-settings-edit.label-enabled","Enabled"),description:(0,s.t)("dashboard-scene.annotation-settings-edit.description-enabled-annotation-query-issued-every-dashboard","When enabled the annotation query is issued every dashboard refresh"),children:(0,S.jsx)(we.S,{name:"enable",id:"enable",value:Ie.enable,onChange:Cn,"data-testid":Q.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.enable})}),(0,S.jsx)(I.D,{label:(0,s.t)("dashboard-scene.annotation-settings-edit.label-hidden","Hidden"),description:(0,s.t)("dashboard-scene.annotation-settings-edit.description-hidden","Annotation queries can be toggled on or off at the top of the dashboard. With this option checked this toggle will be hidden."),children:(0,S.jsx)(we.S,{name:"hide",id:"hide",value:Ie.hide,onChange:Cn,"data-testid":Q.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.hide})}),(0,S.jsx)(I.D,{label:(0,s.t)("dashboard-scene.annotation-settings-edit.label-color","Color"),description:(0,s.t)("dashboard-scene.annotation-settings-edit.description-color-annotation-event-markers","Color to use for the annotation event markers"),children:(0,S.jsx)(X.B,{children:(0,S.jsx)(So.a,{value:Ie?.iconColor,onChange:Nn})})}),(0,S.jsx)(I.D,{label:(0,s.t)("dashboard-scene.annotation-settings-edit.label-show-in","Show in"),"data-testid":Q.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.showInLabel,children:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(yo.l6,{options:xc,value:jt,onChange:In,"data-testid":Q.Tp.components.Annotations.annotationsTypeInput}),jt!==0&&(0,S.jsx)(yo.KF,{options:sa,value:sa.filter(Bn=>Ie.filter?.ids.includes(Bn.value)),onChange:un,isClearable:!0,placeholder:(0,s.t)("dashboard-scene.annotation-settings-edit.placeholder-choose-panels","Choose panels"),width:100,closeMenuOnSelect:!1,className:At.select,"data-testid":Q.Tp.components.Annotations.annotationsChoosePanelInput})]})})]}),(0,S.jsxs)(ni.n,{children:[(0,S.jsx)("h3",{className:"page-heading",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.annotation-settings-edit.query",children:"Query"})}),$t?.annotations&&Yt&&(0,S.jsx)(ai.A,{datasource:$t,datasourceInstanceSettings:Yt,annotation:Ie,onChange:Bn=>ke(Bn,pe)})]}),(0,S.jsxs)(X.B,{children:[!Ie.builtIn&&(0,S.jsx)(Z.$n,{variant:"destructive",onClick:Sn,"data-testid":Q.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.delete,children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.annotation-settings-edit.delete",children:"Delete"})}),(0,S.jsx)(Z.$n,{variant:"secondary",onClick:ut,"data-testid":Q.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.apply,children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.annotation-settings-edit.back-to-list",children:"Back to list"})})]})]})},gs=Ie=>({settingsForm:(0,he.css)({maxWidth:Ie.spacing(60),marginBottom:Ie.spacing(2)}),select:(0,he.css)({marginTop:"8px"})});var ol=(Ie=>(Ie[Ie.AllPanels=0]="AllPanels",Ie[Ie.IncludePanels=1]="IncludePanels",Ie[Ie.ExcludePanels=2]="ExcludePanels",Ie))(ol||{});const xc=[{label:"All panels",value:0,description:"Send the annotation data to all panels that support annotations"},{label:"Selected panels",value:1,description:"Send the annotations to the explicitly listed panels"},{label:"All panels except",value:2,description:"Do not send annotation data to the following panels"}];var Ec=e(44458),il=e(50201),Io=e(39302);const Pc="Add annotation query",bc=({annotations:Ie,onNew:pe,onEdit:Ce,onMove:ke,onDelete:ut})=>{const vt=(0,xt.of)(si),At=Ie.length===0||Ie.length===1&&Ie[0].builtIn,jt=Yt=>Yt.enable===!1?(0,S.jsx)("em",{className:"muted",children:(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.annotation-settings-list.disabled",values:{annoName:Yt.name},children:["(Disabled) ","{{annoName}}"]})}):Yt.builtIn?(0,S.jsx)("em",{className:"muted",children:(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.annotation-settings-list.built-in",values:{annoName:Yt.name},children:["{{annoName}}"," (Built-in)"]})}):(0,S.jsx)(S.Fragment,{children:Yt.name}),$t=(0,To.l)();return(0,S.jsxs)(X.B,{direction:"column",children:[Ie.length>0&&(0,S.jsx)("div",{className:vt.table,children:(0,S.jsxs)("table",{role:"grid",className:"filter-table filter-table--hover",children:[(0,S.jsx)("thead",{children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.annotation-settings-list.query-name",children:"Query name"})}),(0,S.jsx)("th",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.annotation-settings-list.data-source",children:"Data source"})}),(0,S.jsx)("th",{colSpan:3})]})}),(0,S.jsx)("tbody",{"data-testid":Q.Tp.pages.Dashboard.Settings.Annotations.List.annotations,children:Ie.map((Yt,qt)=>(0,S.jsxs)("tr",{children:[Yt.builtIn?(0,S.jsx)("td",{role:"gridcell",style:{width:"90%"},className:"pointer",onClick:()=>Ce(qt),children:(0,S.jsx)(Z.$n,{size:"sm",fill:"text",variant:"secondary",children:jt(Yt)})}):(0,S.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>Ce(qt),children:(0,S.jsx)(Z.$n,{size:"sm",fill:"text",variant:"secondary",children:jt(Yt)})}),(0,S.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>Ce(qt),children:$t.getInstanceSettings(Yt.datasource)?.name||Yt.datasource?.uid}),(0,S.jsx)("td",{role:"gridcell",style:{width:"1%"},children:qt!==0&&(0,S.jsx)(ta.K,{name:"arrow-up",onClick:()=>ke(qt,Xr.UP),tooltip:(0,s.t)("dashboard-scene.annotation-settings-list.tooltip-move-up","Move up")})}),(0,S.jsx)("td",{role:"gridcell",style:{width:"1%"},children:Ie.length>1&&qt!==Ie.length-1?(0,S.jsx)(ta.K,{name:"arrow-down",onClick:()=>ke(qt,Xr.DOWN),tooltip:(0,s.t)("dashboard-scene.annotation-settings-list.tooltip-move-down","Move down")}):null}),(0,S.jsx)("td",{role:"gridcell",style:{width:"1%"},children:!Yt.builtIn&&(0,S.jsx)(Ec.e,{size:"sm",onConfirm:()=>ut(qt),"aria-label":(0,s.t)("dashboard-scene.annotation-settings-list.delete-aria-label",'Delete query with title "{{title}}"',{title:Yt.name})})})]},`${Yt.name}-${qt}`))})]})}),At&&(0,S.jsx)(X.B,{direction:"column",children:(0,S.jsxs)(il.p,{variant:"call-to-action",button:(0,S.jsx)(Z.$n,{"data-testid":Q.Tp.components.CallToActionCard.buttonV2("Add annotation query"),icon:"comment-alt",onClick:pe,size:"lg",children:(0,S.jsx)(s.x6,{i18nKey:"annotations.empty-state.button-title",children:"Add annotation query"})}),message:(0,s.t)("annotations.empty-state.title","There are no custom annotation queries added yet"),children:[(0,S.jsx)(s.x6,{i18nKey:"annotations.empty-state.info-box-content",children:(0,S.jsx)("p",{children:"Annotations provide a way to integrate event data into your graphs. They are visualized as vertical lines and icons on all graph panels. When you hover over an annotation icon you can get event text & tags for the event. You can add annotation events directly from grafana by holding CTRL or CMD + click on graph (or drag region). These will be stored in Grafana's annotation database."})}),(0,S.jsxs)(s.x6,{i18nKey:"annotations.empty-state.info-box-content-2",children:["Checkout the"," ",(0,S.jsx)(De.Y,{external:!0,href:"http://docs.grafana.org/reference/annotations/",children:"Annotations documentation"})," ","for more information."]})]})}),!At&&(0,S.jsx)(Io.d,{"data-testid":Q.Tp.pages.Dashboard.Settings.Annotations.List.addAnnotationCTAV2,onClick:pe,children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.annotation-settings-list.new-query",children:"New query"})})]})},si=()=>({table:(0,he.css)({width:"100%",overflowX:"auto"})});var Xr=(Ie=>(Ie[Ie.UP=-1]="UP",Ie[Ie.DOWN=1]="DOWN",Ie))(Xr||{});class ll extends o.Bs{constructor(){super(...arguments),this._urlSync=new jr(this),this.getDataSourceRefForAnnotation=()=>{const pe=(0,To.l)().getInstanceSettings(null);if(!pe||!pe.meta.annotations){console.error("Default datasource does not support annotations");return}return(0,sl.p$)(pe)},this.onNew=async()=>{const pe={name:rl,enable:!0,datasource:this.getDataSourceRefForAnnotation(),iconColor:"red"},Ce=new Mo.g({query:pe,name:pe.name,isEnabled:!!pe.enable,isHidden:!!pe.hide}),ke=Xn.b4.getDataLayers(this._dashboard);ke.addAnnotationLayer(Ce),this.setState({editIndex:ke.state.annotationLayers.length-1})},this.onEdit=pe=>{this.setState({editIndex:pe})},this.onBackToList=()=>{this.setState({editIndex:void 0})},this.onMove=(pe,Ce)=>{const ke=Xn.b4.getDataLayers(this._dashboard),ut=[...ke.state.annotationLayers],[vt]=ut.splice(pe,1);ut.splice(pe+Ce,0,vt),ke.setState({annotationLayers:ut})},this.onDelete=pe=>{const Ce=Xn.b4.getDataLayers(this._dashboard),ke=[...Ce.state.annotationLayers];ke.splice(pe,1),Ce.setState({annotationLayers:ke})},this.onUpdate=(pe,Ce)=>{const ke=this.getDataLayer(Ce);ke.setState({name:pe.name,isEnabled:!!pe.enable,isHidden:!!pe.hide,query:pe}),ke.runLayer()}}static{this.Component=cl}getUrlKey(){return"annotations"}get _dashboard(){return(0,C.YQ)(this)}getDataLayer(pe){const ke=Xn.b4.getDataLayers(this._dashboard).state.annotationLayers[pe];if(!(ke instanceof o.tV.g))throw new Error("AnnotationsDataLayer not found at index "+pe);return ke}getDashboard(){return this._dashboard}}function cl({model:Ie}){const pe=Ie.getDashboard(),{annotationLayers:Ce}=Xn.b4.getDataLayers(pe).useState(),{navModel:ke,pageNav:ut}=er(pe,Ie.getUrlKey()),{editIndex:vt}=Ie.useState(),At=Xn.b4.getVizPanels(pe),jt=(0,oa.O)(Ce);return vt!=null&&vt<Ce.length?(0,S.jsx)(dl,{annotationLayer:Ie.getDataLayer(vt),pageNav:ut,panels:At,editIndex:vt,navModel:ke,dashboard:pe,onUpdate:Ie.onUpdate,onBackToList:Ie.onBackToList,onDelete:Ie.onDelete}):(0,S.jsxs)(Ln.Y,{navModel:ke,pageNav:ut,layout:kt.k.Standard,children:[(0,S.jsx)(Vt.c,{dashboard:pe}),(0,S.jsx)(bc,{annotations:jt,onNew:Ie.onNew,onEdit:Ie.onEdit,onDelete:Ie.onDelete,onMove:Ie.onMove})]})}function dl({annotationLayer:Ie,pageNav:pe,navModel:Ce,panels:ke,editIndex:ut,dashboard:vt,onUpdate:At,onBackToList:jt,onDelete:$t}){const{name:Yt,query:qt}=Ie.useState(),hn={text:Yt,parentItem:pe};return(0,S.jsxs)(Ln.Y,{navModel:Ce,pageNav:hn,layout:kt.k.Standard,children:[(0,S.jsx)(Vt.c,{dashboard:vt}),(0,S.jsx)(ws,{annotation:qt,editIndex:ut,panels:ke,onUpdate:At,onBackToList:jt,onDelete:$t})]})}var ul=e(46635),Lr=e(39468),Dc=e(88898),ri=e(86871);class Cc extends o.Bs{constructor(){super(...arguments),this._urlSync=new jr(this),this.onNewLink=()=>{this.links=[...this.links,ri.q],this.setState({editIndex:this.links.length-1})},this.onDelete=pe=>{this.links=[...this.links.slice(0,pe),...this.links.slice(pe+1)],this.setState({editIndex:void 0})},this.onDuplicate=pe=>{this.links=[...this.links,{...pe}]},this.onOrderChange=(pe,Ce)=>{this.links=ul.moveItemImmutably(this.links,pe,pe+Ce)},this.onEdit=pe=>{this.setState({editIndex:pe})},this.onUpdateLink=pe=>{const Ce=this.state.editIndex;Ce!==void 0&&(this.links=[...this.links.slice(0,Ce),pe,...this.links.slice(Ce+1)])},this.onGoBack=()=>{this.setState({editIndex:void 0})}}static{this.Component=Zr}getUrlKey(){return"links"}get dashboard(){return(0,C.YQ)(this)}get links(){return this.dashboard.state.links}set links(pe){this.dashboard.setState({links:pe})}}function Zr({model:Ie}){const{editIndex:pe}=Ie.useState(),Ce=(0,C.YQ)(Ie),{links:ke}=Ce.useState(),{navModel:ut,pageNav:vt}=er(Ce,Ie.getUrlKey()),At=pe!==void 0?ke[pe]:void 0;return At?(0,S.jsx)(Tc,{pageNav:vt,navModel:ut,link:At,dashboard:Ce,onChange:Ie.onUpdateLink,onGoBack:Ie.onGoBack}):(0,S.jsxs)(Ln.Y,{navModel:ut,pageNav:vt,layout:kt.k.Standard,children:[(0,S.jsx)(Vt.c,{dashboard:Ce}),(0,S.jsx)(Dc.X,{links:ke,onNew:Ie.onNewLink,onEdit:Ie.onEdit,onDelete:Ie.onDelete,onDuplicate:Ie.onDuplicate,onOrderChange:Ie.onOrderChange})]})}function Tc({pageNav:Ie,link:pe,navModel:Ce,dashboard:ke,onChange:ut,onGoBack:vt}){const At={text:(0,s.t)("dashboard-scene.edit-link-view.edit-link-page-nav.text.edit-link","Edit link"),parentItem:Ie};return(0,S.jsxs)(Ln.Y,{navModel:Ce,pageNav:At,layout:kt.k.Standard,children:[(0,S.jsx)(Vt.c,{dashboard:ke}),(0,S.jsx)(Lr.d,{link:pe,onUpdate:ut,onGoBack:vt})]})}var qr=e(10928),Pr=e(77824),eo=e(74475),hl=e(56291),fl=e(42357),Ro=e(70969),Fs=e(75570),pl=e(13542);function gl({dashboard:Ie,defaultValues:pe,loadedFromRef:Ce,readOnly:ke,isGitHub:ut,isNew:vt,workflowOptions:At,targetFolderUID:jt,targetFolderTitle:$t,onDismiss:Yt,onSuccess:qt}){const hn=(0,H.mN)({defaultValues:pe}),{editPanel:Cn}=Ie.useState(),{handleSubmit:Nn,watch:In}=hn,un=(0,u.J7)(),[Sn,fa]=In(["ref","workflow"]),{data:zn,isLoading:sa}=(0,ft.Kw)({name:pe.repo,path:pe.path}),{data:Bn}=(0,fe.k)({name:jt},{skip:!jt}),[qn,pa]=(0,ft.tj)(),[Un,cs]=(0,ft.Qo)(),[wr,Dr]=(0,w.useState)(""),ms=(0,Me.Zp)();(0,w.useEffect)(()=>{const ns=zn?.resource?.dryRun?.metadata?.annotations?.[E.Y_];if(!jt||!Bn||!ns)return;const xi=(Bn.metadata.annotations||{})[E.Y_]||$t,Fr=ns.split("/").pop(),Wo=`${xi}/${Fr}`;Dr(Wo)},[zn,Bn,jt,$t]);const Is=async({repo:ns,path:xs,comment:xi})=>{if(!zn?.resource?.file){un.publish({type:$e.r1.alertError.name,payload:[(0,s.t)("dashboard-scene.move-provisioned-dashboard-form.current-file-not-found","Current dashboard file could not be found")]});return}const Fr=fa==="write"?Ce:Sn,Wo=xi||`Move dashboard: ${Ie.state.title}`;try{await qn({name:ns,path:wr,ref:Fr,message:Wo,body:zn.resource.file}).unwrap(),await Un({name:ns,path:xs,ref:Fr,message:Wo}).unwrap()}catch(Vr){pa.isSuccess&&!cs.isSuccess&&un.publish({type:$e.r1.alertWarning.name,payload:[(0,s.t)("dashboard-scene.move-provisioned-dashboard-form.partial-failure-warning","Dashboard was created at new location but could not be deleted from original location. Please manually remove the old file.")]}),un.publish({type:$e.r1.alertError.name,payload:[(0,s.t)("dashboard-scene.move-provisioned-dashboard-form.api-error","Failed to move dashboard"),Vr]})}},pr=()=>{Cn?.onDiscard(),jt&&$t&&qt(jt,$t),ms("/dashboards")},tr=()=>{Cn?.onDiscard(),ms(`/dashboards?new_pull_request_url=${pa.data?.urls?.newPullRequestURL}`)};(0,Dt.J)({dashboard:Ie,request:pa,workflow:fa,handlers:{onBranchSuccess:tr,onWriteSuccess:pr}});const Rs=pa.isLoading||cs.isLoading;return(0,S.jsx)(T._,{title:(0,s.t)("dashboard-scene.move-provisioned-dashboard-form.drawer-title","Move Provisioned Dashboard"),subtitle:Ie.state.title,onClose:Yt,children:(0,S.jsx)(H.Op,{...hn,children:(0,S.jsx)("form",{onSubmit:Nn(Is),children:(0,S.jsxs)(X.B,{direction:"column",gap:2,children:[ke&&(0,S.jsx)(Y.F,{title:(0,s.t)("dashboard-scene.move-provisioned-dashboard-form.title-this-repository-is-read-only","This repository is read only"),children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.move-provisioned-dashboard-form.move-read-only-message",children:"This dashboard cannot be moved directly from Grafana because the repository is read-only. To move this dashboard, please move the file in your Git repository."})}),sa&&(0,S.jsxs)(X.B,{alignItems:"center",gap:2,children:[(0,S.jsx)(xr.y,{}),(0,S.jsx)("div",{children:(0,s.t)("dashboard-scene.move-provisioned-dashboard-form.loading-file-data","Loading dashboard data")})]}),zn?.errors?.length&&zn.errors.length>0&&(0,S.jsx)(Y.F,{title:(0,s.t)("dashboard-scene.move-provisioned-dashboard-form.file-load-error","Error loading dashboard"),severity:"error",children:zn.errors.map((ns,xs)=>(0,S.jsx)("div",{children:ns},xs))}),(0,S.jsx)(I.D,{noMargin:!0,label:(0,s.t)("dashboard-scene.move-provisioned-dashboard-form.target-path-label","Target path"),children:(0,S.jsx)(J.p,{readOnly:!0,value:wr})}),(0,S.jsx)(St.x,{resourceType:"dashboard",isNew:vt,readOnly:ke,workflow:fa,workflowOptions:At,isGitHub:ut}),(0,S.jsxs)(X.B,{gap:2,children:[(0,S.jsx)(Z.$n,{variant:"primary",type:"submit",disabled:Rs||ke||!zn||sa,children:Rs?(0,s.t)("dashboard-scene.move-provisioned-dashboard-form.moving","Moving..."):(0,s.t)("dashboard-scene.move-provisioned-dashboard-form.move-action","Move dashboard")}),(0,S.jsx)(Z.$n,{variant:"secondary",onClick:Yt,fill:"outline",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.move-provisioned-dashboard-form.cancel-action",children:"Cancel"})})]})]})})})})}function ml({dashboard:Ie,targetFolderUID:pe,targetFolderTitle:Ce,onDismiss:ke,onSuccess:ut}){const{defaultValues:vt,loadedFromRef:At,readOnly:jt,isGitHub:$t,workflowOptions:Yt,isNew:qt}=(0,Jt.S)(Ie);return vt?(0,S.jsx)(gl,{dashboard:Ie,defaultValues:vt,loadedFromRef:At,readOnly:jt,isGitHub:$t,isNew:qt,workflowOptions:Yt,targetFolderUID:pe,targetFolderTitle:Ce,onDismiss:ke,onSuccess:ut}):null}class Mc extends o.Bs{constructor(){super(...arguments),this.onTitleChange=pe=>{this._dashboard.setState({title:pe})},this.onDescriptionChange=pe=>{this._dashboard.setState({description:pe})},this.onTagsChange=pe=>{this._dashboard.setState({tags:pe})},this.onFolderChange=async(pe,Ce)=>{const ke={...this._dashboard.state.meta,folderUid:pe||this._dashboard.state.meta.folderUid,folderTitle:Ce||this._dashboard.state.meta.folderTitle};ke.folderUid&&await(0,Fs.Q)(ke.folderUid),this._dashboard.setState({meta:ke})},this.onEditableChange=pe=>{this._dashboard.setState({editable:pe})},this.onTimeZoneChange=pe=>{this.getTimeRange().setState({timeZone:pe})},this.onWeekStartChange=pe=>{this.getTimeRange().setState({weekStart:pe})},this.onRefreshIntervalChange=pe=>{this.getRefreshPicker()?.setState({intervals:pe})},this.onNowDelayChange=pe=>{this.getTimeRange()?.setState({UNSAFE_nowDelay:pe})},this.onHideTimePickerChange=pe=>{this.getDashboardControls()?.setState({hideTimeControls:pe})},this.onLiveNowChange=pe=>{try{const Ce=this.getLiveNowTimer();pe?Ce.enable():Ce.disable()}catch(Ce){console.error(Ce)}},this.onTooltipChange=pe=>{this.getCursorSync()?.setState({sync:pe})},this.onPreloadChange=pe=>{this._dashboard.setState({preload:pe})},this.onDeleteDashboard=()=>{},this.onProvisionedFolderChange=async(pe,Ce)=>{pe!==this._dashboard.state.meta.folderUid&&this.setState({showMoveModal:!0,moveModalProps:{targetFolderUID:pe,targetFolderTitle:Ce}})},this.onMoveModalDismiss=()=>{this.setState({showMoveModal:!1,moveModalProps:void 0})},this.onMoveSuccess=(pe,Ce)=>{const ke={...this._dashboard.state.meta,folderUid:pe,folderTitle:Ce};this._dashboard.setState({meta:ke}),this.onMoveModalDismiss()}}get _dashboard(){return(0,C.YQ)(this)}getUrlKey(){return"settings"}getDashboard(){return this._dashboard}getTimeRange(){return o.jh.getTimeRange(this._dashboard)}getRefreshPicker(){return this.getDashboardControls().state.refreshPicker}getCursorSync(){return Xn.b4.getCursorSync(this._dashboard)}getLiveNowTimer(){const pe=o.jh.findObject(this._dashboard,Ce=>Ce instanceof o.Gg.en);if(pe instanceof o.Gg.en)return pe;throw new Error("LiveNowTimer could not be found")}getDashboardControls(){return this._dashboard.state.controls}static{this.Component=({model:pe})=>{const Ce=pe.getDashboard(),{navModel:ke,pageNav:ut}=er(Ce,pe.getUrlKey()),{title:vt,description:At,tags:jt,meta:$t,editable:Yt}=Ce.useState(),{showMoveModal:qt,moveModalProps:hn}=pe.useState(),{sync:Cn}=pe.getCursorSync()?.useState()||{},{timeZone:Nn,weekStart:In,UNSAFE_nowDelay:un}=pe.getTimeRange().useState(),{intervals:Sn}=pe.getRefreshPicker().useState(),{hideTimeControls:fa}=pe.getDashboardControls().useState(),{enabled:zn}=pe.getLiveNowTimer().useState(),sa=[{label:(0,s.t)("dashboard-scene.general-settings-edit-view.editable_options.label.editable","Editable"),value:!0},{label:(0,s.t)("dashboard-scene.general-settings-edit-view.editable_options.label.readonly","Read-only"),value:!1}],Bn=[{value:0,label:(0,s.t)("dashboard-scene.general-settings-edit-view.graph_tooltip_options.label.default","Default")},{value:1,label:(0,s.t)("dashboard-scene.general-settings-edit-view.graph_tooltip_options.label.shared-crosshair","Shared crosshair")},{value:2,label:(0,s.t)("dashboard-scene.general-settings-edit-view.graph_tooltip_options.label.shared-tooltip","Shared tooltip")}];return(0,S.jsxs)(Ln.Y,{navModel:ke,pageNav:ut,layout:kt.k.Standard,children:[(0,S.jsx)(Vt.c,{dashboard:Ce}),(0,S.jsxs)("div",{style:{maxWidth:"600px"},children:[(0,S.jsxs)(ne.a,{display:"flex",direction:"column",gap:2,marginBottom:5,children:[(0,S.jsx)(I.D,{noMargin:!0,label:(0,S.jsxs)(X.B,{justifyContent:"space-between",children:[(0,S.jsx)(se.J,{htmlFor:"title-input",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-settings.general.title-label",children:"Title"})}),r.$.featureToggles.dashgpt&&(0,S.jsx)(Ro.Z,{onGenerate:qn=>pe.onTitleChange(qn)})]}),children:(0,S.jsx)(J.p,{id:"title-input",name:"title",value:vt,onChange:qn=>pe.onTitleChange(qn.target.value)})}),(0,S.jsx)(I.D,{noMargin:!0,label:(0,S.jsxs)(X.B,{justifyContent:"space-between",children:[(0,S.jsx)(se.J,{htmlFor:"description-input",children:(0,s.t)("dashboard-settings.general.description-label","Description")}),r.$.featureToggles.dashgpt&&(0,S.jsx)(fl.V,{onGenerate:qn=>pe.onDescriptionChange(qn)})]}),children:(0,S.jsx)(ee.f,{id:"description-input",name:"description",value:At,onChange:qn=>pe.onDescriptionChange(qn.target.value)})}),(0,S.jsx)(I.D,{noMargin:!0,label:(0,s.t)("dashboard-settings.general.tags-label","Tags"),children:(0,S.jsx)(qr.u,{id:"tags-input",tags:jt,onChange:pe.onTagsChange,width:40})}),(0,S.jsx)(I.D,{noMargin:!0,label:(0,s.t)("dashboard-settings.general.folder-label","Folder"),children:(0,S.jsx)(oe.d,{value:$t.folderUid,onChange:Ce.isManagedRepository()?pe.onProvisionedFolderChange:pe.onFolderChange})}),(0,S.jsx)(I.D,{noMargin:!0,label:(0,s.t)("dashboard-settings.general.editable-label","Editable"),description:(0,s.t)("dashboard-settings.general.editable-description","Set to read-only to disable all editing. Reload the dashboard for changes to take effect"),children:(0,S.jsx)(Pr.z,{value:Yt,options:sa,onChange:pe.onEditableChange})})]}),(0,S.jsx)(hl.p,{onTimeZoneChange:pe.onTimeZoneChange,onWeekStartChange:pe.onWeekStartChange,onRefreshIntervalChange:pe.onRefreshIntervalChange,onNowDelayChange:pe.onNowDelayChange,onHideTimePickerChange:pe.onHideTimePickerChange,onLiveNowChange:pe.onLiveNowChange,refreshIntervals:Sn,timePickerHidden:fa,nowDelay:un||"",liveNow:zn,timezone:Nn||"",weekStart:In}),(0,S.jsx)(eo.M,{label:(0,s.t)("dashboard-settings.general.panel-options-label","Panel options"),isOpen:!0,children:(0,S.jsxs)(X.B,{direction:"column",gap:2,children:[(0,S.jsx)(I.D,{noMargin:!0,label:(0,s.t)("dashboard-settings.general.panel-options-graph-tooltip-label","Graph tooltip"),description:(0,s.t)("dashboard-settings.general.panel-options-graph-tooltip-description","Controls tooltip and hover highlight behavior across different panels. Reload the dashboard for changes to take effect"),children:(0,S.jsx)(Pr.z,{onChange:pe.onTooltipChange,options:Bn,value:Cn})}),(0,S.jsx)(I.D,{noMargin:!0,label:(0,s.t)("dashboard-settings.general.panels-preload-label","Preload panels"),description:(0,s.t)("dashboard-settings.general.panels-preload-description","When enabled all panels will start loading as soon as the dashboard has been loaded."),children:(0,S.jsx)(q.d,{id:"preload-panels-dashboards-toggle",value:Ce.state.preload,onChange:qn=>pe.onPreloadChange(qn.currentTarget.checked)})})]})}),(0,S.jsx)(ne.a,{marginTop:3,children:$t.canDelete&&(0,S.jsx)(pl.c,{dashboard:Ce})})]}),qt&&hn&&(0,S.jsx)(ml,{dashboard:Ce,targetFolderUID:hn.targetFolderUID,targetFolderTitle:hn.targetFolderTitle,onDismiss:pe.onMoveModalDismiss,onSuccess:pe.onMoveSuccess})]})}}}var vl=e(13956),yl=e(31119);class Sc extends o.Bs{constructor(pe){super({...pe,jsonText:""}),this.onCodeEditorBlur=Ce=>{this.setState({jsonText:Ce})},this.onSaveSuccess=async Ce=>{const ke=JSON.parse(this.state.jsonText),ut=this.getDashboard(),vt=(0,ln.aK)(ke);let At;if(vt){const jt=await(0,vl.n)("v2").getDashboardDTO(Ce.uid);At=(0,yl.dj)(jt);const $t=o.Go.cloneSceneObjectState(At.state);ut.pauseTrackingChanges(),ut.setInitialSaveModel(jt.spec,jt.metadata),ut.setState($t)}else{ke.version=Ce.version,At=(0,xn.wM)({dashboard:ke,meta:ut.state.meta});const jt=o.Go.cloneSceneObjectState(At.state);ut.pauseTrackingChanges(),ut.setInitialSaveModel(ke,ut.state.meta),ut.setState(jt)}this.setState({jsonText:this.getJsonText()})},this.addActivationHandler(()=>this.setState({jsonText:this.getJsonText()}))}getUrlKey(){return"json-model"}getDashboard(){return(0,C.YQ)(this)}getSaveModel(){return this.getDashboard().getSaveModel()}getJsonText(){const pe=this.getSaveModel();return(0,ba.p)(pe)}static{this.Component=({model:pe})=>{const{state:Ce,onSaveDashboard:ke}=je(!1),[ut,vt]=(0,w.useState)(!1),At=pe.getDashboard(),{navModel:jt,pageNav:$t}=er(At,pe.getUrlKey()),Yt=At.useState().meta.canSave,{jsonText:qt}=pe.useState(),hn=async Sn=>{const fa=await ke(At,{folderUid:At.state.meta.folderUid,overwrite:Sn,rawDashboardJSON:JSON.parse(pe.state.jsonText),k8s:At.state.meta.k8s});vt(!0),fa.status==="success"?(await pe.onSaveSuccess(fa),vt(!1)):vt(!0)},Cn=Sn=>(0,S.jsx)(Z.$n,{type:"submit",onClick:()=>{hn(Sn)},variant:Sn?"destructive":"primary",children:Sn?(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.json-model-edit-view.save-and-overwrite",children:"'Save and overwrite'"}):(0,S.jsx)(s.x6,{i18nKey:"dashboard-settings.json-editor.save-button",children:"Save changes"})}),Nn=(0,S.jsx)(Z.$n,{variant:"secondary",onClick:()=>vt(!1),fill:"outline",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.json-model-edit-view.cancel-button.cancel",children:"Cancel"})}),In=(0,xt.of)(Oc);function un(Sn){if(Sn&&ut){if(ve(Sn))return(0,S.jsxs)(Y.F,{title:(0,s.t)("dashboard-scene.json-model-edit-view.render-save-button-and-error.title-someone-else-has-updated-this-dashboard","Someone else has updated this dashboard"),severity:"error",children:[(0,S.jsx)("p",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.json-model-edit-view.render-save-button-and-error.would-still-dashboard",children:"Would you still like to save this dashboard?"})}),(0,S.jsx)(ne.a,{paddingTop:2,children:(0,S.jsxs)(X.B,{alignItems:"center",children:[Nn,Cn(!0)]})})]});if(le(Sn))return(0,S.jsx)(Re,{saveButton:Cn,cancelButton:Nn});if(Ee(Sn))return(0,S.jsxs)(Y.F,{title:(0,s.t)("dashboard-scene.json-model-edit-view.render-save-button-and-error.title-plugin-dashboard","Plugin dashboard"),severity:"error",children:[(0,S.jsx)("p",{children:(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.json-model-edit-view.render-save-button-and-error.body-plugin-dashboard",children:["Your changes will be lost when you update the plugin. Use ",(0,S.jsx)("strong",{children:"Save as"})," to create custom version."]})}),(0,S.jsx)(ne.a,{paddingTop:2,children:(0,S.jsx)(X.B,{alignItems:"center",children:Cn(!0)})})]})}return(0,S.jsxs)(S.Fragment,{children:[Sn&&ut&&(0,S.jsx)(Y.F,{title:(0,s.t)("dashboard-scene.json-model-edit-view.render-save-button-and-error.title-failed-to-save-dashboard","Failed to save dashboard"),severity:"error",children:(0,S.jsx)("p",{children:Sn.message})}),(0,S.jsx)(X.B,{alignItems:"center",children:Cn(!1)})]})}return(0,S.jsxs)(Ln.Y,{navModel:jt,pageNav:$t,layout:kt.k.Standard,children:[(0,S.jsx)(Vt.c,{dashboard:At}),(0,S.jsxs)("div",{className:In.wrapper,children:[(0,S.jsx)(s.x6,{i18nKey:"dashboard-settings.json-editor.subtitle",children:"The JSON model below is the data structure that defines the dashboard. This includes dashboard settings, panel settings, layout, queries, and so on."}),(0,S.jsx)(Le.B,{width:"100%",value:qt,language:"json",showLineNumbers:!0,showMiniMap:!0,containerStyles:In.codeEditor,onBlur:pe.onCodeEditorBlur}),Yt&&(0,S.jsx)(ne.a,{paddingTop:2,children:un(Ce.error)})]})]})}}}const Oc=Ie=>({wrapper:(0,he.css)({display:"flex",height:"100%",flexDirection:"column",gap:Ie.spacing(2)}),codeEditor:(0,he.css)({flexGrow:1})});var Ic=e(54384);class to extends o.Bs{static{this.Component=oi}get _dashboard(){return(0,C.YQ)(this)}getUrlKey(){return"permissions"}getDashboard(){return this._dashboard}}function oi({model:Ie}){const pe=Ie.getDashboard(),{uid:Ce}=pe.useState(),{navModel:ke,pageNav:ut}=er(pe,Ie.getUrlKey()),vt=M.TP.hasPermission(lr.w.DashboardsPermissionsWrite);return(0,S.jsxs)(Ln.Y,{navModel:ke,pageNav:ut,layout:kt.k.Standard,children:[(0,S.jsx)(Vt.c,{dashboard:pe}),(0,S.jsx)(Ic.x,{resource:"dashboards",resourceId:Ce??"",canSetPermissions:vt})]})}var ii=e(62635),no=e(47969);const Vs=/\$(\w+)|\[\[(\w+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;function xl(Ie){return Ie.map(pe=>({id:pe.state.name,label:`${pe.state.name}`}))}function Mn(Ie,pe){return Ie.filter(Ce=>pe.some(ke=>ke.from===Ce.id||ke.to===Ce.id))}const na=Ie=>{const pe=[];for(const Ce of Ie)for(const ke of Ie){if(Ce===ke)continue;Ce.variableDependency?.hasDependencyOn(ke.state.name)&&pe.push({from:Ce.state.name,to:ke.state.name})}return pe};function li(Ie,pe){if(!pe)return[];let Ce=[];for(const ke of Ie){const ut=ke.state.name,vt=(0,no.Jx)(ut,{key:"model",value:pe},{});Object.keys(vt).length&&Ce.push({variable:ke,tree:vt})}return Ce}function ci(Ie){const pe=[];for(const Ce of Ie){const{variable:ke,tree:ut}=Ce,vt={variable:ke,nodes:[{id:"dashboard",label:(0,s.t)("dashboard-scene.transform-usages-to-network.result.label.dashboard","dashboard")}],edges:[],showGraph:!1};pe.push(El(vt,{id:"dashboard",value:ut}))}return pe}const El=(Ie,pe)=>{const{id:Ce,value:ke}=pe,{nodes:ut,edges:vt}=Ie;if(ke&&typeof ke=="string"){const At=`${pe.id}-${ke}`;return ut.push({id:At,label:ke}),vt.push({from:At,to:Ce}),Ie}if(bl(ke)){const At=Object.keys(ke);for(const jt of At){const $t=`${pe.id}-${jt}`;ut.push({id:$t,label:jt}),vt.push({from:$t,to:Ce}),Ie=El(Ie,{id:$t,value:ke[jt]})}return Ie}return Ie},Br=(Ie,pe)=>{const Ce=pe.find(ke=>ke.variable.state.name===Ie);return Ce&&bl(Ce.tree)?Pl(Ce.tree):0},Pl=Ie=>Object.values(Ie).reduce((Ce,ke)=>typeof ke=="object"?Ce+Pl(ke):Ce+1,0);async function di(Ie,pe){return new Promise((Ce,ke)=>{setTimeout(()=>{try{const ut=Rc(Ie,pe);Ce(ci(ut))}catch(ut){ke(ut)}},200)})}function Rc(Ie,pe){if(!pe)return[];let Ce=[];const ke=Ur(Ie,pe);for(const ut of ke){const vt=(0,no.Jx)(ut,{key:"model",value:pe},{});Object.keys(vt).length&&Ce.push({variable:ut,tree:vt})}return Ce}const Ur=(Ie,pe)=>{Vs.lastIndex=0;const Ce=[],ut=(0,ii.MA)(pe,2).match(Vs);if(!ut)return Ce;for(const vt of ut){if(!vt||vt.indexOf("$__")!==-1||vt.indexOf("${__")!==-1||vt.indexOf("$hashKey")!==-1)continue;const At=Vd(vt);Ie.some(jt=>jt.state.name===At)||Ce.find(jt=>jt===At)||At&&Ce.push(At)}return Ce};function Vd(Ie){const pe=Wa(Ie);if(!pe)return;const Ce=pe.slice(1).find(ke=>ke!==void 0);if(!(Ce in{}))return Ce}const Wa=Ie=>(Vs.lastIndex=0,Vs.exec(Ie));function bl(Ie){return typeof Ie=="object"&&Ie!==null&&!Array.isArray(Ie)}var Ac=e(75505),jc=e(59857),Wr=e(8515),$s=e(71599),Dl=e(6975),Ao=e(29),Cl=e(32442),ao=e(25379),ui=e(49602),Tl=e(18387),so=e(73829),Lc=e(68577),zs=e(44741);function Ml({onChange:Ie,type:pe}){const Ce=(0,w.useMemo)(()=>(0,zs.B$)(),[]),ke=(0,w.useMemo)(()=>Ce.find(ut=>ut.value===pe)??Ce[0],[Ce,pe]);return(0,S.jsx)(Lc.v,{name:(0,s.t)("dashboard-scene.variable-type-select.name-variable-type","Variable type"),value:ke,options:Ce,onChange:Ie,testId:Q.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalTypeSelectV2})}function Bc({variable:Ie,onTypeChange:pe,onGoBack:Ce,onDelete:ke}){const ut=(0,xt.of)(Sl),[vt,At]=(0,w.useState)(),{name:jt,type:$t,label:Yt,description:qt,hide:hn}=Ie.useState(),Cn=(0,zs.bZ)($t)?(0,zs.CD)($t):void 0,[Nn,In]=(0,Se.A)(async()=>{await(0,Ac.s)(Ie.validateAndUpdate())},[Ie]),un=Un=>{Un.value&&pe(Un.value)},Sn=(0,w.useCallback)(Un=>{const cs=(0,zs.c$)(Ie,Un.currentTarget.value);cs.errorMessage!==vt&&At(cs.errorMessage)},[Ie,vt]),fa=Un=>{vt||Ie.setState({name:Un.currentTarget.value})},zn=Un=>Ie.setState({label:Un.currentTarget.value}),sa=Un=>Ie.setState({description:Un.currentTarget.value}),Bn=Un=>Ie.setState({hide:Un}),qn=(0,zs.n_)(Ie),pa=Un=>()=>{(0,Te.rR)("Delete variable"),ke(jt),Un()};return(0,S.jsxs)("form",{"aria-label":(0,s.t)("dashboard-scene.variable-editor-form.aria-label-variable-editor-form","Variable editor form"),children:[(0,S.jsx)(Ml,{onChange:un,type:$t}),(0,S.jsx)(Cl.Y,{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.variable-editor-form.general",children:"General"})}),(0,S.jsx)(ui._,{name:(0,s.t)("dashboard-scene.variable-editor-form.name-name","Name"),description:(0,s.t)("dashboard-scene.variable-editor-form.description-template-variable-characters","The name of the template variable. (Max. 50 characters)"),placeholder:(0,s.t)("dashboard-scene.variable-editor-form.placeholder-variable-name","Variable name"),defaultValue:jt??"",onChange:Sn,onBlur:fa,testId:Q.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalNameInputV2,maxLength:so.M.MaxSize,required:!0,invalid:!!vt,error:vt}),(0,S.jsx)(ui._,{name:(0,s.t)("dashboard-scene.variable-editor-form.name-label","Label"),description:(0,s.t)("dashboard-scene.variable-editor-form.description-optional-display-name","Optional display name"),placeholder:(0,s.t)("dashboard-scene.variable-editor-form.placeholder-label-name","Label name"),defaultValue:Yt??"",onBlur:zn,testId:Q.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalLabelInputV2}),(0,S.jsx)(ao.Z,{name:(0,s.t)("dashboard-scene.variable-editor-form.name-description","Description"),defaultValue:qt??"",placeholder:(0,s.t)("dashboard-scene.variable-editor-form.placeholder-descriptive-text","Descriptive text"),onBlur:sa,width:52}),(0,S.jsx)(Ao.D,{onChange:Bn,hide:hn||jc.rw.hide,type:$t}),Cn&&(0,S.jsx)(Cn,{variable:Ie,onRunQuery:In}),qn&&(0,S.jsx)(Tl.j,{options:Ie.getOptionsForSelect(!1)}),(0,S.jsx)("div",{className:ut.buttonContainer,children:(0,S.jsxs)(X.B,{gap:2,children:[(0,S.jsx)(Wr.$s,{children:({showModal:Un,hideModal:cs})=>(0,S.jsx)(Z.$n,{variant:"destructive",fill:"outline",onClick:()=>{Un($s.u,{title:(0,s.t)("dashboard-scene.variable-editor-form.title.delete-variable","Delete variable"),body:`Are you sure you want to delete: ${jt}?`,confirmText:(0,s.t)("dashboard-scene.variable-editor-form.confirmText.delete-variable","Delete variable"),onConfirm:pa(cs),onDismiss:cs,isOpen:!0})},children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.variable-editor-form.delete",children:"Delete"})})}),(0,S.jsx)(Z.$n,{variant:"secondary","data-testid":Q.Tp.pages.Dashboard.Settings.Variables.Edit.General.applyButton,onClick:Ce,children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.variable-editor-form.back-to-list",children:"Back to list"})}),qn&&(0,S.jsx)(Z.$n,{disabled:Nn.loading,variant:"secondary","data-testid":Q.Tp.pages.Dashboard.Settings.Variables.Edit.General.submitButton,onClick:In,children:Nn.loading?(0,S.jsx)(Dl._,{className:ut.loadingPlaceHolder,text:(0,s.t)("dashboard-scene.variable-editor-form.text-running-query","Running query...")}):(0,s.t)("dashbaord-scene.variable-editor-form.run-query","Run query")})]})})]})}const Sl=Ie=>({buttonContainer:(0,he.css)({marginTop:Ie.spacing(2)}),loadingPlaceHolder:(0,he.css)({marginBottom:0})});var ro=e(89332),_a=e(84500),hi=e(27690);const _s=({variables:Ie})=>{const pe=(0,w.useMemo)(()=>xl(Ie),[Ie]),Ce=(0,w.useMemo)(()=>na(Ie),[Ie]);return Ce.length?(0,S.jsx)(hi.i,{show:!1,title:(0,s.t)("dashboards.settings.variables.dependencies.title","Dependencies"),nodes:Mn(pe,Ce),edges:Ce,children:({showModal:ke})=>(0,S.jsx)(Z.$n,{onClick:()=>{(0,Te.rR)("Show variable dependencies"),ke()},icon:"channel-add",variant:"secondary",children:(0,S.jsx)(s.x6,{i18nKey:"dashboards.settings.variables.dependencies.button",children:"Show dependencies"})})}):null};var oo=e(45967);const jo=({id:Ie,usages:pe,isAdhoc:Ce})=>{const ke=(0,w.useMemo)(()=>pe.find(vt=>(typeof vt.variable=="string"?vt.variable:vt.variable.state.name)===Ie),[pe,Ie]);if(pe.length===0||Ce||!ke)return null;const ut=ke.nodes.map(vt=>vt.label.includes(`$${Ie}`)?{...vt,color:"#FB7E81"}:vt);return(0,S.jsx)(hi.i,{show:!1,title:(0,s.t)("dashboard-scene.variable-usages-button.title-show-usages","Showing usages for: {{variableId}}",{variableId:`$${Ie}`}),nodes:ut,edges:ke.edges,children:({showModal:vt})=>(0,S.jsx)(ta.K,{onClick:()=>{(0,Te.rR)("Show variable usages"),vt()},name:"code-branch",tooltip:(0,s.t)("dashboard-scene.variable-usages-button.tooltip-show-usages","Show usages")})})};function Ol({index:Ie,variable:pe,usageTree:Ce,usagesNetwork:ke,onEdit:ut,onDuplicate:vt,onDelete:At}){const jt=(0,xt.$j)(),$t=(0,xt.of)(fi),Yt=(0,zs.Ao)(pe),qt=pe.state,hn=qt.name,Nn=Br(hn,Ce)>0||qt.type==="adhoc",[In,un]=(0,w.useState)(!1),Sn=zn=>()=>{un(zn)},fa=()=>{(0,Te.rR)("Delete variable"),At(hn)};return(0,S.jsx)(ro.sx,{draggableId:JSON.stringify(hn),index:Ie,children:(zn,sa)=>(0,S.jsxs)("tr",{ref:zn.innerRef,...zn.draggableProps,style:{userSelect:sa.isDragging?"none":"auto",background:sa.isDragging?jt.colors.background.secondary:void 0,...zn.draggableProps.style},children:[(0,S.jsx)("td",{role:"gridcell",className:$t.column,children:(0,S.jsx)(Z.$n,{size:"xs",fill:"text",onClick:Bn=>{Bn.preventDefault(),ut(hn)},className:$t.nameLink,"data-testid":Q.Tp.pages.Dashboard.Settings.Variables.List.tableRowNameFields(qt.name),children:qt.name})}),(0,S.jsx)("td",{role:"gridcell",className:$t.definitionColumn,onClick:Bn=>{Bn.preventDefault(),ut(hn)},"data-testid":Q.Tp.pages.Dashboard.Settings.Variables.List.tableRowDefinitionFields(qt.name),children:Yt}),(0,S.jsx)("td",{role:"gridcell",className:$t.column,children:(0,S.jsxs)("div",{className:$t.icons,children:[(0,S.jsx)(Uc,{passed:Nn}),(0,S.jsx)(jo,{id:qt.name,isAdhoc:qt.type==="adhoc",usages:ke}),(0,S.jsx)(ta.K,{onClick:Bn=>{Bn.preventDefault(),(0,Te.rR)("Duplicate variable"),vt(hn)},name:"copy",tooltip:(0,s.t)("dashboard-scene.variable-editor-list-row.tooltip-duplicate-variable","Duplicate variable"),"data-testid":Q.Tp.pages.Dashboard.Settings.Variables.List.tableRowDuplicateButtons(qt.name)}),(0,S.jsx)(ta.K,{onClick:Bn=>{Bn.preventDefault(),un(!0)},name:"trash-alt",tooltip:(0,s.t)("dashboard-scene.variable-editor-list-row.tooltip-remove-variable","Remove variable"),"data-testid":Q.Tp.pages.Dashboard.Settings.Variables.List.tableRowRemoveButtons(qt.name)}),(0,S.jsx)($s.u,{isOpen:In,title:(0,s.t)("dashboard-scene.variable-editor-list-row.title-delete-variable","Delete variable"),body:(0,s.t)("dashboard-scene.variable-editor-list-row.body-delete-variable","Are you sure you want to delete: {{variable}}?",{variable:qt.name}),confirmText:(0,s.t)("dashboard-scene.variable-editor-list-row.confirmText-delete-variable","Delete variable"),onConfirm:fa,onDismiss:Sn(!1)}),(0,S.jsx)("div",{...zn.dragHandleProps,className:$t.dragHandle,children:(0,S.jsx)(Kn.I,{name:"draggabledots",size:"lg"})})]})})]})})}function Uc({passed:Ie}){const pe=(0,xt.of)(fi);return Ie?(0,S.jsx)(oo.m,{content:(0,s.t)("dashboard-scene.variable-check-indicator.content-variable-referenced-other-variables-dashboard","This variable is referenced by other variables or dashboard."),children:(0,S.jsx)(Kn.I,{name:"check",className:pe.iconPassed,"aria-label":(0,s.t)("dashboard-scene.variable-check-indicator.aria-label-variable-referenced-other-variables-dashboard","This variable is referenced by other variables or dashboard.")})}):(0,S.jsx)(oo.m,{content:(0,s.t)("dashboard-scene.variable-check-indicator.content-variable-not-referenced-other-variables-dashboard","This variable is not referenced by other variables or dashboard."),children:(0,S.jsx)(Kn.I,{name:"exclamation-triangle",className:pe.iconFailed,"aria-label":(0,s.t)("dashboard-scene.variable-check-indicator.aria-label-variable-referenced-dashboard","This variable is not referenced by any variable or dashboard.")})})}function fi(Ie){return{dragHandle:(0,he.css)({cursor:"grab",marginLeft:Ie.spacing(1)}),column:(0,he.css)({width:"1%"}),nameLink:(0,he.css)({cursor:"pointer",color:Ie.colors.primary.text}),definitionColumn:(0,he.css)({width:"100%",maxWidth:"200px",cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),iconPassed:(0,he.css)({color:Ie.v1.palette.greenBase,marginRight:Ie.spacing(2)}),iconFailed:(0,he.css)({color:Ie.v1.palette.orange,marginRight:Ie.spacing(2)}),icons:(0,he.css)({display:"flex",gap:Ie.spacing(2),alignItems:"center"})}}function Wc({variables:Ie,usages:pe,usagesNetwork:Ce,onChangeOrder:ke,onDelete:ut,onDuplicate:vt,onAdd:At,onEdit:jt}){const $t=(0,xt.of)(Il),Yt=hn=>{!hn.destination||!hn.source||((0,Te.rR)("Variable drag and drop"),ke(hn.source.index,hn.destination.index))};return Ie.filter(_a.Ru).length<=0?(0,S.jsx)(Lo,{onAdd:At}):(0,S.jsxs)(X.B,{direction:"column",gap:3,children:[(0,S.jsxs)("table",{className:Ua()("filter-table","filter-table--hover",$t.tableContainer),"data-testid":Q.Tp.pages.Dashboard.Settings.Variables.List.table,role:"grid",children:[(0,S.jsx)("thead",{children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.variable-editor-list.variable",children:"Variable"})}),(0,S.jsx)("th",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.variable-editor-list.definition",children:"Definition"})}),(0,S.jsx)("th",{colSpan:5})]})}),(0,S.jsx)(ro.JY,{onDragEnd:Yt,children:(0,S.jsx)(ro.gL,{droppableId:"variables-list",direction:"vertical",children:hn=>(0,S.jsxs)("tbody",{ref:hn.innerRef,...hn.droppableProps,children:[Ie.map((Cn,Nn)=>{if(!(0,_a.Ru)(Cn))return null;const In=Cn.state;return(0,S.jsx)(Ol,{index:Nn,variable:Cn,onDelete:ut,onDuplicate:vt,onEdit:jt,usageTree:pe,usagesNetwork:Ce},`${In.name}-${Nn}`)}),hn.placeholder]})})})]}),(0,S.jsxs)(X.B,{children:[(0,S.jsx)(_s,{variables:Ie}),(0,S.jsx)(Z.$n,{"data-testid":Q.Tp.pages.Dashboard.Settings.Variables.List.newButton,onClick:At,icon:"plus",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.variable-editor-list.new-variable",children:"New variable"})})]})]})}function Lo({onAdd:Ie}){return(0,S.jsx)(X.B,{direction:"column",children:(0,S.jsxs)(il.p,{variant:"call-to-action",button:(0,S.jsx)(Z.$n,{"data-testid":Q.Tp.components.CallToActionCard.buttonV2("Add variable"),icon:"calculator-alt",onClick:Ie,size:"lg",children:(0,S.jsx)(s.x6,{i18nKey:"variables.empty-state.button-title",children:"Add variable"})}),message:(0,s.t)("variables.empty-state.title","There are no variables added yet"),children:[(0,S.jsx)("p",{children:(0,S.jsx)(s.x6,{i18nKey:"variables.empty-state.info-box-content",children:"Variables enable more interactive and dynamic dashboards. Instead of hard-coding things like server or sensor names in your metric queries you can use variables in their place. Variables are shown as list boxes at the top of the dashboard. These drop-down lists make it easy to change the data being displayed in your dashboard."})}),(0,S.jsxs)(s.x6,{i18nKey:"variables.empty-state.info-box-content-2",children:["Check out the"," ",(0,S.jsx)(De.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/variables/",children:"Templates and variables documentation"})," ","for more information."]})]})})}const Il=()=>({tableContainer:(0,he.css)({overflow:"auto"})}),Bo=1e3;function Nr({variables:Ie,dashboard:pe}){const[Ce,ke]=(0,w.useState)(!1),[ut,vt]=(0,w.useState)(0),At=(0,xt.of)(pi);(0,w.useEffect)(()=>vt(hn=>hn+1),[Ie,pe]);const[{loading:jt,value:$t},Yt]=(0,Se.A)(async()=>{const hn=Date.now(),Cn=await di(Ie,pe),In=Date.now()-hn;return In>=Bo&&(0,Te.rR)("Slow unknown variables expansion",{elapsed:In}),vt(0),Cn},[Ie,pe]),qt=hn=>{hn&&((0,Te.rR)("Unknown variables section expanded"),ut>0&&Yt()),ke(hn)};return(0,S.jsx)("div",{className:At.container,children:(0,S.jsx)(eo.M,{label:(0,S.jsx)(Nc,{}),isOpen:Ce,onToggle:qt,children:jt||!$t?(0,S.jsx)(X.B,{justifyContent:"center",direction:"column",children:(0,S.jsxs)(X.B,{justifyContent:"center",children:[(0,S.jsx)("span",{children:(0,S.jsx)(s.x6,{i18nKey:"variables.unknown-table.loading",children:"Loading..."})}),(0,S.jsx)(xr.y,{})]})}):$t.length>0?(0,S.jsx)(Rl,{usages:$t}):(0,S.jsx)(Uo,{})})})}function Nc(){const Ie=(0,xt.of)(pi);return(0,S.jsxs)("h5",{children:[(0,S.jsx)(s.x6,{i18nKey:"variables.unknown-table.renamed-or-missing-variables",children:"Renamed or missing variables"}),(0,S.jsx)(oo.m,{content:(0,s.t)("variables.unknown-table.tooltip-renamed-or-missing-variables","Click to expand a list with all variable references that have been renamed or are missing from the dashboard."),children:(0,S.jsx)(Kn.I,{name:"info-circle",className:Ie.infoIcon})})]})}function Uo(){return(0,S.jsx)("span",{children:(0,S.jsx)(s.x6,{i18nKey:"variables.unknown-table.no-unknowns",children:"No renamed or missing variables found."})})}function Rl({usages:Ie}){const pe=(0,xt.of)(pi);return(0,S.jsxs)("table",{className:"filter-table filter-table--hover",children:[(0,S.jsx)("thead",{children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{children:(0,S.jsx)(s.x6,{i18nKey:"variables.unknown-table.variable",children:"Variable"})}),(0,S.jsx)("th",{colSpan:5})]})}),(0,S.jsx)("tbody",{children:Ie.map(Ce=>{const ke=typeof Ce.variable=="string"?Ce.variable:Ce.variable.state.name;return(0,S.jsxs)("tr",{children:[(0,S.jsx)("td",{className:pe.firstColumn,children:(0,S.jsx)("span",{children:ke})}),(0,S.jsx)("td",{className:pe.defaultColumn}),(0,S.jsx)("td",{className:pe.defaultColumn}),(0,S.jsx)("td",{className:pe.defaultColumn}),(0,S.jsx)("td",{className:pe.lastColumn,children:(0,S.jsx)(jo,{id:ke,usages:Ie,isAdhoc:!1})})]},ke)})})]})}const pi=Ie=>({container:(0,he.css)({marginTop:Ie.spacing(4),paddingTop:Ie.spacing(4)}),infoIcon:(0,he.css)({marginLeft:Ie.spacing(1)}),defaultColumn:(0,he.css)({width:"1%"}),firstColumn:(0,he.css)({width:"1%",verticalAlign:"top",color:Ie.colors.text.maxContrast}),lastColumn:(0,he.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"100%",textAlign:"right"})});class Al extends o.Bs{constructor(){super(...arguments),this._urlSync=new jr(this),this.getVariableIndex=pe=>this.getVariables().findIndex(ke=>ke.state.name===pe),this.replaceEditVariable=pe=>{const Ce=this.state.editIndex??-1,{variables:ke}=this.getVariableSet().state;if(!ke[Ce]){console.error("Variable not found");return}const vt=[...ke.slice(0,Ce),pe,...ke.slice(Ce+1)];this.getVariableSet().setState({variables:vt})},this.onDelete=pe=>{const Ce=this.getVariableIndex(pe),{variables:ke}=this.getVariableSet().state;if(Ce===-1){console.error("Variable not found");return}const ut=[...ke.slice(0,Ce),...ke.slice(Ce+1)];this.getVariableSet().setState({variables:ut}),this.setState({editIndex:void 0})},this.onDuplicated=pe=>{const Ce=this.getVariableIndex(pe),ke=this.getVariableSet().state.variables;if(Ce===-1){console.error("Variable not found");return}const ut=ke[Ce];let vt=0,At=`copy_of_${ut.state.name}`;for(;ke.some(Yt=>Yt.state.name===At);)vt++,At=`copy_of_${ut.state.name}_${vt}`;const jt=ut.clone(ut.state);jt.setState({name:At});const $t=[...ke.slice(0,Ce+1),jt,...ke.slice(Ce+1)];this.getVariableSet().setState({variables:$t})},this.onOrderChanged=(pe,Ce)=>{const ke=this.getVariableSet().state.variables;if(!this.getVariableSet())return;if(pe<0||pe>=ke.length||Ce<0||Ce>=ke.length){console.error("Invalid index");return}const ut=[...ke],vt=ut.splice(pe,1);ut.splice(Ce,0,vt[0]),this.getVariableSet().setState({variables:ut})},this.onEdit=pe=>{const Ce=this.getVariableIndex(pe);if(Ce===-1){console.error("Variable not found");return}this.setState({editIndex:Ce})},this.onAdd=()=>{const pe=this.getVariables(),Ce=pe.length,ke=(0,zs.kh)(pe);this.getVariableSet().setState({variables:[...this.getVariables(),ke]}),this.setState({editIndex:Ce})},this.onTypeChange=pe=>{const Ce=this.state.editIndex??-1,{variables:ke}=this.getVariableSet().state,ut=ke[Ce];if(!ut){console.error("Variable not found");return}const{name:vt,label:At}=ut.state,jt=(0,zs.No)(pe,{name:vt,label:At});this.replaceEditVariable(jt)},this.onGoBack=()=>{this.setState({editIndex:void 0})},this.onValidateVariableName=(pe,Ce)=>{let ke=null;zs.cH.test(pe)||(ke="Template names cannot begin with '__', that's reserved for Grafana's global variables"),zs.mJ.test(pe)||(ke="Only word characters are allowed in variable names");const ut=this.getVariableSet().getByName(pe)?.state;return ut&&ut.key!==Ce&&(ke="Variable with the same name already exists"),ke?[!0,ke]:[!1,null]},this.getSaveModel=()=>(0,gt.Uy)(this.getDashboard()),this.getUsages=()=>{const pe=this.getSaveModel();return li(this.getVariables(),pe)},this.getUsagesNetwork=()=>{const pe=this.getUsages();return ci(pe)}}static{this.Component=Kc}getUrlKey(){return"variables"}getDashboard(){return(0,C.YQ)(this)}getVariableSet(){return o.jh.getVariables(this.getDashboard())}getVariables(){return this.getVariableSet().state.variables}}function Kc({model:Ie}){const pe=Ie.getDashboard(),{navModel:Ce,pageNav:ke}=er(pe,Ie.getUrlKey()),{onDelete:ut,onDuplicated:vt,onOrderChanged:At,onEdit:jt,onTypeChange:$t,onGoBack:Yt,onAdd:qt}=Ie,{variables:hn}=Ie.getVariableSet().useState(),{editIndex:Cn}=Ie.useState(),Nn=(0,w.useMemo)(()=>Ie.getUsagesNetwork(),[Ie]),In=(0,w.useMemo)(()=>Ie.getUsages(),[Ie]),un=Ie.getSaveModel();if(Cn!==void 0&&hn[Cn]){const Sn=hn[Cn];if(Sn)return(0,S.jsx)(wc,{variable:Sn,onTypeChange:$t,onGoBack:Yt,pageNav:ke,navModel:Ce,dashboard:pe,onDelete:ut})}return(0,S.jsxs)(Ln.Y,{navModel:Ce,pageNav:ke,layout:kt.k.Standard,children:[(0,S.jsx)(Vt.c,{dashboard:pe}),(0,S.jsx)(Wc,{variables:hn,usages:In,usagesNetwork:Nn,onDelete:ut,onDuplicate:vt,onChangeOrder:At,onAdd:qt,onEdit:jt}),(0,S.jsx)(Nr,{variables:hn,dashboard:un})]})}function wc({variable:Ie,pageNav:pe,navModel:Ce,dashboard:ke,onTypeChange:ut,onGoBack:vt,onDelete:At}){const{name:jt}=Ie.useState(),$t={text:jt,parentItem:pe};return(0,S.jsxs)(Ln.Y,{navModel:Ce,pageNav:$t,layout:kt.k.Standard,children:[(0,S.jsx)(Vt.c,{dashboard:ke}),(0,S.jsx)(Bc,{variable:Ie,onTypeChange:ut,onGoBack:vt,onDelete:At},Ie.state.key)]})}var Ra=e(10685),Fc=e(34753),hr=e(1199),Pa=e(23289);const ja=({hideModal:Ie,onRestore:pe,version:Ce})=>{const ke=(0,_e._2)(),ut=async()=>{await pe(Ce)?(ke.success("Dashboard restored",`Restored from version ${Ce.version}`),Pa.c.versionRestoreClicked({version:Ce.version,confirm:!0})):ke.error("Dashboard restore failed",`Failed to restore from version ${Ce.version}`),Ie()};return(0,S.jsx)($s.u,{isOpen:!0,title:(0,s.t)("dashboard-scene.revert-dashboard-modal.title-restore-version","Restore version"),icon:"history",onDismiss:Ie,onConfirm:ut,body:(0,S.jsx)("p",{children:(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.revert-dashboard-modal.body-restore-version",values:{version:Ce.version},children:["Are you sure you want to restore the dashboard to version ","{{version}}","? All unsaved changes will be lost."]})}),confirmText:(0,s.t)("dashboard-scene.revert-dashboard-modal.confirmText-restore-version","Yes, restore to version {{version}}",{version:Ce.version})})};var jl=e(61371);const gi=({baseInfo:Ie,newInfo:pe,diffData:Ce,isNewLatest:ke,onRestore:ut})=>{const vt=(0,jl.G4)(Ce.lhs,Ce.rhs),At=(0,xt.of)(Vc);return(0,S.jsxs)(X.B,{direction:"column",gap:1,children:[(0,S.jsxs)(X.B,{justifyContent:"space-between",alignItems:"center",children:[(0,S.jsxs)(X.B,{alignItems:"center",children:[(0,S.jsxs)("span",{className:(0,he.cx)(At.versionInfo,At.noMarginBottom),children:[(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.version-history-comparison.old-version-updated",values:{version:Ie.version,editor:Ie.createdBy,timeAgo:Ie.ageString},children:[(0,S.jsxs)("strong",{children:["Version ","{{version}}"]})," updated by ","{{editor}}"," ","{{timeAgo}}"]}),Ie.message]}),(0,S.jsx)(Kn.I,{name:"arrow-right",size:"sm"}),(0,S.jsxs)("span",{className:At.versionInfo,children:[(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.version-history-comparison.new-version-updated",values:{version:pe.version,editor:pe.createdBy,timeAgo:pe.ageString},children:[(0,S.jsxs)("strong",{children:["Version ","{{version}}"]})," updated by ","{{editor}}"," ","{{timeAgo}}"]}),pe.message]})]}),ke&&(0,S.jsx)(Wr.$s,{children:({showModal:jt,hideModal:$t})=>(0,S.jsx)(Z.$n,{variant:"destructive",icon:"history",onClick:()=>{jt(ja,{version:Ie,onRestore:ut,hideModal:$t})},children:(0,S.jsxs)(s.x6,{i18nKey:"dashboard-scene.version-history.comparison.button-restore",values:{version:Ie.version},children:["Restore to version ","{{version}}"]})})})]}),Object.entries(vt).map(([jt,$t])=>(0,S.jsx)(Fc.D,{diffs:$t,title:jt},jt)),(0,S.jsx)(ne.a,{paddingTop:2,children:(0,S.jsx)(eo.M,{isOpen:!1,label:(0,s.t)("dashboard-scene.version-history-comparison.label-view-json-diff","View JSON diff"),children:(0,S.jsx)(hr.M,{oldValue:JSON.stringify(Ce.lhs,null,2),newValue:JSON.stringify(Ce.rhs,null,2)})})})]})},Vc=Ie=>({versionInfo:(0,he.css)({color:Ie.colors.text.secondary,fontSize:Ie.typography.bodySmall.fontSize}),noMarginBottom:(0,he.css)({marginBottom:0})});var La=e(7923),br=e(94018);const Ll=({versions:Ie,canCompare:pe,onCheck:Ce,onRestore:ke})=>{const ut=(0,xt.of)(Bl);return(0,S.jsx)("div",{className:ut.margin,children:(0,S.jsxs)("table",{className:(0,he.cx)("filter-table",ut.table),children:[(0,S.jsx)("thead",{children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{className:"width-4"}),(0,S.jsx)("th",{className:"width-4",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.version-history-table.version",children:"Version"})}),(0,S.jsx)("th",{className:"width-14",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.version-history-table.date",children:"Date"})}),(0,S.jsx)("th",{className:"width-10",children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.version-history-table.updated-by",children:"Updated by"})}),(0,S.jsx)("th",{children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.version-history-table.notes",children:"Notes"})}),(0,S.jsx)("th",{})]})}),(0,S.jsx)("tbody",{children:Ie.map((vt,At)=>(0,S.jsxs)("tr",{children:[(0,S.jsx)("td",{children:(0,S.jsx)(we.S,{"aria-label":(0,s.t)("dashboard-scene.version-history-table.aria-label-toggle-selection","Toggle selection of version {{version}}",{version:vt.version}),className:(0,he.css)({display:"inline"}),checked:vt.checked,onChange:jt=>Ce(jt,vt.id),disabled:!vt.checked&&pe})}),(0,S.jsx)("td",{children:vt.version}),(0,S.jsx)("td",{children:vt.createdDateString}),(0,S.jsx)("td",{children:vt.createdBy}),(0,S.jsx)("td",{children:vt.message}),(0,S.jsx)("td",{className:"text-right",children:At===0?(0,S.jsx)(br.v,{name:(0,s.t)("dashboard-scene.version-history-table.name-latest","Latest"),colorIndex:17}):(0,S.jsx)(Wr.$s,{children:({showModal:jt,hideModal:$t})=>(0,S.jsx)(Z.$n,{variant:"secondary",size:"sm",icon:"history",onClick:()=>{jt(ja,{version:vt,hideModal:$t,onRestore:ke}),Pa.c.versionRestoreClicked({version:vt.version,index:At,confirm:!1,version_date:vt.created})},children:(0,S.jsx)(s.x6,{i18nKey:"dashboard-scene.version-history-table.restore",children:"Restore"})})})})]},vt.id))})]})})};function Bl(Ie){return{margin:(0,he.css)({marginBottom:Ie.spacing(4)}),table:(0,he.css)({td:{whiteSpace:"normal !important"}})}}const Os=10;class $c extends o.Bs{constructor(pe){super({...pe,versions:[],isLoading:!0,isAppending:!0,viewMode:"list",isNewLatest:!1,diffData:{lhs:"",rhs:""}}),this._limit=Os,this._start=0,this._continueToken="",this.fetchVersions=(Ce=!1)=>{const ke=this._dashboard.state.uid;if(!ke)return;this.setState({isAppending:Ce});const ut=this._continueToken?{limit:this._limit,start:this._start,continueToken:this._continueToken}:{limit:this._limit,start:this._start};mn.w.getHistoryList(ke,ut).then(vt=>{this.setState({isLoading:!1,versions:[...this.state.versions??[],...this.decorateVersions(vt.versions)]}),this._start+=this._limit,this._continueToken=vt.continueToken??""}).catch(vt=>console.log(vt)).finally(()=>this.setState({isAppending:!1}))},this.getDiff=async()=>{const Ce=this.versions.filter($t=>$t.checked),[ke,ut]=Ce,vt=ke.version===this._dashboard.state.version;if(this.setState({isLoading:!0}),!this._dashboard.state.uid)return;let At,jt;r.$.featureToggles.kubernetesClientDashboardsFolders?(At=await mn.w.getDashboardVersion(this._dashboard.state.uid,ut.id),jt=await mn.w.getDashboardVersion(this._dashboard.state.uid,ke.id)):(At=await mn.w.getDashboardVersion(this._dashboard.state.uid,ut.version),jt=await mn.w.getDashboardVersion(this._dashboard.state.uid,ke.version)),this.setState({baseInfo:ut,isLoading:!1,isNewLatest:vt,newInfo:ke,viewMode:"compare",diffData:{lhs:At.data,rhs:jt.data}})},this.reset=()=>{this._continueToken="",this.setState({baseInfo:void 0,diffData:{lhs:"",rhs:""},isNewLatest:!1,newInfo:void 0,versions:this.versions.map(Ce=>({...Ce,checked:!1})),viewMode:"list"})},this.onCheck=(Ce,ke)=>{this.setState({versions:this.versions.map(ut=>ut.id===ke?{...ut,checked:Ce.currentTarget.checked}:ut)})},this.addActivationHandler(()=>{this.fetchVersions()})}static{this.Component=zc}get _dashboard(){return(0,C.YQ)(this)}get diffData(){return this.state.diffData??{lhs:"",rhs:""}}get versions(){return this.state.versions??[]}get limit(){return this._limit}get start(){return this._start}get continueToken(){return this._continueToken}getUrlKey(){return"versions"}getDashboard(){return this._dashboard}getTimeRange(){return o.jh.getTimeRange(this._dashboard)}decorateVersions(pe){const Ce=this.getTimeRange().getTimeZone();return pe.map(ke=>({...ke,createdDateString:(0,ea.LE)(ke.created,{timeZone:Ce}),ageString:(0,ea.fq)(ke.created,{timeZone:Ce}),checked:!1}))}}function zc({model:Ie}){const pe=Ie.getDashboard(),{isLoading:Ce,isAppending:ke,viewMode:ut,baseInfo:vt,newInfo:At,isNewLatest:jt}=Ie.useState(),{navModel:$t,pageNav:Yt}=er(pe,Ie.getUrlKey()),qt=Ie.versions.filter(Sn=>Sn.checked).length===2,hn=Ie.versions.length>1,Cn=Ie.versions.length>=Ie.limit;let Nn=Ie.versions.find(Sn=>Sn.version===1)||Ie.versions.length%Ie.limit!==0;r.$.featureToggles.kubernetesClientDashboardsFolders&&(Nn=Nn||Ie.continueToken==="");const In=(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(La.m,{onClick:Ie.reset,baseVersion:vt?.version,newVersion:At?.version,isNewLatest:jt}),Ce?(0,S.jsx)(Gn,{msg:"Fetching changes\u2026"}):(0,S.jsx)(gi,{newInfo:At,baseInfo:vt,isNewLatest:jt,diffData:Ie.diffData,onRestore:pe.onRestore})]}),un=(0,S.jsxs)(S.Fragment,{children:[Ce?(0,S.jsx)(Gn,{msg:"Fetching history list\u2026"}):(0,S.jsx)(Ll,{versions:Ie.versions,onCheck:Ie.onCheck,canCompare:qt,onRestore:pe.onRestore}),ke&&(0,S.jsx)(Gn,{msg:"Fetching more entries\u2026"}),hn&&(0,S.jsx)(Ra.r,{hasMore:Cn,canCompare:qt,getVersions:Ie.fetchVersions,getDiff:Ie.getDiff,isLastPage:!!Nn})]});return(0,S.jsxs)(Ln.Y,{navModel:$t,pageNav:Yt,layout:kt.k.Standard,children:[(0,S.jsx)(Vt.c,{dashboard:pe}),ut==="compare"?In:un]})}const Gn=({msg:Ie})=>(0,S.jsxs)(X.B,{children:[(0,S.jsx)(xr.y,{}),(0,S.jsx)("em",{children:Ie})]});function er(Ie,pe){const Ce=(0,Me.zy)(),ke=(0,Je.d4)(jt=>jt.navIndex),ut=(0,f.tc)(ke,"dashboards/browse"),vt=Ie.getPageNav(Ce,ke),At={text:(0,s.t)("dashboard-scene.use-dashboard-edit-page-nav.page-nav.text.settings","Settings"),url:n.I.getUrlForPartial(Ce,{editview:"settings",editIndex:null}),children:[],parentItem:vt};return Ie.state.meta.canEdit&&(At.children.push({text:(0,s.t)("dashboard-settings.general.title","General"),url:n.I.getUrlForPartial(Ce,{editview:"settings",editIndex:null}),active:pe==="settings"}),At.children.push({text:(0,s.t)("dashboard-settings.annotations.title","Annotations"),url:n.I.getUrlForPartial(Ce,{editview:"annotations",editIndex:null}),active:pe==="annotations"}),At.children.push({text:(0,s.t)("dashboard-settings.variables.title","Variables"),url:n.I.getUrlForPartial(Ce,{editview:"variables",editIndex:null}),active:pe==="variables"}),At.children.push({text:(0,s.t)("dashboard-settings.links.title","Links"),url:n.I.getUrlForPartial(Ce,{editview:"links",editIndex:null}),active:pe==="links"})),Ie.state.uid&&Ie.state.meta.canSave&&At.children.push({text:(0,s.t)("dashboard-settings.versions.title","Versions"),url:n.I.getUrlForPartial(Ce,{editview:"versions",editIndex:null}),active:pe==="versions"}),Ie.state.uid&&Ie.state.meta.canAdmin&&M.TP.hasPermission(lr.w.DashboardsPermissionsRead)&&At.children.push({text:(0,s.t)("dashboard-settings.permissions.title","Permissions"),url:n.I.getUrlForPartial(Ce,{editview:"permissions",editIndex:null}),active:pe==="permissions"}),At.children.push({text:(0,s.t)("dashboard-settings.json-editor.title","JSON Model"),url:n.I.getUrlForPartial(Ce,{editview:"json-model",editIndex:null}),active:pe==="json-model"}),{navModel:ut,pageNav:At}}function _c(Ie){switch(Ie){case"annotations":return new ll({});case"variables":return new Al({});case"links":return new Cc({});case"versions":return new $c({});case"json-model":return new Sc({});case"permissions":return new to({});case"settings":default:return new Mc({})}}var Gs=e(90091),yn=e(99949);class io extends o.Bs{constructor(pe){super(pe),this.addActivationHandler(this._activationHandler.bind(this))}_activationHandler(){const pe=this.state.panelRef.resolve();return(0,C.sf)(pe)}getUrlKey(){return this.state.panelRef.resolve().state.key}static{this.Component=({model:pe})=>{const{panelRef:Ce}=pe.useState(),ke=Ce.resolve();return(0,S.jsx)(ke.Component,{model:ke})}}}class lo{constructor(pe){this._scene=pe}getKeys(){return["inspect","viewPanel","editPanel","editview","autofitpanels","kiosk","shareView"]}getUrlState(){const pe=this._scene.state;return{inspect:pe.inspectPanelKey,autofitpanels:this.getAutoFitPanels(),viewPanel:pe.viewPanelScene?.getUrlKey(),editview:pe.editview?.getUrlKey(),editPanel:pe.editPanel?.getUrlKey()||void 0,kiosk:pe.kioskMode===ki.d9.Full?"":void 0,shareView:pe.shareView,orgId:M.TP.user.orgId.toString()}}getAutoFitPanels(){if(this._scene.state.body instanceof ts.D)return this._scene.state.body.state.grid.state.UNSAFE_fitPanels?"true":void 0}updateFromUrl(pe){const{inspectPanelKey:Ce,viewPanelScene:ke,isEditing:ut,editPanel:vt,shareView:At}=this._scene.state,jt={};if(typeof pe.editview=="string"&&this._scene.canEditDashboard()?(jt.editview=_c(pe.editview),ut||(this._scene.state.editable?setTimeout(()=>this._scene.onEnterEditMode()):jt.editview=void 0)):pe.hasOwnProperty("editview")&&(jt.editview=void 0),typeof pe.inspect=="string"){let Yt=(0,C.vL)(this._scene,pe.inspect);if(!Yt){if((0,D.ag)(pe.inspect)){this._handleInspectRepeatClone(pe.inspect);return}l.A.emit($e.r1.alertError,["Panel not found"]),i.Ny.partial({inspect:null});return}jt.inspectPanelKey=pe.inspect,jt.overlay=new ei({panelRef:Yt.getRef()})}else Ce&&(jt.inspectPanelKey=void 0,jt.overlay=void 0);if(typeof pe.viewPanel=="string"){const Yt=(0,C.vL)(this._scene,pe.viewPanel);if(!Yt){if((0,D.ag)(pe.viewPanel)){this._handleViewRepeatClone(pe.viewPanel);return}l.A.emit($e.r1.alertError,["Panel not found"]),i.Ny.partial({viewPanel:null});return}jt.viewPanelScene=new io({panelRef:Yt.getRef()})}else ke&&pe.viewPanel===null&&(jt.viewPanelScene=void 0);if(typeof pe.editPanel=="string"){const Yt=(0,C.Uv)(this._scene,pe.editPanel);if(!Yt){console.warn(`Panel ${pe.editPanel} not found`);return}this._scene.state.viewPanelScene&&this._scene.setState({viewPanelScene:void 0}),ut||this._scene.onEnterEditMode();const qt=(0,C.iL)(Yt);if(qt&&!qt?.state.isLoaded){this._waitForLibPanelToLoadBeforeEnteringPanelEdit(Yt,qt);return}jt.editPanel=(0,ti.L)(Yt)}else vt&&pe.editPanel===null&&(jt.editPanel=void 0);typeof pe.shareView=="string"?(jt.shareView=pe.shareView,jt.overlay=r.$.featureToggles.newDashboardSharingComponent?new Gs.j({shareView:pe.shareView}):new yn.Z({activeTab:pe.shareView})):At&&pe.shareView===null&&(jt.overlay=void 0,jt.shareView=void 0);const $t=this._scene.state.body;if($t instanceof ts.D){const Yt=typeof pe.autofitpanels=="string";!!$t.state.grid.state.UNSAFE_fitPanels!==Yt&&$t.state.grid.setState({UNSAFE_fitPanels:Yt})}typeof pe.kiosk=="string"&&(pe.kiosk==="true"||pe.kiosk==="")&&(jt.kioskMode=ki.d9.Full),Object.keys(jt).length>0&&this._scene.setState(jt)}_handleInspectRepeatClone(pe){this._inspectEventSub||(this._inspectEventSub=this._scene.subscribeToEvent(Xs.d,()=>{const Ce=(0,C.vL)(this._scene,pe);Ce&&(this._inspectEventSub?.unsubscribe(),this._scene.setState({inspectPanelKey:pe,overlay:new ei({panelRef:Ce.getRef()})}))}))}_handleViewRepeatClone(pe){this._viewEventSub||(this._viewEventSub=this._scene.subscribeToEvent(Xs.d,()=>{const Ce=(0,C.vL)(this._scene,pe);Ce&&(this._viewEventSub?.unsubscribe(),this._scene.setState({viewPanelScene:new io({panelRef:Ce.getRef()})}))}))}_waitForLibPanelToLoadBeforeEnteringPanelEdit(pe,Ce){const ke=Ce.subscribeToState(ut=>{ut.isLoaded&&(this._scene.setState({editPanel:(0,ti.L)(pe)}),ke.unsubscribe())})}}var Kr=e(57852),fr=e(12469);class Ul{constructor(){this._binds=[]}addBinding(pe){fr.R.bind(pe.key,Ce=>{Ce.preventDefault(),Ce.stopPropagation(),Ce.returnValue=!1,pe.onTrigger()},pe.type??"keydown"),this._binds.push({...pe,type:pe.type??"keydown"})}removeAll(){this._binds.forEach(pe=>{fr.R.unbind(pe.key,pe.type)}),this._binds=[]}}var mi=e(58662),Wl=e(37040);function Gc(Ie){const pe=new Ul;let Ce=null;const ke=Ie.canEditDashboard(),ut=l.A.subscribe(Kr.Tp,At=>{typeof At.payload.panelId=="string"&&(Ce=At.payload.panelId)});function vt(At,jt){return()=>{const $t=o.jh.findObject(At,Yt=>Yt.state.key===Ce);if($t&&$t instanceof o.Eb){jt($t);return}}}return pe.addBinding({key:"v",onTrigger:vt(Ie,At=>{if(Ie.state.viewPanelScene)i.Ny.push(n.I.getUrlForPartial(i.Ny.getLocation(),{viewPanel:void 0}));else{const jt=n.I.stripBaseFromUrl((0,Aa.r7)(At));i.Ny.push(jt)}})}),r.$.featureToggles.newDashboardSharingComponent?(pe.addBinding({key:"p u",onTrigger:vt(Ie,async At=>{const jt=new Gs.j({shareView:mi.wr.link,panelRef:At.getRef()});Ie.showModal(jt)})}),pe.addBinding({key:"p e",onTrigger:vt(Ie,async At=>{const jt=new Gs.j({shareView:mi.wr.embed,panelRef:At.getRef()});Ie.showModal(jt)})}),ir.TP.isSignedIn&&r.$.snapshotEnabled&&ir.TP.hasPermission(lr.w.SnapshotsCreate)&&pe.addBinding({key:"p s",onTrigger:vt(Ie,async At=>{const jt=new Gs.j({shareView:mi.wr.snapshot,panelRef:At.getRef()});Ie.showModal(jt)})})):pe.addBinding({key:"p s",onTrigger:vt(Ie,async At=>{Ie.showModal(new yn.Z({panelRef:At.getRef()}))})}),pe.addBinding({key:"i",onTrigger:vt(Ie,async At=>{Ie.state.inspectPanelKey?i.Ny.push(n.I.getUrlForPartial(i.Ny.getLocation(),{inspect:void 0})):i.Ny.push(n.I.stripBaseFromUrl((0,Aa.Uu)(At)))})}),pe.addBinding({key:"p x",onTrigger:vt(Ie,async At=>{const jt=await(0,Aa.Lp)(At);jt&&i.Ny.push(jt)})}),pe.addBinding({key:"p l",onTrigger:vt(Ie,Wl.vR)}),pe.addBinding({key:"d r",onTrigger:()=>o.jh.getTimeRange(Ie).onRefresh()}),pe.addBinding({key:"t z",onTrigger:()=>{Nl(Ie)}}),pe.addBinding({key:"ctrl+z",onTrigger:()=>{Nl(Ie)}}),pe.addBinding({key:"t a",onTrigger:()=>{Xn.b4.getTimePicker(Ie)?.toAbsolute()}}),pe.addBinding({key:"t left",onTrigger:()=>{Kl(Ie,"left")}}),pe.addBinding({key:"t right",onTrigger:()=>{Kl(Ie,"right")}}),ke&&(pe.addBinding({key:"e",onTrigger:vt(Ie,async At=>{if(At.getRoot()instanceof yi){const $t=(0,C.Cs)(At);if(Ie.state.editPanel)i.Ny.push(n.I.getUrlForPartial(i.Ny.getLocation(),{editPanel:void 0}));else{const Yt=n.I.stripBaseFromUrl((0,Aa.e0)($t));i.Ny.push(Yt)}}})}),pe.addBinding({key:"d s",onTrigger:Ie.onOpenSettings}),pe.addBinding({key:"mod+s",onTrigger:()=>Ie.openSaveDrawer({})}),pe.addBinding({key:"p r",onTrigger:vt(Ie,At=>{Ie.state.isEditing&&(0,Wl.MI)(Ie,At)})}),pe.addBinding({key:"p d",onTrigger:vt(Ie,At=>{Ie.state.isEditing&&Ie.duplicatePanel(At)})}),pe.addBinding({key:"d shift+c",onTrigger:()=>{Ie.state.body instanceof ts.D&&Ie.state.body.collapseAllRows()}}),pe.addBinding({key:"d shift+e",onTrigger:()=>{Ie.state.body instanceof ts.D&&Ie.state.body.expandAllRows()}})),()=>{pe.removeAll(),ut.unsubscribe()}}function Nl(Ie){Xn.b4.getTimePicker(Ie)?.onZoom()}function Kl(Ie,pe){const Ce=Xn.b4.getTimePicker(Ie);Ce&&(pe==="left"&&Ce.onMoveBackward(),pe==="right"&&Ce.onMoveForward())}var wl=e(25953),Hc=e(17084),vi=e(48492);const Qc=["title","description","tags","editable","graphTooltip","links","meta","preload"],Fl="systemPanelFilterVar",Vl="systemDynamicRowSizeVar";class yi extends o.Bs{constructor(pe,Ce="v1"){super({title:(0,s.t)("dashboard-scene.dashboard-scene.title.dashboard","Dashboard"),meta:{},editable:!0,$timeRange:pe.$timeRange??new o.JZ({}),body:pe.body??ts.D.fromVizPanels(),links:pe.links??[],...pe,editPane:new W,layoutOrchestrator:new nn}),this._urlSync=new lo(this),this._variableDependency=new kc(this),this._renderBeforeActivation=!0,this.onEnterEditMode=()=>{this._initialState=o.Go.cloneSceneObjectState(this.state),this._initialUrlState=i.Ny.getLocation(),this.setState({isEditing:!0}),this.state.body.editModeChanged?.(!0),this._changeTracker.startTrackingChanges()},this.onRestore=async ke=>{let ut;if(r.$.featureToggles.kubernetesClientDashboardsFolders?ut=await mn.w.restoreDashboard(ke.uid,ke.id):ut=await mn.w.restoreDashboard(ke.uid,ke.version),!Number.isInteger(ut.version))return!1;const vt={dashboard:new v.G(ke.data),meta:this.state.meta},At=(0,xn.wM)(vt),jt=o.Go.cloneSceneObjectState(At.state);return jt.version=ut.version,this.setState(jt),this.exitEditMode({skipConfirm:!0,restoreInitialState:!1}),!0},this.onOpenSettings=()=>{i.Ny.partial({editview:"settings"})},this.getSnapshotUrl=()=>this.serializer.getSnapshotUrl(),this.onSetScrollRef=ke=>{this._scrollRef=ke},this.serializer=Gt(Ce==="v2"?"v2":"v1"),this._changeTracker=new B.l(this),this.addActivationHandler(()=>this._activationHandler())}static{this.Component=Qi}_activationHandler(){let pe=window.__grafanaSceneContext;const Ce=i.Ny.getLocation().pathname==="/dashboard/new";window.__grafanaSceneContext=this,this._initializePanelSearch(),this.state.isEditing&&(this._initialUrlState=i.Ny.getLocation(),this._changeTracker.startTrackingChanges()),Ce&&(this.onEnterEditMode(),this.setState({isDirty:!0})),!this.state.meta.isEmbedded&&this.state.uid&&y.t.watch(this.state.uid);let ke=()=>{};r.$.publicDashboardAccessToken||(ke=Gc(this));const ut=new Da(this);return(0,x.UA)().setCurrent(ut),()=>{window.__grafanaSceneContext=pe,ke(),this._changeTracker.terminate(),ut.destroy(),y.t.leave()}}_initializePanelSearch(){const pe=o.jh.lookupVariable(Fl,this)?.getValue();typeof pe=="string"&&this.setState({panelSearch:pe});const Ce=o.jh.lookupVariable(Vl,this)?.getValue();if(typeof Ce=="string"){const ke=Number.parseInt(Ce,10);this.setState({panelsPerRow:Number.isInteger(ke)?ke:void 0})}}saveCompleted(pe,Ce,ke){this.serializer.onSaveComplete(pe,Ce),this._changeTracker.stopTrackingChanges(),this.setState({version:Ce.version,isDirty:!1,uid:Ce.uid,id:Ce.id,meta:{...this.state.meta,uid:Ce.uid,url:Ce.url,slug:Ce.slug,folderUid:ke,version:Ce.version},overlay:void 0}),this.state.editPanel?.dashboardSaved(),this._initialState=o.Go.cloneSceneObjectState(this.state),this._initialUrlState=i.Ny.getLocation(),this._changeTracker.startTrackingChanges()}exitEditMode({skipConfirm:pe,restoreInitialState:Ce}){if(!this.canDiscard()){console.error("Trying to discard back to a state that does not exist, initialState undefined");return}if(!this.state.isDirty||pe||this.managedResourceCannotBeEdited()){this.exitEditModeConfirmed(Ce||this.state.isDirty);return}l.A.publish(new d.bY({title:(0,s.t)("dashboard-scene.dashboard-scene.title.discard-changes-to-dashboard","Discard changes to dashboard?"),text:"You have unsaved changes to this dashboard. Are you sure you want to discard them?",icon:"trash-alt",yesText:"Discard",onConfirm:()=>{this.exitEditModeConfirmed()}}))}exitEditModeConfirmed(pe=!0){this._changeTracker.stopTrackingChanges();const Ce=n.I.getUrlForPartial(this._initialUrlState,{editPanel:null,editview:null,inspect:null,inspectTab:null,shareView:null});i.Ny.replace(n.I.stripBaseFromUrl(Ce)),pe?this.setState({...this._initialState,isEditing:!1}):this.setState({isEditing:!1}),this.state.editPanel&&this.state.editPanel.onDiscard(),this.state.body.editModeChanged?.(!1)}canDiscard(){return this._initialState!==void 0}pauseTrackingChanges(){this._changeTracker.stopTrackingChanges()}resumeTrackingChanges(){this._changeTracker.startTrackingChanges()}openSaveDrawer({saveAsCopy:pe,onSaveSuccess:Ce}){this.state.isEditing&&this.setState({overlay:new En({dashboardRef:this.getRef(),saveAsCopy:pe,onSaveSuccess:Ce})})}openV2SchemaEditor(){this.setState({overlay:new dt({dashboardRef:this.getRef()})})}getPageNav(pe,Ce){const{meta:ke,viewPanelScene:ut,editPanel:vt,title:At,uid:jt}=this.state,$t=!jt;let Yt={text:At,url:(0,Pt.u)({uid:jt,slug:ke.slug,currentQueryParams:pe.search,updateQuery:{viewPanel:null,inspect:null,editview:null,editPanel:null,tab:null,shareView:null},isHomeDashboard:!ke.url&&!ke.slug&&!$t&&!ke.isSnapshot,isSnapshot:ke.isSnapshot})};const{folderUid:qt}=ke;if(qt){const hn=(0,f.tc)(Ce,`folder-dashboards-${qt}`).main;hn.id!=="not-found"&&(Yt={...Yt,parentItem:hn})}return ut&&(Yt={text:(0,s.t)("dashboard-scene.dashboard-scene.text.view-panel","View panel"),parentItem:Yt,url:(0,Aa.r7)(ut.state.panelRef.resolve())}),vt&&(Yt={text:(0,s.t)("dashboard-scene.dashboard-scene.text.edit-panel","Edit panel"),parentItem:Yt}),Yt}getBodyToRender(){return this.state.viewPanelScene??this.state.body}getInitialState(){return this._initialState}addPanel(pe){this.state.isEditing||this.onEnterEditMode(),this.state.body.addPanel(pe)}createLibraryPanel(pe,Ce){const ke=pe.clone({$behaviors:[new Bt.u({uid:Ce.uid,name:Ce.name})]}),ut=pe.parent;if(!(ut instanceof es.U))throw new Error("Trying to replace a panel that doesn't have a parent grid item");ut.setState({body:ke})}duplicatePanel(pe){(0,C.h$)(pe).duplicatePanel?.(pe)}copyPanel(pe){if(r.$.featureToggles.dashboardNewLayouts){const ut=pe.parent;if(ut instanceof wl.X){const vt=(0,tn.V6)(ut,this),At=(0,Ft.zd)(ut);(0,vi.G2)(),p.A.set(g.tH,JSON.stringify({elements:vt,gridItem:At}))}else if(ut instanceof es.U){const vt=(0,tn.V6)(ut,this),At=(0,_t.i2)(ut);(0,vi.G2)(),p.A.set(g.tH,JSON.stringify({elements:vt,gridItem:At}))}else throw console.error("Trying to copy a panel that is not DashboardGridItem child"),new Error("Trying to copy a panel that is not DashboardGridItem child");return}if(!pe.parent)return;let Ce=pe.parent;if(!(Ce instanceof es.U))throw console.error("Trying to copy a panel that is not DashboardGridItem child"),new Error("Trying to copy a panel that is not DashboardGridItem child");const ke=(0,gt.ZB)(Ce);(0,vi.G2)(),p.A.set(g.tH,JSON.stringify(ke))}pastePanel(){const pe=p.A.get(g.tH),Ce=JSON.parse(pe),ke=new m.a9(Ce),vt=(0,xn.tt)(ke).state.body;this.addPanel(vt),p.A.delete(g.tH)}removePanel(pe){(0,C.h$)(pe).removePanel?.(pe)}unlinkLibraryPanel(pe){if(!pe.parent)return;const Ce=pe.parent;if(!(Ce instanceof es.U)){console.error("Trying to unlink a lib panel in a layout that is not DashboardGridItem");return}Ce.state.body.setState({$behaviors:void 0})}showModal(pe){this.setState({overlay:pe})}closeModal(){this.setState({overlay:void 0})}async onStarDashboard(){const{meta:pe,uid:Ce}=this.state;if(Ce)try{const ke=await(0,x.UA)().starDashboard(Ce,!!pe.isStarred);this.setState({meta:{...pe,isStarred:ke}})}catch(ke){console.error("Failed to star dashboard",ke)}}onShowAddLibraryPanelDrawer(pe){this.setState({overlay:new Kt({panelToReplaceRef:pe})})}onCreateNewRow(){return(0,Hc.t)(this.state.body)}onCreateNewPanel(){const pe=(0,C.O8)();return this.addPanel(pe),pe}switchLayout(pe){const Ce=this.state.body;j.cc.edit({description:(0,s.t)("dashboard.edit-actions.switch-layout","Switch layout"),source:this,perform:()=>this.setState({body:pe}),undo:()=>this.setState({body:Ce})})}getLayout(){return this.state.body}enrichDataRequest(pe){const Ce=(0,C.YQ)(pe);let ke=(0,C.xz)(pe);Ce.state.isEditing&&Ce.state.editPanel&&(ke=Ce.state.editPanel.state.panelRef.resolve());let ut=0;return ke&&ke.state.key&&((0,D.uc)(ke.state.key)?ut=ps(ke?.state.key):ut=(0,C.Cs)(ke)),{app:a.Jk.Dashboard,dashboardUID:this.state.uid,panelId:ut,panelName:ke?.state?.title,panelPluginId:ke?.state.pluginId,dashboardTitle:this.state.title}}canEditDashboard(){const{meta:pe}=this.state;return!!(pe.canEdit||pe.canMakeEditable)}getInitialSaveModel(){return this.serializer.initialSaveModel}setInitialSaveModel(pe,Ce,ke){this.serializer.initializeElementMapping(pe),this.serializer.initializeDSReferencesMapping(pe);const ut=(0,c.v)(pe);this.serializer.initialSaveModel=ut,this.serializer.metadata=Ce,this.serializer.apiVersion=ke}getTrackingInformation(){return this.serializer.getTrackingInformation(this)}async onDashboardDelete(){this.setState({isDirty:!1}),i.Ny.replace("/")}getDashboardPanels(){return Xn.b4.getVizPanels(this)}rememberScrollPos(){this._prevScrollPos=this._scrollRef?.scrollTop}restoreScrollPos(){this._prevScrollPos!==void 0&&this._scrollRef?.scrollTo(0,this._prevScrollPos)}getSaveModel(){return this.serializer.getSaveModel(this)}getSaveResource(pe){const{meta:Ce}=this.state,ke=this.getSaveAsModel(pe);return{apiVersion:`dashboard.grafana.app/${this.serializer instanceof Ut?"v2alpha1":"v1beta1"}`,kind:"Dashboard",metadata:{...Ce.k8s,name:Ce.uid??Ce.k8s?.name,generateName:pe.isNew?"d":void 0},spec:ke}}getSaveAsModel(pe){return this.serializer.getSaveAsModel(this,pe)}getDashboardChanges(pe,Ce,ke){return this.serializer.getDashboardChangesFromScene(this,{saveTimeRange:pe,saveVariables:Ce,saveRefresh:ke})}getManagerKind(){return this.state.meta.k8s?.annotations?.[E.LH]}isManaged(){return!!this.getManagerKind()}isManagedRepository(){return r.$.featureToggles.provisioning?this.getManagerKind()===E.Sf.Repo:!1}managedResourceCannotBeEdited(){return this.isManaged()&&!this.isManagedRepository()&&!this.state.meta.k8s?.annotations?.[E.Ms]}getPath(){return this.state.meta.k8s?.annotations?.[E.Y_]}}class kc{constructor(pe){this._dashboard=pe,this._emptySet=new Set}getNames(){return this._emptySet}hasDependencyOn(){return!1}variableUpdateCompleted(pe,Ce){if(Ce&&(l.A.publish(new h.og({refreshAll:!0,panelIds:[]})),this._dashboard.publishEvent(new u._)),pe.state.name===Fl){const ke=pe.getValue();typeof ke=="string"&&this._dashboard.setState({panelSearch:ke})}else if(pe.state.name===Vl){const ke=pe.getValue();if(typeof ke=="string"){const ut=Number.parseInt(ke,10);this._dashboard.setState({panelsPerRow:Number.isInteger(ut)?ut:void 0})}}}}},7094:(te,R,e)=>{"use strict";e.d(R,{u:()=>y});var n=e(74848),a=e(16207),s=e(92745),i=e(43173),r=e(36674),u=e(41654),o=e(82612),l=e(30124),g=e(18789),f=e(8285),p=e(32540),c=e(37040),x=e(66251),v=e(81657),m=e(93389);class y extends r.Bs{static{this.LOADING_VIZ_PANEL_PLUGIN_ID="library-panel-loading-plugin"}constructor(b){super(b),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this.state.isLoaded||this.loadLibraryPanelFromPanelModel()}setPanelFromLibPanel(b){if(this.state._loadedPanel?.version===b.version)return;const D=this.parent;if(!(D instanceof r.Eb))return;const C=new o.a9(b.model),P=(0,f.Cs)(D);C.id=P;const M=[];M.push(new p.$({rawLinks:C.links,menu:new p.m({$behaviors:[c.oV]})})),M.push(new x.W);let O;i.$.featureToggles.preferLibraryPanelTitle?O=C.title??D.state.title:O=D.state.title??C.title;const j={title:O,options:C.options??{},fieldConfig:C.fieldConfig,pluginId:C.type,pluginVersion:C.pluginVersion,displayMode:C.transparent?"transparent":void 0,description:C.description,titleItems:M,$data:(0,g.w)(C)};(C.timeFrom||C.timeShift)&&(j.$timeRange=new v.v({timeFrom:C.timeFrom,timeShift:C.timeShift,hideTimeOverride:C.hideTimeOverride})),D.setState(j),D.changePluginType(C.type,j.options,j.fieldConfig),this.setState({_loadedPanel:b,isLoaded:!0,name:b.name});const U=D.parent;C.repeat&&U instanceof m.U&&(U.setState({variableName:C.repeat,repeatDirection:C.repeatDirection==="h"?"h":"v",maxPerRow:C.maxPerRow,itemHeight:U.state.height??10}),U.performRepeat())}unlink(){const b=this.parent;b instanceof r.Eb&&b.setState({$behaviors:b.state.$behaviors?.filter(D=>D!==this)})}async loadLibraryPanelFromPanelModel(){let b=this.parent;if(b instanceof r.Eb)try{const D=await(0,l.Yr)(this.state.uid,!0);this.setPanelFromLibPanel(D)}catch{b.setState({_pluginLoadError:`Unable to load library panel: ${this.state.uid}`})}}}const h=new a.m(d);function d(E){return(0,n.jsx)(u.B,{direction:"column",justifyContent:"space-between",children:(0,n.jsx)(s.x6,{i18nKey:"library-panels.loading-panel-text",children:"Loading library panel"})})}r.Go.registerRuntimePanelPlugin({pluginId:y.LOADING_VIZ_PANEL_PLUGIN_ID,plugin:h})},66483:(te,R,e)=>{"use strict";e.d(R,{c:()=>Se});var n=e(74848),a=e(96540),s=e(22803),i=e(78012),r=e(51898),u=e(92745),o=e(43173),l=e(36490),g=e(63142),f=e(7895),p=e(30703),c=e(88559),x=e(87063),v=e(45861),m=e(93256),y=e(36219),h=e(43707),d=e(5423),E=e(65642),b=e(95943),D=e(73427),C=e(22429),P=e(4590),M=e(52763),O=e(58662),j=e(25508),U=e(33680);const W=[],B=U.PP.endpoints.listRepository.select({}),S=(0,j.Mz)(B,Ge=>Ge.data?.items||W),_=(0,j.Mz)(S,(Ge,je)=>je,(Ge,je)=>{if(je)return Ge.find(Fe=>Fe.metadata?.name===je)}),K=(0,j.Mz)(S,(Ge,je)=>je,(Ge,je)=>Ge.find(Fe=>Fe.metadata?.name===je));var T=e(89451),L=e(55867);const A=r.Tp.pages.Dashboard.DashNav.NewExportButton;function N({dashboard:Ge}){const[je,Fe]=(0,a.useState)(!1),Be=(0,a.useCallback)(Ue=>{Fe(Ue)},[]),Ke=()=>(0,n.jsx)(L.A,{dashboard:Ge});return(0,n.jsx)(m.e,{"data-testid":A.container,children:(0,n.jsx)(c.m,{overlay:Ke,placement:"bottom-end",onVisibleChange:Be,children:(0,n.jsxs)(v.$n,{"data-testid":A.arrowMenu,size:"sm",variant:"secondary",fill:"solid",tooltip:(0,u.t)("export.menu.export-as-json-tooltip","Export"),children:[(0,n.jsx)(u.x6,{i18nKey:"export.menu.export-as-json-label",children:"Export"}),"\xA0",(0,n.jsx)(p.I,{name:je?"angle-up":"angle-down",size:"sm"})]})})})}var V=e(41053),z=e(23289),w=e(16001),H=e(12434);const Q=r.Tp.pages.Dashboard.DashNav.newShareButton;function Z({dashboard:Ge,panel:je}){const Fe=(0,g.of)(Y),[Be,Ke]=(0,a.useState)(!1),[Ue,we]=(0,V.A)(async()=>(z.c.toolbarShareClick(),await(0,H.Xe)(Ge,je)),[Ge]),Xe=(0,a.useCallback)(he=>{he&&z.c.toolbarShareDropdownClick(),Ke(he)},[]),nt=()=>(0,n.jsx)(w.Ay,{dashboard:Ge});return(0,n.jsxs)(m.e,{"data-testid":Q.container,className:Fe.container,children:[(0,n.jsx)(v.$n,{"data-testid":Q.shareLink,size:"sm",tooltip:(0,u.t)("share-dashboard.share-button-tooltip","Copy link"),onClick:we,children:(0,n.jsx)(u.x6,{i18nKey:"share-dashboard.share-button",children:"Share"})}),(0,n.jsx)(c.m,{overlay:nt,placement:"bottom-end",onVisibleChange:Xe,children:(0,n.jsx)(v.$n,{"aria-label":(0,u.t)("dashboard-scene.share-button.aria-label-sharedropdownmenu","Toggle share menu"),"data-testid":Q.arrowMenu,size:"sm",icon:Be?"angle-up":"angle-down"})})]})}function Y(Ge){return{container:(0,s.css)({gap:1})}}var X=e(75541),I=e(8285),J=e(63704),ee=e(71599),q=e(45229),ne=e(87745);function se(Ge){return(0,n.jsx)(f.I,{"data-testid":"button-snapshot",tooltip:(0,u.t)("dashboard.toolbar.open-original","Open original dashboard"),icon:"link",onClick:()=>oe(Ge.originalURL)},"button-snapshot")}const oe=Ge=>{const je=Ge??"",Fe=J.sQ.sanitizeUrl(je);try{const Be=new URL(Fe,o.$.appUrl),Ke=new URL(o.$.appUrl);Be.host!==Ke.host?q.A.publish(new ne.S8({component:ee.u,props:{title:(0,u.t)("dashboard-scene.on-open-snapshot-original-dashboard.title.proceed-to-external-site","Proceed to external site?"),modalClass:(0,s.css)({width:"max-content",maxWidth:"80vw"}),body:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{children:["This link connects to an external website at"," ",(0,n.jsx)("code",{children:je})]}),(0,n.jsx)("p",{children:"Are you sure you'd like to proceed?"})]}),confirmVariant:"primary",confirmText:(0,u.t)("dashboard-scene.on-open-snapshot-original-dashboard.confirmText.proceed","Proceed"),onConfirm:()=>{window.location.href=Be.href}}})):l.Ny.push(Fe)}catch(Be){console.error("Failed to open original dashboard",Be)}};var de=e(99887),fe=e(75735);function ae({meta:Ge}){const je=Ge.k8s;if(!je?.annotations)return;let Fe="Provisioned";const Be=je.annotations?.[fe.LH],Ke=je.annotations?.[fe.Jw];switch(Be){case fe.Sf.Terraform:Fe="Terraform";break;case fe.Sf.Kubectl:Fe="Kubectl";break;case fe.Sf.Plugin:Fe=`Plugin: ${Ke}`;break}return(0,n.jsx)(de.E,{color:"purple",icon:"exchange-alt",tooltip:Fe},"provisioned-dashboard-button-badge")}const ce=({dashboard:Ge})=>{if(!Ge.state.meta.k8s?.annotations)return null;let je="Provisioned";const Fe=Ge.state.meta.k8s.annotations[fe.LH],Be=Ge.state.meta.k8s.annotations[fe.Jw];switch(Fe){case fe.Sf.Terraform:je="Terraform";break;case fe.Sf.Kubectl:je="Kubectl";break;case fe.Sf.Plugin:je=`Plugin: ${Be}`;break;case fe.Sf.Repo:je="Repository";break}return(0,n.jsx)(de.E,{color:"purple",icon:"exchange-alt",tooltip:je},"provisioned-dashboard-button-badge")},ie=({dashboard:Ge})=>(0,n.jsx)(se,{originalURL:Ge.getSnapshotUrl()??""});var ve=e(98036);const le=({dashboard:Ge})=>(0,n.jsx)(f.I,{tooltip:Ge.state.meta.isStarred?(0,u.t)("dashboard.toolbar.new.unmark-favorite","Unmark as favorite"):(0,u.t)("dashboard.toolbar.new.mark-favorite","Mark as favorite"),icon:(0,n.jsx)(p.I,{name:Ge.state.meta.isStarred?"favorite":"star",size:"lg",type:Ge.state.meta.isStarred?"mono":"default"}),"data-testid":r.Tp.components.NavToolbar.markAsFavorite,onClick:()=>{z.c.toolbarFavoritesClick(),Ge.onStarDashboard()}});var Ee=e(12991);const Re=({dashboard:Ge})=>{const{editview:je,editPanel:Fe,isEditing:Be,uid:Ke,meta:Ue,viewPanelScene:we}=Ge.useState(),Xe=!!je,nt=!!we,he=!!Be,xe=!!Fe,me=!!Ke,ye=!!Ue.canEdit,De=!!Ue.canStar,Le=!!Ue.isSnapshot,Ve=!Xe&&!nt&&!xe,ze=(0,Ee.g)([...(0,Ee.f)(X.C.left,"left-dynamic",!xe),{key:"star-button",component:le,group:"actions",condition:me&&De&&Ve&&!he},{key:"public-dashboard-badge",component:ve.d,group:"actions",condition:me&&De&&Ve&&!he},{key:"managed-dashboard-badge",component:ce,group:"actions",condition:Ge.isManaged()&&ye},{key:"open-snapshot-origin-button",component:ie,group:"actions",condition:Le&&!he}],Ge);return ze.length===0?null:(0,n.jsx)(y.U,{alignment:"left",children:ze})};var Oe=e(95395);const Se=(0,a.memo)(({dashboard:Ge})=>o.$.featureToggles.dashboardNewLayouts&&o.$.featureToggles.newDashboardSharingComponent?(0,n.jsx)(h.H,{breadcrumbActions:(0,n.jsx)(Re,{dashboard:Ge}),actions:(0,n.jsx)(Oe.GA,{dashboard:Ge})}):(0,n.jsx)(h.H,{actions:(0,n.jsx)(Te,{dashboard:Ge})}));Se.displayName="NavToolbarActions";function Te({dashboard:Ge}){const{isEditing:je,viewPanelScene:Fe,isDirty:Be,uid:Ke,meta:Ue,editview:we,editPanel:Xe,editable:nt}=Ge.useState(),{isPlaying:he}=P._o.useState(),[xe,me]=(0,a.useState)(!1),ye=D.TP.hasEditPermissionInFolders,De=[],Le=(0,g.of)(Je),Ve=!!Xe,ze=!!Fe,Ze=tt(Xe),Me=Xe&&(0,I.ME)(Xe.state.panelRef.resolve()),$e=!(Ke||Ge.isManaged()),at=i.M.exists(b.tH),ct=!we&&!ze&&!Ve,ft=je&&ct,Et=(0,M.d4)(Ye=>_(Ye,Ue.folderUid)),St=!!(Ge.isManagedRepository()||Et),Pt=E.Ay.viewersCanEdit;Ve||He(De,X.C.left,"left-actions"),De.push({group:"icon-actions",condition:Ke&&!!Ue.canStar&&ct&&!je,render:()=>{let Ye=Ue.isStarred?(0,u.t)("dashboard.toolbar.unmark-favorite","Unmark as favorite"):(0,u.t)("dashboard.toolbar.mark-favorite","Mark as favorite");return(0,n.jsx)(f.I,{tooltip:Ye,icon:(0,n.jsx)(p.I,{name:Ue.isStarred?"favorite":"star",size:"lg",type:Ue.isStarred?"mono":"default"}),"data-testid":r.Tp.components.NavToolbar.markAsFavorite,onClick:()=>{z.c.toolbarFavoritesClick(),Ge.onStarDashboard()}},"star-dashboard-button")}}),De.push({group:"icon-actions",condition:Ke&&!!Ue.canStar&&ct&&!je,render:()=>(0,n.jsx)(ve.d,{dashboard:Ge},"public-dashboard-badge")}),Ge.isManaged()&&Ue.canEdit&&De.push({group:"icon-actions",condition:!0,render:()=>(0,n.jsx)(ae,{meta:Ue},"managed-dashboard-badge")}),De.push({group:"icon-actions",condition:Ue.isSnapshot&&!je,render:()=>(0,n.jsx)(se,{originalURL:Ge.getSnapshotUrl()??""},"go-to-snapshot-origin")}),!Ve&&!je&&He(De,X.C.right,"icon-actions"),De.push({group:"add-panel",condition:ft,render:()=>(0,n.jsx)(c.m,{onVisibleChange:Ye=>{me(Ye),z.c.toolbarAddClick()},overlay:()=>(0,n.jsxs)(x.W,{children:[(0,n.jsx)(x.W.Item,{testId:r.Tp.pages.AddDashboard.itemButton("Add new visualization menu item"),label:(0,u.t)("dashboard.add-menu.visualization","Visualization"),onClick:()=>{const Ye=Ge.onCreateNewPanel();z.c.toolbarAddButtonClicked({item:"add_visualization"}),Ge.setState({editPanel:(0,T.L)(Ye,!0)})}},"add-visualization"),(0,n.jsx)(x.W.Item,{testId:r.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),label:(0,u.t)("dashboard.add-menu.import","Import from library"),onClick:()=>{Ge.onShowAddLibraryPanelDrawer(),z.c.toolbarAddButtonClicked({item:"add_library_panel"})},disabled:Ge.isManagedRepository()},"add-panel-lib"),(0,n.jsx)(x.W.Item,{testId:r.Tp.pages.AddDashboard.itemButton("Add new row menu item"),label:(0,u.t)("dashboard.add-menu.row","Row"),onClick:()=>{Ge.onCreateNewRow(),z.c.toolbarAddButtonClicked({item:"add_row"})}},"add-row"),(0,n.jsx)(x.W.Item,{disabled:!at,testId:r.Tp.pages.AddDashboard.itemButton("Add new panel from clipboard menu item"),label:(0,u.t)("dashboard.add-menu.paste-panel","Paste panel"),onClick:()=>{Ge.pastePanel(),z.c.toolbarAddButtonClicked({item:"paste_panel"})}},"paste-panel")]}),placement:"bottom",offset:[0,6],children:(0,n.jsxs)(v.$n,{variant:"primary",size:"sm",fill:"outline","data-testid":r.Tp.components.PageToolbar.itemButton("Add button"),children:[(0,n.jsx)(u.x6,{i18nKey:"dashboard.toolbar.add",children:"Add"}),(0,n.jsx)(p.I,{name:xe?"angle-up":"angle-down",size:"lg"})]},"add-panel-button")},"add-panel-dropdown")}),De.push({group:"playlist-actions",condition:he&&ct&&!je,render:()=>(0,n.jsx)(f.I,{"data-testid":r.Tp.pages.Dashboard.DashNav.playlistControls.prev,tooltip:(0,u.t)("dashboard.toolbar.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:()=>P._o.prev()},"play-list-prev")}),De.push({group:"playlist-actions",condition:he&&ct&&!je,render:()=>(0,n.jsx)(f.I,{onClick:()=>P._o.stop(),"data-testid":r.Tp.pages.Dashboard.DashNav.playlistControls.stop,children:(0,n.jsx)(u.x6,{i18nKey:"dashboard.toolbar.playlist-stop",children:"Stop playlist"})},"play-list-stop")}),De.push({group:"playlist-actions",condition:he&&ct&&!je,render:()=>(0,n.jsx)(f.I,{"data-testid":r.Tp.pages.Dashboard.DashNav.playlistControls.next,tooltip:(0,u.t)("dashboard.toolbar.playlist-next","Go to next dashboard"),icon:"forward",onClick:()=>P._o.next(),narrow:!0},"play-list-next")}),De.push({group:"back-button",condition:(ze||Ve)&&!Me,render:()=>(0,n.jsx)(v.$n,{onClick:()=>{l.Ny.partial({viewPanel:null,editPanel:null})},tooltip:"",variant:"secondary",size:"sm",icon:"arrow-left","data-testid":r.Tp.components.NavToolbar.editDashboard.backToDashboardButton,children:(0,n.jsx)(u.x6,{i18nKey:"dashboard.toolbar.back-to-dashboard",children:"Back to dashboard"})},"back")}),De.push({group:"back-button",condition:!!we,render:()=>(0,n.jsx)(v.$n,{onClick:()=>{l.Ny.partial({editview:null})},tooltip:"",fill:"text",variant:"secondary",size:"sm",icon:"arrow-left","data-testid":r.Tp.components.NavToolbar.editDashboard.backToDashboardButton,children:(0,n.jsx)(u.x6,{i18nKey:"dashboard.toolbar.back-to-dashboard",children:"Back to dashboard"})},"back")});const Dt=Ke&&!je&&!Ue.isSnapshot&&!he;return De.push({group:"main-buttons",condition:!o.$.featureToggles.newDashboardSharingComponent&&Dt,render:()=>(0,n.jsx)(v.$n,{tooltip:(0,u.t)("dashboard.toolbar.share.tooltip","Share dashboard"),size:"sm",className:Le.buttonWithExtraMargin,fill:"outline",onClick:()=>{z.c.toolbarShareClick(),l.Ny.partial({shareView:O.wr.link})},"data-testid":r.Tp.components.NavToolbar.shareDashboard,children:(0,n.jsx)(u.x6,{i18nKey:"dashboard.toolbar.share.label",children:"Share"})},"share-dashboard-button")}),De.push({group:"main-buttons",condition:!je&&(Ge.canEditDashboard()||Pt)&&!ze&&!he&&nt,render:()=>(0,n.jsx)(v.$n,{onClick:()=>{Ge.onEnterEditMode()},tooltip:(0,u.t)("dashboard.toolbar.edit.tooltip","Enter edit mode"),className:Le.buttonWithExtraMargin,variant:o.$.featureToggles.newDashboardSharingComponent?"secondary":"primary",size:"sm","data-testid":r.Tp.components.NavToolbar.editDashboard.editButton,children:(0,n.jsx)(u.x6,{i18nKey:"dashboard.toolbar.edit.label",children:"Edit"})},"edit")}),De.push({group:"main-buttons",condition:!je&&Ge.canEditDashboard()&&!ze&&!he&&!nt,render:()=>(0,n.jsx)(v.$n,{onClick:()=>{Ge.onEnterEditMode(),Ge.setState({editable:!0,meta:{...Ue,canEdit:!0}})},tooltip:(0,u.t)("dashboard.toolbar.enter-edit-mode.tooltip","This dashboard was marked as read only"),className:Le.buttonWithExtraMargin,variant:"secondary",size:"sm","data-testid":r.Tp.components.NavToolbar.editDashboard.editButton,children:(0,n.jsx)(u.x6,{i18nKey:"dashboard.toolbar.enter-edit-mode.label",children:"Make editable"})},"edit")}),De.push({group:"new-share-dashboard-buttons",condition:o.$.featureToggles.newDashboardSharingComponent&&Dt,render:()=>(0,n.jsx)(N,{dashboard:Ge},"new-export-dashboard-button")}),De.push({group:"new-share-dashboard-buttons",condition:o.$.featureToggles.newDashboardSharingComponent&&Dt,render:()=>(0,n.jsx)(Z,{dashboard:Ge},"new-share-dashboard-button")}),De.push({group:"settings",condition:je&&Ge.canEditDashboard()&&ct,render:()=>(0,n.jsx)(v.$n,{onClick:()=>{Ge.onOpenSettings()},tooltip:(0,u.t)("dashboard.toolbar.dashboard-settings.tooltip","Dashboard settings"),fill:"text",size:"sm",variant:"secondary","data-testid":r.Tp.components.NavToolbar.editDashboard.settingsButton,children:(0,n.jsx)(u.x6,{i18nKey:"dashboard.toolbar.dashboard-settings.label",children:"Settings"})},"settings")}),De.push({group:"main-buttons",condition:je&&!$e&&ct,render:()=>(0,n.jsx)(v.$n,{onClick:()=>Ge.exitEditMode({skipConfirm:!1}),tooltip:(0,u.t)("dashboard.toolbar.exit-edit-mode.tooltip","Exits edit mode and discards unsaved changes"),size:"sm",fill:"text",variant:"primary","data-testid":r.Tp.components.NavToolbar.editDashboard.exitButton,children:(0,n.jsx)(u.x6,{i18nKey:"dashboard.toolbar.exit-edit-mode.label",children:"Exit edit"})},"discard")}),De.push({group:"main-buttons",condition:Ve&&!Me&&!we&&!ze,render:()=>(0,n.jsx)(v.$n,{onClick:Xe?.onDiscard,tooltip:Xe?.state.isNewPanel?(0,u.t)("dashboard.toolbar.discard-panel-new","Discard panel"):(0,u.t)("dashboard.toolbar.discard-panel","Discard panel changes"),size:"sm",disabled:!Ze,fill:"outline",variant:"destructive","data-testid":r.Tp.components.NavToolbar.editDashboard.discardChangesButton,children:Xe?.state.isNewPanel?(0,n.jsx)(u.x6,{i18nKey:"dashboard.toolbar.discard-panel-new",children:"Discard panel"}):(0,n.jsx)(u.x6,{i18nKey:"dashboard.toolbar.discard-panel",children:"Discard panel changes"})},"discard")}),De.push({group:"main-buttons",condition:Ve&&Me&&!we&&!ze,render:()=>(0,n.jsx)(v.$n,{onClick:Xe?.onDiscard,tooltip:(0,u.t)("dashboard.toolbar.discard-library-panel-changes","Discard library panel changes"),size:"sm",fill:"outline",variant:"destructive","data-testid":r.Tp.components.NavToolbar.editDashboard.discardChangesButton,children:(0,n.jsx)(u.x6,{i18nKey:"dashboard.toolbar.discard-library-panel-changes",children:"Discard library panel changes"})},"discardLibraryPanel")}),De.push({group:"main-buttons",condition:Ve&&Me&&!we&&!ze,render:()=>(0,n.jsx)(v.$n,{onClick:Xe?.onUnlinkLibraryPanel,tooltip:(0,u.t)("dashboard.toolbar.unlink-library-panel","Unlink library panel"),size:"sm",fill:"outline",variant:"secondary","data-testid":r.Tp.components.NavToolbar.editDashboard.unlinkLibraryPanelButton,children:(0,n.jsx)(u.x6,{i18nKey:"dashboard.toolbar.unlink-library-panel",children:"Unlink library panel"})},"unlinkLibraryPanel")}),De.push({group:"main-buttons",condition:Ve&&Me&&!we&&!ze,render:()=>(0,n.jsx)(v.$n,{onClick:Xe?.onSaveLibraryPanel,tooltip:(0,u.t)("dashboard.toolbar.save-library-panel","Save library panel"),size:"sm",fill:"outline",variant:"primary","data-testid":r.Tp.components.NavToolbar.editDashboard.saveLibraryPanelButton,children:(0,n.jsx)(u.x6,{i18nKey:"dashboard.toolbar.save-library-panel",children:"Save library panel"})},"saveLibraryPanel")}),De.push({group:"main-buttons",condition:je&&!Me&&(Ue.canSave||ye),render:()=>{if($e)return(0,n.jsx)(v.$n,{onClick:()=>{Ge.openSaveDrawer({})},className:Le.buttonWithExtraMargin,tooltip:(0,u.t)("dashboard.toolbar.save-dashboard.tooltip","Save changes"),size:"sm",variant:"primary","data-testid":r.Tp.components.NavToolbar.editDashboard.saveButton,children:(0,n.jsx)(u.x6,{i18nKey:"dashboard.toolbar.save-dashboard.label",children:"Save dashboard"})},"save");if(ye&&!Ue.canSave&&!Ue.canMakeEditable&&!St)return(0,n.jsx)(v.$n,{onClick:()=>{Ge.openSaveDrawer({saveAsCopy:!0})},className:Le.buttonWithExtraMargin,tooltip:(0,u.t)("dashboard.toolbar.save-dashboard-copy.tooltip","Save as copy"),size:"sm",variant:Be?"primary":"secondary",children:(0,n.jsx)(u.x6,{i18nKey:"dashboard.toolbar.save-dashboard-copy.label",children:"Save as copy"})},"save");const Ye=(0,n.jsxs)(x.W,{children:[(0,n.jsx)(x.W.Item,{label:(0,u.t)("dashboard.toolbar.save-dashboard-short","Save"),icon:"save",onClick:()=>{Ge.openSaveDrawer({})}}),(0,n.jsx)(x.W.Item,{label:(0,u.t)("dashboard.toolbar.save-dashboard-copy.label","Save as copy"),icon:"copy",onClick:()=>{Ge.openSaveDrawer({saveAsCopy:!0})}})]});return(0,n.jsxs)(m.e,{className:Le.buttonWithExtraMargin,children:[(0,n.jsx)(v.$n,{onClick:()=>{Ge.openSaveDrawer({})},tooltip:(0,u.t)("dashboard.toolbar.save-dashboard.tooltip","Save changes"),size:"sm","data-testid":r.Tp.components.NavToolbar.editDashboard.saveButton,variant:Be?"primary":"secondary",children:(0,n.jsx)(u.x6,{i18nKey:"dashboard.toolbar.save-dashboard.label",children:"Save dashboard"})}),(0,n.jsx)(c.m,{overlay:Ye,children:(0,n.jsx)(v.$n,{"aria-label":(0,u.t)("dashboard.toolbar.more-save-options","More save options"),icon:"angle-down",variant:Be?"primary":"secondary",size:"sm"})})]},"save")}}),(0,n.jsx)(y.U,{alignment:"right",children:_e(De)})}function _e(Ge){const je=[];let Fe="";for(const Be of Ge)Be.condition&&(Fe&&Fe!==Be.group&&Fe&&je.push((0,n.jsx)(d.K,{},`${Be.group}-separator`)),je.push(Be.render()),Fe=Be.group);return je}function He(Ge,je,Fe){if(je.length>0)for(const Be of je){const Ke={dashboard:(0,C.UA)().getCurrent()};if(Be.show(Ke)){const Ue=Be.component;Ge.push({group:Fe,condition:!0,render:()=>(0,a.createElement)(Ue,{...Ke,key:Ge.length})})}}}function tt(Ge){const[je,Fe]=(0,a.useState)();return(0,a.useEffect)(()=>{if(Ge){const Be=Ge.subscribeToState(Ke=>{Ke.isDirty!==je&&Fe(Ke.isDirty)});return()=>Be.unsubscribe()}},[Ge,je]),je}function Je(Ge){return{hiddenElementsContainer:(0,s.css)({display:"flex",padding:0,gap:Ge.spacing(1),whiteSpace:"nowrap"}),buttonWithExtraMargin:(0,s.css)({margin:Ge.spacing(0,.5)}),publicBadge:(0,s.css)({color:"grey",backgroundColor:"transparent",border:"1px solid"})}}},32540:(te,R,e)=>{"use strict";e.d(R,{$:()=>f,m:()=>c});var n=e(74848),a=e(92745),s=e(36674),i=e(67522),r=e(30703),u=e(88559),o=e(7895),l=e(87063),g=e(37040);class f extends s.Bs{constructor(){super(...arguments),this._variableDependency=new s.Sh(this,{onAnyVariableChanged:()=>{this.state.rawLinks&&this.state.rawLinks.length>0&&this.forceRender()}})}static{this.Component=p}}function p({model:v}){const{menu:m,rawLinks:y}=v.useState();if(s.jh.getTimeRange(v).useState(),!(v.parent instanceof s.Eb))throw new Error("VizPanelLinks must be a child of VizPanel");if(!y||y.length===0)return null;if(y.length===1){const h=(0,g.eQ)(v.parent)[0];return(0,n.jsx)(i.NR.TitleItem,{href:h.href,onClick:h.onClick,target:h.target,title:h.title,children:(0,n.jsx)(r.I,{name:"external-link-alt",size:"md"})})}return(0,n.jsx)(u.m,{overlay:()=>(0,n.jsx)(m.Component,{model:m},m.state.key),children:(0,n.jsx)(o.I,{icon:"external-link-alt",iconSize:"md","aria-label":(0,a.t)("dashboard-scene.viz-panel-links-renderer.aria-label-panel-links","Panel links")})})}class c extends s.Bs{static{this.Component=x}}function x({model:v}){const{links:m}=v.useState();return m?(0,n.jsx)(l.W,{children:m?.map((y,h)=>(0,n.jsx)(l.W.Item,{label:y.title,url:y.href,target:y.target,onClick:y.onClick},h))}):null}},37040:(te,R,e)=>{"use strict";e.d(R,{eQ:()=>Y,MI:()=>I,oV:()=>Z,_i:()=>w,vR:()=>ee});var n=e(54092),a=e(60188),s=e(83175),i=e(92745),r=e(43173),u=e(36490),o=e(36674),l=e(45229),g=e(64762),f=e(12066),p=e(15130),c=e(47797),x=e(54),v=e(20437),m=e(58662),y=e(26689),h=e(302),d=e(8001),E=e(63629),b=e(3260),D=e(8535),C=e(11257),P=e(87745),M=e(90091),O=e(99949),j=e(3371),U=e(23289),W=e(22079),B=e(8285),S=e(72746),_=e(32540),K=e(74848),T=e(12161);class L extends o.Bs{constructor(){super(...arguments),this.onDismiss=()=>{(0,B.YQ)(this).closeModal()},this.onConfirm=()=>{const oe=(0,B.YQ)(this);oe.unlinkLibraryPanel(this.state.panelRef.resolve()),oe.closeModal()}}static{this.Component=A}}function A({model:se}){return(0,K.jsx)(T.l,{isOpen:!0,onConfirm:()=>{se.onConfirm(),se.onDismiss()},onDismiss:se.onDismiss})}let N;function V(){return N||(N=(0,d.dp)(E.qm),N)}const z="metrics-drilldown";function w(se){(async()=>{const de=se.parent,fe=de.getPlugin(),ae=[],ce=[],ie=(0,B.YQ)(de),{isEmbedded:ve}=ie.state.meta,le=await H(de),Ee=(0,j.uc)(de.state.key);if(ve){le&&se.setState({items:[le]});return}const Re=!!ie.state.editPanel;if(Re||ae.push({text:(0,i.t)("panel.header-menu.view","View"),iconClassName:"eye",shortcut:"v",href:(0,W.r7)(de)}),ie.canEditDashboard()&&ie.state.editable&&!Ee&&!Re&&ae.push({text:(0,i.t)("panel.header-menu.edit","Edit"),iconClassName:"edit",shortcut:"e",href:(0,W.e0)((0,B.Cs)(de))}),r.$.featureToggles.newDashboardSharingComponent){const Te=[];Te.push({text:(0,i.t)("share-panel.menu.share-link-title","Share link"),iconClassName:"link",shortcut:"p u",onClick:()=>{U.c.sharingCategoryClicked({item:m.wr.link,shareResource:(0,m.hD)(de?.getRef())});const _e=new M.j({shareView:m.wr.link,panelRef:de.getRef()});ie.showModal(_e)}}),Te.push({text:(0,i.t)("share-panel.menu.share-embed-title","Share embed"),iconClassName:"arrow",shortcut:"p e",onClick:()=>{U.c.sharingCategoryClicked({item:m.wr.embed,shareResource:(0,m.hD)(de.getRef())});const _e=new M.j({shareView:m.wr.embed,panelRef:de.getRef()});ie.showModal(_e)}}),p.TP.isSignedIn&&r.$.snapshotEnabled&&p.TP.hasPermission(C.w.SnapshotsCreate)&&Te.push({text:(0,i.t)("share-panel.menu.share-snapshot-title","Share snapshot"),iconClassName:"camera",shortcut:"p s",onClick:()=>{U.c.sharingCategoryClicked({item:m.wr.snapshot,shareResource:(0,m.hD)(de.getRef())});const _e=new M.j({shareView:m.wr.snapshot,panelRef:de.getRef()});ie.showModal(_e)}}),ae.push({type:"submenu",text:(0,i.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",subMenu:Te,onClick:_e=>{_e.preventDefault()}})}else ae.push({text:(0,i.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",onClick:()=>{ie.showModal(new O.Z({panelRef:de.getRef()}))},shortcut:"p s"});ie.state.isEditing&&!Ee&&!Re&&ce.push({text:(0,i.t)("panel.header-menu.duplicate","Duplicate"),iconClassName:"file-copy-alt",onClick:()=>{ie.duplicatePanel(de)},shortcut:"p d"}),Re||ce.push({text:(0,i.t)("panel.header-menu.copy","Copy"),iconClassName:"copy",onClick:()=>{ie.copyPanel(de)}}),ie.state.isEditing&&!Ee&&!Re&&((0,B.ME)(de)?(ce.push({text:(0,i.t)("panel.header-menu.unlink-library-panel","Unlink library panel"),iconClassName:"link-broken",onClick:()=>{ie.showModal(new L({panelRef:de.getRef()}))}}),ce.push({text:(0,i.t)("panel.header-menu.replace-library-panel","Replace library panel"),iconClassName:"library-panel",onClick:()=>{ie.onShowAddLibraryPanelDrawer(de.getRef())}})):r.$.featureToggles.newDashboardSharingComponent?ce.push({text:(0,i.t)("share-panel.menu.new-library-panel-title","New library panel"),iconClassName:"plus-square",onClick:()=>{const Te=new M.j({shareView:m.wr.libraryPanel,panelRef:de.getRef()});ie.showModal(Te)}}):ce.push({text:(0,i.t)("panel.header-menu.create-library-panel","Create library panel"),onClick:()=>{ie.showModal(new O.Z({panelRef:de.getRef(),activeTab:m.wr.libraryPanel}))}})),(0,x.q0)()&&ce.push({text:(0,i.t)("panel.header-menu.new-alert-rule","New alert rule"),iconClassName:"bell",onClick:Te=>J(de)}),q(de.state.options)&&!Re&&ce.push({text:de.state.options.legend.showLegend?(0,i.t)("panel.header-menu.hide-legend","Hide legend"):(0,i.t)("panel.header-menu.show-legend","Show legend"),iconClassName:de.state.options.legend.showLegend?"legend-hide":"legend-show",onClick:Te=>{Te.preventDefault(),ee(de)},shortcut:"p l"}),ie.canEditDashboard()&&fe&&!fe.meta.skipDataQuery&&!Ee&&ce.push({text:(0,i.t)("panel.header-menu.get-help","Get help"),iconClassName:"question-circle",onClick:Te=>{Te.preventDefault(),ne(de,y.q.Help)}}),le&&ae.push(le),ae.push(Q(fe,de,ie)),V();const{extensions:Se}=N({extensionPointId:n.S.DashboardPanelMenu,context:X(de,ie),limitPerPlugin:3});if(Se.length>0&&!ie.state.isEditing){const Te=Se.filter(tt=>tt.type===n.u.link),[_e,He]=Te.reduce(([tt,Je],Ge)=>(Ge.category===z?tt.push(Ge):Je.push(Ge),[tt,Je]),[[],[]]);_e.length>0&&ae.push({text:(0,i.t)("dashboard-scene.panel-menu-behavior.async-func.text.metrics-drilldown","Metrics drilldown"),iconClassName:"code-branch",type:"submenu",subMenu:(0,b.N9)(_e)}),He.length>0&&ae.push({text:(0,i.t)("dashboard-scene.panel-menu-behavior.async-func.text.extensions","Extensions"),iconClassName:"plug",type:"submenu",subMenu:(0,b.N9)(He)})}ce.length&&ae.push({type:"submenu",text:(0,i.t)("panel.header-menu.more","More..."),iconClassName:"cube",subMenu:ce,onClick:Te=>{Te.preventDefault()}}),ie.state.isEditing&&!Ee&&!Re&&(ae.push({text:"",type:"divider"}),ae.push({text:(0,i.t)("panel.header-menu.remove","Remove"),iconClassName:"trash-alt",onClick:()=>{I(ie,de)},shortcut:"p r"})),se.setState({items:ae})})()}async function H(se){const oe=await(0,W.Lp)(se);if(oe)return{text:(0,i.t)("panel.header-menu.explore","Explore"),iconClassName:"compass",shortcut:"p x",href:oe}}function Q(se,oe,de){const fe=[];return se&&!se.meta.skipDataQuery&&(fe.push({text:(0,i.t)("panel.header-menu.inspect-data","Data"),href:(0,W.Uu)(oe,y.q.Data),onClick:ae=>{ae.preventDefault(),u.Ny.partial({inspect:oe.state.key,inspectTab:y.q.Data})}}),de instanceof S.H$&&de.state.meta.canEdit&&fe.push({text:(0,i.t)("panel.header-menu.query","Query"),href:(0,W.Uu)(oe,y.q.Query),onClick:ae=>{ae.preventDefault(),u.Ny.partial({inspect:oe.state.key,inspectTab:y.q.Query})}})),fe.push({text:(0,i.t)("panel.header-menu.inspect-json","Panel JSON"),href:(0,W.Uu)(oe,y.q.JSON),onClick:ae=>{ae.preventDefault(),u.Ny.partial({inspect:oe.state.key,inspectTab:y.q.JSON})}}),{text:(0,i.t)("panel.header-menu.inspect","Inspect"),iconClassName:"info-circle",shortcut:"i",href:(0,W.Uu)(oe),onClick:ae=>{ae.isDefaultPrevented()||u.Ny.partial({inspect:oe.state.key,inspectTab:y.q.Data})},subMenu:fe.length>0?fe:void 0}}function Z(se){if(!(se.parent instanceof _.$))throw new Error("parent of VizPanelLinksMenu must be VizPanelLinks");const oe=se.parent.parent;if(!(oe instanceof o.Eb))throw new Error("parent of VizPanelLinks must be VizPanel");se.setState({links:Y(oe)})}function Y(se){const oe=(ae,ce)=>o.jh.interpolate(se,ae,ce),de=(0,h.CH)(se,oe);if(!de)return[];const fe=de.getLinks(oe);return fe.map(ae=>({...ae,onClick:(ie,ve)=>{U.c.panelLinkClicked({has_multiple_links:fe.length>1}),ae.onClick?.(ie,ve)}}))}function X(se,oe){const de=o.jh.getTimeRange(se);let fe=(0,B.un)(se);const ae=fe?.state.queries,ce=(0,B.Cs)(se);let ie={};if(se.state.$variables&&se.state.$variables.state.variables.forEach(ve=>{ve instanceof o.xc&&(ie={...ie,[ve.state.name]:{value:ve.getValue(),text:ve.getValueText()}})}),se.parent?.parent instanceof o.tI){const ve=se.parent.parent;ve.state.$variables&&ve.state.$variables.state.variables.forEach(le=>{le instanceof o.xc&&(ie={...ie,[le.state.name]:{value:le.getValue(),text:le.getValueText()}})})}return{id:ce,pluginId:se.state.pluginId,title:se.state.title,timeRange:de.state.value.raw,timeZone:(0,a.O)({timeZone:de.getTimeZone()}),dashboard:{uid:oe.state.uid,title:oe.state.title,tags:oe.state.tags||[]},targets:ae,scopedVars:ie,data:fe?.state.data}}function I(se,oe){l.A.publish(new P.bY({title:(0,i.t)("dashboard-scene.on-remove-panel.title.remove-panel","Remove panel"),text:(0,i.t)("dashboard-scene.on-remove-panel.text.remove-panel","Are you sure you want to remove this panel?"),icon:"trash-alt",yesText:"Remove",onConfirm:()=>se.removePanel(oe)}))}const J=async se=>{try{const oe=await(0,v.J6)(se),de=s.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(oe),returnTo:window.location.pathname+window.location.search});u.Ny.push(de)}catch(oe){const de=`Error getting rule values from the panel: ${(0,c.q6)(oe)}`;(0,D.JD)((0,f.dx)((0,g.gi)(de)));return}};function ee(se){const oe=se.state.options;q(oe)&&typeof oe.legend.showLegend=="boolean"&&se.onOptionsChange({legend:{showLegend:!oe.legend.showLegend}})}function q(se){return se!=null&&typeof se=="object"&&"legend"in se}const ne=(se,oe)=>{u.Ny.partial({inspect:se.state.key,inspectTab:oe})}},66251:(te,R,e)=>{"use strict";e.d(R,{W:()=>r});var n=e(74848),a=e(36674),s=e(46429),i=e(8285);class r extends a.Bs{constructor(){super({}),this.onActivate=()=>{const l=this.parent;if(!l||!(l instanceof a.Eb))throw new Error("PanelNotices can be used only as title items for VizPanel")},this.addActivationHandler(this.onActivate)}static{this.Component=u}getPanel(){const l=this.parent;return l&&l instanceof a.Eb?l:null}}function u({model:o}){const l=o.getPanel(),f=a.jh.getData(o).useState();if(!l)return null;const p=(0,i.Cs)(l);return f.data?.series?(0,n.jsx)(s.Z,{frames:f.data?.series,panelId:p}):null}},81657:(te,R,e)=>{"use strict";e.d(R,{v:()=>c});var n=e(74848),a=e(22803),s=e(22592),i=e(17548),r=e(33239),u=e(36674),o=e(63142),l=e(45967),g=e(91867),f=e(67522),p=e(30703);class c extends u.XQ{constructor(y={}){super({...y,from:"now-6h",to:"now",value:(0,s.E2)()}),this._variableDependency=new u.Sh(this,{statePaths:["timeFrom","timeShift"]}),this.addActivationHandler(()=>this._onActivate())}static{this.Component=x}_onActivate(){this._subs.add(this.subscribeToState(h=>{const{timeInfo:d,timeRange:E}=this.getTimeOverride(this.getAncestorTimeRange().state.value);h.timeInfo!==d&&this.setState({timeInfo:d,value:E})}));const{timeRange:y}=this.getTimeOverride(this.getAncestorTimeRange().state.value);this.setState({value:y,from:y.raw.from.toString(),to:y.raw.to.toString()})}ancestorTimeRangeChanged(y){const h=this.getTimeOverride(y.value);this.setState({value:h.timeRange,timeInfo:h.timeInfo})}getTimeOverride(y){const{timeFrom:h,timeShift:d}=this.state,E={timeInfo:"",timeRange:y};if(h){const b=u.jh.interpolate(this,this.state.timeFrom),D=i.describeTextRange(b);if(D.invalid)return E.timeInfo="invalid time override",E;if(i.isRelativeTimeRange(y.raw)){const C=this.getTimeZone();E.timeInfo=D.display,E.timeRange={from:r.parse(D.from,void 0,C),to:r.parse(D.to,void 0,C),raw:{from:D.from,to:D.to}}}}if(d){const b=u.jh.interpolate(this,this.state.timeShift);if(i.describeTextRange(b).invalid)return E.timeInfo="invalid timeshift",E;const C="-"+b;E.timeInfo+=" timeshift "+C;const P=r.parseDateMath(C,E.timeRange.from,!1),M=r.parseDateMath(C,E.timeRange.to,!0);if(!P||!M)return E.timeInfo="invalid timeshift",E;E.timeRange={from:P,to:M,raw:{from:P,to:M}}}return E}}function x({model:m}){const{timeInfo:y,hideTimeOverride:h}=m.useState(),d=(0,o.of)(v);return!y||h?null:(0,n.jsx)(l.m,{content:(0,n.jsx)(g.xS,{timeRange:m.state.value,timeZone:m.getTimeZone()}),children:(0,n.jsxs)(f.NR.TitleItem,{className:d.timeshift,children:[(0,n.jsx)(p.I,{name:"clock-nine",size:"sm"})," ",y]})})}const v=m=>({timeshift:(0,a.css)({color:m.colors.text.link,gap:m.spacing(.5),whiteSpace:"nowrap"})})},29700:(te,R,e)=>{"use strict";e.d(R,{r:()=>m});var n=e(74848),a=e(96540),s=e(16207),i=e(92745),r=e(36490),u=e(36674),o=e(87063),l=e(41654),g=e(31286),f=e(93256),p=e(45861),c=e(88559),x=e(8285),v=e(72746);const m="__unconfigured-panel",y=new s.m(h);function h(d){const[E,b]=(0,a.useState)(!1),D=(0,a.useCallback)(O=>{b(O)},[]),C=()=>{r.Ny.partial({editPanel:d.id})},P=()=>{const O=window.__grafanaSceneContext;if(!(O instanceof v.H$))throw new Error("DashboardScene not found");const j=(0,x.vL)(O,(0,x.XA)(d.id));if(!j)throw new Error("Panel not found");O.onShowAddLibraryPanelDrawer(j.getRef())},M=()=>(0,n.jsxs)(o.W,{children:[(0,n.jsx)(o.W.Item,{icon:"pen",label:(0,i.t)("dashboard.new-panel.menu-open-panel-editor","Configure"),onClick:C}),(0,n.jsx)(o.W.Item,{icon:"library-panel",label:(0,i.t)("dashboard.new-panel.menu-use-library-panel","Use library panel"),onClick:P})]});return(0,n.jsx)(l.B,{direction:"row",alignItems:"center",height:"100%",justifyContent:"center",children:(0,n.jsx)(g.a,{paddingBottom:2,children:(0,n.jsxs)(f.e,{children:[(0,n.jsx)(p.$n,{icon:"sliders-v-alt",onClick:C,children:(0,n.jsx)(i.x6,{i18nKey:"dashboard.new-panel.configure-button",children:"Configure"})}),(0,n.jsx)(c.m,{overlay:M,placement:"bottom-end",onVisibleChange:D,children:(0,n.jsx)(p.$n,{"aria-label":(0,i.t)("dashboard.new-panel.configure-button-menu","Toggle menu"),icon:E?"angle-up":"angle-down"})})]})})})}u.Go.registerRuntimePanelPlugin({pluginId:m,plugin:y})},12161:(te,R,e)=>{"use strict";e.d(R,{l:()=>i});var n=e(74848),a=e(92745),s=e(71599);const i=({isOpen:r,onConfirm:u,onDismiss:o})=>(0,n.jsx)(s.u,{title:(0,a.t)("dashboard-scene.unlink-modal.title-really-unlink-panel","Do you really want to unlink this panel?"),icon:"question-circle",body:(0,a.t)("dashboard-scene.unlink-modal.body-unlink-panel","If you unlink this panel, you will be able to edit it without affecting any other dashboards. However, once you make a change you will not be able to revert to its original reusable panel."),confirmText:(0,a.t)("dashboard-scene.unlink-modal.confirmText-yes-unlink","Yes, unlink"),onConfirm:()=>{u(),o()},onDismiss:o,isOpen:r})},3392:(te,R,e)=>{"use strict";e.d(R,{E:()=>x,j:()=>v});var n=e(2543),a=e(7389),s=e(78282),i=e(65642),r=e(30124),u=e(99305),o=e(75515),l=e(97583),g=e(67933);function f(m,y){switch(m.kind){case"GridLayout":{const h=m.spec.items||[];m.spec.items=h.filter(d=>d.spec.element.name!==y);break}case"AutoGridLayout":{const h=m.spec.items||[];m.spec.items=h.filter(d=>d.kind==="AutoGridLayoutItem"&&d.spec.element.name!==y);break}case"RowsLayout":{const h=m.spec.rows||[];m.spec.rows=h.filter(d=>(f(d.spec.layout,y),!p(d.spec.layout)));break}case"TabsLayout":{const h=m.spec.tabs||[];m.spec.tabs=h.filter(d=>(f(d.spec.layout,y),!p(d.spec.layout)));break}}}function p(m){if(!m||!m.spec)return!0;switch(m.kind){case"GridLayout":return(m.spec.items||[]).length===0;case"AutoGridLayout":return(m.spec.items||[]).length===0;case"RowsLayout":return(m.spec.rows||[]).length===0;case"TabsLayout":return(m.spec.tabs||[]).length===0;default:return!0}}function c(m){return!!(m.libraryPanel?.name&&m.libraryPanel?.uid)}async function x(m){m.cleanUpRepeats();const y=m.getSaveModelCloneOld();y.id=null,m.processRepeats();const h=[],d={},E={},b={},D=new Map;for(const O of y.getVariables())b[O.name]=O;const C=(O,j)=>{if(O.datasource===void 0){O.datasource=j;return}let U=O.datasource,W=null;const B=U?.uid,S=B&&u.SY.exec(B);if(S){const _=S[1]||S[2]||S[4];W=b[_],W&&W.current&&(U=W.current.value)}return(0,s.l)().get(U).then(_=>{if(_.meta?.builtIn||(d["datasource"+_.meta?.id]={type:"datasource",id:_.meta.id,name:_.meta.name,version:_.meta.info.version||"1.0.0"},W))return;const K=O.libraryPanel,T=K?"-for-library-panel":"";let L="DS_"+_.name.replace(" ","_").toUpperCase()+T.toUpperCase();if(E[L]={name:L,label:_.name,description:"",type:"datasource",pluginId:_.meta?.id,pluginName:_.meta?.name,usage:E[L]?.usage},K){const A=E[L]?.usage?.libraryPanels||[];A.push({name:K.name,uid:K.uid}),E[L].usage={libraryPanels:A}}O.datasource={type:_.meta.id,uid:"${"+L+"}"}})},P=async O=>{if(O.type!=="row"){if(await C(O),O.targets)for(const U of O.targets)await C(U,O.datasource);const j=i.Ay.panels[O.type];j&&(d["panel"+j.id]={type:"panel",id:j.id,name:j.name,version:j.info.version})}},M=async O=>{if((0,o.X)(O)){const{name:j,uid:U}=O.libraryPanel;let W=O.libraryPanel.model;W||(W=(await(0,r.Yr)(U,!0)).model),await C(W);const{gridPos:B,id:S,..._}=W;D.has(U)||D.set(U,{name:j,uid:U,kind:l.i.Panel,model:_})}};try{for(const U of y.panels)if(await P(U),U.collapsed!==void 0&&U.collapsed===!0&&U.panels)for(const W of U.panels)await P(W);for(const U of y.getVariables())U.type==="query"?(await C(U),U.options=[],U.current={},U.refresh=U.refresh!==a.CO.never?U.refresh:a.CO.onDashboardLoad):U.type==="datasource"?U.current={}:U.type==="adhoc"&&await C(U);for(const U of y.annotations.list)await C(U);d.grafana={type:"grafana",id:"grafana",name:"Grafana",version:i.Ay.buildInfo.version};for(const U of y.panels)if(await M(U),U.collapsed!==void 0&&U.collapsed===!0&&U.panels)for(const W of U.panels)await M(W);(0,n.each)(E,U=>{h.push(U)});for(const U of y.getVariables())if((0,g.VO)(U)){const W="VAR_"+U.name.replace(" ","_").toUpperCase();h.push({name:W,type:"constant",label:U.label||U.name,value:U.query,description:""}),U.query="${"+W+"}",U.current={value:U.query,text:U.query,selected:!1},U.options=[U.current]}const O=[...D.entries()].reduce((U,[W,B])=>(U[W]=B,U),{}),j=(0,n.defaults)({__inputs:h,__elements:O,__requires:(0,n.sortBy)(d,["id"])},y);for(let U=0;U<j.panels.length;U++){const W=j.panels[U];c(W)&&(j.panels[U]={gridPos:W.gridPos,id:W.id,libraryPanel:{uid:W.libraryPanel.uid,name:W.libraryPanel.name}})}return j}catch(O){return console.error("Export failed:",O),{error:O}}}async function v(m){const y={},h=m.variables.filter(b=>b.kind==="DatasourceVariable");for(const b of m.variables)y[b.spec.name]=b.spec;const d=b=>{const D=b.datasource?.uid;if(D?.startsWith("${")&&D?.endsWith("}")){const C=D.slice(2,-1);if(h.find(M=>M.spec.name===C))return}b.datasource=void 0},E=b=>{if(b.spec.data.spec.queries)for(const D of b.spec.data.spec.queries)d(D.spec)};try{const b=m.elements,D=m.layout;for(const[C,P]of Object.entries(b))P.kind==="Panel"?E(P):P.kind==="LibraryPanel"&&(delete b[C],f(D,C));for(const C of m.variables)C.kind==="QueryVariable"?(d(C.spec),C.spec.options=[],C.spec.current={text:"",value:""}):C.kind==="DatasourceVariable"&&(C.spec.current={text:"",value:""});for(const C of m.annotations)d(C.spec);return m}catch(b){return console.error("Export failed:",b),{error:b}}}},25953:(te,R,e)=>{"use strict";e.d(R,{X:()=>O});var n=e(2543),a=e(96540),s=e(36674),i=e(57558),r=e(3371),u=e(8285),o=e(41667),l=e(39765),g=e(74848),f=e(92745),p=e(25797),c=e(51156),x=e(31819),v=e(46415),m=e(33143);function y(j){const U=new p.C({title:(0,f.t)("dashboard.auto-grid.item-options.repeat.title","Repeat options"),id:"repeat-options",isOpenDefault:!1}).addItem(new c.v({title:(0,f.t)("dashboard.auto-grid.item-options.repeat.variable.title","Repeat by variable"),id:"repeat-by-variable-select",description:(0,f.t)("dashboard.auto-grid.item-options.repeat.variable.description","Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard."),render:B=>(0,g.jsx)(h,{id:B.props.id,item:j})})),W=(0,v.h)(j.state.conditionalRendering);return[U,W]}function h({item:j,id:U}){const{variableName:W}=j.useState();return(0,g.jsx)(x.U,{id:U,sceneContext:j,repeat:W,onChange:B=>{m.cc.edit({description:(0,f.t)("dashboard.edit-actions.panel-repeat-variable","Panel repeat by"),source:j,perform:()=>j.setRepeatByVariable(B),undo:()=>j.setRepeatByVariable(W)})}})}var d=e(22803),E=e(63142),b=e(41116),D=e(39242);function C({model:j}){const{body:U,repeatedPanels:W,key:B}=j.useState(),{draggingKey:S}=j.getParentGrid().useState(),{isEditing:_}=(0,u.TN)(j),[K,T,L]=(0,b.H)(j),A=(0,E.of)(P);if(K&&!_)return null;const N=!!S,V=S===B;return W?(0,g.jsx)(g.Fragment,{children:W.map(z=>(0,g.jsxs)("div",{className:(0,d.cx)(T,A.wrapper),children:[(0,g.jsx)(z.Component,{model:z}),L]},z.state.key))}):(0,g.jsxs)("div",{ref:j.containerRef,"data-auto-grid-item-drop-target":N?B:void 0,children:[V&&(0,g.jsx)("div",{className:A.draggedPlaceholder}),(0,g.jsxs)("div",{className:(0,d.cx)(!V&&T,A.wrapper,V&&A.draggedWrapper),children:[(0,g.jsx)(U.Component,{model:U}),L]})]})}const P=j=>({container:(0,d.css)({width:"100%",height:"100%"}),wrapper:(0,d.css)({width:"100%",height:"100%",position:"relative"}),draggedWrapper:(0,d.css)({position:"absolute",zIndex:1e3,top:`var(${D.hM})`,left:`var(${D.PS})`,width:`var(${D.MS})`,height:`var(${D.PP})`,opacity:.8}),draggedPlaceholder:(0,d.css)({width:"100%",height:"100%",boxShadow:`0 0 ${j.spacing(.5)} ${j.colors.primary.border}`,background:`${j.colors.primary.transparent}`,zIndex:-1})});var M=e(29425);class O extends s.Bs{constructor(U){super({...U,conditionalRendering:U?.conditionalRendering??i.p.createEmpty()}),this._variableDependency=new s.Sh(this,{variableNames:this.state.variableName?[this.state.variableName]:[],onVariableUpdateCompleted:()=>this.performRepeat()}),this.isDashboardLayoutItem=!0,this.containerRef=a.createRef(),this.addActivationHandler(()=>this._activationHandler())}static{this.Component=C}_activationHandler(){this.state.variableName&&this.performRepeat();const U=this.state.conditionalRendering?.activate();return()=>{U&&U()}}getOptions(){return y(this)}setElementBody(U){this.setState({body:U})}performRepeat(){if(!this.state.variableName||s.jh.hasVariableDependencyInLoadingState(this))return;const U=s.jh.lookupVariable(this.state.variableName,this)??new s.yP({name:"_____default_sys_repeat_var_____",options:[],value:"",text:"",query:"A"});if(!(U instanceof s.n8)){console.error("DashboardGridItem: Variable is not a MultiValueVariable");return}const{values:W,texts:B}=(0,u.a7)(U);if((0,n.isEqual)(this._prevRepeatValues,W))return;const S=this.state.body,_=[],K={values:[""],texts:U.hasAllValue()?["All"]:["None"]},T=W.length?W:K.values,L=B.length?B:K.texts;for(let A=0;A<T.length;A++){const N={$variables:new s.Pj({variables:[new s.xc({name:U.state.name,value:T[A],text:String(L[A])})]}),key:(0,r.lv)(S.state.key,A)},V=S.clone(N);_.push(V)}this.setState({repeatedPanels:_}),this._prevRepeatValues=W,this.publishEvent(new l.d({source:this}),!0)}setRepeatByVariable(U){const W={variableName:U};this.state.body.state.$variables&&this.state.body.setState({$variables:void 0}),this._variableDependency.setVariableNames(U?[U]:[]),this.setState(W),this.performRepeat()}getParentGrid(){if(!(this.parent instanceof M.o))throw new Error("Parent is not a AutoGridLayout");return this.parent}getBoundingBox(){const U=this.containerRef.current.getBoundingClientRect();return{width:U.width,height:U.height,top:this.containerRef.current.offsetTop,left:this.containerRef.current.offsetLeft}}editingStarted(){this.state.variableName&&(this.state.repeatedPanels?.length??0)>1&&this.state.body.setState({$variables:this.state.repeatedPanels[0].state.$variables?.clone(),$data:this.state.repeatedPanels[0].state.$data?.clone()})}editingCompleted(U){U&&(this._prevRepeatValues=void 0),this.performRepeat()}scrollIntoView(){(0,o.d)(this,this.containerRef)}}},29425:(te,R,e)=>{"use strict";e.d(R,{o:()=>m});var n=e(96540),a=e(36674),s=e(8285),i=e(25953),r=e(74848),u=e(22803),o=e(63142),l=e(3371),g=e(6607),f=e(1837),p=e(8835);function c({model:y}){const{children:h,isHidden:d,isLazy:E}=y.useState(),b=(0,l.Qp)(y),D=(0,o.of)(x,y.state),{layoutOrchestrator:C,isEditing:P}=(0,s.TN)(y),M=a.jh.getAncestor(y,p.X2),{fillScreen:O}=M.useState();if(d||!C)return null;const j=!b&&P;return(0,r.jsxs)("div",{className:(0,u.cx)(D.container,O&&D.containerFillScreen,P&&D.containerEditing),ref:y.containerRef,children:[h.map(U=>E?(0,r.jsx)(a.w1,{className:D.container,children:(0,r.jsx)(U.Component,{model:U},U.state.key)},U.state.key):(0,r.jsx)(U.Component,{model:U},U.state.key)),j&&(0,r.jsx)(g.f,{layoutManager:M})]})}const x=(y,h)=>({container:(0,u.css)({display:"grid",position:"relative",gridTemplateColumns:h.templateColumns,gridTemplateRows:h.templateRows||"unset",gridAutoRows:h.autoRows||"unset",rowGap:y.spacing(h.rowGap??1),columnGap:y.spacing(h.columnGap??1),justifyItems:h.justifyItems||"unset",alignItems:h.alignItems||"unset",justifyContent:h.justifyContent||"unset",[y.breakpoints.down("md")]:h.md?{gridTemplateRows:h.md.templateRows,gridTemplateColumns:h.md.templateColumns,rowGap:h.md.rowGap?y.spacing(h.md.rowGap??1):void 0,columnGap:h.md.columnGap?y.spacing(h.md.rowGap??1):void 0,justifyItems:h.md.justifyItems,alignItems:h.md.alignItems,justifyContent:h.md.justifyContent}:void 0,...f.u}),containerFillScreen:(0,u.css)({flexGrow:1}),containerEditing:(0,u.css)({paddingBottom:y.spacing(5),position:"relative"}),wrapper:(0,u.css)({display:"grid",position:"relative",width:"100%",height:"100%"}),dragging:(0,u.css)({position:"fixed",top:0,left:0,zIndex:y.zIndex.portal+1,pointerEvents:"none"})});var v=e(39242);class m extends a.Bs{constructor(h){super({rowGap:1,columnGap:1,templateColumns:"repeat(auto-fit, minmax(400px, 1fr))",autoRows:h.autoRows??"320px",children:h.children??[],...h}),this.containerRef=(0,n.createRef)(),this._draggedGridItem=null,this._initialGridItemPosition=null,this._onDragStart=this._onDragStart.bind(this),this._onDragEnd=this._onDragEnd.bind(this),this._onDrag=this._onDrag.bind(this),this.addActivationHandler(()=>this._activationHandler())}static{this.Component=c}_activationHandler(){return()=>{this._resetPanelPositionAndSize(),document.body.removeEventListener("pointermove",this._onDrag),document.body.removeEventListener("pointerup",this._onDragEnd),document.body.classList.remove("dashboard-draggable-transparent-selection")}}isDraggable(){return this.state.isDraggable??!1}getDragClass(){return`grid-drag-handle-${this.state.key}`}getDragClassCancel(){return"grid-drag-cancel"}getDragHooks(){return{onDragStart:this._onDragStart}}_canDrag(h){return!this.isDraggable()||!(h.target instanceof Element)?!1:!!h.target.closest(`.${this.getDragClass()}`)&&!h.target.closest(`.${this.getDragClassCancel()}`)}_onDragStart(h,d){if(!this._canDrag(h))return;if(h.preventDefault(),h.stopPropagation(),!(d.parent instanceof i.X))throw new Error("Dragging wrong item");this._draggedGridItem=d.parent;const{top:E,left:b,width:D,height:C}=this._draggedGridItem.getBoundingBox();this._initialGridItemPosition={pageX:h.pageX,pageY:h.pageY,top:E,left:b},this._updatePanelSize(D,C),this._updatePanelPosition(E,b),this.setState({draggingKey:this._draggedGridItem.state.key}),document.body.addEventListener("pointermove",this._onDrag),document.body.addEventListener("pointerup",this._onDragEnd),document.body.classList.add("dashboard-draggable-transparent-selection"),(0,s.wP)(this)?.startDraggingSync(h,d)}_onDragEnd(){window.getSelection()?.removeAllRanges(),this._draggedGridItem=null,this._initialGridItemPosition=null,this._resetPanelPositionAndSize(),this.setState({draggingKey:void 0}),document.body.removeEventListener("pointermove",this._onDrag),document.body.removeEventListener("pointerup",this._onDragEnd),document.body.classList.remove("dashboard-draggable-transparent-selection")}_onDrag(h){if(!this._draggedGridItem||!this._initialGridItemPosition){this._onDragEnd();return}this._updatePanelPosition(this._initialGridItemPosition.top+(h.pageY-this._initialGridItemPosition.pageY),this._initialGridItemPosition.left+(h.pageX-this._initialGridItemPosition.pageX));const d=document.elementsFromPoint(h.clientX,h.clientY)?.find(E=>{const b=E.getAttribute("data-auto-grid-item-drop-target");return!!b&&b!==this._draggedGridItem.state.key})?.getAttribute("data-auto-grid-item-drop-target");d&&this._onDragOverItem(d)}_onDragOverItem(h){const d=[...this.state.children],E=d.findIndex(D=>D===this._draggedGridItem),b=d.findIndex(D=>D.state.key===h);E===-1||b===-1||(d.splice(E,1),d.splice(b,0,this._draggedGridItem),this.setState({children:d}))}_updatePanelPosition(h,d){this._setContainerStyle(v.hM,`${h}px`),this._setContainerStyle(v.PS,`${d}px`)}_updatePanelSize(h,d){this._setContainerStyle(v.MS,`${Math.floor(h)}px`),this._setContainerStyle(v.PP,`${Math.floor(d)}px`)}_resetPanelPositionAndSize(){this._removeContainerStyle(v.hM),this._removeContainerStyle(v.PS),this._removeContainerStyle(v.MS),this._removeContainerStyle(v.PP)}_setContainerStyle(h,d){this.containerRef.current?.style.setProperty(h,d)}_removeContainerStyle(h){this.containerRef.current?.style.removeProperty(h)}}},8835:(te,R,e)=>{"use strict";e.d(R,{j:()=>_,YL:()=>K,X2:()=>T,jo:()=>z,Kf:()=>A});var n=e(74848),a=e(92745),s=e(36674),i=e(95943),r=e(33143),u=e(4974),o=e(3371),l=e(1682),g=e(8285),f=e(93389),p=e(48492),c=e(25953),x=e(29425),v=e(22803),m=e(2543),y=e(96540),h=e(51898),d=e(63142),E=e(41654),b=e(37386),D=e(43243),C=e(63527),P=e(45861),M=e(21285),O=e(51156);function j(w){const H=[];return H.push(new O.v({title:(0,a.t)("dashboard-scene.get-edit-options.title.column-options","Column options"),skipField:!0,render:()=>(0,n.jsx)(U,{layoutManager:w})})),H.push(new O.v({title:(0,a.t)("dashboard-scene.get-edit-options.title.row-height-options","Row height options"),skipField:!0,render:()=>(0,n.jsx)(W,{layoutManager:w})})),H}function U({layoutManager:w}){const{maxColumnCount:H,columnWidth:Q}=w.useState(),[Z,Y]=y.useState(null),[X,I]=y.useState(!1),[J,ee]=y.useState(!1),q=(0,d.of)(B);(0,y.useEffect)(()=>{X&&Z&&(Z.focus(),I(!1))},[X,Z]);const ne=["narrow","standard","wide","custom"].map(ie=>({label:(0,m.capitalize)(ie),value:ie})),se=typeof Q=="string",oe=se?(0,a.t)("dashboard.auto-grid.options.min-width","Min column width"):(0,a.t)("dashboard.auto-grid.options.min-width-custom","Custom min width"),de=["1","2","3","4","5","6","7","8","9","10"].map(ie=>({label:ie,value:ie})),fe=ie=>{const ve=parseInt(ie.target.value,10);if(isNaN(ve)||ve<50||ve>2e3){ee(!0);return}else J&&ee(!1);w.onColumnWidthChanged(ve)},ae=ie=>{ie.value==="custom"&&I(!0),w.onColumnWidthChanged(ie.value)},ce=()=>{J&&ee(!1),w.onColumnWidthChanged("standard")};return(0,n.jsxs)(E.B,{columnGap:2,rowGap:0,wrap:!0,children:[(0,n.jsx)(b.D,{label:oe,invalid:J,error:J?(0,a.t)("dashboard.auto-grid.options.min-width-error","A number between 50 and 2000 is required"):void 0,className:q.wideSelector,children:se?(0,n.jsx)(D.G,{id:"min-column-width",options:ne,value:Q,onChange:ae,"data-testid":h.Tp.components.PanelEditor.ElementEditPane.AutoGridLayout.minColumnWidth}):(0,n.jsx)(C.p,{id:"min-column-width",defaultValue:Q,onBlur:fe,ref:ie=>Y(ie),type:"number",min:50,max:2e3,invalid:J,"data-testid":h.Tp.components.PanelEditor.ElementEditPane.AutoGridLayout.customMinColumnWidth,suffix:(0,n.jsx)(P.$n,{size:"sm",fill:"text",icon:"times",tooltip:(0,a.t)("dashboard.auto-grid.options.min-width-custom-clear","Back to standard min column width"),onClick:ce,"data-testid":h.Tp.components.PanelEditor.ElementEditPane.AutoGridLayout.clearCustomMinColumnWidth,children:(0,a.t)("dashboard.auto-grid.options.custom-min-width.clear","Clear")})})}),(0,n.jsx)(b.D,{label:(0,a.t)("dashboard.auto-grid.options.max-columns","Max columns"),className:q.narrowSelector,children:(0,n.jsx)(D.G,{id:"max-columns",options:de,value:String(H),onChange:({value:ie})=>w.onMaxColumnCountChanged(parseInt(ie,10)),width:6.5,"data-testid":h.Tp.components.PanelEditor.ElementEditPane.AutoGridLayout.maxColumns})})]})}function W({layoutManager:w}){const{rowHeight:H,fillScreen:Q}=w.useState(),[Z,Y]=y.useState(null),[X,I]=y.useState(!1),[J,ee]=y.useState(!1),q=(0,d.of)(B);(0,y.useEffect)(()=>{X&&Z&&(Z.focus(),I(!1))},[X,Z]);const ne=["short","standard","tall","custom"].map(ce=>({label:(0,m.capitalize)(ce),value:ce})),se=typeof H=="string",oe=H?(0,a.t)("dashboard.auto-grid.options.min-height","Row height"):(0,a.t)("dashboard.auto-grid.options.min-height-custom","Custom row height"),de=ce=>{const ie=parseInt(ce.target.value,10);if(isNaN(ie)||ie<50||ie>2e3){ee(!0);return}else J&&ee(!1);w.onRowHeightChanged(ie)},fe=ce=>{ce.value==="custom"&&I(!0),w.onRowHeightChanged(ce.value)},ae=()=>{J&&ee(!1),w.onRowHeightChanged("standard")};return(0,n.jsxs)(E.B,{columnGap:2,rowGap:0,wrap:!0,children:[(0,n.jsx)(b.D,{label:oe,invalid:J,error:J?(0,a.t)("dashboard.auto-grid.options.min-height-error","A number between 50 and 2000 is required"):void 0,className:q.wideSelector,children:se?(0,n.jsx)(D.G,{id:"min-height",options:ne,value:H,onChange:fe,"data-testid":h.Tp.components.PanelEditor.ElementEditPane.AutoGridLayout.rowHeight}):(0,n.jsx)(C.p,{id:"min-height",defaultValue:H,onBlur:de,ref:ce=>Y(ce),type:"number",min:50,max:2e3,invalid:J,"data-testid":h.Tp.components.PanelEditor.ElementEditPane.AutoGridLayout.customRowHeight,suffix:(0,n.jsx)(P.$n,{size:"sm",fill:"text",icon:"times",tooltip:(0,a.t)("dashboard.auto-grid.options.min-width-custom-clear","Back to standard min column width"),onClick:ae,"data-testid":h.Tp.components.PanelEditor.ElementEditPane.AutoGridLayout.clearCustomRowHeight,children:(0,a.t)("dashboard.auto-grid.options.custom-min-height.clear","Clear")})})}),(0,n.jsx)(b.D,{label:(0,a.t)("dashboard.auto-grid.options.height-fill","Fill screen"),className:q.narrowSelector,children:(0,n.jsx)(M.K,{id:"fill-screen-toggle",value:Q,onChange:()=>w.onFillScreenChanged(!Q),"data-testid":h.Tp.components.PanelEditor.ElementEditPane.AutoGridLayout.fillScreen})})]})}const B=w=>({wideSelector:(0,v.css)({minWidth:w.spacing(14),flex:`1 1 ${w.spacing(14)}`}),narrowSelector:(0,v.css)({width:w.spacing(10)})}),S=3,_="standard",K="standard";class T extends s.Bs{constructor(H){const Q=H.maxColumnCount??S,Z=H.columnWidth??_,Y=H.rowHeight??K,X=H.fillScreen??!1;super({...H,maxColumnCount:Q,columnWidth:Z,rowHeight:Y,fillScreen:X,layout:H.layout??new x.o({isDraggable:!0,templateColumns:A(Q,Z),autoRows:z(Y,X)})}),this.isDashboardLayoutManager=!0,this.descriptor=T.descriptor}static{this.Component=L}static{this.descriptor={get name(){return(0,a.t)("dashboard.auto-grid.name","Auto grid")},get description(){return(0,a.t)("dashboard.auto-grid.description","Panels resize to fit and form uniform grids")},id:"AutoGridLayout",createFromLayout:T.createFromLayout,isGridLayout:!0,icon:"apps"}}serialize(){return(0,u.K4)(this)}getOutlineChildren(){return this.state.layout.state.children.map(Q=>Q.state.body)}addPanel(H){const Q=l.b4.getNextPanelId(this);H.setState({key:(0,g.XA)(Q)}),H.clearParent();const Z=new c.X({body:H});r.cc.addElement({addedObject:H,source:this,perform:()=>{this.state.layout.setState({children:[...this.state.layout.state.children,Z]})},undo:()=>{this.state.layout.setState({children:this.state.layout.state.children.filter(Y=>Y!==Z)})}})}pastePanel(){const H=(0,p.dp)((0,g.YQ)(this));this.state.layout.setState({children:[...this.state.layout.state.children,H]}),this.publishEvent(new r.jO(H),!0),(0,p.G2)()}removePanel(H){const Q=H.parent;if(!(Q instanceof c.X))return;const Z=this.state.layout.state.children.indexOf(Q);r.cc.removeElement({removedObject:H,source:this,perform:()=>{this.state.layout.setState({children:this.state.layout.state.children.filter(Y=>Y!==Q)})},undo:()=>{this.state.layout.setState({children:[...this.state.layout.state.children.slice(0,Z),Q,...this.state.layout.state.children.slice(Z)]})}})}duplicate(){const H=this.state.layout.state.children,Q=[];if(H.length){let Z=l.b4.getNextPanelId(H[0].state.body);H.forEach(Y=>{const X=Y.clone({key:void 0,body:Y.state.body.clone({key:(0,g.XA)(Z)})});Q.push(X),Z++})}return this.clone({key:void 0,layout:this.state.layout.clone({key:void 0,children:Q})})}duplicatePanel(H){const Q=H.parent;if(!(Q instanceof c.X)){console.error("Trying to duplicate a panel that is not inside a DashboardGridItem");return}const Z=l.b4.getNextPanelId(this),Y=this.state.layout,X=H.clone({key:(0,g.XA)(Z)}),I=Q.clone({key:(0,g.ty)(Z),body:X}),J=Y.state.children.indexOf(Q),ee=[...Y.state.children];ee.splice(J+1,0,I),Y.setState({children:ee}),this.publishEvent(new r.jO(X),!0)}getVizPanels(){const H=[];for(const Q of this.state.layout.state.children)Q instanceof c.X&&H.push(Q.state.body);return H}editModeChanged(H){this.state.layout.setState({isDraggable:H}),(0,g.X0)(this.state.layout,!0)}cloneLayout(H,Q){return this.clone({layout:this.state.layout.clone({isDraggable:Q&&this.state.layout.state.isDraggable,children:this.state.layout.state.children.map(Z=>{if(Z instanceof c.X){const Y=(0,g.Cs)(Z.state.body),X=(0,o.ed)(H,(0,g.ty)(Y));return Z.clone({key:X,body:Z.state.body.clone({key:(0,o.ed)(X,(0,g.XA)(Y))})})}throw new Error("Unexpected child type")})})})}getOptions(){return j(this)}onMaxColumnCountChanged(H){this.setState({maxColumnCount:H}),this.state.layout.setState({templateColumns:A(H,this.state.columnWidth)})}onColumnWidthChanged(H){H==="custom"&&(H=N(this.state.columnWidth)),this.setState({columnWidth:H}),this.state.layout.setState({templateColumns:A(this.state.maxColumnCount,this.state.columnWidth)})}onFillScreenChanged(H){this.setState({fillScreen:H}),this.state.layout.setState({autoRows:z(this.state.rowHeight,H)})}onRowHeightChanged(H){H==="custom"&&(H=V(this.state.rowHeight)),this.setState({rowHeight:H}),this.state.layout.setState({autoRows:z(H,this.state.fillScreen)})}static createEmpty(){return new T({})}static createFromLayout(H){const Q=H.getVizPanels(),Z=[];for(let X of Q){const I=X.parent instanceof f.U?X.parent.state.variableName:void 0;Z.push(new c.X({body:X.clone(),variableName:I}))}const Y=T.createEmpty();return Y.state.layout.setState({children:Z,isDraggable:(0,g.YQ)(H).state.isEditing}),Y}}function L({model:w}){return(0,n.jsx)(w.state.layout.Component,{model:w.state.layout})}function A(w,H){return`repeat(auto-fit, minmax(min(max(100% / ${w} - ${i.dU}px, ${N(H)}px), 100%), 1fr))`}function N(w){if(typeof w=="number")return w;switch(w){case"narrow":return 192;case"wide":return 768;case"custom":case"standard":default:return 448}}function V(w){if(typeof w=="number")return w;switch(w){case"short":return 168;case"tall":return 512;case"custom":case"standard":default:return 320}}function z(w,H){const Q=V(w),Z=H?"auto":`${Q}px`;return`minmax(${Q}px, ${Z})`}},39242:(te,R,e)=>{"use strict";e.d(R,{MS:()=>s,PP:()=>i,PS:()=>a,hM:()=>n});const n="--responsive-grid-dragged-item-top",a="--responsive-grid-dragged-item-left",s="--responsive-grid-dragged-item-width",i="--responsive-grid-dragged-item-height"},93389:(te,R,e)=>{"use strict";e.d(R,{U:()=>U});var n=e(2543),a=e(96540),s=e(36674),i=e(95943),r=e(3371),u=e(8285),o=e(41667),l=e(39765),g=e(74848),f=e(92745),p=e(77824),c=e(18857),x=e(25797),v=e(51156),m=e(31819),y=e(33143);function h(W){return[new x.C({title:(0,f.t)("dashboard.default-layout.item-options.repeat.title","Repeat options"),id:"Repeat options",isOpenDefault:!1}).addItem(new v.v({title:(0,f.t)("dashboard.default-layout.item-options.repeat.variable.title","Repeat by variable"),id:"repeat-by-variable-select",description:(0,f.t)("dashboard.default-layout.item-options.repeat.variable.description","Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard."),render:S=>(0,g.jsx)(b,{id:S.props.id,gridItem:W})})).addItem(new v.v({title:(0,f.t)("dashboard.default-layout.item-options.repeat.direction.title","Repeat direction"),useShowIf:()=>{const{variableName:S}=W.useState();return!!S},render:()=>(0,g.jsx)(d,{gridItem:W})})).addItem(new v.v({title:(0,f.t)("dashboard.default-layout.item-options.repeat.max","Max per row"),useShowIf:()=>{const{variableName:S,repeatDirection:_}=W.useState();return!!S&&_==="h"},render:()=>(0,g.jsx)(E,{gridItem:W})}))]}function d({gridItem:W}){const{repeatDirection:B}=W.useState(),S=[{label:(0,f.t)("dashboard.default-layout.item-options.repeat.direction.horizontal","Horizontal"),value:"h"},{label:(0,f.t)("dashboard.default-layout.item-options.repeat.direction.vertical","Vertical"),value:"v"}];return(0,g.jsx)(p.z,{options:S,value:B??"h",onChange:_=>{y.cc.edit({description:(0,f.t)("dashboard.edit-actions.panel-repeat-direction","Repeat direction"),source:W,perform:()=>W.setRepeatDirection(_),undo:()=>W.setRepeatDirection(B??"h")})}})}function E({gridItem:W}){const{maxPerRow:B}=W.useState(),S=[2,3,4,6,8,12].map(_=>({label:_.toString(),value:_}));return(0,g.jsx)(c.l6,{options:S,value:B??4,onChange:_=>{y.cc.edit({description:(0,f.t)("dashboard.edit-actions.panel-max-repeats-per-row","Max repeats per row"),source:W,perform:()=>W.setMaxPerRow(_.value),undo:()=>W.setMaxPerRow(B??4)})}})}function b({gridItem:W,id:B}){const{variableName:S,width:_}=W.useState(),K=(0,a.useCallback)(L=>{W.setRepeatByVariable(L),W.handleVariableName(),_!==24&&(W.setState({width:24}),s.jh.getAncestor(W,s.hy).forceRender())},[W,_]),T=(0,a.useCallback)(L=>{L!==S&&y.cc.edit({description:(0,f.t)("dashboard.edit-actions.panel-repeat-variable","Panel repeat by"),source:W,perform:()=>K(L),undo:()=>K(S)})},[W,K,S]);return(0,g.jsx)(m.U,{id:B,sceneContext:W,repeat:S,onChange:T})}var D=e(22803),C=e(43173);function P({model:W}){const{repeatedPanels:B,itemHeight:S,variableName:_,body:K}=W.useState(),T=B?.length??0,L=M(W.getRepeatDirection(),T,W.getMaxPerRow(),S??10);return!_&&K instanceof s.Eb?(0,g.jsx)("div",{className:O,ref:W.containerRef,children:(0,g.jsx)(K.Component,{model:K},K.state.key)}):B?(0,g.jsx)("div",{className:L,ref:W.containerRef,children:B.map(A=>(0,g.jsx)("div",{className:O,children:(0,g.jsx)(A.Component,{model:A},A.state.key)},A.state.key))}):null}function M(W,B,S,_){return(0,a.useMemo)(()=>{const K=C.$.theme2,T=_*i.sD*B+(B-1)*i.dU;if(W==="h"){const L=Math.ceil(B/S),A=Math.min(B,S);return(0,D.css)({display:"grid",height:"100%",width:"100%",gridTemplateColumns:`repeat(${A}, 1fr)`,gridTemplateRows:`repeat(${L}, 1fr)`,gridColumnGap:K.spacing(1),gridRowGap:K.spacing(1),[K.breakpoints.down("md")]:{display:"flex",flexDirection:"column",height:T}})}return(0,D.css)({display:"flex",height:"100%",width:"100%",flexDirection:"column",gap:K.spacing(1),[K.breakpoints.down("md")]:{height:T}})},[W,B,S,_])}const O=(0,D.css)({display:"flex",flexGrow:1,position:"relative",width:"100%",height:"100%"});class j{constructor(B){this._gridItem=B}getNames(){return this._gridItem.state.variableName?new Set([this._gridItem.state.variableName]):new Set}hasDependencyOn(B){return this._gridItem.state.variableName===B}variableUpdateCompleted(B){this._gridItem.state.variableName===B.state.name&&this._gridItem.performRepeat()}}class U extends s.Bs{constructor(B){super(B),this._variableDependency=new j(this),this.isDashboardLayoutItem=!0,this.containerRef=a.createRef(),this.addActivationHandler(()=>this._activationHandler())}static{this.Component=P}_activationHandler(){return this.handleVariableName(),()=>{this._handleGridSizeUnsubscribe()}}_handleGridSizeSubscribe(){this._gridSizeSub||(this._gridSizeSub=this.subscribeToState((B,S)=>this._handleGridResize(B,S)))}_handleGridSizeUnsubscribe(){this._gridSizeSub&&(this._gridSizeSub.unsubscribe(),this._gridSizeSub=void 0)}_handleGridResize(B,S){if(B.height===S.height)return;const _=this.state.repeatedPanels?.length??1,K={};if(this.getRepeatDirection()==="v")K.itemHeight=Math.ceil(B.height/_);else{const T=Math.ceil(_/this.getMaxPerRow());K.itemHeight=Math.ceil(B.height/T)}K.itemHeight!==this.state.itemHeight&&this.setState(K)}getClassName(){return this.state.variableName?"panel-repeater-grid-item":""}getOptions(){return h(this)}setElementBody(B){this.setState({body:B})}editingStarted(){this.state.variableName&&(this.state.repeatedPanels?.length??!1)&&this.state.body.setState({$variables:this.state.repeatedPanels[0].state.$variables?.clone(),$data:this.state.repeatedPanels[0].state.$data?.clone()})}editingCompleted(B){B&&(this._prevRepeatValues=void 0),this.state.variableName&&this.state.repeatDirection==="h"&&this.state.width!==i.cV&&this.setState({width:i.cV})}performRepeat(){if(!this.state.variableName||s.jh.hasVariableDependencyInLoadingState(this))return;const B=s.jh.lookupVariable(this.state.variableName,this)??new s.yP({name:"_____default_sys_repeat_var_____",options:[],value:"",text:"",query:"A"});if(!(B instanceof s.n8)){console.error("DashboardGridItem: Variable is not a MultiValueVariable");return}const{values:S,texts:_}=(0,u.a7)(B);if((0,n.isEqual)(this._prevRepeatValues,S))return;const K=this.state.body,T=[],L={values:[""],texts:B.hasAllValue()?["All"]:["None"]},A=S.length?S:L.values,N=_.length?_:L.texts;for(let Z=0;Z<A.length;Z++){const Y={$variables:new s.Pj({variables:[new s.xc({name:B.state.name,value:A[Z],text:String(N[Z]),isMulti:B.state.isMulti,includeAll:B.state.includeAll})]}),key:(0,r.lv)(K.state.key,Z)},X=K.clone(Y);T.push(X)}const V=this.getRepeatDirection(),z={repeatedPanels:T},w=this.state.itemHeight??10,H=this.state.height,Q=this.getMaxPerRow();if(V==="h"){const Z=Math.ceil(T.length/Q);z.height=Z*w}else z.height=T.length*w;if(this.setState(z),H!==this.state.height){const Z=s.jh.getLayout(this);Z instanceof s.hy&&Z.forceRender()}this._prevRepeatValues=S,this.publishEvent(new l.d({source:this}),!0)}handleVariableName(){this.state.variableName?this._handleGridSizeSubscribe():this._handleGridSizeUnsubscribe(),this.performRepeat()}setRepeatByVariable(B){const S={variableName:B};B&&!this.state.repeatDirection&&(S.repeatDirection="h"),this.state.body.state.$variables&&this.state.body.setState({$variables:void 0}),this.setState(S)}getMaxPerRow(){return this.state.maxPerRow??4}setMaxPerRow(B){this.setState({maxPerRow:B})}getRepeatDirection(){return this.state.repeatDirection==="v"?"v":"h"}setRepeatDirection(B){this.setState({repeatDirection:B})}isRepeated(){return this.state.variableName!==void 0}scrollIntoView(){const B=document.querySelector(`[data-griditem-key="${this.state.key}"`);B instanceof HTMLElement?(0,o.R)(B):(0,o.d)(this,this.containerRef)}}},1131:(te,R,e)=>{"use strict";e.d(R,{D:()=>U});var n=e(74848),a=e(22803),s=e(92745),i=e(43173),r=e(36674),u=e(63142),o=e(95943),l=e(84403),g=e(33143),f=e(17340),p=e(3371),c=e(1682),x=e(8285),v=e(25953),m=e(6607),y=e(48492),h=e(1837),d=e(93389),E=e(87308);const b=8,D=6,C=12,P=8;function M(S){const _=new Set;let K=0;function T(L){for(let A=0;A<L.state.width;A++)for(let N=0;N<L.state.height;N++){const V=`${L.state.x+A},${L.state.y+N}`;_.add(V),L.state.y+L.state.height>K&&(K=L.state.y+L.state.height)}}for(const L of S.state.children)if(T(L),L instanceof r.tI)for(const A of L.state.children)T(A);for(let L=0;L<1/0;L++){for(let A=0;A<=o.cV-b;A++){let N=!0;for(let V=0;V<b;V++){for(let z=0;z<D;z++){const w=`${A+V},${L+z}`;if(_.has(w)){N=!1;break}}if(!N)break}if(N)return O(_,{x:A,y:L,width:b,height:D},K)}if(L>K+D)break}return{x:0,y:K,width:C,height:P}}function O(S,_,K){if(_.y>=K)return _.width=C,_.height=P,_;for(let T=_.x+_.width+1;T<=o.cV;T++){let L=!0;for(let A=_.y;A<_.y+_.height;A++){const N=`${T},${A}`;if(S.has(N)){L=!1;break}}if(L)_.width=T-_.x;else break}for(let T=_.y+_.height+1;T<=K;T++){let L=!0;if(_.height>=20)break;for(let A=_.x;A<_.x+_.width;A++){const N=`${A},${T}`;if(S.has(N)){L=!1;break}}if(L)_.height=T-_.y;else break}return _}var j=e(18178);class U extends r.Bs{constructor(_){super(_),this.isDashboardLayoutManager=!0,this.descriptor=U.descriptor,this.addActivationHandler(()=>this._activationHandler())}static{this.Component=W}static{this.descriptor={get name(){return(0,s.t)("dashboard.default-layout.name","Custom")},get description(){return(0,s.t)("dashboard.default-layout.description","Position and size each panel individually")},id:"GridLayout",createFromLayout:U.createFromLayout,isGridLayout:!0,icon:"window-grid"}}serialize(){return(0,f.SW)(this)}_activationHandler(){i.$.featureToggles.dashboardNewLayouts&&this._subs.add(this.subscribeToEvent(r.V$,({payload:{evt:_,panel:K}})=>(0,x.wP)(this)?.startDraggingSync(_,K))),this._subs.add(this.state.grid.subscribeToState(({children:_},{children:K})=>{_.length===K.length&&this.publishEvent(new g.su(this.state.grid),!0)}))}addPanel(_){const K=c.b4.getNextPanelId(this);if(_.setState({key:(0,x.XA)(K)}),_.clearParent(),i.$.featureToggles.dashboardNewLayouts){const T=M(this.state.grid),L=new d.U({...T,body:_,key:(0,x.ty)(K)});g.cc.addElement({addedObject:_,source:this,perform:()=>{this.state.grid.setState({children:[...this.state.grid.state.children,L]})},undo:()=>{this.state.grid.setState({children:this.state.grid.state.children.filter(A=>A!==L)})}})}else{const T=new d.U({height:x.sw,width:x.vm,x:0,y:0,body:_,key:(0,x.ty)(K)});this.state.grid.setState({children:[T,...this.state.grid.state.children]})}}pastePanel(){const _=M(this.state.grid),K=(0,y.qY)((0,x.YQ)(this),_);i.$.featureToggles.dashboardNewLayouts?g.cc.edit({description:(0,s.t)("dashboard.edit-actions.paste-panel","Paste panel"),addedObject:K.state.body,source:this,perform:()=>{this.state.grid.setState({children:[...this.state.grid.state.children,K]})},undo:()=>{this.state.grid.setState({children:this.state.grid.state.children.filter(T=>T!==K)})}}):this.state.grid.setState({children:[...this.state.grid.state.children,K]}),(0,y.G2)()}removePanel(_){const K=_.parent;if(!(K instanceof d.U))throw new Error("Trying to remove panel that is not inside a DashboardGridItem");const T=this.state.grid;let L;try{L=r.jh.getAncestor(K,r.tI)}catch{L=void 0}if(L){L.setState({children:L.state.children.filter(A=>A!==K)}),T.forceRender();return}if(!i.$.featureToggles.dashboardNewLayouts){T.setState({children:T.state.children.filter(A=>A!==K)});return}g.cc.removeElement({removedObject:K.state.body,source:this,perform:()=>T.setState({children:T.state.children.filter(A=>A!==K)}),undo:()=>T.setState({children:[...T.state.children,K]})})}duplicatePanel(_){const K=_.parent;if(!(K instanceof d.U)){console.error("Trying to duplicate a panel that is not inside a DashboardGridItem");return}let T,L,A;const N=c.b4.getNextPanelId(this),V=this.state.grid;K instanceof d.U?(T=r.Go.cloneSceneObjectState(K.state.body.state),L=r.jh.getData(K.state.body).clone()):(T=r.Go.cloneSceneObjectState(_.state),L=r.jh.getData(_).clone()),delete L.state.data?.alertState;const z=new r.Eb({...T,$data:L,key:(0,x.XA)(N)});if(A=new d.U({x:K.state.x,y:K.state.y,height:K.state.height,itemHeight:K.state.height,width:K.state.width,variableName:K.state.variableName,repeatDirection:K.state.repeatDirection,maxPerRow:K.state.maxPerRow,key:(0,x.ty)(N),body:z}),K.parent instanceof r.tI){const w=K.parent;w.setState({children:[...w.state.children,A]}),V.forceRender();return}V.setState({children:[...V.state.children,A]}),this.publishEvent(new g.jO(z),!0)}duplicate(){const _=this.state.grid.state.children,K=_.find(A=>A instanceof d.U),T=[];if(_.length){let A=K?c.b4.getNextPanelId(K.state.body):1;_.forEach(N=>{if(N instanceof d.U){const V=N.clone({key:void 0,body:N.state.body.clone({key:(0,x.XA)(A)})});T.push(V),A++}else T.push(N.clone({key:void 0}))})}return this.clone({key:void 0,grid:this.state.grid.clone({key:void 0,children:T})})}getVizPanels(){const _=[];return this.state.grid.forEachChild(K=>{if(!(K instanceof d.U)&&!(K instanceof r.tI))throw new Error("Child is not a DashboardGridItem or SceneGridRow, invalid scene");K instanceof d.U&&K.state.body instanceof r.Eb?_.push(K.state.body):K instanceof r.tI&&K.forEachChild(T=>{T instanceof d.U&&T.state.body instanceof r.Eb&&_.push(T.state.body)})}),_}addNewRow(){const _=c.b4.getNextPanelId(this),K=new r.tI({key:(0,x.XA)(_),title:(0,s.t)("dashboard-scene.default-grid-layout-manager.row.title.row-title","Row title"),actions:new j.u({}),y:0}),T=this.state.grid,L=T.state.children.findIndex(N=>N instanceof r.tI),A=T.state.children.splice(0,L===-1?T.state.children.length:L).map(N=>N.clone());return A&&K.setState({children:A}),T.setState({children:[K,...T.state.children]}),this.publishEvent(new g.jO(K),!0),K}editModeChanged(_){const K=()=>{this.state.grid.setState({isDraggable:_,isResizable:_}),(0,x.X0)(this.state.grid,!0)};if(i.$.featureToggles.dashboardNewLayouts){setTimeout(K,10);return}K()}activateRepeaters(){this.isActive||this.activate(),this.state.grid.isActive||this.state.grid.activate(),this.state.grid.forEachChild(_=>{if(_ instanceof d.U&&!_.isActive){_.activate();return}if(_ instanceof r.tI&&_.state.$behaviors){for(const K of _.state.$behaviors)if(K instanceof E.L&&!_.isActive){_.activate();break}_.state.children.forEach(K=>{if(K instanceof d.U&&!K.isActive){K.activate();return}})}})}getOutlineChildren(){const _=[];for(const K of this.state.grid.state.children)K instanceof d.U&&(K.state.repeatedPanels?_.push(...K.state.repeatedPanels):_.push(K.state.body));return _}cloneLayout(_,K){return this.clone({grid:this.state.grid.clone({isResizable:K&&this.state.grid.state.isResizable,isDraggable:K&&this.state.grid.state.isDraggable,children:this.state.grid.state.children.reduce((T,L)=>{if(L instanceof d.U){const A=(0,p.ed)(_,(0,x.ty)(T.panelId)),N=L.clone({key:A,body:L.state.body.clone({key:(0,p.ed)(A,(0,x.XA)(T.panelId++))}),isDraggable:K&&L.state.isDraggable,isResizable:K&&L.state.isResizable});return T.children.push(N),T}if(L instanceof r.tI){const A=(0,p.ed)(_,(0,x.XA)(T.panelId++)),N=L.clone({key:A,children:L.state.children.reduce((V,z)=>{if((0,p.Ry)(z.state.key))return V;if(!(z instanceof d.U))return V.push(z.clone()),V;const w=(0,p.ed)(A,(0,x.ty)(T.panelId)),H=z.clone({key:w,isDraggable:K&&z.state.isDraggable,isResizable:K&&z.state.isResizable,body:z.state.body.clone({key:(0,p.ed)(w,(0,x.XA)(T.panelId++))})});return V.push(H),V},[]),isDraggable:K&&L.state.isDraggable,isResizable:K&&L.state.isResizable});return T.children.push(N),T}return T.children.push(L.clone()),T},{panelId:0,children:[]}).children})})}removeRow(_,K=!1){const T=this.state.grid,L=T.state.children.filter(A=>A.state.key!==_.state.key);if(!K){const A=_.state.children.map(V=>V.clone()),N=T.state.children.findIndex(V=>V.state.key===_.state.key);L.splice(N,0,...A)}this.publishEvent(new g.ck(_),!0),T.setState({children:L})}collapseAllRows(){this.state.grid.state.children.forEach(_=>{_ instanceof r.tI&&(_.state.isCollapsed||this.state.grid.toggleRow(_))})}expandAllRows(){this.state.grid.state.children.forEach(_=>{_ instanceof r.tI&&_.state.isCollapsed&&this.state.grid.toggleRow(_)})}static createFromLayout(_){const K=_.getVizPanels();return U.fromVizPanels(K)}static fromVizPanels(_=[]){const K=[],L=o.cV/3;let A=0,N=0;for(let V of _){const z=V.parent instanceof v.X?V.parent.state.variableName:void 0;V.clearParent(),K.push(new d.U({key:(0,x.ty)((0,x.Cs)(V)),x:N,y:A,width:L,height:10,itemHeight:10,body:V,variableName:z})),N+=L,N+L>o.cV&&(N=0,A+=10)}return new U({grid:new r.hy({children:K,isDraggable:!0,isResizable:!0})})}static fromGridItems(_,K,T){const L=_.reduce((A,N)=>(N.clearParent(),A.push(N),A),[]);return new U({grid:new r.hy({children:L,isDraggable:K,isResizable:T})})}}function W({model:S}){const{children:_}=(0,r.gn)(S.state.grid,{shouldActivateOrKeepAlive:!0}),K=(0,x.MZ)(S),{isEditing:T}=K.useState(),L=(0,p.Qp)(S),A=(0,u.of)(B),N=T&&i.$.featureToggles.dashboardNewLayouts&&!L;return S.parent===K&&_.length===0?(0,n.jsx)(l.A,{dashboard:K,canCreate:!!K.state.meta.canEdit},"dashboard-empty-state"):(0,n.jsxs)("div",{className:(0,a.cx)(A.container,T&&A.containerEditing),children:[S.state.grid.Component&&(0,n.jsx)(S.state.grid.Component,{model:S.state.grid}),N&&(0,n.jsx)("div",{className:A.actionsWrapper,children:(0,n.jsx)(m.f,{layoutManager:S})})]})}function B(S){return{container:(0,a.css)({width:"100%",display:"flex",flexGrow:1,flexDirection:"column"}),containerEditing:(0,a.css)({"> div:first-child":{flexGrow:"0 !important",minHeight:"250px"},...h.u}),actionsWrapper:(0,a.css)({position:"relative",paddingBottom:S.spacing(5)})}}},87308:(te,R,e)=>{"use strict";e.d(R,{L:()=>o});var n=e(2543),a=e.n(n),s=e(36674),i=e(3371),r=e(8285),u=e(39765);class o extends s.Bs{constructor(x){super(x),this._variableDependency=new s.Sh(this,{variableNames:[this.state.variableName],onVariableUpdateCompleted:()=>this.performRepeat()}),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this.performRepeat();const x=this._getLayout(),v=this._getRow(),m=v.state.children.filter(h=>!(0,i.Ry)(h.state.key)),y=x.subscribeToState(()=>{const h=x.state.children.filter(d=>(0,i.oX)(d.state.key,v.state.key));for(const d of h){if(!(d instanceof s.tI))continue;const E=d.state.children.filter(D=>!(0,i.Ry)(D.state.key));if(E.length===m.length)continue;const b=E.find(D=>!(0,i.ag)(D.state.key));if(b){const D=b.clone();if(d.setState({children:d.state.children.filter(C=>C!==b)}),v.state.children.find(C=>C.state.key===D.state.key))return;v.setState({children:[...v.state.children,D]}),this.performRepeat(!0)}}});return()=>{y.unsubscribe()}}_getRow(){if(!(this.parent instanceof s.tI))throw new Error("RepeatedRowBehavior: Parent is not a SceneGridRow");return this.parent}_getLayout(){const x=s.jh.getLayout(this);if(!(x instanceof s.hy))throw new Error("RepeatedRowBehavior: Layout is not a SceneGridLayout");return x}performRepeat(x=!1){if(this._variableDependency.hasDependencyInLoadingState())return;const v=s.jh.lookupVariable(this.state.variableName,this.parent?.parent);if(!v){console.error("RepeatedRowBehavior: Variable not found");return}if(!(v instanceof s.n8)){console.error("RepeatedRowBehavior: Variable is not a MultiValueVariable");return}const m=this._getRow(),y=this._getLayout(),{values:h,texts:d}=(0,r.a7)(v);if((0,n.isEqual)(this._prevRepeatValues,h)&&!x)return;this._prevRepeatValues=h,this._clonedRows=[];const E=m.state.children,b=l(E);let D=0;const C={values:[""],texts:v.hasAllValue()?["All"]:["None"]},P=h.length?h:C.values,M=d.length?d:C.texts;for(let O=0;O<P.length;O++){const U=O===0?m:m.clone({y:(m.state.y??0)+b*O+O,$behaviors:[],actions:void 0}),W=(0,i.lv)(m.state.key,O);U.setState({key:W,$variables:new s.Pj({variables:[new s.xc({name:this.state.variableName,value:P[O],text:String(M[O]),isMulti:v.state.isMulti,includeAll:v.state.includeAll})]}),children:[]});const B=[];for(const S of E){const _=S.state.y??0,K=(0,i.ed)(W,(0,i.Dq)(S.state.key)),T=_+(b+1)*O,L=O>0?S.clone({isDraggable:!1,isResizable:!1}):S;L.setState({key:K,y:T}),O>0&&p(L,K),B.push(L),D<T+L.state.height&&(D=T+L.state.height)}U.setState({children:B}),this._clonedRows.push(U)}g(y,this._clonedRows,D,m.state.key),this.publishEvent(new u.d({source:this}),!0)}removeBehavior(){const x=this._getRow(),v=this._getLayout(),m=f(v,x.state.key);v.setState({children:m}),x.setState({$behaviors:x.state.$behaviors.filter(y=>y!==this),$variables:void 0})}}function l(c){let x=0,v=Number.MAX_VALUE;if(c.length===0)return 0;for(const m of c)m.state.y+m.state.height>x&&(x=m.state.y+m.state.height),m.state.y<v&&(v=m.state.y);return x-v}function g(c,x,v,m){const y=f(c,m),h=y.findIndex(E=>E instanceof s.tI&&(0,i.d9)(E.state.key)===(0,i.d9)(m));if(h===-1)throw new Error("RowRepeaterBehavior: Parent row not found in layout children");const d=[...y.slice(0,h),...x,...y.slice(h+1)];if(y.length>h+1){const E=y.slice(h+1),b=E[0].state.y,D=v-b;for(const C of E)if(C.setState({y:C.state.y+D}),C instanceof s.tI)for(const P of C.state.children)P.setState({y:P.state.y+D})}c.setState({children:d})}function f(c,x){return c.state.children.filter(v=>!(v instanceof s.tI)||!(0,i.oX)((0,i.Dq)(v.state.key),x))}function p(c,x){c.forEachChild(v=>{const m=(0,i.ed)(x,v.state.key);v.setState({key:m}),p(v,m)})}},18178:(te,R,e)=>{"use strict";e.d(R,{u:()=>K});var n=e(92745),a=e(36674),s=e(45229),i=e(87745),r=e(1131),u=e(87308),o=e(74848),l=e(22803),g=e(96540),f=e(63142),p=e(30703),c=e(9931),x=e(18615),v=e(8285),m=e(93389),y=e(8515),h=e(22787),d=e(49785),E=e(51898),b=e(37386),D=e(63527),C=e(34999),P=e(89640),M=e(45861),O=e(31819);const j=({repeat:T,title:L,sceneContext:A,isUsingDashboardDS:N,onUpdate:V,onCancel:z})=>{const[w,H]=(0,g.useState)(T),Q=(0,g.useCallback)(I=>H(I),[H]),{handleSubmit:Z,register:Y}=(0,d.mN)({defaultValues:{title:L}}),X=I=>{V(I.title,w)};return(0,o.jsxs)("form",{onSubmit:Z(X),children:[(0,o.jsx)(b.D,{label:(0,n.t)("dashboard.default-layout.row-options.form.title","Title"),children:(0,o.jsx)(D.p,{...Y("title"),type:"text"})}),(0,o.jsx)(b.D,{label:(0,n.t)("dashboard.default-layout.row-options.form.repeat-for.label","Repeat for"),children:(0,o.jsx)(O.U,{sceneContext:A,repeat:w,onChange:Q})}),N&&(0,o.jsx)(C.F,{"data-testid":E.Tp.pages.Dashboard.Rows.Repeated.ConfigSection.warningMessage,severity:"warning",title:"",topSpacing:3,bottomSpacing:0,children:(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{children:(0,o.jsxs)(n.x6,{i18nKey:"dashboard.default-layout.row-options.form.repeat-for.warning.text",children:["Panels in this row use the ",{SHARED_DASHBOARD_QUERY:c.K}," data source. These panels will reference the panel in the original row, not the ones in the repeated rows."]})}),(0,o.jsx)(P.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/create-dashboard/#configure-repeating-rows",children:(0,o.jsx)(n.x6,{i18nKey:"dashboard.default-layout.row-options.form.repeat-for.learn-more",children:"Learn more"})})]})}),(0,o.jsxs)(h.a.ButtonRow,{children:[(0,o.jsx)(M.$n,{type:"button",variant:"secondary",onClick:z,fill:"outline",children:(0,o.jsx)(n.x6,{i18nKey:"dashboard.default-layout.row-options.form.cancel",children:"Cancel"})}),(0,o.jsx)(M.$n,{type:"submit",children:(0,o.jsx)(n.x6,{i18nKey:"dashboard.default-layout.row-options.form.update",children:"Update"})})]})]})},U=({repeat:T,title:L,parent:A,onDismiss:N,onUpdate:V,isUsingDashboardDS:z})=>{const w=(0,f.of)(W);return(0,o.jsx)(h.a,{isOpen:!0,title:(0,n.t)("dashboard.default-layout.row-options.modal.title","Row options"),onDismiss:N,className:w.modal,children:(0,o.jsx)(j,{sceneContext:A,repeat:T,title:L,onCancel:N,onUpdate:V,isUsingDashboardDS:z})})},W=()=>({modal:(0,l.css)({label:"RowOptionsModal",width:"500px"})}),B=({repeat:T,title:L,parent:A,onUpdate:N,isUsingDashboardDS:V})=>(0,o.jsx)(y.$s,{children:({showModal:z,hideModal:w})=>(0,o.jsx)("button",{type:"button",className:"pointer","aria-label":(0,n.t)("dashboard.default-layout.row-options.button.label","Row options"),onClick:()=>{z(U,{title:L,repeat:T,parent:A,onDismiss:w,onUpdate:(H,Q)=>{N(H,Q),w()},isUsingDashboardDS:V})},children:(0,o.jsx)(p.I,{name:"cog"})})});B.displayName="RowOptionsButton";function S({model:T}){const L=T.getParent(),{title:A,children:N}=L.useState(),V=(0,v.MZ)(T),{meta:z,isEditing:w}=(0,v.TN)(T),H=(0,f.of)(_),Q=(0,g.useMemo)(()=>N.some(Y=>{if(!(Y instanceof m.U))return!1;if(Y.state.body instanceof a.Eb){const X=(0,v.un)(Y.state.body);return X?.state.datasource?.uid===c.K||X?.state.datasource?.uid===x.uv&&X?.state.queries.some(I=>I.datasource?.uid===c.K)}return!1}),[N]),Z=L.state.$behaviors?.find(Y=>Y instanceof u.L);return(0,o.jsx)(o.Fragment,{children:z.canEdit&&w&&(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:H.rowActions,children:[(0,o.jsx)(B,{title:A,repeat:Z instanceof u.L?Z.state.variableName:void 0,parent:V,onUpdate:(Y,X)=>T.onUpdate(Y,X),isUsingDashboardDS:Q}),(0,o.jsx)("button",{type:"button",onClick:()=>T.onDelete(),"aria-label":(0,n.t)("dashboard.default-layout.row-actions.delete","Delete row"),children:(0,o.jsx)(p.I,{name:"trash-alt"})})]})})})}const _=T=>({rowActions:(0,l.css)({color:T.colors.text.secondary,lineHeight:"27px",button:{color:T.colors.text.secondary,paddingLeft:T.spacing(2),background:"transparent",border:"none","&:hover":{color:T.colors.text.maxContrast}}})});class K extends a.Bs{static{this.Component=S}getParent(){if(!(this.parent instanceof a.tI))throw new Error("RowActions must have a SceneGridRow parent");return this.parent}removeRow(L){a.jh.getAncestor(this,r.D).removeRow(this.getParent(),L)}onUpdate(L,A){const N=this.getParent();let V;if(N.state.$behaviors)for(let z of N.state.$behaviors)z instanceof u.L&&(V=z);L!==N.state.title&&N.setState({title:L}),A?(V&&V.removeBehavior(),V=new u.L({variableName:A}),N.setState({$behaviors:[...N.state.$behaviors??[],V]})):V?.removeBehavior()}onDelete(){s.A.publish(new i.bY({title:(0,n.t)("dashboard.default-layout.row-actions.modal.title","Delete row"),text:(0,n.t)("dashboard.default-layout.row-actions.modal.text","Are you sure you want to remove this row and all its panels?"),altActionText:(0,n.t)("dashboard.default-layout.row-actions.modal.alt-action","Delete row only"),icon:"trash-alt",onConfirm:()=>this.removeRow(!0),onAltAction:()=>this.removeRow()}))}}},97335:(te,R,e)=>{"use strict";e.d(R,{o:()=>ae});var n=e(96540),a=e(92745),s=e(36674),i=e(45229),r=e(95943),u=e(29043),o=e(77197),l=e(87745),g=e(57558),f=e(76584),p=e(67350),c=e(8285),x=e(8835),v=e(48492),m=e(41667),y=e(74848),h=e(51898),d=e(37386),E=e(63527),b=e(21285),D=e(34999),C=e(89640),P=e(25797),M=e(51156),O=e(31819),j=e(9931),U=e(18615),W=e(46415),B=e(44802),S=e(20246);function _(ce,ie){const{layout:ve}=ce.useState(),le=(0,n.useMemo)(()=>new P.C({title:"",id:"row-options"}).addItem(new M.v({title:"",skipField:!0,render:()=>(0,y.jsx)(K,{row:ce,isNewElement:ie})})).addItem(new M.v({title:(0,a.t)("dashboard.rows-layout.row-options.row.fill-screen","Fill screen"),render:()=>(0,y.jsx)(L,{row:ce})})).addItem(new M.v({title:(0,a.t)("dashboard.rows-layout.row-options.row.hide-header","Hide row header"),render:()=>(0,y.jsx)(T,{row:ce})})),[ce,ie]),Ee=(0,n.useMemo)(()=>new P.C({title:(0,a.t)("dashboard.rows-layout.row-options.repeat.title","Repeat options"),id:"repeat-options",isOpenDefault:!1}).addItem(new M.v({title:(0,a.t)("dashboard.rows-layout.row-options.repeat.variable.title","Repeat by variable"),description:(0,a.t)("dashboard.rows-layout.row-options.repeat.variable.description","Repeat this row for each value in the selected variable."),render:()=>(0,y.jsx)(A,{row:ce})})),[ce]),Re=(0,B.W)(ve),Oe=[le,...Re,Ee],Se=(0,n.useMemo)(()=>(0,W.h)(ce.state.conditionalRendering),[ce]);return Se&&Oe.push(Se),Oe}function K({row:ce,isNewElement:ie}){const{title:ve}=ce.useState(),le=(0,S.z4)({autoFocus:ie}),Ee=ce.hasUniqueTitle();return(0,y.jsx)(d.D,{label:(0,a.t)("dashboard.rows-layout.row-options.row.title","Title"),invalid:!Ee,error:Ee?void 0:(0,a.t)("dashboard.rows-layout.row-options.title-not-unique","Title should be unique"),children:(0,y.jsx)(E.p,{ref:le,title:(0,a.t)("dashboard.rows-layout.row-options.title-option","Title"),value:ve,onChange:Re=>ce.onChangeTitle(Re.currentTarget.value)})})}function T({row:ce}){const{hideHeader:ie=!1}=ce.useState();return(0,y.jsx)(b.d,{value:ie,onChange:()=>ce.onHeaderHiddenToggle()})}function L({row:ce}){const{fillScreen:ie}=ce.useState();return(0,y.jsx)(b.d,{value:ie,onChange:()=>ce.onChangeFillScreen(!ie)})}function A({row:ce}){const{layout:ie}=ce.useState(),ve=(0,c.MZ)(ce),le=ie.getVizPanels().some(Ee=>{const Re=(0,c.un)(Ee);return Re?.state.datasource?.uid===j.K||Re?.state.datasource?.uid===U.uv&&Re?.state.queries.some(Oe=>Oe.datasource?.uid===j.K)});return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(O.U,{sceneContext:ve,repeat:ce.state.repeatByVariable,onChange:Ee=>ce.onChangeRepeat(Ee)}),le?(0,y.jsxs)(D.F,{"data-testid":h.Tp.pages.Dashboard.Rows.Repeated.ConfigSection.warningMessage,severity:"warning",title:"",topSpacing:3,bottomSpacing:0,children:[(0,y.jsx)("p",{children:(0,y.jsxs)(a.x6,{i18nKey:"dashboard.rows-layout.row.repeat.warning",children:["Panels in this row use the ",{SHARED_DASHBOARD_QUERY:j.K}," data source. These panels will reference the panel in the original row, not the ones in the repeated rows."]})}),(0,y.jsx)(C.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/create-dashboard/#configure-repeating-rows",children:(0,y.jsx)(a.x6,{i18nKey:"dashboard.rows-layout.row.repeat.learn-more",children:"Learn more"})})]}):void 0]})}var N=e(22803),V=e(89332),z=e(56887),w=e(63142),H=e(45861),Q=e(36324),Z=e(30703),Y=e(45967),X=e(41116),I=e(3371),J=e(72746);function ee({model:ce}){const{layout:ie,collapse:ve,fillScreen:le,hideHeader:Ee,isDropTarget:Re,key:Oe}=ce.useState(),Se=(0,I.Lv)(ce),{isEditing:Te}=(0,c.TN)(ce),[_e,He,tt]=(0,X.H)(ce),{isSelected:Je,onSelect:Ge,isSelectable:je}=(0,z.y)(Oe),Fe=(0,c.hg)(ce),{rows:Be}=ce.getParentLayout().useState(),Ke=(0,w.of)(q),Ue=(0,w.of)(H.my),we=ce.parent?.parent instanceof J.H$,Xe=(0,Q.C)(),nt=Be.findIndex(ze=>ze===ce),he=!ve&&le,xe=_e&&!Te,[me,ye]=(0,n.useState)(!1),De=(0,n.useCallback)(()=>ye(!0),[]),Le=(0,n.useCallback)(()=>ye(!1),[]),Ve=!Se&&Te;return xe?null:(0,y.jsx)(V.sx,{draggableId:Oe,index:nt,isDragDisabled:!Ve,children:(ze,Ze)=>(0,y.jsxs)("div",{ref:Me=>{ze.innerRef(Me),ce.containerRef.current=Me},"data-dashboard-drop-target-key":ce.state.key,className:(0,N.cx)(Ke.wrapper,!ve&&Ke.wrapperNotCollapsed,Ze.isDragging&&Ke.dragging,ve&&Ke.wrapperCollapsed,he&&Ke.wrapperGrow,He,!Se&&Je&&"dashboard-selected-element",!Se&&!Je&&me&&"dashboard-selectable-element",Re&&"dashboard-drop-target"),onPointerDown:Me=>{Me.stopPropagation(),Xe.set(Me)},onPointerUp:Me=>{if(Je&&Me.target instanceof Element&&Me.target.closest("button")){Me.stopPropagation();return}Xe.check(Me)||setTimeout(()=>Ge?.(Me))},...ze.draggableProps,children:[(!Ee||Te)&&(0,y.jsxs)("div",{className:(0,N.cx)(Ke.rowHeader,"dashboard-row-header"),onMouseEnter:je?De:void 0,onMouseLeave:je?Le:void 0,...ze.dragHandleProps,children:[(0,y.jsxs)("button",{onClick:()=>ce.onCollapseToggle(),className:(0,N.cx)(Ue,Ke.rowTitleButton),"aria-label":ve?(0,a.t)("dashboard.rows-layout.row.expand","Expand row"):(0,a.t)("dashboard.rows-layout.row.collapse","Collapse row"),"data-testid":h.Tp.components.DashboardRow.title(Fe),children:[(0,y.jsx)(Z.I,{name:ve?"angle-right":"angle-down"}),(0,y.jsxs)("span",{className:(0,N.cx)(Ke.rowTitle,Ee&&Ke.rowTitleHidden,!we&&Ke.rowTitleNested,ve&&Ke.rowTitleCollapsed),children:[!ce.hasUniqueTitle()&&(0,y.jsx)(Y.m,{content:(0,a.t)("dashboard.rows-layout.row-warning.title-not-unique","This title is not unique"),children:(0,y.jsx)(Z.I,{name:"exclamation-triangle"})}),Fe,Ee&&(0,y.jsx)(Y.m,{content:(0,a.t)("dashboard.rows-layout.header-hidden-tooltip","Row header only visible in edit mode"),children:(0,y.jsx)(Z.I,{name:"eye-slash"})})]})]}),Ve&&(0,y.jsx)(Z.I,{name:"draggabledots",className:"dashboard-row-header-drag-handle"})]}),!ve&&(0,y.jsx)(ie.Component,{model:ie}),tt]})},Oe)}function q(ce){return{rowHeader:(0,N.css)({display:"flex",gap:ce.spacing(1),padding:ce.spacing(.5,.5,.5,0),alignItems:"center",justifyContent:"space-between",marginBottom:ce.spacing(1),"& .dashboard-row-header-drag-handle":(0,N.css)({opacity:0,[ce.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.25s"}}),"&:hover":(0,N.css)({"& .dashboard-row-header-drag-handle":(0,N.css)({opacity:1})})}),rowTitleButton:(0,N.css)({display:"flex",alignItems:"center",cursor:"pointer",background:"transparent",border:"none",minWidth:0,gap:ce.spacing(1)}),rowTitle:(0,N.css)({display:"flex",alignItems:"center",gap:ce.spacing(2),...ce.typography.h5,fontWeight:ce.typography.fontWeightMedium,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",flexGrow:1,minWidth:0}),rowTitleHidden:(0,N.css)({textDecoration:"line-through",opacity:.6,"&:hover":(0,N.css)({opacity:1})}),rowTitleNested:(0,N.css)({fontSize:ce.typography.body.fontSize,fontWeight:ce.typography.fontWeightRegular}),rowTitleCollapsed:(0,N.css)({color:ce.colors.text.secondary}),wrapper:(0,N.css)({display:"flex",flexDirection:"column",minHeight:ce.spacing(2.75+1+1+.125)}),wrapperNotCollapsed:(0,N.css)({"> div:nth-child(2)":{marginLeft:ce.spacing(3),position:"relative",width:"auto","&:before":{content:'""',position:"absolute",top:"-8px",bottom:0,left:"-16px",width:"1px",backgroundColor:ce.colors.border.weak}}}),dragging:(0,N.css)({cursor:"move"}),wrapperGrow:(0,N.css)({flexGrow:1}),wrapperCollapsed:(0,N.css)({flexGrow:0,borderBottom:`1px solid ${ce.colors.border.weak}`,minHeight:"unset",".dashboard-row-header":{marginBottom:ce.spacing(0)}}),rowActions:(0,N.css)({display:"flex",opacity:0}),checkboxWrapper:(0,N.css)({display:"flex",alignItems:"center",paddingLeft:ce.spacing(1)})}}var ne=e(32635);function se(ce){return[new P.C({title:"",id:"rows-options"}).addItem(new M.v({title:(0,a.t)("dashboard.edit-pane.row.header.title","Row header"),render:()=>(0,y.jsx)(oe,{model:ce})}))]}function oe({model:ce}){const ie=ce.getRows();let ve=!1,le=!1;for(let Ee=0;Ee<ie.length;Ee++){const{hideHeader:Re}=ie[Ee].useState(),Oe=ie[Ee-1];le=le||Oe&&!!Oe.state.hideHeader!=!!Re,ve=ve||!!Re}return(0,y.jsx)(ne.S,{label:(0,a.t)("dashboard.edit-pane.row.header.hide","Hide"),value:ve,indeterminate:le,onChange:()=>ce.onHeaderHiddenToggle(ve,le)})}class de{constructor(ie){this._rows=ie,this.isEditableDashboardElement=!0}getEditableElementInfo(){return{typeName:(0,a.t)("dashboard.edit-pane.elements.rows","Rows"),icon:"folder",instanceName:""}}useEditPaneOptions(){return se(this)}getRows(){return this._rows}onDelete(){this._rows.forEach(ie=>ie.onDelete())}onHeaderHiddenToggle(ie,ve){this._rows.forEach(le=>le.onHeaderHiddenToggle(ve?!0:!ie))}}var fe=e(97883);class ae extends s.Bs{constructor(ie){super({...ie,title:ie?.title??(0,a.t)("dashboard.rows-layout.row.new","New row"),layout:ie?.layout??x.X2.createEmpty(),conditionalRendering:ie?.conditionalRendering??g.p.createEmpty()}),this._variableDependency=new s.Sh(this,{statePaths:["title"]}),this.isEditableDashboardElement=!0,this.isDashboardDropTarget=!0,this.containerRef=n.createRef(),this.addActivationHandler(()=>this._activationHandler())}static{this.Component=ee}_activationHandler(){const ie=this.state.conditionalRendering?.activate();return()=>{ie&&ie()}}getEditableElementInfo(){return{typeName:(0,a.t)("dashboard.edit-pane.elements.row","Row"),instanceName:s.jh.interpolate(this,this.state.title,void 0,"text"),icon:"list-ul"}}getOutlineChildren(){return this.state.layout.getOutlineChildren()}getLayout(){return this.state.layout}getSlug(){return o.A.slugifyForUrl(s.jh.interpolate(this,this.state.title??"Row"))}switchLayout(ie){this.setState({layout:ie})}useEditPaneOptions(ie){return _(this,ie)}onDelete(){this.getParentLayout().removeRow(this)}onConfirmDelete(){if(this.getLayout().getVizPanels().length===0){this.onDelete();return}if(this.getParentLayout().shouldUngroup()){this.onDelete();return}i.A.publish(new l.bY({title:(0,a.t)("dashboard.rows-layout.delete-row-title","Delete row?"),text:(0,a.t)("dashboard.rows-layout.delete-row-text","Deleting this row will also remove all panels. Are you sure you want to continue?"),yesText:(0,a.t)("dashboard.rows-layout.delete-row-yes","Delete"),onConfirm:()=>{this.onDelete()}}))}createMultiSelectedElement(ie){return new de(ie.filter(ve=>ve instanceof ae))}onDuplicate(){this.getParentLayout().duplicateRow(this)}duplicate(){return this.clone({key:void 0,layout:this.getLayout().duplicate()})}serialize(){return(0,f.HQ)(this)}onCopy(){const ie=(0,p.IC)(this.getLayout(),(0,c.YQ)(this));(0,v.G2)(),u.A.set(r.rt,JSON.stringify({elements:ie,row:this.serialize()}))}setIsDropTarget(ie){!!this.state.isDropTarget!==ie&&this.setState({isDropTarget:ie})}draggedPanelOutside(ie){this.getLayout().removePanel?.(ie),this.setIsDropTarget(!1)}draggedPanelInside(ie){ie.clearParent(),this.getLayout().addPanel(ie),this.setIsDropTarget(!1)}onChangeTitle(ie){this.setState({title:ie})}onChangeName(ie){this.onChangeTitle(ie)}onHeaderHiddenToggle(ie=!this.state.hideHeader){this.setState({hideHeader:ie})}onChangeFillScreen(ie){this.setState({fillScreen:ie})}onChangeRepeat(ie){ie?this.setState({repeatByVariable:ie}):this.setState({repeatedRows:void 0,$variables:void 0,repeatByVariable:void 0})}onCollapseToggle(){this.setState({collapse:!this.state.collapse})}getParentLayout(){return s.jh.getAncestor(this,fe.V)}scrollIntoView(){(0,m.d)(this,this.containerRef)}getCollapsedState(){return this.state.collapse??!1}setCollapsedState(ie){this.setState({collapse:ie})}hasUniqueTitle(){return!this.getParentLayout().duplicateTitles().has(this.state.title)}}},97883:(te,R,e)=>{"use strict";e.d(R,{V:()=>K});var n=e(92745),a=e(36674),s=e(33143),i=e(76584),r=e(3371),u=e(8285),o=e(93389),l=e(1131),g=e(87308),f=e(34031),p=e(37365),c=e(48492),x=e(20246),v=e(97335),m=e(74848),y=e(22803),h=e(89332),d=e(51898),E=e(63142),b=e(45861),D=e(61659),C=e(2543),P=e(96540),M=e(68079),O=e(39765);function j({row:T,variable:L}){const{repeatedRows:A}=T.useState();return(0,P.useEffect)(()=>{U(L,T,!1);const N=L.subscribeToState(z=>U(L,T,!1)),V=T.subscribeToEvent(s.WG,z=>U(L,T,!0));return()=>{V.unsubscribe(),N.unsubscribe()}},[L,T]),A===void 0||a.jh.hasVariableDependencyInLoadingState(L)||L.state.loading?(u.xp.logger("RowItemRepeater",!1,"Variable is loading, showing spinner"),(0,m.jsx)(M.y,{})):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(T.Component,{model:T},T.state.key),A?.map(N=>(0,m.jsx)(N.Component,{model:N},N.state.key))]})}function U(T,L,A){if(a.jh.hasVariableDependencyInLoadingState(T)){u.xp.logger("RowItemRepeater",!1,"Skipped dependency in loading state");return}if(T.state.loading){u.xp.logger("RowItemRepeater",!1,"Skipped, variable is loading");return}const{values:N,texts:V}=(0,u.a7)(T),z=W(L,T.state.name);if(!A&&(0,C.isEqual)(z,N)){u.xp.logger("RowItemRepeater",!1,"Skipped, values the same");return}A?u.xp.logger("RowItemRepeater",!1,"Performing repeats, contentChanged"):u.xp.logger("RowItemRepeater",!1,"Performing repeats, variable values changed",N);const w=N.length?N:[""],H=V.length?V:T.hasAllValue()?["All"]:["None"],Q=[];for(let Z=0;Z<w.length;Z++){const Y=Z===0,X=(0,r.lv)(L.state.key,Z),I=Y?L:L.clone({repeatByVariable:void 0,repeatedRows:void 0,layout:void 0}),J=Y?L.getLayout():L.getLayout().cloneLayout(X,!1);I.setState({key:X,$variables:new a.Pj({variables:[new a.xc({name:T.state.name,value:w[Z],text:String(H[Z]),isMulti:T.state.isMulti,includeAll:T.state.includeAll})]}),layout:J}),Y||Q.push(I)}L.setState({repeatedRows:Q}),L.publishEvent(new O.d({source:L}),!0)}function W(T,L){const A=[];if(!T.state.repeatedRows)return[];function N(V){const z=a.jh.lookupVariable(L,V);if(z){const w=z.getValue();w!=null&&!Array.isArray(w)&&A.push(w)}}N(T);for(const V of T.state.repeatedRows)N(V);return A}function B({model:T}){const{rows:L,key:A}=T.useState(),{isEditing:N}=(0,u.TN)(T),V=(0,E.of)(_),{hasCopiedRow:z}=(0,D.x)();return(0,m.jsx)(h.JY,{onBeforeDragStart:w=>T.forceSelectRow(w.draggableId),onDragEnd:w=>{w.destination&&w.destination.index!==w.source.index&&T.moveRow(w.draggableId,w.source.index,w.destination.index)},children:(0,m.jsx)(h.gL,{droppableId:A,direction:"vertical",children:w=>(0,m.jsxs)("div",{className:V.wrapper,ref:w.innerRef,...w.droppableProps,children:[L.map(H=>(0,m.jsx)(S,{row:H,manager:T},H.state.key)),w.placeholder,N&&(0,m.jsxs)("div",{className:"dashboard-canvas-add-button",children:[(0,m.jsx)(b.$n,{icon:"plus",variant:"primary",fill:"text",onClick:()=>T.addNewRow(),"data-testid":d.Tp.components.CanvasGridAddActions.addRow,children:(0,m.jsx)(n.x6,{i18nKey:"dashboard.canvas-actions.new-row",children:"New row"})}),z&&(0,m.jsx)(b.$n,{icon:"clipboard-alt",variant:"primary",fill:"text",onClick:()=>T.pasteRow(),"data-testid":d.Tp.components.CanvasGridAddActions.pasteRow,children:(0,m.jsx)(n.x6,{i18nKey:"dashboard.canvas-actions.paste-row",children:"Paste row"})})]})]})})})}function S({row:T,manager:L}){const{repeatByVariable:A}=(0,a.gn)(T,{shouldActivateOrKeepAlive:!0});if(A){const N=a.jh.lookupVariable(A,L);if(N instanceof a.n8)return(0,m.jsx)(j,{row:T,manager:L,variable:N},T.state.key)}return(0,m.jsx)(T.Component,{model:T},T.state.key)}function _(T){return{wrapper:(0,y.css)({display:"flex",flexDirection:"column",gap:T.spacing(1),flexGrow:1,width:"100%"})}}class K extends a.Bs{constructor(){super(...arguments),this.isDashboardLayoutManager=!0,this.descriptor=K.descriptor}static{this.Component=B}static{this.descriptor={get name(){return(0,n.t)("dashboard.rows-layout.name","Rows")},get description(){return(0,n.t)("dashboard.rows-layout.description","Collapsable panel groups with headings")},id:"RowsLayout",createFromLayout:K.createFromLayout,isGridLayout:!1,icon:"list-ul"}}serialize(){return(0,i.aL)(this)}addPanel(L){}getVizPanels(){const L=[];for(const A of this.state.rows){const N=A.getLayout().getVizPanels();L.push(...N)}return L}cloneLayout(L,A){return this.clone({rows:this.state.rows.map(N=>{const V=(0,r.ed)(L,N.state.key);return N.clone({key:V,layout:N.state.layout.cloneLayout(V,A)})})})}duplicate(){const L=this.state.rows.map(A=>A.duplicate());return this.clone({rows:L,key:void 0})}duplicateRow(L){const A=L.duplicate();this.addNewRow(A)}addNewRow(L){const A=L??new v.o({}),N=new Set(this.state.rows.map(z=>z.state.title).filter(z=>z!==void 0)),V=(0,x.BK)(A.state.title,N);return V!==A.state.title&&A.setState({title:V}),s.cc.addElement({addedObject:A,source:this,perform:()=>this.setState({rows:[...this.state.rows,A]}),undo:()=>this.setState({rows:this.state.rows.filter(z=>z!==A)})}),A}editModeChanged(L){this.state.rows.forEach(A=>A.getLayout().editModeChanged?.(L))}pasteRow(){const L=(0,u.YQ)(this),A=(0,c.$v)(L);this.addNewRow(A)}shouldUngroup(){return this.state.rows.length===1}getOutlineChildren(){const L=[];for(const A of this.state.rows)if(L.push(A),A.state.repeatedRows)for(const N of A.state.repeatedRows)L.push(N);return L}removeRow(L){if(this.shouldUngroup()){(0,x.f)(this,L.state.layout);return}const A=this.state.rows.findIndex(N=>N===L);s.cc.removeElement({removedObject:L,source:this,perform:()=>this.setState({rows:this.state.rows.filter(N=>N!==L)}),undo:()=>{const N=[...this.state.rows];N.splice(A,0,L),this.setState({rows:N})}})}moveRow(L,A,N){const V=[...this.state.rows],[z]=V.splice(A,1);V.splice(N,0,z),this.setState({rows:V}),this.publishEvent(new s.su(this),!0)}forceSelectRow(L){const A=this.state.rows.findIndex(z=>z.state.key===L),N=this.state.rows[A];if(!N)return;(0,u.YQ)(this).state.editPane.selectObject(N,L,{force:!0,multi:!1})}static createEmpty(){return new K({rows:[new v.o]})}static createFromLayout(L){let A=[];if(L instanceof p.K)for(const N of L.state.tabs){if((0,r.Ry)(N.state.key))continue;const V=N.state.conditionalRendering;V?.clearParent();const z=N.state.$behaviors?.find(w=>w instanceof f.T);A.push(new v.o({layout:N.state.layout.clone(),title:N.state.title,conditionalRendering:V,repeatByVariable:z?.state.variableName}))}else if(L instanceof l.D){const N=[];let V;L.state.grid.forEachChild(z=>{if(!(z instanceof o.U)&&!(z instanceof a.tI))throw new Error("Child is not a DashboardGridItem or SceneGridRow, invalid scene");if(z instanceof a.tI){if(!(0,r.Ry)(z.state.key)){const w=z.state.$behaviors?.find(H=>H instanceof g.L);N.push({title:z.state.title,isCollapsed:!!z.state.isCollapsed,isDraggable:z.state.isDraggable,isResizable:z.state.isResizable,children:z.state.children,repeat:w?.state.variableName}),V=void 0}}else V||(V=[],N.push({children:V})),V.push(z)}),A=N.map(z=>new v.o({title:z.title,collapse:!!z.isCollapsed,repeatByVariable:z.repeat,layout:l.D.fromGridItems(z.children,z.isDraggable??L.state.grid.state.isDraggable,z.isResizable??L.state.grid.state.isResizable)}))}else A=[new v.o({layout:L.clone()})];return A.length===0&&(A=[new v.o]),new K({rows:A})}duplicateTitles(){const L=new Map,A=new Set;return this.state.rows.forEach(N=>{const V=a.jh.interpolate(N,N.state.title),z=(L.get(V)??0)+1;L.set(V,z),z>1&&V&&A.add(V)}),A}}},92769:(te,R,e)=>{"use strict";e.d(R,{V:()=>fe});var n=e(96540),a=e(92745),s=e(36674),i=e(95943),r=e(73427),u=e(29043),o=e(77197),l=e(87745),g=e(57558),f=e(6461),p=e(67350),c=e(8285),x=e(8835),v=e(48492),m=e(41667),y=e(74848),h=e(51898),d=e(37386),E=e(63527),b=e(34999),D=e(89640),C=e(25797),P=e(51156),M=e(31819),O=e(9931),j=e(18615),U=e(46415),W=e(44802),B=e(20246);function S(ae,ce){const{layout:ie}=ae.useState(),ve=(0,n.useMemo)(()=>new C.C({title:"",id:"tab-item-options"}).addItem(new P.v({title:(0,a.t)("dashboard.tabs-layout.tab-options.title-option","Title"),render:()=>(0,y.jsx)(_,{tab:ae,isNewElement:ce})})),[ae,ce]),le=(0,n.useMemo)(()=>new C.C({title:(0,a.t)("dashboard.tabs-layout.tab-options.repeat.title","Repeat options"),id:"repeat-options",isOpenDefault:!1}).addItem(new P.v({title:(0,a.t)("dashboard.tabs-layout.tab-options.repeat.variable.title","Repeat by variable"),description:(0,a.t)("dashboard.tabs-layout.tab-options.repeat.variable.description","Repeat this tab for each value in the selected variable."),render:()=>(0,y.jsx)(K,{tab:ae})})),[ae]),Ee=(0,W.W)(ie),Re=[ve,...Ee,le],Oe=(0,n.useMemo)(()=>(0,U.h)(ae.state.conditionalRendering),[ae]);return Oe&&Re.push(Oe),Re}function _({tab:ae,isNewElement:ce}){const{title:ie}=ae.useState(),ve=(0,B.z4)({autoFocus:ce}),le=ae.hasUniqueTitle();return(0,y.jsx)(d.D,{invalid:!le,error:le?void 0:(0,a.t)("dashboard.tabs-layout.tab-options.title-not-unique","Title should be unique"),children:(0,y.jsx)(E.p,{ref:ve,title:(0,a.t)("dashboard.tabs-layout.tab-options.title-option","Title"),value:ie,onChange:Ee=>ae.onChangeTitle(Ee.currentTarget.value)})})}function K({tab:ae}){const{layout:ce}=ae.useState(),ie=(0,c.MZ)(ae),ve=ce.getVizPanels().some(le=>{const Ee=(0,c.un)(le);return Ee?.state.datasource?.uid===O.K||Ee?.state.datasource?.uid===j.uv&&Ee?.state.queries.some(Re=>Re.datasource?.uid===O.K)});return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(M.U,{sceneContext:ie,repeat:ae.getRepeatVariable(),onChange:le=>ae.onChangeRepeat(le)}),ve?(0,y.jsxs)(b.F,{"data-testid":h.Tp.pages.Dashboard.Rows.Repeated.ConfigSection.warningMessage,severity:"warning",title:"",topSpacing:3,bottomSpacing:0,children:[(0,y.jsx)("p",{children:(0,y.jsxs)(a.x6,{i18nKey:"dashboard.tabs-layout.tab.repeat.warning",children:["Panels in this tab use the ",{SHARED_DASHBOARD_QUERY:O.K}," data source. These panels will reference the panel in the original tab, not the ones in the repeated tabs."]})}),(0,y.jsx)(D.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/create-dashboard/#configure-repeating-tabs",children:(0,y.jsx)(a.x6,{i18nKey:"dashboard.tabs-layout.tab.repeat.learn-more",children:"Learn more"})})]}):void 0]})}var T=e(22803),L=e(89332),A=e(96014),N=e(63704),V=e(92138),z=e(56887),w=e(63142),H=e(36324),Q=e(60208),Z=e(31286),Y=e(45967),X=e(30703),I=e(41116),J=e(3371);function ee({model:ae}){const{title:ce,key:ie,isDropTarget:ve}=ae.useState(),le=ae.getParentLayout(),{tabs:Ee,currentTabIndex:Re}=le.useState(),Oe=s.jh.interpolate(ae,ce,void 0,"text"),{isSelected:Se,onSelect:Te,isSelectable:_e}=(0,z.y)(ie),{isEditing:He}=(0,c.TN)(ae),tt=ae.getSlug(),Je=le.getUrlKey(),Ge=Ee.findIndex(xe=>xe===ae),je=Ge===Re,Fe=(0,A.zy)(),Be=N.sQ.sanitize(V.I.getUrlForPartial(Fe,{[Je]:tt})),Ke=(0,w.of)(ne),Ue=(0,H.C)(),[we]=(0,I.H)(ae),nt=!(0,J.Lv)(ae)&&He;if(we&&!He&&!je)return null;let he={};return ae.hasUniqueTitle()||(he={icon:"exclamation-triangle",tooltip:(0,a.t)("dashboard.tabs-layout.tab-warning.title-not-unique","This title is not unique")}),(0,y.jsx)(L.sx,{draggableId:ie,index:Ge,isDragDisabled:!nt,children:(xe,me)=>(0,y.jsx)("div",{ref:ye=>xe.innerRef(ye),className:(0,T.cx)(me.isDragging&&Ke.dragging),...xe.draggableProps,...xe.dragHandleProps,children:(0,y.jsx)(Q.o,{ref:ae.containerRef,truncate:!0,className:(0,T.cx)(we&&Ke.hidden,Se&&"dashboard-selected-element",_e&&!Se&&"dashboard-selectable-element",ve&&"dashboard-drop-target"),active:je,title:Oe,suffix:we?q:void 0,href:Be,"aria-selected":je,onPointerDown:ye=>{ye.stopPropagation(),Ue.set(ye)},onPointerUp:ye=>{ye.stopPropagation(),!(!_e||Ue.check(ye))&&Te?.(ye)},label:Oe,"data-dashboard-drop-target-key":ae.state.key,...he})})},ie)}function q(){return(0,y.jsx)(Z.a,{paddingLeft:1,display:"inline",children:(0,y.jsx)(Y.m,{content:(0,a.t)("dashboard.conditional-rendering.overlay.tooltip","Element is hidden due to conditional rendering."),children:(0,y.jsx)(X.I,{name:"eye-slash"})})})}const ne=()=>({dragging:(0,T.css)({cursor:"move"}),hidden:(0,T.css)({opacity:.4,"&:hover":(0,T.css)({opacity:1})})});var se=e(34031);class oe{constructor(ce){this._tabs=ce,this.isEditableDashboardElement=!0}getEditableElementInfo(){return{typeName:(0,a.t)("dashboard.edit-pane.elements.tabs","Tabs"),icon:"folder",instanceName:""}}useEditPaneOptions(){return[]}getTabs(){return this._tabs}onDelete(){this._tabs.forEach(ce=>ce.onDelete())}}var de=e(37365);class fe extends s.Bs{constructor(ce){super({...ce,title:ce?.title??(0,a.t)("dashboard.tabs-layout.tab.new","New tab"),layout:ce?.layout??x.X2.createEmpty(),conditionalRendering:ce?.conditionalRendering??g.p.createEmpty()}),this._variableDependency=new s.Sh(this,{statePaths:["title"]}),this.isEditableDashboardElement=!0,this.isDashboardDropTarget=!0,this.containerRef=n.createRef(),this.addActivationHandler(()=>this._activationHandler())}static{this.Component=ee}_activationHandler(){const ce=this.state.conditionalRendering?.activate();return()=>{ce&&ce()}}getEditableElementInfo(){return{typeName:(0,a.t)("dashboard.edit-pane.elements.tab","Tab"),instanceName:s.jh.interpolate(this,this.state.title,void 0,"text"),icon:"layers"}}getOutlineChildren(){return this.state.layout.getOutlineChildren()}getLayout(){return this.state.layout}getSlug(){return o.A.slugifyForUrl(s.jh.interpolate(this,this.state.title??"Tab"))}switchLayout(ce){this.setState({layout:ce})}useEditPaneOptions(ce){return S(this,ce)}onDelete(){this.getParentLayout().removeTab(this)}onConfirmDelete(){const ce=this.getParentLayout();if(ce.shouldUngroup()){ce.removeTab(this);return}if(this.getLayout().getVizPanels().length===0){this.onDelete();return}r.lE.publish(new l.bY({title:(0,a.t)("dashboard.tabs-layout.delete-tab-title","Delete tab?"),text:(0,a.t)("dashboard.tabs-layout.delete-tab-text","Deleting this tab will also remove all panels. Are you sure you want to continue?"),yesText:(0,a.t)("dashboard.tabs-layout.delete-tab-yes","Delete"),onConfirm:()=>{this.onDelete()}}))}serialize(){return(0,f.Yz)(this)}onCopy(){const ce=(0,p.IC)(this.getLayout(),(0,c.YQ)(this));(0,v.G2)(),u.A.set(i.Gk,JSON.stringify({elements:ce,tab:this.serialize()}))}createMultiSelectedElement(ce){return new oe(ce.filter(ie=>ie instanceof fe))}onDuplicate(){this.getParentLayout().duplicateTab(this)}duplicate(){return this.clone({key:void 0,layout:this.getLayout().duplicate()})}onAddPanel(ce=(0,c.O8)()){this.getLayout().addPanel(ce)}onAddTab(){this.getParentLayout().addNewTab()}onChangeTitle(ce){this.setState({title:ce})}onChangeName(ce){this.onChangeTitle(ce)}onChangeRepeat(ce){let ie=this._getRepeatBehavior();ce?(ie&&ie.removeBehavior(),ie=new se.T({variableName:ce}),this.setState({$behaviors:[...this.state.$behaviors??[],ie]}),ie.activate()):ie?.removeBehavior()}setIsDropTarget(ce){!!this.state.isDropTarget!==ce&&this.setState({isDropTarget:ce})}draggedPanelOutside(ce){this.getLayout().removePanel?.(ce),this.setIsDropTarget(!1)}draggedPanelInside(ce){ce.clearParent(),this.getLayout().addPanel(ce),this.setIsDropTarget(!1);const ie=this.getParentLayout(),ve=ie.state.tabs.findIndex(le=>le===this);ve!==ie.state.currentTabIndex&&ie.setState({currentTabIndex:ve})}getRepeatVariable(){return this._getRepeatBehavior()?.state.variableName}getParentLayout(){return s.jh.getAncestor(this,de.K)}scrollIntoView(){const ce=this.getParentLayout();ce.getCurrentTab()!==this&&ce.switchToTab(this),(0,m.d)(this,this.containerRef)}hasUniqueTitle(){return!this.getParentLayout().duplicateTitles().has(this.state.title)}_getRepeatBehavior(){return this.state.$behaviors?.find(ce=>ce instanceof se.T)}}},34031:(te,R,e)=>{"use strict";e.d(R,{T:()=>g});var n=e(2543),a=e.n(n),s=e(36674),i=e(3371),r=e(8285),u=e(39765),o=e(92769),l=e(37365);class g extends s.Bs{constructor(x){super(x),this._variableDependency=new s.Sh(this,{variableNames:[this.state.variableName],onVariableUpdateCompleted:()=>this.performRepeat()}),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this.performRepeat()}_getTab(){if(!(this.parent instanceof o.V))throw new Error("RepeatedTabItemBehavior: Parent is not a TabItem");return this.parent}_getLayout(){const x=this._getTab().parent;if(!(x instanceof l.K))throw new Error("RepeatedTabItemBehavior: Layout is not a TabsLayoutManager");return x}performRepeat(x=!1){if(this._variableDependency.hasDependencyInLoadingState())return;const v=s.jh.lookupVariable(this.state.variableName,this.parent?.parent);if(!v){console.error("RepeatedTabItemBehavior: Variable not found");return}if(!(v instanceof s.n8)){console.error("RepeatedTabItemBehavior: Variable is not a MultiValueVariable");return}const m=this._getTab(),y=this._getLayout(),{values:h,texts:d}=(0,r.a7)(v);if((0,n.isEqual)(this._prevRepeatValues,h)&&!x)return;this._prevRepeatValues=h,this._clonedTabs=[];const E=m.getLayout(),b={values:[""],texts:v.hasAllValue()?["All"]:["None"]},D=h.length?h:b.values,C=d.length?d:b.texts;for(let P=0;P<D.length;P++){const M=P===0,O=M?m:m.clone({$behaviors:[]}),j=(0,i.lv)(m.state.key,P);O.setState({key:j,$variables:new s.Pj({variables:[new s.xc({name:this.state.variableName,value:D[P],text:String(C[P]),isMulti:v.state.isMulti,includeAll:v.state.includeAll})]}),layout:E.cloneLayout?.(j,M)}),this._clonedTabs.push(O)}f(y,this._clonedTabs,m.state.key),this.publishEvent(new u.d({source:this}),!0)}removeBehavior(){const x=this._getTab(),v=this._getLayout(),m=p(v,x.state.key);v.setState({tabs:m}),x.setState({$behaviors:x.state.$behaviors.filter(y=>y!==this),$variables:void 0})}}function f(c,x,v){const m=p(c,v),y=m.findIndex(h=>h.state.key.includes(v));if(y===-1)throw new Error("TabItemRepeaterBehavior: Tab not found in layout");c.setState({tabs:[...m.slice(0,y),...x,...m.slice(y+1)]})}function p(c,x){return c.state.tabs.filter(v=>!(0,i.oX)(v.state.key,x))}},37365:(te,R,e)=>{"use strict";e.d(R,{K:()=>j});var n=e(92745),a=e(36674),s=e(33143),i=e(6461),r=e(3371),u=e(8285),o=e(97335),l=e(97883),g=e(48492),f=e(20246),p=e(92769),c=e(34031),x=e(74848),v=e(22803),m=e(89332),y=e(51898),h=e(63142),d=e(54314),E=e(45861),b=e(13941),D=e(41116),C=e(1837),P=e(61659);function M({model:U}){const W=(0,h.of)(O),{tabs:B,key:S}=U.useState(),_=U.getCurrentTab(),{layout:K}=_.useState(),T=(0,u.YQ)(U),{isEditing:L}=T.useState(),{hasCopiedTab:A}=(0,P.x)(),[N,V,z]=(0,D.H)(_);return(0,x.jsxs)("div",{className:W.tabLayoutContainer,children:[(0,x.jsx)(d.U,{className:W.tabsBar,children:(0,x.jsx)(m.JY,{onBeforeDragStart:w=>U.forceSelectTab(w.draggableId),onDragEnd:w=>{w.destination&&w.destination.index!==w.source.index&&U.moveTab(w.source.index,w.destination.index)},children:(0,x.jsxs)("div",{className:W.tabsRow,children:[(0,x.jsx)(m.gL,{droppableId:S,direction:"horizontal",children:w=>(0,x.jsxs)("div",{className:W.tabsContainer,ref:w.innerRef,...w.droppableProps,children:[B.map(H=>(0,x.jsx)(H.Component,{model:H},H.state.key)),w.placeholder]})}),L&&(0,x.jsxs)("div",{className:"dashboard-canvas-add-button",children:[(0,x.jsx)(E.$n,{icon:"plus",variant:"primary",fill:"text",onClick:()=>U.addNewTab(),"data-testid":y.Tp.components.CanvasGridAddActions.addTab,children:(0,x.jsx)(n.x6,{i18nKey:"dashboard.canvas-actions.new-tab",children:"New tab"})}),A&&(0,x.jsx)(E.$n,{icon:"clipboard-alt",variant:"primary",fill:"text",onClick:()=>U.pasteTab(),"data-testid":y.Tp.components.CanvasGridAddActions.pasteTab,children:(0,x.jsx)(n.x6,{i18nKey:"dashboard.canvas-actions.paste-tab",children:"Paste tab"})})]})]})})}),L&&(0,x.jsxs)(b.J,{className:(0,v.cx)(W.tabContentContainer,V),children:[_&&(0,x.jsx)(K.Component,{model:K}),z]}),!L&&(0,x.jsx)(b.J,{className:W.tabContentContainer,children:_&&(0,x.jsx)(K.Component,{model:K})})]})}const O=U=>({tabLayoutContainer:(0,v.css)({display:"flex",flexDirection:"column",flex:"1 1 auto"}),tabsBar:(0,v.css)(C.u),tabsRow:(0,v.css)({display:"flex",width:"100%",alignItems:"center"}),tabsContainer:(0,v.css)({display:"flex",justifyContent:"flex-start",alignItems:"flex-end",overflowX:"auto",overflowY:"hidden",paddingInline:U.spacing(.125),paddingTop:"1px"}),tabContentContainer:(0,v.css)({backgroundColor:"transparent",position:"relative",display:"flex",flexDirection:"column",flex:1,minHeight:U.spacing(1+.125),paddingTop:U.spacing(1)})});class j extends a.Bs{constructor(W){super({...W,tabs:W.tabs??[new p.V],currentTabIndex:W.currentTabIndex??0}),this.isDashboardLayoutManager=!0,this.descriptor=j.descriptor,this._urlSync=new a.So(this,{keys:()=>[this.getUrlKey()]})}static{this.Component=M}static{this.descriptor={get name(){return(0,n.t)("dashboard.tabs-layout.name","Tabs")},get description(){return(0,n.t)("dashboard.tabs-layout.description","Organize panels into horizontal tabs")},id:"TabsLayout",createFromLayout:j.createFromLayout,isGridLayout:!1,icon:"window"}}serialize(){return(0,i.lX)(this)}duplicate(){throw new Error("Method not implemented.")}duplicateTab(W){const B=W.duplicate();this.addNewTab(B)}getUrlState(){return{[this.getUrlKey()]:this.getCurrentTab().getSlug()}}updateFromUrl(W){const B=this.getUrlKey(),S=W[B];if(S&&typeof W[B]=="string"){const _=this.state.tabs.findIndex(K=>K.getSlug()===S);_!==-1&&this.setState({currentTabIndex:_})}}switchToTab(W){this.setState({currentTabIndex:this.state.tabs.indexOf(W)})}getCurrentTab(){return this.state.tabs.length>this.state.currentTabIndex?this.state.tabs[this.state.currentTabIndex]:this.state.tabs[0]}addPanel(W){this.getCurrentTab().getLayout().addPanel(W)}getVizPanels(){const W=[];for(const B of this.state.tabs){const S=B.getLayout().getVizPanels();W.push(...S)}return W}cloneLayout(W,B){return this.clone({tabs:this.state.tabs.map(S=>{const _=(0,r.ed)(W,S.state.key);return S.clone({key:_,layout:S.state.layout.cloneLayout(_,B)})})})}getOutlineChildren(){return this.state.tabs}addNewTab(W){const B=W??new p.V({}),S=new Set(this.state.tabs.map(K=>K.state.title).filter(K=>K!==void 0)),_=(0,f.BK)(B.state.title,S);return _!==B.state.title&&B.setState({title:_}),s.cc.addElement({addedObject:B,source:this,perform:()=>this.setState({tabs:[...this.state.tabs,B],currentTabIndex:this.state.tabs.length}),undo:()=>{const K=this.state.tabs.findIndex(T=>T===B);this.setState({tabs:this.state.tabs.filter(T=>T!==B),currentTabIndex:this.state.currentTabIndex===K?Math.max(0,this.state.currentTabIndex-1):this.state.currentTabIndex})}}),B}editModeChanged(W){this.state.tabs.forEach(B=>B.getLayout().editModeChanged?.(W))}pasteTab(){const W=(0,u.YQ)(this),B=(0,g.sN)(W);this.addNewTab(B)}activateRepeaters(){this.state.tabs.forEach(W=>{W.isActive||W.activate();const B=(W.state.$behaviors??[]).find(S=>S instanceof c.T);B?.isActive||B?.activate(),W.getLayout().activateRepeaters?.()})}shouldUngroup(){return this.state.tabs.length===1}removeTab(W){if(this.shouldUngroup()){(0,f.f)(this,W.state.layout);return}if(this.getCurrentTab()===W){const K=this.state.currentTabIndex,T=this.state.tabs.findIndex(A=>A===W),L=K>0?K-1:0;s.cc.removeElement({removedObject:W,source:this,perform:()=>this.setState({tabs:this.state.tabs.filter(A=>A!==W),currentTabIndex:K===T?L:K}),undo:()=>{const A=[...this.state.tabs];A.splice(T,0,W),this.setState({tabs:A,currentTabIndex:K})}});return}const S=this.state.tabs.filter(K=>K!==W),_=S.length===0?[new p.V]:S;this.setState({tabs:_,currentTabIndex:0})}moveTab(W,B){const S=this.state.tabs[W];s.cc.moveElement({source:this,movedObject:S,perform:()=>{this.rearrangeTabs(W,B)},undo:()=>{this.rearrangeTabs(B,W)}})}rearrangeTabs(W,B){const S=[...this.state.tabs],[_]=S.splice(W,1);S.splice(B,0,_),this.setState({tabs:S,currentTabIndex:B}),this.publishEvent(new s.su(this),!0)}forceSelectTab(W){const B=this.state.tabs.findIndex(K=>K.state.key===W),S=this.state.tabs[B];if(!S)return;(0,u.YQ)(this).state.editPane.selectObject(S,W,{force:!0,multi:!1}),this.setState({currentTabIndex:B})}static createEmpty(){const W=new p.V;return new j({tabs:[W]})}static createFromLayout(W){let B=[];if(W instanceof l.V)for(const S of W.state.rows){if((0,r.Ry)(S.state.key))continue;const _=S.state.conditionalRendering;_?.clearParent();const K=S.state.repeatByVariable?[new c.T({variableName:S.state.repeatByVariable})]:void 0;B.push(new p.V({layout:S.state.layout.clone(),title:S.state.title,conditionalRendering:_,$behaviors:K}))}else W.clearParent(),B.push(new p.V({layout:W}));return new j({tabs:B})}getUrlKey(){let W=this.parent,B="dtab";for(;W;)W instanceof p.V&&(B=`${W.getSlug()}-${B}`),W instanceof o.o&&(B=`${W.getSlug()}-${B}`),W=W.parent;return B}duplicateTitles(){const W=new Map,B=new Set;return this.state.tabs.forEach(S=>{const _=a.jh.interpolate(S,S.state.title),K=(W.get(_)??0)+1;W.set(_,K),K>1&&B.add(_)}),B}}},6607:(te,R,e)=>{"use strict";e.d(R,{f:()=>h});var n=e(74848),a=e(22803),s=e(51898),i=e(92745),r=e(63142),u=e(45861),o=e(88559),l=e(87063),g=e(1682),f=e(8285),p=e(72746),c=e(97883),x=e(37365),v=e(17084),m=e(61659),y=e(20246);function h({layoutManager:C}){const P=(0,r.of)(D),{hasCopiedPanel:M}=(0,m.x)();return(0,n.jsxs)("div",{className:(0,a.cx)(P.addAction,"dashboard-canvas-add-button"),children:[(0,n.jsx)(u.$n,{variant:"primary",fill:"text",icon:"plus","data-testid":s.Tp.components.CanvasGridAddActions.addPanel,onClick:()=>C.addPanel((0,f.O8)()),children:(0,n.jsx)(i.x6,{i18nKey:"dashboard.canvas-actions.add-panel",children:"Add panel"})}),(0,n.jsx)(o.m,{overlay:(0,n.jsxs)(l.W,{children:[(0,n.jsx)(l.W.Item,{icon:"list-ul",label:(0,i.t)("dashboard.canvas-actions.group-into-row","Group into row"),onClick:()=>{(0,v.t)(C)}}),(0,n.jsx)(l.W.Item,{icon:"layers",label:(0,i.t)("dashboard.canvas-actions.group-into-tab","Group into tab"),onClick:()=>{(0,v.A)(C)}})]}),children:(0,n.jsx)(u.$n,{variant:"primary",fill:"text",icon:"layers","data-testid":s.Tp.components.CanvasGridAddActions.groupPanels,children:(0,n.jsx)(i.x6,{i18nKey:"dashboard.canvas-actions.group-panels",children:"Group panels"})})}),d(C),M&&C.pastePanel&&(0,n.jsx)(u.$n,{variant:"primary",fill:"text",icon:"clipboard-alt",onClick:()=>{C.pastePanel?.()},children:(0,n.jsx)(i.x6,{i18nKey:"dashboard.canvas-actions.paste-panel",children:"Paste panel"})})]})}function d(C){if(C.parent instanceof p.H$)return null;const M=g.b4.getLayoutManagerFor(C.parent),O=()=>{(0,y.f)(M,C)};return M instanceof x.K?(0,n.jsx)(E,{parentLayout:M,onClick:O}):M instanceof c.V?(0,n.jsx)(b,{parentLayout:M,onClick:O}):null}function E({parentLayout:C,onClick:P}){const{tabs:M}=C.useState();return M.length>1?null:(0,n.jsx)(u.$n,{variant:"primary",fill:"text",icon:"layers-slash",onClick:P,"data-testid":s.Tp.components.CanvasGridAddActions.ungroup,children:(0,n.jsx)(i.x6,{i18nKey:"dashboard.canvas-actions.un-group-panels",children:"Ungroup"})})}function b({parentLayout:C,onClick:P}){const{rows:M}=C.useState();return M.length>1?null:(0,n.jsx)(u.$n,{variant:"primary",fill:"text",icon:"layers-slash",onClick:P,"data-testid":s.Tp.components.CanvasGridAddActions.ungroup,children:(0,n.jsx)(i.x6,{i18nKey:"dashboard.canvas-actions.un-group-panels",children:"Ungroup"})})}const D=C=>({addAction:(0,a.css)({position:"absolute",padding:C.spacing(1,0),height:C.spacing(5),bottom:0,left:0,right:0,opacity:0,[C.transitions.handleMotion("no-preference","reduce")]:{transition:C.transitions.create("opacity")}})})},44802:(te,R,e)=>{"use strict";e.d(R,{W:()=>y});var n=e(74848),a=e(96540),s=e(92745),i=e(31286),r=e(77824),u=e(25797),o=e(51156),l=e(15759),g=e(42954),f=e(8835),p=e(1131),c=e(97883),x=e(37365);const v=new g.O(()=>[p.D.descriptor,f.X2.descriptor,c.V.descriptor,x.K.descriptor]);function m({layoutManager:h}){const d=h.descriptor.isGridLayout,E=v.list().filter(C=>C.isGridLayout===d),b=(0,a.useCallback)(C=>{const P=h.parent;P&&(0,l.l)(P)&&P.switchLayout(C.createFromLayout(h))},[h]),D=E.map(C=>({value:C,label:C.name,icon:C.icon,description:C.description,ariaLabel:`layout-selection-option-${C.name}`}));return(0,n.jsx)(i.a,{paddingBottom:2,display:"flex",grow:1,alignItems:"center",children:(0,n.jsx)(r.z,{fullWidth:!0,value:h.descriptor,options:D,onChange:b})})}function y(h){return(0,a.useMemo)(()=>{const d=h.descriptor.isGridLayout,E=new u.C({title:(0,s.t)("dashboard.layout.common.group-layout","Group layout"),id:"group-layout-category",isOpenDefault:!1}),b=new u.C({title:(0,s.t)("dashboard.layout.common.panel-layout","Panel layout"),id:"grid-layout-category",isOpenDefault:!1});if(b.addItem(new o.v({title:"",skipField:!0,render:()=>(0,n.jsx)(m,{layoutManager:h})})),d?E.props.disabledText=(0,s.t)("dashboard.layout.common.group-layout-disabled","No groups exists on this level"):(E.addItem(new o.v({title:"",skipField:!0,render:()=>(0,n.jsx)(m,{layoutManager:h})})),b.props.disabledText=(0,s.t)("dashboard.layout.common.panel-layout-disabled","Select a row or tab to change panel layout options")),h.getOptions)for(const D of h.getOptions())b.addItem(D);return[E,b]},[h])}},17084:(te,R,e)=>{"use strict";e.d(R,{A:()=>o,t:()=>l});var n=e(43173),a=e(33143),s=e(1131),i=e(97883),r=e(37365),u=e(15759);function o(g){const f=g.parent;if(!(0,u.l)(f))throw new Error("Parent layout is not a LayoutParent");if(g instanceof r.K)return g.addNewTab();const p=r.K.createEmpty();p.state.tabs[0].setState({layout:g.clone()}),f.switchLayout(p);const c=p.state.tabs[0];return g.publishEvent(new a.jO(c),!0),c}function l(g){if(!n.$.featureToggles.dashboardNewLayouts){if(g instanceof s.D)return g.addNewRow();throw new Error("New dashboard layouts feature not enabled but new layout found")}if(g instanceof i.V)return g.addNewRow();if(g instanceof r.K){const x=g.getCurrentTab();return l(x.state.layout)}const f=g.parent;if(!(0,u.l)(f))throw new Error("Parent layout is not a LayoutParent");const p=i.V.createFromLayout(f.getLayout());f.switchLayout(p);const c=p.state.rows[0];return g.publishEvent(new a.jO(c),!0),c}},48492:(te,R,e)=>{"use strict";e.d(R,{$v:()=>p,G2:()=>f,dp:()=>v,qY:()=>m,sN:()=>c});var n=e(95943),a=e(29043),s=e(4974),i=e(17340),r=e(76584),u=e(6461),o=e(1682),l=e(25953),g=e(93389);function f(){a.A.delete(n.tH),a.A.delete(n.rt),a.A.delete(n.Gk)}function p(h){const d=a.A.get(n.rt),E=JSON.parse(d);f();const b=y(o.b4.getNextPanelId(h));let D;try{D=(0,r.g5)(E.row,E.elements,!1,b)}catch{throw new Error("Error pasting row from clipboard, please try to copy again")}return D}function c(h){const d=a.A.get(n.Gk),E=JSON.parse(d);f();const b=y(o.b4.getNextPanelId(h));let D;try{D=(0,u.zE)(E.tab,E.elements,!1,b)}catch{throw new Error("Error pasting tab from clipboard, please try to copy again")}return D}function x(h){const d=a.A.get(n.tH),{elements:E,gridItem:b}=JSON.parse(d);return b.kind==="GridLayoutItem"?(0,i.ve)(b,E,y(o.b4.getNextPanelId(h))):(0,s.i6)(b,E,y(o.b4.getNextPanelId(h)))}function v(h){const d=x(h);return d instanceof l.X?d:new l.X({body:d.state.body,key:d.state.key,variableName:d.state.variableName})}function m(h,d){const E=x(h);return E instanceof g.U?E:new g.U({...d,body:E.state.body,key:E.state.key,variableName:E.state.variableName})}function y(h){let d=h;return()=>d++}},41667:(te,R,e)=>{"use strict";e.d(R,{R:()=>u,d:()=>r});var n=e(36674),a=e(97335),s=e(92769),i=e(37365);function r(o,l){if(l.current?.isConnected){u(l.current);return}let g=o.parent;for(;g;){if(g instanceof a.o&&g.state.collapse&&g.onCollapseToggle(),g instanceof n.tI&&g.state.isCollapsed&&g.onCollapseToggle(),g instanceof s.V){const f=g.parent;f instanceof i.K&&f.getCurrentTab()!==g&&f.switchToTab(g)}g=g.parent}setTimeout(()=>{l.current?.isConnected&&u(l.current)},10)}function u(o){o.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}},1837:(te,R,e)=>{"use strict";e.d(R,{u:()=>n});const n={"&:hover,:focus-within":{".dashboard-canvas-add-button":{opacity:1,filter:"unset"}}}},61659:(te,R,e)=>{"use strict";e.d(R,{x:()=>i});var n=e(96540),a=e(95943),s=e(29043);function i(){const[r,u]=(0,n.useState)(s.A.exists(a.tH)),[o,l]=(0,n.useState)(s.A.exists(a.rt)),[g,f]=(0,n.useState)(s.A.exists(a.Gk));return(0,n.useEffect)(()=>{const p=s.A.subscribe(a.tH,()=>{u(s.A.exists(a.tH))}),c=s.A.subscribe(a.rt,()=>{l(s.A.exists(a.rt))}),x=s.A.subscribe(a.Gk,()=>{f(s.A.exists(a.Gk))});return()=>{p(),c(),x()}},[]),{hasCopiedPanel:r,hasCopiedRow:o,hasCopiedTab:g}}},20246:(te,R,e)=>{"use strict";e.d(R,{BK:()=>r,f:()=>u,z4:()=>i});var n=e(96540),a=e(15759);function s(o){let l=o.parent;for(;l;){if(isDashboardLayoutManager(l))return l;l=l.parent}return null}function i({autoFocus:o}={}){const l=(0,n.useRef)(null);return(0,n.useEffect)(()=>{l.current&&o&&setTimeout(()=>l.current?.focus(),200)},[o]),l}function r(o,l){const g=o??"";if(l.has(g)){const f=g.match(/^(.*?)(\d+)$/);if(f){const p=f[1],c=parseInt(f[2],10);let x=`${p}${c+1}`;for(;l.has(x);){const v=parseInt(x.match(/\d+$/)[0],10)+1;x=`${p}${v}`}return x}else{let p=1,c=`${g} ${p}`;for(;l.has(c);)p++,c=`${g} ${p}`;return c}}return g}function u(o,l){const g=o.parent;(0,a.l)(g)&&(l.clearParent(),g.switchLayout(l))}},95395:(te,R,e)=>{"use strict";e.d(R,{GA:()=>se,aS:()=>fe,Qk:()=>oe});var n=e(74848),a=e(22803),s=e(63142),i=e(36219),r=e(7895),u=e(15130),o=e(4590),l=e(75541),g=e(8285),f=e(51898),p=e(92745),c=e(36490),x=e(45861);const v=({dashboard:ie})=>(0,n.jsx)(x.$n,{onClick:()=>c.Ny.partial(ie.state.editview?{editview:null}:{viewPanel:null,editPanel:null}),tooltip:"",fill:ie.state.editview?"text":void 0,variant:"secondary",size:"sm",icon:"arrow-left","data-testid":f.Tp.components.NavToolbar.editDashboard.backToDashboardButton,children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.toolbar.new.back-to-dashboard",children:"Back to dashboard"})});var m=e(30703);const y=({dashboard:ie})=>(0,n.jsx)(r.I,{tooltip:(0,p.t)("dashboard.toolbar.new.dashboard-settings.tooltip","Dashboard settings"),icon:(0,n.jsx)(m.I,{name:"cog",size:"lg",type:"default"}),onClick:()=>ie.onOpenSettings(),"data-testid":f.Tp.components.NavToolbar.editDashboard.settingsButton}),h=({dashboard:ie})=>(0,n.jsx)(x.$n,{onClick:()=>ie.state.editPanel?.onDiscard(),tooltip:(0,p.t)("dashboard.toolbar.new.discard-library-panel-changes","Discard library panel changes"),size:"sm",fill:"outline",variant:"destructive","data-testid":f.Tp.components.NavToolbar.editDashboard.discardChangesButton,children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.toolbar.new.discard-library-panel-changes",children:"Discard library panel changes"})});var d=e(96540);const E=({dashboard:ie})=>{const ve=b(ie.state.editPanel);return(0,n.jsx)(x.$n,{onClick:()=>ie.state.editPanel?.onDiscard(),tooltip:ie.state.editPanel?.state.isNewPanel?(0,p.t)("dashboard.toolbar.new.discard-panel-new","Discard panel"):(0,p.t)("dashboard.toolbar.new.discard-panel","Discard panel changes"),size:"sm",disabled:!ve,fill:"outline",variant:"destructive","data-testid":f.Tp.components.NavToolbar.editDashboard.discardChangesButton,children:ie.state.editPanel?.state.isNewPanel?(0,n.jsx)(p.x6,{i18nKey:"dashboard.toolbar.new.discard-panel-new",children:"Discard panel"}):(0,n.jsx)(p.x6,{i18nKey:"dashboard.toolbar.new.discard-panel",children:"Discard panel changes"})})};function b(ie){const[ve,le]=(0,d.useState)();return(0,d.useEffect)(()=>{if(ie){const Ee=ie.subscribeToState(Re=>{Re.isDirty!==ve&&le(Re.isDirty)});return()=>Ee.unsubscribe()}},[ie,ve]),ve}var D=e(45967);const C=({icon:ie,label:ve,checked:le,checkedIcon:Ee,checkedLabel:Re,disabled:Oe,onClick:Se,"data-testid":Te})=>{const _e=(0,s.of)(P),He=le&&Re?Re:ve,tt=le&&Ee?Ee:ie;return(0,n.jsx)(D.m,{content:He,children:(0,n.jsx)("button",{"aria-label":He,className:(0,a.cx)({[_e.container]:!0,[_e.containerChecked]:le,[_e.containerDisabled]:Oe}),"data-testid":Te,onClick:Oe?void 0:Se,children:(0,n.jsx)("div",{className:(0,a.cx)(_e.box,le&&_e.boxChecked),children:(0,n.jsx)(m.I,{name:tt,size:"xs"})})})})},P=ie=>({container:(0,a.css)({border:`1px solid ${ie.components.input.borderColor}`,padding:ie.spacing(.25),backgroundColor:ie.components.input.background,borderRadius:ie.shape.radius.default,width:ie.spacing(5.5),height:ie.spacing(3),cursor:"pointer",display:"flex",flexDirection:"row",alignItems:"center",[ie.transitions.handleMotion("no-preference","reduce")]:{transition:"all 0.2s ease-in-out"},"&:hover":{borderColor:ie.components.input.borderHover}}),containerChecked:(0,a.css)({backgroundColor:ie.colors.primary.main,borderColor:"transparent","&:hover":{backgroundColor:ie.colors.primary.shade,borderColor:"transparent"}}),containerDisabled:(0,a.css)({cursor:"initial",background:ie.colors.action.disabledBackground,borderColor:ie.colors.border.weak}),box:(0,a.css)({background:ie.colors.background.primary,display:"flex",alignItems:"center",justifyContent:"center",width:ie.spacing(2.5),height:ie.spacing(2.5),borderRadius:ie.shape.radius.default,transform:"translateX(0)",position:"relative",[ie.transitions.handleMotion("no-preference","reduce")]:{transition:"all 0.2s ease-in-out"},"&:after":(0,a.css)({content:"''",position:"absolute",top:0,left:0,right:0,bottom:0,borderRadius:ie.shape.radius.default,background:ie.colors.secondary.main,border:`1px solid ${ie.colors.secondary.border}`})}),boxChecked:(0,a.css)({transform:`translateX(calc(100% - ${ie.spacing(.25)}))`})}),M=({dashboard:ie})=>(0,n.jsx)(C,{checked:!!ie.state.isEditing,icon:"pen",label:(0,p.t)("dashboard.toolbar.new.edit-toggle.enter.label","Enter edit mode"),checkedLabel:(0,p.t)("dashboard.toolbar.new.edit-toggle.exit.label","Exit edit mode"),disabled:o._o.state.isPlaying,"data-testid":f.Tp.components.NavToolbar.editDashboard.editButton,onClick:ve=>{ve.preventDefault(),ve.stopPropagation(),ie.state.isEditing?ie.exitEditMode({skipConfirm:!1}):ie.onEnterEditMode()}});var O=e(43173),j=e(58662),U=e(55867),W=e(23289),B=e(93256),S=e(88559),_=e(45229),K=e(87745);const T=({dashboard:ie,menu:ve,onMenuVisibilityChange:le,groupTestId:Ee,buttonLabel:Re,buttonTooltip:Oe,buttonTestId:Se,onButtonClick:Te,arrowLabel:_e,arrowTestId:He,variant:tt="secondary"})=>{const[Je,Ge]=(0,d.useState)(!1);return(0,n.jsxs)(B.e,{"data-testid":Ee,onPointerDown:je=>{ie.state.isEditing&&ie.state.isDirty&&(je.preventDefault(),je.stopPropagation(),_.A.publish(new K.bY({title:(0,p.t)("dashboard.toolbar.new.share-export.modal.title","Save changes to dashboard?"),text:(0,p.t)("dashboard.toolbar.new.share-export.modal.text","You have unsaved changes to this dashboard. You need to save them before you can share it."),icon:"exclamation-triangle",noText:(0,p.t)("dashboard.toolbar.new.share-export.modal.noText","Discard"),yesText:(0,p.t)("dashboard.toolbar.new.share-export.modal.yesText","Save"),yesButtonVariant:"primary",onConfirm:()=>ie.openSaveDrawer({})})))},children:[(0,n.jsx)(x.$n,{"data-testid":Se,size:"sm",tooltip:Oe,variant:tt,onClick:Te,children:Re}),(0,n.jsx)(S.m,{overlay:ve,placement:"bottom-end",onVisibleChange:je=>{ie.state.isEditing&&ie.state.isDirty||(le?.(je),Ge(je))},children:(0,n.jsx)(x.$n,{"aria-label":_e,"data-testid":He,size:"sm",icon:Je?"angle-up":"angle-down",variant:tt})})]})},L=f.Tp.pages.Dashboard.DashNav.NewExportButton,A=({dashboard:ie})=>{const ve=O.$.featureToggles.kubernetesDashboards?(0,p.t)("dashboard.toolbar.new.export.tooltip.as-code","Export as code"):(0,p.t)("dashboard.toolbar.new.export.tooltip.json","Export as JSON");return(0,n.jsx)(T,{menu:()=>(0,n.jsx)(U.A,{dashboard:ie}),groupTestId:L.container,buttonLabel:(0,p.t)("dashboard.toolbar.new.export.title","Export"),buttonTooltip:ve,buttonTestId:L.container,onButtonClick:()=>{c.Ny.partial({shareView:j.wr.export}),W.c.sharingCategoryClicked({item:j.wr.export,shareResource:(0,j.hD)()})},arrowLabel:(0,p.t)("dashboard.toolbar.new.export.arrow","Export"),arrowTestId:L.arrowMenu,dashboard:ie})},N=({dashboard:ie})=>(0,n.jsx)(x.$n,{disabled:o._o.state.isPlaying,onClick:()=>{ie.onEnterEditMode(),ie.setState({editable:!0,meta:{...ie.state.meta,canEdit:!0}})},tooltip:(0,p.t)("dashboard.toolbar.new.enter-edit-mode.tooltip","This dashboard was marked as read only"),variant:"secondary",size:"sm","data-testid":f.Tp.components.NavToolbar.editDashboard.editButton,children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.toolbar.new.enter-edit-mode.label",children:"Make editable"})}),V=({})=>(0,n.jsx)(r.I,{"data-testid":f.Tp.pages.Dashboard.DashNav.playlistControls.next,tooltip:(0,p.t)("dashboard.toolbar.new.playlist-next","Go to next dashboard"),icon:"forward",onClick:()=>o._o.next(),narrow:!0}),z=({})=>(0,n.jsx)(r.I,{"data-testid":f.Tp.pages.Dashboard.DashNav.playlistControls.prev,tooltip:(0,p.t)("dashboard.toolbar.new.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:()=>o._o.prev()}),w=({})=>(0,n.jsx)(r.I,{onClick:()=>o._o.stop(),"data-testid":f.Tp.pages.Dashboard.DashNav.playlistControls.stop,children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.toolbar.new.playlist-stop",children:"Stop playlist"})});var H=e(87063);const Q=({dashboard:ie})=>{const{meta:ve,isDirty:le,uid:Ee}=ie.state,Re=!(Ee||ie.isManaged()),Oe=ie.isManaged();return Re?(0,n.jsx)(x.$n,{onClick:()=>ie.openSaveDrawer({}),tooltip:(0,p.t)("dashboard.toolbar.new.save-dashboard.tooltip","Save changes"),size:"sm",variant:"primary","data-testid":f.Tp.components.NavToolbar.editDashboard.saveButton,children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.toolbar.new.save-dashboard.label",children:"Save"})}):u.TP.hasEditPermissionInFolders&&!ve.canSave&&!ve.canMakeEditable&&!Oe?(0,n.jsx)(x.$n,{onClick:()=>ie.openSaveDrawer({saveAsCopy:!0}),tooltip:(0,p.t)("dashboard.toolbar.new.save-dashboard-copy.tooltip","Save as copy"),size:"sm",variant:le?"primary":"secondary",children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.toolbar.new.save-dashboard-copy.label",children:"Save as copy"})}):(0,n.jsxs)(B.e,{children:[(0,n.jsx)(x.$n,{onClick:()=>ie.openSaveDrawer({}),tooltip:(0,p.t)("dashboard.toolbar.new.save-dashboard.tooltip","Save changes"),size:"sm","data-testid":f.Tp.components.NavToolbar.editDashboard.saveButton,variant:le?"primary":"secondary",children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.toolbar.new.save-dashboard.label",children:"Save"})}),(0,n.jsx)(S.m,{overlay:(0,n.jsxs)(H.W,{children:[(0,n.jsx)(H.W.Item,{label:(0,p.t)("dashboard.toolbar.new.save-dashboard-short","Save"),icon:"save",onClick:()=>ie.openSaveDrawer({})}),(0,n.jsx)(H.W.Item,{label:(0,p.t)("dashboard.toolbar.new.save-dashboard-copy.label","Save as copy"),icon:"copy",onClick:()=>ie.openSaveDrawer({saveAsCopy:!0})})]}),children:(0,n.jsx)(x.$n,{"aria-label":(0,p.t)("dashboard.toolbar.new.more-save-options","More save options"),icon:"angle-down",variant:le?"primary":"secondary",size:"sm"})})]})},Z=({dashboard:ie})=>(0,n.jsx)(x.$n,{onClick:()=>ie.state.editPanel?.onSaveLibraryPanel(),tooltip:(0,p.t)("dashboard.toolbar.new.save-library-panel","Save library panel"),size:"sm",fill:"outline",variant:"primary","data-testid":f.Tp.components.NavToolbar.editDashboard.saveLibraryPanelButton,children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.toolbar.new.save-library-panel",children:"Save library panel"})});var Y=e(41053),X=e(16001),I=e(12434);const J=f.Tp.pages.Dashboard.DashNav.newShareButton,ee=({dashboard:ie})=>{const[ve,le]=(0,Y.A)(async()=>(W.c.toolbarShareClick(),await(0,I.Xe)(ie)),[ie]);return(0,n.jsx)(T,{menu:()=>(0,n.jsx)(X.Ay,{dashboard:ie}),onMenuVisibilityChange:Ee=>{Ee&&W.c.toolbarShareDropdownClick()},groupTestId:J.shareLink,buttonLabel:(0,p.t)("dashboard.toolbar.new.share.title","Share"),buttonTooltip:(0,p.t)("dashboard.toolbar.new.share.tooltip","Copy link"),buttonTestId:J.container,onButtonClick:le,arrowLabel:(0,p.t)("dashboard.toolbar.new.share.arrow","Share"),arrowTestId:J.arrowMenu,dashboard:ie,variant:ie.state.isEditing?"secondary":"primary"})},q=({dashboard:ie})=>(0,n.jsx)(x.$n,{onClick:()=>ie.state.editPanel?.onUnlinkLibraryPanel(),tooltip:(0,p.t)("dashboard.toolbar.new.unlink-library-panel","Unlink library panel"),size:"sm",fill:"outline",variant:"secondary","data-testid":f.Tp.components.NavToolbar.editDashboard.unlinkLibraryPanelButton,children:(0,n.jsx)(p.x6,{i18nKey:"dashboard.toolbar.new.unlink-library-panel",children:"Unlink library panel"})});var ne=e(12991);const se=({dashboard:ie})=>{const{editPanel:ve,editable:le,editview:Ee,isEditing:Re,uid:Oe,meta:Se,viewPanelScene:Te}=ie.useState(),{isPlaying:_e}=o._o.useState(),He=(0,s.of)(ce),tt=!!le,Je=!!Se.canSave,Ge=!!Oe,je=!!Re,Fe=!!Ee,Be=!!ve,Ke=!!Te,Ue=Be&&(0,g.ME)(ve.state.panelRef.resolve()),we=!Fe&&!Ke&&!Be,Xe=je&&we,nt=!!Se.isSnapshot,he=u.TP.hasEditPermissionInFolders,xe=Be&&!Fe&&!Ke,me=_e&&we&&!je,ye=Ge&&!nt&&!_e&&!Be;return(0,n.jsx)(i.U,{alignment:"right",className:He.container,children:(0,ne.g)([...(0,ne.f)(l.C.right,"",!Be&&!je),{key:"play-list-previous-button",component:z,group:"playlist",condition:me},{key:"play-list-stop-button",component:w,group:"playlist",condition:me},{key:"play-list-next-button",component:V,group:"playlist",condition:me},{key:"back-to-dashboard-button",component:v,group:"panel",condition:Fe||(Ke||Be)&&!Ue},{key:"discard-panel-button",component:E,group:"panel",condition:xe&&!Ue},{key:"discard-library-panel-button",component:h,group:"panel",condition:xe&&Ue},{key:"unlink-library-panel-button",component:q,group:"panel",condition:xe&&Ue},{key:"save-library-panel-button",component:Z,group:"panel",condition:xe&&Ue},{key:"dashboard-undo",component:de,group:"dashboard",condition:Xe&&ie.canEditDashboard()},{key:"dashboard-redo",component:ae,group:"dashboard",condition:Xe&&ie.canEditDashboard()},{key:"dashboard-settings",component:y,group:"dashboard",condition:Xe&&ie.canEditDashboard()},{key:"save-dashboard",component:Q,group:"save-edit",condition:je&&!Ue&&(Je||he)},{key:"make-dashboard-editable-button",component:N,group:"save-edit",condition:!Re&&ie.canEditDashboard()&&!Ke&&!tt&&!_e},{key:"edit-dashboard-switch",component:M,group:"save-edit",condition:ie.canEditDashboard()&&!Be&&!Ue&&!Ke&&tt&&!_e&&!Be},{key:"new-export-dashboard-button",component:A,group:"export-share",condition:ye},{key:"new-share-dashboard-button",component:ee,group:"export-share",condition:ye}],ie)})},oe="undo-button";function de({dashboard:ie}){const ve=ie.state.editPane,{undoStack:le}=ve.useState(),Ee=le[le.length-1],Re=`Undo${Ee?.description?` '${Ee.description}'`:""}`;return(0,n.jsx)(r.I,{id:oe,icon:"corner-up-left",disabled:le.length===0,onClick:()=>ve.undoAction(),tooltip:Re})}const fe="redo-button";function ae({dashboard:ie}){const ve=ie.state.editPane,{redoStack:le}=ve.useState(),Ee=le[le.length-1],Re=`Redo${Ee?.description?` '${Ee.description}'`:""}`;return(0,n.jsx)(r.I,{id:fe,icon:"corner-up-right",disabled:le.length===0,tooltip:Re,onClick:()=>ve.redoAction()})}const ce=ie=>({container:(0,a.css)({paddingLeft:ie.spacing(.5)})})},98036:(te,R,e)=>{"use strict";e.d(R,{d:()=>l,u:()=>g});var n=e(74848),a=e(22803),s=e(51898),i=e(92745),r=e(63142),u=e(99887),o=e(62905);const l=({dashboard:c})=>c.state.uid?(0,n.jsx)(f,{uid:c.state.uid}):null,g=f;function f({uid:c}){const{data:x}=(0,o.Bs)(c),v=(0,r.of)(p);return x?(0,n.jsx)(u.E,{color:"blue",text:(0,i.t)("dashboard.toolbar.new.public-dashboard","Public"),className:v.badge,"data-testid":s.Tp.pages.Dashboard.DashNav.publicDashboardTag}):null}const p=()=>({badge:(0,a.css)({color:"grey",backgroundColor:"transparent",border:"1px solid"})})},12991:(te,R,e)=>{"use strict";e.d(R,{f:()=>r,g:()=>i});var n=e(74848),a=e(5423),s=e(22429);function i(u,o){const l=[];let g="";for(const f of u)f.condition&&(f.group&&g&&g!==f.group&&l.push((0,n.jsx)(a.K,{},`${f.group}-separator`)),l.push((0,n.jsx)(f.component,{dashboard:o},f.key)),g=f.group);return l}function r(u,o,l){const g=(0,s.UA)().getCurrent();return u.reduce((f,p)=>{const c={dashboard:g};return p.show(c)&&f.push({key:f.length.toString(),group:o,condition:l,component:()=>(0,n.jsx)(p.component,{...c})}),f},[])}},35718:(te,R,e)=>{"use strict";e.d(R,{C:()=>g});var n=e(1906),a=e(57852),s=e(43173),i=e(78282),r=e(36674),u=e(78767),o=e(1682),l=e(8285);function g(v,m){const y=(0,l.YQ)(v);m.app=y.state.editPanel?n.Jk.PanelEditor:n.Jk.Dashboard,y.subscribeToState(h=>{h.editPanel?m.app=n.Jk.PanelEditor:m.app=n.Jk.Dashboard}),m.canAddAnnotations=()=>{const h=(0,l.YQ)(v);return!f(h)||!s.$.featureToggles.annotationPermissionUpdate&&!h.canEditDashboard()?!1:!!h.state.meta.annotationsPermissions?.dashboard.canAdd},m.canEditAnnotations=h=>{const d=(0,l.YQ)(v);return!s.$.featureToggles.annotationPermissionUpdate&&!d.canEditDashboard()?!1:h?!!d.state.meta.annotationsPermissions?.dashboard.canEdit:!!d.state.meta.annotationsPermissions?.organization.canEdit},m.canDeleteAnnotations=h=>{const d=(0,l.YQ)(v);return!s.$.featureToggles.annotationPermissionUpdate&&!d.canEditDashboard()?!1:h?!!d.state.meta.annotationsPermissions?.dashboard.canDelete:!!d.state.meta.annotationsPermissions?.organization.canDelete},m.onAnnotationCreate=async h=>{const d=(0,l.YQ)(v),E=h.from!==h.to,b={dashboardUID:d.state.uid,panelId:(0,l.Cs)(v),isRegion:E,time:h.from,timeEnd:E?h.to:0,tags:h.tags,text:h.description};await(0,u.vJ)(b),p(d),m.eventBus.publish(new a.We(b))},m.onAnnotationUpdate=async h=>{const d=(0,l.YQ)(v),E=h.from!==h.to,b={id:h.id,dashboardUID:d.state.uid,panelId:(0,l.Cs)(v),isRegion:E,time:h.from,timeEnd:E?h.to:0,tags:h.tags,text:h.description};await(0,u.rJ)(b),p(d),m.eventBus.publish(new a.We(b))},m.onAnnotationDelete=async h=>{await(0,u.Xm)({id:h}),p((0,l.YQ)(v)),m.eventBus.publish(new a.We({id:h}))},m.onAddAdHocFilter=h=>{const d=(0,l.YQ)(v),E=(0,l.un)(v);if(!E)return;const b=c(d,E.state.datasource);x(b,h)},m.onUpdateData=h=>Promise.resolve(!0)}function f(v){const m=o.b4.getDataLayers(v);for(const y of m.state.annotationLayers)if(y instanceof r.tV.g&&y.state.isEnabled&&y.state.query.builtIn)return y}function p(v){const m=f(v);m&&m.runLayer()}function c(v,m){const y=r.jh.getVariables(v);for(const d of y.state.variables)if(r.Go.isAdHocVariable(d)){const E=d.state.datasource;if(E===m||E?.uid===m?.uid)return d}const h=new r.H9({name:"Filters",datasource:m,supportsMultiValueOperators:!!(0,i.l)().getInstanceSettings(m)?.meta.multiValueFilterOperators,useQueriesAsFilterForOptions:!0,layout:s.$.featureToggles.newFiltersUI?"combobox":void 0});return y.setState({variables:[...y.state.variables,h]}),h}function x(v,m){const y=v.state.filters.findIndex(h=>h.key===m.key&&h.value===m.value&&h.operator!==m.operator);if(y>=0){const h=v.state.filters.slice();h.splice(y,1,m),v.updateFilters(h);return}v.updateFilters([...v.state.filters,m])}},3688:(te,R,e)=>{"use strict";e.d(R,{y:()=>n});function n(a){return"isDashboardLayoutItem"in a}},39765:(te,R,e)=>{"use strict";e.d(R,{d:()=>a});var n=e(68388);class a extends n.x{static{this.type="dashboard-repeats-processed"}}},15759:(te,R,e)=>{"use strict";e.d(R,{l:()=>n});function n(a){return"switchLayout"in a}},84019:(te,R,e)=>{"use strict";e.d(R,{V:()=>l,X:()=>o});var n=e(92745),a=e(43173),s=e(59857),i=e(78947),r=e(75735),u=e(28998);async function o(g){let f=s.Ye.templating?.list;if(a.$.featureToggles.newDashboardWithFiltersAndGroupBy){const c=await(0,u.tR)().get();if(c.getTagKeys){const x={type:c.meta.id,uid:c.uid},v={datasource:x,filters:[],name:"Filter",type:"adhoc"},m={datasource:x,name:"Group by",type:"groupby"};f=(f||[]).concat([v,m])}}const p={meta:{canStar:!1,canShare:!1,canDelete:!1,isNew:!0,folderUid:""},dashboard:{...s.Ye,uid:"",title:(0,n.t)("dashboard-scene.build-new-dashboard-save-model.data.title.new-dashboard","New dashboard"),panels:[],timezone:a.$.bootData.user?.timezone||s.Ye.timezone}};return f&&(p.dashboard.templating={list:f}),g&&(p.meta.folderUid=g),p}async function l(g){let f=(0,i.xE)().variables;if(a.$.featureToggles.newDashboardWithFiltersAndGroupBy){const c=await(0,u.tR)().get();if(c.getTagKeys){const x={type:c.meta.id,uid:c.uid},v={kind:"AdhocVariable",spec:{...(0,i.IP)(),name:"Filter",datasource:x}},m={kind:"GroupByVariable",spec:{...(0,i.Bj)(),datasource:x,name:"Group by"}};f=(f||[]).concat([v,m])}}const p={apiVersion:"v2alpha1",kind:"DashboardWithAccessInfo",spec:{...(0,i.xE)(),title:(0,n.t)("dashboard-scene.build-new-dashboard-save-model-v2.data.title.new-dashboard","New dashboard"),timeSettings:{...(0,i.ft)(),timezone:a.$.bootData.user?.timezone||(0,i.ft)().timezone}},access:{canStar:!1,canShare:!1,canDelete:!1},metadata:{name:"",resourceVersion:"0",creationTimestamp:"0",annotations:{[r.ew]:""}}};return f&&(p.spec.variables=f),g&&p.metadata.annotations&&(p.metadata.annotations[r.ew]=g),p}},78320:(te,R,e)=>{"use strict";e.d(R,{o:()=>a,x:()=>n});const n={name:"grafana",uid:"grafana"},a=1},39557:(te,R,e)=>{"use strict";e.d(R,{B:()=>r});var n=e(74848),a=e(62467),s=e(81160),i=e(36674);class r extends i.n8{constructor(o){super({name:"",type:"snapshot",isReadOnly:!0,query:"",value:"",text:"",options:[],...o}),this._variableDependency=new i.Sh(this,{statePaths:[]})}getValueOptions(o){const f=(i.jh.interpolate(this,this.state.query).match(/(?:\\,|[^,])+/g)??[]).map(p=>{p=p.replace(/\\,/g,",");const c=/^(.+)\s:\s(.+)$/g.exec(p)??[];if(c.length===3){const[,x,v]=c;return{label:x.trim(),value:v.trim()}}else return{label:p.trim(),value:p.trim()}});return(0,a.of)(f)}validateAndUpdate(){return this.getValueOptions({}).pipe((0,s.T)(o=>(this.state.options!==o&&this._updateValueGivenNewOptions(o),{})))}static{this.Component=({model:o})=>(0,n.jsx)(i.WY,{model:o})}_updateValueGivenNewOptions(o){const{value:l,text:g}=this.state,f={options:o,loading:!1,value:l??[],text:g??[]};this.setState(f)}}},99392:(te,R,e)=>{"use strict";e.d(R,{O:()=>a});var n=e(36674);function a(s){const i=[];for(const r of s){if(!(r instanceof n.tV.g))continue;const u={...r.state.query,enable:!!r.state.isEnabled,hide:!!r.state.isHidden};i.push(u)}return i}},4974:(te,R,e)=>{"use strict";e.d(R,{Dr:()=>f,K4:()=>l,i6:()=>x,zd:()=>g});var n=e(78947),a=e(25953),s=e(29425),i=e(8835),r=e(1682),u=e(8285),o=e(67350);function l(v){const{maxColumnCount:m,fillScreen:y,columnWidth:h,rowHeight:d,layout:E}=v.state,b=(0,n.kH)();return{kind:"AutoGridLayout",spec:{maxColumnCount:m,fillScreen:y===b.fillScreen?void 0:y,...p(h),...c(d),items:E.state.children.map(g)}}}function g(v){const y={kind:"AutoGridLayoutItem",spec:{element:{kind:"ElementReference",name:r.b4.getElementIdentifierForVizPanel(v.state?.body)}}},h=v.state.conditionalRendering?.serialize();return h?.spec.items.length&&(y.spec.conditionalRendering=h),v.state.variableName&&(y.spec.repeat={mode:"variable",value:v.state.variableName}),y}function f(v,m,y,h){if(v.kind!=="AutoGridLayout")throw new Error("Invalid layout kind");const d=(0,n.kH)(),{maxColumnCount:E,columnWidthMode:b,columnWidth:D,rowHeightMode:C,rowHeight:P,fillScreen:M}=v.spec,O=v.spec.items.map(W=>x(W,m,h)),j=b==="custom"?D:b,U=C==="custom"?P:C;return new i.X2({maxColumnCount:E,columnWidth:j,rowHeight:U,fillScreen:M??d.fillScreen,layout:new s.o({templateColumns:(0,i.Kf)(E??d.maxColumnCount,j??i.j),autoRows:(0,i.jo)(U??i.YL,M??!1),children:O})})}function p(v){return{columnWidthMode:typeof v=="number"?"custom":v,columnWidth:typeof v=="number"?v:void 0}}function c(v){return{rowHeightMode:typeof v=="number"?"custom":v,rowHeight:typeof v=="number"?v:void 0}}function x(v,m,y){const h=m[v.spec.element.name];if(!h)throw new Error(`Panel with uid ${v.spec.element.name} not found in the dashboard elements`);let d;return y&&(d=y()),new a.X({key:(0,u.ty)(d??h.spec.id),body:h.kind==="LibraryPanel"?(0,o.kB)(h,d):(0,o.Gl)(h,d),variableName:v.spec.repeat?.value,conditionalRendering:(0,o.Xy)(v)})}},17340:(te,R,e)=>{"use strict";e.d(R,{SW:()=>l,i2:()=>p,v2:()=>g,ve:()=>m});var n=e(36674),a=e(73427),s=e(93389),i=e(1131),r=e(1682),u=e(8285),o=e(67350);function l(y,h){return{kind:"GridLayout",spec:{items:f(y,h)}}}function g(y,h,d,E){if(y.kind!=="GridLayout")throw new Error("Invalid layout kind");return new i.D({grid:new n.hy({isLazy:!(d||a.TP.user.authenticatedBy==="render"),children:x(y,h,E)})})}function f(y,h){let d=[];for(const E of y.state.grid.state.children)E instanceof s.U&&(E.state.variableName?d=d.concat(c(E,h)):d.push(p(E)));return d}function p(y,h){let d,E=0,b=0,D=0,C=0,P=y;if(!(P.state.body instanceof n.Eb))throw new Error("DashboardGridItem body expected to be VizPanel");C=(P.state.variableName?P.state.itemHeight:P.state.height)??0,E=P.state.x??0,b=P.state.y??0,D=P.state.width??0;const M=P.state.variableName;let O=r.b4.getElementIdentifierForVizPanel(P.state.body);if(d={kind:"GridLayoutItem",spec:{x:E,y:h??b,width:D,height:C,element:{kind:"ElementReference",name:O}}},M){const j={mode:"variable",value:M};P.state.maxPerRow&&(j.maxPerRow=P.getMaxPerRow()),P.state.repeatDirection&&(j.direction=P.getRepeatDirection()),d.spec.repeat=j}if(!d)throw new Error("Unsupported grid item type");return d}function c(y,h=!1){if(h){if(y.state.body instanceof n.Eb&&(0,u.ME)(y.state.body))return[];if(y.state.repeatedPanels){const{h:d,w:E,columnCount:b}=(0,u.bR)(y);return y.state.repeatedPanels.map((C,P)=>{let M=0,O=0;y.state.repeatDirection==="v"?(M=y.state.x,O=P*d):(M=P%b*E,O=y.state.y+Math.floor(P/b)*d);const j={x:M,y:O,w:E,h:d};return{kind:"GridLayoutItem",spec:{x:j.x,y:j.y,width:j.w,height:j.h,repeat:{mode:"variable",value:y.state.variableName,maxPerRow:y.getMaxPerRow(),direction:y.state.repeatDirection},element:{kind:"ElementReference",name:C.state.key}}}})}return[]}else return[p(y)]}function x(y,h,d){return y.spec.items.map(b=>{if(b.kind==="GridLayoutItem")return m(b,h,d);throw new Error(`Unknown layout element kind: ${b.kind}`)})}function v(y,h,d,E){let b;return h.kind==="Panel"?b=(0,o.Gl)(h,E):b=(0,o.kB)(h,E),new s.U({key:`grid-item-${E??h.spec.id}`,x:y.x,y:d??y.y,width:y.repeat?.direction==="h"?24:y.width,height:y.height,itemHeight:y.height,body:b,variableName:y.repeat?.value,repeatDirection:y.repeat?.direction,maxPerRow:y.repeat?.maxPerRow})}function m(y,h,d){const E=h[y.spec.element.name];if(!E)throw new Error(`Panel with uid ${y.spec.element.name} not found in the dashboard elements`);let b;return d&&(b=d()),v(y.spec,E,void 0,b)}},76584:(te,R,e)=>{"use strict";e.d(R,{HQ:()=>o,Vf:()=>l,aL:()=>u,g5:()=>g});var n=e(97335),a=e(97883),s=e(3371),i=e(59006),r=e(67350);function u(f){return{kind:"RowsLayout",spec:{rows:f.state.rows.filter(p=>!(0,s.Ry)(p.state.key)).map(o)}}}function o(f){const p=f.state.layout.serialize(),c={kind:"RowsLayoutRow",spec:{title:f.state.title,collapse:f.state.collapse,layout:p,fillScreen:f.state.fillScreen,hideHeader:f.state.hideHeader,...f.state.repeatByVariable&&{repeat:{mode:"variable",value:f.state.repeatByVariable}}}},x=f.state.conditionalRendering?.serialize();return x?.spec.items.length&&(c.spec.conditionalRendering=x),c}function l(f,p,c,x){if(f.kind!=="RowsLayout")throw new Error("Invalid layout kind");const v=f.spec.rows.map(m=>g(m,p,c,x));return new a.V({rows:v})}function g(f,p,c,x){const v=f.spec.layout;return new n.o({title:f.spec.title,collapse:f.spec.collapse,hideHeader:f.spec.hideHeader,fillScreen:f.spec.fillScreen,repeatByVariable:f.spec.repeat?.value,layout:i.j.get(v.kind).deserialize(v,p,c,x),conditionalRendering:(0,r.Xy)(f)})}},6461:(te,R,e)=>{"use strict";e.d(R,{Yz:()=>l,lX:()=>o,wm:()=>g,zE:()=>f});var n=e(92769),a=e(34031),s=e(37365),i=e(3371),r=e(59006),u=e(67350);function o(p){return{kind:"TabsLayout",spec:{tabs:p.state.tabs.filter(c=>!(0,i.Ry)(c.state.key)).map(l)}}}function l(p){const c=p.state.layout.serialize(),x={kind:"TabsLayoutTab",spec:{title:p.state.title,layout:c}},v=p.state.conditionalRendering?.serialize();if(v?.spec.items.length&&(x.spec.conditionalRendering=v),p.state.$behaviors){for(const m of p.state.$behaviors)if(m instanceof a.T){if(x.spec.repeat)throw new Error("Multiple repeaters are not supported");x.spec.repeat={value:m.state.variableName,mode:"variable"}}}return x}function g(p,c,x,v){if(p.kind!=="TabsLayout")throw new Error("Invalid layout kind");const m=p.spec.tabs.map(y=>f(y,c,x,v));return new s.K({tabs:m})}function f(p,c,x,v){const m=p.spec.layout,y=p.spec.repeat?[new a.T({variableName:p.spec.repeat.value})]:void 0;return new n.V({title:p.spec.title,layout:r.j.get(m.kind).deserialize(m,c,x,v),$behaviors:y,conditionalRendering:(0,u.Xy)(p)})}},59006:(te,R,e)=>{"use strict";e.d(R,{j:()=>u});var n=e(42954),a=e(4974),s=e(17340),i=e(76584),r=e(6461);const u=new n.O(()=>[{id:"GridLayout",name:"Grid Layout",deserialize:s.v2},{id:"AutoGridLayout",name:"Auto Grid Layout",deserialize:a.Dr},{id:"RowsLayout",name:"Rows Layout",deserialize:i.Vf},{id:"TabsLayout",name:"Tabs Layout",deserialize:r.wm}])},67350:(te,R,e)=>{"use strict";e.d(R,{Gl:()=>d,IC:()=>W,Kq:()=>C,V6:()=>B,Xy:()=>U,kB:()=>E});var n=e(43173),a=e(36674),s=e(18615),i=e(57558),r=e(55793),u=e(84655),o=e(36605),l=e(7094),g=e(32540),f=e(37040),p=e(66251),c=e(81657),x=e(35718),v=e(8285),m=e(62265),y=e(3281),h=e(39508);function d(S,_){const K=[];K.push(new g.$({rawLinks:S.spec.links,menu:new g.m({$behaviors:[f.oV]})})),K.push(new p.W);const T=S.spec.data.spec.queryOptions,L=(T.timeFrom||T.timeShift)&&!T.hideTimeOverride,A={key:(0,v.XA)(_??S.spec.id),title:S.spec.title?.substring(0,5e3),description:S.spec.description,pluginId:S.spec.vizConfig.kind,options:S.spec.vizConfig.spec.options,fieldConfig:(0,y.So)(S.spec.vizConfig.spec.fieldConfig),pluginVersion:S.spec.vizConfig.spec.pluginVersion,displayMode:S.spec.transparent?"transparent":"default",hoverHeader:!S.spec.title&&!L,hoverHeaderOffset:0,seriesLimit:n.$.panelSeriesLimit,$data:b(S),titleItems:K,$behaviors:[],extendPanelContext:x.C};return n.$.publicDashboardAccessToken||(A.menu=new a.Lw({$behaviors:[f._i]})),(T.timeFrom||T.timeShift)&&(A.$timeRange=new c.v({timeFrom:T.timeFrom,timeShift:T.timeShift,hideTimeOverride:T.hideTimeOverride})),new a.Eb(A)}function E(S,_){const K=[];K.push(new g.$({rawLinks:[],menu:new g.m({$behaviors:[f.oV]})})),K.push(new p.W);const T={key:(0,v.XA)(_??S.spec.id),titleItems:K,seriesLimit:n.$.panelSeriesLimit,$behaviors:[new l.u({uid:S.spec.libraryPanel.uid,name:S.spec.libraryPanel.name})],extendPanelContext:x.C,pluginId:l.u.LOADING_VIZ_PANEL_PLUGIN_ID,title:S.spec.title,options:{},fieldConfig:{defaults:{},overrides:[]}};return n.$.publicDashboardAccessToken||(T.menu=new a.Lw({$behaviors:[f._i]})),new a.Eb(T)}function b(S){const _=S.spec,K=_.data?.spec.queries??[];if(!K?.length||n.$.panels[_.vizConfig.kind]?.skipDataQuery)return;let T;const L=D(S);return T=new a.dt({datasource:L,queries:K.map(O),maxDataPoints:_.data.spec.queryOptions.maxDataPoints??void 0,maxDataPointsFromWidth:!0,cacheTimeout:_.data.spec.queryOptions.cacheTimeout,queryCachingTTL:_.data.spec.queryOptions.queryCachingTTL,minInterval:_.data.spec.queryOptions.interval??void 0,dataLayerFilter:{panelId:_.id},$behaviors:[new o.L({})]}),new a.Es({$data:T,transformations:_.data.spec.transformations.map(A=>({...A.spec,topic:(0,h.MM)(A.spec.topic)}))})}function D(S){if(!S.spec.data?.spec.queries?.length)return;let _,K=!1;return S.spec.data.spec.queries.forEach(T=>{_?(_.uid!==T.spec.datasource?.uid||_.type!==T.spec.datasource?.type)&&(K=!0):T.spec.datasource?.uid?_=T.spec.datasource:_=P(T)}),K?{type:"mixed",uid:s.uv}:_}function C(S){return M(S.spec.datasource,S.spec.query.kind)}function P(S){return M(S.spec.datasource,S.spec.query.kind)}function M(S,_){if(S?.uid)return S;const K=n.$.bootData.settings.defaultDatasource,T=n.$.bootData.settings.datasources;if(T&&T[K]&&T[K].meta.id===_)return{uid:T[K].uid||T[K].name,type:T[K].meta.id};const L=T&&Object.values(T).find(A=>A.meta.id===_);if(L)return{uid:L.uid,type:L.meta.id};if(T&&T[K])return console.warn(`Could not find datasource for query kind ${_}, defaulting to ${T[K].meta.id}`),{uid:T[K].uid||T[K].name,type:T[K].meta.id}}function O(S){return{refId:S.spec.refId,datasource:P(S),hide:S.spec.hidden,...S.spec.query.spec}}function j(S){return S.serialize()}function U(S){if(!S.spec.conditionalRendering)return i.p.createEmpty();const _=u.k.get(S.spec.conditionalRendering.kind).deserialize(S.spec.conditionalRendering);if(_&&!(_ instanceof r.M))throw new Error("Conditional rendering must always start with a root group");return new i.p({rootGroup:_})}function W(S,_){const K=S.getVizPanels(),T=_.serializer.getDSReferencesMapping(),L=K.map(A=>(0,m.GB)(A,T));return(0,m.Cy)(L,_)}function B(S,_){return(0,m.Cy)([(0,m.GB)(S.state.body,_.serializer.getDSReferencesMapping())],_)}},84500:(te,R,e)=>{"use strict";e.d(R,{$o:()=>p,CN:()=>g,Gs:()=>c,Ru:()=>x});var n=e(43173),a=e(36674),s=e(59857),i=e(21275),r=e(78947),u=e(8285),o=e(62265),l=e(39508);function g(v,m){const y=[];for(const h of v.state.variables){const d={name:h.state.name,label:h.state.label,description:h.state.description??void 0,skipUrlSync:!!h.state.skipUrlSync,hide:h.state.hide||s.zL.dontHide,type:h.state.type};if(a.Go.isQueryVariable(h)){let E=[];((0,l.qJ)(h.state.refresh)==="never"||m)&&(E=f(h.state)),y.push({...d,current:{value:h.state.value,text:h.state.text},options:E,query:h.state.query,definition:h.state.definition,datasource:(0,o.AB)(v,h,"variable"),sort:h.state.sort,refresh:h.state.refresh,regex:h.state.regex,allValue:h.state.allValue,includeAll:h.state.includeAll,multi:h.state.isMulti,allowCustomValue:h.state.allowCustomValue,skipUrlSync:h.state.skipUrlSync})}else if(a.Go.isCustomVariable(h))y.push({...d,current:{text:h.state.value,value:h.state.value},options:f(h.state),query:h.state.query,multi:h.state.isMulti,allValue:h.state.allValue,includeAll:h.state.includeAll,allowCustomValue:h.state.allowCustomValue});else if(a.Go.isDataSourceVariable(h))y.push({...d,current:{value:h.state.value,text:h.state.text},options:[],regex:h.state.regex,refresh:i.CO.onDashboardLoad,query:h.state.pluginId,multi:h.state.isMulti,allValue:h.state.allValue,includeAll:h.state.includeAll,allowCustomValue:h.state.allowCustomValue});else if(a.Go.isConstantVariable(h))y.push({...d,current:{value:h.state.value,text:h.state.value},query:h.state.value,hide:s.zL.hideVariable});else if(a.Go.isIntervalVariable(h)){const E=(0,u.bx)(h.state.intervals);y.push({...d,current:{text:h.state.value,value:h.state.value},query:E,refresh:h.state.refresh,options:h.state.intervals.map(b=>({value:b,text:b,selected:b===h.state.value})),auto:h.state.autoEnabled,auto_min:h.state.autoMinInterval,auto_count:h.state.autoStepCount})}else if(a.Go.isTextBoxVariable(h)){const E={text:h.state.value,value:h.state.value};y.push({...d,current:E,options:[{...E,selected:!0}],query:h.state.value})}else if(a.Go.isGroupByVariable(h)&&n.$.featureToggles.groupByVariable){const E=h.state.defaultValue?{value:h.state.defaultValue.value,text:h.state.defaultValue.text}:void 0;y.push({...d,datasource:h.state.datasource,options:h.state.defaultOptions?.map(b=>({text:b.text,value:String(b.value)})),current:{text:h.state.text,value:h.state.value},defaultValue:E,allowCustomValue:h.state.allowCustomValue})}else if(a.Go.isAdHocVariable(h))y.push({...d,datasource:h.state.datasource,allowCustomValue:h.state.allowCustomValue,baseFilters:h.state.baseFilters||[],filters:[...c(h.state.originFilters),...h.state.filters],defaultKeys:h.state.defaultKeys});else if(h.state.type!=="system")throw new Error("Unsupported variable type")}for(const h of y)h.hide===s.zL.dontHide&&delete h.hide,h.skipUrlSync||delete h.skipUrlSync,h.label===""&&delete h.label,h.multi||delete h.multi,h.sort===i.ZG.disabled&&delete h.sort;return y}function f(v){return v.options.map(m=>({value:String(m.value),text:m.label,selected:Array.isArray(v.value)?v.value.includes(m.value):v.value===m.value}))}function p(v,m,y){let h=[];for(const d of v.state.variables){const E={name:d.state.name,label:d.state.label,description:d.state.description??void 0,skipUrlSync:!!d.state.skipUrlSync,hide:(0,l.NB)(d.state.hide)||(0,r.SR)()},b={value:d.state.value,text:d.state.text};let D=[];if(a.Go.isQueryVariable(d)){((0,l.qJ)(d.state.refresh)==="never"||m)&&(D=f(d.state));const C=d.state.query;let P;typeof C!="string"?P={kind:d.state.datasource?.type??(0,o.lD)(C),spec:(0,o.c8)(C)}:P={kind:d.state.datasource?.type??(0,o.lD)(C),spec:{[l.sB]:C}};const M={kind:"QueryVariable",spec:{...E,current:b,options:D,query:P,definition:d.state.definition,datasource:(0,o.AB)(v,d,"variable",void 0,y),sort:(0,l.LY)(d.state.sort),refresh:(0,l.qJ)(d.state.refresh),regex:d.state.regex,allValue:d.state.allValue,includeAll:d.state.includeAll||!1,multi:d.state.isMulti||!1,skipUrlSync:d.state.skipUrlSync||!1,allowCustomValue:d.state.allowCustomValue??!0}};h.push(M)}else if(a.Go.isCustomVariable(d)){D=f(d.state);const C={kind:"CustomVariable",spec:{...E,current:b,options:D,query:d.state.query,multi:d.state.isMulti||!1,allValue:d.state.allValue,includeAll:d.state.includeAll??!1,allowCustomValue:d.state.allowCustomValue??!0}};h.push(C)}else if(a.Go.isDataSourceVariable(d)){const C={kind:"DatasourceVariable",spec:{...E,current:b,options:[],regex:d.state.regex,refresh:"onDashboardLoad",pluginId:d.state.pluginId,multi:d.state.isMulti||!1,includeAll:d.state.includeAll||!1,allowCustomValue:d.state.allowCustomValue??!0}};d.state.allValue!==void 0&&(C.spec.allValue=d.state.allValue),h.push(C)}else if(a.Go.isConstantVariable(d)){const C={kind:"ConstantVariable",spec:{...E,current:{...b,text:String(d.state.value)},query:d.state.value}};h.push(C)}else if(a.Go.isIntervalVariable(d)){const C=(0,u.bx)(d.state.intervals),P={kind:"IntervalVariable",spec:{...E,current:{...b,text:d.state.value},query:C,refresh:"onTimeRangeChanged",options:d.state.intervals.map(M=>({value:M,text:M,selected:M===d.state.value})),auto:d.state.autoEnabled,auto_min:d.state.autoMinInterval,auto_count:d.state.autoStepCount}};h.push(P)}else if(a.Go.isTextBoxVariable(d)){const C={text:d.state.value,value:d.state.value},P={kind:"TextVariable",spec:{...E,current:C,query:d.state.value}};h.push(P)}else if(a.Go.isGroupByVariable(d)&&n.$.featureToggles.groupByVariable){D=f(d.state);const C=d.state.defaultValue?{value:d.state.defaultValue.value,text:d.state.defaultValue.text}:void 0,P={kind:"GroupByVariable",spec:{...E,datasource:d.state.datasource||{},options:d.state.defaultOptions?.map(M=>({text:M.text,value:String(M.value)}))||[],current:b,defaultValue:C,multi:d.state.isMulti||!1}};h.push(P)}else if(a.Go.isAdHocVariable(d)){const C={kind:"AdhocVariable",spec:{...E,name:d.state.name,datasource:d.state.datasource||{},baseFilters:c(d.state.baseFilters)||[],filters:[...c(d.state.originFilters),...c(d.state.filters)],defaultKeys:d.state.defaultKeys||[],allowCustomValue:d.state.allowCustomValue??!0}};h.push(C)}else if(d.state.type!=="system")throw new Error("Unsupported variable type: "+d.state.type)}return h}function c(v){return v?.filter(m=>!m.origin||m.origin==="dashboard")||[]}function x(v){return v.state.type!=="system"}},31119:(te,R,e)=>{"use strict";e.d(R,{dj:()=>M});var n=e(2543),a=e.n(n),s=e(43173),i=e(78282),r=e(36674),u=e(78947),o=e(8255),l=e(75735),g=e(11968),f=e(49e3),p=e(34960),c=e(88632),x=e(88499),v=e(44804),m=e(72746),y=e(8285),h=e(39557),d=e(59006),E=e(67350),b=e(65333),D=e(3281),C=e(39508);const P="default";function M(A){const{spec:N,metadata:V,apiVersion:z}=A,w=L(N);w&&N.annotations.unshift(w);const H=N.annotations.map(ee=>{let q=ee.spec;return q?.legacyOptions&&(q={...q,...q.legacyOptions}),new f.g({key:(0,n.uniqueId)("annotations-"),query:{...q,builtIn:ee.spec.builtIn?1:0},name:ee.spec.name,isEnabled:!!ee.spec.enable,isHidden:!!ee.spec.hide})}),Q=!!N.editable,Z=A.access.canSave!==!1;let Y;V.labels?.[l.Y5]&&(Y=parseInt(V.labels[l.Y5],10));const X={canShare:A.access.canShare!==!1,canSave:Z,canStar:A.access.canStar!==!1,canEdit:A.access.canEdit!==!1,canDelete:A.access.canDelete!==!1,canAdmin:A.access.canAdmin!==!1,url:A.access.url,slug:A.access.slug,annotationsPermissions:A.access.annotationsPermissions,created:V.creationTimestamp,createdBy:V.annotations?.[l.hc],updated:V.annotations?.[l.xU],updatedBy:V.annotations?.[l.Qu],folderUid:V.annotations?.[l.ew],isSnapshot:!!V.annotations?.[l.qw],showSettings:!!A.access.canEdit,canMakeEditable:Z&&!Q,hasUnsavedFolderChange:!1,version:V.generation,k8s:V};Q||(X.canEdit=!1,X.canDelete=!1,X.canSave=!1);const I=d.j.get(N.layout.kind).deserialize(N.layout,N.elements,N.preload),J=new m.H$({description:N.description,editable:N.editable,preload:N.preload,id:Y,isDirty:!1,links:N.links,meta:X,tags:N.tags,title:N.title,uid:V.name,version:V.generation,body:I,$timeRange:new r.JZ({from:N.timeSettings.from,to:N.timeSettings.to,fiscalYearStartMonth:N.timeSettings.fiscalYearStartMonth,timeZone:N.timeSettings.timezone,weekStart:N.timeSettings.weekStart,UNSAFE_nowDelay:N.timeSettings.nowDelay}),$variables:O(N,X.isSnapshot??!1),$behaviors:[new r.Gg.K2({sync:(0,D.Y_)(N.cursorSync)}),new r.Gg.Hf,x.M,b.A2,new r.Gg.en({enabled:N.liveNow}),g.U,new v.s({reloadOnParamsChange:s.$.featureToggles.reloadDashboardsOnParamsChange&&!1,uid:Y?.toString()})],$data:new c.s({annotationLayers:H}),controls:new p.x({timePicker:new r.KE({quickRanges:N.timeSettings.quickRanges,defaultQuickRanges:s.$.quickRanges}),refreshPicker:new r.WM({refresh:N.timeSettings.autoRefresh,intervals:N.timeSettings.autoRefreshIntervals,withText:!0}),hideTimeControls:N.timeSettings.hideTimepicker})},"v2");return J.setInitialSaveModel(A.spec,A.metadata,z),J}function O(A,N){let V;return N?V=S(A):V=j(A),V}function j(A){const N=A.variables.map(V=>{try{return U(V)}catch(z){return console.error(z),null}}).filter(V=>!!V);return s.$.featureToggles.scopeFilters&&N.push(new r.Kg({enable:!0})),new r.Pj({variables:N})}function U(A){const N={name:A.spec.name,label:A.spec.label,description:A.spec.description};if(A.kind===(0,u.l_)().kind)return new r.H9({...N,description:A.spec.description,skipUrlSync:A.spec.skipUrlSync,hide:(0,D.cc)(A.spec.hide),datasource:A.spec.datasource,applyMode:"auto",filters:A.spec.filters??[],baseFilters:A.spec.baseFilters??[],defaultKeys:A.spec.defaultKeys,useQueriesAsFilterForOptions:!0,layout:s.$.featureToggles.newFiltersUI?"combobox":void 0,supportsMultiValueOperators:!!(0,i.l)().getInstanceSettings(A.spec.datasource)?.meta.multiValueFilterOperators});if(A.kind===(0,u.ns)().kind)return new r.yP({...N,value:A.spec.current?.value??"",text:A.spec.current?.text??"",query:A.spec.query,isMulti:A.spec.multi,allValue:A.spec.allValue||void 0,includeAll:A.spec.includeAll,defaultToAll:!!A.spec.includeAll,skipUrlSync:A.spec.skipUrlSync,hide:(0,D.cc)(A.spec.hide)});if(A.kind===(0,u.m6)().kind)return new r.fS({...N,value:A.spec.current?.value??"",text:A.spec.current?.text??"",query:W(A),datasource:(0,E.Kq)(A),sort:(0,D.ES)(A.spec.sort),refresh:(0,D.tH)(A.spec.refresh),regex:A.spec.regex,allValue:A.spec.allValue||void 0,includeAll:A.spec.includeAll,defaultToAll:!!A.spec.includeAll,isMulti:A.spec.multi,skipUrlSync:A.spec.skipUrlSync,hide:(0,D.cc)(A.spec.hide),definition:A.spec.definition});if(A.kind===(0,u.X1)().kind)return new r.mI({...N,value:A.spec.current?.value??"",text:A.spec.current?.text??"",regex:A.spec.regex,pluginId:A.spec.pluginId,allValue:A.spec.allValue||void 0,includeAll:A.spec.includeAll,defaultToAll:!!A.spec.includeAll,skipUrlSync:A.spec.skipUrlSync,isMulti:A.spec.multi,hide:(0,D.cc)(A.spec.hide),defaultOptionEnabled:A.spec.current?.value===P&&A.spec.current?.text==="default"});if(A.kind===(0,u.pK)().kind){const V=(0,y.Sm)(A.spec.query),z=B(A,V);return new r.Yj({...N,value:z,intervals:V,autoEnabled:A.spec.auto,autoStepCount:A.spec.auto_count,autoMinInterval:A.spec.auto_min,refresh:(0,D.tH)(A.spec.refresh),skipUrlSync:A.spec.skipUrlSync,hide:(0,D.cc)(A.spec.hide)})}else{if(A.kind===(0,u.ET)().kind)return new r.x0({...N,value:A.spec.query,skipUrlSync:A.spec.skipUrlSync,hide:(0,D.cc)(A.spec.hide)});if(A.kind===(0,u.t1)().kind){let V;return A?.spec.current?.value?typeof A.spec.current.value=="string"?V=A.spec.current.value:V=A.spec.current.value[0]:V=A.spec.query,new r.TS({...N,value:V,skipUrlSync:A.spec.skipUrlSync,hide:(0,D.cc)(A.spec.hide)})}else{if(s.$.featureToggles.groupByVariable&&A.kind===(0,u.uB)().kind)return new r.ZG({...N,datasource:A.spec.datasource,value:A.spec.current?.value||[],text:A.spec.current?.text||[],skipUrlSync:A.spec.skipUrlSync,isMulti:A.spec.multi,hide:(0,D.cc)(A.spec.hide),defaultOptions:A.options});throw new Error(`Scenes: Unsupported variable type ${A.kind}`)}}}function W(A){return C.sB in A.spec.query.spec?A.spec.query.spec[C.sB]??"":{...A.spec.query.spec,refId:A.spec.query.spec.refId??"A"}}function B(A,N){const V=Array.isArray(A.spec.current.value)?A.spec.current.value[0]:A.spec.current.value;return V.startsWith("$__auto_interval_")?"$__auto":N.includes(V)?V:N[0]}function S(A){const N=A.variables.map(V=>{try{return V.kind==="AdhocVariable"?new r.H9({name:V.spec.name,label:V.spec.label,readOnly:!0,description:V.spec.description,skipUrlSync:V.spec.skipUrlSync,hide:(0,D.cc)(V.spec.hide),datasource:V.spec.datasource,applyMode:"auto",filters:V.spec.filters??[],baseFilters:V.spec.baseFilters??[],defaultKeys:V.spec.defaultKeys,useQueriesAsFilterForOptions:!0,layout:s.$.featureToggles.newFiltersUI?"combobox":void 0,supportsMultiValueOperators:!!(0,i.l)().getInstanceSettings(V.spec.datasource)?.meta.multiValueFilterOperators}):_(V)}catch(z){return console.error(z),null}}).filter(V=>!!V);return new r.Pj({variables:N})}function _(A){let N,V;if(A.kind==="IntervalVariable"){const z=(0,y.Sm)(A.spec.query),w=B(A,z);return N=new h.B({name:A.spec.name,label:A.spec.label,description:A.spec.description,value:w,text:w,hide:(0,D.cc)(A.spec.hide)}),N}return A.kind==="ConstantVariable"||A.kind==="AdhocVariable"?V={value:"",text:""}:V={value:A.spec.current?.value??"",text:A.spec.current?.text??""},N=new h.B({name:A.spec.name,label:A.spec.label,description:A.spec.description,value:V?.value??"",text:V?.text??"",hide:(0,D.cc)(A.spec.hide)}),N}function K(A,N){return A.elements[N].kind==="Panel"?A.elements[N]:void 0}function T(A,N){return A.elements[N].kind==="LibraryPanel"?A.elements[N]:void 0}function L(A){return A.annotations.some(z=>z.spec.builtIn)?void 0:{kind:"AnnotationQuery",spec:{datasource:{uid:"-- Grafana --",type:"grafana"},name:"Annotations & Alerts",iconColor:o.Mk,enable:!0,hide:!0,builtIn:!0}}}},65333:(te,R,e)=>{"use strict";e.d(R,{tt:()=>ne,EH:()=>q,A2:()=>se,wM:()=>Y});var n=e(2543),a=e(43173),s=e(27489),i=e(25992),r=e(36674),u=e(5857),o=e(73427),l=e(45173),g=e(7817),f=e(82612),p=e(11968),c=e(7498),x=e(49e3),v=e(34960),m=e(88632),y=e(88499),h=e(44804),d=e(72746),E=e(7094),b=e(32540),D=e(37040),C=e(66251),P=e(81657),M=e(93389),O=e(1131),j=e(87308),U=e(18178),W=e(97335),B=e(97883),S=e(35718),_=e(18789),K=e(23289),T=e(8285),L=e(78282),A=e(39557);const N="default";function V(ae){const ce=ae.templating.list.map(ie=>{try{return H(ie)}catch(ve){return console.error(ve),null}}).filter(ie=>!!ie);return a.$.featureToggles.scopeFilters&&ce.push(new r.Kg({enable:!0})),new r.Pj({variables:ce})}function z(ae){const ce=ae.templating.list.map(ie=>{try{return ie.type==="adhoc"?new r.H9({name:ie.name,label:ie.label,readOnly:!0,description:ie.description,skipUrlSync:ie.skipUrlSync,hide:ie.hide,datasource:ie.datasource,applyMode:"auto",filters:ie.filters??[],baseFilters:ie.baseFilters??[],defaultKeys:ie.defaultKeys,useQueriesAsFilterForOptions:!0,layout:a.$.featureToggles.newFiltersUI?"combobox":void 0,supportsMultiValueOperators:!!(0,L.l)().getInstanceSettings(ie.datasource)?.meta.multiValueFilterOperators}):w(ie)}catch(ve){return console.error(ve),null}}).filter(ie=>!!ie);return new r.Pj({variables:ce})}function w(ae){let ce,ie;if(ae.type==="interval"){const ve=(0,T.Sm)(ae.query),le=(0,T.pk)(ae,ve);return ce=new A.B({name:ae.name,label:ae.label,description:ae.description,value:le,text:le,hide:ae.hide}),ce}return ae.type==="system"||ae.type==="constant"||ae.type==="adhoc"?ie={value:"",text:""}:ie={value:ae.current?.value??"",text:ae.current?.text??""},ce=new A.B({name:ae.name,label:ae.label,description:ae.description,value:ie?.value??"",text:ie?.text??"",hide:ae.hide}),ce}function H(ae){const ce={name:ae.name,label:ae.label,description:ae.description};if(ae.type==="adhoc"){const ie=[],ve=[];return ae.filters?.forEach(le=>le.origin?ie.push(le):ve.push(le)),new r.H9({...ce,description:ae.description,skipUrlSync:ae.skipUrlSync,hide:ae.hide,datasource:ae.datasource,applyMode:"auto",originFilters:ie,filters:ve,baseFilters:ae.baseFilters??[],defaultKeys:ae.defaultKeys,allowCustomValue:ae.allowCustomValue,useQueriesAsFilterForOptions:!0,layout:a.$.featureToggles.newFiltersUI?"combobox":void 0,supportsMultiValueOperators:!!(0,L.l)().getInstanceSettings(ae.datasource)?.meta.multiValueFilterOperators})}if(ae.type==="custom")return new r.yP({...ce,value:ae.current?.value??"",text:ae.current?.text??"",query:ae.query,isMulti:ae.multi,allValue:ae.allValue||void 0,includeAll:ae.includeAll,defaultToAll:!!ae.includeAll,skipUrlSync:ae.skipUrlSync,hide:ae.hide,allowCustomValue:ae.allowCustomValue});if(ae.type==="query")return new r.fS({...ce,value:ae.current?.value??"",text:ae.current?.text??"",query:ae.query,datasource:ae.datasource,sort:ae.sort,refresh:ae.refresh,regex:ae.regex,allValue:ae.allValue||void 0,includeAll:ae.includeAll,defaultToAll:!!ae.includeAll,isMulti:ae.multi,skipUrlSync:ae.skipUrlSync,hide:ae.hide,definition:ae.definition,allowCustomValue:ae.allowCustomValue});if(ae.type==="datasource")return new r.mI({...ce,value:ae.current?.value??"",text:ae.current?.text??"",regex:ae.regex,pluginId:ae.query,allValue:ae.allValue||void 0,includeAll:ae.includeAll,defaultToAll:!!ae.includeAll,skipUrlSync:ae.skipUrlSync,isMulti:ae.multi,hide:ae.hide,defaultOptionEnabled:ae.current?.value===N&&ae.current?.text==="default",allowCustomValue:ae.allowCustomValue});if(ae.type==="interval"){const ie=(0,T.Sm)(ae.query),ve=(0,T.pk)(ae,ie);return new r.Yj({...ce,value:ve,intervals:ie,autoEnabled:ae.auto,autoStepCount:ae.auto_count,autoMinInterval:ae.auto_min,refresh:ae.refresh,skipUrlSync:ae.skipUrlSync,hide:ae.hide})}else{if(ae.type==="constant")return new r.x0({...ce,value:ae.query,skipUrlSync:ae.skipUrlSync,hide:ae.hide});if(ae.type==="textbox"){let ie;return ae?.current?.value?typeof ae.current.value=="string"?ie=ae.current.value:ie=ae.current.value[0]:ie=ae.query,new r.TS({...ce,value:ie,skipUrlSync:ae.skipUrlSync,hide:ae.hide})}else{if(a.$.featureToggles.groupByVariable&&ae.type==="groupby")return new r.ZG({...ce,datasource:ae.datasource,value:ae.current?.value||[],text:ae.current?.text||[],skipUrlSync:ae.skipUrlSync,hide:ae.hide,defaultOptions:ae.options,defaultValue:ae.defaultValue,allowCustomValue:ae.allowCustomValue});throw new Error(`Scenes: Unsupported variable type ${ae.type}`)}}}function Q(ae){return function(ie,ve){if(ve.angularPanelCtrl){ie.options={angularOptions:ae.getOptionsToRemember()};return}if(!ae.options||Object.keys(ae.options).length===0){(0,n.defaults)(ie,ae.getOptionsToRemember());const le=(0,n.cloneDeep)(ae.targets);Object.defineProperty(ie,"targets",{get:function(){return console.warn("Accessing the targets property when migrating a panel plugin is deprecated. Changes to this property will be ignored."),le}})}if(ae.autoMigrateFrom){const le=f.NB[ae.autoMigrateFrom]!=null,Ee=ae.getOptionsToRemember(),Re=ae.autoMigrateFrom;if(ve.onPanelTypeChanged){const Oe=le?{angular:Ee}:Ee.options;Object.assign(ie.options,ve.onPanelTypeChanged(ie,Re,Oe,ie.fieldConfig))}}}}var Z=e(78320);function Y(ae){const ce=new g.G(ae.dashboard,ae.meta),ie=q(ce,ae.dashboard),ve=a.$.featureToggles.kubernetesDashboards?`${l._.group}/${l._.version}`:void 0;return ie.setInitialSaveModel(ae.dashboard,ae.meta,ve),ie}function X(ae){const ce=[];let ie=null,ve=[];for(const le of ae)le.type==="row"?!ie&&ve.length===0?ie=le:ie?(ce.push(ee(ie,ve)),ve=[],ie=le):(ce.push(new W.o({title:"",collapse:le.collapsed,layout:new O.D({grid:new r.hy({children:ve})}),hideHeader:!0,$behaviors:[]})),ve=[],ie=le):ve.push(ne(le));return ie&&ce.push(ee(ie,ve)),new B.V({rows:ce})}function I(ae){const ce=[];let ie=null,ve=[];for(const le of ae)if(le.type==="row")ie?ie.id!==le.id&&(ce.push(J(ie,ve)),le.collapsed?(ce.push(J(le,[])),ie=null):ie=le,ve=[]):le.collapsed?ce.push(J(le,[])):ie=le;else{le.snapshotData&&de(le);const Ee=ne(le);ie?ve.push(Ee):ce.push(Ee)}return ie&&ce.push(J(ie,ve)),ce}function J(ae,ce){ae.collapsed&&ae.panels&&(ce=ae.panels.map(le=>(le instanceof f.a9||(le=new f.a9(le)),ne(le))));let ie,ve=ce;return ae.repeat&&(ie=[new j.L({variableName:ae.repeat})]),new r.tI({key:(0,T.XA)(ae.id),title:ae.title,y:ae.gridPos.y,isCollapsed:ae.collapsed,children:ve,$behaviors:ie,actions:new U.u({})})}function ee(ae,ce){return new W.o({key:(0,T.XA)(ae.id),title:ae.title,collapse:ae.collapsed,layout:new O.D({grid:new r.hy({children:(ae.panels?.map(ve=>ne(ve))??[]).concat(ce)})}),repeatByVariable:ae.repeat})}function q(ae,ce){let ie,ve=[],le;const Ee=ae.uid,Re=a.$.featureToggles.dashboardNewLayouts?"v2":"v1";ae.meta.isSnapshot?ie=z(ae):ie=V(ae),ae.annotations?.list?.length&&!ae.isSnapshot()&&(ve=ae.annotations?.list.map(tt=>new x.g({key:(0,n.uniqueId)("annotations-"),query:tt,name:tt.name,isEnabled:!!tt.enable,isHidden:!!tt.hide})));let Oe=a.$.unifiedAlertingEnabled;Oe||ae.panels.find(tt=>!!tt.alert)&&(Oe=!0),Oe&&(le=new c.C({key:"alert-states",name:"Alert States"}));const Se=a.$.featureToggles.scopeFilters&&ae.scopeMeta?{trait:ae.scopeMeta.trait,groups:ae.scopeMeta.groups}:void 0,Te=[new r.Gg.K2({sync:ae.graphTooltip}),new r.Gg.Hf({enableProfiling:a.$.dashboardPerformanceMetrics.findIndex(tt=>tt==="*"||tt===ae.uid)!==-1,onProfileComplete:fe(ae.uid,ae.title)}),y.M,se,new r.Gg.en({enabled:ae.liveNow}),p.U,new h.s({reloadOnParamsChange:a.$.featureToggles.reloadDashboardsOnParamsChange&&ae.meta.reloadOnParamsChange,uid:Ee})];let _e;return a.$.featureToggles.dashboardNewLayouts&&ae.panels.some(tt=>tt.type==="row")?_e=X(ae.panels):_e=new O.D({grid:new r.hy({isLazy:!(ce.preload||o.TP.user.authenticatedBy==="render"),children:I(ae.panels)})}),new d.H$({uid:Ee,description:ae.description,editable:ae.editable,preload:ce.preload??!1,id:ae.id,isDirty:!1,links:ae.links||[],meta:ae.meta,tags:ae.tags||[],title:ae.title,version:ae.version,scopeMeta:Se,body:_e,$timeRange:new r.JZ({from:ae.time.from,to:ae.time.to,fiscalYearStartMonth:ae.fiscalYearStartMonth,timeZone:ae.timezone,weekStart:(0,u.rE)(ae.weekStart)?ae.weekStart:void 0,UNSAFE_nowDelay:ae.timepicker?.nowDelay}),$variables:ie,$behaviors:Te,$data:new m.s({annotationLayers:ve,alertStatesLayer:le}),controls:new v.x({timePicker:new r.KE({quickRanges:ae.timepicker.quick_ranges,defaultQuickRanges:a.$.quickRanges}),refreshPicker:new r.WM({refresh:ae.refresh,intervals:ae.timepicker.refresh_intervals,withText:!0}),hideTimeControls:ae.timepicker.hidden})},Re)}function ne(ae){const ce=ae.repeat?{variableName:ae.repeat,repeatDirection:ae.repeatDirection==="v"?"v":"h"}:{},ie=[];ie.push(new b.$({rawLinks:ae.links,menu:new b.m({$behaviors:[D.oV]})})),ie.push(new C.W);const ve=(ae.timeFrom||ae.timeShift)&&!ae.hideTimeOverride,le={key:(0,T.XA)(ae.id),title:ae.title?.substring(0,5e3),description:ae.description,pluginId:ae.type??"timeseries",options:ae.options??{},fieldConfig:ae.fieldConfig,pluginVersion:ae.pluginVersion,seriesLimit:a.$.panelSeriesLimit,displayMode:ae.transparent?"transparent":void 0,hoverHeader:!ae.title&&!ve,hoverHeaderOffset:0,$data:(0,_.w)(ae),titleItems:ie,$behaviors:[],extendPanelContext:S.C,_UNSAFE_customMigrationHandler:Q(ae)};ae.libraryPanel&&(le.$behaviors.push(new E.u({uid:ae.libraryPanel.uid,name:ae.libraryPanel.name})),le.pluginId=E.u.LOADING_VIZ_PANEL_PLUGIN_ID,le.$data=void 0),a.$.publicDashboardAccessToken||(le.menu=new r.Lw({$behaviors:[D._i]})),(ae.timeFrom||ae.timeShift)&&(le.$timeRange=new P.v({timeFrom:ae.timeFrom,timeShift:ae.timeShift,hideTimeOverride:ae.hideTimeOverride}));const Ee=new r.Eb(le);return new M.U({key:`grid-item-${ae.id}`,x:ae.gridPos.x,y:ae.gridPos.y,width:ce.repeatDirection==="h"?24:ae.gridPos.w,height:ae.gridPos.h,itemHeight:ae.gridPos.h,body:Ee,maxPerRow:ae.maxPerRow,...ce})}function se(ae){ae.subscribeToEvent(r.Kw,ce=>{const{interaction:ie}=ce.payload;switch(ie){case"panel-status-message-clicked":K.c.panelStatusMessageClicked();break;case"panel-cancel-query-clicked":K.c.panelCancelQueryClicked();break}})}const oe=ae=>ae.map(ce=>({data:{values:ce.fields.map(ie=>ie.values).filter(ie=>ie!==void 0)},schema:{fields:ce.fields.map(ie=>({name:ie.name,type:ie.type,config:ie.config}))}})),de=ae=>{ae.snapshotData&&(ae.datasource=Z.x,ae.targets=[{refId:ae.snapshotData[0]?.refId??"",datasource:ae.datasource,queryType:"snapshot",snapshot:oe(ae.snapshotData)}],ae.snapshotData=[])};function fe(ae,ce){return ie=>{let ve="";ie.origin==="SceneTimeRange"?ve="time-range-change":ie.origin==="SceneRefreshPicker"?ve="refresh":ie.origin==="DashboardScene"?ve="view":ie.origin.indexOf("Variable")>-1&&(ve="variable-change"),(0,s.rR)("dashboard-render",{interactionType:ve,duration:ie.duration,networkDuration:ie.networkDuration,totalJSHeapSize:ie.totalJSHeapSize,usedJSHeapSize:ie.usedJSHeapSize,jsHeapSizeLimit:ie.jsHeapSizeLimit}),(0,i.l$)(`dashboard.${ve}`,{duration:ie.duration,networkDuration:ie.networkDuration,totalJSHeapSize:ie.totalJSHeapSize,usedJSHeapSize:ie.usedJSHeapSize,jsHeapSizeLimit:ie.jsHeapSizeLimit,timeSinceBoot:performance.measure("time_since_boot","frontend_boot_js_done_time_seconds").duration},{dashboard:ae,title:ce})}}},70030:(te,R,e)=>{"use strict";e.d(R,{Uy:()=>C,Z6:()=>M,ZB:()=>P,c:()=>W});var n=e(2543),a=e.n(n),s=e(3594),i=e(36674),r=e(59857),u=e(21275),o=e(10605),l=e(98314),g=e(65635),f=e(8095),p=e(88632),c=e(81657),x=e(93389),v=e(1131),m=e(87308),y=e(3371),h=e(1682),d=e(8285),E=e(78320),b=e(99392),D=e(84500);function C(S,_=!1){const K=S.state,T=K.$timeRange.state,L=K.$data,A=K.$variables,N=K.body;let V=[],z=[];if(N instanceof v.D){for(const J of N.state.grid.state.children)if(J instanceof x.U&&(J.state.variableName?V=V.concat(j(J,_)):V.push(P(J,_))),J instanceof i.tI){if((0,y.Ry)(J.state.key)&&!_)continue;U(J,V,_)}}let w=[];L instanceof p.s&&(w=(0,b.O)(L.state.annotationLayers)),A instanceof i.Pj&&(z=(0,D.CN)(A));const H=K.controls?.state,Q=H?.refreshPicker,Z=B({refresh_intervals:Q?.state.intervals,hidden:H?.hideTimeControls,nowDelay:T.UNSAFE_nowDelay,quick_ranges:H?.timePicker.state.quickRanges},r.lt),Y=K.$behaviors?.find(J=>J instanceof i.Gg.K2)?.state.sync??r.Ye.graphTooltip,X=K.$behaviors?.find(J=>J instanceof i.Gg.en)?.isEnabled||void 0,I={...r.Ye,title:K.title,description:K.description||void 0,uid:K.uid,id:K.id,editable:K.editable,preload:K.preload,time:{from:T.from,to:T.to},timepicker:Z,panels:V,annotations:{list:w},templating:{list:z},version:K.version,timezone:T.timeZone,fiscalYearStartMonth:T.fiscalYearStartMonth,weekStart:T.weekStart,tags:K.tags,links:K.links,graphTooltip:Y,liveNow:X,schemaVersion:g.O2,refresh:Q?.state.refresh,scopeMeta:K.scopeMeta};return(0,o.v)(I,!0)}function P(S,_=!1){let K,T=0,L=0,A=0,N=0,V=S;if(!(V.state.body instanceof i.Eb))throw new Error("DashboardGridItem body expected to be VizPanel");if(K=V.state.body,T=V.state.x??0,L=V.state.y??0,A=V.state.width??0,N=(V.state.variableName?V.state.itemHeight:V.state.height)??0,!K)throw new Error("Unsupported grid item type");return M(K,{x:T,y:L,h:N,w:A},_,V)}function M(S,_,K=!1,T){let L;if((0,d.ME)(S)){const V=(0,d.iL)(S);return L={id:(0,d.Cs)(S),title:S.state.title,gridPos:_,libraryPanel:{name:V.state.name,uid:V.state.uid},type:"library-panel-ref"},L}else L={id:(0,d.Cs)(S),type:S.state.pluginId,title:S.state.title,description:S.state.description??void 0,gridPos:_,fieldConfig:S.state.fieldConfig??{defaults:{},overrides:[]},transformations:[],transparent:S.state.displayMode==="transparent",pluginVersion:S.state.pluginVersion,...O(S,K)};if(S.state.options){const{angularOptions:V,...z}=S.state.options;L.options=z,V&&(0,n.defaults)(L,V)}const A=S.state.$timeRange;A instanceof c.v&&(L.timeFrom=A.state.timeFrom,L.timeShift=A.state.timeShift,L.hideTimeOverride=A.state.hideTimeOverride),T instanceof x.U&&(T.state.variableName&&(L.repeat=T.state.variableName),T.state.maxPerRow&&(L.maxPerRow=T.state.maxPerRow),T.state.repeatDirection&&(L.repeatDirection=T.getRepeatDirection()));const N=h.b4.getPanelLinks(S);return L.links=N?.state.rawLinks??[],L.links.length===0&&delete L.links,L.transformations?.length===0&&delete L.transformations,L.transparent||delete L.transparent,L}function O(S,_=!1){const K=S.state.$data,T={},L=(0,d.un)(S);if(L&&(T.targets=L.state.queries,T.maxDataPoints=L.state.maxDataPoints,T.datasource=L.state.datasource,L.state.cacheTimeout&&(T.cacheTimeout=L.state.cacheTimeout),L.state.queryCachingTTL&&(T.queryCachingTTL=L.state.queryCachingTTL),L.state.minInterval&&(T.interval=L.state.minInterval)),K instanceof i.Es&&(T.transformations=K.state.transformations),K&&_){T.datasource=E.x;let A=(0,l.B6)(K.state.data);K instanceof i.Es&&(A=(0,l.B6)(K.state.$data.state.data)),T.targets=[{refId:"A",datasource:T.datasource,queryType:f.nj.Snapshot,snapshot:A}]}return T}function j(S,_=!1){if(_){if(S.state.body instanceof i.Eb&&(0,d.ME)(S.state.body)){const{x:K=0,y:T=0,width:L=0,height:A=0}=S.state;return[M(S.state.body,{x:K,y:T,w:L,h:A},_)]}if(S.state.repeatedPanels){const{h:K,w:T,columnCount:L}=(0,d.bR)(S);return S.state.repeatedPanels.map((N,V)=>{let z=0,w=0;S.state.repeatDirection==="v"?(z=S.state.x,w=V*K):(z=V%L*T,w=S.state.y+Math.floor(V/L)*K);const H={x:z,y:w,w:T,h:K},Q=N.state.$variables.getByName(S.state.variableName);return{id:(0,d.Cs)(N),type:N.state.pluginId,title:N.state.title,gridPos:H,options:N.state.options,fieldConfig:N.state.fieldConfig??{defaults:{},overrides:[]},transformations:[],transparent:N.state.displayMode==="transparent",scopedVars:{[S.state.variableName]:{text:Q?.state.text,value:Q?.state.value}},...O(N,_)}})}return[]}else return[P(S)]}function U(S,_,K=!1){const T=!!S.state.isCollapsed,L={type:"row",id:(0,d.Cs)(S),title:S.state.title,gridPos:{x:S.state.x??0,y:S.state.y??0,w:S.state.width??24,h:S.state.height??1},collapsed:T,panels:[]};if(S.state.$behaviors?.length){const N=S.state.$behaviors[0];N instanceof m.L&&(L.repeat=N.state.variableName)}if(K&&S.state.$variables){const V=S.state.$variables.state.variables.reduce((z,w)=>({...z,[w.state.name]:{text:w.state.text,value:w.state.value}}),{});L.scopedVars=V}_.push(L);let A=[];K?S.state.children.forEach(N=>{N instanceof x.U&&(N.state.variableName?A=A.concat(j(N,!T)):A.push(P(N,!T)))}):A=S.state.children.map(N=>{if(!(N instanceof x.U))throw new Error("Row child expected to be DashboardGridItem");return P(N)}),S.state.isCollapsed?L.panels=A:_.push(...A)}function W(S,_,K,T){let L={...K,title:S,time:{from:_.from.toISOString(),to:_.to.toISOString()},links:[]};if(T){const A=K.panels?.find(N=>N.id===(0,d.Cs)(T));A&&(A.gridPos={w:24,x:0,y:0,h:20},L={...L,panels:[A]})}if(L.panels?.forEach(A=>{"links"in A&&(A.links=[])}),L.annotations){const N=(L.annotations.list?.filter(V=>V.enable)||[]).map(V=>({name:V.name,enable:V.enable,iconColor:V.iconColor,type:V.type,builtIn:V.builtIn,hide:V.hide,snapshotData:[]}));L.annotations.list=N}return L.templating&&L.templating.list?.forEach(A=>{"query"in A&&(A.query=""),"options"in A&&(A.options=A.current&&!(0,s.R)(A.current)?[A.current]:[]),"refresh"in A&&(A.refresh=u.CO.never)}),L}function B(S,_){const K={...S};for(const T in _)(0,n.isEqual)(K[T],_[T])&&delete K[T];return K}},62265:(te,R,e)=>{"use strict";e.d(R,{AB:()=>H,Cy:()=>M,GB:()=>h,Ic:()=>W,Xl:()=>x,c8:()=>D,lD:()=>b});var n=e(2543),a=e.n(n),s=e(43173),i=e(36674),r=e(10605),u=e(78947),o=e(88632),l=e(81657),g=e(1682),f=e(8285),p=e(84500),c=e(39508);function x(Q,Z=!1){const Y=Q.state,X=Y.$timeRange.state,I=Y.controls?.state,J=I?.refreshPicker,ee=Q.serializer.getDSReferencesMapping(),q={title:Y.title,description:Y.description,cursorSync:v(Y),liveNow:m(Y),preload:Y.preload??(0,u.xE)().preload,editable:Y.editable??(0,u.xE)().editable,links:Y.links??(0,u.xE)().links,tags:Y.tags??(0,u.xE)().tags,timeSettings:{timezone:X.timeZone,from:X.from,to:X.to,autoRefresh:J?.state.refresh||"",autoRefreshIntervals:J?.state.intervals,hideTimepicker:I?.hideTimeControls??!1,weekStart:X.weekStart,fiscalYearStartMonth:X.fiscalYearStartMonth,nowDelay:X.UNSAFE_nowDelay,quickRanges:I?.timePicker.state.quickRanges},variables:O(Y,ee),elements:y(Q,ee),annotations:j(Y,ee),layout:Y.body.serialize()};try{if(B(q))return(0,r.v)(q,!0);throw new Error("Error we could transform the dashboard to schema v2: "+q)}catch(ne){throw console.error("Error transforming dashboard to schema v2: "+ne,q),new Error("Error transforming dashboard to schema v2: "+ne)}}function v(Q){const Z=Q.$behaviors?.find(Y=>Y instanceof i.Gg.K2)?.state.sync;return(0,c.k6)(Z)}function m(Q){const Z=Q.$behaviors?.find(Y=>Y instanceof i.Gg.en)?.isEnabled||void 0;return Z===void 0?!!(0,u.xE)().liveNow:!!Z}function y(Q,Z){const X=(Q.state.body.getVizPanels()??[]).map(I=>h(I,Z));return M(X,Q)}function h(Q,Z){if((0,f.ME)(Q)){const oe=(0,f.iL)(Q);return{kind:"LibraryPanel",spec:{id:(0,f.Cs)(Q),title:Q.state.title,libraryPanel:{uid:oe.state.uid,name:oe.state.name}}}}const Y=Q.state.fieldConfig.defaults.color;let X;if(Y){const oe=(0,c.Jc)(Y.mode);oe&&(X={...Y,mode:oe})}const I=Q.state.fieldConfig.defaults.decimals??void 0,J=Q.state.fieldConfig.defaults.min??void 0,ee=Q.state.fieldConfig.defaults.max??void 0,q=Object.fromEntries(Object.entries({...Q.state.fieldConfig.defaults,decimals:I,min:J,max:ee,color:X}).filter(([oe,de])=>Array.isArray(de)?de.length>0:de!==void 0)),ne={...Q.state.fieldConfig,defaults:q};return{kind:"Panel",spec:{id:(0,f.Cs)(Q),title:Q.state.title,description:Q.state.description??"",links:d(Q),transparent:Q.state.displayMode==="transparent"?!0:void 0,data:{kind:"QueryGroup",spec:{queries:E(Q,Z),transformations:C(Q),queryOptions:P(Q)}},vizConfig:{kind:Q.state.pluginId,spec:{pluginVersion:Q.state.pluginVersion??"",options:Q.state.options,fieldConfig:ne??(0,u.bt)()}}}}}function d(Q){const Z=g.b4.getPanelLinks(Q);return Z?Z.state.rawLinks??[]:[]}function E(Q,Z){const Y=[],X=(0,f.un)(Q),I=X?.state.queries;return I&&I.forEach(J=>{const ee=H(Q,J,"panel",X,Z),q={kind:b(J,X),spec:(0,n.omit)(J,"datasource","refId","hide")},ne={datasource:ee,query:q,refId:J.refId,hidden:!!J.hide};Y.push({kind:"PanelQuery",spec:ne})}),Y}function b(Q,Z){return typeof Q=="string"?W()?.type||"":Q.datasource?.type?Q.datasource.type:Z?.state.datasource?.type?Z.state.datasource.type:W()?.type||""}function D(Q){return Q}function C(Q){let Z=[];const Y=Q.state.$data;if(Y instanceof i.Es){const X=Y.state.transformations;if(X.length===0)return[];for(const I of X){const J=I;if("id"in J){const ee={id:J.id,disabled:J.disabled,filter:J.filter,...J.topic&&{topic:J.topic},options:J.options};Z.push({kind:J.id,spec:ee})}else throw new Error("Unsupported transformation type")}}return Z}function P(Q){let Z={};const Y=(0,f.un)(Q);Y&&(Z.maxDataPoints=Y.state.maxDataPoints,Y.state.cacheTimeout&&(Z.cacheTimeout=Y.state.cacheTimeout),Y.state.queryCachingTTL&&(Z.queryCachingTTL=Y.state.queryCachingTTL),Y.state.minInterval&&(Z.interval=Y.state.minInterval));const X=Q.state.$timeRange;return X instanceof l.v&&(Z.timeFrom=X.state.timeFrom,Z.timeShift=X.state.timeShift,Z.hideTimeOverride=X.state.hideTimeOverride),Z}function M(Q,Z){return Q.reduce((Y,X)=>{let I=Z.serializer.getElementIdForPanel(X.spec.id);return Y[I]=X,Y},{})}function O(Q,Z){const Y=Q.$variables;let X=[];return Y instanceof i.Pj&&(X=(0,p.$o)(Y,!1,Z)),X}function j(Q,Z){const Y=Q.$data;if(!(Y instanceof o.s))return[];const X=[];for(const I of Y.state.annotationLayers){if(!(I instanceof i.tV.g))continue;const J={kind:"AnnotationQuery",spec:{builtIn:!!I.state.query.builtIn,name:I.state.query.name,datasource:H(I,I.state.query,"annotation",void 0,Z),enable:!!I.state.isEnabled,hide:!!I.state.isHidden,iconColor:I.state.query.iconColor}};I.state.query.target&&!I.state.query.query?I.state.query.builtIn?J.spec.query={kind:"grafana",spec:{...I.state.query.target}}:J.spec.query={kind:U(I.state.query),spec:{...I.state.query.target}}:I.state.query.query?.kind&&(J.spec.query={kind:I.state.query.query.kind,spec:{...I.state.query.query.spec}});let ee=(0,n.omit)(I.state.query,"type","target","builtIn","name","datasource","iconColor","enable","hide","filter","query");if(Object.keys(ee).length>0){const{legacyOptions:q,...ne}=ee;J.spec.legacyOptions={...q,...ne}}I.state.query.filter?.ids?.length&&(J.spec.filter=I.state.query.filter),X.push(J)}return X}function U(Q){if(Q.datasource?.type)return Q.datasource.type;{const Z=W();return Z?Z.type:"grafana"}}function W(){const Q=s.$.bootData.settings.defaultDatasource,Y=s.$.bootData.settings.datasources[Q];return{type:Y.meta.id,uid:Y.name}}function B(Q){if(typeof Q!="object"||Q===null||Array.isArray(Q))throw new Error("Dashboard is not an object or is null");if(!("title"in Q)||typeof Q.title!="string")throw new Error("Title is not a string");if(!("timeSettings"in Q)||typeof Q.timeSettings!="object"||Q.timeSettings===null)throw new Error("TimeSettings is not an object or is null");if(!("variables"in Q)||!Array.isArray(Q.variables))throw new Error("Variables is not an array");if(!("elements"in Q)||typeof Q.elements!="object"||Q.elements===null)throw new Error("Elements is not an object or is null");if(!("annotations"in Q)||!Array.isArray(Q.annotations))throw new Error("Annotations is not an array");if(!("layout"in Q)||typeof Q.layout!="object"||Q.layout===null)throw new Error("Layout is not an object or is null");if("description"in Q&&Q.description!==void 0&&typeof Q.description!="string")throw new Error("Description is not a string");if("cursorSync"in Q&&Q.cursorSync!==void 0){const Y=["Off","Crosshair","Tooltip"];if(typeof Q.cursorSync!="string"||!Y.includes(Q.cursorSync))throw new Error("CursorSync is not a valid value")}if("liveNow"in Q&&Q.liveNow!==void 0&&typeof Q.liveNow!="boolean")throw new Error("LiveNow is not a boolean");if("preload"in Q&&Q.preload!==void 0&&typeof Q.preload!="boolean")throw new Error("Preload is not a boolean");if("editable"in Q&&Q.editable!==void 0&&typeof Q.editable!="boolean")throw new Error("Editable is not a boolean");if("links"in Q&&Q.links!==void 0&&!Array.isArray(Q.links))throw new Error("Links is not an array");if("tags"in Q&&Q.tags!==void 0&&!Array.isArray(Q.tags))throw new Error("Tags is not an array");if("id"in Q&&Q.id!==void 0&&typeof Q.id!="number")throw new Error("ID is not a number");const Z=Q.timeSettings;if(!("from"in Z)||typeof Z.from!="string")throw new Error("From is not a string");if(!("to"in Z)||typeof Z.to!="string")throw new Error("To is not a string");if(!("autoRefresh"in Z)||typeof Z.autoRefresh!="string")throw new Error("AutoRefresh is not a string");if(!("hideTimepicker"in Z)||typeof Z.hideTimepicker!="boolean")throw new Error("HideTimepicker is not a boolean");if("autoRefreshIntervals"in Z&&Z.autoRefreshIntervals!==void 0&&!Array.isArray(Z.autoRefreshIntervals))throw new Error("AutoRefreshIntervals is not an array");if("timezone"in Z&&Z.timezone!==void 0&&typeof Z.timezone!="string")throw new Error("Timezone is not a string");if("quickRanges"in Z&&Z.quickRanges!==void 0&&!Array.isArray(Z.quickRanges))throw new Error("QuickRanges is not an array");if("weekStart"in Z&&Z.weekStart!==void 0&&(typeof Z.weekStart!="string"||!["saturday","sunday","monday"].includes(Z.weekStart)))throw new Error('WeekStart should be one of "saturday", "sunday" or "monday"');if("nowDelay"in Z&&Z.nowDelay!==void 0&&typeof Z.nowDelay!="string")throw new Error("NowDelay is not a string");if("fiscalYearStartMonth"in Z&&Z.fiscalYearStartMonth!==void 0&&typeof Z.fiscalYearStartMonth!="number")throw new Error("FiscalYearStartMonth is not a number");if(!("kind"in Q.layout))throw new Error("Layout kind is required");return Q.layout.kind==="GridLayout"?S(Q.layout):Q.layout.kind==="RowsLayout"&&_(Q.layout),!0}function S(Q){if(typeof Q!="object"||Q===null)throw new Error("Layout is not an object or is null");if(!("kind"in Q)||Q.kind!=="GridLayout")throw new Error("Layout kind is not GridLayout");if(!("spec"in Q)||typeof Q.spec!="object"||Q.spec===null)throw new Error("Layout spec is not an object or is null");if(!("items"in Q.spec)||!Array.isArray(Q.spec.items))throw new Error("Layout spec items is not an array")}function _(Q){if(typeof Q!="object"||Q===null)throw new Error("Layout is not an object or is null");if(!("kind"in Q)||Q.kind!=="RowsLayout")throw new Error("Layout kind is not RowsLayout");if(!("spec"in Q)||typeof Q.spec!="object"||Q.spec===null)throw new Error("Layout spec is not an object or is null");if(!("rows"in Q.spec)||!Array.isArray(Q.spec.rows))throw new Error("Layout spec items is not an array")}function K(Q,Z,Y){if(!Y)return new Set;if(Z==="panels"&&A(Q)){const X=g.b4.getElementIdentifierForVizPanel(Q);return Y.panels.get(X)||new Set}if(Z==="variables")return Y.variables;if(Z==="annotations")return Y.annotations;throw new Error(`Invalid type ${Z} for getAutoAssignedDSRef`)}function T(Q,Z,Y,X){const I=L(Q,Y);if(!Z?.has(I)){if(Y==="query")return"datasource"in Q&&Q.datasource?Q.datasource:X?.state?.datasource;if(Y==="variable"&&"state"in Q&&"datasource"in Q.state)return Q.state.datasource||{};if(Y==="annotation"&&"datasource"in Q)return Q.datasource||{}}}function L(Q,Z){if(Z==="query")return"refId"in Q?Q.refId:"";if(Z==="variable")return"state"in Q&&"name"in Q.state?Q.state.name:"";if(Z==="annotation")return"name"in Q?Q.name:"";throw new Error(`Invalid type ${Z} for getElementIdentifier`)}function A(Q){return"pluginId"in Q.state}function N(Q){return!("pluginId"in Q.state)&&("variables"in Q.state||"getValue"in Q)}function V(Q){return"refId"in Q&&!("state"in Q)}function z(Q){return"datasource"in Q&&"name"in Q}function w(Q){return"state"in Q&&"name"in Q.state}function H(Q,Z,Y,X,I){let J;if(Y==="panel"){if(!X||!A(Q)||!V(Z))return;const ee=K(Q,"panels",I);J=T(Z,ee,"query",X)}if(Y==="variable"){if(!N(Q)||!w(Z))return;const ee=K(Q,"variables",I);J=T(Z,ee,"variable")}if(Y==="annotation"){if(!z(Z))return;const ee=K(Q,"annotations",I);J=T(Z,ee,"annotation")}return Object.keys(J||{}).length>0?J:void 0}},3281:(te,R,e)=>{"use strict";e.d(R,{ES:()=>u,So:()=>g,Y_:()=>o,cc:()=>r,tH:()=>i});var n=e(18600),a=e(21275),s=e(59857);function i(f){switch(f){case"never":return a.CO.never;case"onDashboardLoad":return a.CO.onDashboardLoad;case"onTimeRangeChanged":return a.CO.onTimeRangeChanged;default:return a.CO.never}}function r(f){switch(f){case"dontHide":return s.zL.dontHide;case"hideLabel":return s.zL.hideLabel;case"hideVariable":return s.zL.hideVariable;default:return s.zL.dontHide}}function u(f){switch(f){case"disabled":return a.ZG.disabled;case"numericalAsc":return a.ZG.numericalAsc;case"alphabeticalCaseInsensitiveAsc":return a.ZG.alphabeticalCaseInsensitiveAsc;case"alphabeticalCaseInsensitiveDesc":return a.ZG.alphabeticalCaseInsensitiveDesc;case"numericalDesc":return a.ZG.numericalDesc;case"naturalAsc":return a.ZG.naturalAsc;case"naturalDesc":return a.ZG.naturalDesc;case"alphabeticalAsc":return a.ZG.alphabeticalAsc;case"alphabeticalDesc":return a.ZG.alphabeticalDesc;default:return a.ZG.disabled}}function o(f){switch(f){case"Crosshair":return a.yV.Crosshair;case"Tooltip":return a.yV.Tooltip;case"Off":return a.yV.Off;default:return a.$C}}function l(f){switch(f){case"true":return n.W.True;case"false":return n.W.False;case"null":return n.W.Null;case"nan":return n.W.NaN;case"null+nan":return n.W.NullAndNaN;case"empty":return n.W.Empty;default:throw new Error(`Unknown match type: ${f}`)}}function g(f){const p=x=>{switch(x){case"absolute":return a.Ol.Absolute;case"percentage":return a.Ol.Percentage;default:return a.Ol.Absolute}},c={...f.defaults};return f.defaults.mappings&&(c.mappings=f.defaults.mappings.map(x=>{switch(x.type){case"value":return{...x,type:a.dM.ValueToText};case"range":return{...x,type:a.dM.RangeToText};case"regex":return{...x,type:a.dM.RegexToText};case"special":return{...x,options:{...x.options,match:l(x.options.match)},type:a.dM.SpecialValue};default:return x}})),f.defaults.thresholds&&(c.thresholds={...f.defaults.thresholds,mode:p(f.defaults.thresholds.mode)}),{...f,defaults:c}}},39508:(te,R,e)=>{"use strict";e.d(R,{Jc:()=>f,LY:()=>l,MM:()=>g,NB:()=>o,k6:()=>r,qJ:()=>u,sB:()=>i});var n=e(739),a=e(21275),s=e(78947);const i="__legacyStringValue";function r(p){switch(p){case 0:return"Off";case 1:return"Crosshair";case 2:return"Tooltip";default:return(0,s.xE)().cursorSync}}function u(p){switch(p){case 0:return"never";case 1:return"onDashboardLoad";case 2:return"onTimeRangeChanged";default:return(0,s.FM)()}}function o(p){switch(p){case 0:return"dontHide";case 1:return"hideLabel";case 2:return"hideVariable";default:return(0,s.SR)()}}function l(p){switch(p){case 0:return"disabled";case 1:return"alphabeticalAsc";case 2:return"alphabeticalDesc";case 3:return"numericalAsc";case 4:return"numericalDesc";default:return(0,s.G9)()}}function g(p){switch(p){case"annotations":return n.QR.Annotations;case"alertStates":return n.QR.AlertStates;case"series":return n.QR.Series;default:return}}function f(p){switch(p){case a.Yb.Thresholds:return"thresholds";case a.Yb.PaletteClassic:return"palette-classic";case a.Yb.PaletteClassicByName:return"palette-classic-by-name";case a.Yb.ContinuousGrYlRd:return"continuous-GrYlRd";case a.Yb.ContinuousRdYlGr:return"continuous-RdYlGr";case a.Yb.ContinuousBlYlRd:return"continuous-BlYlRd";case a.Yb.ContinuousYlRd:return"continuous-YlRd";case a.Yb.ContinuousBlPu:return"continuous-BlPu";case a.Yb.ContinuousYlBl:return"continuous-YlBl";case a.Yb.ContinuousBlues:return"continuous-blues";case a.Yb.ContinuousReds:return"continuous-reds";case a.Yb.ContinuousGreens:return"continuous-greens";case a.Yb.ContinuousPurples:return"continuous-purples";case a.Yb.Fixed:return"fixed";case a.Yb.Shades:return"shades";default:return}}},13542:(te,R,e)=>{"use strict";e.d(R,{c:()=>B,h:()=>S});var n=e(74848),a=e(42941),s=e(41053),i=e(51898),r=e(92745),u=e(27489),o=e(43173),l=e(45861),g=e(71599),f=e(66404),p=e(35137),c=e(22787),x=e(89640),v=e(18346),m=e(2522),y=e(49785),h=e(54148),d=e(32899),E=e(75234),b=e(8207),D=e(41654),C=e(34999),P=e(33680),M=e(91555),O=e(89314),j=e(11480);function U({dashboard:K,defaultValues:T,loadedFromRef:L,readOnly:A,isGitHub:N,isNew:V,workflowOptions:z,onDismiss:w}){const H=(0,y.mN)({defaultValues:T}),{editPanel:Q}=K.useState(),{handleSubmit:Z,watch:Y}=H,[X,I]=Y(["ref","workflow"]),[J,ee]=(0,P.Qo)(),q=async({repo:fe,path:ae,comment:ce})=>{if(!fe||!ae){console.error("Missing required fields for deletion:",{repo:fe,path:ae});return}const ie=I==="write"?L:X,ve=ce||`Delete dashboard: ${K.state.title}`;J({name:fe,path:ae,ref:ie,message:ve})},ne=(0,h.Zp)(),se=fe=>{(0,E.J7)().publish({type:d.r1.alertError.name,payload:[(0,r.t)("dashboard-scene.delete-provisioned-dashboard-form.api-error","Failed to delete dashboard"),fe]})},oe=()=>{Q?.onDiscard(),w(),window.location.href="/dashboards"},de=(fe,ae)=>{Q?.onDiscard(),w(),ne(`${M.mL}/${T.repo}/dashboard/preview/${fe}?pull_request_url=${ae?.newPullRequestURL}`)};return(0,j.J)({dashboard:K,request:ee,workflow:I,handlers:{onBranchSuccess:({path:fe,urls:ae})=>de(fe,ae),onWriteSuccess:oe,onError:se}}),(0,n.jsx)(b._,{title:(0,r.t)("dashboard-scene.delete-provisioned-dashboard-form.drawer-title","Delete Provisioned Dashboard"),subtitle:K.state.title,onClose:w,children:(0,n.jsx)(y.Op,{...H,children:(0,n.jsx)("form",{onSubmit:Z(q),children:(0,n.jsxs)(D.B,{direction:"column",gap:2,children:[A&&(0,n.jsx)(C.F,{title:(0,r.t)("dashboard-scene.delete-provisioned-dashboard-form.title-this-repository-is-read-only","This repository is read only"),children:(0,n.jsx)(r.x6,{i18nKey:"dashboard-scene.delete-provisioned-dashboard-form.delete-read-only-file-message",children:"This dashboard cannot be deleted directly from Grafana because the repository is read-only. To delete this dashboard, please remove the file from your Git repository."})}),(0,n.jsx)(O.x,{resourceType:"dashboard",isNew:V,readOnly:A,workflow:I,workflowOptions:z,isGitHub:N}),(0,n.jsxs)(D.B,{gap:2,children:[(0,n.jsx)(l.$n,{variant:"destructive",type:"submit",disabled:ee.isLoading||A,children:ee.isLoading?(0,r.t)("dashboard-scene.delete-provisioned-dashboard-form.deleting","Deleting..."):(0,r.t)("dashboard-scene.delete-provisioned-dashboard-form.delete-action","Delete dashboard")}),(0,n.jsx)(l.$n,{variant:"secondary",onClick:w,fill:"outline",children:(0,n.jsx)(r.x6,{i18nKey:"dashboard-scene.delete-provisioned-dashboard-form.cancel-action",children:"Cancel"})})]})]})})})})}function W({dashboard:K,onDismiss:T}){const{defaultValues:L,loadedFromRef:A,readOnly:N,isGitHub:V,workflowOptions:z,isNew:w}=(0,m.S)(K);return L?(0,n.jsx)(U,{dashboard:K,defaultValues:L,loadedFromRef:A,readOnly:N,isGitHub:V,isNew:w,workflowOptions:z,onDismiss:T}):null}function B({dashboard:K}){const[T,L]=(0,a.A)(!1),[A]=(0,v.uz)(),[,N]=(0,s.A)(async()=>{(0,u.rR)("grafana_manage_dashboards_delete_clicked",{item_counts:{dashboard:1},source:"dashboard_scene_settings",restore_enabled:!!o.$.featureToggles.restoreDashboards}),L(),K.state.uid&&await A({selectedItems:{dashboard:{[K.state.uid]:!0},folder:{}}}),await K.onDashboardDelete()},[K,L]);return K.isManagedRepository()&&T?(0,n.jsx)(W,{dashboard:K,onDismiss:L}):K.state.meta.provisioned&&T?(0,n.jsx)(_,{dashboardId:K.state.meta.provisionedExternalId,onClose:L}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.$n,{variant:"destructive",onClick:L,"data-testid":i.Tp.pages.Dashboard.Settings.General.deleteDashBoard,children:(0,n.jsx)(r.x6,{i18nKey:"dashboard-settings.dashboard-delete-button",children:"Delete dashboard"})}),T&&(0,n.jsx)(S,{dashboardTitle:K.state.title,onConfirm:N,onClose:L})]})}function S({dashboardTitle:K,onConfirm:T,onClose:L}){return(0,n.jsx)(g.u,{isOpen:!0,body:(0,n.jsxs)(n.Fragment,{children:[o.$.featureToggles.restoreDashboards&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.E,{element:"p",children:(0,n.jsx)(r.x6,{i18nKey:"dashboard-settings.delete-modal-restore-dashboards-text",children:"This action will mark the dashboard for deletion in 30 days. Your organization administrator can restore it anytime before the 30 days expire."})}),(0,n.jsx)(p.$,{v:1})]}),(0,n.jsx)(f.E,{element:"p",children:(0,n.jsx)(r.x6,{i18nKey:"dashboard-settings.delete-modal-text",children:"Do you want to delete this dashboard?"})}),(0,n.jsx)(f.E,{element:"p",children:K}),(0,n.jsx)(p.$,{v:2})]}),onConfirm:T,onDismiss:L,title:(0,r.t)("dashboard-settings.delete-modal.title","Delete"),icon:"trash-alt",confirmText:(0,r.t)("dashboard-settings.delete-modal.delete-button","Delete"),confirmationText:(0,r.t)("dashboard-settings.delete-modal.confirmation-text","Delete")})}function _({dashboardId:K,onClose:T}){return(0,n.jsxs)(c.a,{isOpen:!0,title:(0,r.t)("dashboard-scene.provisioned-delete-modal.title-cannot-delete-provisioned-dashboard","Cannot delete provisioned dashboard"),icon:"trash-alt",onDismiss:T,children:[(0,n.jsx)("p",{children:(0,n.jsx)(r.x6,{i18nKey:"dashboard-scene.provisioned-delete-modal.cannot-be-deleted",children:"This dashboard is managed by Grafana provisioning and cannot be deleted. Remove the dashboard from the config file to delete it."})}),(0,n.jsxs)("p",{children:[(0,n.jsx)("i",{children:(0,n.jsxs)(r.x6,{i18nKey:"dashboard-scene.provisioned-delete-modal.see-docs",children:["See"," ",(0,n.jsx)(x.Y,{href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",external:!0,children:"documentation"})," ","for more information about provisioning."]})}),(0,n.jsx)("br",{}),(0,n.jsxs)(r.x6,{i18nKey:"dashboard-scene.provisioned-delete-modal.file-path",children:["File path: ",{dashboardId:K}]})]}),(0,n.jsx)(c.a.ButtonRow,{children:(0,n.jsx)(l.$n,{variant:"primary",onClick:T,children:(0,n.jsx)(r.x6,{i18nKey:"dashboard-scene.provisioned-delete-modal.ok",children:"OK"})})})]})}},39468:(te,R,e)=>{"use strict";e.d(R,{d:()=>c});var n=e(74848),a=e(92745),s=e(37386),i=e(63527),r=e(18857),u=e(10928),o=e(74475),l=e(32635),g=e(45861),f=e(86871);const p=Object.keys(f.G).map(x=>({label:x,value:x}));function c({link:x,onUpdate:v,onGoBack:m}){const y=[{value:"dashboards",label:(0,a.t)("dashboard-scene.dashboard-link-form.link-type-options.label.dashboards","Dashboards")},{value:"link",label:(0,a.t)("dashboard-scene.dashboard-link-form.link-type-options.label.link","Link")}],h=C=>{v({...x,tags:C})},d=C=>{const P={...x,type:C.value};P.type==="dashboards"?(P.url="",P.tooltip=""):P.tags=[],v(P)},E=C=>{v({...x,icon:C.value})},b=C=>{const P=C.currentTarget;v({...x,[P.name]:P.type==="checkbox"?P.checked:P.value})},D=x.title===f.q.title;return(0,n.jsxs)("div",{style:{maxWidth:"600px"},children:[(0,n.jsx)(s.D,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-title","Title"),children:(0,n.jsx)(i.p,{name:"title",id:"title",value:x.title,onChange:b,autoFocus:D})}),(0,n.jsx)(s.D,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-type","Type"),children:(0,n.jsx)(r.l6,{inputId:"link-type-input",value:x.type,options:y,onChange:d})}),x.type==="dashboards"&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(s.D,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-with-tags","With tags"),children:(0,n.jsx)(u.u,{tags:x.tags,onChange:h})})}),x.type==="link"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.D,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-url","URL"),children:(0,n.jsx)(i.p,{name:"url",value:x.url,onChange:b})}),(0,n.jsx)(s.D,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-tooltip","Tooltip"),children:(0,n.jsx)(i.p,{name:"tooltip",value:x.tooltip,onChange:b,placeholder:(0,a.t)("dashboard-scene.dashboard-link-form.placeholder-open-dashboard","Open dashboard")})}),(0,n.jsx)(s.D,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-icon","Icon"),children:(0,n.jsx)(r.l6,{value:x.icon,options:p,onChange:E})})]}),(0,n.jsxs)(o.M,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-options","Options"),isOpen:!0,children:[x.type==="dashboards"&&(0,n.jsx)(s.D,{children:(0,n.jsx)(l.S,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-show-as-dropdown","Show as dropdown"),name:"asDropdown",value:x.asDropdown,onChange:b})}),(0,n.jsx)(s.D,{children:(0,n.jsx)(l.S,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-include-current-time-range","Include current time range"),name:"keepTime",value:x.keepTime,onChange:b})}),(0,n.jsx)(s.D,{children:(0,n.jsx)(l.S,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-include-current-template-variable-values","Include current template variable values"),name:"includeVars",value:x.includeVars,onChange:b})}),(0,n.jsx)(s.D,{children:(0,n.jsx)(l.S,{label:(0,a.t)("dashboard-scene.dashboard-link-form.label-open-link-in-new-tab","Open link in new tab"),name:"targetBlank",value:x.targetBlank,onChange:b})})]}),(0,n.jsx)(g.$n,{variant:"secondary",onClick:m,children:(0,n.jsx)(a.x6,{i18nKey:"dashboard-scene.dashboard-link-form.back-to-list",children:"Back to list"})})]})}},88898:(te,R,e)=>{"use strict";e.d(R,{X:()=>x});var n=e(74848),a=e(22803),s=e(92745),i=e(63142),r=e(41654),u=e(50201),o=e(45861),l=e(89640),g=e(30703),f=e(37658),p=e(76319),c=e(44458);function x({links:m,onNew:y,onOrderChange:h,onEdit:d,onDuplicate:E,onDelete:b}){const D=(0,i.of)(v);return m.length===0?(0,n.jsx)(r.B,{direction:"column",children:(0,n.jsx)(u.p,{variant:"call-to-action",button:(0,n.jsx)(o.$n,{onClick:y,size:"lg",children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-links.empty-state.button-title",children:"Add dashboard link"})}),message:(0,s.t)("dashboard-links.empty-state.title","There are no dashboard links added yet"),children:(0,n.jsxs)(s.x6,{i18nKey:"dashboard-links.empty-state.info-box-content",children:["Dashboard links allow you to place links to other dashboards and web sites directly below the dashboard header."," ",(0,n.jsx)(l.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/manage-dashboard-links/",children:"Learn more"})]})})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("table",{role:"grid",className:"filter-table filter-table--hover",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.dashboard-link-list.type",children:"Type"})}),(0,n.jsx)("th",{children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.dashboard-link-list.info",children:"Info"})}),(0,n.jsx)("th",{colSpan:3})]})}),(0,n.jsx)("tbody",{children:m.map((P,M)=>(0,n.jsxs)("tr",{children:[(0,n.jsxs)("td",{role:"gridcell",className:"pointer",onClick:()=>d(M),children:[(0,n.jsx)(g.I,{name:"external-link-alt"})," \xA0 ",P.type]}),(0,n.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>d(M),children:(0,n.jsxs)(r.B,{children:[P.title&&(0,n.jsx)("span",{className:D.titleWrapper,children:P.title}),P.type==="link"&&(0,n.jsx)("span",{className:D.urlWrapper,children:P.url}),P.type==="dashboards"&&(0,n.jsx)(f.L,{tags:P.tags??[]})]})}),(0,n.jsx)("td",{style:{width:"1%"},role:"gridcell",children:M!==0&&(0,n.jsx)(p.K,{name:"arrow-up",onClick:()=>h(M,-1),tooltip:(0,s.t)("dashboard-scene.dashboard-link-list.tooltip-move-link-up","Move link up")})}),(0,n.jsx)("td",{style:{width:"1%"},role:"gridcell",children:m.length>1&&M!==m.length-1?(0,n.jsx)(p.K,{name:"arrow-down",onClick:()=>h(M,1),tooltip:(0,s.t)("dashboard-scene.dashboard-link-list.tooltip-move-link-down","Move link down")}):null}),(0,n.jsx)("td",{style:{width:"1%"},role:"gridcell",children:(0,n.jsx)(p.K,{name:"copy",onClick:()=>E(P),tooltip:(0,s.t)("dashboard-scene.dashboard-link-list.tooltip-copy-link","Copy link")})}),(0,n.jsx)("td",{style:{width:"1%"},role:"gridcell",children:(0,n.jsx)(c.e,{"aria-label":(0,s.t)("dashboard-scene.dashboard-link-list.delete-aria-label",'Delete link with title "{{title}}"',{title:P.title}),size:"sm",onConfirm:()=>b(M)})})]},`${P.title}-${M}`))})]}),(0,n.jsx)(o.$n,{className:D.newLinkButton,icon:"plus",onClick:y,children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.dashboard-link-list.new-link",children:"New link"})})]})}const v=m=>({titleWrapper:(0,a.css)({width:"20vw",textOverflow:"ellipsis",overflow:"hidden"}),urlWrapper:(0,a.css)({width:"40vw",textOverflow:"ellipsis",overflow:"hidden"}),newLinkButton:(0,a.css)({marginTop:m.spacing(3)})})},86871:(te,R,e)=>{"use strict";e.d(R,{G:()=>a,q:()=>n});const n={icon:"external link",title:"New link",tooltip:"",type:"dashboards",url:"",asDropdown:!1,tags:[],targetBlank:!1,keepTime:!1,includeVars:!1},a={"external link":"external-link-alt",dashboard:"apps",question:"question-circle",info:"info-circle",bolt:"bolt",doc:"file-alt",cloud:"cloud"}},99584:(te,R,e)=>{"use strict";e.d(R,{Q:()=>m});var n=e(74848),a=e(96540),s=e(68125),i=e(51898),r=e(92745),u=e(30048),o=e(31286),l=e(34999),g=e(37386),f=e(21285),p=e(50992),c=e(76792),x=e(69076),v=e(32442);function m({datasource:y,infoText:h,allowCustomValue:d,onDataSourceChange:E,onDefaultKeysChange:b,onAllowCustomValueChange:D,defaultKeys:C,inline:P,datasourceSupported:M}){const O=(0,a.useCallback)(j=>{const U=(0,s.Jh)(`key,value
`+j)[0],W=[];for(let B=0;B<U.length;B++)W.push({text:U.fields[0].values[B],value:U.fields[1].values[B]});b?.(W)},[b]);return(0,n.jsxs)(n.Fragment,{children:[!P&&(0,n.jsx)(v.Y,{children:(0,n.jsx)(r.x6,{i18nKey:"dashboard-scene.ad-hoc-variable-form.adhoc-options",children:"Ad-hoc options"})}),(0,n.jsx)(o.a,{marginBottom:2,children:(0,n.jsx)(u.c,{label:(0,r.t)("dashboard-scene.ad-hoc-variable-form.label-data-source","Data source"),htmlFor:"data-source-picker",tooltip:h,children:(0,n.jsx)(c.s,{current:y,onChange:E,width:30,variables:!0,noDefault:!0})})}),M===!1?(0,n.jsx)(l.F,{title:(0,r.t)("dashboard-scene.ad-hoc-variable-form.alert-not-supported","This data source does not support ad hoc filters"),severity:"warning","data-testid":i.Tp.pages.Dashboard.Settings.Variables.Edit.AdHocFiltersVariable.infoText}):null,M&&b&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.D,{label:(0,r.t)("dashboard-scene.ad-hoc-variable-form.label-use-static-key-dimensions","Use static key dimensions"),description:(0,r.t)("dashboard-scene.ad-hoc-variable-form.description-provide-dimensions-as-csv-dimension-name-dimension-id","Provide dimensions as CSV: {{name}}, {{value}}",{name:"dimensionName",value:"dimensionId"}),children:(0,n.jsx)(f.d,{"data-testid":i.Tp.pages.Dashboard.Settings.Variables.Edit.AdHocFiltersVariable.modeToggle,value:C!==void 0,onChange:j=>{b(C===void 0?[]:void 0)}})}),C!==void 0&&(0,n.jsx)(p.B,{height:300,language:"csv",value:C.map(j=>`${j.text},${j.value}`).join(`
`),onBlur:O,onSave:O,showMiniMap:!1,showLineNumbers:!0})]}),M&&D&&(0,n.jsx)(x.c,{value:d??!0,name:(0,r.t)("dashboard-scene.ad-hoc-variable-form.name-allow-custom-values","Allow custom values"),description:(0,r.t)("dashboard-scene.ad-hoc-variable-form.description-enables-users-custom-values","Enables users to add custom values to the list"),onChange:D,testId:i.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsAllowCustomValueSwitch})]})}},23675:(te,R,e)=>{"use strict";e.d(R,{d:()=>u});var n=e(74848),a=e(51898),s=e(92745),i=e(32442),r=e(49602);function u({onChange:o,constantValue:l}){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.Y,{children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.constant-variable-form.constant-options",children:"Constant options"})}),(0,n.jsx)(r._,{defaultValue:l,name:"Value",placeholder:(0,s.t)("dashboard-scene.constant-variable-form.placeholder-your-metric-prefix","Your metric prefix"),onBlur:o,testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.ConstantVariable.constantOptionsQueryInputV2,width:30})]})}},70430:(te,R,e)=>{"use strict";e.d(R,{w:()=>g});var n=e(74848),a=e(51898),s=e(92745),i=e(36674),r=e(51156),u=e(32442),o=e(25379),l=e(52847);function g({query:c,multi:x,allValue:v,includeAll:m,allowCustomValue:y,onQueryChange:h,onMultiChange:d,onIncludeAllChange:E,onAllValueChange:b,onAllowCustomValueChange:D}){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.Y,{children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.custom-variable-form.custom-options",children:"Custom options"})}),(0,n.jsx)(o.Z,{name:(0,s.t)("dashboard-scene.custom-variable-form.name-values-separated-comma","Values separated by comma"),defaultValue:c,placeholder:"1, 10, mykey : myvalue, myvalue, escaped\\,value",onBlur:h,required:!0,width:52,testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.CustomVariable.customValueInput}),(0,n.jsx)(u.Y,{children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.custom-variable-form.selection-options",children:"Selection options"})}),(0,n.jsx)(l.B,{multi:x,includeAll:m,allValue:v,allowCustomValue:y,onMultiChange:d,onIncludeAllChange:E,onAllValueChange:b,onAllowCustomValueChange:D})]})}function f(c){return c instanceof CustomVariable?[new OptionsPaneItemDescriptor({title:t("dashboard.edit-pane.variable.custom-options.values","Values separated by comma"),render:()=>jsx(p,{variable:c})})]:[]}function p({variable:c}){const{query:x}=c.useState(),v=async m=>{c.setState({query:m.currentTarget.value}),await lastValueFrom(c.validateAndUpdate())};return jsx(TextArea,{rows:2,defaultValue:x,onBlur:v,placeholder:t("dashboard.edit-pane.variable.custom-options.values-placeholder","1, 10, mykey : myvalue, myvalue, escaped,value"),required:!0,"data-testid":selectors.pages.Dashboard.Settings.Variables.Edit.CustomVariable.customValueInput})}},42272:(te,R,e)=>{"use strict";e.d(R,{y:()=>l});var n=e(74848),a=e(51898),s=e(92745),i=e(52847),r=e(32442),u=e(68577),o=e(49602);function l({query:g,regex:f,optionTypes:p,allowCustomValue:c,onChange:x,onRegExBlur:v,multi:m,includeAll:y,allValue:h,onMultiChange:d,onIncludeAllChange:E,onAllValueChange:b,onAllowCustomValueChange:D}){const C=p.find(P=>P.value===g);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.Y,{children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.data-source-variable-form.data-source-options",children:"Data source options"})}),(0,n.jsx)(u.v,{name:(0,s.t)("dashboard-scene.data-source-variable-form.name-type","Type"),value:C,options:p,onChange:x,testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.DatasourceVariable.datasourceSelect}),(0,n.jsx)(o._,{defaultValue:f,name:(0,s.t)("dashboard-scene.data-source-variable-form.name-instance-name-filter","Instance name filter"),placeholder:"/.*-(.*)-.*/",onBlur:v,description:(0,n.jsxs)("div",{children:[(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.data-source-variable-form.description-instance-name-filter",children:"Regex filter for which data source instances to choose from in the variable value list. Leave empty for all."}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsxs)(s.x6,{i18nKey:"dashboard-scene.data-source-variable-form.example-instance-name-filter",components:{codeExample:(0,n.jsx)("code",{children:"/^prod/"})},children:["Example: ","<codeExample />"]})]})}),(0,n.jsx)(r.Y,{children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.data-source-variable-form.selection-options",children:"Selection options"})}),(0,n.jsx)(i.B,{multi:m,includeAll:y,allValue:h,allowCustomValue:c,onMultiChange:d,onIncludeAllChange:E,onAllValueChange:b,onAllowCustomValueChange:D})]})}},1096:(te,R,e)=>{"use strict";e.d(R,{s:()=>f});var n=e(74848),a=e(22803),s=e(51898),i=e(92745),r=e(63142),u=e(69076),o=e(32442),l=e(68577),g=e(49602);function f({intervals:c,onIntervalsChange:x,onAutoEnabledChange:v,onAutoMinIntervalChanged:m,onAutoCountChanged:y,autoEnabled:h,autoMinInterval:d,autoStepCount:E,inline:b=!1}){const D=[1,2,3,4,5,10,20,30,40,50,100,200,300,400,500].map(M=>({label:`${M}`,value:M})),C=(0,r.of)(p),P=D.find(M=>M.value===E)??D[0];return(0,n.jsxs)(n.Fragment,{children:[!b&&(0,n.jsx)(o.Y,{children:(0,n.jsx)(i.x6,{i18nKey:"dashboard-scene.interval-variable-form.interval-options",children:"Interval options"})}),(0,n.jsx)(g._,{defaultValue:c,name:(0,i.t)("dashboard-scene.interval-variable-form.name-values","Values"),placeholder:"1m,10m,1h,6h,1d,7d",onBlur:x,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.intervalsValueInput,width:32,required:!0}),(0,n.jsx)(u.c,{value:h,name:(0,i.t)("dashboard-scene.interval-variable-form.name-auto-option","Auto option"),description:(0,i.t)("dashboard-scene.interval-variable-form.description-auto-option","Dynamically calculates interval by dividing time range by the count specified"),onChange:v,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.autoEnabledCheckbox}),h&&(0,n.jsxs)("div",{className:C.autoFields,children:[(0,n.jsx)(l.v,{name:(0,i.t)("dashboard-scene.interval-variable-form.name-step-count","Step count"),description:(0,i.t)("dashboard-scene.interval-variable-form.description-step-count","How many times the current time range should be divided to calculate the value"),value:P,options:D,onChange:y,width:9,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.stepCountIntervalSelect}),(0,n.jsx)(g._,{value:d,name:(0,i.t)("dashboard-scene.interval-variable-form.name-min-interval","Min interval"),description:(0,i.t)("dashboard-scene.interval-variable-form.description-calculated-value-below-threshold","The calculated value will not go below this threshold"),placeholder:"10s",onChange:m,width:11,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.minIntervalInput})]})]})}const p=c=>({autoFields:(0,a.css)({marginTop:c.spacing(2),display:"flex",flexDirection:"column"})})},66698:(te,R,e)=>{"use strict";e.d(R,{w:()=>l});var n=e(74848),a=e(28105),s=e(92745),i=e(2863),r=e(31286),u=e(66404),o=e(67933);function l({query:g,datasource:f,VariableQueryEditor:p,onLegacyQueryChange:c,onQueryChange:x,timeRange:v}){let m;return typeof g=="string"?m=g||(f.variables?.getDefaultQuery?.()??""):m={...f.variables?.getDefaultQuery?.(),...g},p&&(0,o.VN)(p,f)?(0,n.jsxs)(r.a,{marginBottom:2,children:[(0,n.jsx)(u.E,{variant:"bodySmall",weight:"medium",children:(0,n.jsx)(s.x6,{i18nKey:"dashboard-scene.query-editor.query",children:"Query"})}),(0,n.jsx)(r.a,{marginTop:.25,children:(0,n.jsx)(p,{datasource:f,query:m,templateSrv:(0,i.w)(),onChange:c},f.uid)})]}):p&&(0,o.CH)(p,f)?(0,n.jsx)(r.a,{marginBottom:2,children:(0,n.jsx)(r.a,{marginTop:.25,children:(0,n.jsx)(p,{datasource:f,query:m,onChange:x,onRunQuery:()=>{},data:{series:[],state:a.Gu.Done,timeRange:v},range:v,onBlur:()=>{},history:[]},f.uid)})}):null}},28799:(te,R,e)=>{"use strict";e.d(R,{u:()=>y});var n=e(74848),a=e(16817),s=e(51898),i=e(92745),r=e(78282),u=e(37386),o=e(89640),l=e(66698),g=e(52847),f=e(76792),p=e(38681),c=e(56620),x=e(83501),v=e(32442),m=e(25379);function y({datasource:h,onDataSourceChange:d,query:E,onQueryChange:b,onLegacyQueryChange:D,timeRange:C,regex:P,onRegExChange:M,sort:O,onSortChange:j,refresh:U,onRefreshChange:W,isMulti:B,onMultiChange:S,allowCustomValue:_,onAllowCustomValueChange:K,includeAll:T,onIncludeAllChange:L,allValue:A,onAllValueChange:N}){const{value:V}=(0,a.A)(async()=>{const H=await(0,r.l)().get(h??""),Q=await(0,p.y)(H),Z=H?.variables?.getDefaultQuery?.();if(!E&&Z){const Y=typeof Z=="string"?Z:{...Z,refId:Z.refId??"A"};b(Y)}return{datasource:H,VariableQueryEditor:Q}},[h]),{datasource:z,VariableQueryEditor:w}=V??{};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.Y,{children:(0,n.jsx)(i.x6,{i18nKey:"dashboard-scene.query-variable-editor-form.query-options",children:"Query options"})}),(0,n.jsx)(u.D,{label:(0,i.t)("dashboard-scene.query-variable-editor-form.label-data-source","Data source"),htmlFor:"data-source-picker",children:(0,n.jsx)(f.s,{current:h,onChange:d,variables:!0,width:30})}),z&&w&&(0,n.jsx)(l.w,{onQueryChange:b,onLegacyQueryChange:D,datasource:z,query:E,VariableQueryEditor:w,timeRange:C}),(0,n.jsx)(m.Z,{defaultValue:P??"",name:(0,i.t)("dashboard-scene.query-variable-editor-form.name-regex","Regex"),description:(0,n.jsxs)("div",{children:[(0,n.jsx)(i.x6,{i18nKey:"dashboard-scene.query-variable-editor-form.description-optional",children:"Optional, if you want to extract part of a series name or metric node segment."}),(0,n.jsx)("br",{}),(0,n.jsxs)(i.x6,{i18nKey:"dashboard-scene.query-variable-editor-form.description-examples",children:["Named capture groups can be used to separate the display text and value (",(0,n.jsx)(o.Y,{href:"https://grafana.com/docs/grafana/latest/variables/filter-variables-with-regex#filter-and-modify-using-named-text-and-value-capture-groups",external:!0,children:"see examples"}),")."]})]}),placeholder:"/.*-(?<text>.*)-(?<value>.*)-.*/",onBlur:M,testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRegExInputV2,width:52}),(0,n.jsx)(x.z,{testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsSortSelectV2,onChange:j,sort:O}),(0,n.jsx)(c.U,{testId:s.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRefreshSelectV2,onChange:W,refresh:U}),(0,n.jsx)(v.Y,{children:(0,n.jsx)(i.x6,{i18nKey:"dashboard-scene.query-variable-editor-form.selection-options",children:"Selection options"})}),(0,n.jsx)(g.B,{multi:!!B,includeAll:!!T,allowCustomValue:_,allValue:A,onMultiChange:S,onIncludeAllChange:L,onAllValueChange:N,onAllowCustomValueChange:K})]})}},52847:(te,R,e)=>{"use strict";e.d(R,{B:()=>o});var n=e(74848),a=e(51898),s=e(92745),i=e(41654),r=e(69076),u=e(49602);function o({multi:l,allowCustomValue:g,includeAll:f,allValue:p,onMultiChange:c,onAllowCustomValueChange:x,onIncludeAllChange:v,onAllValueChange:m}){return(0,n.jsxs)(i.B,{direction:"column",gap:2,height:"inherit",alignItems:"start",children:[(0,n.jsx)(r.c,{value:l,name:(0,s.t)("dashboard-scene.selection-options-form.name-multi-value","Multi-value"),description:(0,s.t)("dashboard-scene.selection-options-form.description-enables-multiple-values-selected","Enables multiple values to be selected at the same time"),onChange:c,testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsMultiSwitch}),x&&(0,n.jsx)(r.c,{value:g??!0,name:(0,s.t)("dashboard-scene.selection-options-form.name-allow-custom-values","Allow custom values"),description:(0,s.t)("dashboard-scene.selection-options-form.description-enables-users-custom-values","Enables users to add custom values to the list"),onChange:x,testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsAllowCustomValueSwitch}),(0,n.jsx)(r.c,{value:f,name:(0,s.t)("dashboard-scene.selection-options-form.name-include-all-option","Include All option"),description:(0,s.t)("dashboard-scene.selection-options-form.description-enables-option-include-variables","Enables an option to include all values"),onChange:v,testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsIncludeAllSwitch}),f&&(0,n.jsx)(u._,{defaultValue:p??"",onBlur:m,name:(0,s.t)("dashboard-scene.selection-options-form.name-custom-all-value","Custom all value"),testId:a.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsCustomAllInput})]})}},69076:(te,R,e)=>{"use strict";e.d(R,{c:()=>i});var n=e(74848),a=e(92145),s=e(32635);function i({value:r,name:u,description:o,onChange:l,ariaLabel:g,testId:f}){const p=(0,a.Bi)();return(0,n.jsx)(s.S,{id:p,label:u,description:o,value:r,onChange:l,"aria-label":g,"data-testid":f})}},29:(te,R,e)=>{"use strict";e.d(R,{D:()=>o});var n=e(74848),a=e(96540),s=e(7389),i=e(92745),r=e(37386),u=e(77824);function o({onChange:l,hide:g,type:f}){const p=(0,a.useMemo)(()=>[{label:(0,i.t)("dashboard-scene.variable-hide-select.hide_options.label.nothing","Nothing"),value:s.zL.dontHide},{label:(0,i.t)("dashboard-scene.variable-hide-select.hide_options.label.variable","Variable"),value:s.zL.hideVariable},{label:(0,i.t)("dashboard-scene.variable-hide-select.hide_options.label.label","Label"),value:s.zL.hideLabel}],[]),c=(0,a.useMemo)(()=>p.find(x=>x.value===g)?.value??p[0].value,[g,p]);return f==="constant"?null:(0,n.jsx)(r.D,{label:(0,i.t)("dashboard-scene.variable-hide-select.label","Hide"),children:(0,n.jsx)(u.z,{options:p,onChange:l,value:c})})}},32442:(te,R,e)=>{"use strict";e.d(R,{Y:()=>r});var n=e(74848),a=e(22803),s=e(63142),i=e(53487);function r({className:o,...l}){const g=(0,s.of)(u);return(0,n.jsx)(i.s,{...l,className:(0,a.cx)(g.legend,o)})}function u(o){return{legend:(0,a.css)({marginTop:o.spacing(3),marginBottom:o.spacing(1)})}}},68577:(te,R,e)=>{"use strict";e.d(R,{v:()=>o});var n=e(74848),a=e(22803),s=e(96540),i=e(63142),r=e(37386),u=e(18857);function o({name:g,description:f,value:p,options:c,onChange:x,testId:v,width:m}){const y=(0,i.of)(l),h=(0,s.useId)(),d=`variable-select-input-${g}-${h}`;return(0,n.jsx)(r.D,{label:g,description:f,htmlFor:d,children:(0,n.jsx)(u.l6,{"data-testid":v,inputId:d,onChange:x,value:p,width:m??30,options:c,className:y.selectContainer})})}function l(g){return{selectContainer:(0,a.css)({marginRight:g.spacing(.5)})}}},25379:(te,R,e)=>{"use strict";e.d(R,{$:()=>l,Z:()=>o});var n=e(74848),a=e(22803),s=e(92145),i=e(63142),r=e(37386),u=e(87105);function o({value:g,defaultValue:f,name:p,description:c,placeholder:x,onChange:v,onBlur:m,ariaLabel:y,required:h,width:d,testId:E}){const b=(0,i.of)(l),D=(0,s.Bi)();return(0,n.jsx)(r.D,{label:p,description:c,htmlFor:D,children:(0,n.jsx)(u.f,{id:D,rows:2,value:g,defaultValue:f,onChange:v,onBlur:m,placeholder:x,required:h,"aria-label":y,cols:d,className:b.textarea,"data-testid":E})})}function l(g){return{textarea:(0,a.css)({whiteSpace:"pre-wrap",minHeight:g.spacing(4),height:"auto",overflow:"auto",padding:`${g.spacing(.75)} ${g.spacing(1)}`,width:"inherit",[g.breakpoints.down("sm")]:{width:"100%"}})}}},49602:(te,R,e)=>{"use strict";e.d(R,{_:()=>r});var n=e(74848),a=e(92145),s=e(37386),i=e(63527);function r({value:u,defaultValue:o,name:l,placeholder:g="",onChange:f,testId:p,width:c,required:x,onBlur:v,grow:m,description:y,invalid:h,error:d,maxLength:E}){const b=(0,a.Bi)(l);return(0,n.jsx)(s.D,{label:l,description:y,invalid:h,error:d,htmlFor:b,children:(0,n.jsx)(i.p,{type:"text",id:b,placeholder:g,value:u,defaultValue:o,onChange:f,onBlur:v,width:m?void 0:c??30,"data-testid":p,maxLength:E,required:x})})}},18387:(te,R,e)=>{"use strict";e.d(R,{j:()=>p});var n=e(74848),a=e(22803),s=e(96540),i=e(51898),r=e(92745),u=e(63142),o=e(66404),l=e(97095),g=e(79233),f=e(45861);const p=({options:x})=>{const[v,m]=(0,s.useState)(20),[y,h]=(0,s.useState)([]),d=(0,s.useCallback)(b=>{b.preventDefault(),m(v+20)},[v,m]),E=(0,u.of)(c);return(0,s.useEffect)(()=>h(x.slice(0,v)),[v,x]),y.length?(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",marginTop:"16px"},children:[(0,n.jsx)(o.E,{variant:"bodySmall",weight:"medium",children:(0,n.jsx)(r.x6,{i18nKey:"dashboard-scene.variable-values-preview.preview-of-values",children:"Preview of values"})}),(0,n.jsx)(l.C,{children:y.map((b,D)=>(0,n.jsx)(l.C,{className:E.optionContainer,children:(0,n.jsx)(g.c,{"data-testid":i.Tp.pages.Dashboard.Settings.Variables.Edit.General.previewOfValuesOption,children:(0,n.jsx)("div",{className:E.label,children:b.label})})},`${b.value}-${D}`))}),x.length>v&&(0,n.jsx)(l.C,{className:E.optionContainer,children:(0,n.jsx)(f.$n,{onClick:d,variant:"secondary",size:"sm",children:(0,n.jsx)(r.x6,{i18nKey:"dashboard-scene.variable-values-preview.show-more",children:"Show more"})})})]}):null};p.displayName="VariableValuesPreview";function c(x){return{wrapper:(0,a.css)({display:"flex",flexDirection:"column",marginTop:x.spacing(2)}),optionContainer:(0,a.css)({marginLeft:x.spacing(.5),marginBottom:x.spacing(.5)}),label:(0,a.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"50vw"})}}},44741:(te,R,e)=>{"use strict";e.d(R,{cH:()=>Ve,mJ:()=>ze,Ao:()=>me,IO:()=>Be,e_:()=>he,e4:()=>ye,kh:()=>nt,CD:()=>we,No:()=>Xe,B$:()=>Ue,n_:()=>xe,bZ:()=>je,VD:()=>De,c7:()=>Le,c$:()=>Ze});var n=e(2543),a=e(43173),s=e(78282),i=e(36674),r=e(59857),u=e(8285),o=e(74848),l=e(16817),g=e(48480),f=e(51156),p=e(99584);function c(Me){const{variable:$e}=Me,{datasource:at,defaultKeys:ct,allowCustomValue:ft}=$e.useState(),{value:Et}=(0,l.A)(async()=>await(0,s.l)().get(at),[at]),St=Et?.getTagKeys?"Ad hoc filters are applied automatically to all queries that target this data source":"This data source does not support ad hoc filters.",Pt=mt=>{const zt=(0,g.p$)(mt);$e.setState({datasource:zt,supportsMultiValueOperators:mt.meta.multiValueFilterOperators})},Dt=mt=>{$e.setState({defaultKeys:mt})},Ye=mt=>{$e.setState({allowCustomValue:mt.currentTarget.checked})};return(0,o.jsx)(p.Q,{datasource:at??void 0,infoText:St,allowCustomValue:ft,onDataSourceChange:Pt,defaultKeys:ct,onDefaultKeysChange:Dt,onAllowCustomValueChange:Ye,inline:Me.inline,datasourceSupported:!!Et?.getTagKeys})}function x(Me){return Me instanceof i.H9?[new f.v({render:()=>(0,o.jsx)(c,{variable:Me,onRunQuery:n.noop,inline:!0})})]:(console.warn("getAdHocFilterOptions: variable is not an AdHocFiltersVariable"),[])}var v=e(75505),m=e(92745),y=e(63527),h=e(23675);function d({variable:Me}){const{value:$e}=Me.useState(),at=ct=>{Me.setState({value:ct.currentTarget.value})};return(0,o.jsx)(h.d,{constantValue:$e.toString(),onChange:at})}function E(Me){return Me instanceof i.x0?[new f.v({title:(0,m.t)("dashboard-scene.constant-variable-form.label-value","Value"),render:()=>(0,o.jsx)(b,{variable:Me})})]:(console.warn("getConstantVariableOptions: variable is not a ConstantVariable"),[])}function b({variable:Me}){const{value:$e}=Me.useState(),at=async ct=>{Me.setState({value:ct.currentTarget.value}),await(0,v.s)(Me.validateAndUpdate())};return(0,o.jsx)(y.p,{defaultValue:$e.toString(),onBlur:at,placeholder:(0,m.t)("dashboard-scene.constant-variable-form.placeholder-your-metric-prefix","Your metric prefix")})}var D=e(51898),C=e(87105),P=e(70430);function M({variable:Me,onRunQuery:$e}){const{query:at,isMulti:ct,allValue:ft,includeAll:Et,allowCustomValue:St}=Me.useState(),Pt=Jt=>{Me.setState({isMulti:Jt.currentTarget.checked})},Dt=Jt=>{Me.setState({includeAll:Jt.currentTarget.checked})},Ye=Jt=>{Me.setState({query:Jt.currentTarget.value}),$e()},mt=Jt=>{Me.setState({allValue:Jt.currentTarget.value})},zt=Jt=>{Me.setState({allowCustomValue:Jt.currentTarget.checked})};return(0,o.jsx)(P.w,{query:at??"",multi:!!ct,allValue:ft??"",includeAll:!!Et,allowCustomValue:St,onMultiChange:Pt,onIncludeAllChange:Dt,onQueryChange:Ye,onAllValueChange:mt,onAllowCustomValueChange:zt})}function O(Me){return Me instanceof i.yP?[new f.v({title:(0,m.t)("dashboard.edit-pane.variable.custom-options.values","Values separated by comma"),render:()=>(0,o.jsx)(j,{variable:Me})})]:[]}function j({variable:Me}){const{query:$e}=Me.useState(),at=async ct=>{Me.setState({query:ct.currentTarget.value}),await(0,v.s)(Me.validateAndUpdate())};return(0,o.jsx)(C.f,{rows:2,defaultValue:$e,onBlur:at,placeholder:(0,m.t)("dashboard.edit-pane.variable.custom-options.values-placeholder","1, 10, mykey : myvalue, myvalue, escaped,value"),required:!0,"data-testid":D.Tp.pages.Dashboard.Settings.Variables.Edit.CustomVariable.customValueInput})}var U=e(43243),W=e(42272);function B({variable:Me,onRunQuery:$e}){const{pluginId:at,regex:ct,isMulti:ft,allValue:Et,includeAll:St,allowCustomValue:Pt}=Me.useState(),Dt=ye(),Ye=ln=>{Me.setState({pluginId:ln.value}),$e()},mt=ln=>{Me.setState({regex:ln.currentTarget.value}),$e()},zt=ln=>{Me.setState({isMulti:ln.currentTarget.checked})},Jt=ln=>{Me.setState({includeAll:ln.currentTarget.checked})},Xt=ln=>{Me.setState({allValue:ln.currentTarget.value})},En=ln=>{Me.setState({allowCustomValue:ln.currentTarget.checked})};return(0,o.jsx)(W.y,{query:at,regex:ct,multi:ft||!1,allValue:Et,includeAll:St||!1,optionTypes:Dt,allowCustomValue:Pt,onChange:Ye,onRegExBlur:mt,onMultiChange:zt,onIncludeAllChange:Jt,onAllValueChange:Xt,onAllowCustomValueChange:En})}function S(Me){return Me instanceof i.mI?[new f.v({title:(0,m.t)("dashboard.edit-pane.variable.datasource-options.type","Type"),render:()=>(0,o.jsx)(_,{variable:Me})}),new f.v({title:(0,m.t)("dashboard.edit-pane.variable.datasource-options.name-filter","Name filter"),description:(0,m.t)("dashboard.edit-pane.variable.datasource-options.name-filter-description","Regex filter for which data source instances to include. Leave empty for all."),render:()=>(0,o.jsx)(K,{variable:Me})})]:[]}function _({variable:Me}){const{pluginId:$e}=Me.useState(),at=ye(),ct=async ft=>{Me.setState({pluginId:ft.value}),await(0,v.s)(Me.validateAndUpdate())};return(0,o.jsx)(U.G,{options:at,value:$e,onChange:ct,placeholder:(0,m.t)("dashboard.edit-pane.variable.datasource-options.type-placeholder","Choose data source type"),"data-testid":D.Tp.pages.Dashboard.Settings.Variables.Edit.DatasourceVariable.datasourceSelect})}function K({variable:Me}){const{regex:$e}=Me.useState(),at=async ct=>{Me.setState({regex:ct.currentTarget.value}),await(0,v.s)(Me.validateAndUpdate())};return(0,o.jsx)(y.p,{defaultValue:$e,onBlur:at,"data-testid":D.Tp.pages.Dashboard.Settings.Variables.Edit.DatasourceVariable.nameFilter,placeholder:(0,m.t)("dashboard.edit-pane.variable.datasource-options.name-filter-placeholder","Example: /^prod/")})}var T=e(96540),L=e(68125),A=e(30048),N=e(31286),V=e(34999),z=e(37386),w=e(21285),H=e(50992),Q=e(76792),Z=e(69076),Y=e(32442);function X({datasource:Me,defaultOptions:$e,infoText:at,onDataSourceChange:ct,onDefaultOptionsChange:ft,allowCustomValue:Et,onAllowCustomValueChange:St,inline:Pt,datasourceSupported:Dt}){const Ye=(0,T.useCallback)(mt=>{const zt=(0,L.Jh)(`key,value
`+mt)[0],Jt=[];for(let Xt=0;Xt<zt.length;Xt++)Jt.push({text:zt.fields[0].values[Xt],value:zt.fields[1].values[Xt]});ft(Jt)},[ft]);return(0,o.jsxs)(o.Fragment,{children:[!Pt&&(0,o.jsx)(Y.Y,{children:(0,o.jsx)(m.x6,{i18nKey:"dashboard-scene.group-by-variable-form.group-by-options",children:"Group by options"})}),(0,o.jsx)(N.a,{marginBottom:2,children:(0,o.jsx)(A.c,{label:(0,m.t)("dashboard-scene.group-by-variable-form.label-data-source","Data source"),htmlFor:"data-source-picker",tooltip:at,children:(0,o.jsx)(Q.s,{current:Me,onChange:ct,width:30,variables:!0,noDefault:!0})})}),Dt?null:(0,o.jsx)(V.F,{title:(0,m.t)("dashboard-scene.group-by-variable-form.alert-not-supported","This data source does not support group by variables"),severity:"warning","data-testid":D.Tp.pages.Dashboard.Settings.Variables.Edit.GroupByVariable.infoText}),Dt&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(z.D,{label:(0,m.t)("dashboard-scene.group-by-variable-form.label-use-static-group-by-dimensions","Use static group dimensions"),description:(0,m.t)("dashboard-scene.group-by-variable-form.description-provide-dimensions-as-csv-dimension-name-dimension-id","Provide dimensions as CSV: {{name}}, {{value}}",{name:"dimensionName",value:"dimensionId"}),children:(0,o.jsx)(w.d,{"data-testid":D.Tp.pages.Dashboard.Settings.Variables.Edit.GroupByVariable.modeToggle,value:$e!==void 0,onChange:mt=>{ft($e===void 0?[]:void 0)}})}),$e!==void 0&&(0,o.jsx)(H.B,{height:300,language:"csv",value:$e.map(mt=>`${mt.text},${mt.value}`).join(`
`),onBlur:Ye,onSave:Ye,showMiniMap:!1,showLineNumbers:!0})]}),Dt&&!Pt&&St&&(0,o.jsx)(Z.c,{value:Et,name:(0,m.t)("dashboard-scene.group-by-variable-form.name-allow-custom-values","Allow custom values"),description:(0,m.t)("dashboard-scene.group-by-variable-form.description-enables-users-custom-values","Enables users to add custom values to the list"),onChange:St,testId:D.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsAllowCustomValueSwitch})]})}function I(Me){const{variable:$e,onRunQuery:at,inline:ct}=Me,{datasource:ft,defaultOptions:Et,allowCustomValue:St=!0}=$e.useState(),{value:Pt}=(0,l.A)(async()=>await(0,s.l)().get(ft),[$e.state]),Dt=Pt?.getTagKeys!==void 0,Ye=Dt?"Group by dimensions are applied automatically to all queries that target this data source":"This data source does not support group by variable yet.",mt=async Xt=>{const En=(0,g.p$)(Xt);$e.setState({datasource:En}),at()},zt=async Xt=>{$e.setState({defaultOptions:Xt}),at()},Jt=Xt=>{$e.setState({allowCustomValue:Xt.currentTarget.checked})};return(0,o.jsx)(X,{defaultOptions:Et,datasource:ft??void 0,infoText:ft?Ye:void 0,onDataSourceChange:mt,onDefaultOptionsChange:zt,allowCustomValue:St,onAllowCustomValueChange:Jt,inline:ct,datasourceSupported:Dt})}function J(Me){return Me instanceof i.ZG?[new f.v({render:()=>(0,o.jsx)(I,{variable:Me,onRunQuery:n.noop,inline:!0})})]:(console.warn("getAdHocFilterOptions: variable is not an AdHocFiltersVariable"),[])}var ee=e(1096);function q({variable:Me,onRunQuery:$e,inline:at}){const{intervals:ct,autoStepCount:ft,autoEnabled:Et,autoMinInterval:St,value:Pt}=Me.useState(),Dt=(0,u.bx)(ct),Ye=Xt=>{const En=(0,u.Sm)(Xt.currentTarget.value),ln=En.includes(Pt)?Pt:En[0];Me.setState({intervals:En,value:ln}),$e()},mt=Xt=>{Me.setState({autoStepCount:Xt.value})},zt=Xt=>{Me.setState({autoEnabled:Xt.target.checked})},Jt=Xt=>{Me.setState({autoMinInterval:Xt.currentTarget.value})};return(0,o.jsx)(ee.s,{intervals:Dt,autoStepCount:ft,autoEnabled:Et,onAutoCountChanged:mt,onIntervalsChange:Ye,onAutoEnabledChange:zt,onAutoMinIntervalChanged:Jt,autoMinInterval:St,inline:at})}function ne(Me){return Me instanceof i.Yj?[new f.v({render:()=>(0,o.jsx)(q,{variable:Me,onRunQuery:n.noop,inline:!0})})]:(console.warn("getIntervalVariableOptions: variable is not an IntervalVariable"),[])}var se=e(45861),oe=e(22787),de=e(89640),fe=e(66698),ae=e(38681),ce=e(56620),ie=e(83501),ve=e(28799),le=e(25379),Ee=e(18387);function Re({variable:Me,onRunQuery:$e}){const{datasource:at,regex:ct,sort:ft,refresh:Et,isMulti:St,includeAll:Pt,allValue:Dt,query:Ye,allowCustomValue:mt}=Me.useState(),{value:zt}=i.jh.getTimeRange(Me).useState(),Jt=gt=>{Me.setState({regex:gt.currentTarget.value})},Xt=gt=>{Me.setState({sort:gt.value})},En=gt=>{Me.setState({refresh:gt})},ln=gt=>{Me.setState({isMulti:gt.currentTarget.checked})},cn=gt=>{Me.setState({includeAll:gt.currentTarget.checked})},Pn=gt=>{Me.setState({allValue:gt.currentTarget.value})},wn=gt=>{Me.setState({allowCustomValue:gt.currentTarget.checked})},jn=gt=>{const Lt=(0,g.p$)(gt);if((Me.state.datasource?.type||"")!==Lt.type){Me.setState({datasource:Lt,query:"",definition:""});return}Me.setState({datasource:Lt})},kn=gt=>{Me.setState({query:gt,definition:_e(gt)}),$e()};return(0,o.jsx)(ve.u,{datasource:at??void 0,onDataSourceChange:jn,query:Ye,onQueryChange:kn,onLegacyQueryChange:kn,timeRange:zt,regex:ct,onRegExChange:Jt,sort:ft,onSortChange:Xt,refresh:Et,onRefreshChange:En,isMulti:!!St,onMultiChange:ln,includeAll:!!Pt,onIncludeAllChange:cn,allValue:Dt??"",onAllValueChange:Pn,allowCustomValue:mt,onAllowCustomValueChange:wn})}function Oe(Me){return Me instanceof i.fS?[new f.v({render:()=>(0,o.jsx)(Se,{variable:Me})})]:(console.warn("getQueryVariableOptions: variable is not a QueryVariable"),[])}function Se({variable:Me}){const[$e,at]=(0,T.useState)(!1),ct=()=>{Me.refreshOptions()};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(N.a,{display:"flex",direction:"column",paddingBottom:1,children:(0,o.jsx)(se.$n,{tooltip:(0,m.t)("dashboard.edit-pane.variable.open-editor-tooltip","For more variable options open variable editor"),onClick:()=>at(!0),size:"sm",fullWidth:!0,"data-testid":D.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsOpenButton,children:(0,o.jsx)(m.x6,{i18nKey:"dashboard.edit-pane.variable.open-editor",children:"Open variable editor"})})}),(0,o.jsxs)(oe.a,{title:(0,m.t)("dashboard.edit-pane.variable.query-options.modal-title","Query Variable"),isOpen:$e,onDismiss:()=>at(!1),children:[(0,o.jsx)(Te,{variable:Me}),(0,o.jsxs)(oe.a.ButtonRow,{children:[(0,o.jsx)(se.$n,{variant:"primary",fill:"outline",onClick:ct,"data-testid":D.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.previewButton,children:(0,o.jsx)(m.x6,{i18nKey:"dashboard.edit-pane.variable.query-options.preview",children:"Preview"})}),(0,o.jsx)(se.$n,{variant:"secondary",fill:"outline",onClick:()=>at(!1),"data-testid":D.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.closeButton,children:(0,o.jsx)(m.x6,{i18nKey:"dashboard.edit-pane.variable.query-options.close",children:"Close"})})]})]})]})}function Te({variable:Me}){const{datasource:$e,sort:at,refresh:ct,query:ft,regex:Et}=Me.useState(),{value:St}=i.jh.getTimeRange(Me).useState(),{value:Pt}=(0,l.A)(async()=>{const cn=await(0,s.l)().get($e??""),Pn=await(0,ae.y)(cn),wn=cn?.variables?.getDefaultQuery?.();if(!ft&&wn){const jn=typeof wn=="string"?wn:{...wn,refId:wn.refId??"A"};zt(jn)}return{datasource:cn,VariableQueryEditor:Pn}},[$e]),{datasource:Dt,VariableQueryEditor:Ye}=Pt??{},mt=cn=>{const Pn=(0,g.p$)(cn);if((Me.state.datasource?.type||"")!==Pn.type){Me.setState({datasource:Pn,query:"",definition:""});return}Me.setState({datasource:Pn})},zt=cn=>{Me.setState({query:cn,definition:_e(cn)})},Jt=cn=>{Me.setState({regex:cn.currentTarget.value})},Xt=cn=>{Me.setState({sort:cn.value})},En=cn=>{Me.setState({refresh:cn})},ln=xe(Me);return(0,o.jsxs)("div",{"data-testid":D.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.editor,children:[(0,o.jsx)(z.D,{label:(0,m.t)("dashboard-scene.query-variable-editor-form.label-target-data-source","Target data source"),htmlFor:"data-source-picker",children:(0,o.jsx)(Q.s,{current:Dt,onChange:mt,variables:!0,width:30})}),Dt&&Ye&&(0,o.jsx)(fe.w,{onQueryChange:zt,onLegacyQueryChange:zt,datasource:Dt,query:ft,VariableQueryEditor:Ye,timeRange:St}),(0,o.jsx)(le.Z,{defaultValue:Et??"",name:(0,m.t)("dashboard-scene.query-variable-editor-form.name-regex","Regex"),description:(0,o.jsxs)("div",{children:[(0,o.jsx)(m.x6,{i18nKey:"dashboard-scene.query-variable-editor-form.description-optional",children:"Optional, if you want to extract part of a series name or metric node segment."}),(0,o.jsx)("br",{}),(0,o.jsxs)(m.x6,{i18nKey:"dashboard-scene.query-variable-editor-form.description-examples",children:["Named capture groups can be used to separate the display text and value (",(0,o.jsx)(de.Y,{href:"https://grafana.com/docs/grafana/latest/variables/filter-variables-with-regex#filter-and-modify-using-named-text-and-value-capture-groups",external:!0,children:"see examples"}),")."]})]}),placeholder:"/.*-(?<text>.*)-(?<value>.*)-.*/",onBlur:Jt,testId:D.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRegExInputV2,width:52}),(0,o.jsx)(ie.z,{testId:D.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsSortSelectV2,onChange:Xt,sort:at}),(0,o.jsx)(ce.U,{testId:D.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRefreshSelectV2,onChange:En,refresh:ct}),ln&&(0,o.jsx)(Ee.j,{options:Me.getOptionsForSelect(!1)})]})}function _e(Me){return typeof Me=="string"?Me:Me.hasOwnProperty("query")&&typeof Me.query=="string"?Me.query:""}var He=e(49602);function tt({defaultValue:Me,value:$e,onChange:at,onBlur:ct,inline:ft}){return(0,o.jsxs)(o.Fragment,{children:[!ft&&(0,o.jsx)(Y.Y,{children:(0,o.jsx)(m.x6,{i18nKey:"dashboard-scene.text-box-variable-form.text-options",children:"Text options"})}),(0,o.jsx)(He._,{value:$e,defaultValue:Me,name:ft?void 0:(0,m.t)("dashboard-scene.text-box-variable.name-default-value","Default value"),placeholder:(0,m.t)("dashboard-scene.text-box-variable-form.placeholder-default-value-if-any","(optional)"),onChange:at,onBlur:ct,width:30,testId:D.Tp.pages.Dashboard.Settings.Variables.Edit.TextBoxVariable.textBoxOptionsQueryInputV2})]})}function Je({variable:Me,inline:$e}){const{value:at}=Me.useState(),ct=ft=>{Me.setState({value:ft.currentTarget.value})};return(0,o.jsx)(tt,{defaultValue:at,onBlur:ct,inline:$e})}function Ge(Me){return Me instanceof i.TS?[new f.v({title:(0,m.t)("dashboard-scene.textbox-variable-form.label-value","Value"),render:()=>(0,o.jsx)(Je,{onChange:n.noop,variable:Me,inline:!0})})]:(console.warn("getTextBoxVariableOptions: variable is not a TextBoxVariable"),[])}function je(Me){return Me!=="system"}const Fe={custom:{name:"Custom",description:"Values are static and defined manually",editor:M,getOptions:O},query:{name:"Query",description:"Values are fetched from a data source query",editor:Re,getOptions:Oe},constant:{name:"Constant",description:"A hidden constant variable, useful for metric prefixes in dashboards you want to share",editor:d,getOptions:E},interval:{name:"Interval",description:"Values are timespans, ex 1m, 1h, 1d",editor:q,getOptions:ne},datasource:{name:"Data source",description:"Dynamically switch the data source for multiple panels",editor:B,getOptions:S},adhoc:{name:"Ad hoc filters",description:"Add key/value filters on the fly",editor:c,getOptions:x},groupby:{name:"Group by",description:"Add keys to group by on the fly",editor:I,getOptions:J},textbox:{name:"Textbox",description:"Users can enter any arbitrary strings in a textbox",editor:Je,getOptions:Ge}};function Be(Me){const $e=Fe[Me];if(!$e)throw new Error(`Variable type ${Me} not found`);return $e}const Ke=["query","custom","textbox","constant","datasource","interval","adhoc","groupby"];function Ue(){const Me=Ke.map($e=>({label:Fe[$e].name,value:$e,description:Fe[$e].description}));return a.$.featureToggles.groupByVariable?Me:Me.filter($e=>$e.value!=="groupby")}function we(Me){return Fe[Me].editor}function Xe(Me,$e){switch(Me){case"custom":return new i.yP($e);case"query":return new i.fS($e);case"constant":return new i.x0({...$e,hide:r.zL.hideVariable});case"interval":return new i.Yj($e);case"datasource":return new i.mI($e);case"adhoc":return new i.H9({...$e,layout:a.$.featureToggles.newFiltersUI?"combobox":void 0});case"groupby":return new i.ZG($e);case"textbox":return new i.TS($e)}}function nt(Me){const at=he("query",Me);return new i.fS({name:at})}function he(Me,$e){let at=0,ct=`${Me}${at}`;for(;$e.find(ft=>ft.state.name===ct);)ct=`${Me}${++at}`;return ct}function xe(Me){return"options"in Me.state||"intervals"in Me.state}function me(Me){let $e="";return Me instanceof i.fS?$e=Me.state.definition||(typeof Me.state.query=="string"?Me.state.query:""):Me instanceof i.mI?$e=String(Me.state.pluginId):Me instanceof i.yP?$e=Me.state.query:Me instanceof i.Yj?$e=(0,u.bx)(Me.state.intervals):(Me instanceof i.TS||Me instanceof i.x0)&&($e=String(Me.state.value)),$e}function ye(){const Me=(0,s.l)().getList({metrics:!0,variables:!0});return(0,n.chain)(Me).uniqBy("meta.id").map(at=>({label:at.meta.name,value:at.meta.id})).value()}function De(Me){return"type"in Me.state&&"getValue"in Me}function Le(Me){return De(Me)?i.Go.isAdHocVariable(Me)||i.Go.isConstantVariable(Me)||i.Go.isCustomVariable(Me)||i.Go.isDataSourceVariable(Me)||i.Go.isIntervalVariable(Me)||i.Go.isQueryVariable(Me)||i.Go.isTextBoxVariable(Me)||i.Go.isGroupByVariable(Me):!1}const Ve=/^(?!__).*$/,ze=/^\w+$/;function Ze(Me,$e){const at=Me.parent;if(!(at instanceof i.Pj))throw new Error("Variable parent is not a SceneVariableSet");if(!Ve.test($e))return{isValid:!1,errorMessage:"Template names cannot begin with '__', that's reserved for Grafana's global variables"};if(!ze.test($e))return{isValid:!1,errorMessage:"Only word characters are allowed in variable names"};const ct=at.getByName($e);return ct&&ct!==Me?{isValid:!1,errorMessage:"Variable with the same name already exists"}:{isValid:!0}}},34753:(te,R,e)=>{"use strict";e.d(R,{D:()=>c});var n=e(74848),a=e(22803),s=e(2543),i=e(63142),r=e(30703);const u=({diff:v})=>{const m=(0,i.of)(o),y=!(0,s.isUndefined)(v.originalValue)&&!(0,s.isArray)(v.originalValue)&&!(0,s.isObject)(v.originalValue),h=!(0,s.isUndefined)(v.value)&&!(0,s.isArray)(v.value)&&!(0,s.isObject)(v.value);return(0,n.jsxs)(n.Fragment,{children:[y&&(0,n.jsx)("span",{className:m,children:String(v.originalValue)}),y&&h?(0,n.jsx)(r.I,{name:"arrow-right"}):null,h&&(0,n.jsx)("span",{className:m,children:String(v.value)})]})},o=v=>(0,a.css)({backgroundColor:v.colors.action.hover,borderRadius:v.shape.radius.default,color:v.colors.text.primary,fontSize:v.typography.body.fontSize,margin:v.spacing(0,.5),padding:v.spacing(.25,.5)});var l=e(61371);const g={op:"replace",originalValue:void 0,path:[""],value:void 0,startLineNumber:0,endLineNumber:0},f=({diff:v,title:m})=>{const y=(0,i.of)(p);return v?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.I,{type:"mono",name:"circle",className:y[v.op],size:"xs"})," ",(0,n.jsx)("span",{className:y.embolden,children:m})," ",(0,n.jsx)("span",{children:(0,l.Fl)(v,v.path?.length>1)})," ",(0,n.jsx)(u,{diff:v})]}):(0,n.jsxs)("div",{className:y.withoutDiff,children:[(0,n.jsx)(r.I,{type:"mono",name:"circle",className:y.replace,size:"xs"})," ",(0,n.jsx)("span",{className:y.embolden,children:m})," ",(0,n.jsx)("span",{children:(0,l.Fl)(g,!1)})]})},p=v=>({embolden:(0,a.css)({fontWeight:v.typography.fontWeightBold}),add:(0,a.css)({color:v.colors.success.main}),replace:(0,a.css)({color:v.colors.warning.main}),move:(0,a.css)({color:v.colors.warning.main}),copy:(0,a.css)({color:v.colors.success.main}),_get:(0,a.css)({color:v.colors.success.main}),test:(0,a.css)({color:v.colors.success.main}),remove:(0,a.css)({color:v.colors.error.main}),withoutDiff:(0,a.css)({marginBottom:v.spacing(1)})}),c=({diffs:v,title:m})=>{const y=(0,i.of)(x);return v.length===1?(0,n.jsx)("div",{className:y.container,"data-testid":"diffGroup",children:(0,n.jsx)(f,{title:m,diff:v[0]})}):(0,n.jsxs)("div",{className:y.container,"data-testid":"diffGroup",children:[(0,n.jsx)(f,{title:m}),(0,n.jsx)("ul",{className:y.list,children:v.map((h,d)=>(0,n.jsxs)("li",{className:y.listItem,children:[(0,n.jsx)("span",{children:(0,l.Fl)(h)})," ",(0,n.jsx)(u,{diff:h})]},`${(0,s.last)(h.path)}__${d}`))})]})},x=v=>({container:(0,a.css)({}),list:(0,a.css)({marginLeft:v.spacing(4)}),listItem:(0,a.css)({marginBottom:v.spacing(1),"&:last-child":{marginBottom:0}})})},1199:(te,R,e)=>{"use strict";e.d(R,{M:()=>o});var n=e(74848),a=e(22803),s=e(82514),i=e.n(s),r=e(84140),u=e(63142);const o=({oldValue:l,newValue:g,...f})=>{const p=(0,u.$j)(),c={variables:{dark:{diffViewerBackground:p.colors.background.canvas,diffViewerColor:p.colors.text.primary,addedBackground:(0,r.A)(p.v1.palette.greenShade).setAlpha(.3).toString(),addedColor:"white",removedBackground:(0,r.A)(p.v1.palette.redShade).setAlpha(.3).toString(),removedColor:"white",wordAddedBackground:(0,r.A)(p.v1.palette.greenBase).setAlpha(.4).toString(),wordRemovedBackground:(0,r.A)(p.v1.palette.redBase).setAlpha(.4).toString(),addedGutterBackground:(0,r.A)(p.v1.palette.greenShade).setAlpha(.2).toString(),removedGutterBackground:(0,r.A)(p.v1.palette.redShade).setAlpha(.2).toString(),gutterBackground:p.colors.background.primary,gutterBackgroundDark:p.colors.background.primary,highlightBackground:(0,r.A)(p.colors.primary.main).setAlpha(.4).toString(),highlightGutterBackground:(0,r.A)(p.colors.primary.shade).setAlpha(.2).toString(),codeFoldGutterBackground:p.colors.background.secondary,codeFoldBackground:p.colors.background.secondary,emptyLineBackground:p.colors.background.secondary,gutterColor:p.colors.text.disabled,addedGutterColor:p.colors.text.primary,removedGutterColor:p.colors.text.primary,codeFoldContentColor:p.colors.text.disabled,diffViewerTitleBackground:p.colors.background.secondary,diffViewerTitleColor:p.colors.text.disabled,diffViewerTitleBorderColor:p.colors.border.strong}},codeFold:{fontSize:p.typography.bodySmall.fontSize},gutter:{pre:{color:(0,r.A)(p.colors.text.disabled).setAlpha(1).toString(),opacity:.61}}};return(0,n.jsx)("div",{className:(0,a.css)({fontSize:p.typography.bodySmall.fontSize,pre:{all:"revert"}}),children:(0,n.jsx)(i(),{styles:c,oldValue:l,newValue:g,splitView:!1,compareMethod:s.DiffMethod.CSS,useDarkTheme:p.isDark,...f})})}},19161:(te,R,e)=>{"use strict";e.d(R,{w:()=>s});var n=e(68143);class a{getHistoryList(r,u){return typeof r!="string"?Promise.resolve([]):(0,n.AI)().get(`api/dashboards/uid/${r}/versions`,u)}getDashboardVersion(r,u){return typeof r!="string"?Promise.resolve({}):(0,n.AI)().get(`api/dashboards/uid/${r}/versions/${u}`)}restoreDashboard(r,u){if(typeof r!="string")return Promise.resolve({});const o=`api/dashboards/uid/${r}/restore`;return(0,n.AI)().post(o,{version:u})}}const s=new a},10685:(te,R,e)=>{"use strict";e.d(R,{r:()=>o});var n=e(74848),a=e(92745),s=e(41654),i=e(45861),r=e(45967),u=e(23289);const o=({hasMore:l,canCompare:g,getVersions:f,getDiff:p,isLastPage:c})=>(0,n.jsxs)(s.B,{children:[l&&(0,n.jsx)(i.$n,{type:"button",onClick:()=>{f(!0),u.c.showMoreVersionsClicked()},variant:"secondary",disabled:c,children:(0,n.jsx)(a.x6,{i18nKey:"dashboard-scene.versions-history-buttons.show-more-versions",children:"Show more versions"})}),(0,n.jsx)(r.m,{content:(0,a.t)("dashboard-scene.versions-history-buttons.content-select-two-versions-to-start-comparing","Select two versions to start comparing"),placement:"bottom",children:(0,n.jsx)(i.$n,{type:"button",disabled:!g,onClick:p,icon:"code-branch",children:(0,n.jsx)(a.x6,{i18nKey:"dashboard-scene.versions-history-buttons.compare-versions",children:"Compare versions"})})})]})},7923:(te,R,e)=>{"use strict";e.d(R,{m:()=>g});var n=e(74848),a=e(22803),s=e(2543),i=e.n(s),r=e(92745),u=e(63142),o=e(76319),l=e(30703);const g=({onClick:p=s.noop,baseVersion:c=0,newVersion:x=0,isNewLatest:v=!1})=>{const m=(0,u.of)(f);return(0,n.jsxs)("h3",{className:m.header,children:[(0,n.jsx)(o.K,{name:"arrow-left",size:"xl",onClick:p,tooltip:(0,r.t)("dashboard-scene.version-history-header.tooltip-reset-version","Reset version")}),(0,n.jsxs)("span",{children:[(0,n.jsxs)(r.x6,{i18nKey:"dashboard-scene.version-history-header.compare-versions",children:["Comparing ",{baseVersion:c}," ",(0,n.jsx)(l.I,{name:"arrows-h"})," ",{newVersion:x}]})," ",v&&(0,n.jsx)("cite",{className:"muted",children:(0,n.jsx)(r.x6,{i18nKey:"dashboard-scene.version-history-header.latest",children:"(Latest)"})})]})]})},f=p=>({header:(0,a.css)({fontSize:p.typography.h3.fontSize,display:"flex",gap:p.spacing(2),marginBottom:p.spacing(2)})})},61371:(te,R,e)=>{"use strict";e.d(R,{Fl:()=>u,G4:()=>r});var n=e(16111),a=e(25504),s=e(2543),i=e.n(s);const r=(g,f)=>{const p=(0,n.UD)(g,f),c=a.stringify(g,null,2),x=a.stringify(f,null,2),v=h=>h.map(d=>{let E,b,D=0,C=0;const P=(0,s.tail)(d.path.split("/"));return d.op==="replace"&&x.pointers[d.path]&&(E=(0,s.get)(g,P),b=d.value,D=x.pointers[d.path].value.line,C=x.pointers[d.path].valueEnd.line),d.op==="add"&&x.pointers[d.path]&&(b=d.value,D=x.pointers[d.path].value.line,C=x.pointers[d.path].valueEnd.line),d.op==="remove"&&c.pointers[d.path]&&(E=(0,s.get)(g,P),D=c.pointers[d.path].value.line,C=c.pointers[d.path].valueEnd.line),{op:d.op,value:b,path:P,originalValue:E,startLineNumber:D,endLineNumber:C}}),m=h=>(0,s.sortBy)(h,"startLineNumber"),y=h=>h.reduce((d,E)=>{const b=E.path[0];return d[b]||(d[b]=[]),d[b].push(E),d},{});return(0,s.flow)([v,m,y])(p)},u=(g,f=!0)=>{const p=(0,s.last)(g.path),c=o(p),x=g.op==="remove"?g.originalValue:g.value;let v=l(g.op);return f&&(c?v+=` item ${p}`:(0,s.isArray)(x)&&!(0,s.isEmpty)(x)?v+=` ${x.length} ${p}`:v+=` ${p}`),v},o=g=>!(0,s.isNaN)((0,s.toNumber)(g)),l=g=>g==="add"?"added":g==="remove"?"deleted":"changed"},55867:(te,R,e)=>{"use strict";e.d(R,{A:()=>x});var n=e(74848),a=e(96540),s=e(51898),i=e(92745),r=e(36490),u=e(43173),o=e(87063),l=e(58662),g=e(23289);const f=s.Tp.pages.Dashboard.DashNav.NewExportButton.Menu,p=[];function c(v){p.push(v)}function x({dashboard:v}){const m=d=>{r.Ny.partial({shareView:d})},y=(0,a.useCallback)(()=>{const d=[];p.forEach(b=>d.push(b));const E=u.$.featureToggles.kubernetesDashboards?(0,i.t)("dashboard.toolbar.new.export.tooltip.as-code","Export as code"):(0,i.t)("share-dashboard.menu.export-json-title","Export as JSON");return d.push({shareId:l.wr.export,testId:f.exportAsJson,icon:"arrow",label:E,renderCondition:!0,onClick:()=>m(l.wr.export)}),d.filter(b=>b.renderCondition)},[]),h=d=>{g.c.sharingCategoryClicked({item:d.shareId,shareResource:(0,l.hD)()}),d.onClick(v)};return(0,n.jsx)(o.W,{"data-testid":f.container,children:y().map(d=>(0,n.jsx)(o.W.Item,{testId:d.testId,label:d.label,icon:d.icon,description:d.description,onClick:()=>h(d)},d.label))})}},84330:(te,R,e)=>{"use strict";e.d(R,{i:()=>g,j:()=>f});var n=e(74848),a=e(92745),s=e(41654),i=e(72636),r=e(77824),u=e(21285),o=e(34999),l=e(89640),g=(p=>(p.Classic="classic",p.V1Resource="v1-resource",p.V2Resource="v2-resource",p))(g||{});function f({dashboardJson:p,isSharingExternally:c,exportMode:x,isViewingYAML:v,onExportModeChange:m,onShareExternallyChange:y,onViewYAML:h}){const d=p.value?.hasLibraryPanels,E=p.value?.initialSaveModelVersion,b=p.value?.json&&"spec"in p.value.json&&"elements"in p.value.json.spec,D=b&&c&&d,C=x==="v2-resource"?(0,a.t)("export.json.export-remove-ds-refs","Remove deployment details"):(0,a.t)("share-modal.export.share-externally-label","Export for sharing externally"),P=(0,a.t)("export.json.export-mode","Model"),M=(0,a.t)("export.json.export-format","Format");return(0,n.jsxs)(s.B,{gap:2,direction:"column",children:[(0,n.jsxs)(s.B,{gap:1,direction:"column",children:[E==="v1"&&(0,n.jsxs)(s.B,{alignItems:"center",children:[(0,n.jsx)(i.J,{children:P}),(0,n.jsx)(r.z,{options:[{label:(0,a.t)("dashboard-scene.resource-export.label.classic","Classic"),value:"classic"},{label:(0,a.t)("dashboard-scene.resource-export.label.v1-resource","V1 Resource"),value:"v1-resource"},{label:(0,a.t)("dashboard-scene.resource-export.label.v2-resource","V2 Resource"),value:"v2-resource"}],value:x,onChange:O=>m(O)})]}),E==="v2"&&(0,n.jsxs)(s.B,{alignItems:"center",children:[(0,n.jsx)(i.J,{children:P}),(0,n.jsx)(r.z,{options:[{label:(0,a.t)("dashboard-scene.resource-export.label.v2-resource","V2 Resource"),value:"v2-resource"},{label:(0,a.t)("dashboard-scene.resource-export.label.v1-resource","V1 Resource"),value:"v1-resource"}],value:x,onChange:O=>m(O)})]}),x!=="classic"&&(0,n.jsxs)(s.B,{gap:1,alignItems:"center",children:[(0,n.jsx)(i.J,{children:M}),(0,n.jsx)(r.z,{options:[{label:(0,a.t)("dashboard-scene.resource-export.label.json","JSON"),value:"json"},{label:(0,a.t)("dashboard-scene.resource-export.label.yaml","YAML"),value:"yaml"}],value:v?"yaml":"json",onChange:h})]}),(b||x==="classic"||E==="v2"&&x==="v1-resource")&&(0,n.jsxs)(s.B,{gap:1,alignItems:"start",children:[(0,n.jsx)(i.J,{children:C}),(0,n.jsx)(u.d,{label:C,value:c,onChange:y})]})]}),D&&(0,n.jsx)(o.F,{title:(0,a.t)("dashboard-scene.save-dashboard-form.schema-v2-library-panels-export-title","Dashboard Schema V2 does not support exporting library panels to be used in another instance yet"),severity:"warning",children:(0,n.jsxs)(a.x6,{i18nKey:"dashboard-scene.save-dashboard-form.schema-v2-library-panels-export",children:["The dynamic dashboard functionality is experimental, and has not full feature parity with current dashboards behaviour. It is based on a new schema format, that does not support library panels. This means that when exporting the dashboard to use it in another instance, we will not include library panels. We intend to support them as we progress in the feature"," ",(0,n.jsx)(l.Y,{external:!0,href:"https://grafana.com/docs/release-life-cycle/",children:"life cycle"}),"."]})})]})}},16001:(te,R,e)=>{"use strict";e.d(R,{Ay:()=>h});var n=e(74848),a=e(96540),s=e(51898),i=e(92745),r=e(36490),u=e(43173),o=e(87063),l=e(73427),g=e(11257),f=e(24313),p=e(58662),c=e(23289);const x=s.Tp.pages.Dashboard.DashNav.newShareButton.menu;let v=[];function m(d){v.push(d)}function y(){v=[]}function h({dashboard:d,panel:E}){const b=P=>{r.Ny.partial({shareView:P})},D=(0,a.useCallback)(()=>{const P=[];return P.push({shareId:p.wr.link,testId:x.shareInternally,icon:"building",label:(0,i.t)("share-dashboard.menu.share-internally-title","Share internally"),renderCondition:!0,onClick:()=>b(p.wr.link)}),P.push({shareId:p.wr.publicDashboard,testId:x.shareExternally,icon:"share-alt",label:(0,i.t)("share-dashboard.menu.share-externally-title","Share externally"),renderCondition:!E&&(0,f.iR)(),onClick:()=>{b(p.wr.publicDashboard)}}),P.push({shareId:p.wr.snapshot,testId:x.shareSnapshot,icon:"camera",label:(0,i.t)("share-dashboard.menu.share-snapshot-title","Share snapshot"),renderCondition:l.TP.isSignedIn&&u.$.snapshotEnabled&&l.TP.hasPermission(g.w.SnapshotsCreate),onClick:()=>{b(p.wr.snapshot)}}),v.forEach(M=>P.push(M)),P.filter(M=>M.renderCondition)},[E]),C=P=>{c.c.sharingCategoryClicked({item:P.shareId,shareResource:(0,p.hD)(E?.getRef())}),P.onClick(d)};return(0,n.jsx)(o.W,{"data-testid":x.container,children:D().map(P=>(0,n.jsxs)(a.Fragment,{children:[P.renderDividerAbove&&(0,n.jsx)(o.W.Divider,{}),(0,n.jsx)(o.W.Item,{testId:P.testId,label:P.label,icon:P.icon,description:P.description,component:P.component,className:P.className,onClick:()=>C(P)})]},P.shareId))})}},12434:(te,R,e)=>{"use strict";e.d(R,{F7:()=>g,Xe:()=>u,yk:()=>l});var n=e(71673),a=e(58662),s=e(29043),i=e(23289);const r={useAbsoluteTimeRange:!0,useShortUrl:!0,theme:"current"},u=async(f,p)=>{const{useAbsoluteTimeRange:c,useShortUrl:x,theme:v}=l();return i.c.shareLinkCopied({currentTimeRange:c,theme:v,shortenURL:x,shareResource:(0,a.hD)(p?.getRef())}),await(0,n.Sp)(f,{useAbsoluteTimeRange:c,theme:v,useShortUrl:x})},o="grafana.dashboard.link.shareConfiguration";function l(){return s.A.exists(o)&&s.A.getObject(o)||r}function g(f){s.A.setObject(o,f)}},90091:(te,R,e)=>{"use strict";e.d(R,{j:()=>bn});var n=e(74848),a=e(36490),s=e(36674),i=e(8207),r=e(58662),u=e(8285),o=e(22803),l=e(20382),g=e(16817),f=e(70713),p=e(51898),c=e(92745),x=e(43173),v=e(63142),m=e(41654),y=e(21285),h=e(72636),d=e(50992),E=e(68079),b=e(45861),D=e(47931),C=e(6890),P=e(64762),M=e(8535),O=e(23289),j=e(56445),U=e(84330);const W=p.Tp.pages.ExportDashboardDrawer.ExportAsJson;class B extends j.N{static{this.Component=S}getTabLabel(){return(0,c.t)("export.json.title","Export dashboard")}}function S({model:It}){const yt=(0,v.of)(_),{isSharingExternally:Vt,isViewingYAML:fn,exportMode:Dn}=It.useState(),Wn=(0,g.A)(async()=>await It.getExportableDashboardJson(),[Vt,Dn]),Fn=JSON.stringify(Wn.value?.json,null,2),la=l.Ay.dump(Wn.value?.json,{skipInvalid:!0}),Kn=fn?la:Fn,aa=async()=>{await It.onSaveAsFile();const Zn=(0,c.t)("export.json.download-successful_toast_message","Your JSON has been downloaded");(0,M.JD)((0,C.dx)((0,P.tZ)(Zn)))},Ia=(0,c.t)("export.json.export-externally-label","Export the dashboard to use in another instance");return(0,n.jsxs)("div",{"data-testid":W.container,className:yt.container,children:[(0,n.jsx)("p",{children:(0,n.jsx)(c.x6,{i18nKey:"export.json.info-text",children:"Copy or download a file containing the definition of your dashboard"})}),x.$.featureToggles.kubernetesDashboards?(0,n.jsx)(U.j,{dashboardJson:Wn,isSharingExternally:Vt??!1,exportMode:Dn??U.i.Classic,isViewingYAML:fn??!1,onExportModeChange:It.onExportModeChange,onShareExternallyChange:It.onShareExternallyChange,onViewYAML:It.onViewYAML}):(0,n.jsxs)(m.B,{gap:1,alignItems:"start",children:[(0,n.jsx)(y.d,{label:Ia,"data-testid":W.exportExternallyToggle,id:"export-externally-toggle",value:!!Vt,onChange:It.onShareExternallyChange}),(0,n.jsx)(h.J,{children:Ia})]}),(0,n.jsx)("div",{className:yt.codeEditorBox,children:(0,n.jsx)(f.Ay,{"data-testid":W.codeEditor,children:({width:Zn,height:ma})=>Kn?(0,n.jsx)(d.B,{value:Kn,language:fn?"yaml":"json",showLineNumbers:!0,showMiniMap:!1,height:ma,width:Zn,readOnly:!0}):Wn.loading&&(0,n.jsx)(E.y,{})})}),(0,n.jsx)("div",{className:yt.buttonsContainer,children:(0,n.jsxs)(m.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,n.jsx)(b.$n,{"data-testid":W.saveToFileButton,variant:"primary",icon:"download-alt",onClick:aa,children:(0,n.jsx)(c.x6,{i18nKey:"export.json.download-button",children:"Download file"})}),(0,n.jsx)(D.b,{"data-testid":W.copyToClipboardButton,variant:"secondary",icon:"copy",disabled:Wn.loading,getText:()=>Kn??"",onClipboardCopy:()=>{O.c.exportCopyJsonClicked()},children:(0,n.jsx)(c.x6,{i18nKey:"export.json.copy-button",children:"Copy to clipboard"})}),(0,n.jsx)(b.$n,{"data-testid":W.cancelButton,variant:"secondary",onClick:It.useState().onDismiss,fill:"outline",children:(0,n.jsx)(c.x6,{i18nKey:"export.json.cancel-button",children:"Cancel"})})]})})]})}function _(It){return{container:(0,o.css)({height:"100%"}),codeEditorBox:(0,o.css)({margin:`${It.spacing(2,0)}`,height:"75%"}),buttonsContainer:(0,o.css)({paddingBottom:It.spacing(2)})}}var K=e(96540),T=e(3271),L=e(73427),A=e(62905),N=e(82298),V=e(24313),z=e(11257),w=e(76319),H=e(66404),Q=e(70735);function Z({onConfirm:It,onDismiss:yt,description:Vt,confirmButtonLabel:fn,title:Dn,isActionLoading:Wn}){const Fn=(0,v.of)(Y),la=()=>(0,n.jsx)("div",{className:Fn.bodyContainer,children:(0,n.jsxs)(m.B,{justifyContent:"space-between",children:[(0,n.jsxs)(m.B,{gap:1,alignItems:"center",children:[(0,n.jsx)(w.K,{size:"xl",name:"angle-left","aria-label":(0,c.t)("share-drawer.confirm-action.back-arrow-button","Back button"),onClick:yt}),(0,n.jsx)(H.E,{variant:"h4",children:Dn})]}),Wn&&(0,n.jsx)(E.y,{})]})});return(0,n.jsx)(Q.k,{body:(0,n.jsx)(la,{}),description:Vt,confirmButtonLabel:fn,confirmButtonVariant:"destructive",dismissButtonLabel:(0,c.t)("share-drawer.confirm-action.cancel-button","Cancel"),dismissButtonVariant:"secondary",justifyButtons:"flex-start",onConfirm:It,onDismiss:yt})}const Y=It=>({bodyContainer:(0,o.css)({marginBottom:It.spacing(2)})}),X=(0,K.createContext)(void 0),I=()=>{const It=(0,K.useContext)(X);if(It===void 0)throw new Error("useShareDrawerContext must be used within a DrawerContext");return It};var J=e(49785),ee=e(16780),q=e(37386),ne=e(45967),se=e(30703),oe=e(63527),de=e(83692);const fe=p.Tp.pages.ShareDashboardDrawer.ShareExternally.Configuration;function ae(){const It=(0,v.of)(ce),{dashboard:yt}=I(),[Vt,{isLoading:fn}]=(0,A.T2)(),{data:Dn}=A.Sm.endpoints?.getPublicDashboard.useQueryState(yt.state.uid),Wn=L.TP.hasPermission(z.w.DashboardsPublicWrite),Fn=fn||!Wn,Kn=s.jh.getTimeRange(yt).useState(),{handleSubmit:aa,setValue:Ia,control:Zn}=(0,J.mN)({defaultValues:{isAnnotationsEnabled:Dn?.annotationsEnabled,isTimeSelectionEnabled:Dn?.timeSelectionEnabled}}),ma=async(ta,Ya)=>{Ia(ta,Ya),await aa(_n=>ka({..._n,[ta]:Ya}))()},ka=ta=>{const{isAnnotationsEnabled:Ya,isTimeSelectionEnabled:_n}=ta;Vt({dashboard:yt,payload:{...Dn,annotationsEnabled:Ya,timeSelectionEnabled:_n}})};return(0,n.jsxs)(m.B,{direction:"column",gap:2,children:[(0,n.jsx)(H.E,{element:"p",children:(0,n.jsx)(c.x6,{i18nKey:"public-dashboard.configuration.settings-label",children:"Settings"})}),(0,n.jsxs)(m.B,{justifyContent:"space-between",children:[(0,n.jsx)("form",{onSubmit:aa(ka),children:(0,n.jsx)(ee.n,{disabled:Fn,children:(0,n.jsxs)(m.B,{direction:"column",gap:2,children:[(0,n.jsxs)(m.B,{gap:1,children:[(0,n.jsx)(J.xI,{render:({field:{ref:ta,...Ya}})=>(0,n.jsx)(y.d,{...Ya,"data-testid":fe.enableTimeRangeSwitch,onChange:_n=>{O.c.publicDashboardTimeSelectionChanged({enabled:_n.currentTarget.checked}),ma("isTimeSelectionEnabled",_n.currentTarget.checked)},label:(0,c.t)("public-dashboard.configuration.enable-time-range-label","Enable time range")}),control:Zn,name:"isTimeSelectionEnabled"}),(0,n.jsx)(h.J,{description:(0,c.t)("public-dashboard.configuration.enable-time-range-description","Allow people to change time range"),children:(0,n.jsx)(c.x6,{i18nKey:"public-dashboard.configuration.enable-time-range-label",children:"Enable time range"})})]}),(0,n.jsxs)(m.B,{gap:1,children:[(0,n.jsx)(J.xI,{render:({field:{ref:ta,...Ya}})=>(0,n.jsx)(y.d,{...Ya,"data-testid":fe.enableAnnotationsSwitch,onChange:_n=>{O.c.publicDashboardAnnotationsSelectionChanged({enabled:_n.currentTarget.checked}),ma("isAnnotationsEnabled",_n.currentTarget.checked)},label:(0,c.t)("public-dashboard.configuration.display-annotations-label","Display annotations")}),control:Zn,name:"isAnnotationsEnabled"}),(0,n.jsx)(h.J,{style:{flex:1},description:(0,c.t)("public-dashboard.configuration.display-annotations-description","Present annotations on this dashboard"),children:(0,n.jsx)(c.x6,{i18nKey:"public-dashboard.configuration.display-annotations-label",children:"Display annotations"})})]}),(0,n.jsxs)(m.B,{gap:1,alignItems:"flex-start",children:[(0,n.jsx)("div",{className:It.timeRange,children:(0,n.jsx)(c.x6,{i18nKey:"public-dashboard.configuration.time-range-label",children:"Time range"})}),(0,n.jsx)("div",{className:(0,o.cx)(It.timeRange,It.timeRangeValue),children:(0,n.jsx)(de.f,{value:Kn.value})}),(0,n.jsx)(ne.m,{placement:"right",content:(0,c.t)("public-dashboard.configuration.time-range-tooltip","The shared dashboard uses the default time range settings of the dashboard"),children:(0,n.jsx)(se.I,{name:"info-circle",size:"md"})})]})]})})}),fn&&(0,n.jsx)(E.y,{})]})]})}const ce=It=>({timeRange:(0,o.css)({fontSize:It.typography.bodySmall.fontSize,fontWeight:It.typography.bodySmall.fontWeight}),timeRangeValue:(0,o.css)({color:It.colors.text.secondary})});var ie=e(87063),ve=e(88559);const le=p.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,Ee=({onDelete:It,onReshare:yt})=>(0,n.jsxs)(ie.W,{children:[(0,n.jsx)(ie.W.Item,{label:(0,c.t)("public-dashboard.email-sharing.resend-invite-label","Resend invite"),onClick:yt}),(0,n.jsx)(ie.W.Item,{label:(0,c.t)("public-dashboard.email-sharing.revoke-access-label","Revoke access"),destructive:!0,onClick:It})]}),Re=({recipients:It,dashboardUid:yt,publicDashboard:Vt})=>{const fn=(0,v.of)(Se),[Dn,{isLoading:Wn}]=(0,A.$L)(),[Fn,{isLoading:la}]=(0,A.NA)(),Kn=Wn||la,aa=(Zn,ma)=>{O.c.revokePublicDashboardEmailClicked(),Dn({recipientUid:Zn,recipientEmail:ma,dashboardUid:yt,uid:Vt.uid})},Ia=Zn=>{O.c.resendPublicDashboardEmailClicked(),Fn({recipientUid:Zn,uid:Vt.uid})};return(0,n.jsx)("table",{"data-testid":le.EmailSharingList,className:fn.table,children:(0,n.jsx)("tbody",{children:It.map((Zn,ma)=>(0,n.jsxs)("tr",{className:fn.listItem,children:[(0,n.jsx)("td",{className:fn.user,children:(0,n.jsxs)(m.B,{direction:"row",gap:1,alignItems:"center",children:[(0,n.jsx)("div",{className:fn.icon,children:(0,n.jsx)(se.I,{name:"user"})}),(0,n.jsx)(H.E,{children:Zn.recipient})]})}),(0,n.jsx)("td",{children:Kn&&(0,n.jsx)(E.y,{})}),(0,n.jsx)("td",{children:(0,n.jsx)(ve.m,{overlay:(0,n.jsx)(Ee,{onDelete:()=>aa(Zn.uid,Zn.recipient),onReshare:()=>Ia(Zn.uid)}),children:(0,n.jsx)(w.K,{name:"ellipsis-v","aria-label":(0,c.t)("dashboard-scene.email-list.aria-label-emailmenu","Toggle email menu"),variant:"secondary",size:"lg"})})})]},Zn.uid))})})},Oe=({dashboard:It})=>{const yt=(0,v.of)(Se),{data:Vt}=A.Sm.endpoints?.getPublicDashboard.useQueryState(It.state.uid);return(0,n.jsx)(q.D,{label:(0,c.t)("public-dashboard.email-sharing.recipient-list-title","People with access"),description:(0,c.t)("public-dashboard.email-sharing.recipient-list-description","Only people you've directly invited can access this dashboard"),className:yt.listField,children:Vt?.recipients?.length?(0,n.jsx)("div",{className:yt.listContainer,children:(0,n.jsx)(Re,{recipients:Vt.recipients,dashboardUid:It.state.uid,publicDashboard:Vt})}):(0,n.jsx)(n.Fragment,{})})},Se=It=>({listField:(0,o.css)({marginBottom:0}),listContainer:(0,o.css)({maxHeight:"140px",overflowY:"auto"}),table:(0,o.css)({width:"100%"}),listItem:(0,o.css)({display:"flex",alignItems:"center",gap:It.spacing(.5),padding:It.spacing(.75,1),color:It.colors.text.secondary}),user:(0,o.css)({flex:1}),icon:(0,o.css)({border:`${It.spacing(.25)} solid ${It.colors.text.secondary}`,padding:It.spacing(.125,.5),borderRadius:It.shape.radius.circle,color:It.colors.text.secondary})}),Te=p.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,_e=()=>{const{dashboard:It}=I(),{data:yt,isError:Vt}=A.Sm.endpoints?.getPublicDashboard.useQueryState(It.state.uid),[fn,{isLoading:Dn}]=(0,A.NY)(),Wn=L.TP.hasPermission(z.w.DashboardsPublicWrite),{register:Fn,handleSubmit:la,formState:{errors:Kn,isValid:aa},reset:Ia}=(0,J.mN)({defaultValues:{email:""},mode:"onSubmit"}),Zn=async ma=>{O.c.publicDashboardEmailInviteClicked(),await fn({recipient:ma.email,uid:yt.uid,dashboardUid:It.state.uid}).unwrap(),Ia({email:""})};return(0,n.jsxs)("div",{children:[(0,n.jsx)("form",{onSubmit:la(Zn),children:(0,n.jsx)(ee.n,{disabled:!Wn||Vt,children:(0,n.jsx)(q.D,{label:(0,n.jsxs)(m.B,{gap:1,alignItems:"center",children:[(0,n.jsx)(c.x6,{i18nKey:"public-dashboard.email-sharing.recipient-invitation-button",children:"Invite"}),(0,n.jsx)(ne.m,{placement:"right",content:(0,c.t)("public-dashboard.email-sharing.recipient-invitation-tooltip","This dashboard contains sensitive data. By using this feature you will be sharing with external people."),children:(0,n.jsx)(se.I,{name:"info-circle",size:"sm"})})]}),description:(0,c.t)("public-dashboard.email-sharing.recipient-invitation-description","Invite someone by email"),error:Kn.email?.message,invalid:!!Kn.email?.message,children:(0,n.jsxs)(m.B,{direction:"row",children:[(0,n.jsx)(oe.p,{placeholder:(0,c.t)("public-dashboard.email-sharing.recipient-email-placeholder","Email"),autoCapitalize:"none",loading:Dn,...Fn("email",{required:(0,c.t)("public-dashboard.email-sharing.recipient-required-email-text","Email is required"),pattern:{value:V._l,message:(0,c.t)("public-dashboard.email-sharing.recipient-invalid-email-text","Invalid email")}}),"data-testid":Te.EmailSharingInput}),(0,n.jsx)(b.$n,{type:"submit",variant:"primary",disabled:Dn||!aa,"data-testid":Te.EmailSharingInviteButton,children:(0,n.jsx)(c.x6,{i18nKey:"public-dashboard.email-sharing.recipient-invitation-button",children:"Invite"})})]})})})}),(0,n.jsx)(Oe,{dashboard:It}),(0,n.jsx)(T.c,{}),(0,n.jsx)(ae,{})]})};var He=e(32635),tt=e(34999);const Je="https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/shared-dashboards/#share-externally-with-specific-people",Ge=p.Tp.pages.ShareDashboardDrawer.ShareExternally;function je(){return(0,n.jsx)(tt.F,{title:"",severity:"info",bottomSpacing:0,"data-testid":Ge.emailSharingAlert,children:(0,n.jsxs)(m.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,n.jsx)(c.x6,{i18nKey:"public-dashboard.email-sharing.alert-text",children:"Sharing dashboards by email is billed per user for the duration of the 30-day token, regardless of how many dashboards are shared. Billing stops after 30 days unless you renew the token."}),(0,n.jsx)(b.$n,{variant:"secondary",onClick:()=>window.open(Je,"_blank"),type:"button",children:(0,n.jsx)(c.x6,{i18nKey:"public-dashboard.email-sharing.learn-more-button",children:"Learn more"})})]})})}const Fe=p.Tp.pages.ShareDashboardDrawer.ShareExternally.Creation,Be=({hasError:It})=>{const{dashboard:yt,onDismiss:Vt}=I(),fn=(0,v.of)(Ke),[Dn,{isLoading:Wn,isError:Fn}]=(0,A.U9)(),la=L.TP.hasPermission(z.w.DashboardsPublicWrite),Kn=!la||Wn||Fn||It,{handleSubmit:aa,register:Ia,formState:{isValid:Zn}}=(0,J.mN)({mode:"onChange"}),ma=()=>{O.c.generatePublicDashboardUrlClicked({share:V.Xo.EMAIL}),Dn({dashboard:yt,payload:{share:V.Xo.EMAIL,isEnabled:!0}})};return(0,n.jsxs)(n.Fragment,{children:[la&&(0,n.jsx)(je,{}),(0,n.jsx)("form",{onSubmit:aa(ma),children:(0,n.jsxs)(ee.n,{disabled:Kn,children:[(0,n.jsx)("div",{className:fn.checkbox,children:(0,n.jsx)(He.S,{...Ia("billAcknowledgment",{required:!0}),label:(0,c.t)("public-dashboard.email-sharing.bill-ack","I understand that adding users requires payment.*")})}),(0,n.jsxs)(m.B,{direction:"row",gap:1,alignItems:"center",children:[(0,n.jsx)(b.$n,{type:"submit",disabled:!Zn,"data-testid":Fe.EmailShare.createButton,children:(0,n.jsx)(c.x6,{i18nKey:"public-dashboard.email-sharing.accept-button",children:"Accept"})}),(0,n.jsx)(b.$n,{variant:"secondary",onClick:Vt,"data-testid":Fe.EmailShare.cancelButton,children:(0,n.jsx)(c.x6,{i18nKey:"public-dashboard.email-sharing.cancel-button",children:"Cancel"})}),Wn&&(0,n.jsx)(E.y,{})]})]})})]})},Ke=It=>({checkbox:(0,o.css)({marginBottom:It.spacing(2)})}),Ue=()=>{const{dashboard:It}=I(),{data:yt,isError:Vt}=A.Sm.endpoints?.getPublicDashboard.useQueryState(It.state.uid);return(0,n.jsx)(n.Fragment,{children:yt?(0,n.jsx)(_e,{}):(0,n.jsx)(Be,{hasError:Vt})})},we="https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/shared-dashboards",Xe=p.Tp.pages.ShareDashboardDrawer.ShareExternally,nt=()=>(0,n.jsx)(tt.F,{title:"",severity:"info",bottomSpacing:0,"data-testid":Xe.publicAlert,children:(0,n.jsxs)(m.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,n.jsx)(c.x6,{i18nKey:"public-dashboard.public-sharing.alert-text",children:"Sharing this dashboard externally makes it entirely accessible to anyone with the link."}),(0,n.jsx)(b.$n,{variant:"secondary",onClick:()=>window.open(we,"_blank"),type:"button",children:(0,n.jsx)(c.x6,{i18nKey:"public-dashboard.public-sharing.learn-more-button",children:"Learn more"})})]})}),he=p.Tp.pages.ShareDashboardDrawer.ShareExternally.Creation;function xe({hasError:It}){const{dashboard:yt,onDismiss:Vt}=I(),fn=(0,v.of)(me),Dn=L.TP.hasPermission(z.w.DashboardsPublicWrite),{handleSubmit:Wn,register:Fn,formState:{isValid:la}}=(0,J.mN)({mode:"onChange"}),[Kn,{isLoading:aa,isError:Ia}]=(0,A.U9)(),Zn=()=>{O.c.generatePublicDashboardUrlClicked({share:V.Xo.PUBLIC}),Kn({dashboard:yt,payload:{share:V.Xo.PUBLIC,isEnabled:!0}})},ma=!Dn||aa||Ia||It;return(0,n.jsxs)(n.Fragment,{children:[Dn&&(0,n.jsx)(nt,{}),(0,n.jsx)("form",{onSubmit:Wn(Zn),children:(0,n.jsxs)(ee.n,{disabled:ma,children:[(0,n.jsx)("div",{className:fn.checkbox,children:(0,n.jsx)(He.S,{...Fn("publicAcknowledgment",{required:!0}),label:(0,c.t)("public-dashboard.public-sharing.public-ack","I understand that this entire dashboard will be public.*"),"data-testid":he.willBePublicCheckbox})}),(0,n.jsxs)(m.B,{direction:"row",gap:1,alignItems:"center",children:[(0,n.jsx)(b.$n,{type:"submit",disabled:!la,"data-testid":he.PublicShare.createButton,children:(0,n.jsx)(c.x6,{i18nKey:"public-dashboard.public-sharing.accept-button",children:"Accept"})}),(0,n.jsx)(b.$n,{variant:"secondary",onClick:Vt,"data-testid":he.PublicShare.cancelButton,children:(0,n.jsx)(c.x6,{i18nKey:"public-dashboard.public-sharing.cancel-button",children:"Cancel"})}),aa&&(0,n.jsx)(E.y,{})]})]})})]})}const me=It=>({checkbox:(0,o.css)({marginBottom:It.spacing(2)})});function ye(){const{dashboard:It}=I(),{data:yt,isError:Vt}=A.Sm.endpoints?.getPublicDashboard.useQueryState(It.state.uid);return(0,n.jsx)(n.Fragment,{children:yt?(0,n.jsx)(ae,{}):(0,n.jsx)(xe,{hasError:Vt})})}var De=e(37672),Le=e(44173),Ve=e(35195),ze=e(71748);function Ze({publicDashboard:It}){const{dashboard:yt}=I(),Vt=L.TP.hasPermission(z.w.DashboardsPublicWrite),fn=(0,ze.b)(yt),Dn=(yt.state.$variables?.state.variables.length??0)>0;return(0,n.jsxs)(n.Fragment,{children:[Vt&&Dn&&(0,n.jsx)(Le.D,{showDescription:!1}),!Vt&&(0,n.jsx)(Ve.t,{mode:It?"edit":"create"}),Vt&&!!fn?.length&&(0,n.jsx)(De.s,{unsupportedDataSources:fn.join(", ")}),It?.share===V.Xo.EMAIL&&(0,V.AY)()&&(0,n.jsx)(je,{}),It?.share===V.Xo.PUBLIC&&(0,n.jsx)(nt,{})]})}var Me=e(30360),$e=e(18857);const at=()=>({label:(0,c.t)("public-dashboard.share-externally.public-share-type-option-label","Anyone with the link"),description:(0,c.t)("public-dashboard.share-externally.public-share-type-option-description","Anyone with the link can access dashboard"),value:V.Xo.PUBLIC,icon:"globe"}),ct=()=>({label:(0,c.t)("public-dashboard.share-externally.email-share-type-option-label","Only specific people"),description:(0,c.t)("public-dashboard.share-externally.email-share-type-option-description","Only people with the link can access dashboard"),value:V.Xo.EMAIL,icon:"users-alt"}),ft=p.Tp.pages.ShareDashboardDrawer.ShareExternally;function Et({setShareType:It,options:yt,value:Vt}){const{dashboard:fn}=I(),Dn=(0,v.of)(St),{data:Wn}=A.Sm.endpoints?.getPublicDashboard.useQueryState(fn.state.uid),[Fn,{isLoading:la}]=(0,A.ft)(),Kn=L.TP.hasPermission(z.w.DashboardsPublicWrite),aa=at(),Ia=Zn=>{if(!Wn)return;O.c.publicDashboardShareTypeChange({shareType:Zn===V.Xo.EMAIL?"email":"public"});const ma={dashboard:fn,payload:{...Wn,share:Zn}};Fn(ma)};return(0,n.jsxs)("div",{children:[(0,n.jsxs)(m.B,{justifyContent:"space-between",children:[(0,n.jsx)(h.J,{description:Vt.description,children:(0,n.jsx)(c.x6,{i18nKey:"public-dashboard.share-configuration.share-type-label",children:"Link access"})}),la&&(0,n.jsx)(E.y,{})]}),(0,V.AY)()?(0,n.jsx)($e.l6,{"data-testid":ft.shareTypeSelect,options:yt,value:Vt,disabled:!Kn,onChange:Zn=>{It(Zn),Ia(Zn.value)},className:Dn.select}):(0,n.jsxs)(m.B,{gap:1,alignItems:"center",children:[(0,Me.Uo)(aa.icon)&&(0,n.jsx)(se.I,{name:(0,Me.Uo)(aa.icon)}),(0,n.jsx)(H.E,{children:aa.label})]})]})}const St=()=>({select:(0,o.css)({flex:1})}),Pt=p.Tp.pages.ShareDashboardDrawer.ShareExternally,Dt=()=>(0,V.AY)()?[ct(),at()]:[at()];class Ye extends s.Bs{static{this.Component=mt}getTabLabel(){return(0,c.t)("share-dashboard.menu.share-externally-title","Share externally")}}function mt({model:It}){const[yt,Vt]=(0,K.useState)(!1),fn=(0,v.of)(Xt),Dn=(0,u.YQ)(It),{data:Wn,isLoading:Fn}=(0,A.Bs)(Dn.state.uid),[la,{isLoading:Kn}]=(0,A.bN)(),aa=()=>{Vt(!0)},Ia=async()=>{O.c.revokePublicDashboardClicked(),await la({dashboard:Dn,uid:Wn.uid,dashboardUid:Dn.state.uid}).unwrap(),Vt(!1)};return Fn?(0,n.jsx)(N.a,{}):yt?(0,n.jsx)(Z,{title:(0,c.t)("public-dashboard.share-externally.revoke-access-button","Revoke access"),confirmButtonLabel:(0,c.t)("public-dashboard.share-externally.revoke-access-button","Revoke access"),onConfirm:Ia,onDismiss:()=>Vt(!1),description:(0,c.t)("public-dashboard.share-externally.revoke-access-description","Are you sure you want to revoke this access? The dashboard can no longer be shared."),isActionLoading:Kn}):(0,n.jsx)("div",{className:fn.container,children:(0,n.jsx)(zt,{publicDashboard:Wn,onRevokeClick:aa})})}function zt({publicDashboard:It,onRevokeClick:yt}){const Vt=Dt(),fn=(0,K.useMemo)(()=>It&&(0,V.AY)()?Vt.find(Kn=>Kn.value===It?.share)??Vt[0]:Vt[0],[It,Vt]),[Dn,Wn]=(0,K.useState)(fn),Fn=(0,K.useMemo)(()=>Dn.value===V.Xo.EMAIL&&(0,V.AY)()?(0,n.jsx)(Ue,{}):(0,n.jsx)(ye,{}),[Dn]);return(0,n.jsxs)(m.B,{direction:"column",gap:2,"data-testid":Pt.container,children:[(0,n.jsx)(Ze,{publicDashboard:It}),(0,n.jsx)(Et,{setShareType:Wn,value:Dn,options:Vt}),Fn,It&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(T.c,{spacing:0}),(0,n.jsx)(Jt,{publicDashboard:It,onRevokeClick:yt})]})]})}function Jt({publicDashboard:It,onRevokeClick:yt}){const{dashboard:Vt}=I(),[fn,{isLoading:Dn}]=(0,A.eq)(),Wn=(0,v.of)(Xt),Fn=L.TP.hasPermission(z.w.DashboardsPublicWrite);function la(){O.c.publicDashboardUrlCopied()}const Kn=async()=>{O.c.publicDashboardPauseSharingClicked({paused:!It.isEnabled}),fn({dashboard:Vt,payload:{...It,isEnabled:!It.isEnabled}})};return(0,n.jsxs)(m.B,{alignItems:"center",direction:{xs:"column",sm:"row"},children:[(0,n.jsx)("div",{className:Wn.actionsContainer,children:(0,n.jsxs)(m.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,n.jsx)(D.b,{"data-testid":Pt.Configuration.copyUrlButton,variant:"primary",fill:"outline",icon:"link",getText:()=>(0,V.mL)(It.accessToken),onClipboardCopy:la,children:(0,n.jsx)(c.x6,{i18nKey:"public-dashboard.share-externally.copy-link-button",children:"Copy external link"})}),(0,n.jsx)(b.$n,{icon:"trash-alt",variant:"destructive",fill:"outline",disabled:Dn||!Fn,onClick:yt,"data-testid":Pt.Configuration.revokeAccessButton,children:(0,n.jsx)(c.x6,{i18nKey:"public-dashboard.share-externally.revoke-access-button",children:"Revoke access"})}),(0,n.jsx)(b.$n,{icon:It.isEnabled?"pause":"play",variant:"secondary",fill:"outline",tooltip:It.isEnabled?(0,c.t)("public-dashboard.share-externally.pause-access-tooltip","Pausing will temporarily disable access to this dashboard for all users"):"",onClick:Kn,disabled:Dn||!Fn,"data-testid":Pt.Configuration.toggleAccessButton,children:It.isEnabled?(0,n.jsx)(c.x6,{i18nKey:"public-dashboard.share-externally.pause-access-button",children:"Pause access"}):(0,n.jsx)(c.x6,{i18nKey:"public-dashboard.share-externally.resume-access-button",children:"Resume access"})})]})}),Dn&&(0,n.jsx)(E.y,{})]})}const Xt=It=>({container:(0,o.css)({paddingBottom:It.spacing(2)}),actionsContainer:(0,o.css)({width:"100%"})});var En=e(29216);const ln=p.Tp.pages.ShareDashboardDrawer.ShareInternally;function cn({useLockedTime:It,onToggleLockedTime:yt,useShortUrl:Vt,onUrlShorten:fn,onChangeTheme:Dn,selectedTheme:Wn,isLoading:Fn}){return(0,n.jsxs)(m.B,{justifyContent:"space-between",children:[(0,n.jsxs)(m.B,{gap:2,direction:"column",children:[(0,n.jsxs)(m.B,{gap:1,direction:"column",children:[(0,n.jsxs)(m.B,{gap:1,alignItems:"start",children:[(0,n.jsx)(y.d,{label:(0,c.t)("link.share.time-range-label","Lock time range"),id:"share-current-time-range",value:It,onChange:yt,"data-testid":ln.lockTimeRangeSwitch}),(0,n.jsx)(h.J,{description:(0,c.t)("link.share.time-range-description","Change the current relative time range to an absolute time range"),children:(0,n.jsx)(c.x6,{i18nKey:"link.share.time-range-label",children:"Lock time range"})})]}),(0,n.jsxs)(m.B,{gap:1,alignItems:"start",children:[(0,n.jsx)(y.d,{id:"share-short-url",value:Vt,label:(0,c.t)("link.share.short-url-label","Shorten link"),onChange:fn,"data-testid":ln.shortenUrlSwitch}),(0,n.jsx)(h.J,{children:(0,n.jsx)(c.x6,{i18nKey:"link.share.short-url-label",children:"Shorten link"})})]})]}),(0,n.jsx)(En.w,{selectedTheme:Wn,onChange:Dn})]}),Fn&&(0,n.jsx)(E.y,{})]})}var Pn=e(8655),wn=e(12434);const jn=p.Tp.pages.ShareDashboardDrawer.ShareInternally;class kn extends Pn.R{static{this.Component=gt}constructor(yt){const{useAbsoluteTimeRange:Vt,useShortUrl:fn,theme:Dn}=(0,wn.yk)();super({...yt,useLockedTime:Vt,useShortUrl:fn,selectedTheme:Dn}),this.onToggleLockedTime=this.onToggleLockedTime.bind(this),this.onUrlShorten=this.onUrlShorten.bind(this),this.onThemeChange=this.onThemeChange.bind(this)}getTabLabel(){return(0,c.t)("share-dashboard.menu.share-internally-title","Share internally")}async onToggleLockedTime(){const yt=!this.state.useLockedTime;(0,wn.F7)({useAbsoluteTimeRange:yt,useShortUrl:this.state.useShortUrl,theme:this.state.selectedTheme}),await super.onToggleLockedTime()}async onUrlShorten(){const yt=!this.state.useShortUrl;(0,wn.F7)({useShortUrl:yt,useAbsoluteTimeRange:this.state.useLockedTime,theme:this.state.selectedTheme}),await super.onUrlShorten()}async onThemeChange(yt){(0,wn.F7)({theme:yt,useShortUrl:this.state.useShortUrl,useAbsoluteTimeRange:this.state.useLockedTime}),await super.onThemeChange(yt)}}function gt({model:It}){const yt=(0,v.of)(Lt),{useLockedTime:Vt,useShortUrl:fn,selectedTheme:Dn,isBuildUrlLoading:Wn}=It.useState();return(0,n.jsxs)("div",{className:jn.container,children:[(0,n.jsx)(tt.F,{severity:"info",title:(0,c.t)("link.share.config-alert-title","Link settings"),children:(0,n.jsx)(c.x6,{i18nKey:"link.share.config-alert-description",children:"Updating your settings will modify the default copy link to include these changes. Please note that these settings are saved within your current browser scope."})}),(0,n.jsx)("div",{className:yt.configDescription,children:(0,n.jsx)(H.E,{variant:"body",children:(0,n.jsx)(c.x6,{i18nKey:"link.share.config-description",children:"Create a personalized, direct link to share your dashboard within your organization, with the following customization settings:"})})}),(0,n.jsx)(cn,{useLockedTime:Vt,onToggleLockedTime:It.onToggleLockedTime,useShortUrl:fn,onUrlShorten:It.onUrlShorten,selectedTheme:Dn,onChangeTheme:It.onThemeChange,isLoading:Wn}),(0,n.jsx)(T.c,{spacing:1}),(0,n.jsx)(m.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:(0,n.jsx)(D.b,{icon:"link",variant:"primary",fill:"outline",disabled:Wn,getText:It.getShareUrl,onClipboardCopy:It.onCopy,className:yt.copyButtonContainer,"data-testid":jn.copyUrlButton,children:(0,n.jsx)(c.x6,{i18nKey:"link.share.copy-link-button",children:"Copy link"})})})]})}const Lt=It=>({configDescription:(0,o.css)({marginBottom:It.spacing(2)}),copyButtonContainer:(0,o.css)({marginTop:It.spacing(2)})});var Rt=e(5805),Ut=e(89640),Gt=e(15130),Ft=e(51155),_t=e(77824);const tn="https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/#share-a-snapshot",xn="https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/#panel-snapshot";function mn({name:It,onNameChange:yt,onExpireChange:Vt,selectedExpireOption:fn,panelRef:Dn,disableInputs:Wn,children:Fn}){const la=(0,v.of)(An);return(0,n.jsxs)("div",{className:la.container,children:[(0,n.jsx)(tt.F,{severity:"info",title:"",children:(0,n.jsxs)(m.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,n.jsx)(H.E,{children:Dn?(0,n.jsx)(c.x6,{i18nKey:"snapshot.share-panel.info-alert",children:"A Grafana panel snapshot publicly shares a panel while removing sensitive data such as queries and panel links, leaving only visible metrics and series names. Anyone with the link can access the snapshot."}):(0,n.jsx)(c.x6,{i18nKey:"snapshot.share.info-alert",children:"A Grafana dashboard snapshot publicly shares a dashboard while removing sensitive data such as queries and panel links, leaving only visible metrics and series names. Anyone with the link can access the snapshot."})}),(0,n.jsx)(b.$n,{variant:"secondary",onClick:()=>window.open(Dn?xn:tn,"_blank"),type:"button",children:(0,n.jsx)(c.x6,{i18nKey:"snapshot.share.learn-more-button",children:"Learn more"})})]})}),(0,n.jsxs)("fieldset",{disabled:Wn,children:[(0,n.jsx)(q.D,{label:(0,c.t)("snapshot.share.name-label","Snapshot name"),children:(0,n.jsx)(oe.p,{id:"snapshot-name-input",value:It,onChange:Kn=>yt(Kn.currentTarget.value)})}),(0,n.jsx)(q.D,{label:(0,c.t)("snapshot.share.expiration-label","Expires in"),children:(0,n.jsx)(_t.z,{id:"expire-select-input",options:(0,Ft.u)(),value:fn?.value,onChange:Vt})})]}),(0,n.jsx)(T.c,{}),Fn]})}const An=It=>({container:(0,o.css)({paddingBottom:It.spacing(2)})}),ia=p.Tp.pages.ShareDashboardDrawer.ShareSnapshot;class ca extends Ft.l{static{this.Component=ea}getTabLabel(){return(0,c.t)("share-dashboard.menu.share-snapshot-title","Share snapshot")}}function ea({model:It}){const[yt,Vt]=(0,K.useState)(!1),[fn,Dn]=(0,K.useState)(!1),[Wn,Fn]=(0,K.useState)(1),{snapshotName:la,snapshotSharingOptions:Kn,selectedExpireOption:aa,panelRef:Ia,onDismiss:Zn,dashboardRef:ma}=It.useState(),[ka,ta]=(0,Rt.default)(async(rr=!1)=>{const Js=await It.onSnapshotCreate(rr);return Fn(2),Js}),[Ya,_n]=(0,Rt.default)(async rr=>{const Js=await It.onSnapshotDelete(rr);return Fn(1),Vt(!1),Dn(!0),Js}),Ns=()=>{Zn?.()},is=()=>{It.onSnasphotNameChange(ma.resolve().state.title),Fn(1)},Ys=async()=>{await _n(ka.value?.deleteUrl),is()};return yt?(0,n.jsx)(Z,{title:(0,c.t)("snapshot.share.delete-title","Delete snapshot"),confirmButtonLabel:(0,c.t)("snapshot.share.delete-button","Delete snapshot"),onConfirm:Ys,onDismiss:()=>Vt(!1),description:(0,c.t)("snapshot.share.delete-description","Are you sure you want to delete this snapshot?"),isActionLoading:Ya.loading}):(0,n.jsx)("div",{"data-testid":ia.container,children:(0,n.jsxs)(n.Fragment,{children:[Wn===1&&fn&&(0,n.jsx)(tt.F,{severity:"info",title:"",onRemove:()=>Dn(!1),children:(0,n.jsx)(c.x6,{i18nKey:"snapshot.share.deleted-alert",children:"Snapshot deleted. It could take an hour to be cleared from CDN caches."})}),(0,n.jsx)(mn,{name:la??"",selectedExpireOption:aa,onNameChange:It.onSnasphotNameChange,onExpireChange:It.onExpireChange,disableInputs:Wn===2,panelRef:Ia,children:(0,n.jsxs)(m.B,{justifyContent:"space-between",gap:{xs:2},direction:{xs:"column",xl:"row"},children:[Wn===1?(0,n.jsx)(Ca,{onCreateClick:ta,isLoading:ka.loading,onCancelClick:Ns,sharingOptions:Kn}):Wn===2&&ka.value&&(0,n.jsx)(oa,{url:ka.value.url,onDeleteClick:()=>Vt(!0),onNewSnapshotClick:is}),(0,n.jsx)(Ut.Y,{icon:"external-link-alt",href:"/dashboard/snapshots",external:!0,children:(0,c.t)("snapshot.share.view-all-button","View all snapshots")})]})})]})})}const Ca=({isLoading:It,onCreateClick:yt,onCancelClick:Vt,sharingOptions:fn})=>(0,n.jsxs)(m.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,n.jsx)(b.$n,{variant:"primary",disabled:It,onClick:()=>yt(),"data-testid":ia.publishSnapshot,children:(0,n.jsx)(c.x6,{i18nKey:"snapshot.share.local-button",children:"Publish snapshot"})}),fn?.externalEnabled&&(0,n.jsx)(b.$n,{variant:"secondary",disabled:It,onClick:()=>yt(!0),children:fn?.externalSnapshotName}),(0,n.jsx)(b.$n,{variant:"secondary",fill:"outline",onClick:Vt,children:(0,n.jsx)(c.x6,{i18nKey:"snapshot.share.cancel-button",children:"Cancel"})}),It&&(0,n.jsx)(E.y,{})]}),oa=({url:It,onDeleteClick:yt,onNewSnapshotClick:Vt})=>{const fn=Gt.TP.hasPermission(z.w.SnapshotsDelete),Dn=fn?"":(0,c.t)("snapshot.share.delete-permission-tooltip","You don't have permission to delete snapshots");return(0,n.jsxs)(m.B,{justifyContent:"flex-start",gap:1,direction:{xs:"column",sm:"row"},children:[(0,n.jsx)(D.b,{icon:"link",variant:"primary",fill:"outline",getText:()=>It,"data-testid":ia.copyUrlButton,children:(0,n.jsx)(c.x6,{i18nKey:"snapshot.share.copy-link-button",children:"Copy link"})}),(0,n.jsx)(b.$n,{icon:"trash-alt",variant:"destructive",fill:"outline",onClick:yt,disabled:!fn,tooltip:Dn,children:(0,n.jsx)(c.x6,{i18nKey:"snapshot.share.delete-button",children:"Delete snapshot"})}),(0,n.jsx)(b.$n,{variant:"secondary",fill:"solid",onClick:Vt,children:(0,n.jsx)(c.x6,{i18nKey:"snapshot.share.new-snapshot-button",children:"New snapshot"})})]})};var Jn=e(89752),Da=e(42656),Fa=e(4213),Xn=e.n(Fa),ps=e(41053),Aa=e(75505),xt=e(68143),dt=e(47327);const bt=p.Tp.pages.ShareDashboardDrawer.ShareInternally.SharePanel;function Mt({title:It,imageUrl:yt,buildUrl:Vt,disabled:fn,theme:Dn}){const Wn=(0,v.of)(Bt),{handleSubmit:Fn,register:la,watch:Kn,formState:{errors:aa,isValid:Ia}}=(0,J.mN)({mode:"onChange",defaultValues:{width:1e3,height:500,scaleFactor:1}});(0,K.useEffect)(()=>{Vt({width:Kn("width"),height:Kn("height"),scale:Kn("scaleFactor")})},[Vt,Kn]);const[{loading:Zn,value:ma,error:ka},ta]=(0,ps.A)(async is=>{const Ys=await(0,Aa.s)((0,xt.AI)().fetch({url:is,responseType:"blob"}));return new Blob([Ys.data],{type:"image/png"})},[]),Ya=async is=>{const{width:Ys,height:rr,scaleFactor:Js}=is;O.c.generatePanelImageClicked({width:Ys,height:rr,scaleFactor:Js,theme:Dn,shareResource:"panel"}),await ta(yt)},_n=()=>{O.c.downloadPanelImageClicked({shareResource:"panel"}),Xn()(ma,`${It}.png`)},Ns=()=>{Vt({width:Kn("width"),height:Kn("height"),scale:Kn("scaleFactor")})};return(0,n.jsx)("div",{"data-testid":bt.preview,children:(0,n.jsxs)(m.B,{gap:2,direction:"column",children:[(0,n.jsx)(H.E,{element:"h4",children:(0,n.jsx)(c.x6,{i18nKey:"share-panel-image.preview.title",children:"Panel preview"})}),(0,n.jsx)("form",{onSubmit:Fn(Ya),children:(0,n.jsxs)(ee.n,{disabled:!x.$.rendererAvailable,label:(0,n.jsxs)(m.B,{gap:1,alignItems:"center",children:[(0,n.jsx)(H.E,{element:"h5",children:(0,n.jsx)(c.x6,{i18nKey:"share-panel-image.settings.title",children:"Image settings"})}),(0,n.jsx)(ne.m,{content:(0,c.t)("share-panel-image.settings.max-warning","Setting maximums are limited by the image renderer service"),children:(0,n.jsx)(se.I,{name:"info-circle",size:"sm"})})]}),children:[(0,n.jsxs)(m.B,{gap:1,justifyContent:"space-between",direction:{xs:"column",sm:"row"},children:[(0,n.jsx)(q.D,{label:(0,c.t)("share-panel-image.settings.width-label","Width"),className:Wn.imageConfigurationField,required:!0,invalid:!!aa.width,error:aa.width?.message,children:(0,n.jsx)(oe.p,{...la("width",{required:(0,c.t)("share-panel-image.settings.width-required","Width is required"),min:{value:1,message:(0,c.t)("share-panel-image.settings.width-min","Width must be equal or greater than 1")},valueAsNumber:!0,onChange:Ns}),placeholder:(0,c.t)("share-panel-image.settings.width-placeholder","1000"),type:"number",suffix:"px","data-testid":bt.widthInput})}),(0,n.jsx)(q.D,{label:(0,c.t)("share-panel-image.settings.height-label","Height"),className:Wn.imageConfigurationField,required:!0,invalid:!!aa.height,error:aa.height?.message,children:(0,n.jsx)(oe.p,{...la("height",{required:(0,c.t)("share-panel-image.settings.height-required","Height is required"),min:{value:1,message:(0,c.t)("share-panel-image.settings.height-min","Height must be equal or greater than 1")},valueAsNumber:!0,onChange:Ns}),placeholder:(0,c.t)("share-panel-image.settings.height-placeholder","500"),type:"number",suffix:"px","data-testid":bt.heightInput})}),(0,n.jsx)(q.D,{label:(0,c.t)("share-panel-image.settings.scale-factor-label","Scale factor"),className:Wn.imageConfigurationField,required:!0,invalid:!!aa.scaleFactor,error:aa.scaleFactor?.message,children:(0,n.jsx)(oe.p,{...la("scaleFactor",{required:(0,c.t)("share-panel-image.settings.scale-factor-required","Scale factor is required"),min:{value:1,message:(0,c.t)("share-panel-image.settings.scale-factor-min","Scale factor must be equal or greater than 1")},valueAsNumber:!0,onChange:Ns}),placeholder:(0,c.t)("share-panel-image.settings.scale-factor-placeholder","1"),type:"number","data-testid":bt.scaleFactorInput})})]}),(0,n.jsxs)(m.B,{gap:1,direction:{xs:"column",sm:"row"},children:[(0,n.jsx)(b.$n,{icon:"gf-layout-simple",variant:"secondary",fill:"solid",type:"submit",disabled:fn||Zn||!Ia,"data-testid":bt.generateImageButton,children:(0,n.jsx)(c.x6,{i18nKey:"link.share-panel.render-image",children:"Generate image"})}),(0,n.jsx)(b.$n,{onClick:_n,icon:"download-alt",variant:"secondary",disabled:!ma||Zn||fn,"data-testid":bt.downloadImageButton,children:(0,n.jsx)(c.x6,{i18nKey:"link.share-panel.download-image",children:"Download image"})})]})]})}),Zn&&(0,n.jsxs)("div",{children:[(0,n.jsx)(dt.G,{width:128}),(0,n.jsx)("div",{className:Wn.imageLoadingContainer,children:(0,n.jsx)(H.E,{variant:"body",children:It||""})})]}),ma&&!Zn&&(0,n.jsx)("img",{src:URL.createObjectURL(ma),alt:"panel-preview-img",className:Wn.image}),ka&&!Zn&&(0,n.jsx)(tt.F,{severity:"error",title:(0,c.t)("link.share-panel.render-image-error","Failed to render panel image"),children:(0,xt.NF)(ka)?ka.statusText:(0,c.t)("link.share-panel.render-image-error-description","An error occurred when generating the image")})]})})}const Bt=It=>({imageConfigurationField:(0,o.css)({flex:1}),image:(0,o.css)({maxWidth:"100%",width:"max-content"}),imageLoadingContainer:(0,o.css)({maxWidth:"100%",height:362,border:`1px solid ${It.components.input.borderColor}`,padding:It.spacing(1)})});class Kt extends Pn.R{static{this.Component=Qt}constructor(yt){super(yt)}getTabLabel(){return(0,c.t)("share-panel.drawer.share-link-title","Link settings")}}function Qt({model:It}){const yt=(0,v.of)(Zt),{useLockedTime:Vt,useShortUrl:fn,selectedTheme:Dn,isBuildUrlLoading:Wn,imageUrl:Fn,panelRef:la}=It.useState(),Kn=la?.resolve().state.title,Ia=!!(0,u.YQ)(It).state.uid;return(0,n.jsxs)("div",{children:[(0,n.jsx)(H.E,{variant:"body",children:(0,n.jsx)(c.x6,{i18nKey:"link.share-panel.config-description",children:"Create a personalized, direct link to share your panel within your organization, with the following customization settings:"})}),(0,n.jsxs)("div",{className:yt.configurationContainer,children:[(0,n.jsx)(cn,{useLockedTime:Vt,onToggleLockedTime:It.onToggleLockedTime,useShortUrl:fn,onUrlShorten:It.onUrlShorten,selectedTheme:Dn,onChangeTheme:It.onThemeChange,isLoading:Wn}),(0,n.jsx)(D.b,{icon:"link",variant:"primary",fill:"outline",disabled:Wn,getText:It.getShareUrl,onClipboardCopy:It.onCopy,children:(0,n.jsx)(c.x6,{i18nKey:"link.share.copy-link-button",children:"Copy link"})})]}),(0,n.jsx)(T.c,{spacing:2}),(0,n.jsxs)(m.B,{gap:2,direction:"column",children:[!Ia&&(0,n.jsx)(tt.F,{severity:"info",title:(0,c.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,n.jsx)(c.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})}),!x.$.rendererAvailable&&(0,n.jsx)(tt.F,{severity:"info",title:(0,c.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,n.jsxs)(c.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,n.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})}),(0,n.jsx)(Mt,{title:Kn||"",buildUrl:It.buildUrl,imageUrl:Fn,disabled:!Ia,theme:Dn})]})]})}const Zt=It=>({configurationContainer:(0,o.css)({marginTop:It.spacing(2)})}),nn=[];function kt(It){nn.push(It)}class bn extends s.Bs{constructor(yt){super({...yt}),this.onDismiss=()=>{this.state.activeShare?.onDismiss?this.state.activeShare.onDismiss():this.state.panelRef?(0,u.YQ)(this).closeModal():a.Ny.partial({shareView:null})},this.addActivationHandler(()=>this.buildActiveShare(yt.shareView))}static{this.Component=Ln}buildActiveShare(yt){const{panelRef:Vt}=this.state,fn=(0,u.YQ)(this),Dn=Vt?Hn(yt,this.onDismiss,fn.getRef(),Vt):Yn(yt,this.onDismiss,fn.getRef(),Vt);this.setState({activeShare:Dn})}}function Ln({model:It}){const{activeShare:yt}=It.useState(),Vt=(0,u.YQ)(It);return(0,n.jsx)(i._,{title:yt?.getTabLabel(),onClose:It.onDismiss,size:"md",children:(0,n.jsx)(X.Provider,{value:{dashboard:Vt,onDismiss:It.onDismiss},children:yt&&(0,n.jsx)(yt.Component,{model:yt})})})}function Yn(It,yt,Vt,fn){const Dn=nn.find(Wn=>Wn.id===It);if(Dn)return new Dn.shareOption({onDismiss:yt});switch(It){case r.wr.link:return new kn({onDismiss:yt});case r.wr.publicDashboard:return new Ye({onDismiss:yt});case r.wr.snapshot:return new ca({dashboardRef:Vt,panelRef:fn,onDismiss:yt});case r.wr.export:return new B({onDismiss:yt});default:return new kn({onDismiss:yt})}}function Hn(It,yt,Vt,fn){switch(It){case r.wr.link:return new Kt({panelRef:fn,onDismiss:yt});case r.wr.snapshot:return new ca({dashboardRef:Vt,panelRef:fn,onDismiss:yt});case r.wr.embed:return new Da.c({panelRef:fn,onDismiss:yt});case r.wr.libraryPanel:return new Jn.S({panelRef:fn,onDismiss:yt});default:return new Kt({panelRef:fn,onDismiss:yt})}}},56445:(te,R,e)=>{"use strict";e.d(R,{N:()=>K});var n=e(74848),a=e(4213),s=e.n(a),i=e(20382),r=e(2543),u=e.n(r),o=e(16817),l=e(70713),g=e(92745),f=e(43173),p=e(36674),c=e(41654),x=e(37386),v=e(21285),m=e(22787),y=e(45861),h=e(50992),d=e(47931),E=e(50803),b=e(60171),D=e(45173),C=e(99828),P=e(58662),M=e(7817),O=e(3392),j=e(70030),U=e(62265),W=e(13241),B=e(23289),S=e(8285),_=e(84330);class K extends p.Bs{constructor(N){super({...N,isSharingExternally:!1,isViewingJSON:!1,exportMode:f.$.featureToggles.kubernetesDashboards?_.i.Classic:void 0}),this.tabId=P.wr.export,this.onShareExternallyChange=()=>{this.setState({isSharingExternally:!this.state.isSharingExternally})},this.onExportModeChange=V=>{this.setState({exportMode:V}),V===_.i.Classic&&this.setState({isViewingYAML:!1})},this.onViewJSON=()=>{this.setState({isViewingJSON:!this.state.isViewingJSON})},this.onViewYAML=()=>{this.setState({isViewingYAML:!this.state.isViewingYAML})},this.getExportableDashboardJson=async()=>{const{isSharingExternally:V,exportMode:z}=this.state,w=(0,S.YQ)(this),H=await w.serializer.makeExportableExternally(w),Q=w.getInitialSaveModel(),Z=Q&&(0,b.aK)(Q)?"v2":"v1",Y=w.serializer.getSaveModel(w),X=V?H:Y,I=T(w,!!V);if((0,b.aK)(Y)&&"elements"in X&&Z==="v2"&&z!==_.i.V1Resource)return this.setState({exportMode:_.i.V2Resource}),{json:{apiVersion:w.serializer.apiVersion??"",kind:"Dashboard",metadata:I,spec:X,status:{}},initialSaveModelVersion:Z,hasLibraryPanels:Object.values(Y.elements).some(J=>J.kind==="LibraryPanel")};if(z===_.i.V1Resource)if((0,b.aK)(Y)&&Z==="v2")try{const J=(0,U.Xl)(w),ee=T(w,!!V),q=(0,E.Sb)(J,{name:ee.name??"",generation:ee.generation??0,resourceVersion:ee.resourceVersion??"0",creationTimestamp:ee.creationTimestamp??""});let ne;if(V){const se=new M.G(q,void 0,{getVariablesFromState:()=>(0,W.E)(window.__grafanaSceneContext)});ne=await(0,O.E)(se)}else ne=q;return{json:{apiVersion:`${D._.group}/${D._.version}`,kind:"Dashboard",metadata:ee,spec:ne,status:{}},initialSaveModelVersion:Z,hasLibraryPanels:void 0}}catch(J){return{json:{error:`Failed to convert dashboard to v1. ${J}`},initialSaveModelVersion:Z,hasLibraryPanels:void 0}}else{const J=(0,j.Uy)(w);return{json:{apiVersion:`${D._.group}/${D._.version}`,kind:"Dashboard",metadata:I,spec:J,status:{}},initialSaveModelVersion:Z,hasLibraryPanels:void 0}}if(z===_.i.V2Resource){const J=(0,U.Xl)(w),ee=JSON.parse(JSON.stringify(J)),q=await(0,O.j)(ee),ne=V?q:J;return{json:{apiVersion:`${C.P.group}/${C.P.version}`,kind:"Dashboard",metadata:I,spec:ne,status:{}},initialSaveModelVersion:Z}}if(Z==="v1"&&(0,b.aK)(Y)&&Q&&"panels"in Q){const J=new M.G(Q,void 0,{getVariablesFromState:()=>(0,W.E)(window.__grafanaSceneContext)});return{json:V?await(0,O.E)(J):Q,hasLibraryPanels:void 0,initialSaveModelVersion:Z}}return{json:X,hasLibraryPanels:void 0,initialSaveModelVersion:Z}},this.onSaveAsFile=async()=>{const V=await this.getExportableDashboardJson(),z=JSON.stringify(V.json,null,2),{isSharingExternally:w,isViewingYAML:H}=this.state,Q=new Blob([H?i.Ay.dump(V.json):z],{type:"application/json;charset=utf-8"}),Z=new Date().getTime();let Y="dashboard";"title"in V.json&&V.json.title&&(Y=V.json.title);const X=H?"yaml":"json";s()(Q,`${Y}-${Z}.${X}`),B.c.exportDownloadJsonClicked({externally:w})}}static{this.Component=L}getTabLabel(){return(0,g.t)("share-modal.tab-title.export","Export")}getClipboardText(){}}function T(A,N){let V={};if(A.serializer.metadata&&("k8s"in A.serializer.metadata?V=A.serializer.metadata.k8s?(0,r.cloneDeep)(A.serializer.metadata.k8s):{}:"annotations"in A.serializer.metadata&&(V=(0,r.cloneDeep)(A.serializer.metadata))),"managedFields"in V&&delete V.managedFields,N){"uid"in V&&delete V.uid,delete V.resourceVersion,delete V.namespace;for(const z in V.labels)z.startsWith("grafana.app/")&&delete V.labels[z];for(const z in V.annotations)z.startsWith("grafana.app/")&&delete V.annotations[z]}return V}function L({model:A}){const{isSharingExternally:N,isViewingJSON:V,modalRef:z,exportMode:w,isViewingYAML:H}=A.useState(),Q=(0,o.A)(async()=>await A.getExportableDashboardJson(),[V,N,w]),Z=JSON.stringify(Q.value?.json,null,2),Y=i.Ay.dump(Q.value?.json,{skipInvalid:!0}),X=H?Y:Z,I=(0,g.t)("share-modal.export.share-externally-label","Export for sharing externally");return(0,n.jsxs)(n.Fragment,{children:[!V&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:(0,n.jsx)(g.x6,{i18nKey:"share-modal.export.info-text",children:"Export this dashboard."})}),f.$.featureToggles.kubernetesDashboards?(0,n.jsx)(_.j,{dashboardJson:Q,isSharingExternally:N??!1,exportMode:w??_.i.Classic,isViewingYAML:H??!1,onExportModeChange:A.onExportModeChange,onShareExternallyChange:A.onShareExternallyChange,onViewYAML:A.onViewYAML}):(0,n.jsx)(c.B,{gap:2,direction:"column",children:(0,n.jsx)(x.D,{label:I,children:(0,n.jsx)(v.d,{id:"share-externally-toggle",value:N,onChange:A.onShareExternallyChange})})}),(0,n.jsxs)(m.a.ButtonRow,{children:[(0,n.jsx)(y.$n,{variant:"secondary",onClick:()=>{z?.resolve().onDismiss()},fill:"outline",children:(0,n.jsx)(g.x6,{i18nKey:"share-modal.export.cancel-button",children:"Cancel"})}),H?(0,n.jsx)(y.$n,{variant:"secondary",icon:"brackets-curly",onClick:A.onViewJSON,children:(0,n.jsx)(g.x6,{i18nKey:"share-modal.export.view-button-yaml",children:"View YAML"})}):(0,n.jsx)(y.$n,{variant:"secondary",icon:"brackets-curly",onClick:A.onViewJSON,children:(0,n.jsx)(g.x6,{i18nKey:"share-modal.export.view-button",children:"View JSON"})}),(0,n.jsx)(y.$n,{variant:"primary",icon:"save",onClick:()=>A.onSaveAsFile(),children:(0,n.jsx)(g.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]}),V&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Ay,{disableHeight:!0,children:({width:J})=>Q.value?(0,n.jsx)(h.B,{value:X,showLineNumbers:!0,language:H?"yaml":"json",showMiniMap:!1,height:"500px",width:J}):Q.loading?(0,n.jsxs)("div",{children:[" ",(0,n.jsx)(g.x6,{i18nKey:"share-modal.export.loading",children:"Loading..."})]}):null}),(0,n.jsxs)(m.a.ButtonRow,{children:[(0,n.jsx)(y.$n,{variant:"secondary",fill:"outline",onClick:A.onViewJSON,icon:"arrow-left",children:(0,n.jsx)(g.x6,{i18nKey:"share-modal.export.back-button",children:"Back to export config"})}),(0,n.jsx)(d.b,{variant:"secondary",icon:"copy",disabled:Q.loading,getText:()=>X??"",children:(0,n.jsx)(g.x6,{i18nKey:"share-modal.view-json.copy-button",children:"Copy to Clipboard"})}),(0,n.jsx)(y.$n,{variant:"primary",icon:"save",disabled:Q.loading,onClick:()=>A.onSaveAsFile(),children:(0,n.jsx)(g.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]})]})}},89752:(te,R,e)=>{"use strict";e.d(R,{S:()=>c});var n=e(74848),a=e(92745),s=e(43173),i=e(36674),r=e(65241),u=e(58662),o=e(7817),l=e(82612),g=e(93389),f=e(70030),p=e(8285);class c extends i.Bs{constructor(){super(...arguments),this.tabId=u.wr.libraryPanel}static{this.Component=x}getTabLabel(){return s.$.featureToggles.newDashboardSharingComponent?(0,a.t)("share-panel.drawer.new-library-panel-title","New library panel"):(0,a.t)("share-modal.tab-title.library-panel","Library panel")}}function x({model:v}){const{panelRef:m,modalRef:y}=v.useState();if(!m)return null;const h=m.resolve(),d=h.parent;if(d instanceof g.U){const E=(0,p.YQ)(v),b=(0,f.ZB)(d),D=new l.a9(b),C=(0,f.Uy)(E),P=new o.G(C);return(0,n.jsx)(r.j,{initialFolderUid:E.state.meta.folderUid,dashboard:P,panel:D,onDismiss:()=>{y?y.resolve().onDismiss():E.closeModal()},onCreateLibraryPanel:M=>E.createLibraryPanel(h,M)})}return null}},8655:(te,R,e)=>{"use strict";e.d(R,{R:()=>b});var n=e(74848),a=e(25229),s=e(51898),i=e(92745),r=e(43173),u=e(36674),o=e(16780),l=e(37386),g=e(21285),f=e(63527),p=e(47931),c=e(30703),x=e(34999),v=e(71673),m=e(29216),y=e(58662),h=e(52043),d=e(23289),E=e(8285);class b extends u.Bs{constructor(M){super({...M,useLockedTime:M.useLockedTime??!0,useShortUrl:M.useShortUrl??!1,selectedTheme:M.selectedTheme??"current",shareUrl:"",imageUrl:"",isBuildUrlLoading:!1}),this.tabId=y.wr.link,this.buildUrl=async O=>{this.setState({isBuildUrlLoading:!0});const{panelRef:j,useLockedTime:U,useShortUrl:W,selectedTheme:B}=this.state,S=(0,E.YQ)(this),_=j?.resolve(),K={useAbsoluteTimeRange:U,theme:B,useShortUrl:W};let T=(0,v.VN)(S,K,_);W&&(T=await(0,v.fn)(T));const L=u.jh.getTimeRange(_??S),A=(0,v.$l)(K,L,_);let N=A;_&&(delete N.viewPanel,N.panelId=_.state.key,N["__feature.dashboardSceneSolo"]=!0);const V=(0,h.u)({uid:S.state.uid,currentQueryParams:window.location.search,updateQuery:{...A,...O,panelId:_?.state.key},absolute:!0,soloRoute:!0,render:!0,timeZone:C(L.getTimeZone())});this.setState({shareUrl:T,imageUrl:V,isBuildUrlLoading:!1})},this.getShareUrl=()=>this.state.shareUrl,this.onCopy=()=>{d.c.shareLinkCopied({currentTimeRange:this.state.useLockedTime,theme:this.state.selectedTheme,shortenURL:this.state.useShortUrl,shareResource:(0,y.hD)(this.state.panelRef)})},this.addActivationHandler(()=>{this.buildUrl()}),this.onToggleLockedTime=this.onToggleLockedTime.bind(this),this.onUrlShorten=this.onUrlShorten.bind(this),this.onThemeChange=this.onThemeChange.bind(this)}static{this.Component=D}getTabLabel(){return(0,i.t)("share-modal.tab-title.link","Link")}async onToggleLockedTime(){const M=!this.state.useLockedTime;this.setState({useLockedTime:M}),await this.buildUrl()}async onUrlShorten(){const M=!this.state.useShortUrl;this.setState({useShortUrl:M}),await this.buildUrl()}async onThemeChange(M){this.setState({selectedTheme:M}),await this.buildUrl()}}function D({model:P}){const M=P.useState(),{panelRef:O}=M,j=(0,E.YQ)(P),U=O?.resolve(),B=u.jh.getTimeRange(U??j).state.to==="now",{useLockedTime:S,useShortUrl:_,selectedTheme:K,shareUrl:T,imageUrl:L}=M,A=s.Tp.pages.SharePanelModal,N=!!j.state.uid,V=(0,i.t)("share-modal.link.time-range-label","Lock time range"),z=(0,i.t)("share-modal.link.time-range-description","Transforms the current relative time range to an absolute time range"),w=(0,i.t)("share-modal.link.shorten-url","Shorten URL"),H=(0,i.t)("share-modal.link.link-url","Link URL");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:(0,n.jsx)(i.x6,{i18nKey:"share-modal.link.info-text",children:"Create a direct link to this dashboard or panel, customized with the options below."})}),(0,n.jsxs)(o.n,{children:[(0,n.jsx)(l.D,{label:V,description:B?z:"",children:(0,n.jsx)(g.d,{id:"share-current-time-range",value:S,onChange:P.onToggleLockedTime})}),(0,n.jsx)(m.w,{selectedTheme:K,onChange:P.onThemeChange}),(0,n.jsx)(l.D,{label:w,children:(0,n.jsx)(g.d,{id:"share-shorten-url",value:_,onChange:P.onUrlShorten})}),(0,n.jsx)(l.D,{label:H,children:(0,n.jsx)(f.p,{id:"link-url-input",value:T,readOnly:!0,addonAfter:(0,n.jsx)(p.b,{icon:"copy",variant:"primary",getText:P.getShareUrl,onClipboardCopy:P.onCopy,children:(0,n.jsx)(i.x6,{i18nKey:"share-modal.link.copy-link-button",children:"Copy"})})})})]}),U&&r.$.rendererAvailable&&(0,n.jsxs)(n.Fragment,{children:[N&&(0,n.jsx)("div",{className:"gf-form",children:(0,n.jsxs)("a",{href:L,target:"_blank",rel:"noreferrer","aria-label":A.linkToRenderedImage,children:[(0,n.jsx)(c.I,{name:"camera"}),"\xA0",(0,n.jsx)(i.x6,{i18nKey:"share-modal.link.rendered-image",children:"Direct link rendered image"})]})}),!N&&(0,n.jsx)(x.F,{severity:"info",title:(0,i.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,n.jsx)(i.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})})]}),U&&!r.$.rendererAvailable&&(0,n.jsx)(x.F,{severity:"info",title:(0,i.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,n.jsxs)(i.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,n.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})})]})}function C(P){const M="UTC"+encodeURIComponent((0,a.KQ)().format("Z"));if(P==="utc")return"UTC";if(P==="browser"){if(!window.Intl)return M;const j=window.Intl.DateTimeFormat().resolvedOptions();return j.timeZone?j.timeZone:M}return P}},99949:(te,R,e)=>{"use strict";e.d(R,{Z:()=>V});var n=e(74848),a=e(92745),s=e(36490),i=e(43173),r=e(36674),u=e(52792),o=e(22787),l=e(13941),g=e(73427),f=e(24313),p=e(11257),c=e(58662),x=e(23289),v=e(8285),m=e(56445),y=e(89752),h=e(8655),d=e(42656),E=e(51155),b=e(62905),D=e(82298),C=e(22803),P=e(63142),M=e(72973),O=e(71599);class j extends r.Bs{static{this.Component=U}constructor(H){super({confirmVariant:"destructive",dismissText:"Cancel",dismissVariant:"secondary",icon:"exclamation-triangle",confirmButtonVariant:"destructive",...H})}onDismiss(){}}function U({model:w}){const H=w.useState();return(0,n.jsx)(O.u,{...H})}var W=e(71748);function B({model:w,publicDashboard:H,isGetLoading:Q}){const Z=(0,P.of)(S),Y=g.TP.hasPermission(p.w.DashboardsPublicWrite),X=(0,v.YQ)(w),{isDirty:I}=X.useState(),[J]=(0,b.bN)(),ee=(X.state.$variables?.state.variables.length??0)>0,q=(0,W.b)(X),se=r.jh.getTimeRange(w).useState();return(0,n.jsx)(M.b,{dashboard:X,publicDashboard:H,unsupportedDatasources:q,onRevoke:()=>{X.showModal(new j({isOpen:!0,title:(0,a.t)("dashboard-scene.config-public-dashboard.title.revoke-public-url","Revoke public URL"),icon:"trash-alt",confirmText:(0,a.t)("dashboard-scene.config-public-dashboard.confirmText.revoke-public-url","Revoke public URL"),body:(0,n.jsx)("p",{className:Z.description,children:(0,n.jsx)(a.x6,{i18nKey:"public-dashboard.config.revoke-body",children:"Are you sure you want to revoke this URL? The dashboard will no longer be public."})}),onDismiss:()=>{X.showModal(new V({activeTab:c.wr.publicDashboard}))},onConfirm:()=>{J({dashboard:X,dashboardUid:X.state.uid,uid:H.uid}),X.closeModal()}}))},timeRange:se.value,showSaveChangesAlert:Y&&I,hasTemplateVariables:ee})}const S=w=>({description:(0,C.css)({fontSize:w.typography.body.fontSize})});var _=e(58375);function K({model:w}){const H=(0,v.YQ)(w),Q=(0,W.b)(H),Z=(H.state.$variables?.state.variables.length??0)>0;return(0,n.jsx)(_.D,{dashboard:H,unsupportedDatasources:Q,unsupportedTemplateVariables:Z})}class T extends r.Bs{constructor(){super(...arguments),this.tabId=c.wr.publicDashboard}static{this.Component=L}getTabLabel(){return(0,a.t)("share-modal.tab-title.public-dashboard","Public Dashboard")}}function L({model:w}){const{data:H,isLoading:Q}=(0,b.Bs)((0,v.YQ)(w).state.uid);return(0,n.jsx)(n.Fragment,{children:Q?(0,n.jsx)(D.a,{}):(0,f.lI)(H)?(0,n.jsx)(B,{model:w,publicDashboard:H,isGetLoading:Q}):(0,n.jsx)(K,{model:w})})}const A=[];function N(w){A.push(w)}class V extends r.Bs{constructor(H){super({activeTab:"link",...H}),this.onDismiss=()=>{this.state.panelRef?(0,v.YQ)(this).closeModal():s.Ny.partial({shareView:null})},this.onChangeTab=Q=>{x.c.sharingCategoryClicked({item:Q.value,shareResource:(0,c.hD)(this.state.panelRef)}),this.setState({activeTab:Q.value})},this.addActivationHandler(()=>this.buildTabs(H.activeTab))}static{this.Component=z}buildTabs(H){const{panelRef:Q}=this.state,Z=this.getRef(),Y=[new h.R({panelRef:Q,modalRef:Z})],X=(0,v.YQ)(this);if(Q||Y.push(new m.N({modalRef:Z})),g.TP.isSignedIn&&i.$.snapshotEnabled&&g.TP.hasPermission(p.w.SnapshotsCreate)&&Y.push(new E.l({panelRef:Q,dashboardRef:X.getRef(),modalRef:Z})),Q){Y.push(new d.c({panelRef:Q}));const J=Q.resolve();J instanceof r.Eb&&((0,v.ME)(J)||Y.push(new y.S({panelRef:Q,modalRef:Z})))}Q||(Y.push(...A.map(J=>new J({modalRef:Z}))),(0,f.iR)()&&Y.push(new T({modalRef:Z})));const I=Y.find(J=>J.tabId===H);this.setState({activeTab:I?.tabId??Y[0].tabId,tabs:Y})}}function z({model:w}){const{panelRef:H,tabs:Q,activeTab:Z}=w.useState(),Y=H?(0,a.t)("share-modal.panel.title","Share Panel"):(0,a.t)("share-modal.dashboard.title","Share");if(!Q)return;const X=Q?.map(ee=>({label:ee.getTabLabel(),value:ee.tabId})),I=(0,n.jsx)(u.J,{title:Y,icon:"share-alt",tabs:X,activeTab:Z,onChangeTab:w.onChangeTab}),J=Q.find(ee=>ee.tabId===Z);return(0,n.jsx)(o.a,{isOpen:!0,title:I,onDismiss:w.onDismiss,children:(0,n.jsx)(l.J,{children:J&&(0,n.jsx)(J.Component,{model:J})})})}},42656:(te,R,e)=>{"use strict";e.d(R,{c:()=>f});var n=e(74848),a=e(92745),s=e(43173),i=e(36674),r=e(24209),u=e(58662),o=e(81657),l=e(52043),g=e(8285);class f extends i.Bs{constructor(v){super(v),this.tabId=u.wr.embed}static{this.Component=p}getTabLabel(){return s.$.featureToggles.newDashboardSharingComponent?(0,a.t)("share-panel.drawer.share-embed-title","Share embed"):(0,a.t)("share-modal.tab-title.panel-embed","Embed")}}function p({model:x}){const{panelRef:v}=x.useState(),m=v.resolve(),y=(0,g.YQ)(x),{uid:h}=y.useState(),d=(0,g.Cs)(m),E=i.jh.getTimeRange(m),b=E instanceof o.v?E.state.timeFrom:void 0;return(0,n.jsx)(r.D,{panel:{id:d,timeFrom:b},range:E.state.value,dashboard:{uid:h??"",time:E.state.value},buildIframe:c(y),onCancelClick:()=>y.closeModal()})}const c=x=>(v,m,y,h,d)=>{const E=(0,u.XV)({useCurrentTimeRange:v,selectedTheme:y,panel:h,range:d}),b=E.get("editPanel")??E.get("viewPanel")??"";return E.set("panelId",b),E.delete("editPanel"),E.delete("viewPanel"),E.set("__feature.dashboardSceneSolo","true"),`<iframe src="${(0,l.u)({absolute:!0,soloRoute:!0,uid:x.state.uid,slug:x.state.meta.slug,currentQueryParams:E.toString()})}" width="450" height="200" frameborder="0"></iframe>`}},51155:(te,R,e)=>{"use strict";e.d(R,{l:()=>M,u:()=>C});var n=e(74848),a=e(5805),s=e(51898),i=e(92745),r=e(68143),u=e(36674),o=e(37386),l=e(63527),g=e(77824),f=e(22787),p=e(45861),c=e(41654),x=e(47931),v=e(6890),m=e(64762),y=e(58662),h=e(8735),d=e(8535),E=e(70030),b=e(23289);const D=s.Tp.pages.ShareDashboardModal.SnapshotScene,C=()=>{const j={label:(0,i.t)("share-modal.snapshot.expire-week","1 Week"),value:604800};return[{label:(0,i.t)("share-modal.snapshot.expire-hour","1 Hour"),value:60*60},{label:(0,i.t)("share-modal.snapshot.expire-day","1 Day"),value:60*60*24},j,{label:(0,i.t)("share-modal.snapshot.expire-never","Never"),value:0}]},P=()=>C()[2];class M extends u.Bs{constructor(U){super({...U,snapshotName:U.dashboardRef.resolve().state.title,selectedExpireOption:P()}),this.tabId=y.wr.snapshot,this.onSnasphotNameChange=W=>{this.setState({snapshotName:W})},this.onExpireChange=W=>{this.setState({selectedExpireOption:C().find(B=>B.value===W)})},this.onSnapshotCreate=async(W=!1)=>{const{selectedExpireOption:B}=this.state,S=this.prepareSnapshot(),_={dashboard:S,name:S.title,expires:B?.value,external:W};try{const K=await(0,h.s)().create(_);return(0,d.JD)((0,v.dx)((0,m.tZ)((0,i.t)("snapshot.share.success-creation","Your snapshot has been created")))),K}finally{W?b.c.publishSnapshotClicked({expires:_.expires,shareResource:(0,y.hD)(this.state.panelRef)}):b.c.publishSnapshotLocalClicked({expires:_.expires,shareResource:(0,y.hD)(this.state.panelRef)})}},this.onSnapshotDelete=async W=>{const B=await(0,r.AI)().get(W);return(0,d.JD)((0,v.dx)((0,m.tZ)((0,i.t)("snapshot.share.success-delete","Your snapshot has been deleted")))),B},this.addActivationHandler(()=>{this._onActivate()})}static{this.Component=O}_onActivate(){(0,h.s)().getSharingOptions().then(U=>{this.isActive&&this.setState({snapshotSharingOptions:U})})}getTabLabel(){return(0,i.t)("share-modal.tab-title.snapshot","Snapshot")}prepareSnapshot(){const U=u.jh.getTimeRange(this),{dashboardRef:W,panelRef:B}=this.state,S=(0,E.Uy)(W.resolve(),!0);return(0,E.c)(this.state.snapshotName.trim()||"",U.state.value,S,B?.resolve())}}function O({model:j}){const{snapshotName:U,selectedExpireOption:W,modalRef:B,snapshotSharingOptions:S}=j.useState(),[_,K]=(0,a.default)(async(A=!1)=>j.onSnapshotCreate(A)),[T,L]=(0,a.default)(async A=>await(0,r.AI)().get(A));return T.value?(0,n.jsx)(i.x6,{i18nKey:"share-modal.snapshot.deleted-message",children:"The snapshot has been deleted. If you have already accessed it once, then it might take up to an hour before before it is removed from browser caches or CDN caches."}):(0,n.jsxs)(n.Fragment,{children:[!_.value&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:(0,n.jsx)(i.x6,{i18nKey:"share-modal.snapshot.info-text-1",children:"A snapshot is an instant way to share an interactive dashboard publicly. When created, we strip sensitive data like queries (metric, template, and annotation) and panel links, leaving only the visible metric data and series names embedded in your dashboard."})}),(0,n.jsx)("p",{children:(0,n.jsxs)(i.x6,{i18nKey:"share-modal.snapshot.info-text-2",children:["Keep in mind, your snapshot ",(0,n.jsx)("em",{children:"can be viewed by anyone"})," that has the link and can access the URL. Share wisely."]})})]}),(0,n.jsx)(o.D,{label:(0,i.t)("share-modal.snapshot.name","Snapshot name"),children:(0,n.jsx)(l.p,{id:"snapshot-name-input",width:30,defaultValue:U,onBlur:A=>j.onSnasphotNameChange(A.target.value)})}),(0,n.jsx)(o.D,{label:(0,i.t)("share-modal.snapshot.expire","Expire"),children:(0,n.jsx)(g.z,{id:"expire-select-input",options:C(),value:W?.value,onChange:j.onExpireChange})}),(0,n.jsxs)(f.a.ButtonRow,{children:[(0,n.jsx)(p.$n,{variant:"secondary",onClick:()=>{B?.resolve().onDismiss()},fill:"outline",children:(0,n.jsx)(i.x6,{i18nKey:"share-modal.snapshot.cancel-button",children:"Cancel"})}),S?.externalEnabled&&(0,n.jsx)(p.$n,{variant:"secondary",disabled:_.loading,onClick:()=>K(!0),children:S?.externalSnapshotName}),(0,n.jsx)(p.$n,{variant:"primary",disabled:_.loading,onClick:()=>K(),"data-testid":D.PublishSnapshot,children:(0,n.jsx)(i.x6,{i18nKey:"share-modal.snapshot.local-button",children:"Publish Snapshot"})})]})]}),_.value&&(0,n.jsxs)(c.B,{direction:"column",gap:0,children:[(0,n.jsx)(o.D,{label:(0,i.t)("share-modal.snapshot.url-label","Snapshot URL"),children:(0,n.jsx)(l.p,{"data-testid":D.CopyUrlInput,id:"snapshot-url-input",value:_.value.url,readOnly:!0,addonAfter:(0,n.jsx)(x.b,{"data-testid":D.CopyUrlButton,icon:"copy",variant:"primary",getText:()=>_.value.url,children:(0,n.jsx)(i.x6,{i18nKey:"share-modal.snapshot.copy-link-button",children:"Copy"})})})}),(0,n.jsxs)("div",{style:{alignSelf:"flex-end",padding:"5px"},children:[(0,n.jsx)(i.x6,{i18nKey:"share-modal.snapshot.mistake-message",children:"Did you make a mistake? "}),"\xA0",(0,n.jsx)(p.$n,{fill:"outline",size:"md",variant:"destructive",onClick:()=>{L(_.value.deleteUrl)},children:(0,n.jsx)(i.x6,{i18nKey:"share-modal.snapshot.delete-button",children:"Delete snapshot."})})]})]})]})}},71748:(te,R,e)=>{"use strict";e.d(R,{b:()=>g});var n=e(16817),a=e(36580),s=e(35143),i=e(28998),r=e(8285);const u=async f=>{let p=new Set;for(const c of f)s.z.has(c)&&await(0,i.tR)().get(c)instanceof a.iy||p.add(c);return Array.from(p)};function o(f){const p=new Set,c=f.state.body.getVizPanels();for(const x of c){const v=l(x);for(const m of v)p.add(m)}return Array.from(p).sort()}function l(f){const p=new Set,c=(0,r.un)(f);if(c)for(const x of c.state.queries)p.add(x.datasource?.type??"");return Array.from(p)}function g(f){const{value:p}=(0,n.A)(async()=>{const c=o(f);return u(c)},[]);return p}},33380:(te,R,e)=>{"use strict";e.d(R,{R:()=>s});var n=e(36674),a=e(8285);class s{constructor(r){this._vizPanel=r}get id(){const r=(0,a.Cs)(this._vizPanel);return isNaN(r)?(console.error("VizPanel key could not be translated to a legacy numeric panel id",this._vizPanel),0):r}get description(){return this._vizPanel.state.description}get type(){return this._vizPanel.state.pluginId}get title(){return this._vizPanel.state.title}get transformations(){return this._vizPanel.state.$data instanceof n.Es?this._vizPanel.state.$data.state.transformations:[]}get targets(){const r=(0,a.un)(this._vizPanel);return r?r.state.queries:[]}get datasource(){return(0,a.un)(this._vizPanel)?.state.datasource}get options(){return this._vizPanel.state.options}get fieldConfig(){return this._vizPanel.state.fieldConfig}get pluginVersion(){return this._vizPanel.state.pluginVersion}}},3371:(te,R,e)=>{"use strict";e.d(R,{Dq:()=>p,Lv:()=>v,Qp:()=>m,Ry:()=>l,ag:()=>x,d9:()=>o,ed:()=>c,lv:()=>u,oX:()=>g,uc:()=>f});var n=e(72746);const a="-clone-",s="/",i=new RegExp(`${a}[1-9][0-9]*$`),r=new RegExp(`${a}\\d+$`);function u(y,h){const d=y.split(s).slice(0,-1),E=o(p(y));return[...d,`${E}${a}${h}`].join(s)}function o(y){return p(y).replace(r,"")}function l(y){return i.test(p(y))}function g(y,h){return l(y)&&o(y)===o(h)}function f(y){return y.split(s).some(l)}function p(y){return y.split(s).pop()??""}function c(...y){return y.filter(Boolean).join(s)}function x(y){return y.includes(a)}function v(y){const{key:h}=y.useState();return l(h)}function m(y){return l(y.state.key)?!0:!y.parent||y.parent instanceof n.H$?!1:m(y.parent)}},18789:(te,R,e)=>{"use strict";e.d(R,{w:()=>i});var n=e(43173),a=e(36674),s=e(36605);function i(r){if(!r.targets?.length||n.$.panels[r.type]?.skipDataQuery)return;let u;return u=new a.dt({datasource:r.datasource??void 0,queries:r.targets,maxDataPoints:r.maxDataPoints??void 0,maxDataPointsFromWidth:!0,cacheTimeout:r.cacheTimeout,queryCachingTTL:r.queryCachingTTL,minInterval:r.interval??void 0,dataLayerFilter:{panelId:r.id},$behaviors:[new s.L({})]}),new a.Es({$data:u,transformations:r.transformations||[]})}},1682:(te,R,e)=>{"use strict";e.d(R,{b4:()=>m});var n=e(36674),a=e(88632),s=e(32540),i=e(3371),r=e(8285);function u(y){return y.state.controls?.state.timePicker}function o(y){return y.state.controls?.state.refreshPicker}function l(y){return y.state.titleItems&&Array.isArray(y.state.titleItems)?y.state.titleItems.find(d=>d instanceof s.$)??null:null}function g(y){return y.state.body.getVizPanels()}function f(y){let h=0;return n.jh.findAllObjects(y.getRoot(),d=>d instanceof n.Eb||d instanceof n.tI).forEach(d=>{if((0,i.Ry)(d.state.key))return;const E=(0,r.Cs)(d);E>h&&(h=E)}),h+1}function p(y){const h=n.jh.getData(y);if(!(h instanceof a.s))throw new Error("DashboardDataLayerSet not found");return h}function c(y){return(0,r.YQ)(y).state.editPane.state.selection?.getSelectionEntries().map(([,h])=>h.resolve())??[]}function x(y){const h=y.state.$behaviors?.find(d=>d instanceof n.Gg.K2);if(h instanceof n.Gg.K2)return h}function v(y){const h=(0,r.YQ)(y),d=(0,r.Cs)(y);let E=h.serializer.getElementIdForPanel(d);return E||(E=(0,r.XA)(d)),E}const m={getTimePicker:u,getRefreshPicker:o,getPanelLinks:l,getVizPanels:g,getDataLayers:p,getAllSelectedObjects:c,getCursorSync:x,getLayoutManagerFor:r.h$,getNextPanelId:f,getElementIdentifierForVizPanel:v}},17788:(te,R,e)=>{"use strict";e.d(R,{Gq:()=>r,zf:()=>u});var n=e(83175),a=e(36490),s=e(43173);const i="grafana.dashboard.preservedUrlFiltersState";function r(o){const l=window.sessionStorage.getItem(i);if(l){const g=new URLSearchParams(l),f=a.Ny.getSearch(),p=new URLSearchParams;g.forEach((x,v)=>{(!f.has(v)||f.get(v)==="")&&f.append(v,x)}),f.forEach((x,v)=>{x!==""&&p.append(v,x)});for(const x of Array.from(p.keys()))x.startsWith("var-")&&(o.state.$variables?.getByName(x.replace("var-",""))||p.delete(x));const c=p.toString();c&&a.Ny.replace({search:c})}}function u(o,l){if(!s.$.featureToggles.preserveDashboardStateWhenNavigating||!l)return;const g={};o.forEach((c,x)=>{g[x]=c});const f=Object.fromEntries(Object.entries(g).filter(([c])=>c.startsWith("var-")||c==="from"||c==="to"||c==="timezone")),p=Object.fromEntries(Object.entries(f).filter(([c,x])=>!(Array.isArray(x)&&x.length===0)));Object.keys(p).length>0?window.sessionStorage.setItem(i,n.kM.renderUrl("",p)):window.sessionStorage.removeItem(i)}},52043:(te,R,e)=>{"use strict";e.d(R,{u:()=>i});var n=e(83175),a=e(36490),s=e(43173);function i(r){let u=`/d/${r.uid}`;r.uid||(u="/dashboard/new"),r.isSnapshot&&(u=`/dashboard/snapshot/${r.uid}`),r.soloRoute&&(u=`/d-solo/${r.uid}`),r.slug&&(u+=`/${r.slug}`),r.subPath&&(u+=r.subPath),r.render&&(u="/render"+u,r.updateQuery={...r.updateQuery,width:r.updateQuery?.width||1e3,height:r.updateQuery?.height||500,tz:r.timeZone}),r.isHomeDashboard&&(u="/");const o=r.currentQueryParams?(0,a.SE)(r.currentQueryParams):{};if(delete o.shareView,r.updateQuery)for(const g in r.updateQuery)r.updateQuery[g]===null||r.updateQuery[g]===void 0?delete o[g]:o[g]=r.updateQuery[g];const l=n.kM.renderUrl(u,o);return r.absolute?s.$.appUrl+l.slice(1):l}},13241:(te,R,e)=>{"use strict";e.d(R,{E:()=>s});var n=e(36674),a=e(84500);function s(i){const r=n.jh.getVariables(i);return(0,a.CN)(r,!0)}},23289:(te,R,e)=>{"use strict";e.d(R,{c:()=>s});var n=e(27489);let a=!1;const s={dashboardInitialized:r=>{i("init_dashboard_completed",{...r})},panelLinkClicked:r=>{i("panelheader_datalink_clicked",r)},panelStatusMessageClicked:r=>{i("panelheader_statusmessage_clicked",r)},panelCancelQueryClicked:r=>{i("panelheader_cancelquery_clicked",r)},toolbarFavoritesClick:()=>{i("toolbar_actions_clicked",{item:"favorites"})},toolbarSettingsClick:()=>{i("toolbar_actions_clicked",{item:"settings"})},toolbarShareClick:()=>{i("toolbar_actions_clicked",{item:"share"})},toolbarShareDropdownClick:()=>{i("toolbar_actions_clicked",{item:"share_dropdown"})},toolbarAddClick:()=>{i("toolbar_actions_clicked",{item:"add"})},sharingCategoryClicked:r=>{i("sharing_category_clicked",r)},shareLinkCopied:r=>{i("sharing_link_copy_clicked",r)},embedSnippetCopy:r=>{i("sharing_embed_copy_clicked",r)},generatePanelImageClicked:r=>{i("sharing_link_generate_image_clicked",r)},downloadPanelImageClicked:r=>{i("sharing_link_download_image_clicked",r)},publishSnapshotClicked:r=>{i("sharing_snapshot_publish_clicked",r)},publishSnapshotLocalClicked:r=>{i("sharing_snapshot_local_clicked",r)},exportDownloadJsonClicked:r=>{i("sharing_export_download_json_clicked",r)},exportCopyJsonClicked:r=>{i("sharing_export_copy_json_clicked",r)},exportSaveJsonClicked:r=>{i("sharing_export_save_json_clicked",r)},exportViewJsonClicked:r=>{i("sharing_export_view_json_clicked",r)},generatePublicDashboardUrlClicked:r=>{i("sharing_public_generate_url_clicked",r)},revokePublicDashboardEmailClicked:r=>{i("sharing_public_email_revoke_clicked",r)},resendPublicDashboardEmailClicked:r=>{i("sharing_public_email_resend_clicked",r)},publicDashboardEmailInviteClicked:r=>{i("sharing_public_email_invite_clicked",r)},publicDashboardShareTypeChange:r=>{i("sharing_public_can_view_clicked",r)},publicDashboardTimeSelectionChanged:r=>{i("sharing_public_time_picker_clicked",r)},publicDashboardAnnotationsSelectionChanged:r=>{i("sharing_public_annotations_clicked",r)},publicDashboardUrlCopied:r=>{i("sharing_public_copy_url_clicked",r)},publicDashboardPauseSharingClicked:r=>{i("sharing_public_pause_clicked",r)},revokePublicDashboardClicked:r=>{i("sharing_public_revoke_clicked",r)},emptyDashboardButtonClicked:r=>{i("emptydashboard_clicked",r)},toolbarAddButtonClicked:r=>{i("toolbar_add_clicked",r)},setScenesContext:()=>(a=!0,()=>{a=!1}),versionRestoreClicked:r=>{i("version_restore_clicked",r)},showMoreVersionsClicked:()=>{i("show_more_versions_clicked")}},i=(r,u)=>{const o=a?{scenesView:!0}:{};u?(0,n.rR)(`dashboards_${r}`,{...u,...o}):(0,n.rR)(`dashboards_${r}`)}},75541:(te,R,e)=>{"use strict";e.d(R,{C:()=>n,Y:()=>a});const n={left:[],right:[]};function a(s,i){n[s].push(i)}},22079:(te,R,e)=>{"use strict";e.d(R,{Lp:()=>f,Uu:()=>g,e0:()=>l,r7:()=>o});var n=e(92138),a=e(36490),s=e(36674),i=e(73427),r=e(62635),u=e(8285);function o(p){return n.I.getUrlForPartial(a.Ny.getLocation(),{viewPanel:p.state.key,editPanel:void 0})}function l(p){return n.I.getUrlForPartial(a.Ny.getLocation(),{editPanel:p,viewPanel:void 0})}function g(p,c){const x=p.state.key?.replace("-view","");return n.I.getUrlForPartial(a.Ny.getLocation(),{inspect:x,inspectTab:c})}function f(p){const c=p.getPlugin(),x=(0,u.un)(p);if(!i.TP.hasAccessToExplore()||c?.meta.skipDataQuery||!x)return Promise.resolve(void 0);const v=s.jh.getTimeRange(p);return(0,r.Xe)({queries:x.state.queries,dsRef:x.state.datasource,timeRange:v.state.value,scopedVars:{__sceneObject:{value:p}},adhocFilters:x.state.data?.request?.filters})}},11480:(te,R,e)=>{"use strict";e.d(R,{J:()=>r});var n=e(96540),a=e(32899),s=e(92745),i=e(75234);function r({dashboard:u,request:o,workflow:l,handlers:g,isNew:f}){(0,n.useEffect)(()=>{if(o.isError){g.onError?.(o.error);return}if(o.isSuccess&&o.data){u.setState({isDirty:!1});const{ref:p,path:c,urls:x,resource:v}=o.data;if(l==="branch"&&p&&c){g.onBranchSuccess?.({ref:p,path:c,urls:x});return}if((0,i.J7)().publish({type:a.r1.alertSuccess.name,payload:[(0,s.t)("dashboard-scene.edit-provisioned-dashboard-form.success","Dashboard changes saved successfully")]}),f&&v?.upsert&&g.onNewDashboardSuccess){g.onNewDashboardSuccess(v.upsert);return}g.onWriteSuccess?.()}},[o,l,g,f,u])}},8285:(te,R,e)=>{"use strict";e.d(R,{sw:()=>h,vm:()=>d,sf:()=>z,bR:()=>V,xp:()=>ee,Uv:()=>O,EX:()=>P,vL:()=>D,zo:()=>w,X0:()=>j,xz:()=>T,pk:()=>S,YQ:()=>K,O8:()=>L,ty:()=>Z,Sm:()=>W,bx:()=>B,h$:()=>Q,wP:()=>J,iL:()=>N,a7:()=>U,Cs:()=>b,un:()=>_,XA:()=>E,ME:()=>A,MZ:()=>Y,TN:()=>X,hg:()=>I});var n=e(48480),a=e(92745),s=e(43173),i=e(78282),r=e(36674),u=e(60379),o=e(98732),l=e(36605),g=e(72746),f=e(7094),p=e(32540),c=e(37040),x=e(29700),v=e(35718);function m(q){return"isDashboardLayoutManager"in q}var y=e(3371);const h=8,d=12;function E(q){return`panel-${q}`}function b(q){return parseInt((0,y.d9)(q.state.key).replace("panel-",""),10)}function D(q,ne){if(!ne)return null;const se=C(q,ne);if(se)return se;const oe=parseInt(ne,10);return isNaN(oe)?null:C(q,E(oe))}function C(q,ne){if(!ne)return null;const se=r.jh.findObject(q,oe=>oe.state.key===ne?!0:(oe instanceof r.Eb,!1));if(se){if(se instanceof r.Eb)return se;throw new Error(`Found panel with key ${ne} but it was not a VizPanel`)}return null}function P(q,ne){if(!ne)return null;let se=M(q,ne);if(se)return se;const oe=parseInt(ne,10);if(isNaN(oe))return null;const de=E(oe);return se=C(q,de),se||(se=M(q,de),se)}function M(q,ne){if(!ne)return null;const se=r.jh.findObject(q,oe=>{const de=oe.state.key;return de===ne||!(0,y.uc)(de)&&(0,y.d9)(de)===(0,y.d9)(ne)?!0:(oe instanceof r.Eb,!1)});if(se){if(se instanceof r.Eb)return se;throw new Error(`Found panel with key ${ne} but it was not a VizPanel`)}return null}function O(q,ne){if(!ne)return null;let se=P(q,ne);if(!se||!se.state.key)return null;const oe=(0,y.Dq)(se.state.key);if((0,y.ag)(oe)){const de=(0,y.d9)(oe);se=r.jh.findObject(se.parent??q,fe=>{if(!fe.state.key||(0,y.uc)(fe.state.key))return!1;const ae=(0,y.Dq)(fe.state.key);return(0,y.ag)(ae)?!1:(0,y.d9)(ae)===de})}return se instanceof r.Eb?se:null}function j(q,ne){q.forEachChild(se=>{se.isActive&&(se.forceRender(),j(se,ne))})}function U(q){const{value:ne,text:se,options:oe}=q.state;return q.hasAllValue()?{values:oe.map(de=>de.value),texts:oe.map(de=>de.label)}:{values:Array.isArray(ne)?ne:[ne],texts:Array.isArray(se)?se:[se]}}function W(q){const ne=q.match(/(["'])(.*?)\1|\w+/g);if(!ne)return o.Ez.query?.split(",")??[];const se=new Set,oe=ne.reduce((de,fe)=>{const ae=fe.replace(/["']+/g,"");return ae.startsWith("$__auto_interval_")||de.add(ae),de},se);return Array.from(oe)}function B(q){return Array.isArray(q)?q.join(","):""}function S(q,ne){const se=Array.isArray(q.current.value)?q.current.value[0]:q.current.value;return se.startsWith("$__auto_interval_")||se==="$__auto"?"$__auto":ne.includes(se)?se:ne[0]}function _(q){if(!q)return;const ne=q.state.$data??q.parent?.state.$data;if(ne instanceof r.dt)return ne;if(ne instanceof r.Es)return _(ne)}function K(q){const ne=q.getRoot();if(ne instanceof g.H$)return ne;throw new Error("SceneObject root is not a DashboardScene")}function T(q){return q instanceof r.Eb?q:q.parent?T(q.parent):null}function L(){const q=s.$.featureToggles.dashboardNewLayouts?x.r:"timeseries",ne=(0,a.t)("dashboard.new-panel-title","New panel");return new r.Eb({title:ne,pluginId:q,seriesLimit:s.$.panelSeriesLimit,titleItems:[new p.$({menu:new p.m({})})],hoverHeaderOffset:0,$behaviors:[],extendPanelContext:v.C,menu:new r.Lw({$behaviors:[c._i]}),$data:new r.Es({$data:new r.dt({queries:[{refId:"A"}],datasource:(0,n.p$)((0,i.l)().getInstanceSettings(null)),$behaviors:[new l.L({})]}),transformations:[]})})}function A(q){return N(q)!==void 0}function N(q){const ne=q.state.$behaviors?.find(se=>se instanceof f.u);if(ne)return ne}function V(q){const ne=Math.ceil(q.state.repeatedPanels.length/q.getMaxPerRow()),se=Math.ceil(q.state.repeatedPanels.length/ne),oe=24/se;return{h:q.state.itemHeight??10,w:oe,columnCount:se}}function z(q){let ne,se;return q.isActive?ne:(q.parent&&(se=z(q.parent)),ne=q.activate(),()=>{se?.(),ne()})}function w(q){let ne,se;return q.parent&&(se=w(q.parent)),q.isActive?()=>{se?.(),ne?.()}:(ne=q.activate(),()=>{se?.(),ne?.()})}const H=null;function Q(q){let ne=q.parent;for(;ne;){if(m(ne))return ne;ne=ne.parent}throw new Error("Could not find layout manager for scene object")}function Z(q){return`grid-item-${q}`}function Y(q){return K(q)}function X(q){return Y(q).useState()}function I(q){const{title:ne}=q.useState();return ne?r.jh.interpolate(q,ne,void 0,"text"):""}function J(q){return K(q).state.layoutOrchestrator}const ee=(0,u.h)("Dashboard")},50803:(te,R,e)=>{"use strict";e.d(R,{Op:()=>v,Sb:()=>V});var n=e(43173),a=e(21275),s=e(78947),i=e(5857),r=e(75735),u=e(78320),o=e(84500),l=e(62265),g=e(3281),f=e(39508),p=e(60171);function c(z){if((0,p.HG)(z))return z;let w;(0,p.b_)(z)?w=z.spec:w=z.dashboard;const H=(0,s.ft)(),Q=(0,s.xE)(),[Z,Y]=m(w.panels||[]),X=U(w.templating?.list||[]),I=W(w.annotations?.list||[]);let J,ee,q,ne;(0,p.b_)(z)?(J=z.access,ee={...z.metadata.annotations,[r.hm]:w.gnetId??void 0},ne=z.metadata.creationTimestamp,q={[r.Y5]:z.metadata.labels?.[r.Y5]}):(J={url:z.meta.url,slug:z.meta.slug,canSave:z.meta.canSave,canEdit:z.meta.canEdit,canDelete:z.meta.canDelete,canShare:z.meta.canShare,canStar:z.meta.canStar,canAdmin:z.meta.canAdmin,annotationsPermissions:z.meta.annotationsPermissions},ee={[r.hc]:z.meta.createdBy,[r.Qu]:z.meta.updatedBy,[r.xU]:z.meta.updated,[r.ew]:z.meta.folderUid,[r.hX]:z.meta.slug},w.gnetId&&(ee[r.hm]=w.gnetId),z.meta.isSnapshot&&(ee[r.qw]="true"),ne=z.meta.created,q={[r.Y5]:w.id?.toString()??void 0}),ee?.[r.qw]&&(ee[r.UL]=w.snapshot?.originalUrl);const se={title:w.title,description:w.description,tags:w.tags??[],cursorSync:(0,f.k6)(w.graphTooltip),preload:w.preload||Q.preload,liveNow:w.liveNow,editable:w.editable,revision:w.revision,timeSettings:{from:w.time?.from||H.from,to:w.time?.to||H.to,timezone:w.timezone||H.timezone,autoRefresh:w.refresh||H.autoRefresh,autoRefreshIntervals:w.timepicker?.refresh_intervals||H.autoRefreshIntervals,fiscalYearStartMonth:w.fiscalYearStartMonth||H.fiscalYearStartMonth,hideTimepicker:w.timepicker?.hidden||H.hideTimepicker,quickRanges:w.timepicker?.quick_ranges,weekStart:d(w.weekStart,H.weekStart),nowDelay:w.timepicker?.nowDelay||H.nowDelay},links:w.links||[],annotations:I,variables:X,elements:Z,layout:Y};return{apiVersion:"v2alpha1",kind:"DashboardWithAccessInfo",metadata:{creationTimestamp:ne||"",name:w.uid,resourceVersion:w.version?.toString()||"0",annotations:ee,labels:q},spec:se,access:J}}function x(z){if(!(0,p.b_)(z))return z;const w=z.spec;return(0,p._5)(w)?{meta:{...z.access,isNew:!1,isFolder:!1,uid:z.metadata.name,k8s:z.metadata,version:z.metadata.generation},dashboard:w}:{meta:{created:z.metadata.creationTimestamp,createdBy:z.metadata.annotations?.[r.hc]??"",updated:z.metadata.annotations?.[r.xU],updatedBy:z.metadata.annotations?.[r.Qu],folderUid:z.metadata.annotations?.[r.ew],slug:z.metadata.annotations?.[r.hX],url:z.access.url,canAdmin:z.access.canAdmin,canDelete:z.access.canDelete,canEdit:z.access.canEdit,canSave:z.access.canSave,canShare:z.access.canShare,canStar:z.access.canStar,annotationsPermissions:z.access.annotationsPermissions},dashboard:V(w,z.metadata)}}const v={ensureV2Response:c,ensureV1Response:x};function m(z){const w={},H={kind:"GridLayout",spec:{items:[]}};if(!z)return[w,H];if(z.some(h))return y(z);for(const Q of z){const[Z,Y]=C(Q);w[Y]=Z,H.spec.items.push(b(Q,Y))}return[w,H]}function y(z){let w=null,H=0;const Q={},Z={kind:"RowsLayout",spec:{rows:[]}};for(const Y of z)if(h(Y)){H=Y.gridPos.y,w&&Z.spec.rows.push(w);const X=[];for(const I of Y.panels||[]){const[J,ee]=C(I);Q[ee]=J,X.push(b(I,ee,D(I,H)))}w=E(Y,X)}else{const[X,I]=C(Y);if(Q[I]=X,w)if(w.spec.layout.kind==="GridLayout")w.spec.layout.spec.items.push(b(Y,I,D(Y,H)));else throw new Error("RowsLayoutRow from legacy row must have a GridLayout");else{const J={kind:"GridLayout",spec:{items:[b(Y,I)]}};H=-1,w={kind:"RowsLayoutRow",spec:{collapse:!1,title:"",hideHeader:!0,layout:J}}}}return w&&Z.spec.rows.push(w),[Q,Z]}function h(z){return z.type==="row"}function d(z,w){return!z||!(0,i.rE)(z)?w:z}function E(z,w){return{kind:"RowsLayoutRow",spec:{collapse:z.collapsed,title:z.title??"",repeat:z.repeat?{value:z.repeat,mode:"variable"}:void 0,layout:{kind:"GridLayout",spec:{items:w}}}}}function b(z,w,H){return{kind:"GridLayoutItem",spec:{x:z.gridPos.x,y:H??z.gridPos.y,width:z.gridPos.w,height:z.gridPos.h,repeat:z.repeat?{value:z.repeat,mode:"variable",direction:z.repeatDirection,maxPerRow:z.maxPerRow}:void 0,element:{kind:"ElementReference",name:w}}}}function D(z,w){return z.gridPos.y-w-u.o}function C(z){const w=`panel-${z.id}`;if(z.libraryPanel)return[{kind:"LibraryPanel",spec:{libraryPanel:{uid:z.libraryPanel.uid,name:z.libraryPanel.name},id:z.id,title:z.title??""}},w];{const H=O(z.targets||[],z.datasource||M()),Q=j(z.transformations||[]);return[{kind:"Panel",spec:{title:z.title||"",description:z.description||"",vizConfig:{kind:z.type,spec:{fieldConfig:z.fieldConfig||(0,s.bt)(),options:z.options,pluginVersion:z.pluginVersion}},links:z.links?.map(Y=>({title:Y.title,url:Y.url||"",targetBlank:Y.targetBlank}))||[],id:z.id,data:{kind:"QueryGroup",spec:{queries:H,transformations:Q,queryOptions:{cacheTimeout:z.cacheTimeout,maxDataPoints:z.maxDataPoints,interval:z.interval,hideTimeOverride:z.hideTimeOverride,queryCachingTTL:z.queryCachingTTL,timeFrom:z.timeFrom,timeShift:z.timeShift}}}}},w]}}function P(){return(0,l.Ic)()?.type??"grafana"}function M(){const z=(0,l.Ic)()??{type:"grafana",uid:"-- Grafana --"};if(z.uid&&!z.apiVersion){const w=n.$.bootData.settings.datasources[z.uid];z.apiVersion=w.apiVersion??void 0}return{apiVersion:z.apiVersion,type:z.type,uid:z.uid}}function O(z,w){return z.map(H=>{const{refId:Q,hide:Z,datasource:Y,...X}=H;return{kind:"PanelQuery",spec:{refId:H.refId,hidden:H.hide??!1,datasource:H.datasource?H.datasource:w,query:{kind:H.datasource?.type||w.type,spec:{...X}}}}})}function j(z){return z.map(w=>({kind:w.id,spec:{...w,topic:(0,f.MM)(w.topic)}}))}function U(z){const w=[];for(const H of z){const Q={name:H.name,label:H.label,...H.description&&{description:H.description},skipUrlSync:!!H.skipUrlSync,hide:(0,f.NB)(H.hide)};switch(H.type){case"query":let Z=H.query||{};typeof Z=="string"&&(console.warn("Query variable query is a string which is deprecated in the schema v2. It should extend DataQuery"),Z={[f.sB]:Z});const Y={kind:"QueryVariable",spec:{...Q,multi:!!H.multi,includeAll:!!H.includeAll,...H.allValue&&{allValue:H.allValue},current:{value:H.current?.value,text:H.current?.text},options:H.options||[],refresh:(0,f.qJ)(H.refresh),...H.datasource&&{datasource:H.datasource},regex:H.regex||"",sort:(0,f.LY)(H.sort),query:{kind:H.datasource?.type||P(),spec:Z},allowCustomValue:H.allowCustomValue??!0}};w.push(Y);break;case"datasource":let X=P();H.query&&typeof H.query=="string"&&(X=H.query);const I={kind:"DatasourceVariable",spec:{...Q,multi:!!H.multi,includeAll:!!H.includeAll,...H.allValue&&{allValue:H.allValue},current:{value:H.current.value,text:H.current.text},options:H.options||[],refresh:(0,f.qJ)(H.refresh),pluginId:X,regex:H.regex||"",allowCustomValue:H.allowCustomValue??!0}};w.push(I);break;case"custom":const J={kind:"CustomVariable",spec:{...Q,query:H.query,current:{value:H.current.value,text:H.current.text},options:H.options,multi:H.multi,includeAll:H.includeAll,...H.allValue&&{allValue:H.allValue},allowCustomValue:H.allowCustomValue??!0}};w.push(J);break;case"adhoc":const ee={kind:"AdhocVariable",spec:{...Q,datasource:H.datasource||M(),baseFilters:(0,o.Gs)(H.baseFilters)||[],filters:(0,o.Gs)(H.filters)||[],defaultKeys:H.defaultKeys||[],allowCustomValue:H.allowCustomValue??!0}};w.push(ee);break;case"constant":const q={kind:"ConstantVariable",spec:{...Q,current:{value:H.current.value,text:H.current.value},query:H.query}};w.push(q);break;case"interval":const ne={kind:"IntervalVariable",spec:{...Q,current:{value:H.current.value,text:H.current.value},query:H.query,refresh:"onTimeRangeChanged",options:H.options,auto:H.auto,auto_min:H.auto_min,auto_count:H.auto_count}};w.push(ne);break;case"textbox":const se={kind:"TextVariable",spec:{...Q,current:{value:H.current.value,text:H.current.value},query:H.query}};w.push(se);break;case"groupby":const oe={kind:"GroupByVariable",spec:{...Q,datasource:H.datasource||M(),options:H.options,current:{value:H.current.value,text:H.current.text},multi:H.multi}};w.push(oe);break;default:console.error(`Variable transformation not implemented: ${H.type}`)}}return w}function W(z){return z.map(w=>({kind:"AnnotationQuery",spec:{name:w.name,...w.datasource&&{datasource:w.datasource},enable:w.enable,hide:!!w.hide,iconColor:w.iconColor,builtIn:!!w.builtIn,query:{kind:w.datasource?.type||P(),spec:{...w.target}},filter:w.filter}}))}function B(z){const w=[];for(const H of z){const Q={name:H.spec.name,label:H.spec.label,...H.spec.description&&{description:H.spec.description},skipUrlSync:H.spec.skipUrlSync,hide:(0,g.cc)(H.spec.hide),type:N(H)};switch(H.kind){case"QueryVariable":const Z={...Q,current:H.spec.current,options:H.spec.options,query:f.sB in H.spec.query.spec?H.spec.query.spec[f.sB]:H.spec.query.spec,datasource:H.spec.datasource,sort:(0,g.ES)(H.spec.sort),refresh:(0,g.tH)(H.spec.refresh),regex:H.spec.regex,allValue:H.spec.allValue,includeAll:H.spec.includeAll,multi:H.spec.multi,definition:H.spec.definition};w.push(Z);break;case"DatasourceVariable":const Y={...Q,current:H.spec.current,options:[],regex:H.spec.regex,refresh:(0,g.tH)(H.spec.refresh),query:H.spec.pluginId,multi:H.spec.multi,allValue:H.spec.allValue,includeAll:H.spec.includeAll};w.push(Y);break;case"CustomVariable":const X={...Q,current:{text:H.spec.current.value,value:H.spec.current.value},options:H.spec.options,query:H.spec.query,multi:H.spec.multi,allValue:H.spec.allValue,includeAll:H.spec.includeAll};w.push(X);break;case"ConstantVariable":const I={...Q,current:{text:H.spec.current.value,value:H.spec.current.value},hide:(0,g.cc)(H.spec.hide),query:H.spec.current.value};w.push(I);break;case"IntervalVariable":const J={...Q,current:{text:H.spec.current.value,value:H.spec.current.value},hide:(0,g.cc)(H.spec.hide),query:H.spec.query,refresh:(0,g.tH)(H.spec.refresh),options:H.spec.options,auto:H.spec.auto,auto_min:H.spec.auto_min,auto_count:H.spec.auto_count};w.push(J);break;case"TextVariable":const ee={text:H.spec.current.value,value:H.spec.current.value},q={...Q,current:{text:H.spec.current.value,value:H.spec.current.value},options:[{...ee,selected:!0}],query:H.spec.query};w.push(q);break;case"GroupByVariable":const ne={...Q,datasource:H.spec.datasource,current:H.spec.current,options:H.spec.options};w.push(ne);break;case"AdhocVariable":const se={...Q,datasource:H.spec.datasource,baseFilters:H.spec.baseFilters,filters:H.spec.filters,defaultKeys:H.spec.defaultKeys};w.push(se);break;default:console.error(`Variable transformation not implemented: ${H}`)}}return w}function S(z){return z.map(w=>({name:w.spec.name,datasource:w.spec.datasource,enable:w.spec.enable,hide:w.spec.hide,iconColor:w.spec.iconColor,builtIn:w.spec.builtIn?1:0,target:w.spec.query?.spec,filter:w.spec.filter}))}function _(z,w){const H=[];let Q=0;if(w.kind!=="GridLayout")throw new Error("Cannot convert non-GridLayout layout to v1");for(const Z of w.spec.items){const Y=z[Z.spec.element.name],X=K(Y,Z);H.push(X),(X.id??0>Q)&&(Q=X.id??0)}for(const Z of H)Z.type==="row"&&Z.id===-1&&(Z.id=++Q);return H}function K(z,w,H){const{x:Q,y:Z,width:Y,height:X,repeat:I}=w?.spec||{x:0,y:0,width:0,height:0},J={x:Q,y:H??Z,w:Y,h:X};if(z.kind==="Panel"){const ee=z.spec;return{id:ee.id,type:ee.vizConfig.kind,title:ee.title,description:ee.description,fieldConfig:T(ee.vizConfig.spec.fieldConfig),options:ee.vizConfig.spec.options,pluginVersion:ee.vizConfig.spec.pluginVersion,links:ee.links?.map(q=>({title:q.title,url:q.url,...q.targetBlank&&{targetBlank:q.targetBlank}}))||[],targets:ee.data.spec.queries.map(q=>({refId:q.spec.refId,hide:q.spec.hidden,datasource:q.spec.datasource,...q.spec.query.spec})),transformations:ee.data.spec.transformations.map(q=>q.spec),gridPos:J,cacheTimeout:ee.data.spec.queryOptions.cacheTimeout,maxDataPoints:ee.data.spec.queryOptions.maxDataPoints,interval:ee.data.spec.queryOptions.interval,hideTimeOverride:ee.data.spec.queryOptions.hideTimeOverride,queryCachingTTL:ee.data.spec.queryOptions.queryCachingTTL,timeFrom:ee.data.spec.queryOptions.timeFrom,timeShift:ee.data.spec.queryOptions.timeShift,transparent:ee.transparent,...I?.value&&{repeat:I.value},...I?.direction&&{repeatDirection:I.direction},...I?.maxPerRow&&{maxPerRow:I.maxPerRow}}}else if(z.kind==="LibraryPanel"){const ee=z.spec;return{id:ee.id,title:ee.title,gridPos:J,libraryPanel:{uid:ee.libraryPanel.uid,name:ee.libraryPanel.name},type:"library-panel-ref"}}else throw new Error(`Unknown element kind: ${z}`)}function T(z){const w=Q=>{switch(Q){case"absolute":return a.Ol.Absolute;case"percentage":return a.Ol.Percentage;default:return a.Ol.Absolute}},H={...z.defaults};return z.defaults.mappings&&(H.mappings=z.defaults.mappings.map(Q=>{switch(Q.type){case"value":return{...Q,type:a.dM.ValueToText};case"range":return{...Q,type:a.dM.RangeToText};case"regex":return{...Q,type:a.dM.RegexToText};case"special":return{...Q,options:{...Q.options,match:A(Q.options.match)},type:a.dM.SpecialValue};default:return Q}})),z.defaults.thresholds&&(H.thresholds={...z.defaults.thresholds,mode:w(z.defaults.thresholds.mode)}),z.defaults.color?.mode&&(H.color={...z.defaults.color,mode:L(z.defaults.color.mode)}),{...z,defaults:H}}function L(z){switch(z){case"thresholds":return a.Yb.Thresholds;case"palette-classic":return a.Yb.PaletteClassic;case"palette-classic-by-name":return a.Yb.PaletteClassicByName;case"continuous-GrYlRd":return a.Yb.ContinuousGrYlRd;case"continuous-RdYlGr":return a.Yb.ContinuousRdYlGr;case"continuous-BlYlRd":return a.Yb.ContinuousBlYlRd;case"continuous-YlRd":return a.Yb.ContinuousYlRd;case"continuous-BlPu":return a.Yb.ContinuousBlPu;case"continuous-YlBl":return a.Yb.ContinuousYlBl;case"continuous-blues":return a.Yb.ContinuousBlues;case"continuous-reds":return a.Yb.ContinuousReds;case"continuous-greens":return a.Yb.ContinuousGreens;case"continuous-purples":return a.Yb.ContinuousPurples;case"fixed":return a.Yb.Fixed;case"shades":return a.Yb.Shades;default:return a.Yb.Thresholds}}function A(z){switch(z){case"true":return a.WL.True;case"false":return a.WL.False;case"null":return a.WL.Null;case"nan":return a.WL.NaN;case"null+nan":return a.WL.NullAndNan;case"empty":return a.WL.Empty;default:throw new Error(`Unknown match type: ${z}`)}}function N(z){switch(z.kind){case"QueryVariable":return"query";case"DatasourceVariable":return"datasource";case"CustomVariable":return"custom";case"ConstantVariable":return"constant";case"IntervalVariable":return"interval";case"TextVariable":return"textbox";case"GroupByVariable":return"groupby";case"AdhocVariable":return"adhoc";default:throw new Error(`Unknown variable type: ${z}`)}}function V(z,w){const H=S(z.annotations),Q=B(z.variables),Z=_(z.elements,z.layout);return{uid:w.name,title:z.title,description:z.description,tags:z.tags,schemaVersion:40,graphTooltip:(0,g.Y_)(z.cursorSync),preload:z.preload,liveNow:z.liveNow,editable:z.editable,gnetId:w.annotations?.[r.hm],revision:z.revision,time:{from:z.timeSettings.from,to:z.timeSettings.to},timezone:z.timeSettings.timezone,refresh:z.timeSettings.autoRefresh,timepicker:{refresh_intervals:z.timeSettings.autoRefreshIntervals,hidden:z.timeSettings.hideTimepicker,quick_ranges:z.timeSettings.quickRanges,nowDelay:z.timeSettings.nowDelay},fiscalYearStartMonth:z.timeSettings.fiscalYearStartMonth,weekStart:z.timeSettings.weekStart,version:w.generation,links:z.links,annotations:{list:H},panels:Z,templating:{list:Q}}}},13956:(te,R,e)=>{"use strict";e.d(R,{n:()=>m});var n=e(66402),a=e(95407),s=e(60171),i=e(45173),r=e(99828);class u{constructor(){this.v1Client=new i.P,this.v2Client=new r.L}async getDashboardDTO(h){try{return await this.v1Client.getDashboardDTO(h)}catch(d){if(d instanceof a.P&&d.data.storedVersion==="v2alpha1")return await this.v2Client.getDashboardDTO(h);throw d}}async saveDashboard(h){if((0,s.mi)(h))return await this.v2Client.saveDashboard(h);if((0,s.rL)(h))return await this.v1Client.saveDashboard(h);throw new Error("Invalid dashboard command")}async deleteDashboard(h,d){return await this.v1Client.deleteDashboard(h,d)}async listDeletedDashboards(h){const d=await this.v1Client.listDeletedDashboards(h),E=d.items.filter(C=>!(0,s.QX)(C,"v2"));if(E.length===d.items.length)return d;const b=await this.v2Client.listDeletedDashboards(h),D=b.items.filter(C=>!(0,s.QX)(C,"v1"));return{...b,items:[...E,...D]}}async restoreDashboard(h){if((0,s.aK)(h.spec)&&(0,n.N)(h))return await this.v2Client.restoreDashboard(h);if((0,n.N)(h))return await this.v1Client.restoreDashboard(h);throw new Error("Invalid dashboard resource for restore operation")}}var o=e(32899),l=e(92745),g=e(68143),f=e(45229),p=e(79718);class c{constructor(){}saveDashboard(h){return p.t.ignoreNextSave(),(0,g.AI)().post("/api/dashboards/db/",{dashboard:h.dashboard,message:h.message??"",overwrite:h.overwrite??!1,folderUid:h.folderUid})}deleteDashboard(h,d){return(0,g.AI)().delete(`/api/dashboards/uid/${h}`,void 0,{showSuccessAlert:d,validatePath:!0})}async getDashboardDTO(h,d){const E=await(0,g.AI)().get(`/api/dashboards/uid/${h}`,d,void 0,{validatePath:!0});if(E.meta.isFolder)throw f.A.emit(o.r1.alertError,["Dashboard not found"]),{status:404,config:{url:`/api/dashboards/uid/${h}`},data:{message:(0,l.t)("dashboard.legacy-dashboard-api.fetch-error.message.dashboard-not-found","Dashboard not found")}};return E}listDeletedDashboards(h){return Promise.resolve({apiVersion:"v1",kind:"List",metadata:{resourceVersion:"0"},items:[]})}restoreDashboard(h){return Promise.reject(new Error("Restore functionality not supported in legacy API"))}}let x;function v(y){throw new Error("dashboardAPI can be only overridden in test environment")}function m(y){const h=(0,s.GV)(y);if(x||(x={legacy:new c,v1:new i.P,v2:new r.L,unified:new u}),!x[h])throw new Error(`Unknown Dashboard API version: ${h}`);return x[h]}},62905:(te,R,e)=>{"use strict";e.d(R,{$L:()=>E,AK:()=>D,Bs:()=>x,NA:()=>b,NY:()=>d,Sm:()=>c,T2:()=>m,U9:()=>v,_e:()=>h,bN:()=>y,eq:()=>M,ft:()=>O,g9:()=>P,kd:()=>C});var n=e(75816),a=e(92745),s=e(68143),i=e(43173),r=e(73892),u=e(6890),o=e(64762),l=e(24313),g=e(72746);function f(j){return typeof j=="object"&&j!=null&&"error"in j}const p=j=>({error:(0,s.NF)(j)&&j.data.messageId!=="publicdashboards.notFound"?j:null}),c=(0,n.xP)({reducerPath:"publicDashboardApi",baseQuery:(0,r.W)({baseURL:"/api"}),tagTypes:["PublicDashboard","AuditTablePublicDashboard","UsersWithActiveSessions","ActiveUserDashboards"],refetchOnMountOrArgChange:!0,endpoints:j=>({getPublicDashboard:j.query({query:U=>({url:`/dashboards/uid/${U}/public-dashboards`,manageError:p,showErrorAlert:!1}),async onQueryStarted(U,{dispatch:W,queryFulfilled:B}){try{await B}catch(S){f(S)&&(0,s.NF)(S.error)&&W((0,u.dx)((0,o.gi)(S.error.data.message)))}},providesTags:(U,W,B)=>[{type:"PublicDashboard",id:B}]}),createPublicDashboard:j.mutation({query:U=>({url:`/dashboards/uid/${U.dashboard instanceof g.H$?U.dashboard.state.uid:U.dashboard.uid}/public-dashboards`,method:"POST",body:U.payload}),async onQueryStarted({dashboard:U,payload:{share:W}},{dispatch:B,queryFulfilled:S}){const{data:_}=await S;let K=(0,a.t)("public-dashboard.sharing.success-creation","Dashboard is public!");i.$.featureToggles.newDashboardSharingComponent&&(K=W===l.Xo.PUBLIC?(0,a.t)("public-dashboard.public-sharing.success-creation","Your dashboard is now publicly accessible"):(0,a.t)("public-dashboard.email-sharing.success-creation","Your dashboard is ready for external sharing")),B((0,u.dx)((0,o.tZ)(K))),U instanceof g.H$?U.setState({meta:{...U.state.meta,publicDashboardEnabled:_.isEnabled}}):U.updateMeta({publicDashboardEnabled:_.isEnabled})},invalidatesTags:(U,W,{dashboard:B})=>[{type:"PublicDashboard",id:B instanceof g.H$?B.state.uid:B.uid}]}),updatePublicDashboard:j.mutation({query:({payload:U,dashboard:W})=>({url:`/dashboards/uid/${W instanceof g.H$?W.state.uid:W.uid}/public-dashboards/${U.uid}`,method:"PATCH",body:U}),async onQueryStarted({dashboard:U},{dispatch:W,queryFulfilled:B}){await B,W((0,u.dx)((0,o.tZ)(i.$.featureToggles.newDashboardSharingComponent?(0,a.t)("public-dashboard.configuration.success-update","Settings have been successfully updated"):(0,a.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!"))))},invalidatesTags:(U,W,{payload:B})=>[{type:"PublicDashboard",id:B.dashboardUid},"AuditTablePublicDashboard"]}),pauseOrResumePublicDashboard:j.mutation({query:({payload:U,dashboard:W})=>({url:`/dashboards/uid/${W instanceof g.H$?W.state.uid:W.uid}/public-dashboards/${U.uid}`,method:"PATCH",body:U}),async onQueryStarted({dashboard:U,payload:{isEnabled:W}},{dispatch:B,queryFulfilled:S}){const{data:_}=await S;let K=(0,a.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!");i.$.featureToggles.newDashboardSharingComponent&&(K=W?(0,a.t)("public-dashboard.configuration.success-resume","Your dashboard access has been resumed"):(0,a.t)("public-dashboard.configuration.success-pause","Your dashboard access has been paused")),B((0,u.dx)((0,o.tZ)(K))),U instanceof g.H$?U.setState({meta:{...U.state.meta,publicDashboardEnabled:_.isEnabled}}):U.updateMeta?.({publicDashboardEnabled:_.isEnabled})},invalidatesTags:(U,W,{payload:B})=>[{type:"PublicDashboard",id:B.dashboardUid},"AuditTablePublicDashboard"]}),updatePublicDashboardAccess:j.mutation({query:({payload:U,dashboard:W})=>({url:`/dashboards/uid/${W instanceof g.H$?W.state.uid:W.uid}/public-dashboards/${U.uid}`,method:"PATCH",body:U}),async onQueryStarted({dashboard:U,payload:{share:W}},{dispatch:B,queryFulfilled:S}){await S;let _=(0,a.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!");i.$.featureToggles.newDashboardSharingComponent&&(_=W===l.Xo.PUBLIC?(0,a.t)("public-dashboard.public-sharing.success-share-type-change","Dashboard access updated: Anyone with the link can now access"):(0,a.t)("public-dashboard.email-sharing.success-share-type-change","Dashboard access updated: Only specific people can now access with the link")),B((0,u.dx)((0,o.tZ)(_)))},invalidatesTags:(U,W,{payload:B})=>[{type:"PublicDashboard",id:B.dashboardUid},"AuditTablePublicDashboard"]}),addRecipient:j.mutation({query:()=>({url:""})}),deleteRecipient:j.mutation({query:()=>({url:""})}),reshareAccessToRecipient:j.mutation({query:()=>({url:""})}),getActiveUsers:j.query({query:()=>({url:"/"}),providesTags:["UsersWithActiveSessions"]}),getActiveUserDashboards:j.query({query:()=>({url:""}),providesTags:(U,W,B)=>[{type:"ActiveUserDashboards",id:B}]}),listPublicDashboards:j.query({query:(U=1)=>({url:`/dashboards/public-dashboards?page=${U}&perpage=8`}),transformResponse:U=>({...U,totalPages:Math.ceil(U.totalCount/U.perPage)}),providesTags:["AuditTablePublicDashboard"]}),deletePublicDashboard:j.mutation({query:U=>({url:`/dashboards/uid/${U.dashboardUid}/public-dashboards/${U.uid}`,method:"DELETE"}),async onQueryStarted({dashboard:U},{dispatch:W,queryFulfilled:B}){await B,W((0,u.dx)((0,o.tZ)(i.$.featureToggles.newDashboardSharingComponent?(0,a.t)("public-dashboard.share.success-delete","Your dashboard is no longer shareable"):(0,a.t)("public-dashboard.share.success-delete-old","Public dashboard deleted!")))),W(c.util?.resetApiState()),U instanceof g.H$?U.setState({meta:{...U.state.meta,publicDashboardEnabled:!1}}):U?.updateMeta({publicDashboardEnabled:!1})},invalidatesTags:(U,W,{dashboardUid:B})=>[{type:"PublicDashboard",id:B},"AuditTablePublicDashboard","UsersWithActiveSessions","ActiveUserDashboards"]}),revokeAllAccess:j.mutation({query:()=>({url:""})})})}),{useGetPublicDashboardQuery:x,useCreatePublicDashboardMutation:v,useUpdatePublicDashboardMutation:m,useDeletePublicDashboardMutation:y,useListPublicDashboardsQuery:h,useAddRecipientMutation:d,useDeleteRecipientMutation:E,useReshareAccessToRecipientMutation:b,useGetActiveUsersQuery:D,useGetActiveUserDashboardsQuery:C,useRevokeAllAccessMutation:P,usePauseOrResumePublicDashboardMutation:M,useUpdatePublicDashboardAccessMutation:O}=c},95407:(te,R,e)=>{"use strict";e.d(R,{P:()=>n});class n extends Error{constructor(s,i="Dashboard version mismatch"){super(i),this.name="DashboardVersionError",this.status=200,this.data={storedVersion:s,message:i}}}},60171:(te,R,e)=>{"use strict";e.d(R,{GV:()=>s,HG:()=>o,QX:()=>p,_5:()=>u,aK:()=>r,b_:()=>i,mi:()=>g,rL:()=>l});var n=e(43173),a=e(36490);function s(c){const x=n.$.featureToggles.dashboardScene,v=n.$.featureToggles.kubernetesDashboards,m=a.Ny.getSearch().get("scenes")==="false";if(!x||m){if(c==="v2")throw new Error("v2 is not supported for legacy architecture");return v?"v1":"legacy"}if(v)return c==="v1"?"v1":c==="v2"?"v2":"unified";if(c==="v2")throw new Error("v2 is not supported if kubernetes dashboards are disabled");return"legacy"}function i(c){return c?"kind"in c&&c.kind==="DashboardWithAccessInfo":!1}function r(c){return"elements"in c}function u(c){return!r(c)}function o(c){return i(c)&&r(c.spec)}function l(c){return!r(c.dashboard)}function g(c){return r(c.dashboard)}function f(c){return c.status?.conversion?.failed?c.status.conversion.storedVersion:void 0}function p(c,x){const v=f(c);return!!v&&v.startsWith(x)}},45173:(te,R,e)=>{"use strict";e.d(R,{P:()=>p,_:()=>f});var n=e(92138),a=e(92745),s=e(83873),i=e(47797),r=e(77197),u=e(54115),o=e(75735),l=e(52043),g=e(95407);const f={group:"dashboard.grafana.app",version:"v1beta1",resource:"dashboards"};class p{constructor(){this.client=new u.ws(f)}saveDashboard(x){const v=x.dashboard,m={metadata:{...x?.k8s},spec:{...v,title:v.title??"",uid:v.uid??""}};return x.message?m.metadata.annotations={...m.metadata.annotations,[o.fY]:x.message}:m.metadata.annotations&&delete m.metadata.annotations[o.fY],x.folderUid&&(m.metadata.annotations={...m.metadata.annotations,[o.ew]:x.folderUid}),v.uid?(m.metadata.name=v.uid,delete m.metadata.resourceVersion,this.client.update(m,{fieldValidation:"Ignore"}).then(y=>this.asSaveDashboardResponseDTO(y))):(m.metadata.annotations={...m.metadata.annotations,[o.AI]:"default"},this.client.create(m,{fieldValidation:"Ignore"}).then(y=>this.asSaveDashboardResponseDTO(y)))}asSaveDashboardResponseDTO(x){const v=n.I.assureBaseUrl((0,l.u)({uid:x.metadata.name,currentQueryParams:"",slug:r.A.slugifyForUrl(x.spec.title.trim())}));return{uid:x.metadata.name,version:x.metadata.generation??0,id:x.spec.id??0,status:"success",url:v,slug:""}}deleteDashboard(x,v){return this.client.delete(x,v).then(m=>({id:0,message:m.message,title:(0,a.t)("dashboard.k8s-dashboard-api.title.deleted","deleted")}))}async getDashboardDTO(x){try{const v=await this.client.subresource(x,"dto");if(v.status?.conversion?.failed&&v.status.conversion.storedVersion==="v2alpha1")throw new g.P(v.status.conversion.storedVersion,v.status.conversion.error);const m={meta:{...v.access,isNew:!1,isFolder:!1,uid:v.metadata.name,k8s:v.metadata,version:v.metadata.generation,created:v.metadata.creationTimestamp},dashboard:{...v.spec,version:v.metadata.generation,uid:v.metadata.name}},y=v.metadata.annotations??{},h=y[o.LH];if(h&&(m.meta.provisioned=y[o.Ms]==="true"||h===o.Sf.Repo,m.meta.provisionedExternalId=y[o.Y_]),v.metadata.labels?.[o.Y5]&&(m.dashboard.id=parseInt(v.metadata.labels[o.Y5],10)),v.metadata.annotations?.[o.ew])try{const d=await s.IB.getFolderByUid(v.metadata.annotations[o.ew]);m.meta.folderTitle=d.title,m.meta.folderUrl=d.url,m.meta.folderUid=d.uid,m.meta.folderId=d.id}catch{throw new Error("Failed to load folder")}return m}catch(v){const m=(0,i.do)(v);throw(0,i.q6)(v).includes("not found")&&m!==404&&(v.status=404,v.data.message="Dashboard not found"),v}}async listDeletedDashboards(x){return await this.client.list({...x,labelSelector:"grafana.app/get-trash=true"})}restoreDashboard(x){return x.metadata.resourceVersion="",this.client.create(x)}}},99828:(te,R,e)=>{"use strict";e.d(R,{L:()=>c,P:()=>p});var n=e(92138),a=e(92745),s=e(83873),i=e(47797),r=e(77197),u=e(54115),o=e(75735),l=e(52043),g=e(95407),f=e(60171);const p={group:"dashboard.grafana.app",version:"v2alpha1",resource:"dashboards"};class c{constructor(){this.client=new u.ws(p)}async getDashboardDTO(v){try{const m=await this.client.subresource(v,"dto");if(!(0,f.aK)(m.spec)&&m.status?.conversion?.failed&&(m.status.conversion.storedVersion==="v1alpha1"||m.status.conversion.storedVersion==="v1beta1"||m.status.conversion.storedVersion==="v0alpha1"))throw new g.P(m.status.conversion.storedVersion,m.status.conversion.error);if(m.metadata.annotations&&m.metadata.annotations[o.ew])try{const y=await s.IB.getFolderByUid(m.metadata.annotations[o.ew]);m.metadata.annotations[o.w2]=y.title,m.metadata.annotations[o.D1]=y.url}catch{throw new Error("Failed to load folder")}else m.metadata.annotations&&!m.metadata.annotations[o.ew]&&(m.metadata.annotations[o.ew]="");return m}catch(m){const y=(0,i.do)(m);throw(0,i.q6)(m).includes("not found")&&y!==404&&(m.status=404,m.data.message="Dashboard not found"),m}}deleteDashboard(v,m){return this.client.delete(v,m).then(y=>({id:0,message:y.message,title:(0,a.t)("dashboard.k8s-dashboard-v2api.title.deleted","deleted")}))}async saveDashboard(v){const m=v.dashboard,y={metadata:{...v?.k8s},spec:{...m}};return v.message?y.metadata.annotations={...y.metadata.annotations,[o.fY]:v.message}:y.metadata.annotations&&delete y.metadata.annotations[o.fY],v.folderUid&&(delete y.metadata.annotations?.[o.w2],delete y.metadata.annotations?.[o.D1],y.metadata.annotations={...y.metadata.annotations,[o.ew]:v.folderUid}),y.metadata.name?(delete y.metadata.resourceVersion,this.client.update(y).then(h=>this.asSaveDashboardResponseDTO(h))):(y.metadata.annotations={...y.metadata.annotations,[o.AI]:"default"},await this.client.create(y).then(h=>this.asSaveDashboardResponseDTO(h)))}asSaveDashboardResponseDTO(v){const m=n.I.assureBaseUrl((0,l.u)({uid:v.metadata.name,currentQueryParams:"",slug:r.A.slugifyForUrl(v.spec.title.trim())}));let y=0;return v.metadata.labels?.[o.Y5]&&(y=parseInt(v.metadata.labels[o.Y5],10)),{uid:v.metadata.name,version:v.metadata.generation??0,id:y,status:"success",url:m,slug:""}}listDeletedDashboards(v){return this.client.list({...v,labelSelector:"grafana.app/get-trash=true"})}restoreDashboard(v){return v.metadata.resourceVersion="",this.client.create(v)}}},25157:(te,R,e)=>{"use strict";e.d(R,{fP:()=>de,Ay:()=>ae});var n=e(74848),a=e(96540),s=e(22803),i=e(71468),r=e(54148),u=e(63704),o=e(92745),l=e(36490),g=e(79104),f=e(71599),p=e(93256),c=e(7895),x=e(8515),v=e(36219),m=e(6890),y=e(43707),h=e(5423),d=e(65642),E=e(64762),b=e(73427),D=e(94232),C=e(38206),P=e(43550),M=e(51898),O=e(88559),j=e(45861),U=e(30703),W=e(87063),B=e(77731),S=e(23289),_=e(52763),K=e(37918);const L=({dashboard:ie})=>{const ve=(0,a.useMemo)(()=>(0,B._u)(),[]),le=(0,_.wA)(),Ee=(0,_.d4)(Re=>Re.dashboard.initialDatasource);return(0,n.jsxs)(W.W,{children:[(0,n.jsx)(W.W.Item,{testId:M.Tp.pages.AddDashboard.itemButton("Add new visualization menu item"),label:(0,o.t)("dashboard.add-menu.visualization","Visualization"),onClick:()=>{const Re=(0,B.OK)(ie,Ee);S.c.toolbarAddButtonClicked({item:"add_visualization"}),l.Ny.partial({editPanel:Re}),le((0,K.Ub)(void 0))}},"add-visualisation"),(0,n.jsx)(W.W.Item,{testId:M.Tp.pages.AddDashboard.itemButton("Add new row menu item"),label:(0,o.t)("dashboard.add-menu.row","Row"),onClick:()=>{S.c.toolbarAddButtonClicked({item:"add_row"}),(0,B.SD)(ie)}},"add-row"),(0,n.jsx)(W.W.Item,{testId:M.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),label:(0,o.t)("dashboard.add-menu.import","Import from library"),onClick:()=>{S.c.toolbarAddButtonClicked({item:"import_from_library"}),(0,B.s3)(ie)}},"add-panel-lib"),(0,n.jsx)(W.W.Item,{testId:M.Tp.pages.AddDashboard.itemButton("Add new panel from clipboard menu item"),label:(0,o.t)("dashboard.add-menu.paste-panel","Paste panel"),onClick:()=>{S.c.toolbarAddButtonClicked({item:"paste_panel"}),(0,B.no)(ie,ve)},disabled:!ve},"add-panel-clipboard")]})},N=({dashboard:ie,onToolbarAddMenuOpen:ve})=>{const[le,Ee]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{le&&ve&&ve()},[le,ve]),(0,n.jsx)(O.m,{overlay:()=>(0,n.jsx)(L,{dashboard:ie}),placement:"bottom",offset:[0,6],onVisibleChange:Ee,children:(0,n.jsxs)(j.$n,{variant:"secondary",size:"sm",fill:"outline","data-testid":M.Tp.components.PageToolbar.itemButton("Add button"),children:[(0,n.jsx)(o.x6,{i18nKey:"dashboard.toolbar.add",children:"Add"}),(0,n.jsx)(U.I,{name:le?"angle-up":"angle-down",size:"lg"})]})})};var V=e(37010),z=e(22429),w=e(98036),H=e(4590),Q=e(69289),Z=e(87745),Y=e(75541),X=e(34339),I=e(74618),J=e(58662);const ee=({dashboard:ie})=>(0,n.jsx)(j.$n,{"data-testid":M.Tp.pages.Dashboard.DashNav.shareButton,variant:"primary",size:"sm",onClick:()=>{S.c.toolbarShareClick(),l.Ny.partial({shareView:J.wr.link})},children:(0,n.jsx)(o.x6,{i18nKey:"dashboard.toolbar.share-button",children:"Share"})}),q={removeNavIndex:P.Im,setStarred:C.ci,updateTimeZoneForSession:Q.Cj,updateNavIndex:m.Vz},ne=ie=>({navIndex:ie.navIndex}),se=(0,i.connect)(ne,q);function oe(ie){registerDynamicDashNavAction("left",ie)}function de(ie){(0,Y.Y)("right",ie)}const fe=(0,a.memo)(ie=>{(0,r.zy)();const ve=(0,g.C)();(0,D.u)(ie.dashboard.events,Z.Cf);const le=ie.dashboard.snapshot?.originalUrl??"",Ee=()=>{window.location.href=u.sQ.sanitizeUrl(ie.dashboard.snapshot.originalUrl)},Re=(0,E._2)(),Oe=()=>{try{const Ue=new URL(u.sQ.sanitizeUrl(le),d.Ay.appUrl),we=new URL(d.Ay.appUrl);Ue.host!==we.host?b.lE.publish(new Z.S8({component:f.u,props:{title:(0,o.t)("dashboard.dash-nav.on-open-snapshot-original.title.proceed-to-external-site","Proceed to external site?"),modalClass:ce,body:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{children:["This link connects to an external website at"," ",(0,n.jsx)("code",{children:le})]}),(0,n.jsx)("p",{children:"Are you sure you'd like to proceed?"})]}),confirmVariant:"primary",confirmText:(0,o.t)("dashboard.dash-nav.on-open-snapshot-original.confirmText.proceed","Proceed"),onConfirm:Ee}})):Ee()}catch(Ue){Re.error("Invalid URL",Ue instanceof Error?Ue.message:void 0)}},Se=()=>{S.c.toolbarFavoritesClick();const Ue=(0,z.UA)(),{dashboard:we,navIndex:Xe,removeNavIndex:nt,setStarred:he,updateNavIndex:xe}=ie;Ue.starDashboard(we.uid,!!we.meta.isStarred).then(me=>{he({id:we.uid,title:we.title,url:we.meta.url??"",isStarred:me});const ye=Xe.starred;if(me)ye.children?.push({id:C.L1+we.uid,text:we.title,url:we.meta.url??"",parentItem:ye});else{nt(C.L1+we.uid);const De=ye.children?.findIndex(Le=>Le.id===C.L1+we.uid);De&&ye.children?.splice(De,1)}xe(ye),we.meta.isStarred=me,ve()})},Te=()=>{S.c.toolbarSettingsClick(),l.Ny.partial({editview:"settings"})},_e=()=>{H._o.prev()},He=()=>{H._o.next()},tt=()=>{H._o.stop(),ve()},Je=(Ue,we)=>{Ue.map((Xe,nt)=>{const he=Xe.component,xe=(0,a.createElement)(he,{...ie,key:`button-custom-${nt}`});typeof Xe.index=="number"?we.splice(Xe.index,0,xe):we.push(xe)})},Ge=()=>H._o.state.isPlaying,je=()=>{const Ue=d.Ay.buildInfo.env==="development",{dashboard:we,kioskMode:Xe}=ie,{canStar:nt,isStarred:he}=we.meta,xe=[];if(Xe||Ge())return[];if(nt){let me=he?(0,o.t)("dashboard.toolbar.unmark-favorite","Unmark as favorite"):(0,o.t)("dashboard.toolbar.mark-favorite","Mark as favorite");xe.push((0,n.jsx)(X._,{tooltip:me,icon:he?"favorite":"star",iconType:he?"mono":"default",iconSize:"lg",onClick:Se},"button-star"))}return we.uid&&xe.push((0,n.jsx)(w.u,{uid:we.uid},"public-dashboard-badge")),Ue&&d.Ay.featureToggles.dashboardScene&&xe.push((0,n.jsx)(X._,{tooltip:(0,o.t)("dashboard.dash-nav.render-left-actions.tooltip-view-as-scene","View as Scene"),icon:"apps",onClick:()=>{l.Ny.partial({scenes:!0})}},"button-scenes")),Je(Y.C.left,xe),xe},Fe=()=>(0,n.jsxs)(p.e,{children:[(0,n.jsx)(c.I,{tooltip:(0,o.t)("dashboard.toolbar.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:_e,narrow:!0}),(0,n.jsx)(c.I,{onClick:tt,children:(0,n.jsx)(o.x6,{i18nKey:"dashboard.toolbar.playlist-stop",children:"Stop playlist"})}),(0,n.jsx)(c.I,{tooltip:(0,o.t)("dashboard.toolbar.playlist-next","Go to next dashboard"),icon:"forward",onClick:He,narrow:!0})]},"playlist-buttons"),Be=()=>{const{dashboard:Ue,updateTimeZoneForSession:we,hideTimePicker:Xe}=ie;return Xe?null:(0,n.jsx)(I.$,{dashboard:Ue,onChangeTimeZone:we},"time-controls")},Ke=()=>{const{dashboard:Ue,isFullscreen:we,hideTimePicker:Xe}=ie,{canSave:nt,canEdit:he,showSettings:xe,canShare:me}=Ue.meta,{snapshot:ye}=Ue,De=ye&&ye.originalUrl,Le=[];return Ge()?[Fe(),Be()]:(De&&Le.push((0,n.jsx)(c.I,{tooltip:(0,o.t)("dashboard.toolbar.open-original","Open original dashboard"),onClick:Oe,icon:"link"},"button-snapshot")),nt&&!we&&Le.push((0,n.jsx)(x.$s,{children:({showModal:Ve,hideModal:ze})=>(0,n.jsx)(c.I,{tooltip:(0,o.t)("dashboard.toolbar.save","Save dashboard"),icon:"save",onClick:()=>{Ve(V.$,{dashboard:Ue,onDismiss:ze})}})},"button-save")),Je(Y.C.right,Le),xe&&Le.push((0,n.jsx)(c.I,{tooltip:(0,o.t)("dashboard.toolbar.settings","Dashboard settings"),icon:"cog",onClick:Te},"button-settings")),he&&!we&&Le.push((0,n.jsx)(N,{onToolbarAddMenuOpen:S.c.toolbarAddClick,dashboard:Ue},"panel-add-dropdown")),me&&Le.push((0,n.jsx)(ee,{dashboard:Ue},"button-share")),Xe||Le.push((0,n.jsx)(h.K,{},"toolbar-separator")),Le.push(Be()),Le)};return(0,n.jsx)(y.H,{actions:(0,n.jsxs)(n.Fragment,{children:[je(),(0,n.jsx)(h.K,{leftActionsSeparator:!0}),(0,n.jsx)(v.U,{alignment:"right",children:Ke()})]})})});fe.displayName="DashNav";const ae=se(fe),ce=(0,s.css)({width:"max-content",maxWidth:"80vw"})},34339:(te,R,e)=>{"use strict";e.d(R,{_:()=>r});var n=e(74848),a=e(22803),s=e(63142),i=e(76319);const r=({icon:o,iconType:l,iconSize:g,tooltip:f,onClick:p,children:c})=>{const x=(0,s.of)(u);return(0,n.jsxs)("div",{className:x.noBorderContainer,children:[o&&(0,n.jsx)(i.K,{name:o,size:g,iconType:l,tooltip:f,tooltipPlacement:"bottom",onClick:p}),c]})},u=o=>({noBorderContainer:(0,a.css)({padding:`0 ${o.spacing(.5)}`,display:"flex"})})},74618:(te,R,e)=>{"use strict";e.d(R,{$:()=>x});var n=e(74848),a=e(96540),s=e(33239),i=e(92745),r=e(75234),u=e(90811),o=e(5857),l=e(51158),g=e(73427),f=e(15130),p=e(75421),c=e(87745);class x extends a.Component{constructor(){super(...arguments),this.onChangeRefreshInterval=m=>{(0,p.jG)().setAutoRefresh(m),this.forceUpdate()},this.onRefresh=()=>((0,p.jG)().refreshTimeModel(),Promise.resolve()),this.onMoveBack=()=>{g.lE.publish(new c.Io({direction:c.xL.Left}))},this.onMoveForward=()=>{g.lE.publish(new c.Io({direction:c.xL.Right}))},this.onChangeTimePicker=m=>{const{dashboard:y}=this.props,h=y.timepicker,d=h.nowDelay&&m.raw.to==="now",E=s.isMathString(m.raw.from)?m.raw.from:m.from,b=s.isMathString(m.raw.to)?m.raw.to:m.to,D={from:E,to:d?"now-"+h.nowDelay:b};(0,p.jG)().setTime(D)},this.onChangeTimeZone=m=>{this.props.dashboard.timezone=m,this.props.onChangeTimeZone(m),this.onRefresh()},this.onChangeFiscalYearStartMonth=m=>{this.props.dashboard.fiscalYearStartMonth=m,this.onRefresh()},this.onZoom=()=>{this.props.onToolbarZoomClick&&this.props.onToolbarZoomClick(),g.lE.publish(new c.U0({scale:2}))},this.onRefreshClick=()=>{this.props.onToolbarRefreshClick&&this.props.onToolbarRefreshClick(),this.onRefresh()}}componentDidMount(){this.sub=this.props.dashboard.events.subscribe(r.sR,()=>this.forceUpdate())}componentWillUnmount(){this.sub?.unsubscribe()}render(){const{dashboard:m,isOnCanvas:y}=this.props,{quick_ranges:h,refresh_intervals:d}=m.timepicker,E=(0,p.jG)().getValidIntervals(d||u.cb),b=(0,p.jG)().timeRange(),D=m.getTimezone(),C=m.fiscalYearStartMonth,P=m.panelInEdit?.isEditing,M=m.weekStart;let O;return m.refresh===f.SM&&(O=(0,p.jG)().getAutoRefreshInteval().interval),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.mR,{value:b,onChange:this.onChangeTimePicker,timeZone:D,fiscalYearStartMonth:C,onMoveBackward:this.onMoveBack,onMoveForward:this.onMoveForward,onZoom:this.onZoom,onChangeTimeZone:this.onChangeTimeZone,onChangeFiscalYearStartMonth:this.onChangeFiscalYearStartMonth,isOnCanvas:y,onToolbarTimePickerClick:this.props.onToolbarTimePickerClick,weekStart:(0,o.rE)(M)?M:void 0,quickRanges:h}),(0,n.jsx)(u.cC,{onIntervalChanged:this.onChangeRefreshInterval,onRefresh:this.onRefreshClick,value:m.refresh,intervals:E,isOnCanvas:y,tooltip:(0,i.t)("dashboard.toolbar.refresh","Refresh dashboard"),noIntervalPicker:P,showAutoInterval:!0,text:O})]})}}},39302:(te,R,e)=>{"use strict";e.d(R,{d:()=>r});var n=e(74848),a=e(22803),s=e(63142),i=e(45861);const r=({children:o,...l})=>{const g=(0,s.of)(u);return(0,n.jsx)("div",{className:g.buttonWrapper,children:(0,n.jsx)(i.$n,{icon:"plus",...l,children:o})})},u=o=>({buttonWrapper:(0,a.css)({padding:`${o.spacing(3)} 0`})})},56291:(te,R,e)=>{"use strict";e.d(R,{p:()=>d});var n=e(74848),a=e(2543),s=e(96540),i=e(17548),r=e(51898),u=e(92745),o=e(74475),l=e(37386),g=e(59310),f=e(5857),p=e(63527),c=e(21285),x=e(90811),v=e(75421);const m=({refreshIntervals:E,onRefreshIntervalChange:b,getIntervalsFunc:D=h,validateIntervalsFunc:C=y})=>{const[P,M]=(0,s.useState)(D(E??x.cb)),[O,j]=(0,s.useState)(null);(0,s.useEffect)(()=>{const S=D(E??x.cb);M(S)},[D,E]);const U=(0,s.useMemo)(()=>Array.isArray(P)?P.join(","):"",[P]),W=(0,s.useCallback)(S=>{const _=S.currentTarget.value?S.currentTarget.value.split(","):[];M(_)},[M]),B=(0,s.useCallback)(S=>{const _=C(P);_===null&&b(D(P)),j(_)},[D,P,b,C]);return(0,n.jsx)(l.D,{label:(0,u.t)("dashboard-settings.general.auto-refresh-label","Auto refresh"),description:(0,u.t)("dashboard-settings.general.auto-refresh-description","Define the auto refresh intervals that should be available in the auto refresh list. Use the format '5s' for seconds, '1m' for minutes, '1h' for hours, and '1d' for days (e.g.: '5s,10s,30s,1m,5m,15m,30m,1h,2h,1d')."),error:O,invalid:!!O,children:(0,n.jsx)(p.p,{id:"auto-refresh-input",invalid:!!O,value:U,onChange:W,onBlur:B})})},y=(E,b={getTimeSrv:v.jG})=>{try{return h(E,b),null}catch(D){return D instanceof Error?D.message:"Invalid intervals"}},h=(E,b={getTimeSrv:v.jG})=>{const D=E.filter(C=>C.trim()!=="").map(C=>C.replace(/\s+/g,""));return[...new Set(b.getTimeSrv().getValidIntervals(D))]};class d extends s.PureComponent{constructor(){super(...arguments),this.state={isNowDelayValid:!0},this.onNowDelayChange=b=>{const D=b.currentTarget.value;if((0,a.isEmpty)(D))return this.setState({isNowDelayValid:!0}),this.props.onNowDelayChange(D);if(i.isValidTimeSpan(D))return this.setState({isNowDelayValid:!0}),this.props.onNowDelayChange(D);this.setState({isNowDelayValid:!1})},this.onHideTimePickerChange=()=>{this.props.onHideTimePickerChange(!this.props.timePickerHidden)},this.onLiveNowChange=()=>{this.props.onLiveNowChange(!this.props.liveNow)},this.onTimeZoneChange=b=>{typeof b=="string"&&this.props.onTimeZoneChange(b)},this.onWeekStartChange=b=>{this.props.onWeekStartChange(b)}}render(){return(0,n.jsxs)(o.M,{label:(0,u.t)("dashboard-settings.time-picker.time-options-label","Time options"),isOpen:!0,children:[(0,n.jsx)(l.D,{label:(0,u.t)("dashboard-settings.time-picker.time-zone-label","Time zone"),"data-testid":r.Tp.components.TimeZonePicker.containerV2,children:(0,n.jsx)(g.U,{inputId:"time-options-input",includeInternal:!0,value:this.props.timezone,onChange:this.onTimeZoneChange,width:40})}),(0,n.jsx)(l.D,{label:(0,u.t)("dashboard-settings.time-picker.week-start-label","Week start"),"data-testid":r.Tp.components.WeekStartPicker.containerV2,children:(0,n.jsx)(f.l6,{inputId:"week-start-input",width:40,value:this.props.weekStart,onChange:this.onWeekStartChange})}),(0,n.jsx)(m,{refreshIntervals:this.props.refreshIntervals,onRefreshIntervalChange:this.props.onRefreshIntervalChange}),(0,n.jsx)(l.D,{label:(0,u.t)("dashboard-settings.time-picker.now-delay-label","Now delay"),description:(0,u.t)("dashboard-settings.time-picker.now-delay-description","Exclude recent data that may be incomplete."),children:(0,n.jsx)(p.p,{id:"now-delay-input",invalid:!this.state.isNowDelayValid,placeholder:"0m",onChange:this.onNowDelayChange,defaultValue:this.props.nowDelay})}),(0,n.jsx)(l.D,{label:(0,u.t)("dashboard-settings.time-picker.hide-time-picker","Hide time picker"),children:(0,n.jsx)(c.d,{id:"hide-time-picker-toggle",value:!!this.props.timePickerHidden,onChange:this.onHideTimePickerChange})}),(0,n.jsx)(l.D,{label:(0,u.t)("dashboard-settings.time-picker.refresh-live-dashboards-label","Refresh live dashboards"),description:(0,u.t)("dashboard-settings.time-picker.refresh-live-dashboards-description","Continuously update panels when the time range includes the current time"),children:(0,n.jsx)(c.d,{id:"refresh-live-dashboards-toggle",value:!!this.props.liveNow,onChange:this.onLiveNowChange})})]})}}},16200:(te,R,e)=>{"use strict";e.d(R,{n:()=>z,C:()=>V});var n=e(74848),a=e(22803),s=e(96540),i=e(63142),r=e(45861),u=e(66404),o=e(59243),l=e(68079),g=e(45967),f=e(92745),p=e(34999),c=e(41654),x=e(63527),v=e(30703),m=e(89640),y=e(76319);const h=({currentPage:H,numberOfPages:Q,onNavigate:Z,hideWhenSinglePage:Y,className:X})=>{const I=(0,i.of)(d);return Y&&Q<=1?null:(0,n.jsxs)("div",{className:(0,a.cx)(I.wrapper,X),children:[(0,n.jsx)(y.K,{name:"angle-left",size:"md",tooltip:(0,f.t)("dashboard.minimalistic-pagination.tooltip-previous","Previous"),onClick:()=>Z(H-1),disabled:H===1}),(0,n.jsxs)(f.x6,{i18nKey:"dashboard.minimalistic-pagination.page-count",children:[{currentPage:H}," of ",{numberOfPages:Q}]}),(0,n.jsx)(y.K,{name:"angle-right",size:"md",tooltip:(0,f.t)("dashboard.minimalistic-pagination.tooltip-next","Next"),onClick:()=>Z(H+1),disabled:H===Q})]})},d=H=>({wrapper:(0,a.css)({display:"flex",flexDirection:"row",gap:16,userSelect:"none"})}),E=({history:H,index:Q,onNavigate:Z})=>{const Y=(0,i.of)(b),X=H.length;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:Y.contentWrapper,children:(0,n.jsx)(u.E,{element:"p",color:"secondary",children:H[Q-1]})}),(0,n.jsx)(h,{currentPage:Q,numberOfPages:X,onNavigate:Z,hideWhenSinglePage:!1,className:Y.paginationWrapper})]})},b=H=>({paginationWrapper:(0,a.css)({display:"flex",flexDirection:"row",justifyContent:"flex-end",marginTop:15}),contentWrapper:(0,a.css)({display:"flex",flexBasis:"100%",flexGrow:3,whiteSpace:"pre-wrap",maxHeight:110,overflowY:"scroll",backgroundColor:H.colors.background.secondary,border:`1px solid ${H.colors.border.weak}`,padding:H.spacing(1),minHeight:60})});var D=e(66769);const C=({onSuggestionClick:H,isGenerating:Q})=>{const Z=(0,i.of)(P);return(0,n.jsxs)("div",{className:Z.quickSuggestionsWrapper,children:[(0,n.jsx)(r.$n,{onClick:()=>H(D.HG.Shorter),size:"sm",variant:"secondary",icon:"paragraph",disabled:Q,children:D.HG.Shorter}),(0,n.jsx)(r.$n,{onClick:()=>H(D.HG.MoreDescriptive),size:"sm",variant:"secondary",icon:"document-layout-left",disabled:Q,children:D.HG.MoreDescriptive}),(0,n.jsx)(r.$n,{onClick:()=>H(D.HG.Regenerate),icon:"sync",size:"sm",variant:"secondary",disabled:Q,children:"Regenerate"})]})},P=H=>({quickSuggestionsWrapper:(0,a.css)({display:"flex",flexDirection:"row",gap:8})});var M=e(16817),O=e(87056),j=e(25992),U=e(64762);const W=(0,j.DW)("features.dashboards.genai");var B=(H=>(H.IDLE="idle",H.GENERATING="generating",H.COMPLETED="completed",H))(B||{});const S=1e4,_={model:D.ys,temperature:1};function K({model:H,temperature:Q,onResponse:Z}=_){const[Y,X]=(0,s.useState)([]),[I,J]=(0,s.useState)(""),[ee,q]=(0,s.useState)("idle"),[ne,se]=(0,s.useState)(),{error:oe}=(0,U._2)();let de="";const fe=(0,s.useCallback)(Ee=>{q("idle"),X([]),se(Ee),oe("Failed to generate content using LLM","Please try again or if the problem persists, contact your organization admin."),console.error(Ee),W.logError(Ee,{messages:JSON.stringify(Y),model:H,temperature:String(Q)})},[Y,H,Q,oe]);(0,s.useEffect)(()=>{Y.length>0&&J("")},[Y]);const{error:ae,value:ce}=(0,M.A)(async()=>await(0,D.QX)(),[D.QX]),{error:ie,value:ve}=(0,M.A)(async()=>{if(!ce||!Y.length)return{enabled:ce};q("generating"),se(void 0);const Ee=O.qH({model:H,temperature:Q,messages:Y}).pipe(O.qA());return{enabled:ce,stream:Ee.subscribe({next:Re=>{de=Re},error:fe,complete:()=>{J(de),q("completed"),Z?.(de),X([]),se(void 0)}})}},[Y,ce]);(0,s.useEffect)(()=>()=>{ve?.stream?.unsubscribe()},[ve]);const le=(0,s.useCallback)(()=>{ve?.stream?.unsubscribe(),q("idle"),se(void 0),X([])},[ve]);return(0,s.useEffect)(()=>{let Ee;return ee==="generating"&&I===""&&(Ee=setTimeout(()=>{fe(new Error(`LLM stream timed out after ${S}ms`))},S)),()=>{clearTimeout(Ee)}},[ee,I,fe]),(ie||ae)&&se(ie||ae),{setMessages:X,stopGeneration:le,messages:Y,reply:I,streamStatus:ee,error:ne,value:ve}}var T=e(37680);const L=.5,A=({eventTrackingSrc:H,history:Q,messages:Z,onApplySuggestion:Y,updateHistory:X})=>{const I=(0,i.of)(N),[J,ee]=(0,s.useState)(1),[q,ne]=(0,s.useState)(""),se=(0,s.useCallback)(Ge=>{X((0,D.Kb)(Ge))},[X]),{setMessages:oe,stopGeneration:de,reply:fe,streamStatus:ae,error:ce}=K({model:D.ys,temperature:L,onResponse:se}),ie=(Ge,je)=>(0,T.XX)(H,Ge,je),ve=Ge=>{Oe(Ge),ie(T.KR.customFeedback,{customFeedback:Ge})},le=()=>{de(),fe&&se(fe)},Ee=()=>{Y(Q[J-1])},Re=Ge=>{ee(Ge),ie(Ge>J?T.KR.backHistoryItem:T.KR.forwardHistoryItem)},Oe=Ge=>{oe(je=>[...je,...(0,D.To)(Q[J-1],Ge)]),Ge in D.HG&&ie(T.KR.quickFeedback,{quickFeedbackItem:Ge})},Se=Ge=>Ge.key==="Enter"&&ve(q),Te=Ge=>ne(Ge.currentTarget.value),_e=()=>ve(q),He=()=>ie(T.KR.linkToDocs),tt=ae===B.GENERATING,Je=ce&&!tt;return(0,n.jsxs)("div",{className:I.container,children:[Je&&(0,n.jsx)(p.F,{title:"",children:(0,n.jsx)(c.B,{direction:"column",children:(0,n.jsx)("p",{children:(0,n.jsx)(f.x6,{i18nKey:"gen-ai.incomplete-request-error",children:"Sorry, I was unable to complete your request. Please try again."})})})}),(0,n.jsx)(E,{history:Q,index:J,onNavigate:Re}),(0,n.jsx)("div",{className:I.actionButtons,children:(0,n.jsx)(C,{onSuggestionClick:Oe,isGenerating:tt})}),(0,n.jsx)(x.p,{placeholder:(0,f.t)("dashboard.gen-aihistory.placeholder-tell-ai-what-to-do-next","Tell AI what to do next..."),suffix:(0,n.jsx)(r.$n,{icon:"enter",variant:"secondary",fill:"text","aria-label":(0,f.t)("dashboard.gen-aihistory.aria-label-send-custom-feedback","Send custom feedback"),onClick:_e,disabled:!q,children:(0,n.jsx)(f.x6,{i18nKey:"gen-ai.send-custom-feedback",children:"Send"})}),value:q,onChange:Te,onKeyDown:Se}),(0,n.jsx)("div",{className:I.applySuggestion,children:(0,n.jsx)(c.B,{justifyContent:"flex-end",direction:"row",children:tt?(0,n.jsx)(r.$n,{icon:"fa fa-spinner",onClick:le,children:V}):(0,n.jsx)(r.$n,{icon:"check",onClick:Ee,children:(0,n.jsx)(f.x6,{i18nKey:"gen-ai.apply-suggestion",children:"Apply"})})})}),(0,n.jsxs)("div",{className:I.footer,children:[(0,n.jsx)(v.I,{name:"exclamation-circle",className:I.infoColor}),(0,n.jsx)(u.E,{variant:"bodySmall",color:"secondary",children:(0,n.jsxs)(f.x6,{i18nKey:"dashboard.gen-aihistory.footer-text",children:["This content is AI-generated using the"," ",(0,n.jsx)(m.Y,{variant:"bodySmall",inline:!0,href:"https://grafana.com/docs/grafana-cloud/alerting-and-irm/machine-learning/llm-plugin/",external:!0,onClick:He,children:"Grafana LLM plugin"})]})})]})]})},N=H=>({container:(0,a.css)({display:"flex",flexDirection:"column",width:520,maxHeight:350,paddingBottom:25}),applySuggestion:(0,a.css)({paddingTop:H.spacing(2)}),actions:(0,a.css)({display:"flex",flexDirection:"row",flexWrap:"wrap"}),footer:(0,a.css)({position:"absolute",bottom:0,left:0,width:"100%",display:"flex",flexDirection:"row",margin:0,padding:H.spacing(1),paddingLeft:H.spacing(2),alignItems:"center",gap:H.spacing(1),borderTop:`1px solid ${H.colors.border.weak}`,marginTop:H.spacing(2)}),infoColor:(0,a.css)({color:H.colors.info.main}),actionButtons:(0,a.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",padding:"24px 0 8px 0"})}),V="Stop generating",z=({text:H="Auto-generate",toggleTipTitle:Q="",onClick:Z,model:Y=D.ys,messages:X,onGenerate:I,temperature:J=1,eventTrackingSrc:ee,disabled:q,tooltip:ne})=>{const se=(0,i.of)(w),[oe,de]=(0,s.useState)([]),fe=(0,s.useCallback)(nt=>{de(he=>[nt,...he])},[]),ae=(0,s.useCallback)(nt=>{const he=(0,D.Kb)(nt);I(he),fe(he)},[I,fe]),{setMessages:ce,stopGeneration:ie,value:ve,error:le,streamStatus:Ee}=K({model:Y,temperature:J,onResponse:ae}),[Re,Oe]=(0,s.useState)(!1),Se=oe.length>0,Te=!Se,_e=Ee===B.GENERATING,He=q||ve&&!ve.enabled&&!le,tt=(0,s.useCallback)(nt=>(0,T.XX)(ee,nt),[ee]),Je=le||ne?void 0:!1,Ge=le?"Failed to generate content using LLM. Please try again or if the problem persists, contact your organization admin.":ne||"",je=nt=>{Ee===B.GENERATING?ie():Se?Oe(!0):(Z?.(nt),ce(we()));const he=le?T.KR.erroredRetryButton:_e?T.KR.stopGenerationButton:Te?T.KR.autoGenerateButton:T.KR.improveButton;tt(he)};if(!ve?.enabled)return null;const Fe=nt=>{tt(T.KR.applySuggestion),I(nt),Oe(!1)},Be=()=>{if(!_e)return le||ve&&!ve.enabled?"exclamation-circle":"ai"},Ke=()=>{let nt=H;return le&&(nt="Retry"),_e&&(nt=V),Se&&(nt="Improve"),nt},Ue=(0,n.jsx)(r.$n,{icon:Be(),onClick:je,fill:"text",size:"sm",disabled:He,variant:le?"destructive":"primary",children:Ke()}),we=()=>typeof X=="function"?X():X,Xe=()=>{if(Se){const nt=(0,n.jsx)(u.E,{element:"p",children:Q});return(0,n.jsx)(o.G,{title:nt,content:(0,n.jsx)(A,{history:oe,messages:we(),onApplySuggestion:Fe,updateHistory:fe,eventTrackingSrc:ee}),placement:"left-start",fitContent:!0,show:Re,onClose:()=>Oe(!1),onOpen:()=>Oe(!0),children:Ue})}return Ue};return(0,n.jsxs)("div",{className:se.wrapper,children:[_e&&(0,n.jsx)(l.y,{size:"sm",className:se.spinner}),Te?(0,n.jsx)(g.m,{show:Je,interactive:!0,content:Ge,children:Ue}):Xe()]})},w=H=>({wrapper:(0,a.css)({display:"flex"}),spinner:(0,a.css)({color:H.colors.text.link})})},42357:(te,R,e)=>{"use strict";e.d(R,{V:()=>l});var n=e(74848),a=e(22429),s=e(16200),i=e(37680),r=e(66769);const o=`You are an expert in creating Grafana Dashboards.
Your goal is to write a descriptive and concise dashboard description.
You will be given the title and description of the dashboard's panels.
The dashboard description is meant to explain the purpose of the dashboard and what its panels show.
If the dashboard has no panels, the description should be "Empty dashboard"
There should be no numbers in the description except where they are important.
The dashboard description should not have the dashboard title or any quotation marks in it.
The description should be, at most, 300 characters.
Respond with only the description of the dashboard.`,l=({onGenerate:f})=>{const p=(0,a.UA)().getCurrent(),c=(0,r.N3)(p);return(0,n.jsx)(s.n,{messages:g(p),onGenerate:f,eventTrackingSrc:i.ec.dashboardDescription,toggleTipTitle:"Improve your dashboard description",disabled:c.length===0,tooltip:c.length===0?r.ZN:void 0})};function g(f){return[{content:o,role:r.Xh.system},{content:`The title of the dashboard is "${f.title}"
${(0,r.BB)(f)}`,role:r.Xh.user}]}},70969:(te,R,e)=>{"use strict";e.d(R,{Z:()=>l});var n=e(74848),a=e(22429),s=e(16200),i=e(37680),r=e(66769);const o=`You are an expert in creating Grafana Dashboards.
Your goal is to write a concise dashboard title.
You will be given the title and description of the dashboard's panels.
The dashboard title is meant to say what it shows on one line for users to navigate to it.
If the dashboard has no panels, the title should be "Empty dashboard"
There should be no numbers in the title.
The dashboard title should not have quotation marks in it.
The title should be, at most, 50 characters.
Respond with only the title of the dashboard.`,l=({onGenerate:f})=>{const p=(0,a.UA)().getCurrent(),c=(0,r.N3)(p);return(0,n.jsx)(s.n,{messages:g(p),onGenerate:f,eventTrackingSrc:i.ec.dashboardTitle,toggleTipTitle:"Improve your dashboard title",disabled:c.length===0,tooltip:c.length===0?r.ZN:void 0})};function g(f){return[{content:o,role:r.Xh.system},{content:`The panels in the dashboard are: ${(0,r.BB)(f)}`,role:r.Xh.user}]}},22055:(te,R,e)=>{"use strict";e.d(R,{t:()=>l});var n=e(74848),a=e(22429),s=e(16200),i=e(37680),r=e(66769);const o=`You are an expert in creating Grafana Panels.
You will be given the title and description of the dashboard the panel is in as well as the JSON for the panel.
Your goal is to write a descriptive and concise panel description.
The panel description is meant to explain the purpose of the panel, not just its attributes.
Do not refer to the panel; simply describe its purpose.
There should be no numbers in the description except for thresholds.
The description should be, at most, 200 characters.`,l=({onGenerate:f,panel:p})=>(0,n.jsx)(s.n,{messages:()=>g(p),onGenerate:f,eventTrackingSrc:i.ec.panelDescription,toggleTipTitle:"Improve your panel description"});function g(f){const p=(0,a.UA)().getCurrent(),c=(0,r.hn)(f);return[{content:o,role:r.Xh.system},{content:`The panel is part of a dashboard with the title: ${p.title}
The panel is part of a dashboard with the description: ${p.description}
This is the JSON which defines the panel: ${c}`,role:r.Xh.user}]}},76623:(te,R,e)=>{"use strict";e.d(R,{h:()=>o});var n=e(74848),a=e(16200),s=e(37680),i=e(66769);const u="You are an expert in creating Grafana Panels.Your goal is to write short, descriptive, and concise panel title.The title should be shorter than 50 characters.",o=({onGenerate:g,panel:f,dashboard:p})=>(0,n.jsx)(a.n,{messages:()=>l(f,p),onGenerate:g,eventTrackingSrc:s.ec.panelTitle,toggleTipTitle:"Improve your panel title"});function l(g,f){const p=(0,i.hn)(g);return[{content:u,role:i.Xh.system},{content:`The panel is part of a dashboard with the title: ${f.title}
The panel is part of a dashboard with the description: ${f.description}
Use this JSON object which defines the panel: ${p}`,role:i.Xh.user}]}},37680:(te,R,e)=>{"use strict";e.d(R,{KR:()=>i,XX:()=>r,ec:()=>s});var n=e(27489);const a="dashboards_autogenerate_clicked";var s=(u=>(u.panelDescription="panel-description",u.panelTitle="panel-title",u.dashboardChanges="dashboard-changes",u.dashboardTitle="dashboard-title",u.dashboardDescription="dashboard-description",u.unknown="unknown",u))(s||{}),i=(u=>(u.autoGenerateButton="auto-generate-button",u.erroredRetryButton="errored-retry-button",u.stopGenerationButton="stop-generating-button",u.improveButton="improve-button",u.backHistoryItem="back-history-item",u.forwardHistoryItem="forward-history-item",u.quickFeedback="quick-feedback",u.linkToDocs="link-to-docs",u.customFeedback="custom-feedback",u.applySuggestion="apply-suggestion",u))(i||{});function r(u,o,l){(0,n.rR)(a,{src:u,item:o,...l})}},66769:(te,R,e)=>{"use strict";e.d(R,{ZN:()=>j,ys:()=>d,HG:()=>h,Xh:()=>y,Yy:()=>b,BB:()=>M,To:()=>P,hn:()=>O,N3:()=>U,QX:()=>C,Kb:()=>E});var n=e(2543),a=e(87056),s=e(43173),i=e(77731),r=e(18795),u=e(7817);function o(B,S){return B===S?S:Array.isArray(B)&&Array.isArray(S)?f(B,S):l(B)&&l(S)?g(B,S):S}function l(B){return typeof B=="object"&&!Array.isArray(B)&&B!==null}function g(B,S){const _=Object.keys(B),K={};for(const T of _)S.hasOwnProperty(T)&&(Array.isArray(B[T])&&Array.isArray(S[T])||typeof B[T]=="object"&&typeof S[T]=="object"?K[T]=o(B[T],S[T]):K[T]=S[T]);return K}function f(B,S){const _=new Array(B.length).fill(void 0),K=new Set([...Array(B.length).keys()]),T=new Set([...Array(S.length).keys()]);for(let L=0;L<B.length&&T.size!==0;L++){let A=B[L];for(let N=0;N<S.length;N++){if(!T.has(N))continue;let V=S[N];V=o(A,V),JSON.stringify(A)===JSON.stringify(V)&&(K.delete(L),T.delete(N),_[L]=V)}}return p(B,S,_,K,T),_.filter(L=>L!==void 0)}function p(B,S,_,K,T){let L={};T.forEach(N=>{let V=S[N];if(typeof V!="object"||Array.isArray(V)){_.push(V),T.delete(N);return}K.forEach(z=>{let w=B[z];if(typeof w!="object"||Array.isArray(w)){K.delete(z);return}let H=0;for(const Q in w){let Z=w[Q];if(!V.hasOwnProperty(Q))continue;let Y=V[Q];typeof Z!="string"&&typeof Z!="number"||typeof Z!=typeof Y||Z===Y&&(Q==="id"&&(H+=1e3),H++)}H!==0&&(L[H]===void 0&&(L[H]=[]),L[H].push([z,N]))})});const A=Object.keys(L).map(Number);A.sort((N,V)=>V-N);for(const N of A){let V=L[N];for(const z of V){const[w,H]=z;K.has(w)&&T.has(H)&&(_[w]=S[H],K.delete(w),T.delete(H))}}for(const N of T)_.push(S[N])}function c(B){const S=B.split(`
`);let _=B[0].startsWith("Index")?4:3,K=S.slice(0,_);const T=/("title"|Title|\{|\}|\[|\])/i;for(let L=_;L<S.length;L++){let A=S[L];(T.test(A)||A.startsWith("+")||A.startsWith("-"))&&K.push(A)}return K.join(`
`)+`
`}function x(B){if(B===null||B==="")return null;if(Array.isArray(B)){const _=B.map(K=>x(K)).filter(K=>K!==null);return _.length>0?_:null}if(typeof B!="object")return B;const S={};for(const _ in B){const K=x(B[_]);if(K!==null){if(Array.isArray(K)&&K.length===0||typeof K=="object"&&Object.keys(K).length===0)continue;S[_]=K}}return Object.keys(S).length>0?S:null}function v(B){return JSON.parse(JSON.stringify(B,null,2))}function m(B){let S=v(B.getOriginalDashboard()),_=v(new u.G(S).getSaveModelClone()),K=v(B.getSaveModelClone());_=x(o(S,_)),K=x(o(_,K)),S=x(S);let T=(0,r.ss)("Before migration changes","After migration changes",JSON.stringify(S,null,2),JSON.stringify(_,null,2),"","",{context:20}),L=(0,r.ss)("Before user changes","After user changes",JSON.stringify(_,null,2),JSON.stringify(K,null,2),"","",{context:20});return T=c(T),L=c(L),{migrationDiff:T,userDiff:L}}var y=(B=>(B.system="system",B.user="user",B))(y||{}),h=(B=>(B.Shorter="Even shorter",B.MoreDescriptive="More descriptive",B.Regenerate="Please, regenerate",B))(h||{});const d=a.Kx.LARGE,E=B=>B.replace(/^"|"$/g,"");function b(B){const{migrationDiff:S,userDiff:_}=m(B);return{userChanges:_,migrationChanges:S}}let D;async function C(){return s.$.apps["grafana-llm-app"]?D||(D=new Promise(B=>{a.vK().then(S=>{S.ok||(D=void 0),B(S.ok)})}),D):!1}const P=(B,S)=>[{role:"system",content:`Your previous response was: ${B}. The user has provided the following feedback: ${S}. Re-generate your response according to the provided feedback.`}];function M(B){const S=U(B);let _;if(S.length<=10)_=`The panels in the dashboard are:
${S.join(`
`)}`;else{const K=B.panels.filter(A=>A.description),T=B.panels.filter(A=>!A.description);let L;K.length>=10?L=K.slice(10).map(W).join(`
`):(L=K.map(W).join(`
`),L+=`
`,L+=T.slice(10-K.length).map(W).join("n")),_=`There are ${S.length} panels.
Due to space constraints, only the information for ten of them is presented.
These ten are not necessarily the first ten, but prioritized to those with descriptions.
The panels in the dashboard are:
${L}`}return _}function O(B){const S=["datasource","title","description","targets","type"],_={...(0,n.pick)(B,S),options:(0,n.pick)(B.options,["content"])};return JSON.stringify(_,null,2)}const j="To generate this content your dashboard must contain at least one panel with a valid title or description.";function U(B){return B.panels.filter(_=>_.title.length>0&&_.title!==i.LH||_.description&&_.description.length>0).map(W)}const W=(B,S)=>`- Panel ${S}
- Title: ${B.title}${B.description?`
- Description: ${B.description}`:""}`},98314:(te,R,e)=>{"use strict";e.d(R,{B6:()=>c,E_:()=>v,jD:()=>x});var n=e(2543),a=e.n(n),s=e(72985),i=e(77154),r=e(739),u=e(80011),o=e(28105),l=e(92745),g=e(43173),f=e(34273),p=e(8095);function c(E){const b=[];if(E?.series)for(const D of E.series)b.push((0,i.Nw)(D));if(E?.annotations)for(const D of E.annotations){const C=(0,i.Nw)(D);C.schema?.meta||(C.schema.meta={}),C.schema.meta.dataTopic=r.QR.Annotations,b.push(C)}return b}function x(E,b){const D=E.getSaveModel(),C={panelType:D.type,datasource:"??"},P=g.$.buildInfo.versionString;let M=`| Key | Value |
|--|--|
| Panel | ${C.panelType} @ ${D.pluginVersion??P} |
| Grafana | ${P} // ${g.$.buildInfo.edition} |
`;return b&&(M+="<details><summary>Panel debug snapshot dashboard</summary>\n\n```json\n"+b+"\n```\n</details>"),M}async function v(E,b,D){const C=E.getSaveModel(),P=(0,n.cloneDeep)(d),M={panelType:C.type,datasource:"??"},O=await(0,s._)(E.getQueryRunner().getData({withFieldConfig:!1,withTransforms:!1})),j=E.datasource,U=(0,f.W)(c(O),b),W=g.$.buildInfo.versionString,B=C?.targets??[],S=`<table width="100%">
    <tr>
      <th width="2%">Panel</th>
      <td >${M.panelType} @ ${C.pluginVersion??W}</td>
    </tr>
    <tr>
      <th>Queries</th>
      <td>${B.map(_=>{const K=_.datasource??j;return`${_.refId}[${K?.type}]`}).join(", ")}</td>
    </tr>
    ${m(C)}
    ${y(O,U)}
    ${h(O)}
    <tr>
      <th>Grafana</th>
      <td>${W} // ${g.$.buildInfo.edition}</td>
    </tr>
  </table>`.trim();if(P.panels[0]={...C,...P.panels[0],targets:[{refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:p.nj.Snapshot,snapshot:U}]},C.transformations?.length){const _=P.panels[P.panels.length-1];_.title=_.title+" (after transformations)";const K=(0,n.cloneDeep)(_);K.id=100,K.title="Data (before transformations)",K.gridPos.w=24,K.targets[0].withTransforms=!1,P.panels.push(K)}return O.annotations?.length&&P.panels.push({id:7,gridPos:{h:6,w:24,x:0,y:20},type:"table",title:(0,l.t)("dashboard.get-debug-dashboard.title.annotations","Annotations"),datasource:{type:"datasource",uid:"-- Dashboard --"},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,topic:r.QR.Annotations,refId:"A"}]}),P.panels[1].options.content=S,P.panels[2].options.content=JSON.stringify(C,null,2),P.title=`Debug: ${C.title} // ${(0,u.LE)(new Date)}`,P.tags=["debug",`debug-${M.panelType}`],P.time={from:D.from.toISOString(),to:D.to.toISOString()},P}function m(E){return E.transformations?`<tr>
      <th>Transform</th>
      <td>${E.transformations.map(b=>b.id).join(", ")}</td>
  </tr>`:""}function y(E,b){let D=E.series.length??0,C=0,P=0;for(const M of E.series)C+=M.fields.length,P+=M.length;return`<tr><th>Data</th><td>${E.state!==o.Gu.Done?E.state:""} ${D} frames, ${C} fields, ${P} rows </td></tr>`}function h(E){return E.annotations?.length?`<tr>
  <th>Annotations</th>
  <td>${E.annotations.map((b,D)=>`<span>${b.length}</span>`)}</td>
</tr>`:""}const d={panels:[{id:2,title:"Reproduced with embedded data",datasource:{type:"grafana",uid:"grafana"},gridPos:{h:13,w:15,x:0,y:0}},{gridPos:{h:7,w:9,x:15,y:0},id:5,options:{content:"...",mode:"html"},title:"Debug info",type:"text"},{id:6,title:"Original Panel JSON",type:"text",gridPos:{h:13,w:9,x:15,y:7},options:{content:"...",mode:"code",code:{language:"json",showLineNumbers:!0,showMiniMap:!0}}},{id:3,title:"Data from panel above",type:"table",datasource:{type:"datasource",uid:"-- Dashboard --"},gridPos:{h:7,w:15,x:0,y:13},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,refId:"A"}]}],schemaVersion:37}},14252:(te,R,e)=>{"use strict";e.d(R,{BN:()=>l,kx:()=>g,sd:()=>o});var n=e(96540),a=e(24705),s=e(92745),i=e(78282),r=e(26689),u=e(61215);const o=f=>(0,a.A)(async()=>l(f),[f]).value;async function l(f){const p=f?.request?.targets||[];if(f&&f.series&&p.length){for(const c of f.series)if(c.meta&&c.meta.custom){const x=await(0,i.l)().get(p[0].datasource);if(x&&x.components?.MetadataInspector)return x}}}const g=(f,p,c,x,v)=>(0,n.useMemo)(()=>{const m=[];return(0,u.$)(c)&&(m.push({label:(0,s.t)("dashboard.inspect.data-tab","Data"),value:r.q.Data}),m.push({label:(0,s.t)("dashboard.inspect.stats-tab","Stats"),value:r.q.Stats})),v&&m.push({label:(0,s.t)("dashboard.inspect.meta-tab","Meta data"),value:r.q.Meta}),m.push({label:(0,s.t)("dashboard.inspect.json-tab","JSON"),value:r.q.JSON}),x&&m.push({label:(0,s.t)("dashboard.inspect.error-tab","Error"),value:r.q.Error}),p.meta.canEdit&&(0,u.$)(c)&&m.push({label:(0,s.t)("dashboard.inspect.query-tab","Query"),value:r.q.Query}),m},[c,v,p,x])},74098:(te,R,e)=>{"use strict";e.d(R,{D:()=>v});var n=e(74848),a=e(22803),s=e(96540),i=e(78685),r=e(51898),u=e(72489),o=e(63142),l=e(45967),g=e(30703),f=e(45861),p=e(70958),c=e(42795);const x="showCategory",v=s.memo(({id:h,title:d,children:E,forceOpen:b,isOpenDefault:D=!0,renderTitle:C,className:P,itemsCount:M,isNested:O=!1,sandboxId:j,disabledText:U})=>{const[W,B]=(0,i.A)(y(h),{isExpanded:D}),S=b||(W?.isExpanded??D),[_,K]=(0,s.useState)(S),T=(0,s.useRef)(null),[L,A]=(0,p.s)(),N=L[x]===h;(0,s.useEffect)(()=>{(b||N)&&!_&&(K(!0),setTimeout(()=>{T.current?.scrollIntoView()},200))},[_,N,b]);const V=(0,s.useCallback)(()=>{A({[x]:_?void 0:h},!0),B({isExpanded:!_}),K(!_)},[A,_,h,B]);C||(C=function(Y){return Y||M===void 0||M===0?d:(0,n.jsxs)("span",{children:[d," ",(0,n.jsx)(u.p,{value:M})]})});const z=(0,o.of)(m),w=(0,a.cx)({[z.box]:!0,[z.boxNestedExpanded]:O&&_},P),H=(0,a.cx)(z.header,{[z.headerExpanded]:_,[z.headerNested]:O}),Q=(0,a.cx)(z.body,{[z.bodyNested]:O});return U?(0,n.jsx)("div",{className:w,"data-plugin-sandbox":j,"data-testid":r.Tp.components.OptionsGroup.group(h),ref:T,children:(0,n.jsx)(l.m,{content:U,children:(0,n.jsxs)("div",{className:H,children:[(0,n.jsx)("h6",{id:`button-${h}`,className:(0,a.cx)(z.title,z.titleDisabled),children:C(_)}),(0,n.jsx)(g.I,{size:"sm",name:"ban",className:z.disabledIcon})]})})}):(0,n.jsxs)("div",{className:w,"data-plugin-sandbox":j,"data-testid":r.Tp.components.OptionsGroup.group(h),ref:T,children:[(0,n.jsxs)("div",{className:H,onClick:V,children:[(0,n.jsx)("h6",{id:`button-${h}`,className:(0,a.cx)(z.title,_&&z.titleExpanded),children:C(_)}),(0,n.jsx)(f.$n,{"data-testid":r.Tp.components.OptionsGroup.toggle(h),type:"button",fill:"text",size:"md",variant:"secondary","aria-expanded":_,className:z.toggleButton,icon:_?"angle-up":"angle-down",onClick:V})]}),_&&(0,n.jsx)("div",{className:Q,id:h,"aria-labelledby":`button-${h}`,children:E})]})}),m=h=>({box:(0,a.css)({borderTop:`1px solid ${h.colors.border.weak}`}),boxNestedExpanded:(0,a.css)({marginBottom:h.spacing(2)}),title:(0,a.css)({flexGrow:1,overflow:"hidden",lineHeight:1.5,fontSize:"1rem",fontWeight:h.typography.fontWeightMedium,margin:0,color:h.colors.text.secondary}),titleExpanded:(0,a.css)({color:h.colors.text.primary}),header:(0,a.css)({display:"flex",alignItems:"center",padding:h.spacing(.5,1.5),color:h.colors.text.primary,fontWeight:h.typography.fontWeightMedium,cursor:"pointer","&:hover":{background:h.colors.emphasize(h.colors.background.primary,.03)}}),toggleButton:(0,a.css)({alignSelf:"baseline"}),headerExpanded:(0,a.css)({color:h.colors.text.primary}),headerNested:(0,a.css)({padding:h.spacing(.5,0,.5,0)}),body:(0,a.css)({padding:h.spacing(1,2,1,2)}),titleDisabled:(0,a.css)({color:h.colors.text.disabled,cursor:"not-allowed"}),disabledIcon:(0,a.css)({color:h.colors.text.disabled,marginRight:h.spacing(1)}),bodyNested:(0,a.css)({position:"relative",paddingRight:0,"&:before":{content:"''",position:"absolute",top:0,left:"1px",width:"1px",height:"100%",background:h.colors.border.weak}})}),y=h=>`${c.wi}.optionGroup[${h}]`},25797:(te,R,e)=>{"use strict";e.d(R,{C:()=>i});var n=e(74848),a=e(31286),s=e(74098);class i{constructor(u){this.props=u,this.items=[],this.categories=[]}addItem(u){return u.parent=this,this.items.push(u),this}addCategory(u){return u.props.isNested=!0,u.parent=this,this.categories.push(u),this}getCategory(u){let o=this.categories.find(l=>l.props.id===u);return o||(o=new i({title:u,id:u}),this.addCategory(o)),o}render(u){return this.props.customRender?this.props.customRender():this.props.title===""?(0,n.jsx)(a.a,{padding:2,paddingBottom:1,children:this.items.map(o=>o.render(u))},this.props.title):(0,n.jsxs)(s.D,{...this.props,children:[this.items.map(o=>o.render(u)),this.categories.map(o=>o.render(u))]},this.props.title)}}},51156:(te,R,e)=>{"use strict";e.d(R,{v:()=>c});var n=e(74848),a=e(22803),s=e(23257),i=e.n(s),r=e(51898),u=e(37386),o=e(72636),l=e(63142),g=e(45967);function f({overrides:d}){const E=(0,l.of)(p);return(0,n.jsx)("div",{className:E.wrapper,children:d.map((b,D)=>(0,n.jsx)(g.m,{content:b.tooltip,placement:"top",children:(0,n.jsx)("div",{"aria-label":b.description,className:E[b.type]})},D.toString()))})}const p=d=>{const E={width:8,height:8,borderRadius:d.shape.radius.circle,marginLeft:d.spacing(1),top:"-1px"};return{wrapper:(0,a.css)({display:"flex"}),rule:(0,a.css)({...E,position:"relative",backgroundColor:d.colors.primary.main}),data:(0,a.css)({...E,position:"relative",backgroundColor:d.colors.warning.main})}};class c{constructor(E){this.props=E}render(E){return(0,n.jsx)(x,{itemDescriptor:this,searchQuery:E},this.props.title)}useShowIf(){return this.props.useShowIf?this.props.useShowIf():this.props.showIf?this.props.showIf():!0}}function x({itemDescriptor:d,searchQuery:E}){const{title:b,description:D,id:C,render:P,skipField:M}=d.props,O=`${d.parent.props.id} ${b}`;return d.useShowIf()?M?P(d):(0,n.jsx)(u.D,{label:v(d,E),description:D,"aria-label":r.Tp.components.PanelEditor.OptionsPane.fieldLabel(O),htmlFor:C,children:P(d)},O):null}function v(d,E){const{title:b,description:D,overrides:C,id:P,addon:M}=d.props;if(!b)return null;if(!E)return d.parent.props.title===b&&!C?.length?null:(0,n.jsx)(y,{title:b,description:D,overrides:C,addon:M,htmlFor:P});const O=[];return d.parent.parent&&O.push(m(d.parent.parent.props.title,E)),d.parent.props.title!==b&&O.push(m(d.parent.props.title,E)),(0,n.jsxs)(o.J,{description:D&&m(D,E),category:O,htmlFor:P,children:[m(b,E),C&&C.length>0&&(0,n.jsx)(f,{overrides:C})]})}function m(d,E){return(0,n.jsx)(i(),{textToHighlight:d,searchWords:[E],highlightClassName:"search-fragment-highlight"})}function y({title:d,description:E,overrides:b,addon:D,htmlFor:C}){const P=(0,l.of)(h);return(0,n.jsxs)("div",{className:P.container,children:[(0,n.jsxs)(o.J,{description:E,htmlFor:C,children:[d,b&&b.length>0&&(0,n.jsx)(f,{overrides:b})]}),D]})}function h(d){return{container:(0,a.css)({display:"flex",justifyContent:"space-between"})}}},68373:(te,R,e)=>{"use strict";e.d(R,{gs:()=>A,Ff:()=>T,Po:()=>N});var n=e(74848),a=e(22803),s=e(96540),i=e(92745),r=e(63142),u=e(12737),o=e(77824),l=e(92807),g=e(75515),f=e(74098),p=e(25531),c=e(63527);const x=({panel:z,formatDate:w})=>{const H=(0,r.of)(v),Q=z.libraryPanel?.meta;return Q?(0,n.jsxs)("div",{className:H.info,children:[(0,n.jsx)("div",{className:H.libraryPanelInfo,children:(0,n.jsxs)(i.x6,{i18nKey:"library-panels.library-panel-info.usage-count",count:Q.connectedDashboards,children:["Used on ","{{count}}"," dashboards"]})}),(0,n.jsx)("div",{className:H.libraryPanelInfo,children:(0,n.jsxs)(i.x6,{i18nKey:"library-panels.library-panel-info.last-edited",values:{timeAgo:w?.(Q.updated,"L")??Q.updated},components:{person:(0,n.jsxs)(n.Fragment,{children:[Q.updatedBy.avatarUrl&&(0,n.jsx)("img",{width:"22",height:"22",className:H.userAvatar,src:Q.updatedBy.avatarUrl,alt:`Avatar for ${Q.updatedBy.name}`}),Q.updatedBy.name]})},children:["Last edited on ","{{timeAgo}}"," by","<person />"]})})]}):null},v=z=>({info:(0,a.css)({lineHeight:1}),libraryPanelInfo:(0,a.css)({color:z.colors.text.secondary,fontSize:z.typography.bodySmall.fontSize}),userAvatar:(0,a.css)({borderRadius:z.shape.radius.circle,boxSizing:"content-box",width:"22px",height:"22px",paddingLeft:z.spacing(1),paddingRight:z.spacing(1)})});var m=e(25797),y=e(51156);function h(z){const{panel:w,onPanelConfigChange:H,dashboard:Q}=z,Z=new m.C({title:(0,i.t)("dashboard.get-library-panel-options-category.descriptor.title.library-panel-options","Library panel options"),id:"Library panel options",isOpenDefault:!0});return(0,g.X)(w)&&Z.addItem(new y.v({title:(0,i.t)("dashboard.get-library-panel-options-category.title.name","Name"),value:w.libraryPanel.name,popularRank:1,render:function(){return(0,n.jsx)(c.p,{id:"LibraryPanelFrameName",defaultValue:w.libraryPanel.name,onBlur:X=>H("libraryPanel",{...w.libraryPanel,name:X.currentTarget.value})})}})).addItem(new y.v({title:(0,i.t)("dashboard.get-library-panel-options-category.title.information","Information"),render:function(){return(0,n.jsx)(x,{panel:w,formatDate:Q.formatDate})}})),Z}var d=e(51898),E=e(43173),b=e(87105),D=e(21285),C=e(96822),P=e(18857),M=e(82345),O=e(22055),j=e(76623),U=e(31819);function W(z){const{dashboard:w,panel:H,onPanelConfigChange:Q}=z,Z=new m.C({title:(0,i.t)("dashboard.get-panel-frame-category.descriptor.title.panel-options","Panel options"),id:"Panel options",isOpenDefault:!0}),Y=I=>{const J=document.getElementById("PanelFrameTitle");J instanceof HTMLInputElement&&(J.value=I,Q("title",I))},X=I=>{const J=document.getElementById("description-text-area");J instanceof HTMLTextAreaElement&&(J.value=I,Q("description",I))};return Z.addItem(new y.v({title:(0,i.t)("dashboard.get-panel-frame-category.title.title","Title"),id:"PanelFrameTitle",value:H.title,popularRank:1,render:function(J){return(0,n.jsx)(c.p,{"data-testid":d.Tp.components.PanelEditor.OptionsPane.fieldInput("Title"),id:J.props.id,defaultValue:H.title,onBlur:ee=>Q("title",ee.currentTarget.value)})},addon:E.$.featureToggles.dashgpt&&(0,n.jsx)(j.h,{onGenerate:Y,panel:H.getSaveModel(),dashboard:w.getSaveModelClone()})})).addItem(new y.v({title:(0,i.t)("dashboard.get-panel-frame-category.title.description","Description"),id:"description-text-area",description:H.description,value:H.description,render:function(J){return(0,n.jsx)(b.f,{"data-testid":d.Tp.components.PanelEditor.OptionsPane.fieldInput("Description"),id:J.props.id,defaultValue:H.description,onBlur:ee=>Q("description",ee.currentTarget.value)})},addon:E.$.featureToggles.dashgpt&&(0,n.jsx)(O.t,{onGenerate:X,panel:H.getSaveModel()})})).addItem(new y.v({title:(0,i.t)("dashboard.get-panel-frame-category.title.transparent-background","Transparent background"),id:"transparent-background",render:function(J){return(0,n.jsx)(D.d,{"data-testid":d.Tp.components.PanelEditor.OptionsPane.fieldInput("Transparent background"),value:H.transparent,id:J.props.id,onChange:ee=>Q("transparent",ee.currentTarget.checked)})}})).addCategory(new m.C({title:(0,i.t)("dashboard.get-panel-frame-category.title.panel-links","Panel links"),id:"Panel links",isOpenDefault:!1,itemsCount:H.links?.length}).addItem(new y.v({title:(0,i.t)("dashboard.get-panel-frame-category.title.panel-links","Panel links"),render:function(){return(0,n.jsx)(C.e,{links:H.links,onChange:J=>Q("links",J),getSuggestions:M.Fq,data:[]})}}))).addCategory(new m.C({title:(0,i.t)("dashboard.get-panel-frame-category.title.repeat-options","Repeat options"),id:"Repeat options",isOpenDefault:!1}).addItem(new y.v({title:(0,i.t)("dashboard.get-panel-frame-category.title.repeat-by-variable","Repeat by variable"),id:"repeat-by-variable-select",description:"Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard.",render:function(J){return(0,n.jsx)(U.G,{id:J.props.id,repeat:H.repeat,onChange:ee=>{Q("repeat",ee)}})}})).addItem(new y.v({title:(0,i.t)("dashboard.get-panel-frame-category.title.repeat-direction","Repeat direction"),showIf:()=>!!H.repeat,render:function(){const J=[{label:(0,i.t)("dashboard.get-panel-frame-category.direction-options.label.horizontal","Horizontal"),value:"h"},{label:(0,i.t)("dashboard.get-panel-frame-category.direction-options.label.vertical","Vertical"),value:"v"}];return(0,n.jsx)(o.z,{options:J,value:H.repeatDirection||"h",onChange:ee=>Q("repeatDirection",ee)})}})).addItem(new y.v({title:(0,i.t)("dashboard.get-panel-frame-category.title.max-per-row","Max per row"),showIf:()=>!!(H.repeat&&H.repeatDirection==="h"),render:function(){const J=[2,3,4,6,8,12].map(ee=>({label:ee.toString(),value:ee}));return(0,n.jsx)(P.l6,{options:J,value:H.maxPerRow,onChange:ee=>Q("maxPerRow",ee.value)})}})))}var B=e(56424);class S{constructor(w,H){this.categories=w,this.overrides=H}search(w){const H=new RegExp(w,"i"),Z=this.collectHits(this.categories,H,[]).sort(_).map(I=>I.item),X=this.collectHits(this.overrides,H,[]).sort(_).map(I=>I.item);return{optionHits:Z,overrideHits:this.buildOverrideHitCategories(X),totalCount:this.getAllOptionsCount(this.categories)}}collectHits(w,H,Q){for(const Z of w){const Y=H.test(Z.props.title);for(const X of Z.items){if(H.test(X.props.title||"")){Q.push({item:X,rank:1});continue}if(X.props.description&&H.test(X.props.description)){Q.push({item:X,rank:2});continue}Y&&Q.push({item:X,rank:3})}Z.categories.length>0&&this.collectHits(Z.categories,H,Q)}return Q}getAllOptionsCount(w){let H=0;for(const Q of w)H+=Q.items.length,Q.categories.length>0&&(H+=this.getAllOptionsCount(Q.categories));return H}buildOverrideHitCategories(w){const H={};for(const Q of w){let Z=H[Q.parent.props.title];Z||(Z=H[Q.parent.props.title]=new m.C(Q.parent.props),Z.addItem(Q.parent.items[0])),Z.items[0].props.title!==Q.props.title&&Z.addItem(Q)}return Object.values(H)}}function _(z,w){return z.rank-w.rank}function K(z){const w=[];for(const H of z)for(const Q of H.items)Q.props.title==="Unit"&&(Q.props.popularRank=2),Q.props.title==="Min"&&(Q.props.popularRank=3),Q.props.title==="Max"&&(Q.props.popularRank=4),Q.props.title==="Display name"&&(Q.props.popularRank=5),Q.props.popularRank&&w.push(Q);return w.sort((H,Q)=>H.props.popularRank-Q.props.popularRank)}const T=z=>{const{plugin:w,panel:H}=z,[Q,Z]=(0,s.useState)(""),[Y,X]=(0,s.useState)("All"),I=(0,r.of)(V),[J,ee,q]=(0,s.useMemo)(()=>[W(z),(0,B.Zm)(z),h(z)],[H.configRev,z.data,z.instanceState,Q]),ne=(0,s.useMemo)(()=>(0,p.v)(z.panel.fieldConfig,z.plugin.fieldConfigRegistry,z.data?.series??[],Q,z.onFieldConfigsChange),[H.configRev,z.data,z.instanceState,Q]),se=[],oe=Q.length>0,de=(0,s.useMemo)(L,[]),fe=(0,g.X)(H)?[q,J,...ee]:[J,...ee];if(oe)se.push(N(fe,ne,Q));else switch(Y){case"All":(0,g.X)(H)&&se.push(q.render()),se.push(J.render());for(const ce of ee)se.push(ce.render());for(const ce of ne)se.push(ce.render());break;case"Overrides":for(const ce of ne)se.push(ce.render());break;case"Recent":se.push((0,n.jsx)(f.D,{id:"Recent options",title:(0,i.t)("dashboard.options-pane-options.Recent options-title-recent-options","Recent options"),forceOpen:!0,children:K(fe).map(ce=>ce.render())},"Recent options"));break}const ae=!oe&&!w.fieldConfigRegistry.isEmpty();return(0,n.jsxs)("div",{className:I.wrapper,children:[(0,n.jsxs)("div",{className:I.formBox,children:[(0,n.jsx)("div",{className:I.formRow,children:(0,n.jsx)(u.Z,{width:0,value:Q,onChange:Z,placeholder:(0,i.t)("dashboard.options-pane-options.placeholder-search-options","Search options")})}),ae&&(0,n.jsx)("div",{className:I.formRow,children:(0,n.jsx)(o.z,{options:de,value:Y,fullWidth:!0,onChange:X})})]}),(0,n.jsx)(l.P,{children:(0,n.jsx)("div",{className:I.mainBox,children:se})})]})};function L(){return[{label:"All",value:"All"},{label:"Overrides",value:"Overrides"}]}var A=(z=>(z.All="All",z.Overrides="Overrides",z.Recent="Recent",z))(A||{});function N(z,w,H){const Q=new S(z,w),{optionHits:Z,totalCount:Y,overrideHits:X}=Q.search(H);return(0,n.jsxs)("div",{children:[(0,n.jsx)(f.D,{id:"Found options",title:(0,i.t)("dashboard.options-pane-options.title-matched","Matched {{count}}/{{totalCount}} options",{count:Z.length,totalCount:Y}),forceOpen:!0,children:Z.map(I=>I.render(H))},"Normal options"),X.map(I=>I.render(H))]},"search results")}const V=z=>({wrapper:(0,a.css)({height:"100%",display:"flex",flexDirection:"column",flex:"1 1 0",".search-fragment-highlight":{color:z.colors.warning.text,background:"transparent"}}),searchBox:(0,a.css)({display:"flex",flexDirection:"column",minHeight:0}),formRow:(0,a.css)({marginBottom:z.spacing(1)}),formBox:(0,a.css)({padding:z.spacing(1),background:z.colors.background.primary,border:`1px solid ${z.components.panel.borderColor}`,borderTopLeftRadius:z.shape.borderRadius(1.5),borderBottom:"none"}),closeButton:(0,a.css)({marginLeft:z.spacing(1)}),searchHits:(0,a.css)({padding:z.spacing(1,1,0,1)}),searchNotice:(0,a.css)({fontSize:z.typography.size.sm,color:z.colors.text.secondary,padding:z.spacing(1),textAlign:"center"}),mainBox:(0,a.css)({background:z.colors.background.primary,border:`1px solid ${z.components.panel.borderColor}`,borderTop:"none",flexGrow:1}),angularDeprecationWrapper:(0,a.css)({padding:z.spacing(1)})})},25531:(te,R,e)=>{"use strict";e.d(R,{v:()=>W});var n=e(74848),a=e(22803),s=e(2543),i=e(36638),r=e(83340),u=e(92745),o=e(63152),l=e(59695),g=e(63142),f=e(82345),p=e(96540),c=e(23257),x=e.n(c),v=e(32881),m=e(72636),y=e(72489),h=e(76319),d=e(37386),E=e(74098);const b=({property:K,context:T,registry:L,onChange:A,onRemove:N,isSystemOverride:V,searchQuery:z})=>{const w=(0,g.of)(D),H=L?.getIfExists(K.id),Q=(0,p.useId)();if(!H)return null;const Z=Array.isArray(K.value)||K.id===r.uo.Thresholds||K.id===r.uo.Links||K.id===r.uo.Mappings,Y=H.category?.filter(J=>J!==H.name);let X;const I=(J=!0,ee=!1)=>(q=!1)=>(0,n.jsxs)(v.Gy,{justify:"space-between",children:[(0,n.jsxs)(m.J,{category:Y,description:J?H.description:void 0,htmlFor:Q,children:[(0,n.jsx)(x(),{textToHighlight:H.name,searchWords:[z],highlightClassName:"search-fragment-highlight"}),!q&&ee&&H.getItemsCount&&(0,n.jsx)(y.p,{value:H.getItemsCount(K.value)})]}),!V&&(0,n.jsx)("div",{children:(0,n.jsx)(h.K,{name:"times",onClick:N,tooltip:(0,u.t)("dashboard.dynamic-config-value-editor.render-label.tooltip-remove-property","Remove property")})})]});return Z?X=(0,n.jsx)(E.D,{id:H.name,renderTitle:I(!1,!0),className:(0,a.css)({paddingLeft:0,paddingRight:0}),isNested:!0,isOpenDefault:K.value!==void 0,children:(0,n.jsx)(H.override,{value:K.value,onChange:J=>{A(J)},item:H,context:T})}):X=(0,n.jsx)("div",{children:(0,n.jsx)(d.D,{label:I()(),description:H.description,children:(0,n.jsx)(H.override,{value:K.value,onChange:J=>{A(J)},item:H,context:T,id:Q})})}),(0,n.jsx)("div",{className:(0,a.cx)(Z&&w.collapsibleOverrideEditor,!Z&&"dynamicConfigValueEditor--nonCollapsible"),children:X})},D=K=>({collapsibleOverrideEditor:(0,a.css)({label:"collapsibleOverrideEditor","& + .dynamicConfigValueEditor--nonCollapsible":{marginTop:K.spacing(1)}})});var C=e(25797),P=e(51156),M=e(45861),O=e(30703);const j=({isExpanded:K,registry:T,matcherUi:L,overrideName:A,override:N,onOverrideRemove:V})=>{const z=(0,g.of)(U),H=N.properties.map(Z=>T.getIfExists(Z.id)).filter(Z=>!!Z).map(Z=>Z?.name).join(", "),Q=L.optionsToLabel(N.matcher.options);return(0,n.jsxs)("div",{children:[(0,n.jsxs)(v.Gy,{justify:"space-between",children:[(0,n.jsx)("div",{children:A}),(0,n.jsx)(M.$n,{variant:"secondary",fill:"text",icon:"trash-alt",onClick:V,tooltip:(0,u.t)("dashboard.override-category-title.tooltip-remove-override","Remove override"),"aria-label":(0,u.t)("dashboard.override-category-title.aria-label-remove-override","Remove override")})]}),!K&&(0,n.jsx)("div",{className:z.overrideDetails,children:(0,n.jsxs)("div",{className:z.options,title:Q,children:[Q," ",(0,n.jsx)(O.I,{name:"angle-right"})," ",H]})})]})};j.displayName="OverrideTitle";const U=K=>({matcherUi:(0,a.css)({padding:K.spacing(1)}),propertyPickerWrapper:(0,a.css)({marginTop:K.spacing(2)}),overrideDetails:(0,a.css)({fontSize:K.typography.bodySmall.fontSize,color:K.colors.text.secondary,fontWeight:K.typography.fontWeightRegular}),options:(0,a.css)({overflow:"hidden",paddingRight:K.spacing(4)}),unknownLabel:(0,a.css)({marginBottom:0})});function W(K,T,L,A,N){const V=[],z=K;if(!T||T.isEmpty())return[];const w=(Y,X)=>{let I=(0,s.cloneDeep)(z.overrides);I[Y]=X,N({...z,overrides:I})},H=Y=>{let X=(0,s.cloneDeep)(z.overrides);X.splice(Y,1),N({...z,overrides:X})},Q=Y=>{const X=i.sJ.get(Y.value);X&&N({...z,overrides:[...z.overrides,{matcher:{id:X.id,options:X.defaultOptions},properties:[]}]})},Z={data:L,getSuggestions:Y=>(0,f.Hf)(L,Y),isOverride:!0};for(let Y=0;Y<z.overrides.length;Y++){const X=z.overrides[Y],I=(0,u.t)("dashboard.get-field-override-categories.override-name","Override {{overrideNum}}",{overrideNum:Y+1}),J=o.g.get(X.matcher.id),ee=B(T),q=(0,r.Ow)(X),ne=X.properties.length===0,se=new C.C({title:I,id:I,forceOpen:ne,renderTitle:function(ae){return(0,n.jsx)(j,{override:X,isExpanded:ae,registry:T,overrideName:I,matcherUi:J,onOverrideRemove:()=>H(Y)})}}),oe=fe=>{w(Y,{...X,matcher:{...X.matcher,options:fe}})},de=(fe,ae)=>{const ce=T.get(ae.value),ie={id:ce.id,value:ce.defaultValue},ve=fe.properties??[];ve.push(ie),w(Y,{...fe,properties:ve})};se.addItem(new P.v({title:J.name,render:function(){return(0,n.jsx)(J.component,{id:`${J.matcher.id}-${Y}`,matcher:J.matcher,data:L??[],options:X.matcher.options,onChange:oe})}}));for(let fe=0;fe<X.properties.length;fe++){const ae=X.properties[fe],ce=T.getIfExists(ae.id);if(!ce)continue;const ie=le=>{w(Y,{...X,properties:X.properties.map((Ee,Re)=>Re===fe?{...Ee,value:le}:Ee)})},ve=()=>{w(Y,{...X,properties:X.properties.filter((le,Ee)=>Ee!==fe)})};se.addItem(new P.v({title:ce.name,skipField:!0,render:function(){return(0,n.jsx)(b,{isSystemOverride:q,onChange:ie,onRemove:ve,property:ae,registry:T,context:Z,searchQuery:A},`${ae.id}/${fe}`)}}))}!q&&X.matcher.options&&se.addItem(new P.v({title:"----------",skipField:!0,render:function(){return(0,n.jsx)(l.i,{label:(0,u.t)("dashboard.get-field-override-categories.label-add-override-property","Add override property"),variant:"secondary",isFullWidth:!0,icon:"plus",menuPlacement:"auto",options:ee,onChange:ae=>de(X,ae)},"Add override property")}})),V.push(se)}return V.push(new C.C({title:(0,u.t)("dashboard.get-field-override-categories.title.add-button","add button"),id:"add button",customRender:function(){return(0,n.jsx)(S,{children:(0,n.jsx)(l.i,{icon:"plus",label:(0,u.t)("dashboard.get-field-override-categories.label-add-field-override","Add field override"),variant:"secondary",menuPlacement:"auto",isFullWidth:!0,size:"md",options:o.g.list().filter(X=>!X.excludeFromPicker).map(X=>({label:X.name,value:X.id,description:X.description})),onChange:X=>Q(X)})},"Add override")}})),V}function B(K){return K.list().filter(T=>!T.hideFromOverrides).map(T=>{let L=T.name;return T.category&&(L=[...T.category,T.name].join(" > ")),{label:L,value:T.id,description:T.description}})}function S({children:K}){const T=(0,g.of)(_);return(0,n.jsx)("div",{className:T,children:K})}function _(K){return(0,a.css)({borderTop:`1px solid ${K.colors.border.weak}`,padding:`${K.spacing(2)}`,display:"flex"})}},56424:(te,R,e)=>{"use strict";e.d(R,{g5:()=>C,tN:()=>b,Zm:()=>E,Z4:()=>D});var n=e(74848),a=e(2543),s=e(52205),i=e(92745),r=e(63527),u=e(22803),o=e(80011),l=e(63142);const g=({libraryPanel:P})=>{const M=(0,l.of)(f),O=P.useState(),j=O.$timeRange?.getTimeZone(),U=O._loadedPanel?.meta;return U?(0,n.jsxs)("div",{className:M.info,children:[(0,n.jsx)("div",{className:M.libraryPanelInfo,children:(0,n.jsxs)(i.x6,{i18nKey:"dashboard-scene.library-viz-panel-info.usage-count",count:U.connectedDashboards,children:["Used on ","{{count}}"," dashboards"]})}),(0,n.jsx)("div",{className:M.libraryPanelInfo,children:(0,n.jsxs)(i.x6,{i18nKey:"dashboard-scene.library-viz-panel-info.last-edited",values:{timeAgo:(0,o.LE)(U.updated,{format:"L",timeZone:j})},components:{person:(0,n.jsxs)(n.Fragment,{children:[U.updatedBy.avatarUrl&&(0,n.jsx)("img",{className:M.userAvatar,src:U.updatedBy.avatarUrl,alt:`Avatar for ${U.updatedBy.name}`}),U.updatedBy.name]})},children:["{{timeAgo}}"," by","<person />"]})})]}):null},f=P=>({info:(0,u.css)({lineHeight:1}),libraryPanelInfo:(0,u.css)({color:P.colors.text.secondary,fontSize:P.typography.bodySmall.fontSize}),userAvatar:(0,u.css)({borderRadius:P.shape.radius.circle,boxSizing:"content-box",width:"22px",height:"22px",paddingLeft:P.spacing(1),paddingRight:P.spacing(1)})});var p=e(82345),c=e(25797),x=e(51156);const v="Some data fields have this option pre-configured. Add a field override rule to override the pre-configured value.",m="An override rule exists for this property";function y(P,M,O){const j=[];if(O){for(const W of O)for(const B of W.fields)if((0,a.get)(B.config,P.path)!=null){j.push({type:"data",description:v,tooltip:v});break}}return M.overrides.some(W=>W.properties.some(B=>B.id===P.id))&&j.push({type:"rule",description:m,tooltip:m}),j}var h=e(61215);function d({data:P,replaceVariables:M,options:O,eventBus:j,instanceState:U}){const W=P?.series??[];return{data:W,replaceVariables:M,options:O,eventBus:j,getSuggestions:S=>(0,p.Hf)(W,S),instanceState:U,annotations:P?.annotations}}function E(P){const{plugin:M,panel:O,onPanelOptionsChanged:j,onFieldConfigsChange:U,data:W,dashboard:B,instanceState:S}=P,_=O.getOptions(),K=O.fieldConfig,T={},L=d({data:W,replaceVariables:O.replaceVariables,options:_,eventBus:B.events,instanceState:S}),A=V=>{const z=(V&&V[0])??`${M.meta.name}`,w=T[z];return w||(T[z]=new c.C({title:z,id:z,sandboxId:M.meta.id}))},N={getValue:V=>(0,a.get)(_,V),onChange:(V,z)=>{const w=(0,h.Sf)(_,V,z);j(w)}};C(M.getPanelOptionsSupplier(),N,A,L);for(const V of M.fieldConfigRegistry.list()){if(V.isCustom){if(V.showIf&&!V.showIf(K.defaults.custom,W?.series,W?.annotations))continue}else if(V.showIf&&!V.showIf(K.defaults,W?.series,W?.annotations))continue;if(V.hideFromDefaults)continue;const z=A(V.category),w=V.editor,H=K.defaults,Q=V.isCustom?H.custom?(0,a.get)(H.custom,V.path):void 0:(0,a.get)(H,V.path);V.getItemsCount&&(z.props.itemsCount=V.getItemsCount(Q)),z.addItem(new x.v({title:V.name,description:V.description,overrides:y(V,K,W?.series),render:function(){const Y=X=>{U((0,h.EQ)(K,V.path,X,V.isCustom))};return(0,n.jsx)(w,{value:Q,onChange:Y,item:V,context:L,id:V.id})}}))}return Object.values(T)}function b(P){const M=new c.C({title:(0,i.t)("dashboard.get-library-viz-panel-options-category.descriptor.title.library-panel-options","Library panel options"),id:"Library panel options",isOpenDefault:!0});return M.addItem(new x.v({title:(0,i.t)("dashboard.get-library-viz-panel-options-category.title.name","Name"),value:P,popularRank:1,render:function(){return(0,n.jsx)(r.p,{id:"LibraryPanelFrameName","data-testid":"library panel name input",defaultValue:P.state.name,onBlur:j=>P.setState({name:j.currentTarget.value})})}})).addItem(new x.v({title:(0,i.t)("dashboard.get-library-viz-panel-options-category.title.information","Information"),render:function(){return(0,n.jsx)(g,{libraryPanel:P})}})),M}function D(P){const{plugin:M,panel:O,data:j,eventBus:U,instanceState:W}=P,B={},S=A=>{const N=A?.[0]??M.meta.name,V=B[N];return V||(B[N]=new c.C({title:N,id:N,sandboxId:M.meta.id}))},_=O.state.options,K={getValue:A=>(0,a.get)(_,A),onChange:(A,N)=>{const V=(0,h.Sf)(_,A,N);O.onOptionsChange(V)}},T=d({data:j,replaceVariables:O.interpolate,options:_,eventBus:U,instanceState:W});C(M.getPanelOptionsSupplier(),K,S,T);const L=O.state.fieldConfig;for(const A of M.fieldConfigRegistry.list()){const N=A.showIf&&(A.isCustom?!A.showIf(L.defaults.custom,j?.series,j?.annotations):!A.showIf(L.defaults,j?.series,j?.annotations));if(A.hideFromDefaults||N)continue;const V=S(A.category),z=A.editor,w=L.defaults,H=A.isCustom?w.custom?(0,a.get)(w.custom,A.path):void 0:(0,a.get)(w,A.path);A.getItemsCount&&(V.props.itemsCount=A.getItemsCount(H)),V.addItem(new x.v({title:A.name,description:A.description,overrides:y(A,L,j?.series),render:function(){const Z=Y=>{O.onFieldConfigChange((0,h.EQ)(L,A.path,Y,A.isCustom),!0)};return(0,n.jsx)(z,{value:H,onChange:Z,item:A,context:T,id:A.id})}}))}return Object.values(B)}function C(P,M,O,j,U){const W=new s.pv;P(W,j);for(const B of W.getItems()){if(B.showIf&&!B.showIf(j.options,j.data,j.annotations))continue;let S=U;if(S?B.category?.[0]?.length&&(S=S.getCategory(B.category[0])):S=O(B.category),(0,s.iF)(B)){const K=B.getNestedValueAccess(M),T=K.getContext?K.getContext(j):{...j,options:M.getValue(B.path)};C(B.getBuilder(),K,O,T,S);continue}const _=B.editor;S.addItem(new x.v({title:B.name,description:B.description,render:function(){return(0,n.jsx)(_,{value:M.getValue(B.path),onChange:T=>{M.onChange(B.path,T)},item:B,context:j,id:B.id})}}))}}},42795:(te,R,e)=>{"use strict";e.d(R,{Ay:()=>E,GU:()=>p,MJ:()=>x,Ox:()=>v,eK:()=>y,fR:()=>m,kw:()=>h,wi:()=>o});var n=e(65307),a=e(28105),s=e(22592),i=e(29043),r=e(82612),u=e(62667);const o="grafana.dashboard.editor.ui",l={isPanelOptionsVisible:!0,rightPaneSize:400,topPaneSize:.45,mode:u.q5.Fill},g=()=>{const b=i.A.getObject(o,l);let D={...b};return typeof b.topPaneSize=="string"&&(D={...b,topPaneSize:parseFloat(b.topPaneSize)/100}),{getPanel:()=>new r.a9({}),getSourcePanel:()=>new r.a9({}),getData:()=>({state:a.Gu.NotStarted,series:[],timeRange:(0,s.E2)()}),initDone:!1,shouldDiscardChanges:!1,isOpen:!1,isVizPickerOpen:!1,tableViewEnabled:!1,ui:{...l,...D}}},f=(0,n.Z0)({name:"panelEditor",initialState:g(),reducers:{updateEditorInitState:(b,D)=>{b.getPanel=()=>D.payload.panel,b.getSourcePanel=()=>D.payload.sourcePanel,b.initDone=!0,b.isOpen=!0,b.shouldDiscardChanges=!1},setEditorPanelData:(b,D)=>{b.getData=()=>D.payload},setDiscardChanges:(b,D)=>{b.shouldDiscardChanges=D.payload},setPanelEditorUIState:(b,D)=>{b.ui={...b.ui,...D.payload},!b.ui.isPanelOptionsVisible&&b.isVizPickerOpen&&(b.isVizPickerOpen=!1)},toggleVizPicker:(b,D)=>{b.isVizPickerOpen=D.payload,b.isVizPickerOpen&&(b.ui.isPanelOptionsVisible=!0)},toggleTableView(b){b.tableViewEnabled=!b.tableViewEnabled},closeEditor:b=>{b.getPanel=()=>new r.a9({}),b.getSourcePanel=()=>new r.a9({}),b.isOpen=!1,b.initDone=!1,b.isVizPickerOpen=!1,b.tableViewEnabled=!1}}}),{updateEditorInitState:p,setEditorPanelData:c,setDiscardChanges:x,closeEditor:v,setPanelEditorUIState:m,toggleVizPicker:y,toggleTableView:h}=f.actions,E={panelEditor:f.reducer}},62667:(te,R,e)=>{"use strict";e.d(R,{M8:()=>n,Nt:()=>i,__:()=>u,q5:()=>a});var n=(o=>(o.Query="query",o.Transform="transform",o.Visualize="visualize",o.Alert="alert",o))(n||{}),a=(o=>(o[o.Fill=0]="Fill",o[o.Fit=1]="Fit",o[o.Exact=2]="Exact",o))(a||{}),s=(o=>(o[o.Off=0]="Off",o[o.Table=1]="Table",o))(s||{});const i=[{value:0,label:"Fill",description:"Use all available space"},{value:2,label:"Actual",description:"Make same size as on the dashboard"}],r=[{value:0,label:"Visualization",description:"Show using selected visualization"},{value:1,label:"Table",description:"Show raw data in table form"}];var u=(o=>(o[o.Visualizations=0]="Visualizations",o[o.LibraryPanels=1]="LibraryPanels",o[o.Suggestions=2]="Suggestions",o))(u||{})},61215:(te,R,e)=>{"use strict";e.d(R,{$:()=>u,A:()=>r,EQ:()=>o,Sf:()=>l});var n=e(2543),a=e.n(n),s=e(95943),i=e(62667);function r(g,f,p,c){if(g===i.q5.Fill)return{width:f,height:p};const x=8*6,y=(window.innerWidth-60-s.dU*4)/s.cV*c.gridPos.w,h=s.sD*c.gridPos.h+x,d=Math.min(f/y,p/h);return y<=f&&h<=p?{width:y,height:h}:{width:y*d,height:h*d}}function u(g){return g?.meta.skipDataQuery===!1}const o=(g,f,p,c)=>{let x={...g.defaults};const v=p==null||p==="";return c?x.custom?v?x.custom=(0,n.omit)(x.custom,f):x.custom=l(x.custom,f,p):v||(x.custom=l(x.custom,f,p)):v?x=(0,n.omit)(x,f):x=l(x,f,p),{...g,defaults:x}};function l(g,f,p){const c=Array.isArray(f)?f:f.split("."),x=c.shift();if(x.endsWith("]")){const m=x.lastIndexOf("["),y=+x.substring(m+1,x.length-1),h=x.substring(0,m);let d=g[h];const E=Array.isArray(d)?[...d]:[];return c.length&&(d=E[y],(d==null||typeof d!="object")&&(d={}),p=l(d,c,p)),E[y]=p,{...g,[h]:E}}if(!c.length)return{...g,[x]:p};let v=g[x];return(v==null||typeof v!="object")&&(v={}),{...g,[x]:l(v,c,p)}}},31819:(te,R,e)=>{"use strict";e.d(R,{G:()=>g,U:()=>f});var n=e(74848),a=e(96540),s=e(92745),i=e(36674),r=e(18857),u=e(43243),o=e(52763),l=e(93612);const g=({repeat:p,onChange:c,id:x})=>{const v=(0,o.d4)(h=>(0,l.SS)((0,l.y7)(h),h)),m=(0,a.useMemo)(()=>{const h=v.map(d=>({label:d.name,value:d.name}));return h.length===0&&h.unshift({label:(0,s.t)("dashboard.repeat-row-select.variable-options.label.no-template-variables-found","No template variables found"),value:null}),h.unshift({label:(0,s.t)("dashboard.repeat-row-select.variable-options.label.disable-repeating","Disable repeating"),value:null}),h},[v]),y=(0,a.useCallback)(h=>c(h.value),[c]);return(0,n.jsx)(r.l6,{inputId:x,value:p,onChange:y,options:m})},f=({sceneContext:p,repeat:c,id:x,onChange:v})=>{const y=(0,a.useMemo)(()=>i.jh.getVariables(p.getRoot()),[p]).useState().variables,h=(0,a.useMemo)(()=>{const b=y.map(D=>({label:D.state.name,value:D.state.name}));return b.unshift({label:(0,s.t)("dashboard.repeat-row-select2.variable-options.label.disable-repeating","Disable repeating"),value:""}),b},[y]),d=(0,a.useCallback)(b=>b&&v(b.value),[v]),E=!c&&h.length<=1;return(0,n.jsx)(u.G,{id:x,value:c,onChange:d,options:h,disabled:E,placeholder:E?(0,s.t)("dashboard.repeat-row-select2.variable-options.label.no-template-variables-found","No template variables found"):(0,s.t)("dashboard.repeat-row-select2.placeholder","Choose")})}},78159:(te,R,e)=>{"use strict";e.d(R,{C:()=>l,m:()=>g});var n=e(74848),a=e(51898),s=e(92745),i=e(27489),r=e(8515),u=e(45861),o=e(37010);const l=({dashboard:f,onSaveSuccess:p,size:c})=>(0,n.jsx)(r.$s,{children:({showModal:x,hideModal:v})=>(0,n.jsx)(u.$n,{size:c,onClick:()=>{x(o.$,{dashboard:f,onSaveSuccess:p,onDismiss:v})},"aria-label":a.Tp.pages.Dashboard.Settings.General.saveDashBoard,children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-dashboard-button.save-dashboard",children:"Save dashboard"})})}),g=({dashboard:f,onClick:p,onSaveSuccess:c,variant:x,size:v})=>(0,n.jsx)(r.$s,{children:({showModal:m,hideModal:y})=>(0,n.jsx)(u.$n,{size:v,onClick:()=>{(0,i.rR)("grafana_dashboard_save_as_clicked"),p?.(),m(o.$,{dashboard:f,onSaveSuccess:c,onDismiss:y,isCopy:!0})},variant:x,"aria-label":a.Tp.pages.Dashboard.Settings.General.saveAsDashBoard,children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-dashboard-as-button.save-as",children:"Save as"})})})},30906:(te,R,e)=>{"use strict";e.d(R,{l:()=>f});var n=e(74848),a=e(16817),s=e(92745),i=e(41654),r=e(31286),u=e(34999),o=e(68079),l=e(34753),g=e(1199);const f=({diff:p,oldValue:c,newValue:x,hasFolderChanges:v,oldFolder:m,newFolder:y,hasMigratedToV2:h})=>{const d=(0,a.A)(async()=>{const b=JSON.stringify(c??{},null,2),D=JSON.stringify(x??{},null,2);let C;const P=[];let M=0;if(p)for(const[O,j]of Object.entries(p)){const U=(0,n.jsx)(l.D,{diffs:j,title:O},O);O==="schemaVersion"?C=U:P.push(U),M+=j.length}return{schemaChange:C,diffs:P,count:M,showDiffs:M<15,jsonView:(0,n.jsx)(g.M,{oldValue:b,newValue:D})}},[p,c,x]),{value:E}=d;return(0,n.jsxs)(i.B,{direction:"column",gap:1,children:[h&&(0,n.jsx)(r.a,{paddingTop:1,children:(0,n.jsx)(u.F,{title:(0,s.t)("dashboard.save-dashboard-diff.title-because-dashboard-migrated-grafana-format","The diff is hard to read because the dashboard has been migrated to the new Grafana dashboard format"),severity:"info"})}),v&&(0,n.jsx)(l.D,{diffs:[{op:"replace",value:y,originalValue:m,path:[],startLineNumber:0,endLineNumber:0}],title:(0,s.t)("dashboard.save-dashboard-diff.title-folder","folder")},"folder"),(!E||!c)&&(0,n.jsx)(o.y,{}),E&&E.count>=1?(0,n.jsxs)(n.Fragment,{children:[!h&&E&&E.schemaChange&&E.schemaChange,E&&E.showDiffs&&E.diffs,(0,n.jsxs)(r.a,{paddingTop:1,children:[(0,n.jsx)("h4",{children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-dashboard-diff.full-json-diff",children:"Full JSON diff"})}),E.jsonView]})]}):(0,n.jsx)(r.a,{paddingTop:1,children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-dashboard-diff.no-changes-in-the-dashboard-json",children:"No changes in the dashboard JSON"})})]})}},37010:(te,R,e)=>{"use strict";e.d(R,{$:()=>Ue});var n=e(74848),a=e(96540),s=e(92745),i=e(68143),r=e(43173),u=e(8207),o=e(54314),l=e(60208),g=e(61371),f=e(22803),p=e(16817),c=e(63142),x=e(34999),v=e(83873);function m({dashboard:we}){const Xe=(0,c.of)(y),{loading:nt,value:he,error:xe}=(0,p.A)(async()=>{const ye=we.getSaveModelCloneOld();return v.IB.validateDashboard(ye).catch(Le=>{if(Le.status>=500)throw Le;return Le.data})},[we]);let me;if(nt)me=(0,n.jsx)(x.F,{severity:"info",title:(0,s.t)("dashboard.dashboard-validation.title-checking-dashboard-validity","Checking dashboard validity")});else if(he)he.isValid||(me=(0,n.jsxs)(x.F,{severity:"warning",title:(0,s.t)("dashboard.dashboard-validation.title-dashboard-failed-schema-validation","Dashboard failed schema validation"),children:[(0,n.jsx)("p",{children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.dashboard-validation.body-dashboard-failed-schema-validation",children:"Validation is provided for development purposes and should be safe to ignore. If you are a Grafana developer, consider checking and updating the dashboard schema"})}),(0,n.jsx)("div",{className:Xe.error,children:he.message})]}));else{const ye=xe?.message??"Unknown error";me=(0,n.jsx)(x.F,{severity:"info",title:(0,s.t)("dashboard.dashboard-validation.title-error-checking-dashboard-validity","Error checking dashboard validity"),children:(0,n.jsx)("p",{className:Xe.error,children:ye})})}return me?(0,n.jsx)("div",{className:Xe.root,children:me}):null}const y=we=>({root:(0,f.css)({marginTop:we.spacing(1)}),error:(0,f.css)({fontFamily:we.typography.fontFamilyMonospace,whiteSpace:"pre-wrap",overflowX:"auto",maxWidth:"100%"})}),h=m;var d=e(30906),E=e(71599),b=e(22787),D=e(45861),C=e(78159),P=e(2543),M=e(41053),O=e(92138),j=e(27489),U=e(36490),W=e(45229),B=e(64762),S=e(38206),_=e(18346),K=e(87745),T=e(52763),L=e(77731);const A=async(we,Xe,nt,he)=>{const xe=await he({dashboard:we,folderUid:Xe.folderUid??nt.meta.folderUid??we.meta?.folderUid,message:Xe.message,overwrite:Xe.overwrite,k8s:nt.meta.k8s});if("error"in xe)throw xe.error;return xe.data},N=(we=!1)=>{const Xe=(0,T.wA)(),nt=(0,B._2)(),[he]=(0,_.e8)(),[xe,me]=(0,M.A)(async(ye,De,Le)=>{try{const Ve=await A(ye,De,Le,he);Le.version=Ve.version,ye=(0,P.cloneDeep)(ye),ye.version=Ve.version,Le.clearUnsavedChanges(ye,De),W.A.publish(new K.Eu),nt.success((0,s.t)("dashboard.save-dashboard.message-dashboard-saved","Dashboard saved")),(0,L.ko)(Ve.uid),we?(0,j.rR)("grafana_dashboard_copied",{name:Le.title,url:Ve.url}):(0,j.rR)(`grafana_dashboard_${Le.id?"saved":"created"}`,{name:Le.title,url:Ve.url});const ze=U.Ny.getLocation().pathname,Ze=O.I.stripBaseFromUrl(Ve.url);return Ze!==ze&&Ve.url&&setTimeout(()=>U.Ny.replace(Ze)),Le.meta.isStarred&&Xe((0,S.TU)({id:Le.uid,title:Le.title,url:Ze})),Ve}catch(Ve){throw Ve instanceof Error&&nt.error(Ve.message??"Error saving dashboard"),Ve}},[Xe,nt]);return{state:xe,onDashboardSave:me}},V=({dashboard:we,dashboardSaveModel:Xe,error:nt,onDismiss:he,setErrorIsHandled:xe})=>{const{onDashboardSave:me}=N(),ye=r.$.featureToggles.restoreDashboards;return(0,n.jsxs)(n.Fragment,{children:[nt.data&&nt.data.status==="version-mismatch"&&(0,n.jsx)(E.u,{isOpen:!0,title:(0,s.t)("dashboard.save-dashboard-error-proxy.title-version-mismatch","Conflict"),body:(0,n.jsx)("div",{children:(0,n.jsxs)(s.x6,{i18nKey:"dashboard.save-dashboard-error-proxy.body-version-mismatch",children:["Someone else has updated this dashboard",(0,n.jsx)("br",{}),(0,n.jsx)("small",{children:"Would you still like to save this dashboard?"})]})}),confirmText:(0,s.t)("dashboard.save-dashboard-error-proxy.confirmText-save-and-overwrite","Save and overwrite"),onConfirm:async()=>{await me(Xe,{overwrite:!0},we),he()},onDismiss:he}),nt.data&&nt.data.status==="name-exists"&&(0,n.jsx)(n.Fragment,{children:ye?(0,n.jsxs)(b.a,{isOpen:!0,title:(0,s.t)("save-dashboards.name-exists.title","Dashboard name already exists"),onDismiss:he,children:[(0,n.jsx)("p",{children:(0,n.jsx)(s.x6,{i18nKey:"save-dashboards.name-exists.message-info",children:"A dashboard with the same name in the selected folder already exists, including recently deleted dashboards."})}),(0,n.jsx)("p",{children:(0,n.jsx)(s.x6,{i18nKey:"save-dashboards.name-exists.message-suggestion",children:"Please choose a different name or folder."})})]}):(0,n.jsx)(E.u,{isOpen:!0,title:(0,s.t)("dashboard.save-dashboard-error-proxy.title-name-exists","Conflict"),body:(0,n.jsx)("div",{children:(0,n.jsxs)(s.x6,{i18nKey:"dashboard.save-dashboard-error-proxy.body-name-exists",children:["A dashboard with the same name in selected folder already exists.",(0,n.jsx)("br",{}),(0,n.jsx)("small",{children:"Would you still like to save this dashboard?"})]})}),confirmText:(0,s.t)("dashboard.save-dashboard-error-proxy.confirmText-save-and-overwrite","Save and overwrite"),onConfirm:async()=>{await me(Xe,{overwrite:!0},we),he()},onDismiss:he})}),nt.data&&nt.data.status==="plugin-dashboard"&&(0,n.jsx)(z,{dashboard:we,onDismiss:()=>{xe(!0),he()}})]})},z=({onDismiss:we,dashboard:Xe})=>{const{onDashboardSave:nt}=N(),he=(0,c.of)(H);return(0,n.jsxs)(b.a,{className:he.modal,title:(0,s.t)("dashboard.confirm-plugin-dashboard-save-modal.title-plugin-dashboard","Plugin dashboard"),icon:"copy",isOpen:!0,onDismiss:we,children:[(0,n.jsx)("div",{className:he.modalText,children:(0,n.jsxs)(s.x6,{i18nKey:"dashboard.confirm-plugin-dashboard-save-modal.body-plugin-dashboard",children:["Your changes will be lost when you update the plugin.",(0,n.jsx)("br",{}),(0,n.jsxs)("small",{children:["Use ",(0,n.jsx)("strong",{children:"Save As"})," to create custom version."]})]})}),(0,n.jsxs)(b.a.ButtonRow,{children:[(0,n.jsx)(D.$n,{variant:"secondary",onClick:we,fill:"outline",children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.confirm-plugin-dashboard-save-modal.cancel",children:"Cancel"})}),(0,n.jsx)(C.m,{onClick:we,dashboard:Xe,onSaveSuccess:we}),(0,n.jsx)(D.$n,{variant:"destructive",onClick:async()=>{await nt(Xe.getSaveModelClone(),{overwrite:!0},Xe),we()},children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.confirm-plugin-dashboard-save-modal.overwrite",children:"Overwrite"})})]})]})},w=we=>{switch(we){case"version-mismatch":case"name-exists":case"plugin-dashboard":return!0;default:return!1}},H=we=>({modal:(0,f.css)({width:"500px"}),modalText:(0,f.css)({fontSize:we.typography.h4.fontSize,color:we.colors.text.primary,marginBottom:we.spacing(4),paddingTop:we.spacing(2)}),modalButtonRow:(0,f.css)({marginBottom:"14px","a, button":{marginRight:we.spacing(2)}})});var Q=e(50426),Z=e(26987),Y=e(37386),X=e(41654),I=e(72636),J=e(63527),ee=e(87105),q=e(21285),ne=e(91156),se=e(89223),oe=e(42357),de=e(70969);const fe=we=>{const Xe=we.getSaveModelClone();return Xe.id=null,Xe.uid="",Xe.title+=" Copy",Xe.editable=!0,we.id>0&&Xe.panels&&Xe.panels.forEach(nt=>{nt.type==="graph"&&nt.alert&&delete nt.thresholds,delete nt.alert}),Xe},ae=({dashboard:we,isLoading:Xe,isNew:nt,onSubmit:he,onCancel:xe,onSuccess:me})=>{const ye={title:nt?we.title:`${we.title} Copy`,description:we.description,$folder:{uid:we.meta.folderUid,title:we.meta.folderTitle},copyTags:!1},De=Le=>async Ve=>{if(Ve&&Ve===Le().$folder.title?.trim())return"Dashboard name cannot be the same as folder name";try{return await se.P.validateNewDashboardName(Le().$folder.uid??"general",Ve),!0}catch(ze){return ze instanceof Error?ze.message:"Dashboard name is invalid"}};return(0,n.jsx)(Q.l,{defaultValues:ye,onSubmit:async Le=>{if(!he)return;const Ve=fe(we);Ve.title=Le.title,Ve.description=Le.description,!nt&&!Le.copyTags&&(Ve.tags=[]),(await he(Ve,{folderUid:Le.$folder.uid},we)).status==="success"&&me()},children:({register:Le,control:Ve,errors:ze,getValues:Ze})=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Z.e,{render:({field:{ref:Me,...$e}})=>(0,n.jsx)(Y.D,{label:(0,n.jsxs)(X.B,{justifyContent:"space-between",children:[(0,n.jsx)(I.J,{htmlFor:"title",children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-dashboard-as-form.title",children:"Title"})}),r.$.featureToggles.dashgpt&&nt&&(0,n.jsx)(de.Z,{onGenerate:at=>$e.onChange(at)})]}),invalid:!!ze.title,error:ze.title?.message,children:(0,n.jsx)(J.p,{...$e,onChange:at=>$e.onChange(at.target.value),"aria-label":(0,s.t)("dashboard.save-dashboard-as-form.aria-label-save-dashboard-title-field","Save dashboard title field"),autoFocus:!0})}),control:Ve,name:"title",rules:{validate:De(Ze)}}),(0,n.jsx)(Z.e,{render:({field:{ref:Me,...$e}})=>(0,n.jsx)(Y.D,{label:(0,n.jsxs)(X.B,{justifyContent:"space-between",children:[(0,n.jsx)(I.J,{htmlFor:"description",children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-dashboard-as-form.description",children:"Description"})}),r.$.featureToggles.dashgpt&&nt&&(0,n.jsx)(oe.V,{onGenerate:at=>$e.onChange(at)})]}),invalid:!!ze.description,error:ze.description?.message,children:(0,n.jsx)(ee.f,{...$e,onChange:at=>$e.onChange(at.target.value),"aria-label":(0,s.t)("dashboard.save-dashboard-as-form.aria-label-save-dashboard-description-field","Save dashboard description field"),autoFocus:!0})}),control:Ve,name:"description"}),(0,n.jsx)(Y.D,{label:(0,s.t)("dashboard.save-dashboard-as-form.label-folder","Folder"),children:(0,n.jsx)(Z.e,{render:({field:{ref:Me,...$e}})=>(0,n.jsx)(ne.d,{...$e,onChange:(at,ct)=>$e.onChange({uid:at,title:ct}),value:$e.value?.uid}),control:Ve,name:"$folder"})}),!nt&&(0,n.jsx)(Y.D,{label:(0,s.t)("dashboard.save-dashboard-as-form.label-copy-tags","Copy tags"),children:(0,n.jsx)(q.d,{...Le("copyTags")})}),(0,n.jsxs)(X.B,{children:[(0,n.jsx)(D.$n,{type:"button",variant:"secondary",onClick:xe,fill:"outline",children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-dashboard-as-form.cancel",children:"Cancel"})}),(0,n.jsx)(D.$n,{disabled:Xe,type:"submit","aria-label":(0,s.t)("dashboard.save-dashboard-as-form.aria-label-save-dashboard-button","Save dashboard button"),children:Xe?(0,s.t)("dashboard.save-dashboard-as-form.saving","Saving..."):(0,s.t)("dashboard.save-dashboard-as-form.save","Save")})]})]})})};var ce=e(51898),ie=e(32635),ve=e(87056),le=e(16200),Ee=e(37680),Re=e(66769);const Oe=["You are an expert in Grafana Dashboards","Your goal is to write a description of the changes for a dashboard to display to the user","You will be given human-readable diffs with most irrelevant lines filtered out"].join(`.
`),Se=["Respond only with the diff description, which is meant to be loaded directly into the application for the user.",'If there are no substantial user or migration changes, the correct description is "Minor changes only"',`If there are too many changes of either kind, and those changes have a message saying 'too long', the correct response for that section is "Too many changes to auto-summarize"`,"In a diff, lines beginning with - are removed, and lines beginning with + are added.","Lines with neither + nor - are included for context. Be careful not to mark them as added or removed if they do not start with + or -.","If a line is changed, it will show a previous version removed and a new version added","When referring to panel changes, use the panel title","When using panel title, wrap it with double quotes","When the panel changes position, just mention that the panel has changed position","When an entire panel is added or removed, use the panel title and only say it was added or removed and disregard the rest of the changes for that panel","Group together similar changes into one line when multiple panels are affected","Refer to templating elements as variables","Try to make the response as short as possible"].join(`.
`),Te=({dashboard:we,onGenerate:Xe,disabled:nt})=>{const he=(0,a.useCallback)(()=>_e(we),[we]);return(0,n.jsx)(le.n,{messages:he,onGenerate:Xe,temperature:0,model:ve.Kx.BASE,eventTrackingSrc:Ee.ec.dashboardChanges,toggleTipTitle:"Improve your dashboard changes summary",disabled:nt})};function _e(we){let{userChanges:Xe,migrationChanges:nt}=(0,Re.Yy)(we);return Xe.length>8e3&&(Xe="User changes were too long, fill in the user changes section with 'User changes too long to auto-summarize'"),nt.split(`
`).length<10?nt="No significant migration changes":nt.length>8e3&&(nt="Migration changes were too long, fill in the migration changes section with 'Migration changes too long to auto-summarize'"),[{content:Oe,role:Re.Xh.system},{content:`Summarize the following user changes diff under "User changes":
${Xe}`,role:Re.Xh.system},{content:`Be sure to only include substantial user changes, such as adding or removing entire panels, changing panel titles or descriptions, etc.
Do not include "User Changes" section if there are no substantial user changes to report.`,role:Re.Xh.system},{content:`Summarize the following migration changes diff under "Migration changes":
${nt}`,role:Re.Xh.system},{content:`Be sure to only include substantial migration changes, such as adding or removing entire panels, changing panel titles or descriptions, etc.
Ignore any threshold step changes or templating list changes.
Ignore other changes and do not include them in the summary. Do not include "Migration Changes" section if there are no substantial migration changes to report.
If there are substantial migration changes, add "Some autogenerated changes are included to update the dashboard to the latest valid schema version" at the end.`,role:Re.Xh.system},{content:Se,role:Re.Xh.system}]}const He=({dashboard:we,isLoading:Xe,saveModel:nt,options:he,onSubmit:xe,onCancel:me,onSuccess:ye,onOptionsChange:De})=>{const Le=(0,a.useMemo)(()=>we.hasTimeChanged(),[we]),Ve=(0,a.useMemo)(()=>we.hasVariablesChanged(),[we]),[ze,Ze]=(0,a.useState)(!1),[Me,$e]=(0,a.useState)(he.message),at=(0,c.of)(tt);return(0,n.jsx)("form",{onSubmit:async ct=>{if(ct.preventDefault(),!xe)return;Ze(!0),he={...he,message:Me},(await xe(nt.clone,he,we)).status==="success"?ye():Ze(!1)},style:{maxWidth:600},children:(0,n.jsxs)(X.B,{gap:2,direction:"column",alignItems:"flex-start",children:[Le&&(0,n.jsx)(ie.S,{checked:!!he.saveTimerange,onChange:()=>De({...he,saveTimerange:!he.saveTimerange}),label:(0,s.t)("dashboard.save-dashboard-form.label-current-range-dashboard-default","Save current time range as dashboard default"),"aria-label":ce.Tp.pages.SaveDashboardModal.saveTimerange}),Ve&&(0,n.jsx)(ie.S,{checked:!!he.saveVariables,onChange:()=>De({...he,saveVariables:!he.saveVariables}),label:(0,s.t)("dashboard.save-dashboard-form.label-current-variable-values-dashboard-default","Save current variable values as dashboard default"),"aria-label":ce.Tp.pages.SaveDashboardModal.saveVariables}),(0,n.jsxs)("div",{className:at.message,children:[r.$.featureToggles.aiGeneratedDashboardChanges&&(0,n.jsx)(Te,{dashboard:we,onGenerate:ct=>{De({...he,message:ct}),$e(ct)},disabled:!nt.hasChanges}),(0,n.jsx)(ee.f,{value:Me,onChange:ct=>{De({...he,message:ct.currentTarget.value}),$e(ct.currentTarget.value)},placeholder:(0,s.t)("dashboard.save-dashboard-form.placeholder-describe-changes","Add a note to describe your changes."),autoFocus:!0,rows:5})]}),(0,n.jsxs)(X.B,{alignItems:"center",children:[(0,n.jsx)(D.$n,{variant:"secondary",onClick:me,fill:"outline",children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-dashboard-form.cancel",children:"Cancel"})}),(0,n.jsx)(D.$n,{type:"submit",disabled:!nt.hasChanges||Xe,icon:ze?"spinner":void 0,"aria-label":ce.Tp.pages.SaveDashboardModal.save,children:Xe?(0,s.t)("dashboard.save-dashboard-form.saving","Saving..."):(0,s.t)("dashboard.save-dashboard-form.save","Save")}),!nt.hasChanges&&(0,n.jsx)("div",{children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-dashboard-form.no-changes-to-save",children:"No changes to save"})})]})]})})};function tt(we){return{message:(0,f.css)({display:"flex",alignItems:"end",flexDirection:"column",width:"100%"})}}var Je=e(4213),Ge=e(89640),je=e(32881),Fe=e(47931);const Be=({dashboard:we,onCancel:Xe})=>{const[nt,he]=(0,a.useState)(()=>{const me=we.getSaveModelClone();return delete me.id,JSON.stringify(me,null,2)}),xe=(0,a.useCallback)(()=>{const me=new Blob([nt],{type:"application/json;charset=utf-8"});(0,Je.saveAs)(me,we.title+"-"+new Date().getTime()+".json")},[we.title,nt]);return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(X.B,{direction:"column",gap:2,children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-provisioned-dashboard-form.cannot-be-saved",children:"This dashboard cannot be saved from the Grafana UI because it has been provisioned from another source. Copy the JSON or save it to a file below, then you can update your dashboard in the provisioning source."}),(0,n.jsx)("br",{}),(0,n.jsx)("i",{children:(0,n.jsxs)(s.x6,{i18nKey:"dashboard.save-provisioned-dashboard-form.see-docs",children:["See"," ",(0,n.jsx)(Ge.Y,{href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",external:!0,children:"documentation"})," ","for more information about provisioning."]})}),(0,n.jsx)("br",{})," ",(0,n.jsx)("br",{}),(0,n.jsxs)(s.x6,{i18nKey:"dashboard.save-provisioned-dashboard-form.file-path",values:{filePath:we.meta.provisionedExternalId},children:[(0,n.jsx)("strong",{children:"File path:"})," ","{{filePath}}"]})]}),(0,n.jsx)(ee.f,{spellCheck:!1,value:nt,onChange:me=>{he(me.currentTarget.value)},className:Ke.json}),(0,n.jsxs)(je.Gy,{children:[(0,n.jsx)(D.$n,{variant:"secondary",onClick:Xe,fill:"outline",children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-provisioned-dashboard-form.cancel",children:"Cancel"})}),(0,n.jsx)(Fe.b,{icon:"copy",getText:()=>nt,children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-provisioned-dashboard-form.copy-json-to-clipboard",children:"Copy JSON to clipboard"})}),(0,n.jsx)(D.$n,{type:"submit",onClick:xe,children:(0,n.jsx)(s.x6,{i18nKey:"dashboard.save-provisioned-dashboard-form.save-json-to-file",children:"Save JSON to file"})})]})]})})},Ke={json:(0,f.css)({height:"400px",width:"100%",overflow:"auto",resize:"none",fontFamily:"monospace"})},Ue=({dashboard:we,onDismiss:Xe,onSaveSuccess:nt,isCopy:he})=>{const[xe,me]=(0,a.useState)({}),ye=we.getOriginalDashboard(),De=we.meta.provisioned,Le=we.version===0,Ve=!!we.meta.hasUnsavedFolderChange,[ze,Ze]=(0,a.useState)(!1),Me=(0,a.useMemo)(()=>{const Dt=we.getSaveModelClone({saveTimerange:!!xe.saveTimerange,saveVariables:!!xe.saveVariables});if(!ye)return{clone:Dt,diff:{},diffCount:0,hasChanges:!1};const Ye=(0,g.G4)(ye,Dt);let mt=0;for(const zt of Object.values(Ye))mt+=zt.length;return{clone:Dt,diff:Ye,diffCount:mt,hasChanges:(mt>0||Ve)&&!Le}},[we,ye,xe,Le,Ve]),[$e,at]=(0,a.useState)(!1),{state:ct,onDashboardSave:ft}=N(he),Et=nt?()=>{Xe(),nt()}:Xe,St=()=>$e?(0,n.jsx)(d.l,{diff:Me.diff,oldValue:ye,newValue:Me.clone}):Le||he?(0,n.jsx)(ae,{dashboard:we,isLoading:ct.loading,onCancel:Xe,onSuccess:Et,onSubmit:ft,isNew:Le}):De?(0,n.jsx)(Be,{dashboard:we,onCancel:Xe,onSuccess:Et}):(0,n.jsx)(He,{dashboard:we,isLoading:ct.loading,saveModel:Me,onCancel:Xe,onSuccess:Et,onSubmit:ft,options:xe,onOptionsChange:me});if(ct.error&&!ze&&(0,i.NF)(ct.error)&&w(ct.error.data.status))return(0,n.jsx)(V,{error:ct.error,dashboard:we,dashboardSaveModel:Me.clone,onDismiss:Xe,setErrorIsHandled:Ze});let Pt=(0,s.t)("dashboard.save-dashboard-drawer.title","Save dashboard");return he?Pt=(0,s.t)("dashboard.save-dashboard-drawer.title-copy","Save dashboard copy"):De&&(Pt=(0,s.t)("dashboard.save-dashboard-drawer.title-provisioned","Provisioned dashboard")),(0,n.jsxs)(u._,{title:Pt,onClose:Xe,subtitle:we.title,tabs:(0,n.jsxs)(o.U,{children:[(0,n.jsx)(l.o,{label:(0,s.t)("dashboard.save-dashboard-drawer.label-details","Details"),active:!$e,onChangeTab:()=>at(!1)}),Me.hasChanges&&(0,n.jsx)(l.o,{label:(0,s.t)("dashboard.save-dashboard-drawer.label-changes","Changes"),active:$e,onChangeTab:()=>at(!0),counter:Me.diffCount})]}),children:[St(),r.$.featureToggles.showDashboardValidationWarnings&&(0,n.jsx)(h,{dashboard:we})]})}},24209:(te,R,e)=>{"use strict";e.d(R,{D:()=>y});var n=e(74848),a=e(96540),s=e(92745),i=e(43173),r=e(47931),u=e(37386),o=e(41654),l=e(21285),g=e(72636),f=e(87105),p=e(45861),c=e(22787),x=e(23289),v=e(29216),m=e(58662);function y({panel:h,dashboard:d,range:E,onCancelClick:b,buildIframe:D=m.CF}){const[C,P]=(0,a.useState)(!0),[M,O]=(0,a.useState)("current"),[j,U]=(0,a.useState)("");(0,a.useEffect)(()=>{const K=D(C,d.uid,M,h,E);U(K)},[M,C,d,h,E,D]);const W=K=>{U(K.currentTarget.value)},B=()=>{P(K=>!K)},S=K=>{O(K)},_=(0,n.jsx)(r.b,{icon:"copy",variant:"primary",getText:()=>j,onClipboardCopy:()=>{x.c.embedSnippetCopy({currentTimeRange:C,theme:M,shareResource:(0,m.hD)(h)})},children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.embed.copy",children:"Copy to clipboard"})});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.embed.info",children:"Generate HTML for embedding an iframe with this panel"})}),(0,n.jsx)(u.D,{children:(0,n.jsxs)(o.B,{gap:1,alignItems:"start",children:[(0,n.jsx)(l.d,{label:(0,s.t)("share-modal.embed.time-range","Lock time range"),id:"share-current-time-range",value:C,onChange:B}),(0,n.jsx)(g.J,{description:(0,s.t)("embed.share.time-range-description","Change the current relative time range to an absolute time range"),children:(0,n.jsx)(s.x6,{i18nKey:"embed.share.time-range-label",children:"Lock time range"})})]})}),(0,n.jsx)(v.w,{selectedTheme:M,onChange:S}),(0,n.jsx)(u.D,{label:(0,s.t)("share-modal.embed.html","Embed HTML"),description:(0,s.t)("share-modal.embed.html-description","The HTML code below can be pasted and included in another web page. Unless anonymous access is enabled, the users viewing that page need to be signed into Grafana for the graph to load."),children:(0,n.jsx)(f.f,{"data-testid":"share-embed-html",id:"share-panel-embed-embed-html-textarea",rows:5,value:j,onChange:W})}),i.$.featureToggles.newDashboardSharingComponent?(0,n.jsxs)(o.B,{gap:1,justifyContent:"start",children:[_,(0,n.jsx)(p.$n,{variant:"secondary",fill:"outline",onClick:b,children:(0,n.jsx)(s.x6,{i18nKey:"snapshot.share.cancel-button",children:"Cancel"})})]}):(0,n.jsx)(c.a.ButtonRow,{children:_})]})}},65241:(te,R,e)=>{"use strict";e.d(R,{j:()=>o});var n=e(74848),a=e(96540),s=e(92745),i=e(27489),r=e(43652),u=e(58662);const o=({panel:l,initialFolderUid:g,onCreateLibraryPanel:f,onDismiss:p})=>((0,a.useEffect)(()=>{(0,i.rR)("grafana_dashboards_library_panel_share_viewed",{shareResource:(0,u.hD)(l)})},[l]),l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.library.info",children:"Create library panel."})}),(0,n.jsx)(r.b,{panel:l,initialFolderUid:g,onCreateLibraryPanel:f,onDismiss:p})]}):null)},23753:(te,R,e)=>{"use strict";e.d(R,{Zy:()=>Re});var n=e(74848),a=e(96540),s=e(92745),i=e(52792),r=e(22787),u=e(13941),o=e(63142),l=e(65642),g=e(73427),f=e(82298),p=e(24313),c=e(23289),x=e(75515),v=e(11257),m=e(24209),y=e(4213),h=e(37386),d=e(21285),E=e(45861),b=e(2543),D=e(7389),C=e(78282),P=e(30124),M=e(99305),O=e(97583),j=e(67933);function U(Oe){return!!(Oe.libraryPanel?.name&&Oe.libraryPanel?.uid)}class W{async makeExportable(Se){Se.cleanUpRepeats();const Te=Se.getSaveModelCloneOld();Te.id=null,Se.processRepeats();const _e=[],He={},tt={},Je={},Ge=new Map;for(const Ke of Te.getVariables())Je[Ke.name]=Ke;const je=(Ke,Ue)=>{if(Ke.datasource===void 0){Ke.datasource=Ue;return}let we=Ke.datasource,Xe=null;const nt=we?.uid,he=nt&&M.SY.exec(nt);if(he){const xe=he[1]||he[2]||he[4];Xe=Je[xe],Xe&&Xe.current&&(we=Xe.current.value)}return(0,C.l)().get(we).then(xe=>{if(xe.meta?.builtIn||(He["datasource"+xe.meta?.id]={type:"datasource",id:xe.meta.id,name:xe.meta.name,version:xe.meta.info.version||"1.0.0"},Xe))return;const me=Ke.libraryPanel,ye=me?"-for-library-panel":"";let De="DS_"+xe.name.replace(" ","_").toUpperCase()+ye.toUpperCase();if(tt[De]={name:De,label:xe.name,description:"",type:"datasource",pluginId:xe.meta?.id,pluginName:xe.meta?.name,usage:tt[De]?.usage},me){const Le=tt[De]?.usage?.libraryPanels||[];Le.push({name:me.name,uid:me.uid}),tt[De].usage={libraryPanels:Le}}Ke.datasource={type:xe.meta.id,uid:"${"+De+"}"}})},Fe=async Ke=>{if(Ke.type!=="row"){if(await je(Ke),Ke.targets)for(const we of Ke.targets)await je(we,Ke.datasource);const Ue=l.Ay.panels[Ke.type];Ue&&(He["panel"+Ue.id]={type:"panel",id:Ue.id,name:Ue.name,version:Ue.info.version})}},Be=async Ke=>{if((0,x.X)(Ke)){const{name:Ue,uid:we}=Ke.libraryPanel;let Xe=Ke.libraryPanel.model;Xe||(Xe=(await(0,P.Yr)(we,!0)).model),await je(Xe);const{gridPos:nt,id:he,...xe}=Xe;Ge.has(we)||Ge.set(we,{name:Ue,uid:we,kind:O.i.Panel,model:xe})}};try{for(const we of Te.panels)if(await Fe(we),we.collapsed!==void 0&&we.collapsed===!0&&we.panels)for(const Xe of we.panels)await Fe(Xe);for(const we of Te.getVariables())we.type==="query"?(await je(we),we.options=[],we.current={},we.refresh=we.refresh!==D.CO.never?we.refresh:D.CO.onDashboardLoad):we.type==="datasource"&&(we.current={});for(const we of Te.annotations.list)await je(we);He.grafana={type:"grafana",id:"grafana",name:"Grafana",version:l.Ay.buildInfo.version};for(const we of Te.panels)if(await Be(we),we.collapsed!==void 0&&we.collapsed===!0&&we.panels)for(const Xe of we.panels)await Be(Xe);(0,b.each)(tt,we=>{_e.push(we)});for(const we of Te.getVariables())if((0,j.VO)(we)){const Xe="VAR_"+we.name.replace(" ","_").toUpperCase();_e.push({name:Xe,type:"constant",label:we.label||we.name,value:we.query,description:""}),we.query="${"+Xe+"}",we.current={value:we.query,text:we.query,selected:!1},we.options=[we.current]}const Ke=[...Ge.entries()].reduce((we,[Xe,nt])=>(we[Xe]=nt,we),{}),Ue=(0,b.defaults)({__inputs:_e,__elements:Ke,__requires:(0,b.sortBy)(He,["id"])},Te);for(let we=0;we<Ue.panels.length;we++){const Xe=Ue.panels[we];U(Xe)&&(Ue.panels[we]={gridPos:Xe.gridPos,id:Xe.id,libraryPanel:{uid:Xe.libraryPanel.uid,name:Xe.libraryPanel.name}})}return Ue}catch(Ke){return console.error("Export failed:",Ke),{error:Ke}}}}var B=e(3392),S=e(87745),_=e(70713),K=e(50992),T=e(47931);function L({json:Oe,onDismiss:Se}){const Te=(0,a.useCallback)(()=>Oe,[Oe]);return(0,n.jsxs)(r.a,{title:(0,s.t)("dashboard.view-json-modal.title-json","JSON"),onDismiss:Se,onClickBackdrop:Se,isOpen:!0,children:[(0,n.jsx)(_.Ay,{disableHeight:!0,children:({width:_e})=>(0,n.jsx)(K.B,{value:Oe,language:"json",showMiniMap:!1,height:"500px",width:_e})}),(0,n.jsx)(r.a.ButtonRow,{children:(0,n.jsx)(T.b,{icon:"copy",getText:Te,onClipboardCopy:()=>{c.c.exportCopyJsonClicked()},children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.view-json.copy-button",children:"Copy to Clipboard"})})})]})}var A=e(58662);class N extends a.PureComponent{constructor(Se){super(Se),this.onShareExternallyChange=()=>{this.setState({shareExternally:!this.state.shareExternally})},this.onSaveAsFile=()=>{const{dashboard:Te}=this.props,{shareExternally:_e}=this.state;c.c.exportSaveJsonClicked({externally:_e,shareResource:(0,A.hD)(this.props.panel)}),_e?(0,B.E)(Te).then(He=>{this.openSaveAsDialog(He)}):this.openSaveAsDialog(Te.getSaveModelClone())},this.onViewJson=()=>{const{dashboard:Te}=this.props,{shareExternally:_e}=this.state;c.c.exportViewJsonClicked({externally:_e,shareResource:(0,A.hD)(this.props.panel)}),_e?this.exporter.makeExportable(Te).then(He=>{this.openJsonModal(He)}):this.openJsonModal(Te.getSaveModelClone())},this.openSaveAsDialog=Te=>{const _e=JSON.stringify(Te,null,2),He=new Blob([_e],{type:"application/json;charset=utf-8"}),tt=new Date().getTime();(0,y.saveAs)(He,`${Te.title}-${tt}.json`)},this.openJsonModal=Te=>{g.lE.publish(new S.S8({props:{json:JSON.stringify(Te,null,2)},component:L})),this.props.onDismiss?.()},this.state={shareExternally:!1},this.exporter=new W}render(){const{onDismiss:Se}=this.props,{shareExternally:Te}=this.state,_e=(0,s.t)("share-modal.export.share-externally-label","Export for sharing externally");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.export.info-text",children:"Export this dashboard."})}),(0,n.jsx)(h.D,{label:_e,children:(0,n.jsx)(d.d,{id:"share-externally-toggle",value:Te,onChange:this.onShareExternallyChange})}),(0,n.jsxs)(r.a.ButtonRow,{children:[(0,n.jsx)(E.$n,{variant:"secondary",onClick:Se,fill:"outline",children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.export.cancel-button",children:"Cancel"})}),(0,n.jsx)(E.$n,{variant:"secondary",onClick:this.onViewJson,children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.export.view-button",children:"View JSON"})}),(0,n.jsx)(E.$n,{variant:"primary",onClick:this.onSaveAsFile,children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]})}}var V=e(65241),z=e(51898),w=e(16780),H=e(63527),Q=e(89640),Z=e(34999),Y=e(29216);class X extends a.PureComponent{constructor(Se){super(Se),this.buildUrl=async()=>{const{panel:Te,dashboard:_e}=this.props,{useCurrentTimeRange:He,useShortUrl:tt,selectedTheme:Je}=this.state,Ge=await(0,A.Xe)(He,Je,Te,tt),je=(0,A.Lb)(He,_e.uid,Je,Te);this.setState({shareUrl:Ge,imageUrl:je})},this.onUseCurrentTimeRangeChange=()=>{this.setState({useCurrentTimeRange:!this.state.useCurrentTimeRange})},this.onUrlShorten=()=>{this.setState({useShortUrl:!this.state.useShortUrl})},this.onThemeChange=Te=>{this.setState({selectedTheme:Te})},this.getShareUrl=()=>this.state.shareUrl,this.onCopy=()=>{c.c.shareLinkCopied({currentTimeRange:this.state.useCurrentTimeRange,theme:this.state.selectedTheme,shortenURL:this.state.useShortUrl,shareResource:(0,A.hD)(this.props.panel)})},this.state={useCurrentTimeRange:!0,useShortUrl:!1,selectedTheme:"current",shareUrl:"",imageUrl:""}}componentDidMount(){this.buildUrl()}componentDidUpdate(Se,Te){const{useCurrentTimeRange:_e,useShortUrl:He,selectedTheme:tt}=this.state;(Te.useCurrentTimeRange!==_e||Te.selectedTheme!==tt||Te.useShortUrl!==He)&&this.buildUrl()}render(){const{panel:Se,dashboard:Te}=this.props,_e=Te?Te.time.to==="now":!1,{useCurrentTimeRange:He,useShortUrl:tt,selectedTheme:Je,shareUrl:Ge,imageUrl:je}=this.state,Fe=z.Tp.pages.SharePanelModal,Be=!!Te.id,Ke=(0,s.t)("share-modal.link.time-range-label","Lock time range"),Ue=(0,s.t)("share-modal.link.time-range-description","Transforms the current relative time range to an absolute time range"),we=(0,s.t)("share-modal.link.shorten-url","Shorten URL"),Xe=(0,s.t)("share-modal.link.link-url","Link URL");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.link.info-text",children:"Create a direct link to this dashboard or panel, customized with the options below."})}),(0,n.jsxs)(w.n,{children:[(0,n.jsx)(h.D,{label:Ke,description:_e?Ue:"",children:(0,n.jsx)(d.d,{id:"share-current-time-range",value:He,onChange:this.onUseCurrentTimeRangeChange})}),(0,n.jsx)(Y.w,{selectedTheme:Je,onChange:this.onThemeChange}),(0,n.jsx)(h.D,{label:we,children:(0,n.jsx)(d.d,{id:"share-shorten-url",value:tt,onChange:this.onUrlShorten})}),(0,n.jsx)(h.D,{label:Xe,children:(0,n.jsx)(H.p,{id:"link-url-input",value:Ge,readOnly:!0,addonAfter:(0,n.jsx)(T.b,{icon:"copy",variant:"primary",getText:this.getShareUrl,onClipboardCopy:this.onCopy,children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.link.copy-link-button",children:"Copy"})})})})]}),Se&&l.Ay.rendererAvailable&&(0,n.jsxs)(n.Fragment,{children:[Be&&(0,n.jsx)(Q.Y,{href:je,external:!0,icon:"camera","aria-label":Fe.linkToRenderedImage,children:(0,s.t)("share-modal.link.rendered-image","Direct link rendered image")}),!Be&&(0,n.jsx)(Z.F,{severity:"info",title:(0,s.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})})]}),Se&&!l.Ay.rendererAvailable&&(0,n.jsx)(Z.F,{severity:"info",title:(0,s.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,n.jsxs)(s.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,n.jsx)(Q.Y,{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",external:!0,children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})})]})}}var I=e(3594),J=e(68143),ee=e(18857),q=e(41654),ne=e(68079),se=e(75421),oe=e(8735);class de extends a.PureComponent{constructor(Se){super(Se),this.createSnapshot=Te=>()=>{const{timeoutSeconds:_e}=this.state;this.dashboard.snapshot={timestamp:new Date},this.setState({isLoading:!0}),this.dashboard.startRefresh(),setTimeout(()=>{this.saveSnapshot(this.dashboard,Te)},_e*1e3)},this.saveSnapshot=async(Te,_e)=>{const{snapshotExpires:He,timeoutSeconds:tt}=this.state,Je=this.dashboard.getSaveModelCloneOld();this.scrubDashboard(Je);const Ge={dashboard:Je,name:Je.title,expires:He,external:_e};try{const je=await(0,oe.s)().create(Ge);this.setState({deleteUrl:je.deleteUrl,snapshotUrl:je.url,step:2})}finally{_e?c.c.publishSnapshotClicked({expires:He,timeout:tt,shareResource:(0,A.hD)(this.props.panel)}):c.c.publishSnapshotLocalClicked({expires:He,timeout:tt,shareResource:(0,A.hD)(this.props.panel)}),this.setState({isLoading:!1})}},this.scrubDashboard=Te=>{const{panel:_e}=this.props,{snapshotName:He}=this.state;Te.title=He,Te.time=(0,se.jG)().timeRange(),Te.links=[],Te.panels.forEach(Je=>{Je.targets=[],Je.links=[],Je.datasource=null});const tt=Te.annotations.list.filter(Je=>Je.enable);if(Te.annotations.list=tt.map(Je=>({name:Je.name,enable:Je.enable,iconColor:Je.iconColor,snapshotData:Je.snapshotData,type:Je.type,builtIn:Je.builtIn,hide:Je.hide})),Te.getVariables().forEach(Je=>{"query"in Je&&(Je.query=""),"options"in Je&&(Je.options=Je.current&&!(0,I.R)(Je.current)?[Je.current]:[]),"refresh"in Je&&(Je.refresh=D.CO.never)}),_e){const Je=_e.getSaveModel();Je.gridPos.w=24,Je.gridPos.x=0,Je.gridPos.y=0,Je.gridPos.h=20,Te.panels=[Je]}delete this.dashboard.snapshot,this.dashboard.forEachPanel(Je=>{delete Je.snapshotData}),this.dashboard.annotations.list.forEach(Je=>{delete Je.snapshotData})},this.deleteSnapshot=async()=>{const{deleteUrl:Te}=this.state;await(0,J.AI)().get(Te),this.setState({step:3})},this.getSnapshotUrl=()=>this.state.snapshotUrl,this.onSnapshotNameChange=Te=>{this.setState({snapshotName:Te.target.value})},this.onTimeoutChange=Te=>{this.setState({timeoutSeconds:Number(Te.target.value)})},this.onExpireChange=Te=>{this.setState({selectedExpireOption:Te,snapshotExpires:Te.value})},this.dashboard=Se.dashboard,this.expireOptions=[{label:(0,s.t)("share-modal.snapshot.expire-hour","1 Hour"),value:60*60},{label:(0,s.t)("share-modal.snapshot.expire-day","1 Day"),value:60*60*24},{label:(0,s.t)("share-modal.snapshot.expire-week","1 Week"),value:60*60*24*7},{label:(0,s.t)("share-modal.snapshot.expire-never","Never"),value:0}],this.state={isLoading:!1,step:1,selectedExpireOption:this.expireOptions[2],snapshotExpires:this.expireOptions[2].value,snapshotName:Se.dashboard.title,timeoutSeconds:4,snapshotUrl:"",deleteUrl:"",externalEnabled:!1,sharingButtonText:""}}componentDidMount(){this.getSnaphotShareOptions()}async getSnaphotShareOptions(){const Se=await(0,oe.s)().getSharingOptions();this.setState({sharingButtonText:Se.externalSnapshotName,externalEnabled:Se.externalEnabled})}renderStep1(){const{onDismiss:Se}=this.props,{snapshotName:Te,selectedExpireOption:_e,timeoutSeconds:He,isLoading:tt,sharingButtonText:Je,externalEnabled:Ge}=this.state,je=(0,s.t)("share-modal.snapshot.name","Snapshot name"),Fe=(0,s.t)("share-modal.snapshot.expire","Expire"),Be=(0,s.t)("share-modal.snapshot.timeout","Timeout (seconds)"),Ke=(0,s.t)("share-modal.snapshot.timeout-description","You might need to configure the timeout value if it takes a long time to collect your dashboard metrics.");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.snapshot.info-text-1",children:"A snapshot is an instant way to share an interactive dashboard publicly. When created, we strip sensitive data like queries (metric, template, and annotation) and panel links, leaving only the visible metric data and series names embedded in your dashboard."})}),(0,n.jsx)("p",{children:(0,n.jsxs)(s.x6,{i18nKey:"share-modal.snapshot.info-text-2",children:["Keep in mind, your snapshot ",(0,n.jsx)("em",{children:"can be viewed by anyone"})," that has the link and can access the URL. Share wisely."]})})]}),(0,n.jsx)(h.D,{label:je,children:(0,n.jsx)(H.p,{id:"snapshot-name-input",width:30,value:Te,onChange:this.onSnapshotNameChange})}),(0,n.jsx)(h.D,{label:Fe,children:(0,n.jsx)(ee.l6,{inputId:"expire-select-input",width:30,options:this.expireOptions,value:_e,onChange:this.onExpireChange})}),(0,n.jsx)(h.D,{label:Be,description:Ke,children:(0,n.jsx)(H.p,{id:"timeout-input",type:"number",width:21,value:He,onChange:this.onTimeoutChange})}),(0,n.jsxs)(r.a.ButtonRow,{children:[(0,n.jsx)(E.$n,{variant:"secondary",onClick:Se,fill:"outline",children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.snapshot.cancel-button",children:"Cancel"})}),Ge&&(0,n.jsx)(E.$n,{variant:"secondary",disabled:tt,onClick:this.createSnapshot(!0),children:Je}),(0,n.jsx)(E.$n,{variant:"primary",disabled:tt,onClick:this.createSnapshot(),children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.snapshot.local-button",children:"Publish Snapshot"})})]})]})}renderStep2(){const{snapshotUrl:Se}=this.state;return(0,n.jsxs)(q.B,{direction:"column",gap:0,children:[(0,n.jsx)(h.D,{label:(0,s.t)("share-modal.snapshot.url-label","Snapshot URL"),children:(0,n.jsx)(H.p,{id:"snapshot-url-input",value:Se,readOnly:!0,addonAfter:(0,n.jsx)(T.b,{icon:"copy",variant:"primary",getText:this.getSnapshotUrl,children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.snapshot.copy-link-button",children:"Copy"})})})}),(0,n.jsxs)("div",{style:{alignSelf:"flex-end",padding:"5px"},children:[(0,n.jsx)(s.x6,{i18nKey:"share-modal.snapshot.mistake-message",children:"Did you make a mistake? "}),"\xA0",(0,n.jsx)(E.z9,{fill:"text",target:"_blank",onClick:this.deleteSnapshot,children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.snapshot.delete-button",children:"Delete snapshot."})})]})]})}renderStep3(){return(0,n.jsx)("p",{children:(0,n.jsx)(s.x6,{i18nKey:"share-modal.snapshot.deleted-message",children:"The snapshot has been deleted. If you have already accessed it once, then it might take up to an hour before before it is removed from browser caches or CDN caches."})})}render(){const{isLoading:Se,step:Te}=this.state;return(0,n.jsxs)(n.Fragment,{children:[Te===1&&this.renderStep1(),Te===2&&this.renderStep2(),Te===3&&this.renderStep3(),Se&&(0,n.jsx)(ne.y,{inline:!0})]})}}const fe=[],ae=[];function ce(Oe){fe.push(Oe)}function ie(Oe){ae.push(Oe)}function ve(Oe,Se,Te){const He=[{label:(0,s.t)("share-modal.tab-title.link","Link"),value:A.wr.link,component:X}];if(g.TP.isSignedIn&&l.$W.snapshotEnabled&&g.TP.hasPermission(v.w.SnapshotsCreate)){const Je=(0,s.t)("share-modal.tab-title.snapshot","Snapshot");He.push({label:Je,value:A.wr.snapshot,component:de})}if(Se){const Je=(0,s.t)("share-modal.tab-title.embed","Embed");if(He.push({label:Je,value:A.wr.embed,component:m.D}),!(0,x.X)(Se)){const Ge=(0,s.t)("share-modal.tab-title.library-panel","Library panel");He.push({label:Ge,value:A.wr.libraryPanel,component:V.j})}He.push(...ae)}else{const Je=(0,s.t)("share-modal.tab-title.export","Export");He.push({label:Je,value:A.wr.export,component:N}),He.push(...fe),(0,p.iR)()&&He.push({label:(0,s.t)("share-modal.tab-title.public-dashboard-title","Public dashboard"),value:A.wr.publicDashboard,component:f.b})}const tt=He.find(Je=>Je.value===Te);return{tabs:He,activeTab:tt?.value??He[0].value}}function le(Oe){const{tabs:Se,activeTab:Te}=ve(Oe.dashboard.canEditDashboard(),Oe.panel,Oe.activeTab);return{tabs:Se,activeTab:Te}}class Ee extends a.Component{constructor(Se){super(Se),this.onSelectTab=Te=>{this.setState(_e=>({..._e,activeTab:Te.value})),c.c.sharingCategoryClicked({item:Te.value,shareResource:(0,A.hD)(this.props.panel)})},this.state=le(Se)}getActiveTab(){const{tabs:Se,activeTab:Te}=this.state;return Se.find(_e=>_e.value===Te)}renderTitle(){const{panel:Se}=this.props,{activeTab:Te}=this.state,_e=Se?(0,s.t)("share-modal.panel.title","Share Panel"):(0,s.t)("share-modal.dashboard.title","Share"),He=this.props.dashboard.canEditDashboard(),tt=ve(He,this.props.panel,this.state.activeTab).tabs;return(0,n.jsx)(i.J,{title:_e,icon:"share-alt",tabs:tt,activeTab:Te,onChangeTab:this.onSelectTab})}render(){const{dashboard:Se,panel:Te}=this.props,He=this.getActiveTab().component;return(0,n.jsx)(r.a,{isOpen:!0,title:this.renderTitle(),onDismiss:this.props.onDismiss,children:(0,n.jsx)(u.J,{children:(0,n.jsx)(He,{dashboard:Se,panel:Te,onDismiss:this.props.onDismiss})})})}}const Re=(0,o.cV)(Ee)},72973:(te,R,e)=>{"use strict";e.d(R,{K:()=>ve,b:()=>ie});var n=e(74848),a=e(22803),s=e(49785),i=e(51898),r=e(92745),u=e(63142),o=e(37386),l=e(63527),g=e(47931),f=e(41654),p=e(21285),c=e(72636),x=e(32881),v=e(45861),m=e(8515),y=e(62905),h=e(90593),d=e(23289),E=e(61730),b=e(11257),D=e(52763),C=e(15130),P=e(52908);const M=()=>{const{width:Ee}=(0,P.A)();return Ee>1024};var O=e(23753),j=e(58662),U=e(35195),W=e(34999);const B=()=>(0,n.jsx)(W.F,{title:(0,r.t)("public-dashboard.modal-alerts.save-dashboard-changes-alert-title","Please save your dashboard changes before updating the public configuration"),severity:"warning",bottomSpacing:0});var S=e(37672),_=e(44173),K=e(24313),T=e(16780),L=e(56265);const A=i.Tp.pages.ShareDashboardModal.PublicDashboard,N=({disabled:Ee,onChange:Re,register:Oe,timeRange:Se})=>(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(T.n,{disabled:Ee,children:(0,n.jsxs)(x.gW,{spacing:"md",children:[(0,n.jsxs)(f.B,{direction:"column",gap:.5,justifyContent:"space-between",children:[(0,n.jsx)(c.J,{description:(0,r.t)("public-dashboard.settings-configuration.default-time-range-label-desc","The public dashboard uses the default time range settings of the dashboard"),children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.settings-configuration.default-time-range-label",children:"Default time range"})}),(0,n.jsx)(L.b,{value:Se,disabled:!0,onChange:()=>{}})]}),(0,n.jsxs)(f.B,{direction:"row",gap:.5,children:[(0,n.jsx)(p.d,{...Oe("isTimeSelectionEnabled"),"data-testid":A.EnableTimeRangeSwitch,onChange:Te=>{Re("isTimeSelectionEnabled",Te.currentTarget.checked),d.c.publicDashboardTimeSelectionChanged({enabled:Te.currentTarget.checked})}}),(0,n.jsx)(c.J,{description:(0,r.t)("public-dashboard.settings-configuration.time-range-picker-label-desc","Allow viewers to change time range"),children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.settings-configuration.time-range-picker-label",children:"Time range picker enabled"})})]}),(0,n.jsxs)(f.B,{direction:"row",gap:.5,children:[(0,n.jsx)(p.d,{...Oe("isAnnotationsEnabled"),onChange:Te=>{Re("isAnnotationsEnabled",Te.currentTarget.checked),d.c.publicDashboardAnnotationsSelectionChanged({enabled:Te.currentTarget.checked})},"data-testid":A.EnableAnnotationsSwitch}),(0,n.jsx)(c.J,{description:(0,r.t)("public-dashboard.settings-configuration.show-annotations-label-desc","Show annotations on public dashboard"),children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.settings-configuration.show-annotations-label",children:"Show annotations"})})]})]})})});var V=e(93256),z=e(77824),w=e(68079),H=e(72746);const Q=i.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,Z=({recipients:Ee,dashboardUid:Re,publicDashboardUid:Oe})=>{const Se=(0,u.of)(X),[Te,{isLoading:_e}]=(0,y.$L)(),[He,{isLoading:tt}]=(0,y.NA)(),Je=_e||tt,Ge=(Fe,Be)=>{d.c.revokePublicDashboardEmailClicked(),Te({recipientUid:Fe,recipientEmail:Be,dashboardUid:Re,uid:Oe})},je=Fe=>{d.c.resendPublicDashboardEmailClicked(),He({recipientUid:Fe,uid:Oe})};return(0,n.jsx)("table",{className:Se.table,"data-testid":Q.EmailSharingList,children:(0,n.jsx)("tbody",{children:Ee.map((Fe,Be)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:Fe.recipient}),(0,n.jsx)("td",{children:(0,n.jsxs)(V.e,{className:Se.tableButtonsContainer,children:[(0,n.jsx)(v.$n,{type:"button",variant:"destructive",fill:"text",title:(0,r.t)("public-dashboard.email-sharing.revoke-button-title","Revoke"),size:"sm",disabled:Je,onClick:()=>Ge(Fe.uid,Fe.recipient),"data-testid":`${Q.DeleteEmail}-${Be}`,children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.email-sharing.revoke-button",children:"Revoke"})}),(0,n.jsx)(v.$n,{type:"button",variant:"primary",fill:"text",title:(0,r.t)("public-dashboard.email-sharing.resend-button-title","Resend"),size:"sm",disabled:Je,onClick:()=>je(Fe.uid),"data-testid":`${Q.ReshareLink}-${Be}`,children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.email-sharing.resend-button",children:"Resend"})})]})})]},Fe.uid))})})},Y=({dashboard:Ee})=>{const{width:Re}=(0,P.A)(),Oe=(0,u.of)(X),Se=Ee instanceof H.H$?Ee.state.uid:Ee.uid,{data:Te}=(0,y.Bs)(Se),[_e]=(0,y.ft)(),[He,{isLoading:tt}]=(0,y.NY)(),Je=C.TP.hasPermission(b.w.DashboardsPublicWrite),{register:Ge,setValue:je,control:Fe,watch:Be,handleSubmit:Ke,formState:{errors:Ue},reset:we}=(0,s.mN)({defaultValues:{shareType:Te?.share||K.Xo.PUBLIC,email:""},mode:"onSubmit"}),Xe=he=>{const xe={dashboard:Ee,payload:{...Te,share:he}};_e(xe)},nt=async he=>{d.c.publicDashboardEmailInviteClicked(),await He({recipient:he.email,uid:Te.uid,dashboardUid:Se}).unwrap(),we({email:"",shareType:K.Xo.EMAIL})};return(0,n.jsx)("form",{onSubmit:Ke(nt),children:(0,n.jsxs)(T.n,{disabled:!Je,"data-testid":Q.Container,className:Oe.container,children:[(0,n.jsx)(o.D,{label:(0,r.t)("public-dashboard.config.can-view-dashboard-radio-button-label","Can view dashboard"),className:Oe.field,children:(0,n.jsx)(s.xI,{name:"shareType",control:Fe,render:({field:he})=>{const{ref:xe,...me}=he,ye=[{label:(0,r.t)("public-dashboard.config.public-share-type-option-label","Anyone with a link"),value:K.Xo.PUBLIC},{label:(0,r.t)("public-dashboard.config.email-share-type-option-label","Only specified people"),value:K.Xo.EMAIL}];return(0,n.jsx)(z.z,{...me,size:Re<480?"sm":"md",options:ye,onChange:De=>{d.c.publicDashboardShareTypeChange({shareType:De===K.Xo.EMAIL?"email":"public"}),je("shareType",De),Xe(De)}})}})}),Be("shareType")===K.Xo.EMAIL&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.D,{label:(0,r.t)("public-dashboard.email-sharing.invite-field-label","Invite"),description:(0,r.t)("public-dashboard.email-sharing.invite-field-desc","Invite people by email"),error:Ue.email?.message,invalid:!!Ue.email?.message||void 0,className:Oe.field,children:(0,n.jsxs)("div",{className:Oe.emailContainer,children:[(0,n.jsx)(l.p,{className:Oe.emailInput,placeholder:"me@example.com",autoCapitalize:"none",...Ge("email",{required:(0,r.t)("public-dashboard.email-sharing.input-required-email-text","Email is required"),pattern:{value:K._l,message:(0,r.t)("public-dashboard.email-sharing.input-invalid-email-text","Invalid email")}}),"data-testid":Q.EmailSharingInput}),(0,n.jsxs)(v.$n,{type:"submit",variant:"primary",disabled:tt,"data-testid":Q.EmailSharingInviteButton,children:[(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.email-sharing.invite-button",children:"Invite"}),tt&&(0,n.jsx)(w.y,{})]})]})}),!!Te?.recipients?.length&&(0,n.jsx)(Z,{recipients:Te.recipients,dashboardUid:Se,publicDashboardUid:Te.uid})]})]})})},X=Ee=>({container:(0,a.css)({label:"emailConfigContainer",display:"flex",flexDirection:"column",flexWrap:"wrap",gap:Ee.spacing(3)}),field:(0,a.css)({label:"field-noMargin",marginBottom:0}),emailContainer:(0,a.css)({label:"emailContainer",display:"flex",gap:Ee.spacing(1)}),emailInput:(0,a.css)({label:"emailInput",flexGrow:1}),table:(0,a.css)({label:"table",display:"flex",maxHeight:"220px",overflowY:"scroll","& tbody":{display:"flex",flexDirection:"column",flexGrow:1},"& tr":{minHeight:"40px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:Ee.spacing(.5,1),":nth-child(odd)":{background:Ee.colors.background.secondary}}}),tableButtonsContainer:(0,a.css)({display:"flex",justifyContent:"end"})});var I=e(96540),J=e(44019),ee=e(76319);function q({headerElement:Ee,isContentVisible:Re=!1,onRowToggle:Oe,title:Se,...Te}){const _e=(0,u.of)(ne),He=Ee&&J.renderOrCallToRender(Ee,{className:_e.summaryWrapper});return(0,n.jsx)("div",{className:_e.wrapper,children:(0,n.jsxs)("div",{className:_e.header,children:[(0,n.jsx)(ee.K,{name:Re?"angle-down":"angle-right",tooltip:Re?(0,r.t)("public-dashboard.settings-bar-header.collapse-settings-tooltip","Collapse settings"):(0,r.t)("public-dashboard.settings-bar-header.expand-settings-tooltip","Expand settings"),className:_e.collapseIcon,onClick:Oe,"aria-expanded":Re,...Te}),Se&&(0,n.jsx)("div",{className:_e.titleWrapper,onClick:Oe,children:(0,n.jsx)("span",{className:_e.title,children:Se})}),He]})})}q.displayName="SettingsBarHeader";function ne(Ee){return{wrapper:(0,a.css)({label:"header",padding:Ee.spacing(.5,.5),borderRadius:Ee.shape.radius.default,background:Ee.colors.background.secondary,minHeight:Ee.spacing(4),"&:focus":{outline:"none"}}),header:(0,a.css)({label:"column",display:"flex",alignItems:"center",whiteSpace:"nowrap"}),collapseIcon:(0,a.css)({marginLeft:Ee.spacing(.5),color:Ee.colors.text.disabled}),titleWrapper:(0,a.css)({display:"flex",alignItems:"center",cursor:"pointer",overflow:"hidden",marginRight:`${Ee.spacing(.5)}`,[Ee.breakpoints.down("sm")]:{flex:"1 1"}}),title:(0,a.css)({fontWeight:Ee.typography.fontWeightBold,marginLeft:Ee.spacing(.5),overflow:"hidden",textOverflow:"ellipsis"}),summaryWrapper:(0,a.css)({display:"flex",flexWrap:"wrap",[Ee.breakpoints.down("sm")]:{flex:"2 2"}})}}function se({children:Ee,title:Re,headerElement:Oe,...Se}){const Te=(0,u.of)(oe),[_e,He]=(0,I.useState)(!1);function tt(){He(Je=>!Je)}return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(q,{onRowToggle:tt,isContentVisible:_e,title:Re,headerElement:Oe,...Se}),_e&&(0,n.jsx)("div",{className:Te.content,children:Ee})]})}se.displayName="SettingsBar";const oe=Ee=>({content:(0,a.css)({marginTop:Ee.spacing(1),marginLeft:Ee.spacing(4)})});var de=e(83692);function fe({className:Ee,isDataLoading:Re=!1,timeRange:Oe,timeSelectionEnabled:Se,annotationsEnabled:Te}){const _e=(0,u.of)(ae),He=(0,r.t)("public-dashboard.settings-summary.time-range-picker-enabled-text","Time range picker = enabled"),tt=(0,r.t)("public-dashboard.settings-summary.time-range-picker-disabled-text","Time range picker = disabled"),Je=(0,r.t)("public-dashboard.settings-summary.annotations-show-text","Annotations = show"),Ge=(0,r.t)("public-dashboard.settings-summary.annotations-hide-text","Annotations = hide");return Re?(0,n.jsx)("div",{className:(0,a.cx)(_e.summaryWrapper,Ee),children:(0,n.jsx)(w.y,{className:_e.summary,inline:!0,size:"sm"})}):(0,n.jsxs)("div",{className:(0,a.cx)(_e.summaryWrapper,Ee),children:[(0,n.jsxs)("span",{className:_e.summary,children:[(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.settings-summary.time-range-text",children:"Time range = "}),(0,n.jsx)(de.f,{className:_e.timeRange,value:Oe})]}),(0,n.jsx)("span",{className:_e.summary,children:Se?He:tt}),(0,n.jsx)("span",{className:_e.summary,children:Te?Je:Ge})]})}fe.displayName="SettingsSummary";const ae=Ee=>({summaryWrapper:(0,a.css)({display:"flex"}),summary:(0,a.css)({label:"collapsedText",marginLeft:`${Ee.spacing.gridSize*2}px`,fontSize:Ee.typography.bodySmall.fontSize,color:Ee.colors.text.secondary}),timeRange:(0,a.css)({display:"inline-block"})}),ce=i.Tp.pages.ShareDashboardModal.PublicDashboard;function ie({onRevoke:Ee,timeRange:Re,hasTemplateVariables:Oe=!1,showSaveChangesAlert:Se=!1,unsupportedDatasources:Te=[],publicDashboard:_e,dashboard:He}){const tt=(0,u.of)(le),Je=M(),[Ge,{isLoading:je}]=(0,y.T2)(),[Fe,{isLoading:Be}]=(0,y.eq)(),Ke=C.TP.hasPermission(b.w.DashboardsPublicWrite),Ue=!Ke||je||Be,{handleSubmit:we,setValue:Xe,register:nt}=(0,s.mN)({defaultValues:{isAnnotationsEnabled:_e?.annotationsEnabled,isTimeSelectionEnabled:_e?.timeSelectionEnabled,isPaused:!_e?.isEnabled}}),he=async Le=>{const{isAnnotationsEnabled:Ve,isTimeSelectionEnabled:ze,isPaused:Ze}=Le;Ge({dashboard:He,payload:{..._e,annotationsEnabled:Ve,timeSelectionEnabled:ze,isEnabled:!Ze}})},xe=async Le=>{const{isAnnotationsEnabled:Ve,isTimeSelectionEnabled:ze,isPaused:Ze}=Le;Fe({dashboard:He,payload:{..._e,annotationsEnabled:Ve,timeSelectionEnabled:ze,isEnabled:!Ze}})},me=async(Le,Ve)=>{Xe(Le,Ve),await we(ze=>he(ze))()},ye=async Le=>{Xe("isPaused",Le),await we(Ve=>xe(Ve))()};function De(){d.c.publicDashboardUrlCopied()}return(0,n.jsxs)("div",{className:tt.configContainer,children:[Se&&(0,n.jsx)(B,{}),!Ke&&(0,n.jsx)(U.t,{mode:"edit"}),Oe&&(0,n.jsx)(_.D,{}),Te.length>0&&(0,n.jsx)(S.s,{unsupportedDataSources:Te.join(", ")}),(0,K.AY)()&&(0,n.jsx)(Y,{dashboard:He}),(0,n.jsx)(o.D,{label:(0,r.t)("public-dashboard.config.dashboard-url-field-label","Dashboard URL"),className:tt.fieldSpace,children:(0,n.jsx)(l.p,{value:(0,K.mL)(_e.accessToken),readOnly:!0,disabled:!_e?.isEnabled,"data-testid":ce.CopyUrlInput,addonAfter:(0,n.jsx)(g.b,{"data-testid":ce.CopyUrlButton,variant:"primary",disabled:!_e?.isEnabled,getText:()=>(0,K.mL)(_e.accessToken),onClipboardCopy:De,children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.config.copy-button",children:"Copy"})})})}),(0,n.jsx)(o.D,{className:tt.fieldSpace,children:(0,n.jsxs)(f.B,{children:[(0,n.jsx)(p.d,{...nt("isPaused"),disabled:Ue,onChange:Le=>{d.c.publicDashboardPauseSharingClicked({paused:Le.currentTarget.checked}),ye(Le.currentTarget.checked)},"data-testid":ce.PauseSwitch}),(0,n.jsx)(c.J,{className:(0,a.css)({marginBottom:0}),children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.config.pause-sharing-dashboard-label",children:"Pause sharing dashboard"})})]})}),(0,n.jsx)(o.D,{className:tt.fieldSpace,children:(0,n.jsx)(se,{title:(0,r.t)("public-dashboard.config.settings-title","Settings"),headerElement:({className:Le})=>(0,n.jsx)(fe,{className:Le,isDataLoading:je,timeRange:Re,timeSelectionEnabled:_e?.timeSelectionEnabled,annotationsEnabled:_e?.annotationsEnabled}),"data-testid":ce.SettingsDropdown,children:(0,n.jsx)(N,{disabled:Ue,onChange:me,register:nt,timeRange:Re})})}),(0,n.jsx)(f.B,{direction:Je?"row":"column",justifyContent:Je?"flex-end":"flex-start",alignItems:Je?"center":"stretch",children:(0,n.jsx)(x.Gy,{justify:"flex-end",children:(0,n.jsx)(v.$n,{title:(0,r.t)("public-dashboard.config.revoke-public-URL-button-title","Revoke public URL"),onClick:Ee,type:"button",disabled:Ue,"data-testid":ce.DeleteButton,variant:"destructive",fill:"outline",children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.config.revoke-public-URL-button",children:"Revoke public URL"})})})})]})}function ve({publicDashboard:Ee,unsupportedDatasources:Re}){const Se=(0,D.d4)(Ge=>Ge.dashboard).getModel(),Te=(0,h.z)(Se.getDefaultTime(),Se),_e=C.TP.hasPermission(b.w.DashboardsPublicWrite),He=(0,K.kD)(Se.getVariables()),[tt]=(0,y.bN)(),Je=Ge=>{tt({dashboard:Se,uid:Ee.uid,dashboardUid:Se.uid}),Ge()};return(0,n.jsx)(m.$s,{children:({showModal:Ge,hideModal:je})=>(0,n.jsx)(ie,{publicDashboard:Ee,dashboard:Se,unsupportedDatasources:Re,timeRange:Te,showSaveChangesAlert:_e&&Se.hasUnsavedChanges(),hasTemplateVariables:He,onRevoke:()=>{d.c.revokePublicDashboardClicked(),Ge(E.m,{onConfirm:()=>Je(je),onDismiss:()=>{Ge(O.Zy,{dashboard:Se,onDismiss:je,activeTab:j.wr.publicDashboard})}})}})})}const le=Ee=>({configContainer:(0,a.css)({label:"config container",display:"flex",flexDirection:"column",flexWrap:"wrap",gap:Ee.spacing(3)}),fieldSpace:(0,a.css)({label:"field space",width:"100%",marginBottom:0}),timeRange:(0,a.css)({display:"inline-block"})})},58375:(te,R,e)=>{"use strict";e.d(R,{M:()=>U,D:()=>j});var n=e(74848),a=e(22803),s=e(49785),i=e(51898),r=e(92745),u=e(63142),o=e(45861),l=e(68079),g=e(15130),f=e(62905),p=e(23289),c=e(11257),x=e(52763),v=e(35195),m=e(37672),y=e(44173),h=e(24313),d=e(55066),E=e(16780),b=e(32881),D=e(32635);const C=i.Tp.pages.ShareDashboardModal.PublicDashboard,P=({disabled:B,register:S})=>{const _=(0,u.of)(M),K=[{type:"publicAcknowledgment",description:(0,r.t)("public-dashboard.acknowledgment-checkboxes.public-ack-desc","Your entire dashboard will be public*"),testId:C.WillBePublicCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/dashboards/dashboard-public/",tooltip:(0,r.t)("public-dashboard.acknowledgment-checkboxes.public-ack-tooltip","Learn more about public dashboards")}},{type:"dataSourcesAcknowledgment",description:(0,r.t)("public-dashboard.acknowledgment-checkboxes.data-src-ack-desc","Publishing currently only works with a subset of data sources*"),testId:C.LimitedDSCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/datasources/",tooltip:(0,r.t)("public-dashboard.acknowledgment-checkboxes.data-src-ack-tooltip","Learn more about public datasources")}},{type:"usageAcknowledgment",description:(0,r.t)("public-dashboard.acknowledgment-checkboxes.usage-ack-desc","Making a dashboard public will cause queries to run each time it is viewed, which may increase costs*"),testId:C.CostIncreaseCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/enterprise/query-caching/",tooltip:(0,r.t)("public-dashboard.acknowledgment-checkboxes.usage-ack-desc-tooltip","Learn more about query caching")}}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:_.title,children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.acknowledgment-checkboxes.ack-title",children:"Before you make the dashboard public, acknowledge the following:"})}),(0,n.jsx)(E.n,{disabled:B,children:(0,n.jsx)(b.gW,{spacing:"md",children:K.map(T=>(0,n.jsxs)(b.Gy,{spacing:"none",align:"center",children:[(0,n.jsx)(D.S,{...S(T.type,{required:!0}),label:T.description,"data-testid":T.testId}),(0,n.jsx)(o.z9,{variant:"primary",href:T.info.href,target:"_blank",fill:"text",icon:"info-circle",rel:"noopener noreferrer",tooltip:T.info.tooltip})]},T.type))})})]})},M=B=>({title:(0,a.css)({fontWeight:B.typography.fontWeightBold})}),O=i.Tp.pages.ShareDashboardModal.PublicDashboard,j=({unsupportedDatasources:B=[],unsupportedTemplateVariables:S=!1,dashboard:_,hasError:K=!1})=>{const T=(0,u.of)(W),L=g.TP.hasPermission(c.w.DashboardsPublicWrite),[A,{isLoading:N,isError:V}]=(0,f.U9)(),z=()=>{A({dashboard:_,payload:{isEnabled:!0}}),p.c.generatePublicDashboardUrlClicked({})},{handleSubmit:w,register:H,formState:{isValid:Q}}=(0,s.mN)({mode:"onChange"}),Z=!L||N||V||K;return(0,n.jsxs)("div",{className:T.container,children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:T.title,children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.create-page.welcome-title",children:"Welcome to public dashboards!"})}),(0,n.jsx)("p",{className:T.description,children:(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.create-page.unsupported-features-desc",children:"Currently, we don\u2019t support template variables or frontend data sources"})})]}),!L&&(0,n.jsx)(v.t,{mode:"create"}),S&&(0,n.jsx)(y.D,{}),B.length>0&&(0,n.jsx)(m.s,{unsupportedDataSources:B.join(", ")}),(0,n.jsxs)("form",{onSubmit:w(z),children:[(0,n.jsx)("div",{className:T.checkboxes,children:(0,n.jsx)(P,{disabled:Z,register:H})}),(0,n.jsx)("div",{className:T.buttonContainer,children:(0,n.jsxs)(o.$n,{type:"submit",disabled:Z||!Q,"data-testid":O.CreateButton,children:[(0,n.jsx)(r.x6,{i18nKey:"public-dashboard.create-page.generate-public-url-button",children:"Generate public URL"}),N&&(0,n.jsx)(l.y,{className:T.loadingSpinner})]})})]})]})};function U({hasError:B}){const _=(0,x.d4)(L=>L.dashboard).getModel(),{unsupportedDataSources:K}=(0,d.Z)(_),T=(0,h.kD)(_.getVariables());return(0,n.jsx)(j,{dashboard:_,unsupportedDatasources:K,unsupportedTemplateVariables:T,hasError:B})}const W=B=>({container:(0,a.css)({display:"flex",flexDirection:"column",gap:B.spacing(4)}),title:(0,a.css)({fontSize:B.typography.h4.fontSize,margin:B.spacing(0,0,2)}),description:(0,a.css)({color:B.colors.text.secondary,marginBottom:B.spacing(0)}),checkboxes:(0,a.css)({margin:B.spacing(0,0,4)}),buttonContainer:(0,a.css)({display:"flex",justifyContent:"end"}),loadingSpinner:(0,a.css)({marginLeft:B.spacing(1)})})},35195:(te,R,e)=>{"use strict";e.d(R,{t:()=>o});var n=e(74848),a=e(51898),s=e(92745),i=e(43173),r=e(34999);const u=a.Tp.pages.ShareDashboardModal.PublicDashboard,o=({mode:l})=>{const g=i.$.featureToggles.newDashboardSharingComponent?(0,s.t)("public-dashboard.share-externally.no-upsert-perm-alert-title","You don\u2019t have permission to {{ action }} a shared dashboard",{action:l}):(0,s.t)("public-dashboard.modal-alerts.no-upsert-perm-alert-title","You don\u2019t have permission to {{ action }} a public dashboard",{action:l});return(0,n.jsx)(r.F,{severity:"warning",title:g,"data-testid":u.NoUpsertPermissionsWarningAlert,bottomSpacing:0,children:i.$.featureToggles.newDashboardSharingComponent?(0,n.jsxs)(s.x6,{i18nKey:"public-dashboard.share-externally.no-upsert-perm-alert-desc",children:["Contact your admin to get permission to ",{action:l}," shared dashboards"]}):(0,n.jsxs)(s.x6,{i18nKey:"public-dashboard.modal-alerts.no-upsert-perm-alert-desc",children:["Contact your admin to get permission to ",{action:l}," public dashboards"]})})}},37672:(te,R,e)=>{"use strict";e.d(R,{s:()=>p});var n=e(74848),a=e(22803),s=e(46942),i=e.n(s),r=e(51898),u=e(92745),o=e(43173),l=e(63142),g=e(34999);const f=r.Tp.pages.ShareDashboardModal.PublicDashboard,p=({unsupportedDataSources:x})=>{const v=(0,l.of)(c);return(0,n.jsxs)(g.F,{severity:"warning",title:(0,u.t)("public-dashboard.modal-alerts.unsupported-data-source-alert-title","Unsupported data sources"),"data-testid":f.UnsupportedDataSourcesWarningAlert,bottomSpacing:0,children:[(0,n.jsx)("p",{className:v.unsupportedDataSourceDescription,children:o.$.featureToggles.newDashboardSharingComponent?(0,n.jsxs)(u.x6,{i18nKey:"public-dashboard.share-externally.unsupported-data-source-alert-desc",children:["There are data sources in this dashboard that are unsupported for shared dashboards. Panels that use these data sources may not function properly: ",{unsupportedDataSources:x},"."]}):(0,n.jsxs)(u.x6,{i18nKey:"public-dashboard.modal-alerts.unsupported-data-source-alert-desc",children:["There are data sources in this dashboard that are unsupported for public dashboards. Panels that use these data sources may not function properly: ",{unsupportedDataSources:x},"."]})}),(0,n.jsx)("a",{href:o.$.featureToggles.newDashboardSharingComponent?"https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/shared-dashboards/#supported-data-sources":"https://grafana.com/docs/grafana/v11.2/dashboards/dashboard-public/#supported-data-sources",target:"blank",className:i()("text-link",v.unsupportedDataSourceDescription),children:(0,n.jsx)(u.x6,{i18nKey:"public-dashboard.modal-alerts.unsupport-data-source-alert-readmore-link",children:"Read more about supported data sources"})})]})},c=x=>({unsupportedDataSourceDescription:(0,a.css)({color:x.colors.text.secondary,marginBottom:x.spacing(1)})})},44173:(te,R,e)=>{"use strict";e.d(R,{D:()=>u});var n=e(74848),a=e(51898),s=e(92745),i=e(34999);const r=a.Tp.pages.ShareDashboardModal.PublicDashboard,u=({showDescription:o=!0})=>(0,n.jsx)(i.F,{severity:"warning",title:(0,s.t)("public-dashboard.modal-alerts.unsupported-template-variable-alert-title","Template variables are not supported"),"data-testid":r.TemplateVariablesWarningAlert,bottomSpacing:0,children:o&&(0,n.jsx)(s.x6,{i18nKey:"public-dashboard.modal-alerts.unsupported-template-variable-alert-desc",children:"This public dashboard may not work since it uses template variables"})})},82298:(te,R,e)=>{"use strict";e.d(R,{a:()=>x,b:()=>v});var n=e(74848),a=e(22803),s=e(92745),i=e(63142),r=e(68079),u=e(62905),o=e(24313),l=e(52763),g=e(40203),f=e(72973),p=e(58375),c=e(55066);const x=()=>{const y=(0,i.of)(m);return(0,n.jsx)(g.G,{className:y.loadingContainer,children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.x6,{i18nKey:"dashboard.share-public-dashboard-loader.loading-configuration",children:"Loading configuration"}),(0,n.jsx)(r.y,{size:"lg",className:y.spinner})]})})},v=y=>{const{data:h,isLoading:d,isError:E}=(0,u.Bs)(y.dashboard.uid),D=(0,l.d4)(P=>P.dashboard).getModel(),{unsupportedDataSources:C}=(0,c.Z)(D);return(0,n.jsx)(n.Fragment,{children:d?(0,n.jsx)(x,{}):(0,o.lI)(h)?(0,n.jsx)(f.K,{publicDashboard:h,unsupportedDatasources:C}):(0,n.jsx)(p.M,{hasError:E})})},m=y=>({loadingContainer:(0,a.css)({height:"280px",alignItems:"center",justifyContent:"center",gap:y.spacing(1)}),spinner:(0,a.css)({marginBottom:y.spacing(0)})})},24313:(te,R,e)=>{"use strict";e.d(R,{AY:()=>y,Xo:()=>l,_A:()=>p,_l:()=>v,gN:()=>x,iR:()=>m,kD:()=>g,lI:()=>f,mL:()=>c});var n=e(36580),a=e(43173),s=e(62061),i=e(65642),r=e(28998),u=e(58662),o=e(35143),l=(h=>(h.PUBLIC="public",h.EMAIL="email",h))(l||{});const g=h=>h.length>0,f=h=>h?.uid!==""&&h?.uid!==void 0,p=async h=>{let d=new Set;for(const E of h)for(const b of E.targets){const D=b?.datasource?.type;D&&(o.z.has(D)&&await(0,r.tR)().get(b.datasource)instanceof n.iy||d.add(D))}return Array.from(d).sort()},c=h=>`${(0,i.zj)().appUrl}public-dashboards/${h}`,x=(h,d)=>`/d/${h}/${d}?shareView=${u.wr.publicDashboard}`,v=/^[A-Z\d._%+-]+@[A-Z\d.-]+\.[A-Z]{2,}$/i,m=()=>a.$.publicDashboardsEnabled,y=()=>m()&&!!a.$.featureToggles.publicDashboardsEmailSharing&&(0,s.a)("publicDashboardsEmailSharing")},35143:(te,R,e)=>{"use strict";e.d(R,{z:()=>n});const n=new Set(["__expr__","aggregations-io-datasource","apache-iotdb-datasource","aquaqanalytics-kdbbackend-datasource","arabian9ts-mux-datasource","axiomhq-axiom-datasource","cloudwatch","cnos-cnosdb-datasource","criblcloud-search-datasource","datasource","dlopes7-appdynamics-datasource","dvelop-odata-datasource","elasticsearch","factry-historian-datasource","fiskaly-surrealdb-datasource","frser-sqlite-datasource","grafadruid-druid-datasource","grafana-adobeanalytics-datasource","grafana-amazonprometheus-datasource","grafana-athena-datasource","grafana-aurora-datasource","grafana-azure-data-explorer-datasource","grafana-azure-monitor-datasource","grafana-azurecosmosdb-datasource","grafana-bigquery-datasource","grafana-catchpoint-datasource","grafana-clickhouse-datasource","grafana-cloudflare-datasource","grafana-cockroachdb-datasource","grafana-databricks-datasource","grafana-datadog-datasource","grafana-dynamodb-datasource","grafana-dynatrace-datasource","grafana-falconlogscale-datasource","grafana-github-datasource","grafana-gitlab-datasource","grafana-honeycomb-datasource","grafana-iot-sitewise-datasource","grafana-jira-datasource","grafana-looker-datasource","grafana-mock-datasource","grafana-mongodb-datasource","grafana-newrelic-datasource","grafana-odbc-datasource","grafana-opensearch-datasource","grafana-oracle-datasource","grafana-pagerduty-datasource","grafana-postgresql-datasource","grafana-redshift-datasource","grafana-salesforce-datasource","grafana-saphana-datasource","grafana-sentry-datasource","grafana-servicenow-datasource","grafana-snowflake-datasource","grafana-splunk-datasource","grafana-splunk-monitoring-datasource","grafana-sumologic-datasource","grafana-surrealdb-datasource","grafana-testdata-datasource","grafana-timestream-datasource","grafana-vercel-datasource","grafana-wavefront-datasource","grafana-x-ray-datasource","grafana-yugabyte-datasource","grafana-zendesk-datasource","graphite","gridprotectionalliance-osisoftpi-datasource","hadesarchitect-cassandra-datasource","ibm-aql-datasource","influxdb","innius-grpc-datasource","kniepdennis-neo4j-datasource","loki","manassehzhou-maxcompute-datasource","maormil-rabbitmq-datasource","marcusolsson-csv-datasource","mssql","mysql","nagasudhirpulla-api-datasource","needleinajaystack-haystack-datasource","oci-metrics-datasource","opentsdb","parseable-parseable-datasource","prometheus","questdb-questdb-datasource","quickwit-quickwit-datasource","redis-datasource","retrodaredevil-wildgraphql-datasource","stackdriver","tdengine-datasource","trino-datasource","vertamedia-clickhouse-datasource","vertica-grafana-datasource","victoriametrics-logs-datasource","victoriametrics-metrics-datasource","ydbtech-ydb-datasource","yesoreyeram-infinity-datasource"])},55066:(te,R,e)=>{"use strict";e.d(R,{Z:()=>s});var n=e(96540),a=e(24313);const s=i=>{const[r,u]=(0,n.useState)([]);return(0,n.useEffect)(()=>{(async()=>await(0,a._A)(i.panels))().then(l=>{u(l)})},[i.panels]),{unsupportedDataSources:r}}},29216:(te,R,e)=>{"use strict";e.d(R,{w:()=>r});var n=e(74848),a=e(92745),s=e(37386),i=e(77824);const r=({selectedTheme:u="current",onChange:o,description:l})=>{const g=[{label:(0,a.t)("share-modal.theme-picker.current","Current"),value:"current"},{label:(0,a.t)("share-modal.theme-picker.dark","Dark"),value:"dark"},{label:(0,a.t)("share-modal.theme-picker.light","Light"),value:"light"}];return(0,n.jsx)(s.D,{label:(0,a.t)("share-modal.theme-picker.field-name","Theme"),description:l,children:(0,n.jsx)(i.z,{options:g,value:u,onChange:o})})}},58662:(te,R,e)=>{"use strict";e.d(R,{CF:()=>x,Lb:()=>c,P_:()=>g,XV:()=>l,Xe:()=>f,hD:()=>m,wr:()=>y});var n=e(17548),a=e(83175),s=e(92138),i=e(25229),r=e(43173),u=e(71673),o=e(75421);function l({useCurrentTimeRange:h,selectedTheme:d,panel:E,search:b=window.location.search,range:D=(0,o.jG)().timeRange(),orgId:C=r.$.bootData.user.orgId}){const P=new URLSearchParams(b),M=E?.timeFrom;if(M){const{from:O,to:j}=n.describeTextRange(M);P.set("from",O),P.set("to",j)}else P.set("from",String(D.from.valueOf())),P.set("to",String(D.to.valueOf()));return P.set("orgId",String(C)),h||(P.delete("from"),P.delete("to")),d!=="current"&&P.set("theme",d),E&&!P.has("editPanel")&&P.set("viewPanel",String(E.id)),P.delete("auth_token"),P.delete("shareView"),P}function g(){let h=window.location.href;const d=h.indexOf("?");return d!==-1&&(h=h.substring(0,d)),h}async function f(h,d,E,b){const D=g(),C=l({useCurrentTimeRange:h,selectedTheme:d,panel:E}),P=a.kM.appendQueryToUrl(D,C.toString());return b?await(0,u.fn)(P):P}function p(h,d,E,b,D){const C=g(),P=l({useCurrentTimeRange:h,selectedTheme:E,panel:b,range:D});let M=C.replace(r.$.appSubUrl+"/dashboard/",r.$.appSubUrl+"/dashboard-solo/");M=M.replace(r.$.appSubUrl+"/d/",r.$.appSubUrl+"/d-solo/"),s.I.stripBaseFromUrl(C)==="/"&&(M=`${r.$.appUrl}d-solo/${d}`);const j=P.get("editPanel")??P.get("viewPanel")??"";return P.set("panelId",j),P.delete("editPanel"),P.delete("viewPanel"),a.kM.appendQueryToUrl(M,P.toString())}function c(h,d,E,b){let C=p(h,d,E,b).replace(r.$.appSubUrl+"/dashboard-solo/",r.$.appSubUrl+"/render/dashboard-solo/");return C=C.replace(r.$.appSubUrl+"/d-solo/",r.$.appSubUrl+"/render/d-solo/"),C+=`&width=${r.$.rendererDefaultImageWidth}&height=${r.$.rendererDefaultImageHeight}&scale=${r.$.rendererDefaultImageScale}`+v(),C}function x(h,d,E,b,D){return`<iframe src="${p(h,d,E,b,D)}" width="450" height="200" frameborder="0"></iframe>`}function v(){const h="&tz=UTC"+encodeURIComponent((0,i.KQ)().format("Z"));if(!window.Intl)return h;const d=window.Intl.DateTimeFormat();if(!d.resolvedOptions)return h;const E=d.resolvedOptions();return E.timeZone?"&tz="+encodeURIComponent(E.timeZone):h}const m=h=>h?"panel":"dashboard",y={link:"link",snapshot:"snapshot",export:"export",embed:"embed",libraryPanel:"library_panel",pdf:"pdf",report:"report",publicDashboard:"public_dashboard",inviteUser:"invite_user"}},4137:(te,R,e)=>{"use strict";e.d(R,{Zx:()=>C,aK:()=>h});var n=e(74848),a=e(22803),s=e(96540),i=e(16817),r=e(63704),u=e(51898),o=e(92745),l=e(63142),g=e(87063),f=e(92807),p=e(88559),c=e(30703),x=e(45861),v=e(83873),m=e(82345);function y({dashboardUID:P,link:M}){const O=(0,l.of)(D),j=d({dashboardUID:P,link:M});return!j||b.length===0?null:(0,n.jsx)(g.W,{children:(0,n.jsx)("div",{className:O.dropdown,children:(0,n.jsx)(f.P,{maxHeight:"inherit",children:j.map((U,W)=>(0,n.jsx)(g.W.Item,{url:U.url,target:M.targetBlank?"_blank":void 0,label:U.title,testId:u.Tp.components.DashboardLinks.link,"aria-label":(0,o.t)("dashboard.dashboard-links-menu.aria-label-dashboard-name","{{dashboardName}} dashboard",{dashboardName:U.title})},`dashlinks-dropdown-item-${U.uid}-${W}`))})})})}const h=P=>{const{link:M,linkInfo:O,dashboardUID:j}=P,U=d(P),W=(0,l.of)(D);return M.asDropdown?(0,n.jsx)(p.m,{overlay:(0,n.jsx)(y,{link:M,dashboardUID:j}),children:(0,n.jsxs)(C,{"data-placement":"bottom","data-toggle":"dropdown","aria-controls":"dropdown-list","aria-haspopup":"menu",fill:"outline",variant:"secondary","data-testid":u.Tp.components.DashboardLinks.dropDown,children:[(0,n.jsx)(c.I,{"aria-hidden":!0,name:"bars",className:W.iconMargin}),(0,n.jsx)("span",{children:O.title})]})}):(0,n.jsx)(n.Fragment,{children:U.length>0&&U.map((B,S)=>(0,n.jsx)(C,{icon:"apps",variant:"secondary",fill:"outline",href:B.url,target:M.targetBlank?"_blank":void 0,rel:"noreferrer","data-testid":u.Tp.components.DashboardLinks.link,children:B.title},`dashlinks-list-item-${B.uid}-${S}`))})},d=({link:P,dashboardUID:M})=>{const{tags:O}=P,j=(0,i.A)(()=>E(O),[O]);return j.value?b(M,P,j.value):[]};async function E(P,M={getBackendSrv:v.AI}){return await M.getBackendSrv().search({tag:P,limit:100})}function b(P,M,O,j={getLinkSrv:m.mQ,sanitize:r.aj,sanitizeUrl:r.Jf}){return O.filter(U=>U.uid!==P).map(U=>{const W=U.uid,B=j.sanitize(U.title),S=j.getLinkSrv().getLinkUrl({...M,url:U.url}),_=j.sanitizeUrl(S);return{uid:W,title:B,url:_}})}function D(P){return{iconMargin:(0,a.css)({marginRight:P.spacing(.5)}),dropdown:(0,a.css)({maxWidth:"max(30vw, 300px)",maxHeight:"70vh"}),button:(0,a.css)({color:P.colors.text.primary}),dashButton:(0,a.css)({fontSize:P.typography.bodySmall.fontSize,paddingLeft:P.spacing(1),paddingRight:P.spacing(1)})}}const C=(0,s.forwardRef)(({className:P,...M},O)=>{const j=(0,l.of)(D),U=M.href?x.z9:x.$n;return(0,n.jsx)(U,{...M,variant:"secondary",fill:"outline",className:(0,a.cx)(P,j.dashButton),ref:O})});C.displayName="DashboardLinkButton"},47350:(te,R,e)=>{"use strict";e.d(R,{A:()=>A});var n=e(74848),a=e(8642),s=e(96540),i=e(42941),r=e(69862),u=e(57866),o=e(36638),l=e(2197),g=e(51898),f=e(92745),p=e(27489),c=e(2863),x=e(71599),v=e(43260),m=e(85348),y=e(65642),h=e(85622),d=e(22803),E=e(63142),b=e(8207),D=e(50275),C=e(30703);const P=({input:N,output:V,debugMode:z,index:w,uiConfig:H,configs:Q,onChange:Z,toggleShowDebug:Y})=>{const X=(0,E.of)(M),I=(0,s.useMemo)(()=>Q[w],[Q,w]),J=(0,s.useMemo)(()=>(0,s.createElement)(H.editor,{options:{...H.transformation.defaultOptions,...I.transformation.options},input:N,onChange:ee=>{Z(w,{...I.transformation,options:ee})}}),[H.editor,H.transformation.defaultOptions,I.transformation,N,Z,w]);return(0,n.jsxs)("div",{"data-testid":g.Tp.components.TransformTab.transformationEditor(H.name),children:[J,z&&(0,n.jsx)(b._,{title:(0,f.t)("dashboard.transformation-editor.title-debug-transformation","Debug transformation"),subtitle:H.name,onClose:Y,children:(0,n.jsxs)("div",{className:X.debugWrapper,"data-testid":g.Tp.components.TransformTab.transformationEditorDebugger(H.name),children:[(0,n.jsxs)("div",{className:X.debug,children:[(0,n.jsx)("div",{className:X.debugTitle,children:(0,n.jsx)(f.x6,{i18nKey:"dashboard.transformation-editor.input-data",children:"Input data"})}),(0,n.jsx)("div",{className:X.debugJson,children:(0,n.jsx)(D.B,{json:N})})]}),(0,n.jsx)("div",{className:X.debugSeparator,children:(0,n.jsx)(C.I,{name:"arrow-right"})}),(0,n.jsxs)("div",{className:X.debug,children:[(0,n.jsx)("div",{className:X.debugTitle,children:(0,n.jsx)(f.x6,{i18nKey:"dashboard.transformation-editor.output-data",children:"Output data"})}),(0,n.jsx)("div",{className:X.debugJson,children:V&&(0,n.jsx)(D.B,{json:V})})]})]})})]})},M=N=>({debugWrapper:(0,d.css)({display:"flex",flexDirection:"row"}),debugSeparator:(0,d.css)({width:"48px",minHeight:"300px",display:"flex",alignItems:"center",alignSelf:"stretch",justifyContent:"center",margin:`0 ${N.spacing(.5)}`,color:N.colors.primary.text}),debugTitle:(0,d.css)({padding:`${N.spacing(1)} ${N.spacing(.25)}`,fontFamily:N.typography.fontFamilyMonospace,fontSize:N.typography.bodySmall.fontSize,color:N.colors.text.primary,borderBottom:`1px solid ${N.colors.border.weak}`,flexGrow:0,flexShrink:1}),debug:(0,d.css)({marginTop:N.spacing(1),padding:`0 ${N.spacing(1,1,1)}`,border:`1px solid ${N.colors.border.weak}`,background:`${N.isLight?N.v1.palette.white:N.v1.palette.gray05}`,borderRadius:N.shape.radius.default,width:"100%",minHeight:"300px",display:"flex",flexDirection:"column",alignSelf:"stretch"}),debugJson:(0,d.css)({flexGrow:1,height:"100%",overflow:"hidden",padding:N.spacing(.5)})});var O=e(68805),j=e(84510);const U=({isOpen:N,onCloseClick:V,transformer:z})=>{const{transformation:{name:w},help:H}=z,Q=H||(0,j.$n)(),Z=(0,n.jsx)(b._,{title:w,subtitle:"Transformation help",onClose:()=>V(!1),children:(0,n.jsx)(O.j,{markdown:Q,styleOverrides:{borderTop:"2px solid"}})});return N?Z:null};var W=e(739),B=e(37386),S=e(18857),_=e(42240);const K=({index:N,annotations:V,config:z,onChange:w,data:H})=>{const Q=(0,E.of)(T),Z=(0,s.useMemo)(()=>({context:{data:H},showTopic:!0,showFilter:z.topic!==W.QR.Annotations,source:[{value:W.QR.Series,label:"Query and Transformation results"},{value:W.QR.Annotations,label:"Annotation data"}]}),[H,V?.length,z.topic]);return(0,n.jsx)("div",{className:Q.wrapper,children:(0,n.jsx)(B.D,{label:(0,f.t)("dashboard.transformation-filter.label-apply-transformation-to","Apply transformation to"),children:(0,n.jsxs)(n.Fragment,{children:[Z.showTopic&&(0,n.jsx)(S.l6,{isClearable:!0,options:Z.source,value:Z.source.find(Y=>Y.value===z.topic),placeholder:Z.source[0].label,className:Q.padded,onChange:Y=>{w(N,{...z,topic:Y?.value})}}),Z.showFilter&&(0,n.jsx)(_.M,{value:z.filter,context:Z.context,onChange:Y=>w(N,{...z,filter:Y})})]})})})},T=N=>{const V=N.shape.radius.default;return{wrapper:(0,d.css)({padding:N.spacing(2),border:`2px solid ${N.colors.background.secondary}`,borderTop:"none",borderRadius:`0 0 ${V} ${V}`,position:"relative",top:"-4px"}),padded:(0,d.css)({marginBottom:N.spacing(1)})}},L=({onRemove:N,index:V,id:z,data:w,configs:H,uiConfig:Q,onChange:Z})=>{const[Y,X]=(0,i.A)(!1),[I,J]=(0,i.A)(!1),[ee,q]=(0,i.A)(!1),ne=!!H[V].transformation.disabled,se=H[V].transformation.topic,oe=H[V].transformation.filter!=null||se!=null,de=oe||w.series.length>0||(w.annotations?.length??0)>0,[fe,ae]=(0,s.useState)([]),[ce,ie]=(0,s.useState)([]),[ve,le]=(0,s.useState)([]),Ee=(0,s.useCallback)(Te=>{const _e=H[Te].transformation;Z(Te,{..._e,disabled:_e.disabled?void 0:!0})},[Z,H]),Re=(0,s.useCallback)(()=>{let Te={...H[V].transformation};Te.filter?delete Te.filter:Te.filter={id:u.jR.byRefId,options:""},Z(V,Te)},[Z,V,H]),Oe=(0,s.useCallback)((Te,_e,He)=>tt=>{let Je="panel_editor_tabs_transformations_toggle";y.Ay.featureToggles.transformationsRedesign&&(Je="transformations_redesign_"+Je),(0,p.rR)(Je,{action:He?"off":"on",toggleId:_e,transformationId:H[V].transformation.id}),Te(tt)},[H,V]);(0,s.useEffect)(()=>{const Te=H[V].transformation,_e=Te.filter?.options?(0,o.Dq)(Te.filter):void 0,He=V-1;let tt=[],Je=[];He>=0&&(tt=H.slice(0,He).map(we=>we.transformation),Je=H.slice(He,V).map(we=>we.transformation));const Ge=H.slice(0,V).map(we=>we.transformation),je=H.slice(V,V+1).map(we=>we.transformation),Fe={interpolate:we=>(0,c.w)().replace(we)},Be=(0,l.m)(Ge,w.series,Fe).subscribe(we=>{_e&&(we=we.filter(Xe=>_e(Xe))),ae(we)}),Ke=(0,l.m)(Ge,w.series,Fe).pipe((0,r.Z)(we=>(0,l.m)(je,we,Fe))).subscribe(ie),Ue=(0,l.m)(tt,w.series,Fe).pipe((0,r.Z)(we=>(0,l.m)(Je,we,Fe))).subscribe(le);return function(){Be.unsubscribe(),Ke.unsubscribe(),Ue.unsubscribe()}},[V,w,H]);const Se=()=>(0,n.jsxs)(n.Fragment,{children:[Q.state&&(0,n.jsx)(h.p,{state:Q.state}),(0,n.jsx)(v.A,{title:(0,f.t)("dashboard.transformation-operation-row.render-actions.title-show-transform-help","Show transform help"),icon:"info-circle",onClick:Oe(q,"help",ee),active:ee}),de&&(0,n.jsx)(v.A,{title:(0,f.t)("dashboard.transformation-operation-row.render-actions.title-filter","Filter"),icon:"filter",onClick:Oe(Re,"filter",oe),active:oe}),(0,n.jsx)(v.A,{title:(0,f.t)("dashboard.transformation-operation-row.render-actions.title-debug","Debug"),icon:"bug",onClick:Oe(J,"debug",I),active:I}),(0,n.jsx)(v.A,{title:(0,f.t)("dashboard.transformation-operation-row.render-actions.title-disable-transformation","Disable transformation"),icon:ne?"eye-slash":"eye",onClick:Oe(()=>Ee(V),"disabled",ne),active:ne,dataTestId:g.Tp.components.Transforms.disableTransformationButton}),(0,n.jsx)(v.q,{title:(0,f.t)("dashboard.transformation-operation-row.render-actions.title-remove","Remove"),icon:"trash-alt",onClick:()=>y.Ay.featureToggles.transformationsRedesign?X(!0):N(V)}),y.Ay.featureToggles.transformationsRedesign&&(0,n.jsx)(x.u,{isOpen:Y,title:(0,f.t)("dashboard.transformation-operation-row.title-delete","Delete {{name}}?",{name:Q.name}),body:(0,f.t)("dashboard.transformation-operation-row.body-delete","Note that removing one transformation may break others. If there is only a single transformation, you will go back to the main selection screen."),confirmText:(0,f.t)("dashboard.transformation-operation-row.render-actions.confirmText-delete","Delete"),onConfirm:()=>{X(!1),N(V)},onDismiss:()=>X(!1)})]});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(m.u,{id:z,index:V,title:`${V+1} - ${Q.name}`,draggable:!0,actions:Se,disabled:ne,expanderMessages:{close:"Collapse transformation row",open:"Expand transformation row"},children:[oe&&(0,n.jsx)(K,{data:ve,index:V,config:H[V].transformation,annotations:w.annotations,onChange:Z}),(0,n.jsx)(P,{input:fe,output:ce,debugMode:I,index:V,configs:H,uiConfig:Q,onChange:Z,toggleShowDebug:J})]}),(0,n.jsx)(U,{transformer:Q,isOpen:ee,onCloseClick:q})]})},A=({data:N,onChange:V,onRemove:z,configs:w})=>(0,n.jsx)(n.Fragment,{children:w.map((H,Q)=>{const Z=a.h.getIfExists(H.transformation.id);return Z?(0,n.jsx)(L,{index:Q,id:`${H.id}`,data:N,configs:w,uiConfig:Z,onRemove:z,onChange:V},`${H.id}`):null})})},9284:(te,R,e)=>{"use strict";e.d(R,{R:()=>C});var n=e(74848),a=e(22803),s=e(96540),i=e(79319),r=e(64761),u=e(8642),o=e(51898),l=e(92745),g=e(63142),f=e(8207),p=e(63527),c=e(21285),x=e(34343),v=e(8073),m=e(76319),y=e(65642),h=e(85622),d=e(72598);const D=[["viewAll","View all"],...Object.entries(d.eJ)];function C(B){const S=(0,g.of)(P),{suffix:_,xforms:K,search:T,onSearchChange:L,onSearchKeyDown:A,showIllustrations:N,onTransformationAdd:V,selectedFilter:z,data:w,onClose:H,onShowIllustrationsChange:Q,onSelectedFilterChange:Z}=B,Y=(0,s.useCallback)(X=>{X?.click()},[]);return(0,n.jsxs)(f._,{size:"md",onClose:()=>{H&&H()},title:(0,l.t)("dashboard.transformation-picker-ng.title-add-another-transformation","Add another transformation"),children:[(0,n.jsxs)("div",{className:S.searchWrapper,children:[(0,n.jsx)(p.p,{"data-testid":o.Tp.components.Transforms.searchInput,className:S.searchInput,value:T??"",placeholder:(0,l.t)("dashboard.transformation-picker-ng.placeholder-search-for-transformation","Search for transformation"),onChange:L,onKeyDown:A,suffix:_,ref:Y,autoFocus:!0}),(0,n.jsxs)("div",{className:S.showImages,children:[(0,n.jsx)("span",{className:S.illustationSwitchLabel,children:(0,n.jsx)(l.x6,{i18nKey:"dashboard.transformation-picker-ng.show-images",children:"Show images"})})," ",(0,n.jsx)(c.d,{value:N,onChange:()=>Q&&Q(!N)})]})]}),(0,n.jsx)("div",{className:S.filterWrapper,children:D.map(([X,I])=>(0,n.jsx)(x.m,{onClick:()=>Z&&Z(X),label:I,selected:z===X},X))}),(0,n.jsx)(M,{showIllustrations:N,transformations:K,data:w,onClick:X=>{V({value:X})}})]})}function P(B){return{showImages:(0,a.css)({flexBasis:"0",display:"flex",gap:"8px",alignItems:"center"}),pickerInformationLine:(0,a.css)({fontSize:"16px",marginBottom:`${B.spacing(2)}`}),pickerInformationLineHighlight:(0,a.css)({verticalAlign:"middle"}),searchWrapper:(0,a.css)({display:"flex",flexWrap:"wrap",columnGap:"27px",rowGap:"16px",width:"100%"}),searchInput:(0,a.css)({flexGrow:"1",width:"initial"}),illustationSwitchLabel:(0,a.css)({whiteSpace:"nowrap"}),filterWrapper:(0,a.css)({padding:`${B.spacing(1)} 0`,display:"flex",flexWrap:"wrap",rowGap:`${B.spacing(1)}`,columnGap:`${B.spacing(.5)}`})}}function M({showIllustrations:B,transformations:S,onClick:_,data:K}){const T=(0,g.of)(O);return(0,n.jsx)("div",{className:T.grid,children:S.map(L=>{let A=i.M.Applicable;L.transformation.isApplicable!==void 0&&(A=L.transformation.isApplicable(K));const N=A>0;let V=null;L.transformation.isApplicableDescription!==void 0&&(typeof L.transformation.isApplicableDescription=="function"?V=L.transformation.isApplicableDescription(K):V=L.transformation.isApplicableDescription);let z=T.newCard;return N||(z=(0,a.cx)(T.newCard,T.cardDisabled)),(0,n.jsxs)(v.Z,{className:z,"data-testid":o.Tp.components.TransformTab.newTransform(L.name),onClick:()=>_(L.id),children:[(0,n.jsxs)(v.Z.Heading,{className:T.heading,children:[(0,n.jsx)("span",{children:L.name}),(0,n.jsx)("span",{className:T.pluginStateInfoWrapper,children:(0,n.jsx)(h.p,{state:L.state})})]}),(0,n.jsxs)(v.Z.Description,{className:T.description,children:[(0,n.jsx)("span",{children:W(L.id)}),B&&(0,n.jsx)("span",{children:(0,n.jsx)("img",{className:T.image,src:j(L.id,!N),alt:L.name})}),!N&&V!==null&&(0,n.jsx)(m.K,{className:T.cardApplicableInfo,name:"info-circle",tooltip:V})]})]},L.id)})})}function O(B){return{heading:(0,a.css)({fontWeight:400,"> button":{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"nowrap"}}),description:(0,a.css)({fontSize:"12px",display:"flex",flexDirection:"column",justifyContent:"space-between"}),image:(0,a.css)({display:"block",maxEidth:"100%`",marginTop:`${B.spacing(2)}`}),grid:(0,a.css)({display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gridAutoRows:"1fr",gap:`${B.spacing(2)} ${B.spacing(1)}`,width:"100%"}),cardDisabled:(0,a.css)({backgroundColor:"rgb(204, 204, 220, 0.045)",color:`${B.colors.text.disabled} !important`,img:{filter:"grayscale(100%)",opacity:.33}}),cardApplicableInfo:(0,a.css)({position:"absolute",bottom:`${B.spacing(1)}`,right:`${B.spacing(1)}`}),newCard:(0,a.css)({gridTemplateRows:"min-content 0 1fr 0"}),pluginStateInfoWrapper:(0,a.css)({marginLeft:"5px"})}}const j=(B,S)=>`public/build/img/transformations/${y.Ay.theme2.isDark?"dark":"light"}/${B}.svg`,U={[r.F.concatenate]:"Combine all fields into a single frame.",[r.F.configFromData]:"Set unit, min, max and more.",[r.F.fieldLookup]:"Use a field value to lookup countries, states, or airports.",[r.F.filterFieldsByName]:"Remove parts of the query results using a regex pattern.",[r.F.filterByRefId]:"Remove rows from the data based on origin query",[r.F.filterByValue]:"Remove rows from the query results using user-defined filters.",[r.F.groupBy]:"Group data by a field value and create aggregate data.",[r.F.groupingToMatrix]:"Summarize and reorganize data based on three fields.",[r.F.joinByField]:"Combine rows from 2+ tables, based on a related field.",[r.F.labelsToFields]:"Group series by time and return labels or tags as fields.",[r.F.merge]:"Merge multiple series. Values will be combined into one row.",[r.F.organize]:"Re-order, hide, or rename fields.",[r.F.partitionByValues]:"Split a one-frame dataset into multiple series.",[r.F.prepareTimeSeries]:"Stretch data frames from the wide format into the long format.",[r.F.reduce]:"Reduce all rows or data points to a single value (ex. max, mean).",[r.F.renameByRegex]:"Rename parts of the query results using a regular expression and replacement pattern.",[r.F.seriesToRows]:"Merge multiple series. Return time, metric and values as a row."},W=B=>U[B]||u.h.getIfExists(B)?.description||""},34176:(te,R,e)=>{"use strict";e.d(R,{o:()=>z,e:()=>N});var n=e(74848),a=e(89332),s=e(96540),i=e(8642),r=e(51898),u=e(92745),o=e(27489),l=e(76319),g=e(45861),f=e(71599),p=e(93256),c=e(92807),x=e(32881),v=e(63142),m=e(65642),y=e(80849),h=e(36490),d=e(41654),E=e(62667);function b({message:w}){const H=(0,s.useCallback)(()=>{h.Ny.partial({tab:E.M8.Query})},[]);return(0,n.jsx)("div",{style:{marginTop:"100px"},children:(0,n.jsx)(d.B,{direction:"row",justifyContent:"center",children:(0,n.jsxs)(d.B,{direction:"column",gap:2,children:[(0,n.jsx)("h2",{children:w}),(0,n.jsx)("div",{children:(0,n.jsx)(g.$n,{size:"md",variant:"secondary",icon:"arrow-left",onClick:H,children:(0,n.jsx)(u.x6,{i18nKey:"dashboard.panel-not-supported.go-back-to-queries",children:"Go back to Queries"})})})]})})})}var D=e(47350),C=e(22803),P=e(28882),M=e(34999),O=e(63527),j=e(8073),U=e(36321);const W={[P.f.Transformations]:"https://grafana.com/docs/grafana/latest/panels/transformations",[P.f.FieldConfig]:"https://grafana.com/docs/grafana/latest/panels/field-configuration-options/",[P.f.FieldConfigOverrides]:"https://grafana.com/docs/grafana/latest/panels/field-configuration-options/#override-a-field"},B=w=>W[w];var S=e(85622);const _="dashboard.components.TransformationEditor.featureInfoBox.isDismissed";function K(w){const{noTransforms:H,search:Q,xforms:Z,onSearchChange:Y,onSearchKeyDown:X,onTransformationAdd:I,suffix:J}=w;return(0,n.jsxs)(x.gW,{children:[H&&(0,n.jsx)(x.mc,{grow:1,children:(0,n.jsx)(U.b,{storageKey:_,defaultValue:!1,children:(ee,q)=>ee?null:(0,n.jsxs)(M.F,{title:(0,u.t)("dashboard.transformation-picker.title-transformations","Transformations"),severity:"info",onRemove:()=>{q(!0)},children:[(0,n.jsxs)("p",{children:[(0,n.jsx)(u.x6,{i18nKey:"dashboard.transformation-picker.info",children:"Transformations allow you to join, calculate, re-order, hide, and rename your query results before they are visualized."}),(0,n.jsx)("br",{}),(0,n.jsx)(u.x6,{i18nKey:"dashboard.transformation-picker.info-graph-not-suitable",children:"Many transforms are not suitable if you're using the Graph visualization, as it currently only supports time series data."}),(0,n.jsx)("br",{}),(0,n.jsxs)(u.x6,{i18nKey:"dashboard.transformation-picker.info-switch-to-table",children:["It can help to switch to the Table visualization to understand what a transformation is doing."," "]})]}),(0,n.jsx)("a",{href:B(P.f.Transformations),className:"external-link",target:"_blank",rel:"noreferrer",children:(0,n.jsx)(u.x6,{i18nKey:"dashboard.transformation-picker.read-more",children:"Read more"})})]})})}),(0,n.jsx)(O.p,{"data-testid":r.Tp.components.Transforms.searchInput,value:Q??"",autoFocus:!H,placeholder:(0,u.t)("dashboard.transformation-picker.placeholder-search-for-transformation","Search for transformation"),onChange:Y,onKeyDown:X,suffix:J}),Z.map(ee=>(0,n.jsx)(T,{transform:ee,onClick:()=>{I({value:ee.id})}},ee.name))]})}function T({transform:w,onClick:H}){const Q=(0,v.of)(L);return(0,n.jsxs)(j.Z,{className:Q.card,"data-testid":r.Tp.components.TransformTab.newTransform(w.name),onClick:H,children:[(0,n.jsx)(j.Z.Heading,{children:w.name}),(0,n.jsx)(j.Z.Description,{children:w.description}),w.state&&(0,n.jsx)(j.Z.Tags,{children:(0,n.jsx)(S.p,{state:w.state})})]})}function L(w){return{card:(0,C.css)({margin:"0",padding:`${w.spacing(1)}`})}}var A=e(9284);const N="viewAll";class V extends s.PureComponent{constructor(H){super(H),this.onSearchChange=Y=>{this.setState({search:Y.target.value})},this.onSearchKeyDown=Y=>{if(Y.key==="Enter"){const{search:X}=this.state;if(X){const I=X.toLowerCase(),J=i.h.list().filter(ee=>(ee.name+ee.description).toLowerCase().indexOf(I)>=0);J.length>0&&this.onTransformationAdd({value:J[0].id})}}else Y.keyCode===27&&(this.setState({search:"",showPicker:!1}),Y.stopPropagation())},this.getTransformationNextId=Y=>{const{transformations:X}=this.state;let I=0;const J=X.filter(ee=>ee.id.startsWith(Y)).map(ee=>ee.id);return J.length!==0&&(I=Math.max(...J.map(ee=>parseInt(ee.match(/\d+/)[0],10)))+1),`${Y}-${I}`},this.onTransformationAdd=Y=>{let X="panel_editor_tabs_transformations_management";m.Ay.featureToggles.transformationsRedesign&&(X="transformations_redesign_"+X),(0,o.rR)(X,{action:"add",transformationId:Y.value});const{transformations:I}=this.state,J=this.getTransformationNextId(Y.value);this.setState({search:"",showPicker:!1}),this.onChange([...I,{id:J,transformation:{id:Y.value,options:{}}}])},this.onTransformationChange=(Y,X)=>{const{transformations:I}=this.state,J=Array.from(I);let ee="panel_editor_tabs_transformations_management";m.Ay.featureToggles.transformationsRedesign&&(ee="transformations_redesign_"+ee),(0,o.rR)(ee,{action:"change",transformationId:J[Y].transformation.id}),J[Y].transformation=X,this.onChange(J)},this.onTransformationRemove=Y=>{const{transformations:X}=this.state,I=Array.from(X);let J="panel_editor_tabs_transformations_management";m.Ay.featureToggles.transformationsRedesign&&(J="transformations_redesign_"+J),(0,o.rR)(J,{action:"remove",transformationId:I[Y].transformation.id}),I.splice(Y,1),this.onChange(I)},this.onTransformationRemoveAll=()=>{this.onChange([]),this.setState({showRemoveAllModal:!1})},this.onDragEnd=Y=>{const{transformations:X}=this.state;if(!Y||!Y.destination)return;const I=Y.source.index,J=Y.destination.index;if(I===J)return;const ee=Array.from(X),[q]=ee.splice(I,1);ee.splice(J,0,q),this.onChange(ee)},this.renderEmptyMessage=()=>(0,n.jsx)(y.p,{onShowPicker:()=>{this.setState({showPicker:!0})}}),this.renderTransformationEditors=()=>{const{data:Y,transformations:X}=this.state;return(0,n.jsx)(a.JY,{onDragEnd:this.onDragEnd,children:(0,n.jsx)(a.gL,{droppableId:"transformations-list",direction:"vertical",children:I=>(0,n.jsxs)("div",{ref:I.innerRef,...I.droppableProps,children:[(0,n.jsx)(D.A,{configs:X,data:Y,onRemove:this.onTransformationRemove,onChange:this.onTransformationChange}),I.placeholder]})})})};const Q=H.panel.transformations||[],Z=this.buildTransformationIds(Q);this.state={transformations:Q.map((Y,X)=>({transformation:Y,id:Z[X]})),data:{series:[]},search:"",selectedFilter:N,showIllustrations:!0},this.ref=(0,s.createRef)()}buildTransformationIds(H){const Q={},Z=[];for(let Y=0;Y<H.length;Y++){const X=H[Y];Q[X.id]===void 0?Q[X.id]=0:Q[X.id]+=1,Z.push(`${H[Y].id}-${Q[H[Y].id]}`)}return Z}componentDidMount(){this.subscription=this.props.panel.getQueryRunner().getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:H=>this.setState({data:H})})}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}componentDidUpdate(H,Q){if(m.Ay.featureToggles.transformationsRedesign){const Y=!(Q.transformations.length>0)||Q.showPicker,I=!(this.state.transformations.length>0)||this.state.showPicker;if(Y!==I){const J=Math.random()/2;this.setState({scrollTop:I?J:Number.MAX_SAFE_INTEGER})}}Q.scrollTop!==this.state.scrollTop&&this.ref.current?.scrollTo({top:this.state.scrollTop})}onChange(H){this.setState({transformations:H}),this.props.panel.setTransformations(H.map(Q=>Q.transformation))}renderTransformsPicker(){let{showPicker:H}=this.state;const{transformations:Q,search:Z}=this.state,{transformationsRedesign:Y}=m.Ay.featureToggles,X=!Q?.length,I=Q.length>0;let J=null,ee=i.h.list().sort((oe,de)=>oe.name>de.name?1:de.name>oe.name?-1:0);if(!Y&&X&&(H=!0),this.state.selectedFilter!==N&&(ee=ee.filter(oe=>oe.categories&&this.state.selectedFilter&&oe.categories.has(this.state.selectedFilter))),Z){const oe=Z.toLowerCase(),de=ee.filter(fe=>(fe.name+fe.description).toLowerCase().indexOf(oe)>=0);J=(0,n.jsxs)(n.Fragment,{children:[de.length," / ",ee.length," \xA0\xA0",(0,n.jsx)(l.K,{name:"times",onClick:()=>{this.setState({search:""})},tooltip:(0,u.t)("dashboard.un-themed-transformations-editor.tooltip-clear-search","Clear search")})]}),ee=de}!J&&H&&!X&&(J=(0,n.jsx)(l.K,{name:"times",onClick:()=>{this.setState({showPicker:!1})},tooltip:(0,u.t)("dashboard.un-themed-transformations-editor.tooltip-close-picker","Close picker")}));let q=null,ne=null;Y?(q=(0,n.jsx)(A.R,{noTransforms:X,search:Z,suffix:J,xforms:ee,onClose:()=>this.setState({showPicker:!1}),onSelectedFilterChange:oe=>this.setState({selectedFilter:oe}),onShowIllustrationsChange:oe=>this.setState({showIllustrations:oe}),onSearchChange:this.onSearchChange,onSearchKeyDown:this.onSearchKeyDown,onTransformationAdd:this.onTransformationAdd,data:this.state.data.series,selectedFilter:this.state.selectedFilter,showIllustrations:this.state.showIllustrations}),ne=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.$n,{icon:"times",variant:"secondary",onClick:()=>this.setState({showRemoveAllModal:!0}),style:{marginLeft:this.props.theme.spacing.md},children:(0,n.jsx)(u.x6,{i18nKey:"dashboard.un-themed-transformations-editor.delete-all-transformations",children:"Delete all transformations"})}),(0,n.jsx)(f.u,{isOpen:!!this.state.showRemoveAllModal,title:(0,u.t)("dashboard.un-themed-transformations-editor.title-delete-all-transformations","Delete all transformations?"),body:(0,u.t)("dashboard.un-theme-transformations-editor.body-delete-all-transformations","By deleting all transformations, you will go back to the main selection screen."),confirmText:(0,u.t)("dashboard.un-themed-transformations-editor.confirmText-delete-all","Delete all"),onConfirm:()=>this.onTransformationRemoveAll(),onDismiss:()=>this.setState({showRemoveAllModal:!1})})]})):q=(0,n.jsx)(K,{noTransforms:X,search:Z,suffix:J,xforms:ee,onSearchChange:this.onSearchChange,onSearchKeyDown:this.onSearchKeyDown,onTransformationAdd:this.onTransformationAdd});const se=(0,n.jsxs)(p.e,{children:[(0,n.jsx)(g.$n,{icon:"plus",variant:"secondary",onClick:()=>{this.setState({showPicker:!0})},"data-testid":r.Tp.components.Transforms.addTransformationButton,children:(0,n.jsx)(u.x6,{i18nKey:"dashboard.un-themed-transformations-editor.actions.add-another-transformation",children:"Add another transformation"})}),ne]});return(0,n.jsxs)(n.Fragment,{children:[H&&q,Y&&I&&se||!Y&&!H&&I&&se]})}render(){const{panel:{alert:H}}=this.props,{transformations:Q}=this.state,Z=Q.length>0;if(H){const Y=Z?"Transformations can't be used on a panel with alerts":"Transformations can't be used on a panel with existing alerts";return(0,n.jsx)(b,{message:Y})}return(0,n.jsx)(c.P,{ref:this.ref,minHeight:"100%",children:(0,n.jsx)(x.mc,{padding:"lg",children:(0,n.jsxs)("div",{"data-testid":r.Tp.components.TransformTab.content,children:[!Z&&m.Ay.featureToggles.transformationsRedesign&&this.renderEmptyMessage(),Z&&this.renderTransformationEditors(),this.renderTransformsPicker()]})})})}}const z=(0,v.SL)(V)},84403:(te,R,e)=>{"use strict";e.d(R,{A:()=>d});var n=e(74848),a=e(22803),s=e(51898),i=e(92745),r=e(36490),u=e(63142),o=e(41654),l=e(31286),g=e(66404),f=e(45861),p=e(77731),c=e(89451),x=e(72746),v=e(23289),m=e(52763),y=e(37918);const d=({dashboard:b,canCreate:D})=>{const C=(0,u.of)(E),P=(0,m.wA)(),M=(0,m.d4)(W=>W.dashboard.initialDatasource),O=()=>{let W;if(b instanceof x.H$){const B=b.onCreateNewPanel();b.setState({editPanel:(0,c.L)(B,!0)}),r.Ny.partial({firstPanel:!0})}else W=(0,p.OK)(b,M),P((0,y.Ub)(void 0)),r.Ny.partial({editPanel:W,firstPanel:!0});v.c.emptyDashboardButtonClicked({item:"add_visualization"})},j=()=>{v.c.emptyDashboardButtonClicked({item:"import_from_library"}),b instanceof x.H$?b.onShowAddLibraryPanelDrawer():(0,p.s3)(b)},U=b instanceof x.H$&&b.isManagedRepository();return(0,n.jsx)(o.B,{alignItems:"center",justifyContent:"center",children:(0,n.jsx)("div",{className:C.wrapper,children:(0,n.jsxs)(o.B,{alignItems:"stretch",justifyContent:"center",gap:4,direction:"column",children:[(0,n.jsx)(l.a,{borderColor:"strong",borderStyle:"dashed",padding:4,children:(0,n.jsxs)(o.B,{direction:"column",alignItems:"center",gap:2,children:[(0,n.jsx)(g.E,{element:"h1",textAlignment:"center",weight:"medium",children:(0,n.jsx)(i.x6,{i18nKey:"dashboard.empty.add-visualization-header",children:"Start your new dashboard by adding a visualization"})}),(0,n.jsx)(l.a,{marginBottom:2,paddingX:4,children:(0,n.jsx)(g.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,n.jsx)(i.x6,{i18nKey:"dashboard.empty.add-visualization-body",children:"Select a data source and then query and visualize your data with charts, stats and tables or create lists, markdowns and other widgets."})})}),(0,n.jsx)(f.$n,{size:"lg",icon:"plus","data-testid":s.Tp.pages.AddDashboard.itemButton("Create new panel button"),onClick:O,disabled:!D,children:(0,n.jsx)(i.x6,{i18nKey:"dashboard.empty.add-visualization-button",children:"Add visualization"})})]})}),(0,n.jsxs)(o.B,{direction:{xs:"column",md:"row"},wrap:"wrap",gap:4,children:[(0,n.jsx)(l.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,n.jsxs)(o.B,{direction:"column",alignItems:"center",gap:1,children:[(0,n.jsx)(g.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,n.jsx)(i.x6,{i18nKey:"dashboard.empty.add-library-panel-header",children:"Import panel"})}),(0,n.jsx)(l.a,{marginBottom:2,children:(0,n.jsx)(g.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,n.jsx)(i.x6,{i18nKey:"dashboard.empty.add-library-panel-body",children:"Add visualizations that are shared with other dashboards."})})}),(0,n.jsx)(f.$n,{icon:"plus",fill:"outline","data-testid":s.Tp.pages.AddDashboard.itemButton("Add a panel from the panel library button"),onClick:j,disabled:!D||U,children:(0,n.jsx)(i.x6,{i18nKey:"dashboard.empty.add-library-panel-button",children:"Add library panel"})})]})}),(0,n.jsx)(l.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,n.jsxs)(o.B,{direction:"column",alignItems:"center",gap:1,children:[(0,n.jsx)(g.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,n.jsx)(i.x6,{i18nKey:"dashboard.empty.import-a-dashboard-header",children:"Import a dashboard"})}),(0,n.jsx)(l.a,{marginBottom:2,children:(0,n.jsx)(g.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,n.jsxs)(i.x6,{i18nKey:"dashboard.empty.import-a-dashboard-body",children:["Import dashboards from files or ",(0,n.jsx)("a",{href:"https://grafana.com/grafana/dashboards/",children:"grafana.com"}),"."]})})}),(0,n.jsx)(f.$n,{icon:"upload",fill:"outline","data-testid":s.Tp.pages.AddDashboard.itemButton("Import dashboard button"),onClick:()=>{v.c.emptyDashboardButtonClicked({item:"import_dashboard"}),(0,p.VF)()},disabled:!D,children:(0,n.jsx)(i.x6,{i18nKey:"dashboard.empty.import-dashboard-button",children:"Import dashboard"})})]})})]})]})})})};function E(b){return{wrapper:(0,a.css)({label:"dashboard-empty-wrapper",flexDirection:"column",maxWidth:"890px",gap:b.spacing.gridSize*4,paddingTop:b.spacing(2),[b.breakpoints.up("sm")]:{paddingTop:b.spacing(12)}})}}},46429:(te,R,e)=>{"use strict";e.d(R,{Z:()=>c});var n=e(74848),a=e(96540),s=e(36490),i=e(22803),r=e(63142),u=e(7895),o=e(30703),l=e(45967),g=e(35484);const f=({notice:x,onClick:v})=>{const m=(0,r.of)(p),y=x.severity==="error"||x.severity==="warning"?"exclamation-triangle":"file-landscape-alt";return x.inspect&&v?(0,n.jsx)(u.I,{className:m.notice,icon:y,iconSize:"md",tooltip:x.text,onClick:h=>v(h,x.inspect)},x.severity):x.link?(0,n.jsx)("a",{className:m.notice,"aria-label":x.text,href:x.link,target:"_blank",rel:"noreferrer",children:(0,n.jsx)(o.I,{name:y,style:{marginRight:"8px"},size:"md"})}):(0,n.jsx)(l.m,{content:x.text,children:(0,n.jsx)("span",{className:m.iconTooltip,children:(0,n.jsx)(o.I,{name:y,size:"md"})})},x.severity)},p=x=>({notice:(0,i.css)({background:"inherit",border:"none",borderRadius:x.shape.radius.default}),iconTooltip:(0,i.css)({color:`${x.colors.text.secondary}`,backgroundColor:"inherit",cursor:"auto",border:"none",borderRadius:`${x.shape.radius.default}`,padding:`${x.spacing(0,1)}`,height:` ${x.spacing(x.components.height.md)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,g.getFocusStyles)(x),zIndex:1},"&: focus:not(:focus-visible)":(0,g.getMouseFocusStyles)(x),"&:hover ":{boxShadow:`${x.shadows.z1}`,color:`${x.colors.text.primary}`,background:`${x.colors.background.secondary}`}})}),c=({frames:x,panelId:v})=>{const m=(0,a.useCallback)((h,d)=>{h.stopPropagation(),s.Ny.partial({inspect:v,inspectTab:d})},[v]),y={};for(const h of x)if(!(!h.meta||!h.meta.notices))for(const d of h.meta.notices)y[d.severity]=d;return(0,n.jsx)(n.Fragment,{children:Object.values(y).map(h=>(0,n.jsx)(f,{notice:h,onClick:m},h.severity))})}},78013:(te,R,e)=>{"use strict";e.d(R,{M:()=>f});var n=e(83340),a=e(4575),s=e(57866),i=e(95004),r=e(16515),u=e(36638),o=e(49256);const l="hideSeriesFrom",g=(0,n.ZW)(l);function f(h,d,E,b){const{overrides:D}=E,C=h,P=D.findIndex(g);if(P<0){if(d===o.B.ToggleSelection){const B=p([C,...y(D,b)]);return{...E,overrides:[...E.overrides,B]}}const U=m(b,C),W=p(U);return{...E,overrides:[...E.overrides,W]}}const M=Array.from(D),[O]=M.splice(P,1);if(d===o.B.ToggleSelection){let U=x(O);const W=y(M,b);if(W.length>0&&(U=U.filter(S=>W.indexOf(S)<0)),U[0]===C&&U.length===1)return{...E,overrides:M};const B=p([C,...W]);return{...E,overrides:[...M,B]}}const j=c(O,C);return v(j,b)?{...E,overrides:M}:{...E,overrides:[...M,j]}}function p(h,d=a.PP.exclude,E){return E=E??{id:"custom.hideFrom",value:{viz:!0,legend:!1,tooltip:!1}},{__systemRef:l,matcher:{id:s.Ct.byNames,options:{mode:d,names:h,prefix:d===a.PP.exclude?"All except:":void 0,readOnly:!0}},properties:[{...E,value:{viz:!0,legend:!1,tooltip:!1}}]}}const c=(h,d,E=a.PP.exclude)=>{const b=h.properties.find(P=>P.id==="custom.hideFrom"),D=x(h),C=D.findIndex(P=>P===d);return C<0?D.push(d):D.splice(C,1),p(D,E,b)},x=h=>{const d=h.matcher.options?.names;return Array.isArray(d)?[...d]:[]},v=(h,d)=>x(h).length===m(d).length,m=(h,d)=>{const E=new Set;for(const b of h)for(const D of b.fields){if(D.type!==i.PU.number)continue;const C=(0,r.Ct)(D,b,h);C!==d&&E.add(C)}return Array.from(E)},y=(h,d)=>{let E=[];for(const b of h){const D=b.properties.find(C=>C.id==="custom.hideFrom");if(D!==void 0&&D.value?.legend===!0){const P=u.sJ.get(b.matcher.id).get(b.matcher.options);for(const M of d)for(const O of M.fields){if(O.type!==i.PU.number)continue;const j=(0,r.Ct)(O,M,d);P(O,M,d)&&E.push(j)}}}return E}},4405:(te,R,e)=>{"use strict";e.d(R,{a:()=>l});var n=e(49426),a=e(25229),s=e(33239);const i=100;class r{constructor(){this.listeners=[],this.budget=1,this.threshold=1.5,this.ok=new n.t(!0),this.lastUpdate=Date.now(),this.isLive=!1,this.liveTimeOffset=0,this.measure=()=>{const f=Date.now();this.budget=(f-this.lastUpdate)/i;const p=this.ok.getValue(),c=this.budget<=this.threshold;if(p!==c&&this.ok.next(c),this.lastUpdate=f,this.isLive&&this.ok.getValue()&&this.timeRange){let x;for(const v of this.listeners){if(!v.panel.props.isInView)continue;if(f-v.last>=v.intervalMs){if(!x){const{raw:y}=this.timeRange;x={raw:y,from:(0,a.KQ)(f-this.liveTimeOffset),to:(0,a.KQ)(f)}}v.panel.liveTimeChanged(x),v.last=f}}}}}setLiveTimeRange(f){if(this.timeRange=f,this.isLive=f?.raw?.to==="now",this.isLive){const p=s.parse(f.raw.from,!1)?.valueOf(),c=s.parse(f.raw.to,!0)?.valueOf();this.liveTimeOffset=c-p;for(const x of this.listeners)x.intervalMs=o(this.liveTimeOffset,x.panel.props.width)}}listen(f){this.listeners.push({last:this.lastUpdate,panel:f,intervalMs:o(6e4,f.props.width)})}remove(f){this.listeners=this.listeners.filter(p=>p.panel!==f)}updateInterval(f){if(!(!this.timeRange||!this.isLive)){for(const p of this.listeners)if(p.panel===f){p.intervalMs=o(this.liveTimeOffset,p.panel.props.width);return}}}}const u=5*60*1e3;function o(g,f){const p=Math.ceil(g/f/100)*100;return p>u?u:p}const l=new r;setInterval(l.measure,i)},48600:(te,R,e)=>{"use strict";e.d(R,{np:()=>O,t0:()=>M});var n=e(34796),a=e.n(n),s=e(2543),i=e.n(s),r=e(95093),u=e.n(r),o=e(32899),l=e(33239),g=e(68143),f=e(36490),p=e(83873),c=e(67020),x=e(77197),v=e(41644),m=e(28998),y=e(73427),h=e(50803),d=e(13956),E=e(95407),b=e(22429),D=e(8735);class C{loadScriptedDashboard(W){const B="public/dashboards/"+W.replace(/\.(?!js)/,"/")+"?"+new Date().getTime();return(0,g.AI)().get(B,void 0,void 0,{validatePath:!0}).then(this.executeScript.bind(this)).then(S=>({meta:{fromScript:!0,canDelete:!1,canSave:!1,canStar:!1},dashboard:S.data}),S=>{throw console.error("Script dashboard error "+S),y.lE.emit(o.r1.alertError,["Script Error","Please make sure it exists and returns a valid dashboard"]),S})}executeScript(W){const B={dashboardSrv:(0,b.UA)(),datasourceSrv:(0,m.tR)()},_=new Function("ARGS","kbn","dateMath","_","moment","window","document","$","jQuery","services",W)(f.Ny.getSearchObject(),x.A,l,i(),u(),window,document,a(),a(),B);return(0,s.isFunction)(_)?new Promise(K=>{_(T=>{K({data:T})})}):{data:_}}}class P extends C{loadDashboard(W,B,S,_){const K=(0,v.sP)("v1");let T;if(W==="script"&&B)T=this.loadScriptedDashboard(B);else if(W==="snapshot"&&B)T=(0,D.s)().getSnapshot(B);else if(W==="public"&&S)T=p.IB.getPublicDashboardByUid(S).then(L=>L);else if(S){if(!_){const L=K.getDashboardFromCache(S);if(L)return Promise.resolve(L)}T=(0,d.n)("v1").getDashboardDTO(S,_).then(L=>L).catch(L=>{throw(0,g.NF)(L)&&!(L instanceof E.P)&&(console.error("Failed to load dashboard",L),L.isHandled=!0,L.status===404&&y.lE.emit(o.r1.alertError,["Dashboard not found"])),L})}else throw new Error("Dashboard uid or slug required");return T.then(L=>(c.A.addDashboardImpression(L.dashboard.uid),L)),T}loadSnapshot(W){const B=(0,D.s)().getSnapshot(W);return B.then(S=>(c.A.addDashboardImpression(S.dashboard.uid),S)),B}}class M extends C{loadDashboard(W,B,S,_){const K=(0,v.sP)("v2");let T;if(W==="script"&&B)T=this.loadScriptedDashboard(B).then(L=>h.Op.ensureV2Response(L));else if(W==="public"&&S)T=p.IB.getPublicDashboardByUid(S).then(L=>h.Op.ensureV2Response(L));else if(S){if(!_){const L=K.getDashboardFromCache(S);if(L)return Promise.resolve(L)}T=(0,d.n)("v2").getDashboardDTO(S,_).then(L=>L).catch(L=>{throw(0,g.NF)(L)&&!(L instanceof E.P)&&(console.error("Failed to load dashboard",L),L.isHandled=!0,L.status===404&&y.lE.emit(o.r1.alertError,["Dashboard not found"])),L})}else throw new Error("Dashboard uid or slug required");return T.then(L=>(c.A.addDashboardImpression(L.metadata.name),L)),T}loadSnapshot(W){const B=(0,D.s)().getSnapshot(W).then(S=>h.Op.ensureV2Response(S));return B.then(S=>(c.A.addDashboardImpression(S.metadata.name),S)),B}}let O=new P;const j=U=>{throw new Error("dashboardLoaderSrv can be only overriden in test environment")}},22429:(te,R,e)=>{"use strict";e.d(R,{UA:()=>c});var n=e(32899),a=e(92745),s=e(45229),i=e(83873),r=e(13956),u=e(87745),o=e(7817),l=e(17097);class g{constructor(){this.onRemovePanel=v=>{const m=this.getCurrent();m&&(0,l.FC)(m,m.getPanelById(v),!0)},s.l.subscribe(u.Vz,v=>this.onRemovePanel(v.payload))}create(v,m){return new o.G(v,m)}setCurrent(v){this.dashboard=v}getCurrent(){return this.dashboard}saveJSONDashboard(v){const m=JSON.parse(v);return(0,r.n)().saveDashboard({dashboard:m,folderUid:this.dashboard?.meta.folderUid||m.folderUid,message:(0,a.t)("dashboard.dashboard-srv.message.edit-dashboard-json","Edit Dashboard JSON"),k8s:this.dashboard?.meta.k8s})}saveDashboard(v,m){return(0,r.n)().saveDashboard({message:v.message,folderUid:v.folderUid,dashboard:v.dashboard.getSaveModelClone(),showErrorAlert:m?.showErrorAlert})}starDashboard(v,m){const y=(0,i.AI)(),h={showSuccessAlert:!1,url:"/api/user/stars/dashboard/uid/"+v,method:m?"DELETE":"POST"};return y.request(h).then(()=>{const d=!m;this.dashboard?.uid===v&&(this.dashboard.meta.isStarred=d);const E=d?(0,a.t)("notifications.starred-dashboard","Dashboard starred"):(0,a.t)("notifications.unstarred-dashboard","Dashboard unstarred");return s.l.emit(n.r1.alertSuccess,[E]),d})}}let f;function p(x){f=x}function c(){return f||(f=new g),f}},8735:(te,R,e)=>{"use strict";e.d(R,{s:()=>g});var n=e(75505),a=e(81160),s=e(68143),i=e(43173),r=e(73427),u=e(85618);const o={create:f=>(0,s.AI)().post("/api/snapshots",f),getSnapshots:()=>(0,s.AI)().get("/api/dashboard/snapshots"),getSharingOptions:()=>(0,s.AI)().get("/api/snapshot/shared-options"),deleteSnapshot:f=>(0,s.AI)().delete("/api/snapshots/"+f),getSnapshot:async f=>{try{const p=await(0,s.AI)().get("/api/snapshots/"+f);return p.meta.canShare=!1,p}catch(p){throw p}}};class l{constructor(){this.apiVersion="dashboardsnapshot.grafana.app/v0alpha1",this.url=`/apis/${this.apiVersion}/namespaces/${(0,u.Ge)()}/dashboardsnapshots`}async create(p){return(0,s.AI)().post(this.url+"/create",p)}async getSnapshots(){return(await(0,s.AI)().get(this.url)).items.map(c=>({key:c.metadata.name,name:c.spec.title,external:c.spec.externalUrl!=null,externalUrl:c.spec.externalUrl}))}deleteSnapshot(p){return(0,s.AI)().delete(this.url+"/"+p)}async getSharingOptions(){return(0,s.AI)().get("/api/snapshot/shared-options")}async getSnapshot(p){const c={};if(!r.TP.isSignedIn){alert("TODO... need a barer token for anonymous use case");const x=`??? TODO, get anon token for snapshots (${r.TP.user?.name}) ???`;c.Authorization=`Bearer ${x}`}return(0,n.s)((0,s.AI)().fetch({url:this.url+"/"+p+"/body",method:"GET",headers:c}).pipe((0,a.T)(x=>({dashboard:x.data.dashboard,meta:{isSnapshot:!0,canSave:!1,canEdit:!1,canAdmin:!1,canStar:!1,canShare:!1,canDelete:!1,isFolder:!1,provisioned:!1}}))))}}function g(){return i.$.featureToggles.kubernetesSnapshots?new l:o}},75421:(te,R,e)=>{"use strict";e.d(R,{jG:()=>D});var n=e(2543),a=e(25229),s=e(22592),i=e(17548),r=e(32899),u=e(33239),o=e(92745),l=e(36490),g=e(36674),f=e(45229),p=e(65642),c=e(15130),x=e(23237),v=e(90593),m=e(87745),y=e(90811);function h({urlRefresh:C,currentRefresh:P,isAllowedIntervalFn:M,minRefreshInterval:O,refreshIntervals:j=y.cb}){if(!C)return P;const U=M(C),W=j.find(B=>B===C);if(!U||!W){const B=O?j.find(_=>_===O):void 0,S=j?.length?j[0]:void 0;return B??S??P}return C||P}class d{constructor(P){this.contextSrv=P,this.timeRangeForUrl=()=>{const M=this.timeRange().raw;return(0,a.Ar)(M.from)&&(M.from=M.from.valueOf().toString()),(0,a.Ar)(M.to)&&(M.to=M.to.valueOf().toString()),M},this.time=(0,s.E2)().raw,this.timeAtLoad=(0,s.E2)().raw,this.refreshTimeModel=this.refreshTimeModel.bind(this),f.A.subscribe(m.U0,M=>{this.zoomOut(M.payload.scale,M.payload.updateUrl)}),f.A.subscribe(m.Io,M=>{this.shiftTime(M.payload.direction,M.payload.updateUrl)}),f.A.subscribe(m.Rh,M=>{this.makeAbsoluteTime(M.payload.updateUrl)}),f.A.subscribe(m.Bt,()=>{this.copyTimeRangeToClipboard()}),f.A.subscribe(m.VZ,M=>{this.pasteTimeRangeFromClipboard(M.payload.updateUrl)}),document.addEventListener("visibilitychange",()=>{this.autoRefreshBlocked&&document.visibilityState==="visible"&&(this.autoRefreshBlocked=!1,this.refreshTimeModel())})}init(P){this.timeModel=P,this.time=P.time,this.refresh=P.refresh,this.initTimeFromUrl(),this.parseTime(),this.timeAtLoad=(0,n.cloneDeep)(this.time),this.refresh&&this.setAutoRefresh(this.refresh)}getValidIntervals(P){return this.contextSrv.getValidIntervals(P)}parseTime(){(0,n.isString)(this.time.from)&&this.time.from.indexOf("Z")>=0&&(this.time.from=(0,a.KQ)(this.time.from).utc()),(0,n.isString)(this.time.to)&&this.time.to.indexOf("Z")>=0&&(this.time.to=(0,a.KQ)(this.time.to).utc())}parseUrlParam(P,M){if(P.indexOf("now")!==-1)return P;if(P.length===8){const O=(0,a.yT)(P,"YYYYMMDD");if(O.isValid())return O}else if(P.length===15){const O=(0,a.yT)(P,"YYYYMMDDTHHmmss");if(O.isValid())return O}if(!isNaN(Number(P))){const O=parseInt(P,10);return M?(0,a.oZ)(M,O):(0,a.yT)(O)}return null}getTimeWindow(P,M){const O=parseInt(P,10);let j;return M.match(/^\d+$/)&&parseInt(M,10)?j=parseInt(M,10):j=i.intervalToMs(M),{from:(0,a.yT)(O-j/2),to:(0,a.yT)(O+j/2)}}initTimeFromUrl(){if(p.$W.publicDashboardAccessToken&&this.timeModel?.timepicker?.hidden)return;const P=l.Ny.getSearch();P.get("time")&&P.get("time.window")&&(this.time=this.getTimeWindow(P.get("time"),P.get("time.window")));const M=this.timeModel?.getTimezone();P.get("from")&&(this.time.from=this.parseUrlParam(P.get("from"),M)||this.time.from),P.get("to")&&(this.time.to=this.parseUrlParam(P.get("to"),M)||this.time.to),P.get("to")&&P.get("to").indexOf("now")===-1&&(this.refresh=!1,this.timeModel&&(this.timeModel.refresh=void 0)),this.refresh=h({urlRefresh:P.get("refresh"),currentRefresh:this.refresh,refreshIntervals:Array.isArray(this.timeModel?.timepicker?.refresh_intervals)?this.timeModel?.timepicker?.refresh_intervals:void 0,isAllowedIntervalFn:this.contextSrv.isAllowedInterval,minRefreshInterval:p.$W.minRefreshInterval})}updateTimeRangeFromUrl(){const P=l.Ny.getSearch();if(P.get("left"))return;const M=this.timeRangeForUrl(),O=P.get("from"),j=P.get("to");O&&j?(O!==M.from||j!==M.to)&&(this.initTimeFromUrl(),this.setTime(this.time,!1)):this.timeHasChangedSinceLoad()&&this.setTime(this.timeAtLoad,!0)}timeHasChangedSinceLoad(){return this.timeAtLoad&&(this.timeAtLoad.from!==this.time.from||this.timeAtLoad.to!==this.time.to)}setAutoRefresh(P){this.timeModel&&(this.timeModel.refresh=P),this.stopAutoRefresh();const M=l.Ny.getSearchObject();if(!P){M.refresh&&l.Ny.partial({refresh:null},!0);return}let O=P,j=60*1e3;P===c.SM?j=this.getAutoRefreshInteval().intervalMs:(O=this.contextSrv.getValidInterval(P),j=i.intervalToMs(O)),this.refreshMS=j,this.refreshTimer=window.setTimeout(()=>{this.startNextRefreshTimer(j),this.refreshTimeModel()},j),M.refresh!==O&&l.Ny.partial({refresh:O},!0)}getAutoRefreshInteval(){const P=window?.innerWidth??2e3;return i.calculateInterval(this.timeRange(),P,p.$W.minRefreshInterval)}refreshTimeModel(){this.timeModel?.timeRangeUpdated(this.timeRange())}startNextRefreshTimer(P){this.refreshTimer=window.setTimeout(()=>{this.startNextRefreshTimer(P),this.contextSrv.isGrafanaVisible()?this.refreshTimeModel():this.autoRefreshBlocked=!0},P)}stopAutoRefresh(){clearTimeout(this.refreshTimer),this.refreshTimer=void 0,this.refreshMS=void 0}resumeAutoRefresh(){this.timeModel?.refresh&&this.setAutoRefresh(this.timeModel.refresh)}setTime(P,M=!0){if((0,n.extend)(this.time,P),(0,a.Ar)(P.to)?(this.oldRefresh=this.timeModel?.refresh||this.oldRefresh,this.setAutoRefresh("")):this.oldRefresh&&this.oldRefresh!==this.timeModel?.refresh&&(this.setAutoRefresh(this.oldRefresh),this.oldRefresh=void 0),M===!0){const O=this.timeRangeForUrl(),j=l.Ny.getSearchObject();if(j.from===O.from.toString()&&j.to===O.to.toString())return;j.from=O.from.toString(),j.to=O.to.toString(),l.Ny.partial(j)}this.timeModel?.refresh===c.SM&&this.getAutoRefreshInteval().intervalMs!==this.refreshMS&&this.setAutoRefresh(c.SM),this.refreshTimeModel()}timeRange(){return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?g.jh.getTimeRange(window.__grafanaSceneContext).state.value:(0,v.z)(this.time,this.timeModel)}zoomOut(P,M=!0){const O=this.timeRange(),{from:j,to:U}=(0,x.Zk)(O,P);this.setTime({from:(0,a.yT)(j),to:(0,a.yT)(U)},M)}shiftTime(P,M=!0){const O=this.timeRange(),{from:j,to:U}=(0,x.Wb)(P,O);this.setTime({from:(0,a.yT)(j),to:(0,a.yT)(U)},M)}makeAbsoluteTime(P){const{from:M,to:O}=this.timeRange();this.setTime({from:M,to:O},P)}copyTimeRangeToClipboard(){const{raw:P}=this.timeRange();navigator.clipboard.writeText(JSON.stringify({from:P.from,to:P.to})),f.A.emit(r.r1.alertSuccess,[(0,o.t)("time-picker.copy-paste.copy-success-message","Time range copied to clipboard")])}async pasteTimeRangeFromClipboard(P=!0){const{range:M,isError:O}=await(0,x.zG)();if(O===!0){f.A.emit(r.r1.alertError,[(0,o.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,o.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:M})]);return}const{from:j,to:U}=M;this.setTime({from:j,to:U},P)}isRefreshOutsideThreshold(P,M=.05){const O=this.timeRange();if(u.isMathString(O.raw.from)){const j=O.to.diff(O.from),U=Date.now()-P,W=j*M;return U>=W}return!1}}let E;function b(C){E=C}function D(){return E||(E=new d(c.TP)),E}},65635:(te,R,e)=>{"use strict";e.d(R,{O2:()=>A,SW:()=>N,og:()=>Z});var n=e(2543),a=e(53543),s=e(3594),i=e(7389),r=e(48480),u=e(83175),o=e(38036),l=e(18600),g=e(36394),f=e(57866),p=e(95004),c=e(79184),x=e(33023),v=e(78282),m=e(739),y=e(74198),h=e(83162),d=e(65642),E=e(95943);function b(se){return Array.from(new Array(se+1),(oe,de)=>de).filter(oe=>se%oe===0)}var D=e(77197),C=e(28998),P=e(67933),M=e(78763),O=e(18615),j=e(71843),U=e(75663),W=e(39796),B=e(51515);function S(se,oe){const de=[];if(se?.statistics&&se?.statistics.length){se.statistic=se.statistics[0];for(const fe of se.statistics.splice(1))de.push({...se,statistic:fe})}for(const fe of de)fe.refId=(0,W.M)(oe),delete fe.statistics,oe.push(fe);return delete se.statistics,de}function _(se){const oe=[];if(se&&"statistics"in se&&se?.statistics?.length){for(const de of se.statistics.splice(1)){const{statistics:fe,name:ae,...ce}=se;oe.push({...ce,statistic:de,name:`${ae} - ${de}`})}se.statistic=se.statistics[0],oe.length!==0&&(se.name=`${se.name} - ${se.statistic}`),delete se.statistics}return oe}function K(se){se.hasOwnProperty("metricQueryType")||(se.metricQueryType=B.d$.Search),se.hasOwnProperty("metricEditorMode")||(se.metricQueryType===B.d$.Insights?se.metricEditorMode=B.Rx.Code:se.metricEditorMode=se.expression?B.Rx.Code:B.Rx.Builder)}var T=e(82612),L=e(56623);a.D.setInit(h.H),a.G.setInit(h.u);const A=41;class N{constructor(oe){this.dashboard=oe,(0,v.l)()||(0,v.h)(new C.xq)}updateSchema(oe){let de,fe,ae,ce;const ie=this.dashboard.schemaVersion,ve=[];if(this.dashboard.schemaVersion=A,ie!==this.dashboard.schemaVersion){if(ie<2&&(oe.services&&oe.services.filter&&(this.dashboard.time=oe.services.filter.time,this.dashboard.templating.list=oe.services.filter.list||[]),ve.push(le=>(le.type==="graphite"&&(le.type="graph"),le.type!=="graph"||((0,n.isBoolean)(le.legend)&&(le.legend={show:le.legend}),le.grid&&(le.grid.min&&(le.grid.leftMin=le.grid.min,delete le.grid.min),le.grid.max&&(le.grid.leftMax=le.grid.max,delete le.grid.max)),le.y_format&&(le.y_formats||(le.y_formats=[]),le.y_formats[0]=le.y_format,delete le.y_format),le.y2_format&&(le.y_formats||(le.y_formats=[]),le.y_formats[1]=le.y2_format,delete le.y2_format)),le))),ie<3){let le=this.dashboard.getNextPanelId();ve.push(Ee=>(Ee.id||(Ee.id=le,le+=1),Ee))}if(ie<4&&ve.push(le=>(le.type!=="graph"||((0,n.each)(le.aliasYAxis,(Ee,Re)=>{le.seriesOverrides=[{alias:Re,yaxis:Ee}]}),delete le.aliasYAxis),le)),ie<6){const le=(0,n.find)(oe.pulldowns,{type:"annotations"});for(le&&(this.dashboard.annotations={list:le.annotations||[]}),de=0;de<this.dashboard.templating.list.length;de++){const Ee=this.dashboard.templating.list[de];Ee.datasource===void 0&&(Ee.datasource=null),Ee.type==="filter"&&(Ee.type="query"),Ee.type===void 0&&(Ee.type="query"),Ee.allFormat===void 0&&delete Ee.allFormat}}if(ie<7&&(oe.nav&&oe.nav.length&&(this.dashboard.timepicker=oe.nav[0]),ve.push(le=>((0,n.each)(le.targets,Ee=>{Ee.refId||(Ee.refId=le.getNextQueryLetter&&le.getNextQueryLetter())}),le))),ie<8&&ve.push(le=>((0,n.each)(le.targets,Ee=>{Ee.fields&&Ee.tags&&Ee.groupBy&&(Ee.rawQuery?(delete Ee.fields,delete Ee.fill):(Ee.select=(0,n.map)(Ee.fields,Re=>{const Oe=[];return Oe.push({type:"field",params:[Re.name]}),Oe.push({type:Re.func,params:[]}),Re.mathExpr&&Oe.push({type:"math",params:[Re.mathExpr]}),Re.asExpr&&Oe.push({type:"alias",params:[Re.asExpr]}),Oe}),delete Ee.fields,(0,n.each)(Ee.groupBy,Re=>{Re.type==="time"&&Re.interval&&(Re.params=[Re.interval],delete Re.interval),Re.type==="tag"&&Re.key&&(Re.params=[Re.key],delete Re.key)}),Ee.fill&&(Ee.groupBy.push({type:"fill",params:[Ee.fill]}),delete Ee.fill)))}),le)),ie<9&&ve.push(le=>{if(le.type!=="singlestat"&&le.thresholds!=="")return le;if(le.thresholds){const Ee=le.thresholds.split(",");Ee.length>=3&&(Ee.shift(),le.thresholds=Ee.join(","))}return le}),ie<10&&ve.push(le=>(le.type!=="table"||(0,n.each)(le.styles,Ee=>{if(Ee.thresholds&&Ee.thresholds.length>=3){const Re=Ee.thresholds;Re.shift(),Ee.thresholds=Re}}),le)),ie<12&&(0,n.each)(this.dashboard.getVariables(),le=>{"refresh"in le&&(le.refresh&&(le.refresh=1),le.refresh||(le.refresh=0)),"hideVariable"in le&&le.hideVariable?le.hide=2:"hideLabel"in le&&le.hideLabel&&(le.hide=1)}),ie<12&&ve.push(le=>(le.type!=="graph"||!le.grid||le.yaxes||(le.yaxes=[{show:le["y-axis"],min:le.grid.leftMin,max:le.grid.leftMax,logBase:le.grid.leftLogBase,format:le.y_formats[0],label:le.leftYAxisLabel},{show:le["y-axis"],min:le.grid.rightMin,max:le.grid.rightMax,logBase:le.grid.rightLogBase,format:le.y_formats[1],label:le.rightYAxisLabel}],le.xaxis={show:le["x-axis"]},delete le.grid.leftMin,delete le.grid.leftMax,delete le.grid.leftLogBase,delete le.grid.rightMin,delete le.grid.rightMax,delete le.grid.rightLogBase,delete le.y_formats,delete le.leftYAxisLabel,delete le.rightYAxisLabel,delete le["y-axis"],delete le["x-axis"]),le)),ie<13&&ve.push(le=>{if(le.type!=="graph"||!le.grid)return le;le.thresholds||(le.thresholds=[]);const Ee={},Re={};return le.grid.threshold1!==null&&(Ee.value=le.grid.threshold1,le.grid.thresholdLine?(Ee.line=!0,Ee.lineColor=le.grid.threshold1Color,Ee.colorMode="custom"):(Ee.fill=!0,Ee.fillColor=le.grid.threshold1Color,Ee.colorMode="custom")),le.grid.threshold2!==null&&(Re.value=le.grid.threshold2,le.grid.thresholdLine?(Re.line=!0,Re.lineColor=le.grid.threshold2Color,Re.colorMode="custom"):(Re.fill=!0,Re.fillColor=le.grid.threshold2Color,Re.colorMode="custom")),(0,n.isNumber)(Ee.value)&&((0,n.isNumber)(Re.value)?Ee.value>Re.value?(Ee.op=Re.op="lt",le.thresholds.push(Ee),le.thresholds.push(Re)):(Ee.op=Re.op="gt",le.thresholds.push(Ee),le.thresholds.push(Re)):(Ee.op="gt",le.thresholds.push(Ee))),delete le.grid.threshold1,delete le.grid.threshold1Color,delete le.grid.threshold2,delete le.grid.threshold2Color,delete le.grid.thresholdLine,le}),ie<14&&(this.dashboard.graphTooltip=oe.sharedCrosshair?1:0),ie<16&&this.upgradeToGridLayout(oe),ie<17&&ve.push(le=>{if(le.minSpan){const Ee=E.cV/le.minSpan,Re=b(E.cV);le.maxPerRow=Re[(0,n.findIndex)(Re,Oe=>Oe>Ee)-1]}return delete le.minSpan,le}),ie<18&&ve.push(le=>(le["options-gauge"]&&(le.options=le["options-gauge"],le.options.valueOptions={unit:le.options.unit,stat:le.options.stat,decimals:le.options.decimals,prefix:le.options.prefix,suffix:le.options.suffix},le.options.thresholds&&le.options.thresholds.reverse(),delete le.options.options,delete le.options.unit,delete le.options.stat,delete le.options.decimals,delete le.options.prefix,delete le.options.suffix,delete le["options-gauge"]),le)),ie<19&&ve.push(le=>(le.links&&(0,n.isArray)(le.links)&&(le.links=le.links.map(w)),le)),ie<20){const le=Ee=>({...Ee,url:H(Ee.url)});ve.push(Ee=>(Ee.options&&Ee.options.dataLinks&&(0,n.isArray)(Ee.options.dataLinks)&&(Ee.options.dataLinks=Ee.options.dataLinks.map(le)),Ee.options&&Ee.options.fieldOptions&&Ee.options.fieldOptions.defaults&&(Ee.options.fieldOptions.defaults.links&&(0,n.isArray)(Ee.options.fieldOptions.defaults.links)&&(Ee.options.fieldOptions.defaults.links=Ee.options.fieldOptions.defaults.links.map(le)),Ee.options.fieldOptions.defaults.title&&(Ee.options.fieldOptions.defaults.title=H(Ee.options.fieldOptions.defaults.title))),Ee))}if(ie<21){const le=Ee=>({...Ee,url:Ee.url.replace(/__series.labels/g,"__field.labels")});ve.push(Ee=>(Ee.options&&Ee.options.dataLinks&&(0,n.isArray)(Ee.options.dataLinks)&&(Ee.options.dataLinks=Ee.options.dataLinks.map(le)),Ee.options&&Ee.options.fieldOptions&&Ee.options.fieldOptions.defaults&&Ee.options.fieldOptions.defaults.links&&(0,n.isArray)(Ee.options.fieldOptions.defaults.links)&&(Ee.options.fieldOptions.defaults.links=Ee.options.fieldOptions.defaults.links.map(le)),Ee))}if(ie<22&&ve.push(le=>(le.type!=="table"||(0,n.each)(le.styles,Ee=>{Ee.align="auto"}),le)),ie<23)for(const le of this.dashboard.templating.list){if(!(0,P.iv)(le))continue;const{multi:Ee,current:Re}=le;(0,s.R)(Re)||(le.current=(0,M.C)(Re,Ee))}if(ie<24&&ve.push(le=>{const Ee=le.type==="table";if(Ee&&!le.styles)return le;const Re=le.table==="table2";if(!Ee||Re)return le;if(le.type=Ee?"table-old":"table",le.type==="table-old"){const Oe=(0,L.p)(le);Oe&&(le.autoMigrateFrom=le.type,le.type=Oe)}return le}),ie<25,ie<26&&ve.push(le=>(le.type==="text2"&&(le.type="text",delete le.options.angular),le)),ie<27&&(this.removeRepeatedPanels(),this.dashboard.templating.list=this.dashboard.templating.list.map(le=>{if(!(0,P.VO)(le))return le;const Ee={...le};return Ee.current={selected:!0,text:Ee.query??"",value:Ee.query??""},Ee.options=[Ee.current],Ee.hide===i.zL.dontHide||Ee.hide===i.zL.hideLabel?{...Ee,type:"textbox"}:Ee})),ie<28){ve.push(le=>le.type==="singlestat"?Q(le):le);for(const le of this.dashboard.templating.list)le.tags&&delete le.tags,le.tagsQuery&&delete le.tagsQuery,le.tagValuesQuery&&delete le.tagValuesQuery,le.useTags&&delete le.useTags}if(ie<29)for(const le of this.dashboard.templating.list)le.type==="query"&&(le.refresh!==1&&le.refresh!==2&&(le.refresh=1),le.options?.length&&(le.options=[]));if(ie<30&&(ve.push(X),ve.push(q)),ie<31&&ve.push(le=>{if(le.transformations){for(const Ee of le.transformations)if(Ee.id===c.V.id)return Y(le,c.V.id,{id:x.o.id,options:{}})}return le}),ie<32,ie<33&&ve.push(le=>{if(le.datasource=Z(le.datasource,{returnDefaultAsNull:!0}),!le.targets)return le;for(const Ee of le.targets){const Re=Z(Ee.datasource,{returnDefaultAsNull:!0});Re!=null&&(Ee.datasource=Re)}return le}),ie<34&&(ve.push(le=>(this.migrateCloudWatchQueries(le),le)),this.migrateCloudWatchAnnotationQuery()),ie<35&&ve.push(ne),ie<36){for(const Ee of this.dashboard.annotations.list)Ee.datasource=Z(Ee.datasource,{returnDefaultAsNull:!1});const le=(0,v.l)().getInstanceSettings(null);if(le){for(const Ee of this.dashboard.templating.list)Ee.type==="query"&&Ee.datasource===null&&(Ee.datasource=(0,r.p$)(le));ve.push(Ee=>{if(Ee.targets){let Re=!1;Ee.datasource==null&&Ee.targets.length>0&&(Ee.datasource=(0,r.p$)(le),Re=!0);for(const Oe of Ee.targets)(Oe.datasource==null||Oe.datasource.uid==null)&&(Ee.datasource?.uid!==O.uv?Oe.datasource={...Ee.datasource}:Oe.datasource=Z(Oe.datasource,{returnDefaultAsNull:!1})),Re&&Oe.datasource?.uid!=="__expr__"&&(Ee.datasource=Oe.datasource)}return Ee})}}if(ie<37&&ve.push(le=>(le.options?.legend&&typeof le.options.legend=="object"&&(le.options.legend.displayMode==="hidden"||le.options.legend.showLegend===!1?(le.options.legend.displayMode="list",le.options.legend.showLegend=!1):le.options.legend={...le.options.legend,showLegend:!0}),le)),ie<38&&ve.push(le=>{if(le.type==="table"&&le.fieldConfig!==void 0){const Ee=le.fieldConfig.defaults?.custom?.displayMode;if(Ee!==void 0&&(le.fieldConfig.defaults.custom.cellOptions=(0,y.o7)(Ee),delete le.fieldConfig.defaults.custom.displayMode),le.fieldConfig?.overrides)for(const Re of le.fieldConfig.overrides)for(let Oe=0;Oe<(Re.properties?.length||0);Oe++){let Se=Re.properties[Oe].value;Re.properties[Oe].id==="custom.displayMode"&&(Re.properties[Oe].id="custom.cellOptions",Re.properties[Oe].value=(0,y.o7)(Se))}}return le}),ie<39&&ve.push(le=>(le.transformations?.forEach(Ee=>{if(Ee.id==="timeSeriesTable"&&Ee.options!==void 0&&Ee.options.refIdToStat!==void 0){let Re={};for(const[Oe,Se]of Object.entries(Ee.options.refIdToStat)){let Te={};Te.stat=Se,Re[Oe]=Te}Ee.options=Re}}),le)),ie<40&&typeof this.dashboard.refresh!="string"&&(this.dashboard.refresh=""),ie<41&&"time_options"in this.dashboard.timepicker&&delete this.dashboard.timepicker.time_options,ve.length!==0)for(fe=0;fe<this.dashboard.panels.length;fe++)for(ae=0;ae<ve.length;ae++){this.dashboard.panels[fe]=ve[ae].call(this,this.dashboard.panels[fe]);const le=this.dashboard.panels[fe].panels;if(le)for(ce=0;ce<le.length;ce++)le[ce]=ve[ae].call(this,le[ce])}}}removeRepeatedPanels(){const oe=[];for(const de of this.dashboard.panels)de.repeatPanelId||de.repeatByRow||(de.type==="row"&&Array.isArray(de.panels)&&(de.panels=de.panels.filter(fe=>!fe.repeatPanelId)),oe.push(de));this.dashboard.panels=oe}migrateCloudWatchQueries(oe){for(const de of oe.targets||[])if(I(de)&&(K(de),de.hasOwnProperty("statistics"))){const fe=S(de,[...oe.targets]);for(const ae of fe)oe.targets.push(ae)}}migrateCloudWatchAnnotationQuery(){for(const oe of this.dashboard.annotations.list)if(J(oe)){const de=_(oe);for(const fe of de)this.dashboard.annotations.list.push(fe)}}upgradeToGridLayout(oe){let de=0;const fe=E.cV/12;let ce=(0,n.max)((0,n.flattenDeep)((0,n.map)(oe.rows,ve=>(0,n.map)(ve.panels,"id"))))+1;if(!oe.rows)return;const ie=(0,n.some)(oe.rows,ve=>ve.collapse||ve.showTitle||ve.repeat);for(const ve of oe.rows){if(ve.repeatIteration)continue;const le=ve.height||E.bJ,Ee=V(le),Re={};let Oe;ie&&(Re.id=ce,Re.type="row",Re.title=ve.title,Re.collapsed=ve.collapse,Re.repeat=ve.repeat,Re.panels=[],Re.gridPos={x:0,y:de,w:E.cV,h:Ee},Oe=new T.a9(Re),ce++,de++);const Se=new z(Ee,E.cV,de);for(const Te of ve.panels){Te.span=Te.span||E.o9,Te.minSpan&&(Te.minSpan=Math.min(E.cV,E.cV/12*Te.minSpan));const _e=Math.floor(Te.span)*fe,He=Te.height?V(Te.height):Ee,tt=Se.getPanelPosition(He,_e);de=Se.yPos,Te.gridPos={x:tt.x,y:de+tt.y,w:_e,h:He},Se.addPanel(Te.gridPos),delete Te.span,Oe&&Re.collapsed?Oe.panels?.push(Te):this.dashboard.panels.push(new T.a9(Te))}Oe&&this.dashboard.panels.push(Oe),Oe&&Re.collapsed||(de+=Ee)}}}function V(se){return(0,n.isString)(se)&&(se=parseInt(se.replace("px",""),10)),se<E.cx&&(se=E.cx),Math.ceil(se/(E.sD+E.dU))}class z{constructor(oe,de=E.cV,fe=0){this.area=new Array(de).fill(0),this.yPos=fe,this.height=oe}reset(){this.area.fill(0)}addPanel(oe){for(let de=oe.x;de<oe.x+oe.w;de++)(!this.area[de]||oe.y+oe.h-this.yPos>this.area[de])&&(this.area[de]=oe.y+oe.h-this.yPos);return this.area}getPanelPosition(oe,de,fe=!1){let ae,ce,ie;for(let ve=this.area.length-1;ve>=0&&this.height-this.area[ve]>0;ve--)if(ce===void 0)ce=ve;else if(ve<this.area.length-1&&this.area[ve]<=this.area[ve+1])ae=ve;else break;if(ae!==void 0&&ce!==void 0&&ce-ae>=de-1){const ve=(0,n.max)(this.area.slice(ae));ie={x:ae,y:ve}}else return fe?null:(this.yPos+=this.height,this.reset(),this.getPanelPosition(oe,de,!0));return ie}}function w(se){let oe=se.url;return!oe&&se.dashboard&&(oe=`dashboard/db/${D.A.slugifyForUrl(se.dashboard)}`),!oe&&se.dashUri&&(oe=`dashboard/${se.dashUri}`),oe||(oe="/"),se.keepTime&&(oe=u.kM.appendQueryToUrl(oe,`$${o.c.keepTime}`)),se.includeVars&&(oe=u.kM.appendQueryToUrl(oe,`$${o.c.includeVars}`)),se.params&&(oe=u.kM.appendQueryToUrl(oe,se.params)),{url:oe,title:se.title,targetBlank:se.targetBlank}}function H(se){const oe=/(__series_name)|(\$__series_name)|(__value_time)|(__field_name)|(\$__field_name)/g;return se.replace(oe,(de,fe,ae,ce,ie,ve)=>fe?"__series.name":ae?"${__series.name}":ce?"__value.time":ie?"__field.name":ve?"${__field.name}":de)}function Q(se){if(d.$W.panels["grafana-singlestat-panel"])return se.type="grafana-singlestat-panel",se;let oe=!1;return se.changePlugin||(oe=!0,se=new T.a9(se)),se.plugin={angularPanelCtrl:{}},se.gauge?.show?(j.plugin.meta=d.$W.panels.gauge,se.changePlugin(j.plugin)):(U.plugin.meta=d.$W.panels.stat,se.changePlugin(U.plugin)),oe?se.getSaveModel():se}function Z(se,oe){if(oe.returnDefaultAsNull&&(se==null||se==="default"))return null;if((0,r.fN)(se))return se;const de=(0,v.l)().getInstanceSettings(se);return de?(0,r.p$)(de):{uid:se||void 0}}function Y(se,oe,de){if(se.transformations){const fe=[];for(const ae of se.transformations)fe.push(ae),ae.id===oe&&fe.push({...de});se.transformations=fe}return se}function X(se){const oe=se.fieldConfig;if(!oe)return se;if(oe.defaults&&oe.defaults.mappings&&(oe.defaults.mappings=ee(oe.defaults.mappings,oe.defaults.thresholds)),Array.isArray(oe.overrides))for(const de of oe.overrides)for(const fe of de.properties)fe.id==="mappings"&&(fe.value=ee(fe.value));return se}function I(se){return se.hasOwnProperty("dimensions")&&se.hasOwnProperty("namespace")&&se.hasOwnProperty("region")&&se.hasOwnProperty("metricName")}function J(se){return se.hasOwnProperty("dimensions")&&se.hasOwnProperty("namespace")&&se.hasOwnProperty("region")&&se.hasOwnProperty("prefixMatching")&&se.hasOwnProperty("statistics")}function ee(se,oe){if(!se)return;const de={type:l.d.ValueToText,options:{}},fe=[];for(const ae of se){if(ae.type&&ae.options){ae.type===l.d.ValueToText?de.options={...de.options,...ae.options}:fe.push(ae);continue}let ce;const ie=parseFloat(ae.text);if(oe&&!isNaN(ie)){const ve=(0,g.yQ)(ie,oe.steps);ve&&ve.color&&(ce=ve.color)}switch(ae.type){case 1:ae.value!=null&&(ae.value==="null"?fe.push({type:l.d.SpecialValue,options:{match:l.W.Null,result:{text:ae.text,color:ce}}}):de.options[String(ae.value)]={text:ae.text,color:ce});break;case 2:fe.push({type:l.d.RangeToText,options:{from:+ae.from,to:+ae.to,result:{text:ae.text,color:ce}}});break}}return Object.keys(de.options).length>0&&fe.unshift(de),fe}function q(se){return(se.type==="timeseries"||se.type==="xychart"||se.type==="xychart2")&&se.options.tooltipOptions&&(se.options={...se.options,tooltip:se.options.tooltipOptions},delete se.options.tooltipOptions),se}function ne(se){return se.type==="timeseries"&&se.fieldConfig?.defaults.custom?.axisPlacement===m.vM.Hidden&&(se.fieldConfig={...se.fieldConfig,overrides:[...se.fieldConfig.overrides,{matcher:{id:f.Ct.byType,options:p.PU.time},properties:[{id:"custom.axisPlacement",value:m.vM.Auto}]}]}),se}},7817:(te,R,e)=>{"use strict";e.d(R,{G:()=>B});var n=e(2543),a=e(64423),s=e(19379),i=e(80011),r=e(25229),u=e(75234),o=e(43173),l=e(8255),g=e(95943),f=e(15130),p=e(10605),c=e(54742),x=e(39167),v=e(93612),m=e(87745),y=e(73427),h=e(8535),d=e(88813),E=e(99305),b=e(75421),D=e(82612);const C=new Set(["gridPos","title","description","transparent"]);function P(K,T){const L=[],A={changed:!1,actions:{add:[],remove:[],replace:[],update:[],noop:[]},panels:L};let N=0;const V=new Map;for(let z of T){let{id:w}=z;w||(N||(N=O([K,T])),w=N++,z={...z,id:w}),V.set(w,z)}for(const z of K){const w=V.get(z.id);if(!w){A.changed=!0,A.actions.remove.push(z.id),z.destroy();continue}if(V.delete(z.id),w===z){L.push(z),A.actions.noop.push(z.id);continue}if(z.type===w.type){const Q=z.getSaveModel();let Z=!0,Y=!1;for(const[X,I]of Object.entries(w))if(!(0,n.isEqualWith)(I,Q[X],M))if(A.changed=!0,Z=!1,C.has(X))z[X]=I,Y=!0;else{Y=!1;break}if(Z){L.push(z),A.actions.noop.push(z.id);continue}if(Y){L.push(z),A.actions.update.push(z.id);continue}}z.destroy();const H=new D.a9(w);H.key=`${H.id}-update-${Date.now()}`,L.push(H),A.changed=!0,A.actions.replace.push(z.id)}for(const z of V.values())L.push(new D.a9(z)),A.changed=!0,A.actions.add.push(z.id);return A}function M(K,T){if(K==null&&(T===1/0||T===-1/0||T==null)||T==null&&(K===1/0||K===-1/0||K==null))return!0}function O(K){let T=0;for(const L of K)for(const A of L)A.id>T&&(T=A.id);return T+1}var j=e(65635);function U(K,T){return K.repeatDirection===g.HG?!1:T.gridPos.x>=K.gridPos.x+K.gridPos.w&&T.gridPos.y===K.gridPos.y}function W(K){for(const T of K)if(delete T.scopedVars,T.panels?.length)for(const L of T.panels)delete L.scopedVars}class B{constructor(T,L,A){this.timeRangeUpdatedDuringEditOrView=!1,this.originalDashboard=null,this.getVariablesFromState=A?.getVariablesFromState??v.SS,this.events=new s.o,this.id=T.id||null,this.uid=T.uid||L?.uid||null,this.revision=T.revision??void 0,this.title=T.title??"No Title",this.description=T.description,this.tags=T.tags??[],this.timezone=T.timezone??"",this.weekStart=T.weekStart??"",this.editable=T.editable!==!1,this.graphTooltip=T.graphTooltip||0,this.time=T.time??{from:"now-6h",to:"now"},this.timepicker=T.timepicker??{},this.liveNow=T.liveNow,this.templating=this.removeNullValuesFromVariables(this.ensureListExist(T.templating)),this.annotations=this.ensureListExist(T.annotations),this.refresh=T.refresh,this.snapshot=T.snapshot,this.schemaVersion=T.schemaVersion??0,this.fiscalYearStartMonth=T.fiscalYearStartMonth??0,this.version=T.version??0,this.links=T.links??[],this.gnetId=T.gnetId||null,this.panels=(0,n.map)(T.panels??[],N=>new D.a9(N)),this.scopeMeta=T.scopeMeta,this.originalDashboard=(0,n.cloneDeep)(T),this.originalTemplating=(0,n.cloneDeep)(this.templating),this.originalTime=(0,n.cloneDeep)(this.time),this.ensurePanelsHaveUniqueIds(),this.formatDate=this.formatDate.bind(this),this.initMeta(L),this.updateSchema(T),this.addBuiltInAnnotationQuery(),this.sortPanelsByGridPos(),this.panelsAffectedByVariableChange=null,this.appEventsSubscription=new a.yU,this.lastRefresh=Date.now(),this.appEventsSubscription.add(y.lE.subscribe(d.og,this.variablesChangedHandler.bind(this))),this.appEventsSubscription.add(y.lE.subscribe(d.BS,this.variablesTimeRangeProcessDoneHandler.bind(this))),this.appEventsSubscription.add(y.lE.subscribe(d.eF,this.variablesChangedInUrlHandler.bind(this)))}static{this.nonPersistedProperties={events:!0,meta:!0,panels:!0,templating:!0,originalTime:!0,originalTemplating:!0,originalLibraryPanels:!0,panelInEdit:!0,panelInView:!0,getVariablesFromState:!0,formatDate:!0,appEventsSubscription:!0,panelsAffectedByVariableChange:!0,lastRefresh:!0,timeRangeUpdatedDuringEditOrView:!0,originalDashboard:!0}}addBuiltInAnnotationQuery(){this.annotations.list.some(L=>L.builtIn===1)||this.annotations.list.unshift({datasource:{uid:"-- Grafana --",type:"grafana"},name:"Annotations & Alerts",type:"dashboard",iconColor:l.Mk,enable:!0,hide:!0,builtIn:1})}initMeta(T){T=T||{},T.canShare=T.canShare!==!1,T.canSave=T.canSave!==!1,T.canStar=T.canStar!==!1,T.canEdit=T.canEdit!==!1,T.canDelete=T.canDelete!==!1,T.showSettings=T.canEdit,T.canMakeEditable=T.canSave&&!this.editable,T.hasUnsavedFolderChange=!1,this.editable||(T.canEdit=!1,T.canDelete=!1,T.canSave=!1),this.meta=T}getSaveModelCloneOld(T){const L=(0,n.defaults)(T||{},{saveVariables:!0,saveTimerange:!0});let A={};for(const N in this)B.nonPersistedProperties[N]||!this.hasOwnProperty(N)||(A[N]=(0,n.cloneDeep)(this[N]));return A.templating=this.getTemplatingSaveModel(L),L.saveTimerange||(A.time=this.originalTime),A.panels=this.getPanelSaveModels(),A=(0,p.v)(A),A.getVariables=()=>A.templating.list,A}getSaveModelClone(T){const L=this.getSaveModelCloneOld(T),A=JSON.stringify(L);return JSON.parse(A)}updatePanels(T){const L=P(this.panels,T??[]);return L.changed&&(this.panels=L.panels??[],this.sortPanelsByGridPos(),this.events.publish(new m.Q$)),L}getPanelSaveModels(){return this.panels.filter(T=>this.isSnapshotTruthy()||!(T.repeatPanelId||T.repeatedByRow)).map(T=>{if(T.libraryPanel){const{id:L,title:A,libraryPanel:N,gridPos:V}=T;return{id:L,title:A,gridPos:V,libraryPanel:{uid:N.uid,name:N.name}}}return this.panelInEdit&&this.panelInEdit.id===T.id?this.panelInEdit.getSaveModel():T.getSaveModel()}).map(T=>(this.isSnapshotTruthy()||(delete T.scopedVars,T.type==="row"&&T.panels&&T.panels.length>0&&(T.panels=T.panels.filter(L=>!L.repeatPanelId).map(L=>(delete L.scopedVars,L)))),T))}getTemplatingSaveModel(T){const L=this.originalTemplating?.list??[],N=this.getVariablesFromState(this.uid).map(z=>{const w=c.B.get(z.type).getSaveModel(z,T.saveVariables);if(!T.saveVariables){const H=L.find(({name:Q,type:Z})=>Q===z.name&&Z===z.type);if(!H)return w;z.type==="adhoc"?w.filters=H.filters:(w.current=H.current,w.options=H.options)}return w});return{list:(0,p.v)(N)}}timeRangeUpdated(T){this.events.publish(new u.sR(T)),(0,h.JD)((0,x.RK)(this.uid,T)),(this.panelInEdit||this.panelInView)&&(this.timeRangeUpdatedDuringEditOrView=!0)}startRefresh(T={refreshAll:!0,panelIds:[]}){if(this.events.publish(new u._),this.lastRefresh=Date.now(),this.panelInEdit&&(T.refreshAll||T.panelIds.includes(this.panelInEdit.id))){this.panelInEdit.refresh();return}const L=this.panels.filter(A=>!this.otherPanelInFullscreen(A)&&(T.refreshAll||T.panelIds.includes(A.id)));if(!this.isSnapshot())for(const A of L)A.refreshWhenInView=!0;for(const A of L)A.refresh()}render(){this.events.publish(new m.XM);for(const T of this.panels)T.render()}panelInitialized(T){const L=T.getQueryRunner().getLastResult();!this.otherPanelInFullscreen(T)&&!L&&T.refresh()}otherPanelInFullscreen(T){return(this.panelInEdit||this.panelInView)&&!(T.isViewing||T.isEditing)}initEditPanel(T){return(0,b.jG)().stopAutoRefresh(),this.panelInEdit=T.getEditClone(),this.timeRangeUpdatedDuringEditOrView=!1,this.panelInEdit}exitPanelEditor(){this.panelInEdit.destroy(),this.panelInEdit=void 0,(0,b.jG)().resumeAutoRefresh(),this.refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged()}initViewPanel(T){this.panelInView=T,this.timeRangeUpdatedDuringEditOrView=!1,T.setIsViewing(!0)}exitViewPanel(T){this.panelInView=void 0,T.setIsViewing(!1),this.refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged()}refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged(){(this.panelsAffectedByVariableChange||this.timeRangeUpdatedDuringEditOrView)&&(this.startRefresh({panelIds:this.panelsAffectedByVariableChange??[],refreshAll:this.timeRangeUpdatedDuringEditOrView}),this.panelsAffectedByVariableChange=null,this.timeRangeUpdatedDuringEditOrView=!1)}ensurePanelsHaveUniqueIds(){const T=new Set;let L=this.getNextPanelId();for(const A of this.panelIterator())(!A.id||T.has(A.id))&&(A.id=L++),T.add(A.id)}removeNullValuesFromVariables(T){if(!T.list.length)return T;for(const L of T.list)L.current&&(L.current.value===null||Array.isArray(L.current.value)&&L.current.value.includes(null))&&(L.current=void 0);return T}ensureListExist(T={}){return T.list??=[],T}getNextPanelId(){let T=0;for(const L of this.panelIterator())L.id>T&&(T=L.id);return T+1}*panelIterator(){for(const T of this.panels){yield T;const L=T.panels??[];for(const A of L)yield A}}forEachPanel(T){for(let L=0;L<this.panels.length;L++)T(this.panels[L],L)}getPanelById(T,L=!1){if(this.panelInEdit&&this.panelInEdit.id===T)return this.panelInEdit;if(L){for(const A of this.panelIterator())if(A.id===T)return A;return null}else return this.panels.find(A=>A.id===T)??null}canEditPanel(T){return!!(this.meta.canEdit&&T&&!T.repeatPanelId&&T.type!=="row")}canEditPanelById(T){return this.canEditPanel(this.getPanelById(T))}addPanel(T){T.id=this.getNextPanelId(),this.panels.unshift(new D.a9(T)),this.sortPanelsByGridPos(),this.events.publish(new m.Q$)}updateMeta(T){this.meta={...this.meta,...T},this.events.publish(new m.Cf)}makeEditable(){this.editable=!0,this.updateMeta({canMakeEditable:!1,canEdit:!0,canSave:!0})}sortPanelsByGridPos(){this.panels.sort((T,L)=>T.gridPos.y===L.gridPos.y?T.gridPos.x-L.gridPos.x:T.gridPos.y-L.gridPos.y)}clearUnsavedChanges(T,L){for(const A of this.panels)A.configRev=0;this.panelInEdit&&(this.panelInEdit.hasSavedPanelEditChange=this.panelInEdit.configRev>0,this.panelInEdit.configRev=0),this.originalDashboard=T,this.originalTemplating=T.templating,L.saveTimerange&&(this.originalTime=T.time)}hasUnsavedChanges(){return!!this.panels.find(L=>L.hasChanged)}cleanUpRepeats(){if(this.isSnapshotTruthy()||!this.hasVariables())return;W(this.panels);const T=this.panels.filter(L=>(!L.repeat||L.repeatedByRow)&&L.repeatPanelId);(0,n.pull)(this.panels,...T),T.map(L=>L.destroy()),this.sortPanelsByGridPos()}processRepeats(){if(!(this.isSnapshotTruthy()||!this.hasVariables()||this.panelInView)){this.cleanUpRepeats();for(let T=0;T<this.panels.length;T++){const L=this.panels[T];L.repeat&&this.repeatPanel(L,T)}this.sortPanelsByGridPos(),this.events.publish(new m.Q$)}}cleanUpRowRepeats(T){const L=T.map(N=>N.id),A=T.filter(N=>!N.repeat&&N.repeatPanelId&&L.includes(N.repeatPanelId));(0,n.pull)(T,...A),(0,n.pull)(this.panels,...A)}processRowRepeats(T){if(this.isSnapshotTruthy()||!this.hasVariables())return;let L=T.panels??[];if(!T.collapsed){const A=this.panels.findIndex(N=>N.id===T.id);L=this.getRowPanels(A)}this.cleanUpRowRepeats(L);for(const A of L)if(A.repeat){const N=this.panels.findIndex(V=>V.id===A.id);this.repeatPanel(A,N)}}getPanelRepeatClone(T,L,A){if(L===0)return T;const N=T.getSaveModel();N.id=this.getNextPanelId();const V=new D.a9(N);return this.panels.splice(A+L,0,V),V.repeatPanelId=T.id,V.repeat=void 0,this.panelInView?.id===V.id&&(V.setIsViewing(!0),this.panelInView=V),V}getRowRepeatClone(T,L,A){if(L===0){if(!T.collapsed){const w=this.getRowPanels(A);T.panels=w}return T}const N=new D.a9(T.getSaveModel());let V,z;return T.collapsed?(V=(0,n.cloneDeep)(T.panels)??[],N.panels=V,z=A+L):(V=this.getRowPanels(A),N.panels=V.map(w=>w.getSaveModel()),z=A+(V.length+1)*L),this.panels.splice(z,0,N),this.updateRepeatedPanelIds(N),N}repeatPanel(T,L){const A=this.getPanelRepeatVariable(T);if(!A)return;if(T.type==="row"){this.repeatRow(T,L,A);return}const N=this.getSelectedVariableOptions(A),V=T.maxPerRow||4;let z=0,w=T.gridPos.y;for(let Q=0;Q<N.length;Q++){const Z=N[Q];let Y;Y=this.getPanelRepeatClone(T,Q,L),Y.scopedVars??={},Y.scopedVars[A.name]=Z,T.repeatDirection===g.Pz?(Q>0&&(w+=Y.gridPos.h),Y.gridPos.y=w):(Y.gridPos.w=Math.max(g.cV/N.length,g.cV/V),Y.gridPos.x=z,Y.gridPos.y=w,z+=Y.gridPos.w,z+Y.gridPos.w>g.cV&&(z=0,w+=Y.gridPos.h))}const H=w-T.gridPos.y;if(H>0){const Q=L+N.length;for(const Z of this.panels.slice(Q))U(T,Z)||(Z.gridPos.y+=H)}}repeatRow(T,L,A){const N=this.getSelectedVariableOptions(A);for(let V=0;V<N.length;V++){const z=N[V],w=this.getRowRepeatClone(T,V,L);_(w,A,z);const H=this.getRowHeight(w),Q=w.panels||[];let Z;if(T.collapsed){for(const Y of Q)_(Y,A,z),V>0&&this.updateRepeatedPanelIds(Y,!0);w.gridPos.y+=V,Z=L+V+1}else{const Y=L+(Q.length+1)*V+1;Q.forEach((X,I)=>{if(_(X,A,z),V>0){const J=new D.a9(X);this.updateRepeatedPanelIds(J,!0),J.gridPos.y+=H*V,this.panels.splice(Y+I,0,J)}}),w.panels=[],w.gridPos.y+=H*V,Z=Y+Q.length}if(N.length>1)for(const Y of this.panels.slice(Z))Y.gridPos.y+=H}}updateRepeatedPanelIds(T,L){return T.repeatPanelId=T.id,T.id=this.getNextPanelId(),L?T.repeatedByRow=!0:T.repeat=void 0,T}getSelectedVariableOptions(T){let L;return(0,E.ML)(T)?L=T.options.slice(1,T.options.length):L=(0,n.filter)(T.options,{selected:!0}),L}getRowHeight(T){if(!T.panels||T.panels.length===0)return 0;if(T.collapsed)return 1;const L=(0,n.maxBy)(T.panels,({gridPos:A})=>A.y+A.h).gridPos;return L.y+L.h-T.gridPos.y}removePanel(T){this.panels=this.panels.filter(L=>L!==T),T.destroy(),this.events.publish(new m.Q$)}removeRow(T,L){(!L&&T.collapsed||L&&!T.collapsed)&&this.toggleRow(T),this.removePanel(T)}expandRows(){const T=this.panels.filter(L=>L.type==="row"&&L.collapsed);for(const L of T)this.toggleRow(L)}collapseRows(){const T=this.panels.filter(L=>L.type==="row"&&!L.collapsed);for(const L of T)this.toggleRow(L)}isSubMenuVisible(){return this.links.length>0||this.getVariables().some(T=>T.hide!==2)||this.annotations.list.some(T=>!T.hide)}getPanelInfoById(T){const L=this.panels.findIndex(A=>A.id===T);return L>=0?{panel:this.panels[L],index:L}:null}duplicatePanel(T){const L=T.getSaveModel();return L.id=this.getNextPanelId(),delete L.repeat,delete L.repeatIteration,delete L.repeatPanelId,delete L.scopedVars,L.alert&&delete L.thresholds,delete L.alert,T.gridPos.x+T.gridPos.w*2<=g.cV?L.gridPos.x+=T.gridPos.w:L.gridPos.y+=T.gridPos.h,this.addPanel(L),L}formatDate(T,L){return(0,i.LE)(T,{format:L,timeZone:this.getTimezone()})}destroy(){this.appEventsSubscription.unsubscribe(),this.events.removeAllListeners();for(const T of this.panels)T.destroy()}toggleRow(T){const L=(0,n.indexOf)(this.panels,T);if(!T.collapsed){const z=this.getRowPanels(L);(0,n.pull)(this.panels,...z),T.panels=z.map(w=>w.getSaveModel()),T.collapsed=!0,z.some(w=>w.hasChanged)&&T.configRev++,this.events.publish(new m.Q$);return}T.collapsed=!1;const A=T.panels??[],N=A.some(z=>z.repeat),V=T.repeat;if(A.length>0){const w=(A[0].gridPos.y??T.gridPos.y)-(T.gridPos.y+T.gridPos.h);let H=L+1,Q=T.gridPos.y;for(const Y of A){if(V){const X=this.getPanelRepeatVariable(T);if(Y.scopedVars??={},X){const I=this.getSelectedVariableOptions(X);Y.scopedVars={...Y.scopedVars,[X.name]:I[0]}}}Y.gridPos.y??(Y.gridPos.y=T.gridPos.y),Y.gridPos.y-=w,this.panels.splice(H,0,new D.a9(Y)),H+=1,Q=Math.max(Q,Y.gridPos.y+Y.gridPos.h)}const Z=Q-T.gridPos.y-1;for(const Y of this.panels.slice(H))Y.gridPos.y+=Z;T.panels=[],N&&this.processRowRepeats(T)}this.sortPanelsByGridPos(),this.events.publish(new m.Q$)}getRowPanels(T){const L=this.panels.slice(T+1),A=L.findIndex(V=>V.type==="row");return L.slice(0,A>=0?A:this.panels.length)}on(T,L){console.log("DashboardModel.on is deprecated use events.subscribe"),this.events.on(T,L)}off(T,L){console.log("DashboardModel.off is deprecated"),this.events.off(T,L)}cycleGraphTooltip(){this.graphTooltip=(this.graphTooltip+1)%3}sharedTooltipModeEnabled(){return this.graphTooltip>0}sharedCrosshairModeOnly(){return this.graphTooltip===1}getRelativeTime(T){return(0,i.fq)(T,{timeZone:this.getTimezone()})}isSnapshot(){return this.snapshot!==void 0}getTimezone(){return this.timezone?this.timezone:f.TP?.user?.timezone}updateSchema(T){new j.SW(this).updateSchema(T)}hasTimeChanged(){const{time:T,originalTime:L}=this;return!((0,n.isEqual)(T,L)||(0,n.isEqual)((0,r.KQ)(T?.from),(0,r.KQ)(L?.from))&&(0,n.isEqual)((0,r.KQ)(T?.to),(0,r.KQ)(L?.to)))}autoFitPanels(T,L){const A=Math.max(...this.panels.map(Q=>Q.gridPos.h+Q.gridPos.y)),N=55;let z=T-N-20;L&&(z+=N);const w=Math.floor(z/(g.sD+g.dU)),H=A/w;for(const Q of this.panels)Q.gridPos.y=Math.round(Q.gridPos.y/H)||1,Q.gridPos.h=Math.round(Q.gridPos.h/H)||1}templateVariableValueUpdated(){this.processRepeats(),this.events.emit(m.bG)}getPanelByUrlId(T){const L=parseInt(T??"0",10),A=this.panels.filter(N=>N.collapsed);for(const N of A)N.panels?.some(z=>z.id===L)&&this.toggleRow(N);return this.getPanelById(L)}toggleLegendsForAll(){const T=this.panels.filter(S),L=T.filter(V=>V.legend.show).length,A=T.length-L,N=L>=A;for(const V of T)V.legend.show=!N,V.render()}toggleExemplarsForAll(){for(const T of this.panels)for(const L of T.targets){if(!(L.datasource&&(L.datasource.type==="prometheus"||L.datasource.type==="grafana-amazonprometheus-datasource"||L.datasource.type==="grafana-azureprometheus-datasource")))continue;const A=L;A.exemplar=!A.exemplar}this.startRefresh()}getVariables(){return this.getVariablesFromState(this.uid)}canEditAnnotations(T){let L=!0;return T?L=!!this.meta.annotationsPermissions?.dashboard.canEdit:L=!!this.meta.annotationsPermissions?.organization.canEdit,(o.$.featureToggles.annotationPermissionUpdate||this.canEditDashboard())&&L}canDeleteAnnotations(T){let L=!0;return T?L=!!this.meta.annotationsPermissions?.dashboard.canDelete:L=!!this.meta.annotationsPermissions?.organization.canDelete,o.$.featureToggles.annotationPermissionUpdate?L:L&&this.canEditDashboard()}canAddAnnotations(){return this.annotations.list.find(L=>L.builtIn===1)?.enable===!1?!1:o.$.featureToggles.annotationPermissionUpdate?!!this.meta.annotationsPermissions?.dashboard.canAdd:!!this.meta.annotationsPermissions?.dashboard.canAdd&&this.canEditDashboard()}canEditDashboard(){return!!(this.meta.canEdit||this.meta.canMakeEditable)}shouldUpdateDashboardPanelFromJSON(T,L){!(0,n.isEqual)(T?.gridPos,L?.gridPos)&&this.events.publish(new m.Q$)}getDefaultTime(){return this.originalTime}getPanelRepeatVariable(T){return this.getVariablesFromState(this.uid).find(L=>L.name===T.repeat)}isSnapshotTruthy(){return this.snapshot}hasVariables(){return this.getVariablesFromState(this.uid).length>0}hasVariablesChanged(){const T=this.originalTemplating?.list??[],L=this.getTemplatingSaveModel({saveVariables:!0}).list;return T.length!==L.length?!1:!(0,n.isEqual)(L,T)}variablesTimeRangeProcessDoneHandler(T){const L=T.payload.variableIds.length>0;this.variablesChangedHandler(new d.og({panelIds:[],refreshAll:!0}),L)}variablesChangedHandler(T,L=!0){if(L&&this.processRepeats(),T.payload.refreshAll||(0,b.jG)().isRefreshOutsideThreshold(this.lastRefresh)){this.startRefresh({refreshAll:!0,panelIds:[]});return}(this.panelInEdit||this.panelInView)&&(this.panelsAffectedByVariableChange=T.payload.panelIds.filter(A=>A!==(this.panelInEdit?.id??this.panelInView?.id))),this.startRefresh(T.payload)}variablesChangedInUrlHandler(T){this.templateVariableValueUpdated(),this.startRefresh(T.payload)}getOriginalDashboard(){return this.originalDashboard}}function S(K){return!!K.legend}function _(K,T,L){K.scopedVars??={},K.scopedVars[T.name]=L}},82612:(te,R,e)=>{"use strict";e.d(R,{NB:()=>d,a9:()=>E,tw:()=>D});var n=e(2543),a=e.n(n),s=e(24726),i=e(19379),r=e(39796),u=e(1906),o=e(69168),l=e(75234),g=e(2863),f=e(65642),p=e(62635),c=e(87745),x=e(96215),v=e(56623);const m={events:!0,isViewing:!0,isEditing:!0,isInView:!0,hasRefreshed:!0,cachedPluginOptions:!0,plugin:!0,queryRunner:!0,replaceVariables:!0,configRev:!0,hasSavedPanelEditChange:!0,getDisplayTitle:!0,dataSupport:!0,key:!0,isNew:!0,refreshWhenInView:!0},y={id:!0,gridPos:!0,type:!0,title:!0,scopedVars:!0,repeat:!0,repeatPanelId:!0,repeatDirection:!0,repeatedByRow:!0,minSpan:!0,collapsed:!0,panels:!0,targets:!0,datasource:!0,timeFrom:!0,timeShift:!0,hideTimeOverride:!0,description:!0,links:!0,fullscreen:!0,isEditing:!0,isViewing:!0,hasRefreshed:!0,events:!0,cacheTimeout:!0,queryCachingTTL:!0,cachedPluginOptions:!0,transparent:!0,pluginVersion:!0,queryRunner:!0,transformations:!0,fieldConfig:!0,maxDataPoints:!0,interval:!0,replaceVariables:!0,libraryPanel:!0,getDisplayTitle:!0,configRev:!0,key:!0},h={gridPos:{x:0,y:0,h:3,w:6},targets:[{refId:"A"}],cachedPluginOptions:{},transparent:!1,options:{},links:[],transformations:[],fieldConfig:{defaults:{},overrides:[]},title:""},d={graph:"timeseries","table-old":"table",singlestat:"stat","grafana-singlestat-panel":"stat","grafana-piechart-panel":"piechart","grafana-worldmap-panel":"geomap","natel-discrete-panel":"state-timeline"};class E{constructor(P){this.datasource=null,this.isViewing=!1,this.isEditing=!1,this.isInView=!1,this.configRev=0,this.refreshWhenInView=!0,this.cachedPluginOptions={},this.events=new i.o,this.restoreModel(P),this.replaceVariables=this.replaceVariables.bind(this),this.key=(0,s.A)()}restoreModel(P){for(const O in this)m[O]||!this.hasOwnProperty(O)||P[O]||typeof this[O]!="function"&&typeof this[O]!="symbol"&&delete this[O];for(const O in P)this[O]=P[O];const M=(0,v.p)(this);M&&(this.autoMigrateFrom=this.type,this.type=M),(0,n.defaultsDeep)(this,(0,n.cloneDeep)(h)),this.ensureQueryIds()}generateNewKey(){this.key=(0,s.A)()}ensureQueryIds(){if(this.targets&&(0,n.isArray)(this.targets))for(const P of this.targets)P.refId||(P.refId=(0,r.M)(this.targets))}getOptions(){return this.options}get hasChanged(){return this.configRev>0}updateOptions(P){this.options=P,this.configRev++,this.events.publish(new c.PR),this.render()}updateFieldConfig(P){this.fieldConfig=P,this.configRev++,this.events.publish(new c.PR),this.resendLastResult(),this.render()}getSaveModel(){const P={};for(const M in this)m[M]||!this.hasOwnProperty(M)||(0,n.isEqual)(this[M],h[M])||(P[M]=(0,n.cloneDeep)(this[M]));return this.type==="row"&&this.panels&&this.panels.length>0&&(P.panels=this.panels.map(M=>{if(M.libraryPanel){const{id:O,title:j,libraryPanel:U,gridPos:W}=M;return{id:O,title:j,gridPos:W,libraryPanel:{uid:U.uid,name:U.name}}}return M})),P}setIsViewing(P){this.isViewing=P}updateGridPos(P,M=!0){P.x===this.gridPos.x&&P.y===this.gridPos.y&&P.h===this.gridPos.h&&P.w===this.gridPos.w||(this.gridPos.x=P.x,this.gridPos.y=P.y,this.gridPos.w=P.w,this.gridPos.h=P.h,M&&this.configRev++,this.render())}runAllPanelQueries({dashboardUID:P,dashboardTimezone:M,timeData:O,width:j,dashboardTitle:U}){this.getQueryRunner().run({datasource:this.datasource,queries:this.targets,panelId:this.id,panelName:this.title,panelPluginId:this.type,dashboardUID:P,dashboardTitle:U,timezone:M,timeRange:O.timeRange,timeInfo:O.timeInfo,maxDataPoints:this.maxDataPoints||Math.floor(j),minInterval:this.interval,scopedVars:this.scopedVars,cacheTimeout:this.cacheTimeout,queryCachingTTL:this.queryCachingTTL,transformations:this.transformations,app:this.isEditing?u.Jk.PanelEditor:this.isViewing?u.Jk.PanelViewer:u.Jk.Dashboard})}refresh(){this.hasRefreshed=!0,this.events.publish(new l._)}render(){this.hasRefreshed?this.events.publish(new c.XM):this.refresh()}getOptionsToRemember(){return Object.keys(this).reduce((P,M)=>m[M]||y[M]?P:{...P,[M]:this[M]},{})}restorePanelOptions(P){const M=this.cachedPluginOptions[P];M&&(Object.keys(M.properties).map(O=>{this[O]=M.properties[O]}),this.fieldConfig=(0,o.H9)(this.fieldConfig,M.fieldConfig))}applyPluginOptionDefaults(P,M){const O=(0,o.F)({plugin:P,currentOptions:this.options,currentFieldConfig:this.fieldConfig,isAfterPluginChange:M});this.fieldConfig=O.fieldConfig,this.options=O.options}async pluginLoaded(P){this.plugin=P;const M=b(P);if(this.autoMigrateFrom){const O=d[this.autoMigrateFrom]!=null,j=this.getOptionsToRemember(),U=this.autoMigrateFrom,W=this.type;this.clearPropertiesBeforePluginChange(),this.type=W,this.plugin=P,this.callPanelTypeChangeHandler(P,U,j,O)}if(P.onPanelMigration&&M!==this.pluginVersion){const O=P.onPanelMigration(this);this.options=await O,this.pluginVersion=M}this.applyPluginOptionDefaults(P,!1),this.resendLastResult()}clearPropertiesBeforePluginChange(){for(const P in this)y[P]||delete this[P];this.options={},this.fieldConfig={defaults:{...this.fieldConfig.defaults,custom:{}},overrides:(0,o.aW)(this.fieldConfig.overrides,o.nx)}}callPanelTypeChangeHandler(P,M,O,j){if(P.onPanelTypeChanged){const U=j?{angular:O}:O.options;Object.assign(this.options,P.onPanelTypeChanged(this,M,U,this.fieldConfig))}}changePlugin(P){const M=P.meta.id,O=this.getOptionsToRemember(),j=this.fieldConfig,U=this.type,W=this.isAngularPlugin()||!!d[U];this.cachedPluginOptions[U]={properties:O,fieldConfig:j},this.clearPropertiesBeforePluginChange(),this.restorePanelOptions(M),this.callPanelTypeChangeHandler(P,U,O,W),this.type=M,this.plugin=P,this.configRev++,this.applyPluginOptionDefaults(P,!0),P.onPanelMigration&&(this.pluginVersion=b(P))}updateQueries(P){const{dataSource:M}=P;this.datasource=M,this.cacheTimeout=P.cacheTimeout,this.queryCachingTTL=P.queryCachingTTL,this.timeFrom=P.timeRange?.from,this.timeShift=P.timeRange?.shift,this.hideTimeOverride=P.timeRange?.hide,this.interval=P.minInterval,this.maxDataPoints=P.maxDataPoints,this.targets=P.queries,this.configRev++,this.events.publish(new c.zq)}addQuery(P){P=P||{refId:"A"},P.refId=(0,r.M)(this.targets),this.targets.push(P),this.configRev++}changeQuery(P,M){P.refId=this.targets[M].refId,this.configRev++,this.targets=this.targets.map((O,j)=>j===M?P:O)}getEditClone(){const P=this.getSaveModel(),M=new E(P);M.isEditing=!0,M.plugin=this.plugin;const O=this.getQueryRunner();return M.getQueryRunner().useLastResultFrom(O),M}getTransformations(){return this.transformations}getFieldOverrideOptions(){if(this.plugin)return{fieldConfig:this.fieldConfig,replaceVariables:this.replaceVariables,fieldConfigRegistry:this.plugin.fieldConfigRegistry,theme:f.Ay.theme2}}getDataSupport(){return this.plugin?.dataSupport??{annotations:!1,alertStates:!1}}getQueryRunner(){return this.queryRunner||(this.queryRunner=new x.Z(this)),this.queryRunner}hasTitle(){return this.title&&this.title.length>0}isAngularPlugin(){return(this.plugin&&this.plugin.angularPanelCtrl)!==void 0||(this.plugin?.meta?.angular?.detected??!1)}destroy(){this.events.removeAllListeners(),this.queryRunner&&this.queryRunner.destroy()}setTransformations(P){this.transformations=P,this.resendLastResult(),this.configRev++,this.events.publish(new c.JI)}setProperty(P,M){this[P]=M,this.configRev++,P==="repeat"&&(this.repeat&&!this.repeatDirection?this.repeatDirection="h":this.repeat||(delete this.repeatDirection,delete this.maxPerRow))}replaceVariables(P,M,O){const j=this.getQueryRunner().getLastRequest(),U=Object.assign({},this.scopedVars,j?.scopedVars,M);return(0,g.w)().replace(P,U,O)}resendLastResult(){this.plugin&&this.getQueryRunner().resendLastResult()}getDisplayTitle(){return this.replaceVariables(this.title,void 0,"text")}initLibraryPanel(P){for(const[M,O]of Object.entries(P.model)){switch(M){case"id":case"gridPos":case"libraryPanel":continue}this[M]=O}this.libraryPanel=P}unlinkLibraryPanel(){delete this.libraryPanel,this.configRev++,this.render()}}function b(C){return C&&C.meta.info.version?C.meta.info.version:f.Ay.buildInfo.version}function D(C){const P={};return Object.entries(C).filter(([M,O])=>!m[M]&&C.hasOwnProperty(M)&&!(0,n.isEqual)(O,h[M])).forEach(([M,O])=>{P[M]=O}),(0,p.MA)(P)}},83127:(te,R,e)=>{"use strict";e.d(R,{B:()=>s});var n=e(33749),a=e(27489);function s(i){const r={dashboardId:i.id,dashboardName:i.title,dashboardUid:i.uid,folderName:i.meta.folderTitle,eventName:n.n_.DashboardView};(0,a.G$)(r)}},56623:(te,R,e)=>{"use strict";e.d(R,{p:()=>a});var n=e(82612);function a(s){return s.type==="graph"?s.xaxis?.mode==="series"?s.legend?.values?"bargauge":"barchart":s.xaxis?.mode==="histogram"?"histogram":"timeseries":n.NB[s.type]}},37918:(te,R,e)=>{"use strict";e.d(R,{Ay:()=>y,O9:()=>f,Ub:()=>v,X1:()=>p,ig:()=>g,p0:()=>c,xS:()=>l});var n=e(65307),a=e(92745),s=e(59857),i=e(6262),r=e(7817);const u={initPhase:i._g.NotStarted,getModel:()=>null,initError:null,initialDatasource:void 0},o=(0,n.Z0)({name:"dashboard",initialState:u,reducers:{dashboardInitFetching:h=>{h.initPhase=i._g.Fetching},dashboardInitServices:h=>{h.initPhase=i._g.Services},dashboardInitCompleted:(h,d)=>{h.getModel=()=>d.payload,h.initPhase=i._g.Completed},dashboardInitFailed:(h,d)=>{h.initPhase=i._g.Failed,h.initError=d.payload,h.getModel=()=>new r.G({...s.Ye,title:(0,a.t)("dashboard.dashboard-slice.title.dashboard-init-failed","Dashboard init failed")},{canSave:!1,canEdit:!1})},cleanUpDashboard:h=>{h.initPhase=i._g.NotStarted,h.initError=null,h.getModel=()=>null},addPanel:(h,d)=>{},setInitialDatasource:(h,d)=>{h.initialDatasource=d.payload}}}),{dashboardInitFetching:l,dashboardInitFailed:g,dashboardInitCompleted:f,dashboardInitServices:p,cleanUpDashboard:c,addPanel:x,setInitialDatasource:v}=o.actions,y={dashboard:o.reducer}},77731:(te,R,e)=>{"use strict";e.d(R,{B1:()=>b,CW:()=>d,LH:()=>g,OK:()=>f,SD:()=>c,VF:()=>x,_u:()=>y,dH:()=>D,ko:()=>E,no:()=>m,s3:()=>v});var n=e(2543),a=e.n(n),s=e(92745),i=e(36490),r=e(65642),u=e(95943),o=e(29043),l=e(17097);const g="New panel";function f(P,M){const O={type:"timeseries",title:g,gridPos:(0,l.Ft)(P),datasource:M?{uid:M}:null,isNew:!0};return P.addPanel(O),O.id}function p(P,M){const O={type:M,title:t("dashboard.on-create-new-widget-panel.new-panel.title.widget-title","Widget title"),gridPos:calculateNewPanelGridPos(P),datasource:null,isNew:!0};return P.addPanel(O),O.id}function c(P){const M={type:"row",title:(0,s.t)("dashboard.on-create-new-row.new-row.title.row-title","Row title"),gridPos:{x:0,y:0}};P.addPanel(M)}function x(){i.Ny.push("/dashboard/import")}function v(P){const M={type:"add-library-panel",gridPos:(0,l.Ft)(P)};P.addPanel(M)}function m(P,M){if(!M)return;const O=(0,l.Ft)(P),j={type:M.id,title:g,gridPos:{x:O.x,y:O.y,w:M.defaults.gridPos.w,h:M.defaults.gridPos.h}};M.defaults&&((0,n.defaults)(j,M.defaults),j.title=M.defaults.title,o.A.delete(u.tH)),P.addPanel(j)}function y(){const P=(0,n.chain)(r.Ay.panels).filter({hideFromList:!1}).map(O=>O).value(),M=o.A.get(u.tH);if(M){const O=JSON.parse(M),j=(0,n.find)(P,{id:O.type});if(j){const U=(0,n.cloneDeep)(j);return U.name=O.title,U.sort=-1,{...U,defaults:{...O}}}}}const h="grafana.dashboards.panelEdit.lastUsedDatasource";function d(P){if(o.A.exists(h)){const M=o.A.getObject(h);if(M?.dashboardUid===P)return M}}function E(P){if(!o.A.exists(h))return;const O=o.A.getObject(h)?.datasourceUid??"";C(P,O)}function b(P){o.A.setObject(h,{dashboardUid:P,datasourceUid:""})}function D(P,M){const O=d(P);if(!O)C(P,M);else{const j=O?.dashboardUid??"";C(j,M)}}function C(P,M){o.A.setObject(h,{dashboardUid:P,datasourceUid:M})}},17097:(te,R,e)=>{"use strict";e.d(R,{ET:()=>U,FC:()=>b,Ft:()=>_,KJ:()=>C,Mc:()=>P,ZY:()=>O,d7:()=>M,iU:()=>D,nk:()=>W});var n=e(2543),a=e.n(n),s=e(32899),i=e(17548),r=e(25229),u=e(33239),o=e(92745),l=e(2863),g=e(45229),f=e(65642),p=e(95943),c=e(29043),x=e(23753),v=e(82612),m=e(12161),y=e(43652),h=e(87390),d=e(8535),E=e(87745);const b=(K,T,L)=>{if(L!==!1){const A=T.alert?"YES":void 0;g.A.publish(new E.bY({title:(0,o.t)("dashboard.remove-panel.title.remove-panel","Remove panel"),text:(0,o.t)("dashboard.remove-panel.text.remove-panel","Are you sure you want to remove this panel?"),icon:"trash-alt",confirmText:A,yesText:"Remove",onConfirm:()=>b(K,T,!1)}));return}K.removePanel(T),(0,d.JD)((0,h.O6)(T.key))},D=(K,T)=>{K.duplicatePanel(T)},C=K=>{let T=K;K instanceof v.a9&&(T=K.getSaveModel()),c.A.set(p.tH,JSON.stringify(T)),g.A.emit(s.r1.alertSuccess,["Panel copied. Click **Add panel** icon to paste."])},P=(K,T)=>{g.A.publish(new E.S8({component:x.Zy,props:{dashboard:K,panel:T}}))},M=(K,T)=>{g.A.publish(new E.S8({component:y.o,props:{panel:T,initialFolderUid:K.meta.folderUid,isOpen:!0}}))},O=K=>{g.A.publish(new E.S8({component:m.l,props:{onConfirm:()=>K.unlinkLibraryPanel(),isOpen:!0}}))},j=K=>{K.refresh()},U=K=>{const T={...K.options};T.legend.showLegend===!0?T.legend.showLegend=!1:T.legend.showLegend=!0,K.updateOptions(T)};function W(K,T){const L={timeInfo:"",timeRange:T};if(K.timeFrom){const A=(0,l.w)().replace(K.timeFrom,K.scopedVars),N=i.describeTextRange(A);if(N.invalid)return L.timeInfo="invalid time override",L;if((0,n.isString)(T.raw.from)){const V=(0,r.AN)(T.from).tz(),z=(0,r.AN)(T.to).tz(),w=u.parse(N.from,void 0,V);L.timeInfo=N.display,L.timeRange={from:w,to:u.parse(N.to,void 0,z),raw:{from:N.from,to:N.to}}}}if(K.timeShift){const A=(0,l.w)().replace(K.timeShift,K.scopedVars);if(i.describeTextRange(A).invalid)return L.timeInfo="invalid timeshift",L;const V="-"+A;L.timeInfo+=" timeshift "+V;const z=u.parseDateMath(V,L.timeRange.from,!1),w=u.parseDateMath(V,L.timeRange.to,!0);L.timeRange={from:z,to:w,raw:{from:z,to:w}}}return K.hideTimeOverride&&(L.timeInfo=""),L}function B(K){const L=document.getElementsByTagName("html")[0].getBoundingClientRect().width;return K.maxDataPoints?K.maxDataPoints:Math.ceil(L*(K.gridPos.w/24))}function S(K,T){const L=K.plugin&&K.plugin.noPadding?0:config.theme.panelPadding*2,A=K.hasTitle()?config.theme.panelHeaderHeight:0;return T-A-L-PANEL_BORDER}function _(K){for(const L of K.panelIterator())L.gridPos.y+=8;return{x:0,y:0,w:12,h:8}}},90593:(te,R,e)=>{"use strict";e.d(R,{z:()=>s});var n=e(25229),a=e(33239);const s=(i,r)=>{const u={from:(0,n.Ar)(i.from)?(0,n.KQ)(i.from):i.from,to:(0,n.Ar)(i.to)?(0,n.KQ)(i.to):i.to},o=r?r.getTimezone():void 0;return{from:a.parse(u.from,!1,o,r?.fiscalYearStartMonth),to:a.parse(u.to,!0,o,r?.fiscalYearStartMonth),raw:u}}},95710:(te,R,e)=>{"use strict";e.d(R,{Dd:()=>s,GC:()=>i,dM:()=>a,wM:()=>r,z9:()=>o});var n=e(23289);function a(f,p,c){const x=r(f.templating.list),v=i(f.panels.map(m=>m.type));n.c.dashboardInitialized({uid:f.uid,title:f.title,theme:f.style,schemaVersion:f.schemaVersion,version_before_migration:c,panels_count:f.panels.length,...v,...x,settings_nowdelay:f.timepicker.nowDelay,settings_livenow:!!f.liveNow,duration:p,isScene:!1})}function s(f,p){const c=f.getTrackingInformation();n.c.dashboardInitialized({theme:void 0,duration:p,isScene:!0,...c})}function i(f){return f.reduce((p,c)=>(p[g(c)]=1+p[g(c)]||1,p),{})}function r(f){return f.map(p=>p.type).reduce((p,c)=>(p[l(c)]=1+p[l(c)]||1,p),{})}function u(f){switch(f){case"AdhocVariable":return"adhoc";case"CustomVariable":return"custom";case"QueryVariable":return"query";case"IntervalVariable":return"interval";case"ConstantVariable":return"constant";case"DatasourceVariable":return"datasource";case"TextVariable":return"textbox";case"GroupByVariable":return"groupby";default:return}}function o(f){return f.map(p=>u(p.kind)).filter(p=>p!==void 0).reduce((p,c)=>(p[l(c)]=1+p[l(c)]||1,p),{})}const l=f=>`variable_type_${f}_count`,g=f=>`panel_type_${f}_count`},44515:(te,R,e)=>{"use strict";e.d(R,{Z:()=>n,o:()=>a});const n={"text/plain":[".csv",".txt"],"application/json":[".json"]},a=5e5},4735:(te,R,e)=>{"use strict";e.d(R,{v:()=>i});var n=e(88483),a=e(41119),s=e(68125);function i(r){return new n.c(u=>{let o=0;r.forEach(l=>{const g=new FileReader;g.readAsArrayBuffer(l),g.onload=()=>{const f=g.result;if(f&&f instanceof ArrayBuffer){const c=new TextDecoder("utf-8").decode(f);if(l.type==="application/json"){const x=JSON.parse(c);u.next({dataFrames:[(0,a.Vc)(x)],file:l})}else u.next({dataFrames:(0,s.Jh)(c),file:l});++o>=r.length&&u.complete()}}})})}},6079:(te,R,e)=>{"use strict";e.d(R,{r:()=>l});var n=e(74848),a=e(92138),s=e(92745),i=e(45861),r=e(73427),u=e(26437),o=e(11257);function l({variant:g,onClick:f}){const p=r.TP.hasPermission(o.w.DataSourcesCreate),c=a.I.assureBaseUrl(u.b.DataSourcesNew);return(0,n.jsx)(i.z9,{variant:g||"primary",href:c,disabled:!p,tooltip:p?void 0:(0,s.t)("datasources.add-new-data-source-button.tooltip-no-permission","You do not have permission to configure new data sources"),onClick:f,target:"_blank",children:(0,n.jsx)(s.x6,{i18nKey:"data-source-picker.add-new-data-source",children:"Configure a new data source"})})}},85032:(te,R,e)=>{"use strict";e.d(R,{A:()=>u});var n=e(74848),a=e(22803),s=e(63142),i=e(8073),r=e(37658);function u({ds:l,onClick:g,selected:f,description:p,...c}){const x=(0,s.$j)(),v=o(x,l.meta.builtIn);return(0,n.jsxs)(i.Z,{onClick:g,className:(0,a.cx)(v.card,f?v.selected:void 0),...c,children:[(0,n.jsx)(i.Z.Heading,{className:v.heading,children:(0,n.jsxs)("div",{className:v.headingContent,children:[(0,n.jsxs)("span",{className:v.name,children:[l.name," ",l.isDefault?(0,n.jsx)(r.L,{tags:["default"]}):null]}),(0,n.jsx)("small",{className:v.type,children:p||l.meta.name})]})}),(0,n.jsx)(i.Z.Figure,{className:v.logo,children:(0,n.jsx)("img",{src:l.meta.info.logos.small,alt:`${l.meta.name} Logo`})})]},l.uid)}function o(l,g=!1){return{card:(0,a.css)({cursor:"pointer",backgroundColor:"transparent",marginBottom:0,padding:l.spacing(1),"&:hover":{backgroundColor:l.colors.action.hover}}),heading:(0,a.css)({width:"100%",overflow:"hidden","> button":{width:"100%"}}),headingContent:(0,a.css)({color:l.colors.text.secondary,width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"flex",justifyContent:"space-between"}),logo:(0,a.css)({width:"32px",height:"32px",padding:l.spacing(0,1),display:"flex",alignItems:"center","> img":{maxHeight:"100%",minWidth:"24px",filter:`invert(${g&&l.isLight?1:0})`}}),name:(0,a.css)({color:l.colors.text.primary,display:"flex",gap:l.spacing(2)}),type:(0,a.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"flex",alignItems:"center"}),separator:(0,a.css)({margin:l.spacing(0,1),color:l.colors.border.weak}),selected:(0,a.css)({background:l.colors.action.selected,"&::before":{backgroundImage:l.colors.gradients.brandVertical,borderRadius:l.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",transform:"translateX(-50%)",width:l.spacing(.5),left:0}}),meta:(0,a.css)({display:"block",overflowWrap:"unset",whiteSpace:"nowrap",width:"100%",overflow:"hidden",textOverflow:"ellipsis"})}}},93602:(te,R,e)=>{"use strict";e.d(R,{S:()=>c});var n=e(74848),a=e(22803),s=e(96540),i=e(51898),r=e(92745),u=e(2863),o=e(63142),l=e(42227),g=e(6079),f=e(85032),p=e(7078);function c(h){const d=(0,s.useRef)(null),[E,b]=(0,l.dR)({keyboardEvents:h.keyboardEvents,containerRef:d}),D=(0,o.$j)(),C=y(D,b),{className:P,current:M,onChange:O,enableKeyboardNavigation:j,onClickEmptyStateCTA:U}=h,W=(0,l.Kr)({alerting:h.alerting,annotations:h.annotations,dashboard:h.dashboard,logs:h.logs,metrics:h.metrics,mixed:h.mixed,pluginId:h.pluginId,tracing:h.tracing,type:h.type,variables:h.variables}),[B,S]=(0,l.TX)(),_=h.filter?W.filter(h.filter):W;return(0,n.jsxs)("div",{ref:d,className:(0,a.cx)(P,C.container),"data-testid":i.Tp.components.DataSourcePicker.dataSourceList,children:[_.length===0&&(0,n.jsx)(x,{className:C.emptyState,onClickCTA:U}),_.sort((0,p.Tj)(M,B,m())).map(K=>(0,n.jsx)(f.A,{"data-testid":"data-source-card",ds:K,onClick:()=>{S(K),O(K)},selected:(0,p.Df)(K,M),...j?E:{}},K.uid))]})}function x({className:h,onClickCTA:d}){const E=(0,o.of)(v);return(0,n.jsxs)("div",{className:(0,a.cx)(h,E.container),children:[(0,n.jsx)("p",{className:E.message,children:(0,n.jsx)(r.x6,{i18nKey:"data-source-picker.list.no-data-source-message",children:"No data sources found"})}),(0,n.jsx)(g.r,{onClick:d})]})}function v(h){return{container:(0,a.css)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}),message:(0,a.css)({marginBottom:h.spacing(3)})}}function m(){return(0,u.w)().getVariables().filter(d=>d.type==="datasource").map(d=>`\${${d.id}}`)}function y(h,d){return{container:(0,a.css)({display:"flex",flexDirection:"column",padding:h.spacing(.5),[`${d}`]:{backgroundColor:h.colors.background.secondary}}),emptyState:(0,a.css)({height:"100%",flex:1})}}},41776:(te,R,e)=>{"use strict";e.d(R,{p:()=>j});var n=e(74848),a=e(22803),s=e(2543),i=e(96540),r=e(92745),u=e(27489),o=e(43173),l=e(63142),g=e(22787),f=e(63527),p=e(30703),c=e(92807),x=e(40279),v=e(44515),m=e(22747),y=e(42227),h=e(6079),d=e(51898),E=e(85032),b=e(7078);function D(W){switch(W){case"grafana":return(0,r.t)("data-source-picker.built-in-list.description-grafana","Discover visualizations using mock data");case"-- Mixed --":return(0,r.t)("data-source-picker.built-in-list.description-mixed","Use multiple data sources");case"-- Dashboard --":return(0,r.t)("data-source-picker.built-in-list.description-dashboard","Reuse query results from other visualizations");default:return""}}function C({className:W,current:B,onChange:S,tracing:_,dashboard:K,mixed:T,metrics:L,type:A,annotations:N,variables:V,alerting:z,pluginId:w,logs:H,filter:Q}){const Y=(0,y.Kr)({tracing:_,dashboard:K,mixed:T,metrics:L,type:A,annotations:N,variables:V,alerting:z,pluginId:w,logs:H}).filter(X=>(Q?Q?.(X):!0)&&!!X.meta.builtIn);return(0,n.jsx)("div",{className:W,"data-testid":d.Tp.components.DataSourcePicker.advancedModal.builtInDataSourceList,children:Y.map(X=>(0,n.jsx)(E.A,{ds:X,description:D(X.uid),selected:(0,b.Df)(X,B),onClick:()=>S(X)},X.uid))})}var P=e(93602);const M="dashboards_dspickermodal_clicked",O={SELECT_DS:"select_ds",UPLOAD_FILE:"upload_file",CONFIG_NEW_DS:"config_new_ds",CONFIG_NEW_DS_EMPTY_STATE:"config_new_ds_empty_state",SEARCH:"search",DISMISS:"dismiss"};function j({tracing:W,dashboard:B,mixed:S,metrics:_,type:K,annotations:T,variables:L,alerting:A,pluginId:N,logs:V,uploadFile:z,filter:w,onChange:H,current:Q,onDismiss:Z,reportedInteractionFrom:Y}){const X=(0,l.of)(U),[I,J]=(0,i.useState)(""),ee=Y||"modal",q=()=>{Z(),(0,u.rR)(M,{item:O.DISMISS,src:ee})},ne=ae=>{H(ae),(0,u.rR)(M,{item:O.SELECT_DS,ds_type:ae.type,src:ee})},se=(0,i.useMemo)(()=>(0,s.once)(()=>{(0,u.rR)(M,{item:"search",src:ee})}),[ee]),oe=(0,y.ps)("-- Grafana --"),de=(0,m.j)((ae,ce)=>{oe&&(H(oe,[ae]),(0,u.rR)(M,{item:O.UPLOAD_FILE,src:ee}),ce.length<1&&Z())}),fe=({className:ae})=>(0,n.jsx)(C,{className:ae,onChange:ne,current:Q,filter:w,variables:L,tracing:W,metrics:_,type:K,annotations:T,alerting:A,pluginId:N,logs:V,dashboard:B,mixed:S});return(0,n.jsxs)(g.a,{title:(0,r.t)("data-source-picker.modal.title","Select data source"),closeOnEscape:!0,closeOnBackdropClick:!0,isOpen:!0,className:X.modal,contentClassName:X.modalContent,onClickBackdrop:q,onDismiss:q,children:[(0,n.jsxs)("div",{className:X.leftColumn,children:[(0,n.jsx)(f.p,{type:"search",autoFocus:!0,className:X.searchInput,value:I,prefix:(0,n.jsx)(p.I,{name:"search"}),placeholder:(0,r.t)("data-source-picker.modal.input-placeholder","Select data source"),onChange:ae=>{J(ae.currentTarget.value),se()}}),(0,n.jsxs)(c.P,{children:[(0,n.jsx)(P.S,{onChange:ne,current:Q,onClickEmptyStateCTA:()=>(0,u.rR)(M,{item:O.CONFIG_NEW_DS_EMPTY_STATE,src:ee}),filter:ae=>(w?w?.(ae):!0)&&(0,b.Zn)(ae,I)&&!ae.meta.builtIn,variables:L,tracing:W,metrics:_,type:K,annotations:T,alerting:A,pluginId:N,logs:V,dashboard:B,mixed:S}),(0,n.jsx)(fe,{className:X.appendBuiltInDataSourcesList})]})]}),(0,n.jsxs)("div",{className:X.rightColumn,children:[(0,n.jsxs)("div",{className:X.builtInDataSources,children:[(0,n.jsx)("div",{className:X.builtInDataSourcesList,children:(0,n.jsx)(c.P,{children:(0,n.jsx)(fe,{})})}),z&&o.$.featureToggles.editPanelCSVDragAndDrop&&(0,n.jsx)(x.gH,{readAs:"readAsArrayBuffer",fileListRenderer:()=>{},options:{maxSize:v.o,multiple:!1,accept:v.Z,onDrop:de},children:(0,n.jsx)(x.wI,{})})]}),(0,n.jsxs)("div",{className:X.newDSSection,children:[(0,n.jsx)("span",{className:X.newDSDescription,children:(0,n.jsx)(r.x6,{i18nKey:"data-source-picker.modal.configure-new-data-source",children:"Open a new tab and configure a data source"})}),(0,n.jsx)(h.r,{variant:"secondary",onClick:()=>{(0,u.rR)(M,{item:O.CONFIG_NEW_DS,src:ee}),Z()}})]})]})]})}function U(W){return{modal:(0,a.css)({width:"80%",height:"80%",maxWidth:"1200px",maxHeight:"900px",[W.breakpoints.down("md")]:{width:"100%"}}),modalContent:(0,a.css)({display:"flex",flexDirection:"row",height:"100%",[W.breakpoints.down("md")]:{flexDirection:"column"}}),leftColumn:(0,a.css)({display:"flex",flexDirection:"column",width:"50%",height:"100%",paddingRight:W.spacing(4),borderRight:`1px solid ${W.colors.border.weak}`,[W.breakpoints.down("md")]:{width:"100%",borderRight:0,paddingRight:0,flex:1,overflowY:"auto"}}),rightColumn:(0,a.css)({display:"flex",flexDirection:"column",width:"50%",height:"100%",justifyItems:"space-evenly",alignItems:"stretch",paddingLeft:W.spacing(4),[W.breakpoints.down("md")]:{width:"100%",paddingLeft:0,flex:0}}),builtInDataSources:(0,a.css)({flex:"1 1",marginBottom:W.spacing(4),[W.breakpoints.down("md")]:{flex:0}}),builtInDataSourcesList:(0,a.css)({[W.breakpoints.down("md")]:{display:"none",marginBottom:0},marginBottom:W.spacing(4)}),appendBuiltInDataSourcesList:(0,a.css)({[W.breakpoints.up("md")]:{display:"none"}}),newDSSection:(0,a.css)({display:"flex",flexDirection:"row",width:"100%",justifyContent:"space-between",alignItems:"center"}),newDSDescription:(0,a.css)({flex:"1 0",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",color:W.colors.text.secondary}),searchInput:(0,a.css)({width:"100%",minHeight:"32px",marginBottom:W.spacing(1)})}}},76792:(te,R,e)=>{"use strict";e.d(R,{s:()=>T});var n=e(74848),a=e(22803),s=e(34743),i=e(83505),r=e(46885),u=e(18828),o=e(42211),l=e(93225),g=e(2543),f=e(96540),p=e(51898),c=e(92745),x=e(27489),v=e(63142),m=e(63527),y=e(30703),h=e(15245),d=e(92807),E=e(8515),b=e(45861),D=e(65642),C=e(5478),P=e(8095),M=e(42227),O=e(93602);function j(w){const{dataSource:H}=w,Q=(0,v.$j)(),Z=W(Q,H?.meta.builtIn);return H?(0,n.jsx)("img",{className:Z.pickerDSLogo,alt:`${H.meta.name} logo`,src:H.meta.info.logos.small}):U()}function U(){const w=(0,v.of)(W);return(0,n.jsx)("div",{className:w.pickerDSLogo})}function W(w,H=!1){return{pickerDSLogo:(0,a.css)({height:"20px",width:"20px",filter:`invert(${H&&w.isLight?1:0})`})}}var B=e(41776),S=e(7078);const _="dashboards_dspicker_clicked",K={SEARCH:"search",OPEN_DROPDOWN:"open_dspicker",SELECT_DS:"select_ds",ADD_FILE:"add_file",OPEN_ADVANCED_DS_PICKER:"open_advanced_ds_picker",CONFIG_NEW_DS_EMPTY_STATE:"config_new_ds_empty_state"};function T(w){const{current:H,onChange:Q,hideTextValue:Z=!1,width:Y,inputId:X,noDefault:I=!1,disabled:J=!1,placeholder:ee="Select data source",...q}=w,ne=(0,v.of)(L,w),[se,oe]=(0,f.useState)(!1),[de,fe]=(0,f.useState)(!1),[ae,ce]=(0,f.useState)(""),{onKeyDown:ie,keyboardEvents:ve}=(0,C.d)(),le=(0,f.useRef)(null),Ee=(0,f.useMemo)(()=>(0,g.debounce)(ye=>{(0,x.rR)(_,{item:K.SEARCH,query:ye,creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"})},300),[]),[Re,Oe]=(0,f.useState)(),[Se,Te]=(0,f.useState)(),_e=(0,M.ps)(H),He=(0,M.ps)("-- Grafana --"),tt=!H&&I?void 0:_e,Je=ae&&se?(0,n.jsx)(U,{}):(0,n.jsx)(j,{dataSource:tt}),Ge=[(0,s.cY)(4),(0,s.Ej)({apply({availableHeight:ye,elements:De}){De.floating.style.maxHeight=`${Math.max(200,ye-20)}px`,De.floating.style.minHeight="200px"}}),(0,s.UU)({fallbackStrategy:"initialPlacement",crossAxis:!1,boundary:document.body}),(0,s.BN)()],{refs:je,floatingStyles:Fe}=(0,i.we)({open:se,placement:"bottom-start",onOpenChange:oe,middleware:Ge,whileElementsMounted:r.ll,strategy:"fixed"}),Be=(0,f.useCallback)(ye=>{je.setReference(ye),Oe(ye)},[je]),Ke=(0,f.useCallback)(()=>{ce(""),oe(!1),Re?.focus()},[oe,Re]),{overlayProps:Ue,underlayProps:we}=(0,l.e)({onClose:Ke,isDismissable:!0,isOpen:se,shouldCloseOnInteractOutside:ye=>Re?!Re.isSameNode(ye):!1},le),{dialogProps:Xe}=(0,u.s)({"aria-label":"Opened data source picker list"},le);function nt(){oe(!0),Re?.focus()}function he(){He&&Q(He,[P.dx])}function xe(ye){ye.key==="Tab"&&!ye.shiftKey&&se&&(ye.preventDefault(),Se?.focus()),ye.key==="Tab"&&ye.shiftKey&&se&&Ke(),ie(ye)}function me(ye){ye.shiftKey?(ye.preventDefault(),Re?.focus()):Ke()}return(0,f.useEffect)(()=>{const ye=ve.subscribe({next:De=>{switch(De?.code){case"ArrowDown":nt(),De.preventDefault();break;case"ArrowUp":nt(),De.preventDefault();break;case"Escape":Ke(),De.preventDefault();break}}});return()=>ye.unsubscribe()}),(0,n.jsxs)("div",{className:ne.container,"data-testid":p.Tp.components.DataSourcePicker.container,children:[(0,n.jsx)("div",{className:ne.trigger,onClick:()=>{nt(),(0,x.rR)(_,{item:K.OPEN_DROPDOWN,creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"})},children:(0,n.jsx)(m.p,{id:X||"data-source-picker",className:de?void 0:ne.input,"data-testid":p.Tp.components.DataSourcePicker.inputV2,"aria-label":(0,c.t)("datasources.data-source-picker.aria-label-select-a-data-source","Select a data source"),autoComplete:"off",prefix:tt?Je:void 0,suffix:(0,n.jsx)(y.I,{name:se?"search":"angle-down"}),placeholder:Z?"":(0,S.q7)(tt)||ee,onFocus:()=>{fe(!0)},onBlur:()=>{fe(!1)},onKeyDown:xe,value:ae,onChange:ye=>{nt(),ce(ye.currentTarget.value),ye.currentTarget.value&&Ee(ye.currentTarget.value)},ref:Be,disabled:J})}),se?(0,n.jsxs)(h.ZL,{children:[(0,n.jsx)("div",{...we}),(0,n.jsx)("div",{ref:le,...Ue,...Xe,children:(0,n.jsx)(A,{...q,style:Fe,ref:je.setFloating,footerRef:Te,current:tt,filterTerm:ae,keyboardEvents:ve,onChange:(ye,De)=>{Ke(),ye.uid!==tt?.uid&&(Q(ye,De),(0,x.rR)(_,{item:K.SELECT_DS,ds_type:ye.type}))},onClose:Ke,onClickAddCSV:he,onDismiss:Ke,onNavigateOutsiteFooter:me})})]}):null]})}function L(w,H){return{container:(0,a.css)({position:"relative",cursor:H.disabled?"not-allowed":"pointer",width:w.spacing(H.width||"auto")}),trigger:(0,a.css)({cursor:"pointer",pointerEvents:H.disabled?"none":"auto"}),input:(0,a.css)({"input::placeholder":{color:H.disabled?w.colors.action.disabledText:w.colors.text.primary}})}}const A=f.forwardRef((w,H)=>{const{filterTerm:Q,onChange:Z,onClose:Y,onClickAddCSV:X,current:I,filter:J}=w,ee=(0,f.useCallback)(se=>{Z(se)},[Z]),q=(0,f.useCallback)(()=>{X?.(),Y(),(0,x.rR)(_,{item:K.ADD_FILE})},[X,Y]),ne=(0,v.of)(N);return(0,n.jsxs)("div",{style:w.style,ref:H,className:ne.container,children:[(0,n.jsx)(d.P,{showScrollIndicators:!0,children:(0,n.jsx)(O.S,{...w,enableKeyboardNavigation:!0,className:ne.dataSourceList,current:I,onChange:ee,filter:se=>(J?J?.(se):!0)&&(0,S.Zn)(se,Q),onClickEmptyStateCTA:()=>(0,x.rR)(_,{item:K.CONFIG_NEW_DS_EMPTY_STATE})})}),(0,n.jsx)(o.n1,{children:(0,n.jsx)(V,{...w,onClickAddCSV:q,onChange:ee,onNavigateOutsiteFooter:w.onNavigateOutsiteFooter})})]})});A.displayName="PickerContent";function N(w){return{container:(0,a.css)({display:"flex",flexDirection:"column",background:w.colors.background.elevated,borderRadius:w.shape.radius.default,boxShadow:w.shadows.z3,overflow:"hidden"}),picker:(0,a.css)({background:w.colors.background.secondary}),dataSourceList:(0,a.css)({flex:1}),footer:(0,a.css)({flex:0,display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",padding:w.spacing(1.5),borderTop:`1px solid ${w.colors.border.weak}`,backgroundColor:w.colors.background.secondary})}}function V({onClose:w,onChange:H,onClickAddCSV:Q,...Z}){const Y=(0,v.of)(z),X=Z.uploadFile&&D.Ay.featureToggles.editPanelCSVDragAndDrop,I=ee=>{ee.key==="Tab"&&Z.onNavigateOutsiteFooter(ee)},J=ee=>{ee.key==="Tab"&&ee.shiftKey&&Z.onNavigateOutsiteFooter(ee)};return(0,n.jsxs)("div",{className:Y.footer,children:[(0,n.jsx)(E.$s,{children:({showModal:ee,hideModal:q})=>(0,n.jsxs)(b.$n,{size:"sm",variant:"secondary",fill:"text",onClick:()=>{w(),ee(B.p,{reportedInteractionFrom:"ds_picker",tracing:Z.tracing,dashboard:Z.dashboard,mixed:Z.mixed,metrics:Z.metrics,type:Z.type,annotations:Z.annotations,variables:Z.variables,alerting:Z.alerting,pluginId:Z.pluginId,logs:Z.logs,filter:Z.filter,uploadFile:Z.uploadFile,current:Z.current,onDismiss:q,onChange:(ne,se)=>{H(ne,se),q()}}),(0,x.rR)(_,{item:K.OPEN_ADVANCED_DS_PICKER})},ref:Z.footerRef,onKeyDown:X?J:I,children:[(0,n.jsx)(c.x6,{i18nKey:"data-source-picker.open-advanced-button",children:"Open advanced data source picker"}),(0,n.jsx)(y.I,{name:"arrow-right"})]})}),X&&(0,n.jsx)(b.$n,{variant:"secondary",size:"sm",onClick:Q,onKeyDown:I,children:(0,n.jsx)(c.x6,{i18nKey:"datasources.footer.add-csv-or-spreadsheet",children:"Add csv or spreadsheet"})})]})}function z(w){return{footer:(0,a.css)({flex:0,display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",padding:w.spacing(1.5),borderTop:`1px solid ${w.colors.border.weak}`,backgroundColor:w.colors.background.secondary})}}},7078:(te,R,e)=>{"use strict";e.d(R,{Df:()=>i,Tj:()=>u,Zn:()=>o,q7:()=>r,tw:()=>l});var n=e(22429),a=e(77731),s=e(18615);function i(g,f){return!g||!f?!1:typeof f=="string"?g.uid===f:g.uid===f.uid}function r(g){if(g){if(typeof g=="string")return`${g} - not found`;if("name"in g)return g.name;if(g.uid)return`${g.uid} - not found`}}function u(g,f,p){return(x,v)=>{const m=x.name.toUpperCase(),y=v.name.toUpperCase();if(g&&i(x,g))return-1;if(g&&i(v,g))return 1;const h=f.indexOf(x.uid),d=f.indexOf(v.uid);if(h>-1&&h>d)return-1;if(d>-1&&d>h)return 1;const E=p.includes(x.uid),b=p.includes(v.uid);return E&&!b?-1:b&&!E||x.meta.builtIn&&!v.meta.builtIn?1:v.meta.builtIn&&!x.meta.builtIn||m<y?-1:1}}function o(g,f=""){return g.name.toLowerCase().includes(f.toLowerCase())}function l(g){if(!g.uid)return;const f=(0,n.UA)().getCurrent()?.uid??"";if(g.uid===s.uv)return(0,a.B1)(f);(0,a.dH)(f,g.uid)}},37946:(te,R,e)=>{"use strict";e.d(R,{I:()=>n});const n={List:"/datasources",Edit:"/datasources/edit/:uid",Dashboards:"/datasources/edit/:uid/dashboards",New:"/datasources/new"}},42227:(te,R,e)=>{"use strict";e.d(R,{Kr:()=>u,TX:()=>r,dR:()=>l,ps:()=>o});var n=e(96540),a=e(78685),s=e(78282);const i="grafana.features.datasources.components.picker.DataSourceDropDown.history";function r(){const[g=[],f]=(0,a.A)(i,[]),p=(0,n.useCallback)(c=>{c.meta.builtIn||(g.includes(c.uid)?(g.splice(g.findIndex(x=>c.uid===x),1),f([...g,c.uid])):f([...g,c.uid].slice(1,6)))},[g,f]);return[g,p]}function u(g){return(0,s.l)().getList(g)}function o(g){const f=(0,s.l)();return f.getInstanceSettings(g)}function l(g){const{keyboardEvents:f,containerRef:p}=g,c=(0,n.useRef)(0),x="data-role",v="keyboardSelectableItem",m={[x]:v},y=`[${x}="${v}"`,h="data-selectedItem",d=`[${h}="true"]`,E=(0,n.useCallback)(D=>{const C=p?.current?.querySelectorAll(y),P=C?.item(D%C?.length);C?.forEach(M=>M.setAttribute(h,"false")),P&&(P.scrollIntoView({block:"center"}),P.setAttribute(h,"true"))},[p,y]),b=(0,n.useCallback)(()=>{p?.current?.querySelector(d)?.querySelector("button")?.click()},[p,d]);return(0,n.useEffect)(()=>{if(!f)return;const D=f.subscribe({next:C=>{switch(C?.code){case"ArrowDown":{E(++c.current),C.preventDefault();break}case"ArrowUp":c.current=c.current>0?c.current-1:c.current,E(c.current),C.preventDefault();break;case"Enter":b();break}}});return()=>D.unsubscribe()},[f,E,b]),(0,n.useEffect)(()=>{const D=new MutationObserver(C=>{C.some(M=>M.addedNodes&&M.addedNodes.length>0||M.removedNodes&&M.removedNodes.length>0)&&E(0)});return p.current&&D.observe(p.current,{childList:!0}),()=>{D.disconnect()}},[p,y,E]),[m,d]}},18548:(te,R,e)=>{"use strict";e.d(R,{Ay:()=>O,Bs:()=>p,C_:()=>m,E1:()=>o,Gc:()=>g,IJ:()=>d,Ks:()=>E,QZ:()=>D,TN:()=>u,Tk:()=>y,UP:()=>P,eB:()=>x,f$:()=>f,gZ:()=>l,jz:()=>r,lg:()=>C,qR:()=>b,rb:()=>v});var n=e(65307),a=e(78479),s=e(92745);const i={dataSources:[],plugins:[],categories:[],dataSource:{},layoutMode:a.R.List,searchQuery:"",dataSourcesCount:0,dataSourceTypeSearchQuery:"",isLoadingDataSources:!1,isLoadingDataSourcePlugins:!1,dataSourceMeta:{},isSortAscending:!0},r=(0,n.VP)("dataSources/dataSourceLoaded"),u=(0,n.VP)("dataSources/dataSourcesLoad"),o=(0,n.VP)("dataSources/dataSourcesLoaded"),l=(0,n.VP)("dataSources/dataSourceMetaLoaded"),g=(0,n.VP)("dataSources/dataSourcePluginsLoad"),f=(0,n.VP)("dataSources/dataSourcePluginsLoaded"),p=(0,n.VP)("dataSources/setDataSourcesSearchQuery"),c=(0,n.VP)("dataSources/setDataSourcesLayoutMode"),x=(0,n.VP)("dataSources/setDataSourceTypeSearchQuery"),v=(0,n.VP)("dataSources/setDataSourceName"),m=(0,n.VP)("dataSources/setIsDefault"),y=(0,n.VP)("dataSources/setIsSortAscending"),h=(j=i,U)=>u.match(U)?{...j,isLoadingDataSources:!0}:o.match(U)?{...j,isLoadingDataSources:!1,dataSources:U.payload,dataSourcesCount:U.payload.length}:r.match(U)?{...j,dataSource:U.payload}:p.match(U)?{...j,searchQuery:U.payload}:c.match(U)?{...j,layoutMode:U.payload}:g.match(U)?{...j,plugins:[],isLoadingDataSourcePlugins:!0}:f.match(U)?{...j,plugins:U.payload.plugins,categories:U.payload.categories,isLoadingDataSourcePlugins:!1}:x.match(U)?{...j,dataSourceTypeSearchQuery:U.payload}:l.match(U)?{...j,dataSourceMeta:U.payload}:v.match(U)?{...j,dataSource:{...j.dataSource,name:U.payload}}:m.match(U)?{...j,dataSource:{...j.dataSource,isDefault:U.payload}}:y.match(U)?{...j,isSortAscending:U.payload}:j,d={testingStatus:{},loadError:null,loading:!0,plugin:null},E=(0,n.VP)("dataSourceSettings/initDataSourceSettingsSucceeded"),b=(0,n.VP)("dataSourceSettings/initDataSourceSettingsFailed"),D=(0,n.VP)("dataSourceSettings/testDataSourceStarting"),C=(0,n.VP)("dataSourceSettings/testDataSourceSucceeded"),P=(0,n.VP)("dataSourceSettings/testDataSourceFailed"),O={dataSources:h,dataSourceSettings:(j=d,U)=>E.match(U)?{...j,plugin:U.payload,loadError:null,loading:!1}:b.match(U)?{...j,plugin:null,loadError:U.payload.message,loading:!1}:D.match(U)?{...j,testingStatus:{message:(0,s.t)("datasources.data-source-settings-reducer.message.testing-could-couple-minutes","Testing... this could take up to a couple of minutes"),status:"info"}}:C.match(U)?{...j,testingStatus:{status:U.payload?.status,message:U.payload?.message,details:U.payload?.details}}:P.match(U)?{...j,testingStatus:{status:"error",message:U.payload?.message,details:U.payload?.details}}:j}},54825:(te,R,e)=>{"use strict";e.d(R,{K:()=>r});var n=e(76637),a=e(79118),s=e(11576),i=e(32503);function r(o,l,g){return u((0,i.UI)(o,l.field),l,g)}function u(o,l,g){if(!o){const c=g.visualization.getColorByName(l.fixed??"grey");return{isAssumed:!!l.field?.length||!l.fixed,fixed:c,value:()=>c,get:x=>c}}const f=(0,n.Qi)(o);if(f.isByValue||o.config.mappings?.length){const c=(0,a.xg)(o,!0);c!==o.config&&(o={...o,config:c},o.state=void 0);const x=(0,s.J)({field:o,theme:g}),v=m=>x(m).color??"#ccc";return{field:o,get:m=>v(o.values[m]),value:()=>v((0,i.sB)(o))}}const p=f.getCalculator(o,g)(0,0);return{fixed:p,value:()=>p,get:c=>p,field:o}}},71451:(te,R,e)=>{"use strict";e.d(R,{n:()=>h});var n=e(74848),a=e(22803),s=e(96540),i=e(92745),r=e(63142),u=e(45861),o=e(97095),l=e(18027),g=e(63527),f=e(43533),p=e(2381),c=e(14226),x=e(30868),v=e(20012),m=e(4896),y=e(73304);const h=b=>{const{value:D,src:C,name:P,placeholder:M,onChange:O,onClear:j,mediaType:U,folderName:W,size:B,color:S,maxFiles:_}=b,K=(0,r.of)(E),T=(0,r.$j)(),L=(0,s.useRef)(null),A=H=>(0,n.jsx)(y.i,{onChange:O,value:D,mediaType:U,folderName:W,maxFiles:_,hidePopper:H.hidePopper});let N=C;!N&&D&&(N=(0,v.D)(D));const V=S&&{fill:T.visualization.getColorByName(S)},z=()=>D&&N?(0,n.jsx)(x.y,{src:N,className:K.icon,style:{...V}}):(0,n.jsx)(u.z9,{variant:"primary",fill:"text",size:"sm",children:(0,n.jsx)(i.x6,{i18nKey:"dimensions.resource-picker.render-small-resource-picker.set-icon",children:"Set icon"})}),w=()=>(0,n.jsx)(o.C,{children:(0,n.jsx)(l.I,{label:null,grow:!0,children:(0,n.jsx)(g.p,{value:d(C,P),placeholder:M,readOnly:!0,prefix:N&&(0,n.jsx)(x.y,{src:N,className:K.icon,style:{...V}}),suffix:(0,n.jsx)(u.$n,{icon:"times",variant:"secondary",fill:"text",size:"sm",onClick:j})})})});return(0,n.jsx)(f.I,{content:A,children:(H,Q,Z)=>(0,n.jsxs)(n.Fragment,{children:[L.current&&(0,n.jsx)(p.A,{...Z,referenceElement:L.current,onMouseEnter:H,onKeyDown:Y=>{(0,c.Q)(Y,Q)},hidePopper:Q}),(0,n.jsxs)("div",{ref:L,className:K.pointer,onClick:H,onKeyDown:Y=>{Y.key==="Enter"&&H()},role:"button",tabIndex:0,children:[B===m.Iy.SMALL&&z(),B===m.Iy.NORMAL&&w()]})]})})};function d(b,D){if(b?.startsWith("public/build/img/icons")){const C=D?.lastIndexOf(".svg")??0;if(C>0)return D.substring(0,C)}return D}const E=b=>({pointer:(0,a.css)({cursor:"pointer","input[readonly]":{cursor:"pointer"}}),icon:(0,a.css)({verticalAlign:"middle",display:"inline-block",fill:"currentColor",width:"25px"})})},73304:(te,R,e)=>{"use strict";e.d(R,{i:()=>N});var n=e(74848),a=e(22803),s=e(18828),i=e(42211),r=e(93225),u=e(96540),o=e(92745),l=e(68143),g=e(63142),f=e(45861),p=e(65642),c=e(4896),x=e(37386),v=e(40279),m=e(30868);function y({secondaryText:z="Drag and drop here or browse"}){const w=(0,g.of)(d);return(0,n.jsxs)("div",{className:w.iconWrapper,children:[(0,n.jsx)("small",{className:w.small,children:z}),(0,n.jsx)(f.$n,{type:"button",icon:"upload",children:(0,n.jsx)(o.x6,{i18nKey:"dimensions.file-dropzone-custom-children.upload",children:"Upload"})})]})}const h=({mediaType:z,setFormData:w,setUpload:H,error:Q})=>{const Z=(0,g.of)(d),[Y,X]=(0,u.useState)(!1),[I,J]=(0,u.useState)(""),ee=()=>(0,n.jsx)(x.D,{label:(0,o.t)("dimensions.file-uploader.preview.label-preview","Preview"),children:(0,n.jsxs)("div",{className:Z.iconPreview,children:[z===c.zu.Icon&&(0,n.jsx)(m.y,{src:I,className:Z.img}),z===c.zu.Image&&(0,n.jsx)("img",{src:I,alt:"Preview of the uploaded file",className:Z.img})]})}),q=se=>{fetch(`/api/storage/delete/upload/${se.file.name}`,{method:"DELETE"}).catch(oe=>console.error("cannot delete file",oe))},ne=z==="icon"?{"image/*":[".svg",".xml"]}:{"image/*":[".jpeg",".png",".gif",".webp"]};return(0,n.jsx)(v.gH,{readAs:"readAsBinaryString",onFileRemove:q,options:{accept:ne,multiple:!1,onDrop:se=>{let oe=new FormData;oe.append("file",se[0]),J(URL.createObjectURL(se[0])),X(!0),w(oe),H(!0)}},children:Q.message!==""&&Y?(0,n.jsx)("p",{children:Q.message}):Y?(0,n.jsx)(ee,{}):(0,n.jsx)(y,{})})};function d(z,w){return{container:(0,a.css)({display:"flex",flexDirection:"column",width:"100%"}),dropzone:(0,a.css)({display:"flex",flex:1,flexDirection:"column",alignItems:"center",padding:z.spacing(6),borderRadius:z.shape.radius.default,border:`2px dashed ${z.colors.border.medium}`,backgroundColor:w?z.colors.background.secondary:z.colors.background.primary,cursor:"pointer"}),iconWrapper:(0,a.css)({display:"flex",flexDirection:"column",alignItems:"center"}),acceptMargin:(0,a.css)({margin:z.spacing(2,0,1)}),small:(0,a.css)({color:z.colors.text.secondary,marginBottom:z.spacing(2)}),iconContainer:(0,a.css)({display:"flex",flexDirection:"column",width:"80%",alignItems:"center",alignSelf:"center"}),iconPreview:(0,a.css)({width:"238px",height:"198px",border:`1px solid ${z.colors.border.medium}`,display:"flex",alignItems:"center",justifyContent:"center"}),img:(0,a.css)({width:"147px",height:"147px",fill:z.colors.text.primary})}}var E=e(18857),b=e(12737),D=e(28998),C=e(70713),P=e(97222);const M=(0,u.memo)(function(w){const{columnIndex:H,rowIndex:Q,style:Z,data:Y}=w,{cards:X,columnCount:I,onChange:J,selected:ee}=Y,q=H+Q*I,ne=X[q],se=(0,g.of)(j);return(0,n.jsx)("div",{style:Z,children:ne&&(0,n.jsxs)("div",{className:ee===ne.value?(0,a.cx)(se.card,se.selected):se.card,onClick:()=>J(ne.value),onKeyDown:oe=>{oe.key==="Enter"&&J(ne.value)},role:"button",tabIndex:0,children:[ne.imgUrl.endsWith(".svg")?(0,n.jsx)(m.y,{src:ne.imgUrl,className:se.img}):(0,n.jsx)("img",{src:ne.imgUrl,alt:"",className:se.img}),(0,n.jsx)("h6",{className:se.text,children:ne.label.slice(0,-4)})]},ne.value)})},P.t7),O=z=>{const{onChange:w,cards:H,value:Q}=z,Z=(0,g.of)(j);return(0,n.jsx)(C.Ay,{defaultWidth:680,children:({width:Y,height:X})=>{const ee=Math.floor(Y/90),q=Math.ceil(H.length/ee);return(0,n.jsx)(P.yi,{width:Y,height:X,columnCount:ee,columnWidth:90,rowCount:q,rowHeight:90,itemData:{cards:H,columnCount:ee,onChange:w,selected:Q},className:Z.grid,children:M})}})},j=z=>({card:(0,a.css)({display:"inline-block",width:"90px",height:"90px",margin:"0.75rem",marginLeft:"15px",textAlign:"center",cursor:"pointer",position:"relative",backgroundColor:"transparent",border:"1px solid transparent",borderRadius:z.shape.radius.default,paddingTop:"6px",":hover":{borderColor:z.colors.action.hover,boxShadow:z.shadows.z2}}),selected:(0,a.css)({border:`2px solid ${z.colors.primary.main}`,":hover":{borderColor:z.colors.primary.main}}),img:(0,a.css)({width:"40px",height:"40px",objectFit:"cover",verticalAlign:"middle",fill:z.colors.text.primary}),text:(0,a.css)({color:z.colors.text.primary,whiteSpace:"nowrap",fontSize:"12px",textOverflow:"ellipsis",display:"block",overflow:"hidden"}),grid:(0,a.css)({border:`1px solid ${z.colors.border.medium}`})}),U=z=>z===c.zu.Icon?[c.Iu.Icon,c.Iu.IOT,c.Iu.Marker]:[c.Iu.BG],W=(z,w)=>z.find(H=>w.startsWith(H.value))??z[0],B=z=>{const{value:w,mediaType:H,folderName:Q,newValue:Z,setNewValue:Y,maxFiles:X}=z,I=(0,g.of)(S),J=U(H).map(ie=>({label:ie,value:ie})),[ee,q]=(0,u.useState)(),[ne,se]=(0,u.useState)(W(J,w?.length?w:Q)),[oe,de]=(0,u.useState)([]),[fe,ae]=(0,u.useState)([]),ce=ie=>{ie?(ie=ie.toLowerCase(),ae(oe.filter(ve=>ve.search.includes(ie)))):ae(oe)};return(0,u.useEffect)(()=>{const ie=ne?.value;if(ie){const ve=H===c.zu.Icon?le=>le.name.endsWith(".svg"):le=>le.name.endsWith(".png")||le.name.endsWith(".gif");(0,D.tR)().get("-- Grafana --").then(le=>{le.listFiles(ie,X).subscribe({next:Ee=>{const Re=[];Ee.forEach(Oe=>{if(ve(Oe)){const Se=Oe.name.lastIndexOf(".");Re.push({value:`${ie}/${Oe.name}`,label:Oe.name,search:(Se?Oe.name.substring(0,Se):Oe.name).toLowerCase(),imgUrl:`public/${ie}/${Oe.name}`})}}),de(Re),ae(Re)}})})}},[H,ne,X]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x.D,{children:(0,n.jsx)(E.l6,{options:J,onChange:se,value:ne,menuShouldPortal:!1})}),(0,n.jsx)(x.D,{children:(0,n.jsx)(b.Z,{value:ee??"",placeholder:(0,o.t)("dimensions.folder-picker-tab.placeholder-search","Search"),onChange:ie=>{ce(ie),q(ie)}})}),fe&&(0,n.jsx)("div",{className:I.cardsWrapper,children:(0,n.jsx)(O,{cards:fe,onChange:ie=>Y(ie),value:Z})})]})},S=z=>({cardsWrapper:(0,a.css)({height:"30vh",minHeight:"50px",marginTop:"5px",maxWidth:"680px"})});var _=e(63527),K=e(72636),T=e(20012);const L=z=>{const{newValue:w,setNewValue:H,mediaType:Q}=z,Z=(0,g.of)(A),Y=(0,T.D)(w);let X=w?.substring(w.lastIndexOf("/")+1,w.lastIndexOf("."));return X.length>20&&(X=X.substring(0,20)+"..."),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x.D,{children:(0,n.jsx)(_.p,{onChange:I=>H(I.currentTarget.value),value:w})}),(0,n.jsxs)("div",{className:Z.iconContainer,children:[(0,n.jsx)(x.D,{label:(0,o.t)("dimensions.urlpicker-tab.label-preview","Preview"),children:(0,n.jsxs)("div",{className:Z.iconPreview,children:[Q===c.zu.Icon&&(0,n.jsx)(m.y,{src:Y,className:Z.img}),Q===c.zu.Image&&w&&(0,n.jsx)("img",{src:Y,alt:"Preview of the selected URL",className:Z.img})]})}),(0,n.jsx)(K.J,{children:X})]})]})},A=z=>({iconContainer:(0,a.css)({display:"flex",flexDirection:"column",width:"80%",alignItems:"center",alignSelf:"center"}),iconPreview:(0,a.css)({width:"238px",height:"198px",border:`1px solid ${z.colors.border.medium}`,display:"flex",alignItems:"center",justifyContent:"center"}),img:(0,a.css)({width:"147px",height:"147px",fill:z.colors.text.primary})}),N=z=>{const{value:w,onChange:H,mediaType:Q,folderName:Z,maxFiles:Y,hidePopper:X}=z,I=(0,g.of)(V),J=()=>{H(w),X?.()},ee=(0,u.useRef)(null),{dialogProps:q}=(0,s.s)({},ee),{overlayProps:ne}=(0,r.e)({onClose:J,isDismissable:!0,isOpen:!0},ee),se=w&&w.includes("://"),[oe,de]=(0,u.useState)(w??""),[fe,ae]=(0,u.useState)(se?c.QC.URL:c.QC.Folder),[ce,ie]=(0,u.useState)(new FormData),[ve,le]=(0,u.useState)(!1),[Ee,Re]=(0,u.useState)({message:""}),Oe=tt=>`${I.resourcePickerPopoverTab} ${fe===tt&&I.resourcePickerPopoverActiveTab}`,Se=()=>(0,n.jsx)(B,{value:w,mediaType:Q,folderName:Z,newValue:oe,setNewValue:de,maxFiles:Y}),Te=()=>(0,n.jsx)(L,{newValue:oe,setNewValue:de,mediaType:Q}),_e=()=>(0,n.jsx)(h,{mediaType:Q,setFormData:ie,setUpload:le,newValue:oe,error:Ee}),He=()=>{switch(fe){case c.QC.Folder:return Se();case c.QC.URL:return Te();case c.QC.Upload:return _e();default:return Se()}};return(0,n.jsx)(i.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,n.jsx)("section",{ref:ee,...ne,...q,children:(0,n.jsxs)("div",{className:I.resourcePickerPopover,children:[(0,n.jsxs)("div",{className:I.resourcePickerPopoverTabs,children:[(0,n.jsx)("button",{className:Oe(c.QC.Folder),onClick:()=>ae(c.QC.Folder),children:(0,n.jsx)(o.x6,{i18nKey:"dimensions.resource-picker-popover.folder",children:"Folder"})}),(0,n.jsx)("button",{className:Oe(c.QC.URL),onClick:()=>ae(c.QC.URL),children:(0,n.jsx)(o.x6,{i18nKey:"dimensions.resource-picker-popover.url",children:"URL"})})]}),(0,n.jsxs)("div",{className:I.resourcePickerPopoverContent,children:[He(),(0,n.jsxs)("div",{className:I.buttonRow,children:[(0,n.jsx)(f.$n,{variant:"secondary",onClick:()=>J(),fill:"outline",children:(0,n.jsx)(o.x6,{i18nKey:"dimensions.resource-picker-popover.cancel",children:"Cancel"})}),(0,n.jsx)(f.$n,{variant:oe&&oe!==w?"primary":"secondary",onClick:()=>{ve?fetch("/api/storage/upload",{method:"POST",body:ce}).then(tt=>{if(tt.status>=400){tt.json().then(Je=>Re(Je));return}else return tt.json()}).then(tt=>{(0,l.AI)().get(`api/storage/read/${tt.path}`).then(()=>de(`${p.$W.appUrl}api/storage/read/${tt.path}`)).then(()=>H(`${p.$W.appUrl}api/storage/read/${tt.path}`)).then(()=>X?.())}).catch(tt=>console.error(tt)):(H(oe),X?.())},children:(0,n.jsx)(o.x6,{i18nKey:"dimensions.resource-picker-popover.select",children:"Select"})})]})]})]})})})},V=z=>({resourcePickerPopover:(0,a.css)({borderRadius:z.shape.radius.default,boxShadow:z.shadows.z3,background:z.colors.background.primary,border:`1px solid ${z.colors.border.weak}`}),resourcePickerPopoverTab:(0,a.css)({width:"50%",textAlign:"center",padding:z.spacing(1,0),background:z.colors.background.secondary,color:z.colors.text.secondary,fontSize:z.typography.bodySmall.fontSize,cursor:"pointer",border:"none","&:focus:not(:focus-visible)":{outline:"none",boxShadow:"none"},":focus-visible":{position:"relative"}}),resourcePickerPopoverActiveTab:(0,a.css)({color:z.colors.text.primary,fontWeight:z.typography.fontWeightMedium,background:z.colors.background.primary}),resourcePickerPopoverContent:(0,a.css)({width:"315px",fontSize:z.typography.bodySmall.fontSize,minHeight:"184px",padding:z.spacing(1),display:"flex",flexDirection:"column"}),resourcePickerPopoverTabs:(0,a.css)({display:"flex",width:"100%",borderRadius:`${z.shape.radius.default} ${z.shape.radius.default} 0 0`}),buttonRow:(0,a.css)({display:"flex",justifyContent:"center",gap:z.spacing(2),padding:z.spacing(1)})})},20012:(te,R,e)=>{"use strict";e.d(R,{$:()=>i,D:()=>s});var n=e(739),a=e(32503);function s(r){return r?r.indexOf(":/")>0?r:window.__grafana_public_path__+r:""}function i(r,u){const o=u.mode??n.q_.Fixed;if(o===n.q_.Fixed){const f=s(u.fixed);return{isAssumed:!f,fixed:f,value:()=>f,get:p=>f}}const l=(0,a.UI)(r,u.field);if(!l){const f="";return{isAssumed:!0,fixed:f,value:()=>f,get:p=>f}}if(o===n.q_.Mapping){const f=p=>s(`${p}`);return{field:l,get:p=>f(l.values[p]),value:()=>f((0,a.sB)(l))}}const g=f=>{if(l&&l.display){const p=l.display(f).icon;return s(p??"")}return""};return{field:l,get:f=>g(l.values[f]),value:()=>g((0,a.sB)(l))}}},57444:(te,R,e)=>{"use strict";e.d(R,{H:()=>s});var n=e(739),a=e(32503);function s(r,u){return i((0,a.UI)(r,u?.field),u)}function i(r,u){if(!r){const g=u.fixed??0;return{isAssumed:!!u.field?.length||!u.fixed,fixed:g,value:()=>g,get:()=>g}}let o=g=>g%u.max;return u.mode===n.WQ.Clamped&&(o=g=>g<u.min?u.min:g>u.max?u.max:g),{field:r,get:g=>{const f=r.values[g];return f===null||typeof f!="number"?0:o(f)},value:()=>(0,a.sB)(r)}}},10392:(te,R,e)=>{"use strict";e.d(R,{Nn:()=>u,Ru:()=>o,hX:()=>i});var n=e(79118),a=e(739),s=e(32503);function i(l,g){return r((0,s.UI)(l,g?.field),g)}function r(l,g,f){if(!l){const y=g.fixed??0;return{isAssumed:!!g.field?.length||!g.fixed,fixed:y,value:()=>y,get:()=>y}}const p=(0,n.AP)(l),c=g.max-g.min;if(l.values.length<1||c<=0||p.delta<=0)return{fixed:g.min,value:()=>g.min,get:()=>g.min};let v=y=>g.min+y*c;if(f===a.QH.Quad){const y=Math.PI*(g.max/2)**2,h=Math.PI*(g.min/2)**2,d=y-h;v=E=>{let b=h+d*E;return Math.sqrt(b/Math.PI)*2}}const m=y=>{const h=l.values[y];let d=0;return h!==-1/0&&(d=(h-p.min)/p.delta),d>1?d=1:d<0&&(d=0),v(d)};return{get:m,value:()=>m((0,s.sB)(l)),field:l}}function u(l){return l||(l={min:0,max:1}),l.min==null&&(l.min=0),l.max==null&&(l.max=1),l}function o(l,g){let{min:f,max:p}=u(g);if(l||(l={}),l.max==null&&(l.max=p),l.min==null&&(l.min=f),l.min>l.max){const c=l.max;l.max=l.min,l.min=c}return l.min<f&&(l.min=f),l.max>p&&(l.max=p),l.fixed==null&&(l.fixed=l.min+(l.max-l.min)/2),l.field||(l.fixed>p?l.fixed=p:l.fixed<f&&(l.fixed=f)),l}},28807:(te,R,e)=>{"use strict";e.d(R,{E:()=>r});var n=e(95004),a=e(55386),s=e(739),i=e(32503);function r(o,l){const g=l.field?(0,i.UI)(o,l.field):o?.fields.find(f=>f.type===n.PU.string);return u(g,l)}function u(o,l){let g=l.fixed;const f=l.mode??s.RU.Fixed;if(f===s.RU.Fixed)return{isAssumed:!g,fixed:g,value:()=>g,get:c=>g};if(f===s.RU.Template){const c=x=>`TEMPLATE[${l.fixed} // ${x}]`;return o?{field:o,get:x=>c(o.values[x]),value:()=>c((0,i.sB)(o))}:(g=c(""),{isAssumed:!0,fixed:g,value:()=>g,get:x=>g})}if(!o)return{isAssumed:!0,fixed:g,value:()=>g,get:c=>g};let p=c=>(0,a.cN)(o.display(c));return{field:o,get:c=>p(o.values[c]),value:()=>p((0,i.sB)(o))}}},4896:(te,R,e)=>{"use strict";e.d(R,{Iu:()=>s,Iy:()=>u,QC:()=>r,nG:()=>a,zu:()=>i});var n=e(739);const a=Object.freeze({fixed:"",mode:n.RU.Field,field:""});var s=(o=>(o.Icon="img/icons/unicons",o.IOT="img/icons/iot",o.Marker="img/icons/marker",o.BG="img/bg",o))(s||{}),i=(o=>(o.Icon="icon",o.Image="image",o))(i||{}),r=(o=>(o.Folder="folder",o.URL="url",o.Upload="upload",o))(r||{}),u=(o=>(o.SMALL="small",o.NORMAL="normal",o))(u||{})},32503:(te,R,e)=>{"use strict";e.d(R,{B_:()=>c,UI:()=>v,Wb:()=>g,XV:()=>f,b5:()=>p,gG:()=>m,sB:()=>y,wv:()=>x});var n=e(16515),a=e(46644),s=e(43173),i=e(54825),r=e(20012),u=e(57444),o=e(10392),l=e(28807);function g(h,d){if(h?.series&&d.field)for(const E of h.series){const b=(0,i.K)(E,d,s.$.theme2);if(!b.isAssumed||h.series.length===1)return b}return(0,i.K)(void 0,d,s.$.theme2)}function f(h,d){if(h?.series&&d.field)for(const E of h.series){const b=(0,o.hX)(E,d);if(!b.isAssumed||h.series.length===1)return b}return(0,o.hX)(void 0,d)}function p(h,d){if(h?.series&&d.field)for(const E of h.series){const b=(0,u.H)(E,d);if(!b.isAssumed||h.series.length===1)return b}return(0,u.H)(void 0,d)}function c(h,d){if(h?.series&&d.field)for(const E of h.series){const b=(0,r.$)(E,d);if(!b.isAssumed||h.series.length===1)return b}return(0,r.$)(void 0,d)}function x(h,d){if(h?.series&&d.field)for(const E of h.series){const b=(0,l.E)(E,d);if(!b.isAssumed||h.series.length===1)return b}return(0,l.E)(void 0,d)}function v(h,d){const E=m(d,h);return E==null?void 0:h.fields[E]}function m(h,d,E){if(!(!d||!h?.length))for(let b=0;b<d.fields.length;b++){const D=d.fields[b];if(h===D.name)return b;const C=(0,n.Ct)(D,d,E);if(h===C)return b}}function y(h){const d=h.state?.calcs;if(d){const D=d[a.gy.lastNotNull];if(D!=null)return D}const E=h.values;let b=E.length-1;for(;b>=0;){const D=E[b--];if(D!=null)return D}}},97486:(te,R,e)=>{"use strict";e.d(R,{k:()=>P});var n=e(74848),a=e(2543),s=e(96540),i=e(37297),r=e(64394),u=e(60519),o=e(16515),l=e(84229),g=e(60311),f=e(739),p=e(63142),c=e(64400),x=e(12241),v=e(78013),m=e(89381),y=e(1932);function h(M,O,j){return(0,y.jM)(M,U=>{U.defaults.custom===void 0&&(U.defaults.custom={}),U.defaults.max=j;const{custom:W}=U.defaults;switch(W.stacking===void 0&&(W.stacking={group:"A"}),O){case"lines":W.drawStyle=f.GR.Line,W.stacking.mode=f.gs.None,W.fillOpacity=0;break;case"bars":W.drawStyle=f.GR.Bars,W.stacking.mode=f.gs.None,W.fillOpacity=100;break;case"points":W.drawStyle=f.GR.Points,W.stacking.mode=f.gs.None,W.fillOpacity=0;break;case"stacked_lines":W.drawStyle=f.GR.Line,W.stacking.mode=f.gs.Normal,W.fillOpacity=100,W.axisSoftMin=0;break;case"stacked_bars":W.drawStyle=f.GR.Bars,W.stacking.mode=f.gs.Normal,W.fillOpacity=100,W.axisSoftMin=0;break;default:{const B=O;throw new Error(`Invalid graph-style: ${B}`)}}})}function d(M,O,j){return(0,y.jM)(M,U=>{U.defaults.thresholds=j,U.defaults.custom=U.defaults.custom??{},U.defaults.custom.thresholdsStyle=O})}var E=e(56737),b=e(84596),D=e(76732);function C(M){const[O,{inc:j}]=(0,E.A)(1),U=(0,b.A)(M);return(0,s.useMemo)(()=>{U&&!(0,D.J3)(M,U,D.bW)&&j()},[M,U,j]),O}function P({data:M,height:O,width:j,timeZone:U,timeRange:W,onChangeTime:B,loadingState:S,annotations:_,onHiddenSeriesChanged:K,splitOpenFn:T,graphStyle:L,tooltipDisplayMode:A=f.$N.Single,anchorToZero:N=!1,yAxisMaximum:V,thresholdsConfig:z,thresholdsStyle:w,eventBus:H,vizLegendOverrides:Q,toggleLegendRef:Z}){const Y=(0,p.$j)(),X=(0,s.useMemo)(()=>(0,i.O)((0,x.V)(x.S),"Explore"),[]),[I,J]=(0,s.useState)({defaults:{min:N?0:void 0,max:V||void 0,unit:"short",color:{mode:r.Y.PaletteClassic},custom:{drawStyle:f.GR.Line,fillOpacity:0,pointSize:5}},overrides:[]}),ee=(0,s.useMemo)(()=>{const ie=h(I,L,V);return d(ie,w,z)},[I,L,V,z,w]),q=(0,m.h)(T,W),ne=(0,s.useMemo)(()=>(0,u.we)({fieldConfig:ee,data:M,timeZone:U,replaceVariables:ie=>ie,theme:Y,fieldConfigRegistry:X,dataLinkPostProcessor:q}),[X,M,U,Y,ee,q]),se=(0,s.useMemo)(()=>(0,u.we)({fieldConfig:{defaults:{},overrides:[]},data:_,timeZone:U,replaceVariables:ie=>ie,theme:Y,dataLinkPostProcessor:q}),[_,U,Y,q]),oe=C(ne),de=(0,s.useRef)(void 0);(0,s.useEffect)(()=>{if(!K)return;const ie=[];ne.forEach(ve=>{ve.fields.map(Ee=>Ee.config?.custom?.hideFrom?.viz).every(a.identity)&&ie.push((0,o.Ri)(ve))}),(de.current===void 0||!(0,a.isEqual)((0,a.sortBy)(ie),(0,a.sortBy)(de.current)))&&(de.current=ie,K(ie))},[ne,K]);const fe={eventsScope:"explore",eventBus:H,sync:()=>l.y.Off,onToggleSeriesVisibility(ie,ve){J((0,v.M)(ie,ve,I,M))},dataLinkPostProcessor:q};function ae(ie,ve){if(!ie){J({...I,overrides:[]});return}J((0,v.M)(ie,ve,I,M))}Z&&(Z.current=ae);const ce=(0,s.useMemo)(()=>({tooltip:{mode:A,sort:f.xB.None},legend:{displayMode:f.lm.List,showLegend:!0,placement:"bottom",calcs:[],...Q}}),[A,Q]);return(0,n.jsx)(c.XF,{value:fe,children:(0,n.jsx)(g.m,{data:{series:ne,timeRange:W,state:S,annotations:se,structureRev:oe},pluginId:"timeseries",title:"",width:j,height:O,onChangeTimeRange:B,timeZone:U,options:ce})})}},5929:(te,R,e)=>{"use strict";e.d(R,{y:()=>b});var n=e(74848),a=e(96540),s=e(42941),i=e(92745),r=e(67522),u=e(15757),o=e(83953),l=e(97486),g=e(77824),f=e(72265);const p=f.sG.map(D=>({value:D,label:D[0].toUpperCase()+D.slice(1).replace(/_/," ")}));function c(D){const{graphStyle:C,onChangeGraphStyle:P}=D;return(0,n.jsx)(g.z,{size:"sm",options:p,value:C,onChange:P})}var x=e(29043);const v="grafana.explore.style.graph",m=D=>{store.set(v,D)},y=()=>d(x.A.get(v)),h="lines",d=D=>f.sG.find(P=>P===D)??h,E=20,b=({data:D,eventBus:C,height:P,width:M,timeRange:O,timeZone:j,annotations:U,onChangeTime:W,splitOpenFn:B,thresholdsConfig:S,thresholdsStyle:_,loadingState:K,statusMessage:T})=>{const[L,A]=(0,s.A)(!1),[N,V]=(0,a.useState)(y),z=(0,a.useCallback)(H=>{(0,o.ng)(H),V(H)},[]),w=(0,a.useMemo)(()=>L?D:D.slice(0,E),[D,L]);return(0,n.jsx)(r.NR,{title:(0,i.t)("graph.container.title","Graph"),titleItems:[!L&&E<D.length&&(0,n.jsx)(u.m,{toggleShowAllSeries:A,info:(0,n.jsxs)(i.x6,{i18nKey:"graph.container.show-only-series",children:["Showing only ",{MAX_NUMBER_OF_TIME_SERIES:E}," series"]}),buttonLabel:(0,n.jsxs)(i.x6,{i18nKey:"graph.container.show-all-series",children:["Show all ",{length:D.length}]}),tooltip:(0,i.t)("graph.container.content","Rendering too many series in a single panel may impact performance and make data harder to read. Consider refining your queries.")},"disclaimer")].filter(Boolean),width:M,height:P,loadingState:K,statusMessage:T,actions:(0,n.jsx)(c,{graphStyle:N,onChangeGraphStyle:z}),children:(H,Q)=>(0,n.jsx)(l.k,{graphStyle:N,data:w,height:Q,width:H,timeRange:O,onChangeTime:W,timeZone:j,annotations:U,splitOpenFn:B,loadingState:K,thresholdsConfig:S,thresholdsStyle:_,eventBus:C})})}},15757:(te,R,e)=>{"use strict";e.d(R,{m:()=>o});var n=e(74848),a=e(22803),s=e(63142),i=e(30703),r=e(45967),u=e(45861);function o(g){const{toggleShowAllSeries:f,info:p,tooltip:c,buttonLabel:x}=g,v=(0,s.of)(l);return(0,n.jsxs)("div",{className:v.disclaimer,children:[(0,n.jsxs)("span",{className:v.warningMessage,children:[(0,n.jsx)(i.I,{name:"exclamation-triangle","aria-hidden":"true"}),p]}),(0,n.jsx)(r.m,{content:c,children:(0,n.jsx)(u.$n,{variant:"secondary",size:"sm",onClick:f,children:x})})]},"disclaimer")}const l=g=>({disclaimer:(0,a.css)({label:"series-disclaimer",display:"flex",alignItems:"center",gap:g.spacing(1)}),warningMessage:(0,a.css)({display:"flex",alignItems:"center",gap:g.spacing(.5),color:g.colors.warning.main,fontSize:g.typography.bodySmall.fontSize})})},67155:(te,R,e)=>{"use strict";e.d(R,{O:()=>v,v:()=>y});var n=e(74848),a=e(96540),s=e(75505),i=e(41119),r=e(739),u=e(60519),o=e(95004),l=e(2197),g=e(39443),f=e(43173),p=e(24343),c=e(36100),x=e(78529);function v(b){const{timeZone:D,splitOpen:C,range:P,logsSortOrder:M,width:O,dataFrame:j,columnsWithMeta:U,logsFrame:W}=b,[B,S]=(0,a.useState)(void 0),_=W?.timeField.index,K=(0,a.useCallback)(L=>{if(!L.length)return L;const A=(0,i.ES)(L,_,M===r.uH.Descending),[N]=(0,u.we)({data:[A],timeZone:D,theme:f.$.theme2,replaceVariables:V=>V,fieldConfig:{defaults:{custom:{}},overrides:[]}});for(const V of N.fields)V.getLinks=z=>(0,x.QL)({field:V,rowIndex:z.valueRowIndex,splitOpenFn:C,range:P,dataFrame:A}),V.config={...V.config,custom:{inspect:!0,filterable:!0,width:E(V),...V.config.custom},filterable:m(V,W?.bodyField.name??"",W?.timeField.name??"")},V.type=V.type===o.PU.string?(0,i.dF)(V)??o.PU.string:V.type;return N},[M,D,C,P,W?.bodyField.name,W?.timeField.name,_]);if((0,a.useEffect)(()=>{(async()=>{if(!W?.timeField.name||!W?.bodyField.name){S(void 0);return}const A=y(j);let N=h(U);const V=d(N);if(V?A.push(V):A.push({id:"organize",options:{indexByName:{[W.bodyField.name]:0,[W.timeField.name]:1},includeByName:{[W.bodyField.name]:!0,[W.timeField.name]:!0}}}),A.length>0){const z=await(0,s.s)((0,l.m)(A,[j])),w=K(z[0]);S(w)}else S(K(j))})()},[U,j,M,K,W?.bodyField.name,W?.timeField.name]),!B)return null;const T=L=>{const{value:A,key:N,operator:V}=L,{onClickFilterLabel:z,onClickFilterOutLabel:w}=b;!z||!w||(V===c.mc&&z(N,A,j),V===c.Zi&&w(N,A,j))};return(0,n.jsx)(p.X,{data:B,width:O,onCellFilterAdded:b.onClickFilterLabel&&b.onClickFilterOutLabel?T:void 0,height:b.height,footerOptions:{show:!0,reducer:["count"],countRows:!0},initialSortBy:[{displayName:W?.timeField.name||"",desc:M===r.uH.Descending}]})}const m=(b,D,C)=>!(!D||!C||D===b.name||C===b.name||b.config.links?.length);function y(b){return b.fields.filter(D=>{const C=D.typeInfo?.frame==="json.RawMessage"&&D.name==="labels"&&b?.meta?.type!==g.m.LogLines,P=D.name==="labels"&&D.type===o.PU.other&&b?.meta?.type===g.m.LogLines;return C||P}).flatMap(D=>[{id:"extractFields",options:{format:"json",keepTime:!1,replace:!1,source:D.name}}])}function h(b){let D={};return Object.keys(b).filter(C=>b[C].active).forEach(C=>{const P=b[C].index;P!==void 0&&(D[C]=P)}),D}function d(b){let D={};for(const C in b)D[C]=!0;return Object.keys(b).length>0?{id:"organize",options:{indexByName:b,includeByName:D}}:null}function E(b){if(b.type===o.PU.time)return 200}},44720:(te,R,e)=>{"use strict";e.d(R,{a:()=>o,d:()=>l});var n=e(74848),a=e(22803),s=e(34734),i=e(63142),r=e(3642);const u=(g,f)=>({valueNavigation:(0,a.css)({width:r.QH,fontWeight:"bold"}),valueNavigationWrapper:(0,a.css)({display:"flex",justifyContent:"flex-end"}),itemLabelsWrap:(0,a.css)({borderBottom:f?`1px solid ${g.colors.border.medium}`:""})}),o=g=>g.includes(s.gs)?g.replace(s.gs,""):g,l=({valueLabels:g,expanded:f})=>{const p=(0,i.of)(u,f);return(0,n.jsx)("div",{className:p.itemLabelsWrap,children:(0,n.jsx)("div",{className:p.valueNavigationWrapper,children:g.map((c,x)=>(0,n.jsx)("span",{className:p.valueNavigation,children:o(c.name)},c.name))})})}},3642:(te,R,e)=>{"use strict";e.d(R,{Ay:()=>C,QH:()=>h,Jd:()=>d});var n=e(74848),a=e(22803),s=e(73287),i=e(92745),r=e(31200),u=e(27489),o=e(63142),l=e(76319),g=e(44720),f=e(53593);const p=(P,M)=>({rowWrapper:(0,a.css)({position:"relative",minWidth:h,paddingRight:"5px"}),rowValue:(0,a.css)({whiteSpace:"nowrap",overflowX:"auto",MsOverflowStyle:"none",scrollbarWidth:"none",display:"block",paddingRight:"10px","&::-webkit-scrollbar":{display:"none"},"&:before":{pointerEvents:"none",content:"''",width:"100%",height:"100%",position:"absolute",left:0,top:0,background:`linear-gradient(to right, transparent calc(100% - 25px), ${P.colors.background.primary})`}}),rowValuesWrap:(0,a.css)({paddingLeft:d,width:`calc(${M} * ${h})`,display:"flex"})}),c=({totalNumberOfValues:P,values:M,hideFieldsWithoutValues:O})=>{const j=(0,o.of)(p,P);return(0,n.jsx)("div",{role:"cell",className:j.rowValuesWrap,children:M?.map(U=>O&&(U.value===void 0||U.value===f.M)?null:(0,n.jsx)("span",{className:j.rowWrapper,children:(0,n.jsx)("span",{className:j.rowValue,children:U.value})},U.key))})},x=P=>{const M=P.isDark?"#ce9178":"#a31515",O=P.isDark?"#73bf69":"#56a64b";return{metricName:(0,a.css)({color:O}),metricValue:(0,a.css)({color:M}),expanded:(0,a.css)({display:"block",textIndent:"1em"})}},m=({value:P,index:M,length:O,isExpandedView:j})=>{const U=(0,o.of)(x),W=P.key,B=P.value;return(0,n.jsxs)("span",{className:j?U.expanded:"",children:[(0,n.jsx)("span",{className:U.metricName,children:W}),(0,n.jsx)("span",{children:"="}),(0,n.jsx)("span",{children:'"'}),(0,n.jsx)("span",{className:U.metricValue,children:B}),(0,n.jsx)("span",{children:'"'}),M<O-1&&(0,n.jsx)("span",{children:", "})]},M)},y="20px",h="80px",d="25px",E=(P,M,O)=>({rowWrapper:(0,a.css)({borderBottom:`1px solid ${P.colors.border.medium}`,display:"flex",position:"relative",paddingLeft:"22px",alignItems:O?"":"center",height:O?"":"100%"}),copyToClipboardWrapper:(0,a.css)({position:"absolute",left:0,bottom:O?"":"0",top:O?"4px":"0",margin:"auto",zIndex:1,height:"16px",width:"16px"}),rowLabelWrapWrap:(0,a.css)({position:"relative",width:`calc(100% - (${M} * ${h}) - ${d})`}),rowLabelWrap:(0,a.css)({whiteSpace:"nowrap",overflowX:"auto",MsOverflowStyle:"none",scrollbarWidth:"none",paddingRight:y,"&::-webkit-scrollbar":{display:"none"},"&:after":{pointerEvents:"none",content:"''",width:"100%",height:"100%",position:"absolute",left:0,top:0,background:`linear-gradient(to right, transparent calc(100% - ${y}), ${P.colors.background.primary})`}})});function b(P){let M=[],O=[];for(const j in P)j in P&&P[j]&&!j.includes("Value")?M.push({key:j,value:P[j]}):j in P&&P[j]&&j.includes("Value")&&O.push({key:j,value:P[j]});return{values:O,attributeValues:M}}const C=({listItemData:P,listKey:M,totalNumberOfValues:O,valueLabels:j,isExpandedView:U})=>{const{__name__:W,...B}=P,S=(0,r.Rq)(W),[_,K]=(0,s.A)(),T=j?.length??O,L=(0,o.of)(E,T,U),{values:A,attributeValues:N}=b(B),V=H=>H==="\u221E"||H==="Infinity"?"+Inf":H,z=`${S?W:""}{${S?"":`"${W}", `}${N.map(H=>`${(0,r.Nc)(H.key)}="${V(H.value)}"`)}}`,w=!!(j&&j?.length);return(0,n.jsxs)(n.Fragment,{children:[j!==void 0&&U&&(0,n.jsx)(g.d,{valueLabels:j,expanded:U}),(0,n.jsxs)("div",{className:L.rowWrapper,children:[(0,n.jsx)("span",{className:L.copyToClipboardWrapper,children:(0,n.jsx)(l.K,{tooltip:(0,i.t)("explore.raw-list-item.tooltip-copy-to-clipboard","Copy to clipboard"),onClick:()=>{(0,u.rR)("grafana_explore_prometheus_instant_query_ui_raw_toggle_expand"),K(z)},name:"copy"})}),(0,n.jsx)("span",{role:"cell",className:L.rowLabelWrapWrap,children:(0,n.jsxs)("div",{className:L.rowLabelWrap,children:[S&&(0,n.jsx)("span",{children:W}),(0,n.jsx)("span",{children:"{"}),!S&&W!==""&&(0,n.jsxs)("span",{children:['"',W,'"',", "]}),(0,n.jsx)("span",{children:N.map((H,Q)=>(0,n.jsx)(m,{isExpandedView:U,value:H,index:Q,length:N.length},Q))}),(0,n.jsx)("span",{children:"}"})]})}),(0,n.jsx)(c,{hideFieldsWithoutValues:w,totalNumberOfValues:T,values:A})]},M)]})}},53593:(te,R,e)=>{"use strict";e.d(R,{E:()=>s,M:()=>a});var n=e(55386);const a=" ",s=i=>{const r={},u=[],o=i.fields.filter(f=>!["Time"].includes(f.name));let l=o.find(f=>f.name==="__name__")?.values??[];!l.length&&o.length&&o[0].values.length&&(l=Array(o[0].values.length).fill(""));const g=i.fields.filter(f=>!["__name__"].includes(f.name));return l.forEach(function(f,p){r[f]={};const c=r[f][p]??{};for(const x of g){const v=x.name;if(v!=="Time")if(typeof x?.display=="function"){const m=x?.display(x.values[p]);if(!isNaN(m.numeric))c[v]=m.numeric.toString(10);else{const y=(0,n.cN)(m);y?c[v]=y:v.includes("Value #")&&(c[v]=a)}}else console.warn("Field display method is missing!")}u.push({...c,__name__:f})}),u}},52830:(te,R,e)=>{"use strict";e.d(R,{YZ:()=>l,sz:()=>o,tU:()=>r});var n=e(74848),a=e(96540),s=e(52763),i=e(20718),r=(g=>(g.RichHistory="Query history",g.Starred="Starred",g.Settings="Settings",g))(r||{});const u=(0,a.createContext)({selectedTab:"Query history",setSelectedTab:()=>{},drawerOpened:!1,setDrawerOpened:()=>{}});function o(){return(0,a.useContext)(u)}function l({children:g}){const[f,p]=(0,a.useState)("Query history"),[c,x]=(0,a.useState)(!1),v=(0,s.d4)(i.i6);return(0,a.useEffect)(()=>{v&&p(v.starredTabAsFirstTab?"Starred":"Query history")},[v,p]),(0,n.jsx)(u.Provider,{value:{selectedTab:f,setSelectedTab:p,drawerOpened:c,setDrawerOpened:x},children:g})}},98838:(te,R,e)=>{"use strict";e.d(R,{Y:()=>s});var n=e(96540);const a=(0,n.createContext)({openDrawer:()=>{},closeDrawer:()=>{},isDrawerOpen:!1,openAddQueryModal:()=>{},closeAddQueryModal:()=>{},renderSaveQueryButton:()=>null,queryLibraryEnabled:!1});function s(){return(0,n.useContext)(a)}},55555:(te,R,e)=>{"use strict";e.d(R,{g:()=>s});var n=e(74848),a=e(25229);const s=({timeInMs:r,className:u,humanize:o})=>(0,n.jsx)("span",{className:u,children:i(r,o)}),i=(r,u=!1)=>{const o=r/1e3;if(!u)return`${o.toFixed(1)}s`;const l=(0,a.Ah)(o,"seconds"),g=l.hours(),f=l.minutes(),p=l.seconds();return g?`${g}h ${f}m ${p}s`:f?`${f}m ${p}s`:`${p}s`}},49987:(te,R,e)=>{"use strict";e.d(R,{H:()=>A});var n=e(74848),a=e(2543),s=e(96540),i=e(49785),r=e(92745),u=e(27489),o=e(37386),l=e(77824),g=e(34999),f=e(22787),p=e(45861),c=e(95506),x=e(73427),v=e(11257),m=e(92138),y=e(43173),h=e(36490),d=e(29043),E=e(65635),b=e(6262),D=(N=>(N.UNKNOWN="unknown-error",N.NAVIGATION="navigation-error",N))(D||{}),C=(N=>(N.FETCH_DASHBOARD="fetch-dashboard",N.SET_DASHBOARD_LS="set-dashboard-ls-error",N))(C||{});function P({panel:N,dashboardUid:V,openInNewTab:z,timeRange:w}){let H={meta:{},dashboard:{title:"",uid:"",panels:[N],schemaVersion:E.O2}};if(w){const Z=w.raw;H.dashboard.time={from:typeof Z.from=="string"?Z.from:Z.from.toISOString(),to:typeof Z.to=="string"?Z.to:Z.to.toISOString()}}try{d.A.setObject(b.us,H)}catch{return{error:"set-dashboard-ls-error",message:(0,r.t)("dashboard-scene.add-to-dashboard.message.could-panel-dashboard-please-again","Could not add panel to dashboard. Please try again.")}}const Q=M(V);if(z)return!e.g.open(y.$.appUrl+Q,"_blank")?(d.A.delete(b.us),{error:"navigation-error",message:(0,r.t)("dashboard-scene.add-to-dashboard.message.could-navigate-selected-dashboard-please-again","Could not navigate to the selected dashboard. Please try again.")}):void 0;h.Ny.push(m.I.stripBaseFromUrl(Q))}function M(N){return N?`d/${N}`:"dashboard/new"}var O=(N=>(N.NewDashboard="new-dashboard",N.ExistingDashboard="existing-dashboard",N))(O||{});function j({onClose:N,buildPanel:V,timeRange:z,options:w,children:H}){const[Q,Z]=(0,s.useState)(),{handleSubmit:Y,control:X,formState:{errors:I},watch:J}=(0,i.mN)({defaultValues:{saveTarget:"new-dashboard"}}),ee=x.TP.hasPermission(v.w.DashboardsCreate),q=x.TP.hasPermission(v.w.DashboardsWrite),ne=[];ee&&ne.push({label:(0,r.t)("dashboard-scene.add-to-dashboard-form.label.new-dashboard","New dashboard"),value:"new-dashboard"}),q&&ne.push({label:(0,r.t)("dashboard-scene.add-to-dashboard-form.label.existing-dashboard","Existing dashboard"),value:"existing-dashboard"});const se=ne.length>1?J("saveTarget"):ne[0].value,oe=(de,fe)=>{Z(void 0);const ae=fe.saveTarget==="existing-dashboard"?fe.dashboardUid:void 0,ce=V(w);(0,u.rR)("e_2_d_submit",{newTab:de,saveTarget:fe.saveTarget,queries:ce.targets});const ie=P({dashboardUid:ae,panel:ce,openInNewTab:de,timeRange:z});if(ie){Z(ie);return}N()};return(0,s.useEffect)(()=>{(0,u.rR)("e_2_d_open")},[]),(0,n.jsxs)("form",{children:[H,ne.length>1&&(0,n.jsx)(i.xI,{control:X,render:({field:{ref:de,...fe}})=>(0,n.jsx)(o.D,{label:(0,r.t)("dashboard-scene.add-to-dashboard-form.label-target-dashboard","Target dashboard"),description:(0,r.t)("dashboard-scene.add-to-dashboard-form.description-choose-where-to-add-the-panel","Choose where to add the panel."),children:(0,n.jsx)(l.z,{options:ne,...fe,id:"e2d-save-target"})}),name:"saveTarget"}),se==="existing-dashboard"&&(0,n.jsx)(i.xI,{render:({field:{ref:de,value:fe,onChange:ae,...ce}})=>(0,n.jsx)(o.D,{label:(0,r.t)("dashboard-scene.add-to-dashboard-form.label-dashboard","Dashboard"),description:(0,r.t)("dashboard-scene.add-to-dashboard-form.description-select-which-dashboard-panel-created","Select in which dashboard the panel will be created."),error:I.dashboardUid?.message,invalid:!!I.dashboardUid,children:(0,n.jsx)(c.b,{...ce,inputId:"e2d-dashboard-picker",defaultOptions:!0,onChange:ie=>ae(ie?.uid)})}),control:X,name:"dashboardUid",shouldUnregister:!0,rules:{required:{value:!0,message:(0,r.t)("dashboard-scene.add-to-dashboard-form.message.this-field-is-required","This field is required.")}}}),Q&&(0,n.jsx)(g.F,{severity:"error",title:(0,r.t)("dashboard-scene.add-to-dashboard-form.title-error-adding-the-panel","Error adding the panel"),children:Q.message}),(0,n.jsxs)(f.a.ButtonRow,{children:[(0,n.jsx)(p.$n,{type:"reset",onClick:N,fill:"outline",variant:"secondary",children:(0,n.jsx)(r.x6,{i18nKey:"dashboard-scene.add-to-dashboard-form.cancel",children:"Cancel"})}),(0,n.jsx)(p.$n,{type:"submit",variant:"secondary",onClick:Y((0,a.partial)(oe,!0)),icon:"external-link-alt",children:(0,n.jsx)(r.x6,{i18nKey:"dashboard-scene.add-to-dashboard-form.open-in-new-tab",children:"Open in new tab"})}),(0,n.jsx)(p.$n,{type:"submit",variant:"primary",onClick:Y((0,a.partial)(oe,!1)),icon:"apps",children:(0,n.jsx)(r.x6,{i18nKey:"dashboard-scene.add-to-dashboard-form.open-dashboard",children:"Open dashboard"})})]})]})}function U(N){}var W=e(52763),B=e(20718);function S(N,V){let z=[];return N==="table"&&V.panelState?.logs?.columns&&(V.panelState.logs?.labelFieldName&&z.push({id:"extractFields",options:{source:V.panelState.logs.labelFieldName}}),z.push({id:"organize",options:{indexByName:Object.values(V.panelState.logs.columns).reduce((w,H,Q)=>({...w,[H]:Q}),{}),includeByName:Object.values(V.panelState.logs.columns).reduce((w,H)=>({...w,[H]:!0}),{})}})),z}function _(N){const V=L(N.queries,N.queryResponse,N?.panelState);return{targets:N.queries,type:V,title:(0,r.t)("explore.build-dashboard-panel-from-explore-state.title.new-panel","New Panel"),gridPos:{x:0,y:0,w:12,h:8},datasource:N.datasource,transformations:S(V,N)}}const K=N=>!N.hide,T=N=>V=>V.refId===N;function L(N,V,z){for(const{refId:w}of N.filter(K)){const H=T(w);if(V.flameGraphFrames.some(H))return"flamegraph";if(V.graphFrames.some(H))return"timeseries";if(V.logsFrames.some(H))return z?.logs?.visualisationType?z.logs.visualisationType:"logs";if(V.nodeGraphFrames.some(H))return"nodeGraph";if(V.traceFrames.some(H))return"traces";if(V.customFrames.some(H))return V.customFrames.find(H)?.meta?.preferredVisualisationPluginId??"table"}return"table"}function A(N){const{exploreId:V,onClose:z}=N,w=(0,W.d4)((0,B.qq)(V)),H=()=>_({datasource:w.datasourceInstance?.getRef(),queries:w.queries,queryResponse:w.queryResponse,panelState:w?.panelsState});return(0,n.jsx)(j,{onClose:z,buildPanel:H,timeRange:w.range,options:void 0})}},39338:(te,R,e)=>{"use strict";e.d(R,{t:()=>s});var n=e(15130),a=e(11257);function s(){const i=n.TP.hasPermission(a.w.DashboardsCreate),r=n.TP.hasPermission(a.w.DashboardsWrite);return i&&!r?"Add panel to new dashboard":r&&!i?"Add panel to existing dashboard":"Add panel to dashboard"}},20806:(te,R,e)=>{"use strict";e.d(R,{s:()=>l});var n=e(74848),a=e(92138),s=e(92745),i=e(36490),r=e(22787),u=e(41654),o=e(45861);function l(g){const{onDismiss:f,path:p,title:c}=g,x=()=>{e.g.open(a.I.assureBaseUrl(p),"_blank"),f()},v=()=>i.Ny.push(p);return(0,n.jsxs)(r.a,{title:c,isOpen:!0,onDismiss:f,children:[(0,n.jsx)(u.B,{direction:"column",gap:1,children:(0,n.jsx)("p",{children:(0,n.jsx)(s.x6,{i18nKey:"explore.confirm-navigation-modal.new-tab",children:"Do you want to proceed in the current tab or open a new tab?"})})}),(0,n.jsxs)(r.a.ButtonRow,{children:[(0,n.jsx)(o.$n,{onClick:f,fill:"outline",variant:"secondary",children:(0,n.jsx)(s.x6,{i18nKey:"explore.confirm-navigation-modal.cancel",children:"Cancel"})}),(0,n.jsx)(o.$n,{type:"submit",variant:"secondary",onClick:x,icon:"external-link-alt",children:(0,n.jsx)(s.x6,{i18nKey:"explore.confirm-navigation-modal.open-in-new-tab",children:"Open in new tab"})}),(0,n.jsx)(o.$n,{type:"submit",variant:"primary",onClick:v,icon:"apps",children:(0,n.jsx)(s.x6,{i18nKey:"explore.confirm-navigation-modal.open",children:"Open"})})]})]})}},9860:(te,R,e)=>{"use strict";e.d(R,{w:()=>r});var n=e(74848),a=e(96540),s=e(87063),i=e(3260);function r({extensions:l,onSelect:g}){const{categorised:f,uncategorised:p}=o(l),c=p.length>0&&Object.keys(f).length>0;return(0,n.jsx)(s.W,{children:(0,n.jsxs)(n.Fragment,{children:[Object.keys(f).map(x=>(0,n.jsx)(s.W.Group,{label:(0,i.pL)(x,25),children:u(f[x],g)},x)),c&&(0,n.jsx)(s.W.Divider,{},"divider"),u(p,g)]})})}function u(l,g){return l.map(f=>(0,n.jsx)(s.W.Item,{ariaLabel:f.title,icon:f?.icon||"plug",label:(0,i.pL)(f.title,25),onClick:p=>{if(f.path)return g(f);f.onClick?.(p)}},f.id))}function o(l){return(0,a.useMemo)(()=>{const g=[],f={};for(const p of l){if(!p.category){g.push(p);continue}Array.isArray(f[p.category])||(f[p.category]=[]),f[p.category].push(p)}return{uncategorised:g,categorised:f}},[l])}},89381:(te,R,e)=>{"use strict";e.d(R,{h:()=>s});var n=e(96540),a=e(78529);const s=(i,r)=>(0,n.useMemo)(()=>(0,a.YV)(i,r),[i,r])},55133:(te,R,e)=>{"use strict";e.d(R,{m:()=>I,s:()=>ee});var n=e(96540),a=e(27963),s=e(64762),i=e(52763),r=e(20718),u=e(2513);const o={parse:q=>{if(!q.left&&!q.right)return{to:{left:{datasource:null,queries:[],range:{from:u.k.from,to:u.k.to}},schemaVersion:0},error:!1};let ne,se,oe,de;return typeof q.left=="string"&&([ne,oe]=p(q.left)),typeof q.right=="string"?[se,de]=p(q.right):q.right&&(se=f,de=!0),ne||(ne=f),{to:{schemaVersion:0,left:ne,...se&&{right:se}},error:!!oe||!!de}}},l=(q,...ne)=>ne.some(se=>q.hasOwnProperty(se));var g=(q=>(q[q.RangeFrom=0]="RangeFrom",q[q.RangeTo=1]="RangeTo",q[q.Datasource=2]="Datasource",q[q.SegmentsStart=3]="SegmentsStart",q))(g||{});const f={datasource:null,queries:[],range:u.k};function p(q){let ne;try{ne=JSON.parse(q)}catch{return[f,!0]}if(!Array.isArray(ne))return[{queries:[],range:u.k,...ne},!1];if(ne.length<=3)return[f,!0];const se={from:ne[0],to:ne[1]},oe=ne[2],de=ne.slice(3),fe=de.filter(ce=>!l(ce,"ui","mode","__panelsState")),ae=de.find(ce=>l(ce,"__panelsState"))?.__panelsState;return[{datasource:oe,queries:fe,range:se,panelsState:ae},!1]}var c=e(62635),x=e(8692);const v={parse:q=>{if(!q||!q.panes||typeof q.panes!="string")return{to:{schemaVersion:1,panes:{[(0,c.o$)()]:m}},error:!1};let ne;try{ne=JSON.parse(q.panes)}catch{}if(ne==null||typeof ne!="object")return{to:{schemaVersion:1,panes:{[(0,c.o$)()]:m}},error:!0};const se=Object.entries(ne).map(([oe,de])=>[oe,y(de)]).reduce((oe,[de,fe])=>{let ae=de;return(ae.length!==3||/^\d+$/.test(ae)||ae.split("").some(ce=>c.WP.indexOf(ce)===-1))&&(ae=(0,c.o$)()),{...oe,[ae]:fe}},{});return Object.keys(se).length||(se[(0,c.o$)()]=m),{to:{schemaVersion:1,panes:se},error:!1}},migrate:q=>({schemaVersion:1,panes:{[(0,c.o$)()]:q.left,...q.right&&{[(0,c.o$)()]:q.right}}})},m={datasource:null,queries:[],range:u.k};function y(q){return!q||typeof q!="object"?m:{...m,...(0,x.C)("queries",q)&&Array.isArray(q.queries)&&{queries:q.queries},...(0,x.C)("datasource",q)&&typeof q.datasource=="string"&&{datasource:q.datasource},...(0,x.C)("panelsState",q)&&!!q.panelsState&&typeof q.panelsState=="object"&&{panelsState:q.panelsState},...(0,x.C)("range",q)&&!!q.range&&typeof q.range=="object"&&(0,x.C)("from",q.range)&&(0,x.C)("to",q.range)&&typeof q.range.from=="string"&&typeof q.range.to=="string"&&{range:{from:q.range.from,to:q.range.to}}}}const h=q=>E(q),d=[o,v],E=q=>{const ne=b(q),[se,...oe]=d.slice(ne),{error:de,to:fe}=se.parse(q);return[oe.reduce((ce,ie)=>ie.migrate?ie.migrate(ce):ce,fe),de]};function b(q){return!q||!("schemaVersion"in q)||!q.schemaVersion?0:typeof q.schemaVersion=="number"?q.schemaVersion:typeof q.schemaVersion=="string"?Number.parseInt(q.schemaVersion,10):0}var D=e(2543),C=e(19379),P=e(707),M=e(51845),O=e(35231),j=e(19050),U=e(94543),W=e(83953),B=e(80144),S=e(28105),_=e(1906),K=e(28998),T=e(18615);const L=(q,ne)=>{const se=!(0,D.isEqual)(ne?.datasource,q?.datasource),oe=!(0,D.isEqual)(ne?.queries,q?.queries),de=!(0,D.isEqual)(ne?.range||u.k,q?.range||u.k),fe=!(0,D.isEqual)(ne?.panelsState,q?.panelsState);return{datasource:se,queries:oe,range:de,panelsState:fe}};async function A(q,ne,se){if(q)try{return await(0,K.tR)().get(q)}catch{}const oe=[...new Set(ne.map(de=>de.datasource).filter(S.zz).map(de=>typeof de=="string"?de:de.uid))];try{if(oe.length>=1){const de=(await Promise.allSettled(oe.map(fe=>(0,K.tR)().get(fe)))).filter(x.s);if(de.length>1)return await(0,K.tR)().get(T.uv);if(de.length===1)return await(0,K.tR)().get(oe[0])}}catch{}return(0,K.tR)().get((0,c.HQ)(se)).catch(()=>(0,K.tR)().get()).catch(()=>{})}function N(q){return{...q.getDefaultQuery?.(_.Jk.Explore),refId:"A",datasource:q.getRef()}}function V(q){return q.name===T.uv}function z(q){return q&&V(q)?ne=>!!ne.datasource:ne=>ne.datasource?typeof ne.datasource=="string"?ne.datasource===q?.uid||ne.datasource===q?.name:ne.datasource.uid===q?.uid:!0}async function w(q){return(await Promise.allSettled(q.map(se=>(0,K.tR)().get(se.datasource).then(oe=>({query:se,ds:oe}))))).filter(x.s).map(({value:se})=>se.query)}function H(q,ne,se){const oe=Object.values(q.panes);if(oe.length>1){const de=oe.some(({range:fe},ae,[{range:ce}])=>!(0,D.isEqual)(fe,ce));se((0,O.qz)({syncedTimes:!de}))}Object.entries(q.panes).forEach(async([de,fe],ae)=>{const{datasource:ce,queries:ie,range:ve,panelsState:le}=fe,Ee=ne[de];if(Ee!==void 0){const Re=L(fe,I(Ee));Promise.resolve().then(async()=>{Re.datasource&&ce&&await se((0,P.wh)({exploreId:de,datasource:ce}))}).then(async()=>{Re.range&&se((0,U.JA)({exploreId:de,rawRange:(0,W.Z9)(ve)})),Re.queries&&se((0,j.h9)({exploreId:de,queries:(0,B.v)(ie)})),(Re.queries||Re.range)&&(await se((0,j.hS)(de)),se((0,j.Od)({exploreId:de}))),Re.panelsState&&le&&se((0,M.fx)({exploreId:de,panelsState:le}))})}else se((0,M.Gd)({exploreId:de,datasource:ce||"",queries:(0,B.v)(ie),range:(0,W.Z9)(ve),panelsState:le,position:ae,eventBridge:new C.o}))}),Object.keys(ne).filter(de=>!Object.keys(q.panes).includes(de)).forEach(de=>se((0,O.J8)(de)))}function Q(q,ne,se,oe,de){oe((0,O.Ve)()),Promise.all(Object.entries(q.panes).map(([fe,{datasource:ae,queries:ce,range:ie,panelsState:ve}])=>A(ae,ce,se).then(le=>Promise.resolve(le?ce.length?(0,B.v)(ce).filter(z(le)).map(V(le)?D.identity:Ee=>({...Ee,datasource:le.getRef()})):(0,K.tR)().get(V(le)?void 0:le.getRef()).then(Ee=>[N(Ee)]):[]).then(async Ee=>{let Re=await w(Ee);return!Re.length&&le&&(Re=[N(V(le)?await(0,K.tR)().get():le)]),{exploreId:fe,range:ie,panelsState:ve,queries:Re,datasource:le}})))).then(async fe=>{const ae=await Promise.all(fe.map(({exploreId:Ee,range:Re,panelsState:Oe,queries:Se,datasource:Te})=>oe((0,M.Gd)({exploreId:Ee,datasource:Te,queries:Se,range:(0,W.Z9)(Re),panelsState:Oe,eventBridge:new C.o})).unwrap()));if(ae.length>1){const Ee=ae.some(({state:Re},Oe,[{state:Se}])=>!(0,D.isEqual)(Re.range.raw,Se.range.raw));oe((0,O.qz)({syncedTimes:!Ee}))}const ce=ae.reduce((Ee,{exploreId:Re,state:Oe})=>({...Ee,[Re]:I(Oe)}),{}),ie=de.getSearchObject();let ve={};for(const[Ee,Re]of Object.entries(ie).filter(([Oe])=>!["schemaVersion","panes","orgId","left","right"].includes(Oe)))ve[Ee]=Re;const le=new URLSearchParams({schemaVersion:`${q.schemaVersion}`,panes:JSON.stringify(ce),orgId:`${se}`,...ve});de.replace({pathname:de.getLocation().pathname,search:le.toString()}),ne.current="done"})}function Z(q,ne){return q.current=P.wh.pending.type===ne.type,[O.J8.type,O.ve.fulfilled.type,j.Od.pending.type,U.eM.type,M.fx.type,P.wh.fulfilled.type].includes(ne.type)&&!q.current}function Y(q,ne,se,oe){const de=Object.entries(q.panes).reduce((fe,[ae,ce])=>ce?{...fe,[ae]:I(ce)}:fe,{});if(!(0,D.isEqual)(ne.current.panes,JSON.stringify(de))){const fe=!!ne.current.panes&&Object.values(ne.current.panes).filter(Boolean).length===0||se.current==="pending";ne.current={panes:JSON.stringify(de)},oe.partial({panes:ne.current.panes},fe)}}var X=e(83175);function I(q){return{datasource:q.datasourceInstance?.uid||"",queries:q.queries.map(c.w4),range:(0,X.sQ)(q.range.raw),panelsState:J(q.panelsState)}}function J(q){let ne=(0,D.mapValues)(q,se=>(0,D.isObject)(se)?J(se):se);if(ne=(0,D.omitBy)(ne,D.isEmpty),!(0,D.isEmpty)(ne))return ne}function ee(q){const{location:ne}=(0,a.Il)(),se=(0,i.wA)(),oe=(0,i.d4)(r.Qb),de=(0,n.useRef)(oe),fe=(0,i.d4)(le=>le.user.orgId),ae=(0,n.useRef)(q),ce=(0,n.useRef)("notstarted"),ie=(0,n.useRef)(!1),{warning:ve}=(0,s._2)();(0,n.useEffect)(()=>{q.panes||(ce.current="notstarted",ae.current=q)},[q]),(0,n.useEffect)(()=>{const le=se((0,i.ch)({predicate:Ee=>Z(ie,Ee),effect:async(Ee,{cancelActiveListeners:Re,delay:Oe,getState:Se})=>{Re(),await Oe(200),Y(Se().explore,ae,ce,ne)}}));return()=>le()},[se,ne]),(0,n.useEffect)(()=>{de.current=oe},[oe]),(0,n.useEffect)(()=>{const le=ae.current?.panes!==q.panes,[Ee,Re]=h(q);Re&&ve("Could not parse Explore URL","The requested URL contains invalid parameters, a default Explore state has been loaded."),!le&&ce.current==="notstarted"&&(ce.current="pending",Q(Ee,ce,fe,se,ne)),ae.current=q,le&&ce.current==="done"&&H(Ee,de.current,se)},[se,fe,ne,q,ve])}},8692:(te,R,e)=>{"use strict";e.d(R,{C:()=>a,s:()=>n});const n=s=>s.status==="fulfilled";function a(s,i){return s in i}},2513:(te,R,e)=>{"use strict";e.d(R,{k:()=>a});var n=e(43173);const a={from:`now-${n.$.exploreDefaultTimeOffset}`,to:"now"}},80763:(te,R,e)=>{"use strict";e.d(R,{M:()=>p,v:()=>x});var n=e(88483),a=e(78282),s=e(27489),i=e(6890),r=e(64762),u=e(6219),o=e(8535),l=e(51845),g=e(35231),f=e(19050);const p=v=>new n.c(m=>{const y=o.M_.getState().explore.panes[v]?.correlations;if(y)m.next(y),m.complete();else{const h=o.M_.subscribe(()=>{const d=o.M_.getState().explore.panes[v]?.correlations;d&&(h(),m.next(d),m.complete())})}});function c(v){return async(m,y)=>{const h=y().explore.panes[v];if(h.datasourceInstance?.uid!==void 0){let d=h.datasourceInstance.meta.mixed?h.queries.map(b=>b.datasource?.uid).filter(b=>b!==null):[h.datasourceInstance.uid];const E=await(0,u.J6)(d);m((0,l.Fb)({exploreId:v,correlations:E.correlations||[]}))}}}function x(v,m,y){return async(h,d)=>{const E=Object.keys(d().explore?.panes),b=d().explore?.panes[E[0]],D=d().explore?.panes[E[1]];if(!b||!D)return;const C=b.datasourceInstance?.meta.mixed?b.queries[0].datasource:b.datasourceInstance?.getRef(),P=D.datasourceInstance?.meta.mixed?D.queries[0].datasource:D.datasourceInstance?.getRef(),[M,O]=await Promise.all([(0,a.l)().get(C),(0,a.l)().get(P)]);if(M?.uid&&O?.uid&&D.correlationEditorHelperData?.resultField){const j={sourceUID:M.uid,targetUID:O.uid,label:v||await(0,u.tZ)(b,D),description:m,type:"query",config:{field:D.correlationEditorHelperData.resultField,target:D.queries[0],transformations:y}};await(0,u.$q)(M.uid,j).then(async()=>{h((0,g.J8)(E[1])),await h(c(E[0])),await h((0,f.Od)({exploreId:E[0]})),(0,s.rR)("grafana_explore_correlation_editor_saved",{sourceDatasourceType:M.type,targetDataSourceType:O.type})}).catch(U=>{h((0,i.dx)((0,r.gi)("Error creating correlation",U))),console.error(U)})}}}},707:(te,R,e)=>{"use strict";e.d(R,{YR:()=>v,wh:()=>x});var n=e(65307),a=e(27489),s=e(90811),i=e(62635),r=e(6219),u=e(52763),o=e(10951),l=e(51845),g=e(19050),f=e(94543),p=e(83953);const c=(0,n.VP)("explore/updateDatasourceInstance"),x=(0,u.zD)("explore/changeDatasource",async({datasource:m,exploreId:y,options:h},{getState:d,dispatch:E})=>{const b=d().user.orgId,{history:D,instance:C}=await(0,p.BE)(b,m),P=d().explore.panes[y].datasourceInstance;(0,a.rR)("explore_change_ds",{from:(P?.meta?.mixed?"mixed":P?.type)||"unknown",to:C.meta.mixed?"mixed":C.type,exploreId:y}),E(c({exploreId:y,datasourceInstance:C,history:D}));const M=d().explore.panes[y].queries,O=(0,p.dq)(C.uid,M),j=await(0,r.J6)(O);E((0,l.Fb)({exploreId:y,correlations:j.correlations||[]})),h?.importQueries&&await E((0,g.y2)(y,M,P,C)),d().explore.panes[y].isLive&&E((0,f.hO)({exploreId:y,refreshInterval:s.cC.offOption.value})),h?.importQueries&&E((0,g.Od)({exploreId:y}))}),v=(m,y)=>{if(c.match(y)){const{datasourceInstance:h,history:d}=y.payload;return(0,i._u)(m.querySubscription),{...m,datasourceInstance:h,graphResult:null,tableResult:null,logsResult:null,supplementaryQueries:(0,o.Ez)(),queryResponse:(0,p.RA)(),queryKeys:[],history:d}}return m}},51845:(te,R,e)=>{"use strict";e.d(R,{EA:()=>c,Fb:()=>y,Gd:()=>d,LJ:()=>E,QZ:()=>h,fx:()=>p,nE:()=>x});var n=e(65307),a=e(62635),s=e(6219),i=e(34984),r=e(52763),u=e(707),o=e(19050),l=e(94543),g=e(83953);const f=(0,n.VP)("explore/changeSize"),p=(0,n.VP)("explore/changePanels");function c(b,D,C){return async(P,M)=>{const O=M().explore.panes[b];if(O===void 0)return;const{panelsState:j}=O;P(p({exploreId:b,panelsState:{...j,[D]:C}}))}}const x=(0,n.VP)("explore/changeCorrelationHelperData"),v=(0,n.VP)("explore/initializeExploreAction"),m=(0,n.VP)("explore/setUrlReplaced"),y=(0,n.VP)("explore/saveCorrelationsAction");function h(b,{width:D}){return f({exploreId:b,width:D})}const d=(0,r.zD)("explore/initializeExplore",async({exploreId:b,datasource:D,queries:C,range:P,panelsState:M,correlationHelperData:O,eventBridge:j},{dispatch:U,getState:W,fulfillWithValue:B})=>{let S,_=[];if(D){const K=W().user.orgId,T=await(0,g.BE)(K,D);S=T.instance,_=T.history}if(U(v({exploreId:b,queries:C,range:(0,g.eO)(P,(0,i.O)(W().user)),datasourceInstance:S,history:_,eventBridge:j})),M!==void 0&&U(p({exploreId:b,panelsState:M})),U((0,l.JA)({exploreId:b})),S){const K=(0,g.dq)(S.uid,C),T=await(0,s.J6)(K);U(y({exploreId:b,correlations:T.correlations||[]})),U((0,o.Od)({exploreId:b}))}return O!==void 0&&W().explore.correlationEditorDetails?.editorMode&&U(x({exploreId:b,correlationEditorHelperData:O})),B({exploreId:b,state:W().explore.panes[b]})}),E=(b=(0,g.HZ)(),D)=>{if(b=(0,o.JQ)(b,D),b=(0,u.YR)(b,D),b=(0,l.QP)(b,D),f.match(D)){const C=D.payload.width;return{...b,containerWidth:C}}if(p.match(D)){const{panelsState:C}=D.payload;return{...b,panelsState:C}}if(x.match(D)){const{correlationEditorHelperData:C}=D.payload;return{...b,correlationEditorHelperData:C}}if(y.match(D))return{...b,correlations:D.payload.correlations};if(v.match(D)){const{queries:C,range:P,datasourceInstance:M,history:O,eventBridge:j}=D.payload;return{...b,range:P,queries:C,initialized:!0,eventBridge:j,queryKeys:(0,a.dY)(C),datasourceInstance:M,history:O,queryResponse:(0,g.RA)(),cache:[],correlations:[]}}return b}},11280:(te,R,e)=>{"use strict";e.d(R,{Bj:()=>h,H9:()=>g,PA:()=>m,Uu:()=>x,VM:()=>f,fP:()=>y,jX:()=>c,ri:()=>o,s1:()=>p,sh:()=>l,wk:()=>v});var n=e(65307),a=e(81970),s=e(53222),i=e(35231);const r=(0,n.VP)("explore/historyUpdated"),u=({updatedQuery:d,deletedId:E})=>async(b,D)=>{const C=D().explore.richHistory,P=C.map(O=>O.id===d?.id?d:O).filter(O=>O.id!==E),M=C.length-P.length;b((0,i.U2)({richHistoryResults:{richHistory:P,total:D().explore.richHistoryTotal-M}}))},o=(d,E,b,D,C)=>async(P,M)=>{const O=C?{quotaExceededError:!1,limitExceededWarning:!1,otherErrors:!1}:{quotaExceededError:!M().explore.richHistoryStorageFull,limitExceededWarning:!M().explore.richHistoryLimitExceededWarningShown},{richHistoryStorageFull:j,limitExceeded:U}=await(0,a.l0)({localOverride:d,datasource:{uid:E,name:b},queries:D,starred:!1,showNotif:O});C||(j&&P((0,i.fj)()),U&&P((0,i.D)()))},l=(d,E)=>async(b,D)=>{const C=await(0,a.oU)(d,E);b(u({updatedQuery:C}))},g=(d,E)=>async b=>{const D=await(0,a.cX)(d,E);b(u({updatedQuery:D}))},f=d=>async E=>{const b=await(0,a.NC)(d);E(u({deletedId:b}))},p=()=>async d=>{await(0,a.X1)(),d((0,i.U2)({richHistoryResults:{richHistory:[],total:0}})),d((0,i.U2)({richHistoryResults:{richHistory:[],total:0}}))},c=()=>async(d,E)=>{const b=E().explore.richHistorySearchFilters;if(b){const D=await(0,a.DI)(b);d((0,i.U2)({richHistoryResults:D}))}},x=()=>async(d,E)=>{const b=E().explore.richHistorySearchFilters,D=E().explore.richHistory;if(b&&D){const C={...b,page:(b?.page||1)+1},P=await(0,a.DI)(C),M=[...D,...P.richHistory];d((0,i.Ju)({filters:C})),d((0,i.U2)({richHistoryResults:{richHistory:M,total:P.total}}))}},v=()=>async d=>{d((0,i.Ju)({filters:void 0})),d((0,i.U2)({richHistoryResults:{richHistory:[],total:0}}))},m=()=>async(d,E)=>{let b=E().explore.richHistorySettings;b||(b=await(0,a.Gx)(),d((0,i.bZ)(b)))},y=d=>async E=>{E((0,i.bZ)(d)),await(0,a.rs)(d)},h=d=>async(E,b)=>{await E((0,i.Ju)({filters:{...d}}));const D=b().explore.richHistorySettings;(0,s.gQ)().lastUsedDataSourcesAvailable&&await E(y({...D,lastUsedDatasourceFilters:d.datasourceFilters}))}},35231:(te,R,e)=>{"use strict";e.d(R,{Ay:()=>T,D:()=>h,J8:()=>P,JA:()=>C,Ju:()=>E,U2:()=>m,Ve:()=>O,am:()=>W,bZ:()=>d,fj:()=>y,nD:()=>b,ow:()=>B,qz:()=>v,tP:()=>D,ve:()=>j});var n=e(65307),a=e(2543),s=e.n(a),i=e(19379),r=e(92138),u=e(36490),o=e(62635),l=e(59373),g=e(52763),f=e(80144),p=e(2513),c=e(51845),x=e(83953);const v=(0,n.VP)("explore/syncTimes"),m=(0,n.VP)("explore/richHistoryUpdated"),y=(0,n.VP)("explore/richHistoryStorageFullAction"),h=(0,n.VP)("explore/richHistoryLimitExceededAction"),d=(0,n.VP)("explore/richHistorySettingsUpdated"),E=(0,n.VP)("explore/richHistorySearchFiltersUpdatedAction"),b=(0,n.VP)("explore/splitSizeUpdateAction"),D=(0,n.VP)("explore/maximizePaneAction"),C=(0,n.VP)("explore/evenPaneResizeAction"),P=(0,n.VP)("explore/splitClose"),M=(0,n.VP)("explore/setPaneState"),O=(0,n.VP)("explore/clearPanes"),j=(0,g.zD)("explore/splitOpen",async(L,{getState:A,dispatch:N})=>{const V=Object.values(A().explore.panes)[0],z=L?.queries??V?.queries??[];Object.keys(A().explore.panes).forEach((Q,Z)=>{Z>=1&&N(P(Q))});const w=L?.range||V?.range.raw||p.k;let H=(0,o.o$)();for(;A().explore.panes[H];)H=(0,o.o$)();await N(U({exploreId:H,datasource:L?.datasourceUid||V?.datasourceInstance?.getRef(),queries:(0,f.v)(z),range:w,panelsState:L?.panelsState||V?.panelsState,correlationHelperData:L?.correlationHelperData,eventBridge:new i.o})),V?.range&&await N(v({syncedTimes:(0,a.isEqual)(V.range.raw,w)}))}),U=(0,g.zD)("explore/createNewSplitOpen",async(L,{dispatch:A})=>{await A((0,c.Gd)(L))}),W=(0,n.VP)("explore/changeCorrelationEditorDetails"),B=(L,A)=>async N=>{const{timeRange:V,getExploreUrl:z,openInNewWindow:w}=A,H=await z({queries:L.targets,dsRef:L.datasource,scopedVars:L.scopedVars,timeRange:V,adhocFilters:(0,l.w)().getAdhocFilters(L.datasource?.uid??"",!0)});if(w&&H){w(H);return}u.Ny.push(r.I.stripBaseFromUrl(H))},S=()=>(0,x.HZ)(),_={syncedTimes:!1,panes:{},correlationEditorDetails:{editorMode:!1,correlationDirty:!1,queryEditorDirty:!1,isExiting:!1},richHistoryStorageFull:!1,richHistoryLimitExceededWarningShown:!1,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0,richHistory:[]},T={explore:(L=_,A)=>{if(P.match(A)){const{[A.payload]:V,...z}={...L.panes};return{...L,panes:z,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0,syncedTimes:!1}}if(b.match(A)){const{largerExploreId:V}=A.payload;return{...L,largerExploreId:V,maxedExploreId:void 0,evenSplitPanes:V===void 0}}if(D.match(A)){const{exploreId:V}=A.payload;return{...L,largerExploreId:V,maxedExploreId:V,evenSplitPanes:!1}}if(C.match(A))return{...L,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0};if(v.match(A))return{...L,syncedTimes:A.payload.syncedTimes};if(y.match(A))return{...L,richHistoryStorageFull:!0};if(h.match(A))return{...L,richHistoryLimitExceededWarningShown:!0};if(d.match(A)){const V=A.payload;return{...L,richHistorySettings:V}}if(m.match(A)){const{richHistory:V,total:z}=A.payload.richHistoryResults;return{...L,richHistory:V,richHistoryTotal:z}}if(E.match(A)){const V=A.payload.filters;return{...L,richHistorySearchFilters:V}}if(U.pending.match(A))return{...L,panes:{...L.panes,[A.meta.arg.exploreId]:S()}};if(c.Gd?.pending.match(A)){const V=Object.entries(L.panes),z=V.slice(0,A.meta.arg.position),w=V.slice(z.length),H=[...z,[A.meta.arg.exploreId,S()],...w].reduce((Q,[Z,Y])=>({...Q,[Z]:Y}),{});return{...L,panes:H}}if(O.match(A))return{...L,panes:{}};if(W.match(A)){const{editorMode:V,label:z,description:w,canSave:H,correlationDirty:Q,queryEditorDirty:Z,isExiting:Y,postConfirmAction:X,transformations:I}=A.payload;return{...L,correlationEditorDetails:{editorMode:!!(V??L.correlationEditorDetails?.editorMode),canSave:!!(H??L.correlationEditorDetails?.canSave),label:z??L.correlationEditorDetails?.label,description:w??L.correlationEditorDetails?.description,transformations:I??L.correlationEditorDetails?.transformations,correlationDirty:!!(Q??L.correlationEditorDetails?.correlationDirty),queryEditorDirty:!!(Z??L.correlationEditorDetails?.queryEditorDirty),isExiting:!!(Y??L.correlationEditorDetails?.isExiting),postConfirmAction:X}}}const N=A.payload?.exploreId;return typeof N=="string"?{...L,panes:Object.entries(L.panes).reduce((V,[z,w])=>({...V,[z]:z===N?(0,c.LJ)(w,A):w}),{})}:L}}},19050:(te,R,e)=>{"use strict";e.d(R,{_0:()=>Ze,He:()=>ln,hS:()=>Me,bO:()=>ct,IL:()=>cn,rR:()=>ye,y2:()=>ft,Az:()=>Pn,PD:()=>Et,JQ:()=>jn,S6:()=>Ye,Od:()=>Dt,GI:()=>En,q9:()=>Le,h1:()=>_e,qk:()=>me,Rk:()=>Xt,h9:()=>he,TO:()=>wn});var n=e(65307),a=e(32017),s=e.n(a),i=e(2543),r=e(49510),u=e(62467),o=e(58307),l=e(69862),g=e(99165),f=e(28105),p=e(46933),c=e(25229),x=e(67770),v=e(94644),m=e(76732),y=e(39443),h=e(95004);function d(gt,Lt){const Rt=E({data:gt.series},{data:Lt.series}).data;return{...gt,series:Rt}}function E(gt,Lt){if(!gt)return M(Lt);Lt.data.forEach(Ft=>{const _t=gt.data.find(tn=>j(tn,Ft));if(!_t){gt.data.push(O(Ft));return}b(_t,Ft)});const Rt=[...gt.errors??[],...Lt.errors??[]];Rt.length>0&&(gt.errors=Rt);const Ut=gt.error??Lt.error;Ut!=null&&(gt.error=Ut);const Gt=[...gt.traceIds??[],...Lt.traceIds??[]];return Gt.length>0&&(gt.traceIds=Gt),gt}function b(gt,Lt){const Rt=Math.max(gt.fields.length,Lt.fields.length);for(let Ut=0;Ut<Rt;Ut++){if(!gt.fields[Ut])continue;const Gt=D(gt.fields[Ut],Lt.fields,Ut);if(Gt&&(gt.fields[Ut].values=[].concat.apply(Gt.values,gt.fields[Ut].values),Gt.nanos)){const Ft=gt.fields[Ut].nanos?.slice()||[];gt.fields[Ut].nanos=Lt.fields[Ut].nanos?.concat(Ft)}}gt.length+=Lt.length,gt.meta={...gt.meta,stats:P(gt.meta?.stats??[],Lt.meta?.stats??[])}}function D(gt,Lt,Rt){const Ut=Lt.filter(Gt=>Gt.name===gt.name);return Ut.length===1?Ut[0]:gt.labels?Ut.find(Gt=>(0,m.ab)(gt.labels??{},Gt.labels??{})):Lt[Rt]}const C="Summary: total bytes processed";function P(gt,Lt){const Rt=gt.find(Ft=>Ft.displayName===C),Ut=Lt.find(Ft=>Ft.displayName===C);if(Ut!=null&&Rt!=null)return[{value:Ut.value+Rt.value,displayName:C,unit:Rt.unit}];const Gt=Ut??Rt;return Gt!=null?[Gt]:[]}function M(gt){return{...gt,data:gt.data.map(O)}}function O(gt){return{...gt,fields:gt.fields.map(Lt=>({...Lt,values:Lt.values}))}}function j(gt,Lt){if(gt.refId!==Lt.refId||gt.name!==Lt.name)return!1;const Rt=gt.meta?.type,Ut=Lt.meta?.type;if(Rt!==Ut)return!1;if(Rt===y.m.TimeSeriesMulti){const _t=gt.fields.find(xn=>xn.type===h.PU.number),tn=Lt.fields.find(xn=>xn.type===h.PU.number);return _t===void 0||tn===void 0?!1:(0,m.ab)(_t.labels??{},tn.labels??{})}const Gt=gt.meta?.custom?.frameType,Ft=Lt.meta?.custom?.frameType;return Gt==="LabeledTimeValues"&&Ft==="LabeledTimeValues"?!0:Gt===Ft}var U=e(78282),W=e(43173),B=e(62635),S=e(23237),_=e(6219),K=e(28998),T=e(34984),L=e(12282),A=e(18615),N=e(52763),V=e(6890),z=e(64762),w=e(71393),H=e(81160),Q=e(11576),Z=e(79609),Y=e(96702),X=e(41119),I=e(37234),J=e(74746),ee=e(92391);const q=gt=>{const Lt=[],Rt=[],Ut=[],Gt=[],Ft=[],_t=[],tn=[],xn=[];for(const mn of gt.series){if(ie(mn)){xn.push(mn);continue}switch(mn.meta?.preferredVisualisationType){case"logs":Gt.push(mn);break;case"graph":Lt.push(mn);break;case"trace":Ft.push(mn);break;case"table":Rt.push(mn);break;case"rawPrometheus":Ut.push(mn);break;case"nodeGraph":_t.push(mn);break;case"flamegraph":tn.push(mn);break;default:ce(mn)&&Lt.push(mn),Rt.push(mn)}}return{...gt,graphFrames:Lt,tableFrames:Rt,logsFrames:Gt,traceFrames:Ft,nodeGraphFrames:_t,customFrames:xn,flameGraphFrames:tn,rawPrometheusFrames:Ut,graphResult:null,tableResult:null,logsResult:null,rawPrometheusResult:null}},ne=({showCorrelationEditorLinks:gt,queries:Lt,correlations:Rt,defaultTargetDatasource:Ut})=>Gt=>{if(gt&&Ut)for(const Ft of Gt.series)for(const _t of Ft.fields){_t.config.links=[],_t.display=_t.display||(0,Q.H)();const tn={};Ft.fields.map(xn=>{tn[`${xn.name}`]=`\${__data.fields.['${xn.name}']}`}),_t.config.links.push({url:"",origin:Z.x0.ExploreCorrelationsEditor,title:`Correlate with ${_t.name}`,internal:{datasourceUid:Ut.uid,datasourceName:Ut.name,query:{datasource:{uid:Ut.uid}}},meta:{correlationData:{resultField:_t.name,vars:tn,origVars:tn}}})}else if(Lt?.length&&Rt?.length){const Ft=(0,i.mapValues)((0,i.groupBy)(Lt,"refId"),"0.datasource.uid");(0,_.cA)(Gt.series,Rt,Ft)}return Gt},se=gt=>gt.graphFrames.length?{...gt,graphResult:gt.graphFrames}:{...gt,graphResult:null},oe=gt=>{if(gt.tableFrames.length===0)return(0,u.of)({...gt,tableResult:null});gt.tableFrames.sort((Gt,Ft)=>{const _t=Gt.refId,tn=Ft.refId;return _t>tn?1:_t<tn?-1:0});const Lt=gt.tableFrames.every(Gt=>ce(Gt)),Rt={interpolate:Gt=>Gt};return(Lt?(0,u.of)(gt.tableFrames).pipe(Y.c.joinByFieldTransformer.operator({},Rt)):(0,u.of)(gt.tableFrames).pipe(Y.c.mergeTransformer.operator({},Rt))).pipe((0,H.T)(Gt=>{for(const Ft of Gt)for(const _t of Ft.fields)_t.display=_t.display??(0,Q.J)({field:_t,theme:W.$.theme2,timeZone:gt.request?.timezone??"browser"});return{...gt,tableResult:Gt}}))},de=gt=>{const Lt=gt.rawPrometheusFrames;if(!Lt||Lt.length===0)return(0,u.of)({...gt,tableResult:null});Lt.sort((Ft,_t)=>{const tn=Ft.refId,xn=_t.refId;return tn>xn?1:tn<xn?-1:0});const Rt=Lt.every(Ft=>ce(Ft)),Ut={interpolate:Ft=>Ft};return(Rt?(0,u.of)(Lt).pipe(Y.c.joinByFieldTransformer.operator({},Ut)):(0,u.of)(Lt).pipe(Y.c.mergeTransformer.operator({},Ut))).pipe((0,H.T)(Ft=>{const _t=Ft[0];for(const tn of _t.fields)tn.display=tn.display??(0,Q.J)({field:tn,theme:W.$.theme2,timeZone:gt.request?.timezone??"browser"});return{...gt,rawPrometheusResult:_t}}))},fe=(gt={})=>Lt=>{if(Lt.logsFrames.length===0)return{...Lt,logsResult:null};const Rt=Lt.request?.intervalMs,Ut=(0,I.HT)(Lt.logsFrames,Rt,gt.absoluteRange,gt.queries,gt.deduplicate),Gt=(0,B.uE)(gt.refreshInterval),Ft=(0,J.zy)(Ut,Gt),_t=Ft.rows,tn=Ft.series,xn={...Ft,rows:_t,series:tn};return{...Lt,logsResult:xn}};function ae(gt,Lt,Rt,Ut,Gt,Ft,_t){return(0,u.of)(gt).pipe((0,H.T)(tn=>(0,X.N$)(tn,Lt)),(0,H.T)(ne({defaultTargetDatasource:_t,showCorrelationEditorLinks:Ft,queries:Ut,correlations:Gt})),(0,H.T)(q),(0,H.T)(se),(0,H.T)(Rt),(0,l.Z)(de),(0,l.Z)(oe))}function ce(gt){const Lt=(0,i.groupBy)(gt.fields,Rt=>Rt.type);return!!(Object.keys(Lt).length===2&&Lt[h.PU.time]?.length===1&&Lt[h.PU.number])}function ie(gt){return gt.meta?.preferredVisualisationPluginId?(0,ee.oZ)(gt.meta?.preferredVisualisationPluginId):!1}var ve=e(10951),le=e(80763),Ee=e(51845),Re=e(11280),Oe=e(35231),Se=e(94543),Te=e(83953);const _e=gt=>Lt=>{const Rt=Lt.explore.panes[gt];return Rt&&Rt.queryResponse?Rt.queryResponse.state===f.Gu.Loading||Rt.queryResponse.state===f.Gu.Streaming:!1},He=(0,n.VP)("explore/addQueryRow"),tt=(0,n.VP)("explore/changeQueries"),Je=(0,n.VP)("explore/cancelQueries"),Ge=(0,n.VP)("explore/queriesImported"),je=(0,n.VP)("explore/queryStoreSubscription"),Fe=(0,n.VP)("explore/setSupplementaryQueryEnabledAction"),Be=(0,n.VP)("explore/storeSupplementaryQueryDataProviderAction"),Ke=(0,n.VP)("explore/cleanSupplementaryQueryDataProviderAction"),Ue=(0,n.VP)("explore/cleanSupplementaryQueryAction"),we=(0,n.VP)("explore/storeSupplementaryQueryDataSubscriptionAction"),Xe=(0,n.VP)("explore/updateSupplementaryQueryDataAction"),nt=(0,n.VP)("explore/queryStreamUpdated"),he=(0,n.VP)("explore/setQueries"),xe=(0,n.VP)("changeLoadingState"),me=(0,n.VP)("explore/setPausedState"),ye=(0,n.VP)("explore/clearLogs"),De=(0,n.VP)("explore/scanStart"),Le=(0,n.VP)("explore/scanStop"),Ve=(0,n.VP)("explore/addResultsToCache"),ze=(0,n.VP)("explore/clearCache");function Ze(gt,Lt){return async(Rt,Ut)=>{const Gt=Ut().explore.panes[gt];let Ft;Gt.datasourceInstance?.meta.mixed?Ft=(0,i.findLast)(Gt.queries,tn=>!!tn.datasource)?.datasource||void 0:Ft=Gt.datasourceInstance?.getRef();const _t=await(0,B.Ll)(Gt.queries,Lt,Ft);Rt(He({exploreId:gt,index:Lt,query:_t}))}}function Me(gt){return(Lt,Rt)=>{Lt(Le({exploreId:gt})),Lt(Je({exploreId:gt}));const Ut=Rt().explore.panes[gt].supplementaryQueries;for(const Gt of ve.VW)Lt(Ke({exploreId:gt,type:Gt})),Ut[Gt]?.data?.state!==f.Gu.Done&&Lt(Ue({exploreId:gt,type:Gt}))}}const $e=(gt,Lt)=>{const Rt=gt.getRef();return Lt.map(Ut=>({...Ut,datasource:Rt}))},at=async(gt,Lt,Rt)=>{let Ut=[];if(Lt.meta?.id===gt.meta?.id)Ut=Rt;else if((0,p.Ee)(Lt)&&(0,p.FL)(gt)){const Gt=await Lt.exportToAbstractQueries(Rt);Ut=await gt.importFromAbstractQueries(Gt)}else gt.importQueries&&(Ut=await gt.importQueries(Rt,Lt));return $e(gt,Ut)},ct=(0,N.zD)("explore/changeQueries",async({queries:gt,exploreId:Lt},{getState:Rt,dispatch:Ut})=>{let Gt=!1;const Ft=Rt().explore.panes[Lt].queries,_t=Rt().explore.panes[Lt].datasourceInstance?.uid,tn=Rt().explore.correlationEditorDetails,xn=tn?.editorMode||!1;!(Object.keys(Rt().explore.panes)[0]===Lt)&&xn&&!tn?.queryEditorDirty&&Ut((0,Oe.am)({queryEditorDirty:!0}));for(const An of gt)for(const ia of Ft){if(An.refId===ia.refId&&An.datasource?.type!==ia.datasource?.type){const ca=await(0,U.l)().get(ia.datasource),ea=await(0,U.l)().get({uid:An.datasource?.uid});await Ut(ft(Lt,Ft,ca,ea,An.refId)),Gt=!0}if(_t===A.uv&&An.refId===ia.refId&&An.datasource?.uid!==ia.datasource?.uid){const ca=(0,Te.dq)(A.uv,gt),ea=await(0,_.J6)(ca);Ut((0,Ee.Fb)({exploreId:Lt,correlations:ea.correlations||[]}))}}Gt||Ut(tt({queries:gt,exploreId:Lt})),gt.length<Ft.length&&Ut(Dt({exploreId:Lt}))}),ft=(gt,Lt,Rt,Ut,Gt)=>async Ft=>{if(!Rt){Ft(Ge({exploreId:gt,queries:Lt}));return}let _t=Lt;if(Ut.uid===A.uv)_t=Lt.map(xn=>({...xn,datasource:Rt.getRef()}));else if(Rt.uid===A.uv){const xn=(0,i.groupBy)(Lt,An=>An.datasource?.uid),mn=await Promise.all(Object.keys(xn).map(async An=>{const ia=await(0,U.l)().get({uid:An});return await at(Ut,ia,xn[An])}));_t=(0,i.flatten)(mn.filter(An=>An.length>0))}else{let xn=Lt;if(Gt!==void 0){const mn=Lt.find(An=>An.refId===Gt);mn&&(xn=[mn])}_t=await at(Ut,Rt,xn)}let tn=await(0,B.di)(_t,Ut.getRef());if(Gt!==void 0){_t.length===0&&(_t=[await(0,B.Ll)([],void 0,Ut.getRef())]);const xn=Lt.findIndex(An=>An.refId===Gt),mn={...tn[0],refId:Lt[xn].refId};tn=[...Lt],tn[xn]=mn}return Ft(Ge({exploreId:gt,queries:tn})),tn};function Et(gt,Lt,Rt){return async(Ut,Gt)=>{const Ft=Gt().explore.panes[gt],{queries:_t}=Ft,xn=(await Promise.all(_t.map(mn=>Rt({...mn},Lt)))).map((mn,An)=>(0,B.eF)(mn,_t,An));Ut(he({exploreId:gt,queries:xn})),Lt.preventSubmit||Ut(Dt({exploreId:gt}))}}function St(gt,Lt){if(!(gt.filterQuery&&!gt.filterQuery(Lt)))return Lt}async function Pt(gt,Lt,Rt,Ut){const Ft=(await Promise.all(Ut.map(async _t=>{if(_t.datasource?.uid===Rt.uid)return St(Rt,_t);{const tn=await(0,K.tR)().get(_t.datasource);return St(tn,_t)}}))).filter(_t=>!!_t);Ft.length>0&&(gt((0,Re.ri)(!0,Rt.uid,Rt.name,Ft,W.$.queryHistoryEnabled)),W.$.queryHistoryEnabled&&gt((0,Re.ri)(!1,Rt.uid,Rt.name,Ft,!1)),await gt((0,Re.jX)()))}const Dt=(0,N.zD)("explore/runQueries",async({exploreId:gt,preserveCache:Lt},{dispatch:Rt,getState:Ut})=>{Ut().explore?.panes[gt]?.scanning||Rt(Me(gt));const{defaultCorrelationEditorDatasource:Gt,scopedVars:Ft,showCorrelationEditorLinks:_t}=await(0,Te.aj)(Ut(),gt),tn=(0,le.M)(gt);Rt((0,Se.JA)({exploreId:gt})),Lt!==!0&&Rt(cn(gt));const mn=Ut().explore.panes[gt],{datasourceInstance:An,containerWidth:ia,isLive:ca,range:ea,scanning:Ca,queryResponse:oa,querySubscription:Jn,refreshInterval:Da,absoluteRange:Fa,cache:Xn,supplementaryQueries:ps}=mn;let Aa,xt;const dt=mn.queries.map(Mt=>({...Mt,datasource:Mt.datasource||An?.getRef()}));An!=null&&Pt(Rt,Ut().explore,An,dt);const bt=(0,Te.rk)(Xn,Fa);if(bt)Aa=(0,r.z)([(0,u.of)(bt),tn]).pipe((0,l.Z)(([Mt,Bt])=>ae(Mt,oa,fe({absoluteRange:Fa,refreshInterval:Da,queries:dt}),dt,Bt,_t,Gt))),xt=Aa.subscribe(Mt=>{Rt(nt({exploreId:gt,response:Mt}))});else{if(!(0,B.zT)(dt)||!An)return;const Mt=An?.interval;(0,B._u)(Jn);const Bt={minInterval:Mt,maxDataPoints:ia,liveStreaming:ca},Kt=(0,T.O)(Ut().user),Qt=(0,B.bI)(gt,dt,Bt,ea,Ca,Kt,Ft);if(Rt(xe({exploreId:gt,loadingState:f.Gu.Loading})),Aa=(0,r.z)([(0,w.BN)(An,Qt.request).pipe(ca?(0,g.c)(500):o.D),tn]).pipe((0,l.Z)(([Zt,nn])=>ae(Zt,oa,fe({absoluteRange:Fa,refreshInterval:Da,queries:dt}),dt,nn,_t,Gt))),xt=Aa.subscribe({next(Zt){const nn=Ut().explore.panes[gt];if(Rt(nt({exploreId:gt,response:Zt})),nn.scanning)if(console.log(Zt.series),Zt.state===f.Gu.Done&&Zt.series.length===0){const kt=(0,S.Wb)(-1,nn.range);Rt((0,Se.JA)({exploreId:gt,absoluteRange:kt})),Rt(Dt({exploreId:gt}))}else(Zt.series[0]?.length>0||Zt.state===f.Gu.Done)&&Rt(Le({exploreId:gt}))},error(Zt){Rt((0,V.dx)((0,z.gi)("Query processing error",Zt))),Rt(xe({exploreId:gt,loadingState:f.Gu.Error})),console.error(Zt)},complete(){Ut().explore.panes[gt].queryResponse.state===f.Gu.Loading&&Rt(xe({exploreId:gt,loadingState:f.Gu.Done}))}}),ca)for(const Zt of ve.VW)Rt(Ke({exploreId:gt,type:Zt})),Rt(Ue({exploreId:gt,type:Zt}));else Rt(zt({exploreId:gt,datasourceInstance:An,transaction:Qt,newQuerySource:Aa,supplementaryQueries:ps,queries:dt,absoluteRange:Fa}))}Rt(je({exploreId:gt,querySubscription:xt}))}),Ye=(0,N.zD)("explore/runLoadMoreQueries",async({exploreId:gt,absoluteRange:Lt},{dispatch:Rt,getState:Ut})=>{Rt(Me(gt));const{datasourceInstance:Gt,containerWidth:Ft,queryResponse:_t}=Ut().explore.panes[gt],{defaultCorrelationEditorDatasource:tn,scopedVars:xn,showCorrelationEditorLinks:mn}=await(0,Te.aj)(Ut(),gt),An=(0,le.M)(gt);let ia;const ca=_t.logsResult?.queries||[],ea=_t.logsFrames.map(Xn=>Xn.refId),Ca=ca.filter(Xn=>ea.includes(Xn.refId)).map(Xn=>({...Xn,datasource:Xn.datasource||Gt?.getRef(),refId:Xn.refId,supportingQueryType:L.Q$.InfiniteScroll}));if(!(0,B.zT)(Ca)||!Gt)return;const oa={minInterval:Gt?.interval,maxDataPoints:Ft},Jn=(0,T.O)(Ut().user),Da=(0,B.zq)(Jn,{from:(0,c.oZ)(Jn,Lt.from),to:(0,c.oZ)(Jn,Lt.to)},(0,T.q)(Ut().user)),Fa=(0,B.bI)(gt,Ca,oa,Da,!1,Jn,xn);Rt(xe({exploreId:gt,loadingState:f.Gu.Loading})),ia=(0,r.z)([(0,w.BN)(Gt,Fa.request),An]).pipe((0,l.Z)(([Xn,ps])=>Xn.state!==f.Gu.Done?(0,u.of)({..._t,state:f.Gu.Loading}):ae(d(_t,Xn),_t,fe({absoluteRange:Lt,queries:ca,deduplicate:!0}),Ca,ps,mn,tn))),ia.subscribe({next(Xn){Rt(nt({exploreId:gt,response:Xn}))},error(Xn){Rt((0,V.dx)((0,z.gi)("Query processing error",Xn))),Rt(xe({exploreId:gt,loadingState:f.Gu.Error})),console.error(Xn)},complete(){Rt(xe({exploreId:gt,loadingState:f.Gu.Done}))}})}),mt=async(gt,Lt)=>{const Rt=gt.filter(Gt=>Gt.datasource?.uid!==A.uv),Ut=(0,i.groupBy)(Rt,"datasource.uid");return await Promise.all(Object.values(Ut).map(async Gt=>({datasource:await(0,U.l)().get(Gt[0].datasource,Lt),targets:Gt})))},zt=(0,N.zD)("explore/handleSupplementaryQueries",async({datasourceInstance:gt,exploreId:Lt,transaction:Rt,newQuerySource:Ut,supplementaryQueries:Gt,queries:Ft,absoluteRange:_t},{dispatch:tn})=>{let xn;gt.meta.mixed?xn=await mt(Rt.request.targets,Rt.request.scopedVars):xn=[{datasource:gt,targets:Rt.request.targets}];for(const mn of ve.VW){const An=(0,ve.Pm)(xn,mn,{...Rt.request,requestId:`${Rt.request.requestId}_${(0,i.snakeCase)(mn)}`},Ut);An?(tn(Be({exploreId:Lt,type:mn,dataProvider:An})),Jt(Gt[mn].data,Ft,_t)||(tn(Ue({exploreId:Lt,type:mn})),Gt[mn].enabled&&tn(Pn(Lt,mn)))):tn(Ke({exploreId:Lt,type:mn}))}});function Jt(gt,Lt,Rt){if(!gt)return!1;const Ut=(0,i.zipObject)((0,i.map)(Lt,"refId"),Lt),Gt=(0,i.mapValues)((0,i.groupBy)(gt.data.map(xn=>xn.meta?.custom?.sourceQuery),"refId"),i.head),Ft=gt.data.every(xn=>xn.meta?.custom?.logsVolumeType===x.Aj.FullRange),_t=s()(Ut,Gt),tn=gt.data.every(xn=>{const mn=xn.meta?.custom?.absoluteRange;return mn?mn&&mn.from<=Rt.from&&Rt.to<=mn.to:!0});return Ft&&_t&&tn}function Xt(gt,Lt){return(Rt,Ut)=>{const Gt=Ut().explore.panes[gt].queries,Ft=Lt.map((_t,tn)=>(0,B.eF)(_t,Gt,tn));Rt(he({exploreId:gt,queries:Ft})),Rt(Dt({exploreId:gt}))}}function En(gt){return(Lt,Rt)=>{Lt(De({exploreId:gt}));const Ut=(0,S.Wb)(-1,Rt().explore.panes[gt].range);Lt((0,Se.JA)({exploreId:gt,absoluteRange:Ut})),Lt(Dt({exploreId:gt}))}}function ln(gt){return(Lt,Rt)=>{const Ut=Rt().explore.panes[gt].queryResponse,Gt=Rt().explore.panes[gt].absoluteRange,Ft=(0,Te.O2)(Gt);Ut.state===f.Gu.Done&&Lt(Ve({exploreId:gt,cacheKey:Ft,queryResponse:Ut}))}}function cn(gt){return(Lt,Rt)=>{Lt(ze({exploreId:gt}))}}function Pn(gt,Lt){return(Rt,Ut)=>{const{supplementaryQueries:Gt}=Ut().explore.panes[gt],Ft=Gt[Lt].dataProvider;if(Ft){const _t=Ft.subscribe({next:tn=>{Rt(Xe({exploreId:gt,type:Lt,data:tn}))}});Rt(we({exploreId:gt,type:Lt,dataSubscription:_t}))}}}function wn(gt,Lt,Rt){return(Ut,Gt)=>{Ut(Fe({exploreId:gt,enabled:Lt,type:Rt})),(0,ve.Oi)(Lt,Rt),Lt&&Ut(Pn(gt,Rt))}}const jn=(gt,Lt)=>{if(He.match(Lt)){const{queries:Rt}=gt,{index:Ut,query:Gt}=Lt.payload,Ft=[...Rt.slice(0,Ut+1),{...Gt},...Rt.slice(Ut+1)];return{...gt,queries:Ft,queryKeys:(0,B.dY)(Ft)}}if(tt.match(Lt)){const{queries:Rt}=Lt.payload;return{...gt,queries:Rt}}if(Je.match(Lt))return(0,B._u)(gt.querySubscription),{...gt,...gt.queryResponse?{queryResponse:{...gt.queryResponse,state:f.Gu.Done}}:{}};if(he.match(Lt)){const{queries:Rt}=Lt.payload;return{...gt,queries:Rt.slice(),queryKeys:(0,B.dY)(Rt)}}if(je.match(Lt)){const{querySubscription:Rt}=Lt.payload;return{...gt,querySubscription:Rt}}if(Fe.match(Lt)){const{enabled:Rt,type:Ut}=Lt.payload,{supplementaryQueries:Gt}=gt,Ft=Gt[Ut].dataSubscription;!Rt&&Ft&&Ft.unsubscribe();const _t={...Gt,[Ut]:{...Gt[Ut],enabled:Rt,data:void 0}};return{...gt,supplementaryQueries:_t}}if(Be.match(Lt)){const{dataProvider:Rt,type:Ut}=Lt.payload,{supplementaryQueries:Gt}=gt,Ft=Gt[Ut];Ft?.dataSubscription&&Ft.dataSubscription.unsubscribe();const _t={...Gt,[Ut]:{...Ft,dataProvider:Rt,dataSubscription:void 0}};return{...gt,supplementaryQueries:_t}}if(Ke.match(Lt)){const{type:Rt}=Lt.payload,{supplementaryQueries:Ut}=gt,Gt=Ut[Rt];Gt?.dataSubscription&&Gt.dataSubscription.unsubscribe();const Ft={...Ut,[Rt]:{...Gt,dataProvider:void 0,dataSubscription:void 0}};return{...gt,supplementaryQueries:Ft}}if(Ue.match(Lt)){const{type:Rt}=Lt.payload,{supplementaryQueries:Ut}=gt,Gt={...Ut,[Rt]:{...Ut[Rt],data:void 0}};return{...gt,supplementaryQueries:Gt}}if(we.match(Lt)){const{dataSubscription:Rt,type:Ut}=Lt.payload,{supplementaryQueries:Gt}=gt,Ft={...Gt,[Ut]:{...Gt[Ut],dataSubscription:Rt}};return{...gt,supplementaryQueries:Ft}}if(Xe.match(Lt)){let{data:Rt,type:Ut}=Lt.payload;const{supplementaryQueries:Gt}=gt,Ft={...Gt,[Ut]:{...Gt[Ut],data:Rt}};return{...gt,supplementaryQueries:Ft}}if(nt.match(Lt))return kn(gt,Lt);if(Ge.match(Lt)){const{queries:Rt}=Lt.payload;return{...gt,queries:Rt,queryKeys:(0,B.dY)(Rt)}}if(xe.match(Lt)){const{loadingState:Rt}=Lt.payload;return{...gt,queryResponse:{...gt.queryResponse,state:Rt}}}if(me.match(Lt)){const{isPaused:Rt}=Lt.payload;return{...gt,isPaused:Rt}}if(De.match(Lt))return{...gt,scanning:!0};if(Le.match(Lt))return{...gt,scanning:!1,scanRange:void 0};if(Ve.match(Lt)){const{cache:Ut}=gt,{queryResponse:Gt,cacheKey:Ft}=Lt.payload;let _t=[...Ut];return _t.some(xn=>xn.key===Ft)||(_t=[{key:Ft,value:Gt},..._t].slice(0,5)),{...gt,cache:_t}}if(ze.match(Lt))return{...gt,cache:[]};if(ye.match(Lt)){if(!gt.logsResult)return{...gt,clearedAtIndex:null};if(gt.queryResponse.state===f.Gu.Loading)return{...gt,clearedAtIndex:null,logsResult:{...gt.logsResult,rows:[]}};const Rt=gt.clearedAtIndex?gt.clearedAtIndex+gt.logsResult.rows.length:gt.logsResult.rows.length-1;return{...gt,clearedAtIndex:Rt,logsResult:{...gt.logsResult,rows:[]}}}return gt},kn=(gt,Lt)=>{const{response:Rt}=Lt.payload,{request:Ut,error:Gt,graphResult:Ft,logsResult:_t,tableResult:tn,rawPrometheusResult:xn,traceFrames:mn,nodeGraphFrames:An,flameGraphFrames:ia,rawPrometheusFrames:ca,customFrames:ea}=Rt;return Gt&&(Gt.type===v.v2.Timeout||Gt.type===v.v2.Cancelled)?{...gt}:Ut?{...gt,queryResponse:Rt,graphResult:Ft,tableResult:tn,rawPrometheusResult:xn,logsResult:gt.isLive&&_t?{..._t,rows:(0,Te.pg)(gt.clearedAtIndex,_t.rows)}:_t,showLogs:!!_t,showMetrics:!!Ft,showTable:!!tn?.length,showTrace:!!mn.length,showNodeGraph:!!An.length,showRawPrometheus:!!ca.length,showFlameGraph:!!ia.length,showCustom:!!ea?.length,clearedAtIndex:gt.isLive?gt.clearedAtIndex:null}:{...gt}}},20718:(te,R,e)=>{"use strict";e.d(R,{Jr:()=>f,K6:()=>o,Kl:()=>x,Qb:()=>i,i6:()=>u,pF:()=>l,qq:()=>p,st:()=>g,vC:()=>c});var n=e(25508),a=e(2543),s=e.n(a);const i=v=>v.explore.panes,r=v=>v.explore,u=v=>v.explore.richHistorySettings,o=(0,n.Mz)(i,Object.entries),l=(0,n.Mz)(o,v=>v.length>1),g=(0,n.Mz)(o,v=>v.some(m=>m[1].correlationEditorHelperData!==void 0)),f=v=>(0,n.Mz)(i,m=>Object.keys(m)[0]===v),p=v=>(0,n.Mz)(i,m=>m[v]),c=(0,n.Mz)(r,v=>v.correlationEditorDetails),x=(0,n.Mz)(o,v=>{const m=v.map(([d,E])=>{const b=[E?.datasourceInstance?.getRef()],D=E?.queries.map(P=>P.datasource)||[],C=[...b,...D].filter(P=>!!P);if(!(C===void 0||C.length===0))return{exploreId:d,datasources:(0,a.uniqBy)(C,P=>P.uid)}}).filter(d=>!!d),h=(0,a.uniqBy)((0,a.flatten)(m.map(d=>d.datasources)),d=>d.uid).map(d=>{let E=[];return m.forEach(b=>{b.datasources.some(D=>D.uid===d.uid)&&E.push(b.exploreId)}),{datasource:d,exploreIds:E}});return{exploreToDS:m,dsToExplore:h}})},94543:(te,R,e)=>{"use strict";e.d(R,{$_:()=>P,GA:()=>U,GH:()=>d,Iy:()=>M,JA:()=>b,QP:()=>W,Xk:()=>j,eM:()=>y,hO:()=>h,iO:()=>D,ke:()=>O,zY:()=>E});var n=e(65307),a=e(25229),s=e(32899),i=e(28105),r=e(92745),u=e(2863),o=e(90811),l=e(45229),g=e(62635),f=e(23237),p=e(75421),c=e(74746),x=e(34984),v=e(35231),m=e(19050);const y=(0,n.VP)("explore/changeRange"),h=(0,n.VP)("explore/changeRefreshInterval"),d=B=>(S,_)=>{const{syncedTimes:K}=_().explore;K?Object.keys(_().explore.panes).forEach(T=>{S(b({...B,exploreId:T})),S((0,m.Od)({exploreId:T,preserveCache:!0}))}):(S(b({...B})),S((0,m.Od)({exploreId:B.exploreId,preserveCache:!0})))},E=B=>S=>{S((0,m.S6)({...B}))},b=B=>(S,_)=>{const{exploreId:K,absoluteRange:T,rawRange:L}=B,A=_().explore.panes[K],N=(0,x.O)(_().user),V=(0,x.q)(_().user),{range:z}=A;let w=z.raw;T&&(w={from:(0,a.oZ)(N,T.from),to:(0,a.oZ)(N,T.to)}),L&&(w=L);const H=(0,g.zq)(N,w,V),Q={from:H.from.valueOf(),to:H.to.valueOf()};(0,p.jG)().init({timepicker:{},getTimezone:()=>N,timeRangeUpdated(Z){},time:H.raw}),(0,u.w)().updateTimeRange(H),S(y({exploreId:K,range:H,absoluteRange:Q}))};function D(B){return(S,_)=>{const K=_().explore.panes[B].range.raw;Object.keys(_().explore.panes).filter(L=>L!==B).forEach(L=>{S(d({exploreId:L,rawRange:K}))});const T=_().explore.syncedTimes;S((0,v.qz)({syncedTimes:!T}))}}function C(B){return(S,_)=>{const K=(0,x.O)(_().user),T=(0,x.q)(_().user);Object.entries(_().explore.panes).forEach(([L,A])=>{const N=(0,g.zq)(K,A.range.raw,T);B(L,A,N,S)})}}function P(){return C((B,S,_,K)=>{const T={from:_.from.valueOf(),to:_.to.valueOf()};K(d({exploreId:B,absoluteRange:T}))})}function M(B){return C((S,_,K,T)=>{const L=(0,f.Wb)(B,K);T(d({exploreId:S,absoluteRange:L}))})}function O(B){return C((S,_,K,T)=>{const L=(0,f.Zk)(K,B);T(d({exploreId:S,absoluteRange:L}))})}function j(){return(B,S)=>{const _=S().explore.panes[Object.keys(S().explore.panes)[0]].range.raw;navigator.clipboard.writeText(JSON.stringify(_)),l.A.emit(s.r1.alertSuccess,[(0,r.t)("time-picker.copy-paste.copy-success-message","Time range copied to clipboard")])}}function U(){return async(B,S)=>{const{range:_,isError:K}=await(0,f.zG)();if(K===!0){l.A.emit(s.r1.alertError,[(0,r.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,r.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:_})]);return}if(S().explore.syncedTimes){B(d({exploreId:Object.keys(S().explore.panes)[0],rawRange:_})),B(d({exploreId:Object.keys(S().explore.panes)[1],rawRange:_}));return}B(d({exploreId:Object.keys(S().explore.panes)[0],rawRange:_}))}}const W=(B,S)=>{if(h.match(S)){const{refreshInterval:_}=S.payload,K=o.cC.isLive(_),T=(0,g.uE)(_),L=(0,c.zy)(B.logsResult,T);return o.cC.isLive(B.refreshInterval)&&!K&&(0,g._u)(B.querySubscription),{...B,refreshInterval:_,queryResponse:{...B.queryResponse,state:K?i.Gu.Streaming:i.Gu.Done},isLive:K,isPaused:K?!1:B.isPaused,logsResult:L}}if(y.match(S)){const{range:_,absoluteRange:K}=S.payload;return{...B,range:_,absoluteRange:K}}return B}},83953:(te,R,e)=>{"use strict";e.d(R,{BE:()=>D,HZ:()=>E,O2:()=>C,RA:()=>b,Z9:()=>O,aj:()=>B,dq:()=>W,eO:()=>M,ng:()=>d,pg:()=>U,rk:()=>P});var n=e(2543),a=e.n(n),s=e(28105),i=e(22592),r=e(33239),u=e(25229),o=e(78282),l=e(53222),g=e(80977),f=e(18615),p=e(29043),c=e(62635),x=e(28998),v=e(10951),m=e(2513);const y=100,h="grafana.explore.style.graph",d=S=>{p.A.set(h,S)},E=S=>({containerWidth:0,datasourceInstance:null,history:[],queries:[],initialized:!1,range:{from:null,to:null,raw:m.k},absoluteRange:{from:null,to:null},scanning:!1,queryKeys:[],isLive:!1,isPaused:!1,queryResponse:b(),tableResult:null,graphResult:null,logsResult:null,clearedAtIndex:null,rawPrometheusResult:null,eventBridge:null,cache:[],supplementaryQueries:(0,v.Ez)(),panelsState:{},correlations:void 0,...S}),b=()=>({state:s.Gu.NotStarted,series:[],timeRange:(0,i.E2)(),graphFrames:[],logsFrames:[],traceFrames:[],nodeGraphFrames:[],flameGraphFrames:[],customFrames:[],tableFrames:[],rawPrometheusFrames:[],rawPrometheusResult:null,graphResult:null,logsResult:null,tableResult:null});async function D(S,_){let K;try{K=await(0,x.tR)().get(_)}catch{K=await(0,x.tR)().get()}if(K.init)try{K.init()}catch(N){console.error(N)}let T=[];const L=(0,l.tU)(),A=await L.getRichHistory({search:"",sortOrder:g.x.Ascending,datasourceFilters:[K.name],starred:!1});if((A.total||0)>0&&A.richHistory.forEach(N=>{N.queries.forEach(V=>{T.push({ts:parseInt(N.id,10),query:V})})}),T.length<y){const N=await L.getRichHistory({search:"",sortOrder:g.x.Ascending,datasourceFilters:[f.uv],starred:!1});(N.total||0)>0&&N.richHistory.forEach(V=>{V.queries.forEach(z=>{z?.datasource?.uid===K.uid&&T.push({ts:parseInt(V.id,10),query:z})})})}if(T.length<y){const N=`grafana.explore.history.${K.meta?.id}`;T=[...T,...p.A.getObject(N,[])]}return T.length>y&&(T.length=y),(0,c.dr)(S,K.uid),{history:T,instance:K}}function C(S){const _={from:S.from,to:S.to};return Object.entries(_).map(([T,L])=>`${encodeURIComponent(T)}=${encodeURIComponent(L.toString())}`).join("&")}function P(S,_){const K=C(_),T=S.findIndex(A=>A.key===K);return T>=0?S[T].value:void 0}function M(S,_){return{from:r.parse(S.from,!1,_),to:r.parse(S.to,!0,_),raw:S}}function O(S){let _=m.k,K={from:j(S.from),to:j(S.to)};return K.from!==null&&K.to!==null&&(_={from:K.from,to:K.to}),_}function j(S){if(S===null)return null;if((0,u.Ar)(S))return S;if(typeof S!="string")return null;const _=S;if(_.indexOf("now")!==-1)return _;if(_.length===8)return(0,u.yT)(_,"YYYYMMDD");if(_.length===15)return(0,u.yT)(_,"YYYYMMDDTHHmmss");if(_.length===19)return(0,u.yT)(_,"YYYY-MM-DD HH:mm:ss");if(_.match(/^\d+$/)){const T=parseInt(_,10);return(0,u.yT)(T)}const K=(0,u.yT)(_);return K.isValid()?K:null}const U=(S,_)=>_?S?_.slice(S+1):_:[],W=(S,_)=>S===f.uv?(0,n.uniq)(_.map(K=>K.datasource?.uid).filter(K=>!!K)):[S];async function B(S,_){const K=S.explore.panes[_].correlationEditorHelperData,T=S.explore.correlationEditorDetails?.editorMode||!1,L=Object.keys(S.explore.panes)[0]===_,A=T&&L,N=A?await(0,o.l)().get():void 0,V=T&&!L&&K!==void 0;let z={};return V&&K!==void 0&&Object.entries(K?.vars).forEach(w=>{z[w[0]]={value:w[1]}}),{defaultCorrelationEditorDatasource:N,scopedVars:z,showCorrelationEditorLinks:A}}},78529:(te,R,e)=>{"use strict";e.d(R,{JQ:()=>M,O1:()=>j,QL:()=>C,YV:()=>D,_O:()=>B});var n=e(2543),a=e.n(n),s=e(96540),i=e(7102),r=e(39443),u=e(79609),o=e(1906),l=e(38036),g=e(83175),f=e(92745),p=e(2863),c=e(27489),x=e(15130),v=e(70191),m=e(46072),y=e(82345),h=e(55133);const E=[S=>!S.internal||x.TP.hasAccessToExplore()],b="grafana_data_link_clicked",D=(S,_)=>T=>{const{field:L,dataLinkScopedVars:A,frame:N,link:V,linkModel:z}=T,{valueRowIndex:w}=T.config;if(w===void 0)return z;const H=C({field:L,rowIndex:w,splitOpenFn:S,range:_,vars:A,dataFrame:N,linksToProcess:[V]});return H.length?(0,n.first)(H):void 0},C=S=>{const{field:_,vars:K,splitOpenFn:T,range:L,rowIndex:A,dataFrame:N}=S,V={...K||{}};V.__value={value:{raw:_.values[A]},text:(0,f.t)("explore.get-field-links-for-explore.text.raw-value","Raw value")};let z;if(N){if(z=(0,i.F)({frame:N,rowIndex:A}),V.__data={value:{name:N.name,refId:N.refId,fields:z},text:(0,f.t)("explore.get-field-links-for-explore.text.data","Data")},N.meta?.type===r.m.LogLines){const Q=(0,m.ww)(N)?.getLogFrameLabels();Q!=null&&Object.entries(Q[A]).forEach(Z=>{V[Z[0]]={value:Z[1]}})}N.fields.forEach(H=>{z&&z[H.name]&&(V[H.name]={value:z[H.name]})}),V.__targetField={value:z[_.name]}}const w=S.linksToProcess||_.config.links;return w?w.filter(Z=>E.every(Y=>Y(Z,V))).map(Z=>{let Y={};Z.meta?.transformations&&Z.meta?.transformations.forEach(ee=>{let q;ee.field?q=N?.fields.find(se=>se.name===ee.field)?.values[A]:q=_.values[A],Y={...Y,...(0,v.k)(ee,q,_.name)}});const X={...V,...Y},I=j(Z,X);let J=[];if(I.variables.length===0){const ee=_.name.toString();J.push({variableName:ee,value:"",match:""})}else J=I.variables;if(I.allVariablesDefined)if(Z.internal){const ee=ne=>{(0,c.rR)(b,{origin:Z.origin||u.x0.Datasource,app:o.Jk.Explore,internal:!0}),T?.(ne)};return{...(0,l.u)({link:Z,internalLink:Z.internal,scopedVars:X,range:L,field:_,onClickFn:S.splitOpenFn?ne=>ee(ne):void 0,replaceVariables:(0,p.w)().replace.bind((0,p.w)())}),variables:J}}else{const ee=(ne,se)=>(0,p.w)().replace(ne,{...se,...X,...V}),q=(0,y.mQ)().getDataLinkUIModel(Z,ee,_);return q.title||(q.title=P(q.href)),q.target=q.target??"_blank",{...q,variables:J}}else return}).filter(Z=>!!Z):[]};function P(S){S.indexOf("://")<0&&(S=`http://${S}`);let _;try{_=new URL(S).hostname}catch{_=S}return _}function M(S,_){return(0,s.useCallback)((K,T)=>K.fields.flatMap(L=>L.config?.links&&L.config?.links.length?C({field:L,rowIndex:T,range:S,dataFrame:K,splitOpenFn:_}):[]),[S,_])}const O=["__from","__to","__interval","__interval_ms","__org","__user","__range","__rate_interval","__timeFilter","timeFilter"];function j(S,_){let K=[];return(0,p.w)().replace.bind((0,p.w)())(U(S),_,void 0,K),K=(0,n.uniqBy)(K,"variableName"),{variables:K,allVariablesDefined:K.filter(L=>!O.includes(L.variableName)).every(L=>L.found)}}function U(S){let _="",K;for(K in S)typeof S[K]=="string"?_+=" "+S[K]:typeof S[K]=="object"&&(_+=" "+U(S[K]));return _}const W=S=>S[1]!==void 0,B=S=>{const _=Object.entries(S).filter(W).map(([K,T])=>{const L=(0,h.m)(T);return L.range={to:T.range.to.valueOf().toString(),from:T.range.from.valueOf().toString()},[K,L]}).reduce((K,[T,L])=>({...K,[T]:L}),{});return g.kM.renderUrl("/explore",{schemaVersion:1,panes:JSON.stringify(_)})}},80144:(te,R,e)=>{"use strict";e.d(R,{v:()=>a});var n=e(39796);function a(s){const i=new Set(s.map(r=>r.refId).filter(Boolean));return i.size===s.length?s:(i.clear(),s.map(r=>{if(r.refId&&!i.has(r.refId))return i.add(r.refId),r;const u=(0,n.M)(s);return i.add(u),{...r,refId:u}}))}},10951:(te,R,e)=>{"use strict";e.d(R,{Ez:()=>v,Oi:()=>x,Pm:()=>h,VW:()=>p});var n=e(2543),a=e.n(n),s=e(88483),i=e(44240),r=e(6276),u=e(29405),o=e(67770),l=e(28105),g=e(29043),f=e(37234);const p=[o.cF.LogsVolume,o.cF.LogsSample],c=d=>`grafana.explore.logs.enable${d}`,x=(d,E)=>{g.A.set(c(E),d?"true":"false")},v=()=>{let d={[o.cF.LogsVolume]:{enabled:!0},[o.cF.LogsSample]:{enabled:!1}};for(const E of p){if(E===o.cF.LogsSample)continue;g.A.get(c(E))==="false"&&(d[E]={enabled:!1})}return d},m=(d,E,b)=>new s.c(D=>d.subscribe(C=>{if(C.logsResult&&C.logsResult.rows&&C.logsResult.visibleRange&&C.logsResult.bucketSize!==void 0&&C.state===l.Gu.Done){const P=C.logsResult.bucketSize,M=E.map(U=>U.refId),O=(0,n.groupBy)(C.logsResult.rows,"dataFrame.refId");let j=[];M.forEach(U=>{if(O[U]?.length){const W=(0,f.J9)(O[U],P);j=[...j,...W];const B={logsVolumeType:o.Aj.Limited,absoluteRange:C.logsResult?.visibleRange,datasourceName:b,sourceQuery:E.find(S=>S.refId===U)};D.next({data:j.map(S=>{const _=S.meta?.custom||{};return{...S,meta:{custom:{..._,...B}}}}),state:C.state})}}),D.complete()}})),y=(d,E,b,D)=>{if(d===o.cF.LogsVolume)return m(E,b,D)},h=(d,E,b,D)=>{const P=d.map(({datasource:M,targets:O},j)=>{const U=(0,n.cloneDeep)(b);if(U.requestId=`${U.requestId||""}_${j}`,U.targets=O,(0,o.Nc)(M,E)){if(M.getDataProvider)return M.getDataProvider(E,U);if(M.getSupplementaryRequest){const W=M.getSupplementaryRequest(E,U);return W?E===o.cF.LogsVolume?(0,f.sg)(M,W,{targets:U.targets}):(0,f.Wr)(M,W):void 0}else return}else return y(E,D,O,M.name)}).filter(l.zz);if(P.length!==0)return P.length===1?P[0]:(0,i.h)(...P).pipe((0,u.S)((M,O)=>M.errors&&M.errors.length||O.state===l.Gu.NotStarted?M:O.state===l.Gu.Loading&&M.state===l.Gu.NotStarted?{...M,state:l.Gu.Loading}:O.state&&O.state!==l.Gu.Done?M:{...M,data:[...M.data,...O.data],state:l.Gu.Done},{data:[],state:l.Gu.NotStarted}),(0,r.d)())}},29328:(te,R,e)=>{"use strict";e.d(R,{Ex:()=>K,$i:()=>_});var n=e(65474),a=e(69862),s=e(11594),i=e(36580),r=e(2863),u=e(78282),o=e(19729),l=e(74848),g=e(22803),f=e(96540),p=e(92745),c=e(63142),x=e(18027),v=e(45861),m=e(76319),y=e(91073),h=e(52900),d=e(18203),E=e(89931),b=e(4652),D=e(32576),C=e(38610),P=e(4651),M=e(82779);const O=15,j=T=>{const L=P.uQ.find(({value:A})=>A===T)?.description;switch(T){case P.Tz.sql:return(0,l.jsx)(p.x6,{i18nKey:"expressions.expression-query-editor.helper-text-sql",children:'Run MySQL-dialect SQL against the tables returned from your data sources. Data source queries (ie "A", "B") are available as tables and referenced by query-name. Fields are available as columns, as returned from the data source.'});default:return L??""}};function U(){const T=(0,f.useRef)({}),L=(0,f.useCallback)(N=>{switch(N){case P.Tz.math:case P.Tz.reduce:case P.Tz.resample:case P.Tz.threshold:case P.Tz.sql:return T.current[N];case P.Tz.classic:return}},[]),A=(0,f.useCallback)((N,V)=>{switch(N){case P.Tz.math:T.current.math=V;break;case P.Tz.reduce:case P.Tz.resample:case P.Tz.threshold:T.current.reduce=V,T.current.resample=V,T.current.threshold=V;break;case P.Tz.sql:T.current.sql=V}},[]);return{getCachedExpression:L,setCachedExpression:A}}function W(T){const{query:L,queries:A,onRunQuery:N,onChange:V,app:z}=T,{getCachedExpression:w,setCachedExpression:H}=U(),Q=(0,c.of)(B);(0,f.useEffect)(()=>{H(L.type,L.expression)},[L.expression,L.type,H]);const Z=(0,f.useCallback)(I=>{const J=w(I),ee=(0,M.rV)({...L,type:I});V({...ee,expression:J??ee.expression})},[L,V,w]),Y=()=>{const I=A.filter(J=>L.refId!==J.refId).map(J=>({value:J.refId,label:J.refId}));switch(L.type){case P.Tz.math:return(0,l.jsx)(d.z,{onChange:V,query:L,labelWidth:O,onRunQuery:N});case P.Tz.reduce:return(0,l.jsx)(E.Z,{refIds:I,onChange:V,labelWidth:O,query:L,app:z});case P.Tz.resample:return(0,l.jsx)(b.C,{query:L,labelWidth:O,onChange:V,refIds:I});case P.Tz.classic:return(0,l.jsx)(y.z,{onChange:V,query:L,refIds:I});case P.Tz.threshold:return(0,l.jsx)(C.O,{onChange:V,query:L,labelWidth:O,refIds:I});case P.Tz.sql:return(0,l.jsx)(D.k,{onChange:V,query:L,refIds:I})}},X=j(L.type);return(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:Q.operationRow,children:[(0,l.jsx)(x.I,{label:(0,p.t)("expressions.expression-query-editor.label-operation","Operation"),labelWidth:O,children:(0,l.jsx)(h.m,{handleOnSelect:Z,children:(0,l.jsx)(v.$n,{fill:"outline",icon:"angle-down",iconPlacement:"right",variant:"secondary",children:P.uQ.find(({value:I})=>I===L.type)?.label})})}),X&&(0,l.jsx)(m.K,{className:Q.infoIcon,name:"info-circle",tooltip:X})]}),Y()]})}const B=T=>({operationRow:(0,g.css)({display:"flex",alignItems:"center",gap:T.spacing(1)}),infoIcon:(0,g.css)({marginBottom:T.spacing(.5)})});class S extends i.iy{constructor(L){super(L),this.instanceSettings=L}applyTemplateVariables(L,A){const N=(0,r.w)();return{...L,expression:N.replace(L.expression,A),window:N.replace(L.window,A)}}getCollapsedText(L){return`Expression: ${L.type}`}query(L){let A=L.targets.map(async V=>{const z=await(0,u.l)().get(V.datasource);return z.interpolateVariablesInQueries?z?.interpolateVariablesInQueries([V],L.scopedVars,L.filters)[0]:V});return(0,n.H)(Promise.all(A)).pipe((0,a.Z)(V=>super.query({...L,targets:V})))}newQuery(L){return{refId:"--",datasource:i.dR,type:L?.type??P.Tz.math,...L}}}const _={id:-100,uid:P.Uj,name:i.dR.name,type:i.dR.type,access:"proxy",meta:{baseUrl:"",module:"",type:s.QE.datasource,name:i.dR.type,id:i.dR.type,info:{author:{name:"Grafana Labs"},logos:{small:o,large:o},description:"Adds expression support to Grafana",screenshots:[],links:[],updated:"",version:""}},jsonData:{},readOnly:!0},K=new S(_);K.meta={id:i.dR.type,info:{logos:{small:o,large:o}}},K.components={QueryEditor:W}},91073:(te,R,e)=>{"use strict";e.d(R,{z:()=>b});var n=e(74848),a=e(92745),s=e(97095),i=e(18027),r=e(45861),u=e(30703),o=e(82779),l=e(22803),g=e(63142),f=e(41654),p=e(15356),c=e(18857),x=e(63527),v=e(2954);const m=v.A.reducerTypes.map(D=>({label:D.text,value:D.value})),y=v.A.evalOperators.map(D=>({label:D.text,value:D.value})),h=v.A.evalFunctions.map(D=>({label:D.text,value:D.value})),d=({condition:D,index:C,onChange:P,onRemoveCondition:M,refIds:O})=>{const j=(0,g.of)(E),U=L=>{P({...D,operator:{type:L.value}})},W=L=>{P({...D,reducer:{type:L.value,params:[]}})},B=L=>{P({...D,query:{params:[L.value]}})},S=L=>{P({...D,evaluator:{params:D.evaluator.params,type:L.value}})},_=(L,A)=>{const N=parseFloat(L.currentTarget.value),V=[...D.evaluator.params];V[A]=N,P({...D,evaluator:{...D.evaluator,params:V}})},K=(0,l.css)({width:"75px"}),T=D.evaluator.type===v.p.IsWithinRange||D.evaluator.type===v.p.IsOutsideRange||D.evaluator.type===v.p.IsOutsideRangeIncluded||D.evaluator.type===v.p.IsWithinRangeIncluded;return(0,n.jsxs)(f.B,{children:[(0,n.jsxs)("div",{style:{flex:1},children:[(0,n.jsxs)(s.C,{children:[C===0?(0,n.jsx)("div",{className:(0,l.cx)(j.button,K),children:(0,n.jsx)(a.x6,{i18nKey:"expressions.condition.when",children:"WHEN"})}):(0,n.jsx)(p.f,{className:(0,l.cx)(j.buttonSelectText,K),options:y,onChange:U,value:y.find(L=>L.value===D.operator.type)}),(0,n.jsx)(c.l6,{options:m,onChange:W,width:20,value:m.find(L=>L.value===D.reducer.type)}),(0,n.jsx)("div",{className:j.button,children:(0,n.jsx)(a.x6,{i18nKey:"expressions.condition.of",children:"OF"})}),(0,n.jsx)(c.l6,{onChange:B,options:O,width:"auto",value:O.find(L=>L.value===D.query.params[0])})]}),(0,n.jsxs)(s.C,{children:[(0,n.jsx)(p.f,{className:j.buttonSelectText,options:h,onChange:S,value:h.find(L=>L.value===D.evaluator.type)}),T?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x.p,{type:"number",width:10,onChange:L=>_(L,0),value:D.evaluator.params[0]}),(0,n.jsx)("div",{className:j.button,children:(0,n.jsx)(a.x6,{i18nKey:"expressions.condition.to",children:"TO"})}),(0,n.jsx)(x.p,{type:"number",width:10,onChange:L=>_(L,1),value:D.evaluator.params[1]})]}):D.evaluator.type!==v.p.HasNoValue?(0,n.jsx)(x.p,{type:"number",width:10,onChange:L=>_(L,0),value:D.evaluator.params[0]}):null]})]}),(0,n.jsx)(r.$n,{variant:"secondary",type:"button",onClick:()=>M(C),children:(0,n.jsx)(u.I,{name:"trash-alt"})})]})},E=D=>{const C=(0,l.css)({color:D.colors.primary.text,fontSize:D.typography.bodySmall.fontSize});return{buttonSelectText:C,button:(0,l.cx)((0,l.css)({display:"flex",alignItems:"center",borderRadius:D.shape.radius.default,fontWeight:D.typography.fontWeightMedium,border:`1px solid ${D.colors.border.weak}`,whiteSpace:"nowrap",padding:`0 ${D.spacing(1)}`,backgroundColor:D.colors.background.canvas}),C)}},b=({onChange:D,query:C,refIds:P})=>{const M=(U,W)=>{C.conditions&&D({...C,conditions:[...C.conditions.slice(0,W),U,...C.conditions.slice(W+1)]})},O=()=>{if(C.conditions){const U=C.conditions.at(-1)?.query?.params??[],W={...o.P0,query:{params:U}};D({...C,conditions:C.conditions.length>0?[...C.conditions,W]:[W]})}},j=U=>{if(C.conditions){const W=C.conditions[U],B=C.conditions.filter(S=>S!==W).map((S,_)=>_===0?{...S,operator:{type:"when"}}:S);D({...C,conditions:B})}};return(0,n.jsxs)("div",{children:[(0,n.jsx)(s.C,{children:(0,n.jsx)(i.I,{label:(0,a.t)("expressions.classic-conditions.label-conditions","Conditions"),labelWidth:14,children:(0,n.jsx)("div",{children:C.conditions?.map((U,W)=>{if(U)return(0,n.jsx)(d,{index:W,condition:U,onChange:B=>M(B,W),onRemoveCondition:j,refIds:P},W)})})})}),(0,n.jsx)(r.$n,{variant:"secondary",type:"button",onClick:O,children:(0,n.jsx)(u.I,{name:"plus-circle"})})]})}},52900:(te,R,e)=>{"use strict";e.d(R,{m:()=>v});var n=e(74848),a=e(22803),s=e(96540),i=e(1906),r=e(63142),u=e(87063),o=e(30703),l=e(991),g=e(45967),f=e(88559),p=e(4651);const c={[p.Tz.math]:"calculator-alt",[p.Tz.reduce]:"compress-arrows",[p.Tz.resample]:"sync",[p.Tz.classic]:"cog",[p.Tz.threshold]:"sliders-v-alt",[p.Tz.sql]:"database"},x=(0,s.memo)(({item:y,onSelect:h})=>{const{value:d,label:E,description:b}=y,D=(0,r.of)(m),C=(0,s.useCallback)(()=>h(d),[d,h]);return(0,n.jsx)(u.W.Item,{component:()=>(0,n.jsxs)("div",{className:D.expressionTypeItem,role:"menuitem",children:[(0,n.jsxs)("div",{className:D.expressionTypeItemContent,"data-testid":`expression-type-${d}`,children:[(0,n.jsx)(o.I,{className:D.icon,name:c[d],"aria-hidden":"true"}),E,d===p.Tz.sql&&(0,n.jsx)(l.y,{featureState:i.Ay.new})]}),(0,n.jsx)(g.m,{placement:"right",content:b,children:(0,n.jsx)(o.I,{className:D.infoIcon,name:"info-circle"})})]}),label:"",onClick:C},d)});x.displayName="ExpressionMenuItem";const v=(0,s.memo)(({handleOnSelect:y,children:h})=>{const d=(0,s.useMemo)(()=>p.uQ.map(b=>(0,n.jsx)(x,{item:b,onSelect:y},b.value)),[y]),E=(0,s.useMemo)(()=>(0,n.jsx)(u.W,{role:"menu",children:d}),[d]);return(0,n.jsx)(f.m,{placement:"bottom-start",overlay:E,children:h})});v.displayName="ExpressionTypeDropdown";const m=y=>({expressionTypeItem:(0,a.css)({width:"100%",display:"flex",alignItems:"center",gap:y.spacing(1)}),expressionTypeItemContent:(0,a.css)({flexGrow:1,display:"flex",alignItems:"center",gap:y.spacing(1)}),icon:(0,a.css)({color:y.colors.text.secondary,flexShrink:0}),infoIcon:(0,a.css)({opacity:.7,color:y.colors.text.secondary,flexShrink:0})})},18203:(te,R,e)=>{"use strict";e.d(R,{z:()=>x});var n=e(74848),a=e(22803),s=e(92745),i=e(63142),r=e(41654),u=e(18027),o=e(79233),l=e(59243),g=e(30703),f=e(89640),p=e(87105);const c="Math operations on one or more queries. You reference the query by ${refId} ie. $A, $B, $C etc\nThe sum of two scalar values: $A + $B > 10",x=({labelWidth:h,onChange:d,query:E,onRunQuery:b})=>{const D=M=>{d({...E,expression:M.target.value})},C=(0,i.of)(m),P=()=>{E.expression&&b()};return(0,n.jsx)(r.B,{children:(0,n.jsx)(u.I,{label:(0,n.jsx)(o.c,{width:"auto",children:(0,n.jsx)(l.G,{fitContent:!0,content:(0,n.jsxs)("div",{className:C.documentationContainer,children:[(0,n.jsx)("div",{children:(0,n.jsxs)(s.x6,{i18nKey:"expressions.math.run-math-operations",values:{refExample:"${refId}",ref1:"$A",ref2:"$B",ref3:"$C",example:"$A + $B"},children:["Run math operations on one or more queries. You reference the query by ","{{refExample}}"," ie."," ","{{ref1}}",", ","{{ref2}}",", ","{{ref3}}","etc.",(0,n.jsx)("br",{}),"Example: ",(0,n.jsx)("code",{children:"{{example}}"})]})}),(0,n.jsx)("header",{className:C.documentationHeader,children:(0,n.jsx)(s.x6,{i18nKey:"expressions.math.available-math-functions",children:"Available math functions"})}),(0,n.jsxs)("div",{className:C.documentationFunctions,children:[(0,n.jsx)(v,{name:"abs",description:(0,s.t)("expression.math.description-abs","Returns the absolute value of its argument which can be a number or a series")}),(0,n.jsx)(v,{name:"is_inf",description:(0,s.t)("expression.math.description-is-inf","Returns 1 for Inf values (negative or positive) and 0 for other values. It's able to operate on series or scalar values.")}),(0,n.jsx)(v,{name:"is_nan",description:(0,s.t)("expression.math.description-is-nan","Returns 1 for NaN values and 0 for other values. It's able to operate on series or scalar values.")}),(0,n.jsx)(v,{name:"is_null",description:(0,s.t)("expression.math.description-is-null","Returns 1 for null values and 0 for other values. It's able to operate on series or scalar values.")}),(0,n.jsx)(v,{name:"is_number",description:(0,s.t)("expression.math.description-is-number","Returns 1 for all real number values and 0 for non-number. It's able to operate on series or scalar values.")}),(0,n.jsx)(v,{name:"log",description:(0,s.t)("expression.math.description-log","Returns the natural logarithm of its argument, which can be a number or a series")}),(0,n.jsx)(v,{name:"inf, infn, nan, and null",description:(0,s.t)("expression.math.description-inf-nan-null","The inf for infinity positive, infn for infinity negative, nan, and null functions all return a single scalar value that matches its name.")}),(0,n.jsx)(v,{name:"round",description:(0,s.t)("expression.math.description-round","Returns a rounded integer value. It's able to operate on series or escalar values.")}),(0,n.jsx)(v,{name:"ceil",description:(0,s.t)("expression.math.description-ceil","Rounds the number up to the nearest integer value. It's able to operate on series or escalar values.")}),(0,n.jsx)(v,{name:"floor",description:(0,s.t)("expression.math.description-floor","Rounds the number down to the nearest integer value. It's able to operate on series or escalar values.")})]})]}),title:(0,n.jsxs)(r.B,{gap:1,direction:"row",children:[(0,n.jsx)(g.I,{name:"book-open"})," ",(0,n.jsx)(s.x6,{i18nKey:"expressions.math.tooltip-title",children:"Math operator"})]}),footer:(0,n.jsx)("div",{children:(0,n.jsxs)(s.x6,{i18nKey:"expressions.math.tooltip-footer",children:["See our additional documentation on"," ",(0,n.jsx)(f.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/panels/query-a-data-source/use-expressions-to-manipulate-data/about-expressions/#math",children:"Math expressions"}),"."]})}),closeButton:!0,placement:"bottom-start",children:(0,n.jsxs)("div",{className:C.info,children:[(0,n.jsx)(s.x6,{i18nKey:"expressions.math.tooltip-trigger",children:"Expression"})," ",(0,n.jsx)(g.I,{name:"info-circle"})]})})}),labelWidth:h,grow:!0,shrink:!0,children:(0,n.jsx)(p.f,{value:E.expression,onChange:D,rows:1,placeholder:c,onBlur:P,style:{minWidth:250,lineHeight:"26px",minHeight:32}})})})},v=({name:h,description:d})=>{const E=(0,i.of)(y);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:E.name,children:h}),(0,n.jsx)("span",{className:E.description,children:d})]})},m=h=>({documentationHeader:(0,a.css)({fontSize:h.typography.h5.fontSize,fontWeight:h.typography.h5.fontWeight}),documentationContainer:(0,a.css)({display:"flex",flex:1,flexDirection:"column",gap:h.spacing(2),padding:h.spacing(1,2)}),documentationFunctions:(0,a.css)({display:"grid",gridTemplateColumns:"max-content auto",columnGap:h.spacing(2)}),info:(0,a.css)({display:"flex",flexDirection:"row",alignItems:"center",cursor:"pointer",gap:h.spacing(1)})}),y=h=>({name:(0,a.css)({fontWeight:h.typography.fontWeightBold}),description:(0,a.css)({fontSize:h.typography.bodySmall.fontSize,color:h.colors.text.disabled})})},89931:(te,R,e)=>{"use strict";e.d(R,{Z:()=>p});var n=e(74848),a=e(1906),s=e(92745),i=e(18027),r=e(63527),u=e(34999),o=e(89640),l=e(97095),g=e(18857),f=e(4651);const p=({labelWidth:c="auto",onChange:x,app:v,refIds:m,query:y})=>{const h=f.Cu.find(j=>j.value===y.reducer),d=j=>{x({...y,expression:j.value})},E=j=>{x({...y,reducer:j.value})},b=j=>{x({...y,settings:j})},D=j=>{let U;switch(j.value){case f.Mt.Strict:U={mode:f.Mt.Strict};break;case f.Mt.ReplaceNonNumbers:let W=0;y.settings?.mode===f.Mt.ReplaceNonNumbers&&(W=y.settings?.replaceWithValue??0),U={mode:f.Mt.ReplaceNonNumbers,replaceWithValue:W};break;default:U={mode:j.value}}b(U)},C=j=>{const U=j.currentTarget.valueAsNumber;b({mode:f.Mt.ReplaceNonNumbers,replaceWithValue:U??0})},P=y.settings?.mode??f.Mt.Strict,M=()=>{if(P===f.Mt.ReplaceNonNumbers)return(0,n.jsx)(i.I,{label:(0,s.t)("expressions.reduce.replace-with-number.label-replace-with","Replace with"),labelWidth:c,children:(0,n.jsx)(r.p,{type:"number",width:10,onChange:C,value:y.settings?.replaceWithValue??0})})},O=()=>{const j=v===a.Jk.UnifiedAlerting;return P!==f.Mt.Strict||j?null:(0,n.jsx)(u.F,{title:(0,s.t)("reduce.strictMode.title","Strict Mode Behaviour"),severity:"info",children:(0,n.jsxs)(s.x6,{i18nKey:"reduce.strictMode.description",children:["When ",(0,n.jsx)("code",{children:"Reduce Strict mode"})," is used, the ",(0,n.jsx)("code",{children:"fill(null)"})," function (InfluxQL) will result in"," ",(0,n.jsx)("code",{children:"NaN"}),"."," ",(0,n.jsx)(o.Y,{href:"https://grafana.com/docs/grafana/latest/panels-visualizations/query-transform-data/expression-queries/#reduction-modes",children:"See the documentation for more details."})]})})};return(0,n.jsxs)(n.Fragment,{children:[O(),(0,n.jsx)(l.C,{children:(0,n.jsx)(i.I,{label:(0,s.t)("expressions.reduce.label-input","Input"),labelWidth:c,children:(0,n.jsx)(g.l6,{onChange:d,options:m,value:y.expression,width:"auto"})})}),(0,n.jsxs)(l.C,{children:[(0,n.jsx)(i.I,{label:(0,s.t)("expressions.reduce.label-function","Function"),labelWidth:c,children:(0,n.jsx)(g.l6,{options:f.Cu,value:h,onChange:E,width:20})}),(0,n.jsx)(i.I,{label:(0,s.t)("expressions.reduce.label-mode","Mode"),labelWidth:c,children:(0,n.jsx)(g.l6,{onChange:D,options:f.HZ,value:P,width:25})}),M()]})]})}},4652:(te,R,e)=>{"use strict";e.d(R,{C:()=>l});var n=e(74848),a=e(92745),s=e(97095),i=e(18027),r=e(18857),u=e(63527),o=e(4651);const l=({labelWidth:g="auto",onChange:f,refIds:p,query:c})=>{const x=o.PN.find(E=>E.value===c.downsampler),v=o.iX.find(E=>E.value===c.upsampler),m=E=>{f({...c,window:E.target.value})},y=E=>{f({...c,expression:E.value})},h=E=>{f({...c,downsampler:E.value})},d=E=>{f({...c,upsampler:E.value})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.C,{children:(0,n.jsx)(i.I,{label:(0,a.t)("expressions.resample.label-input","Input"),labelWidth:g,children:(0,n.jsx)(r.l6,{onChange:y,options:p,value:c.expression,width:20})})}),(0,n.jsxs)(s.C,{children:[(0,n.jsx)(i.I,{label:(0,a.t)("expressions.resample.label-resample-to","Resample to"),labelWidth:g,tooltip:(0,a.t)("expressions.resample.tooltip-s-m-h","10s, 1m, 30m, 1h"),children:(0,n.jsx)(u.p,{onChange:m,value:c.window,width:15})}),(0,n.jsx)(i.I,{label:(0,a.t)("expressions.resample.label-downsample","Downsample"),children:(0,n.jsx)(r.l6,{options:o.PN,value:x,onChange:h,width:25})}),(0,n.jsx)(i.I,{label:(0,a.t)("expressions.resample.label-upsample","Upsample"),children:(0,n.jsx)(r.l6,{options:o.iX,value:v,onChange:d,width:25})})]})]})}},32576:(te,R,e)=>{"use strict";e.d(R,{k:()=>l});var n=e(74848),a=e(22803),s=e(96540),i=e(97504),r=e(63142);const u=2,o={id:"mysql"},l=({onChange:f,refIds:p,query:c,alerting:x=!1})=>{const m=`SELECT *
  FROM ${(0,s.useMemo)(()=>p.map(D=>D.value),[p])[0]}
  LIMIT 10`,y=(0,r.of)(g),h=(0,s.useRef)(null),[d,E]=(0,s.useState)({height:0}),b=D=>{f({...c,expression:D,format:x?"alerting":void 0})};return(0,s.useEffect)(()=>{if(!h.current)return;const D=new ResizeObserver(C=>{const{height:P}=C[0].contentRect;E({height:P})});return D.observe(h.current),()=>D.disconnect()},[]),(0,s.useEffect)(()=>{c.expression||b(m)},[]),(0,n.jsx)("div",{ref:h,className:y.editorContainer,children:(0,n.jsx)(i.Y,{query:c.expression||m,onChange:b,height:d.height-u,language:o})})},g=()=>({editorContainer:(0,a.css)({height:"240px",resize:"vertical",overflow:"auto",minHeight:"100px"})})},38610:(te,R,e)=>{"use strict";e.d(R,{O:()=>W});var n=e(74848),a=e(22803),s=e(2543),i=e(96540),r=e(92745),u=e(63142),o=e(97095),l=e(18027),g=e(18857),f=e(63527),p=e(21285),c=e(41654),x=e(2954),v=e(4651),m=e(81988),y=e(66258),h=e(65307);const d=(0,h.VP)("thresold/updateRefId"),E=(0,h.VP)("thresold/updateThresholdType"),b=(0,h.VP)("thresold/updateThresholdParams"),D=(0,h.VP)("thresold/updateHysteresis"),C=(0,h.VP)("thresold/updateUnloadParams"),P=(0,h.vy)({type:v.Tz.threshold,refId:"",conditions:[]},_=>{_.addCase(d,(K,T)=>{K.expression=T.payload}),_.addCase(E,(K,T)=>{const L=T.payload.evalFunction,A=T.payload.onError;if(K.conditions[0].evaluator.type=L,!!K.conditions[0].unloadEvaluator){const V=M(K.conditions[0].evaluator.type);A&&A(void 0),K.conditions[0].evaluator.type=L;const z={type:V,params:K.conditions[0].evaluator?.params??[0,0]};K.conditions[0].unloadEvaluator=z}}),_.addCase(b,(K,T)=>{const{param:L,index:A}=T.payload;K.conditions[0].evaluator.params[A]=L}),_.addCase(D,(K,T)=>{const{hysteresisChecked:L,onError:A}=T.payload;L?K.conditions[0].unloadEvaluator={type:M(K.conditions[0].evaluator.type),params:K.conditions[0].evaluator?.params??[0,0]}:(K.conditions[0].unloadEvaluator=void 0,A&&A(void 0))}),_.addCase(C,(K,T)=>{const{param:L,index:A,onError:N}=T.payload;K.conditions[0].unloadEvaluator?K.conditions[0].unloadEvaluator.params[A]=L:K.conditions[0].unloadEvaluator={type:M(K.conditions[0].evaluator.type),params:K.conditions[0].evaluator?.params??[0,0]};const V=O(K.conditions[0]),{errorMsg:z,errorMsgFrom:w,errorMsgTo:H}=V??{};N&&N(z||w||H)})});function M(_){return _===x.p.IsAbove?x.p.IsBelow:_===x.p.IsBelow?x.p.IsAbove:_===x.p.IsEqual?x.p.IsNotEqual:_===x.p.IsNotEqual?x.p.IsEqual:_===x.p.IsGreaterThanEqual?x.p.IsLessThanEqual:_===x.p.IsLessThanEqual?x.p.IsGreaterThanEqual:_===x.p.IsWithinRange?x.p.IsOutsideRange:_===x.p.IsOutsideRange?x.p.IsWithinRange:_===x.p.IsWithinRangeIncluded?x.p.IsOutsideRangeIncluded:_===x.p.IsOutsideRangeIncluded?x.p.IsWithinRangeIncluded:x.p.IsBelow}function O(_){const{unloadEvaluator:K,evaluator:T}=_;if(!T)return;if(K?.params[0]===void 0||Number.isNaN(K?.params[0]))return{errorMsg:"This value cannot be empty"};const{type:L,params:A}=T,{params:N}=K;if(L===x.p.IsWithinRange||L===x.p.IsOutsideRange||L===x.p.IsWithinRangeIncluded||L===x.p.IsOutsideRangeIncluded){if(N[0]===void 0||Number.isNaN(N[0]))return{errorMsgFrom:"This value cannot be empty"};if(N[1]===void 0||Number.isNaN(N[1]))return{errorMsgTo:"This value cannot be empty"}}const[V,z]=K.params,[w,H]=A;switch(L){case x.p.IsAbove:if(V>w)return{errorMsg:`Enter a number less than or equal to ${w}`};break;case x.p.IsBelow:if(V<w)return{errorMsg:`Enter a number more than or equal to ${w}`};break;case x.p.IsEqual:if(V===w)return{errorMsg:`Enter a different number than ${w}`};break;case x.p.IsNotEqual:if(V!==w)return{errorMsg:`Enter the same number as ${w}`};break;case x.p.IsGreaterThanEqual:if(V>=w)return{errorMsg:`Enter a number less than ${w}`};break;case x.p.IsLessThanEqual:if(V<=w)return{errorMsg:`Enter a number more than ${w}`};break;case x.p.IsOutsideRange:if(V<w)return{errorMsgFrom:`Enter a number more than or equal to ${w}`};if(z>H)return{errorMsgTo:`Enter a number less than or equal to ${H}`};break;case x.p.IsWithinRange:if(V>w)return{errorMsgFrom:`Enter a number less than or equal to ${w}`};if(z<H)return{errorMsgTo:`Enter a number be more than or equal to ${H}`};break;case x.p.IsOutsideRangeIncluded:if(V<=w)return{errorMsgFrom:`Enter a number more than ${w}`};if(z>=H)return{errorMsgTo:`Enter a number less than ${H}`};break;case x.p.IsWithinRangeIncluded:if(V>=w)return{errorMsgFrom:`Enter a number less than ${w}`};if(z<=H)return{errorMsgTo:`Enter a number be more than ${H}`};break;default:throw new Error(`evaluator function type ${L} not supported.`)}}const j=x.p.IsAbove,U={type:"query",evaluator:{type:j,params:[0,0]},query:{params:[]},reducer:{params:[],type:"last"}},W=({labelWidth:_,onChange:K,refIds:T,query:L,onError:A,useHysteresis:N=!1})=>{const V=(0,u.of)(S),z={...L,conditions:L.conditions?.length?L.conditions:[U]},[w,H]=(0,i.useReducer)(P,z),Q=w.conditions[0],Z=v.zd.find(ne=>ne.value===w.conditions[0].evaluator?.type),Y=ne=>{H(d(ne.value))};(0,i.useEffect)(()=>{w&&K(w)},[w]);const X=ne=>{H(E({evalFunction:ne.value??j,onError:A}))},I=(ne,se)=>{H(b({param:parseFloat(ne.currentTarget.value),index:se}))},J=Q.evaluator.type===x.p.IsWithinRange||Q.evaluator.type===x.p.IsOutsideRange||Q.evaluator.type===x.p.IsOutsideRangeIncluded||Q.evaluator.type===x.p.IsWithinRangeIncluded,ee=(0,s.uniqueId)("threshold-");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.C,{children:(0,n.jsx)(l.I,{label:(0,r.t)("expressions.threshold.label-input","Input"),labelWidth:_,htmlFor:ee,children:(0,n.jsx)(g.l6,{inputId:ee,onChange:Y,options:T,value:L.expression,width:20})})}),(0,n.jsxs)(o.C,{children:[(0,n.jsx)(m.E,{onChange:X,value:Z}),J?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.p,{type:"number",width:10,onChange:ne=>I(ne,0),defaultValue:Q.evaluator.params[0]}),(0,n.jsx)(y.Y,{}),(0,n.jsx)(f.p,{type:"number",width:10,onChange:ne=>I(ne,1),defaultValue:Q.evaluator.params[1]})]}):(0,n.jsx)(f.p,{type:"number",width:10,onChange:ne=>I(ne,0),defaultValue:Q.evaluator.params[0]||0})]}),N&&(0,n.jsx)(q,{isRange:J,onError:A})]});function q({isRange:ne,onError:se}){const oe=!!Q.unloadEvaluator,de=ce=>{H(D({hysteresisChecked:ce.currentTarget.checked,onError:se})),fe.current=!0},fe=i.useRef(!0),ae=()=>{fe.current=!1};return(0,n.jsxs)("div",{className:V.hysteresis,children:[(0,n.jsx)("div",{onMouseDown:ae,children:(0,n.jsx)(p.K,{showLabel:!0,label:(0,r.t)("alerting.rule-form.threshold.recovery.title","Custom recovery threshold"),value:oe,onChange:de,className:V.switch})}),oe&&(0,n.jsx)(B,{isRange:ne,condition:Q,onError:se,dispatch:H,allowOnblur:fe})]})}};function B({isRange:_,condition:K,onError:T,dispatch:L,allowOnblur:A}){const N=(0,u.of)(S),V=(X,I)=>{const J=parseFloat(X.currentTarget.value);L(C({param:J,index:I,onError:T}))},z=O(K),{errorMsg:w,errorMsgFrom:H,errorMsgTo:Q}=z??{};if(_)return(0,n.jsx)(Z,{allowOnblur:A});return(0,n.jsx)(Y,{allowOnblur:A});function Z({allowOnblur:X}){switch(K.evaluator.type){case x.p.IsWithinRange:if(K.evaluator.type===x.p.IsWithinRange)return(0,n.jsx)(o.C,{className:N.hysteresis,children:(0,n.jsx)(l.I,{label:(0,r.t)("alerting.rule-form.threshold.recovery.stop-alerting-outside-range","Stop alerting (or pending state) when outside range"),labelWidth:"auto",children:(0,n.jsxs)(c.B,{direction:"row",gap:0,children:[(0,n.jsx)("div",{className:N.range,children:(0,n.jsx)(l.I,{invalid:!!H,error:H,className:N.noMargin,children:(0,n.jsx)(f.p,{type:"number",width:10,onBlur:I=>X.current&&V(I,0),defaultValue:K.unloadEvaluator?.params[0]})})}),(0,n.jsx)(y.Y,{}),(0,n.jsx)("div",{className:N.range,children:(0,n.jsx)(l.I,{invalid:!!Q,error:Q,children:(0,n.jsx)(f.p,{type:"number",width:10,onBlur:I=>X.current&&V(I,1),defaultValue:K.unloadEvaluator?.params[1]})})})]})})});case x.p.IsOutsideRange:return(0,n.jsx)(o.C,{className:N.hysteresis,children:(0,n.jsx)(l.I,{label:(0,r.t)("alerting.rule-form.threshold.recovery.stop-alerting-inside-range","Stop alerting (or pending state) when inside range"),labelWidth:"auto",children:(0,n.jsxs)(c.B,{direction:"row",gap:0,children:[(0,n.jsx)("div",{className:N.range,children:(0,n.jsx)(l.I,{invalid:!!H,error:H,children:(0,n.jsx)(f.p,{type:"number",width:10,onBlur:I=>X.current&&V(I,0),defaultValue:K.unloadEvaluator?.params[0]})})}),(0,n.jsx)(y.Y,{}),(0,n.jsx)("div",{className:N.range,children:(0,n.jsx)(l.I,{invalid:!!Q,error:Q,children:(0,n.jsx)(f.p,{type:"number",width:10,onBlur:I=>X.current&&V(I,1),defaultValue:K.unloadEvaluator?.params[1]})})})]})})});case x.p.IsOutsideRangeIncluded:return(0,n.jsx)(o.C,{className:N.hysteresis,children:(0,n.jsx)(l.I,{label:(0,r.t)("alerting.rule-form.threshold.recovery.stop-alerting-inside-range","Stop alerting (or pending state) when inside range"),labelWidth:"auto",children:(0,n.jsxs)(c.B,{direction:"row",gap:0,children:[(0,n.jsx)("div",{className:N.range,children:(0,n.jsx)(l.I,{invalid:!!H,error:H,children:(0,n.jsx)(f.p,{type:"number",width:10,onBlur:I=>X.current&&V(I,0),defaultValue:K.unloadEvaluator?.params[0]})})}),(0,n.jsx)(y.Y,{}),(0,n.jsx)("div",{className:N.range,children:(0,n.jsx)(l.I,{invalid:!!Q,error:Q,children:(0,n.jsx)(f.p,{type:"number",width:10,onBlur:I=>X.current&&V(I,1),defaultValue:K.unloadEvaluator?.params[1]})})})]})})});case x.p.IsWithinRangeIncluded:return(0,n.jsx)(o.C,{className:N.hysteresis,children:(0,n.jsx)(l.I,{label:(0,r.t)("alerting.rule-form.threshold.recovery.stop-alerting-outside-range","Stop alerting (or pending state) when outside range"),labelWidth:"auto",children:(0,n.jsxs)(c.B,{direction:"row",gap:0,children:[(0,n.jsx)("div",{className:N.range,children:(0,n.jsx)(l.I,{invalid:!!H,error:H,children:(0,n.jsx)(f.p,{type:"number",width:10,onBlur:I=>X.current&&V(I,0),defaultValue:K.unloadEvaluator?.params[0]})})}),(0,n.jsx)(y.Y,{}),(0,n.jsx)("div",{className:N.range,children:(0,n.jsx)(l.I,{invalid:!!Q,error:Q,children:(0,n.jsx)(f.p,{type:"number",width:10,onBlur:I=>X.current&&V(I,1),defaultValue:K.unloadEvaluator?.params[1]})})})]})})});default:return null}}function Y({allowOnblur:X}){switch(K.evaluator.type){case x.p.IsAbove:return(0,n.jsx)(o.C,{className:N.hysteresis,children:(0,n.jsx)(l.I,{label:(0,r.t)("alerting.rule-form.threshold.recovery.stop-alerting-bellow","Stop alerting (or pending state) when below"),labelWidth:"auto",invalid:!!w,error:w,children:(0,n.jsx)(f.p,{type:"number",width:10,onBlur:I=>{X.current&&V(I,0)},defaultValue:K.unloadEvaluator?.params[0]})})});case x.p.IsBelow:return(0,n.jsx)(o.C,{className:N.hysteresis,children:(0,n.jsx)(l.I,{label:(0,r.t)("alerting.rule-form.threshold.recovery.stop-alerting-above","Stop alerting (or pending state) when above"),labelWidth:"auto",invalid:!!w,error:w,children:(0,n.jsx)(f.p,{type:"number",width:10,onBlur:I=>{X.current&&V(I,0)},defaultValue:K.unloadEvaluator?.params[0]})})});case x.p.IsEqual:return(0,n.jsx)(o.C,{className:N.hysteresis,children:(0,n.jsx)(l.I,{label:(0,r.t)("alerting.rule-form.threshold.recovery.stop-alerting-equal","Stop alerting (or pending state) when equal to"),labelWidth:"auto",invalid:!!w,error:w,children:(0,n.jsx)(f.p,{type:"number",width:10,onBlur:I=>{X.current&&V(I,0)},defaultValue:K.unloadEvaluator?.params[0]})})});case x.p.IsNotEqual:return(0,n.jsx)(o.C,{className:N.hysteresis,children:(0,n.jsx)(l.I,{label:(0,r.t)("alerting.rule-form.threshold.recovery.stop-alerting-not-equal","Stop alerting (or pending state) when not equal to"),labelWidth:"auto",invalid:!!w,error:w,children:(0,n.jsx)(f.p,{type:"number",width:10,onBlur:I=>{X.current&&V(I,0)},defaultValue:K.unloadEvaluator?.params[0]})})});case x.p.IsGreaterThanEqual:return(0,n.jsx)(o.C,{className:N.hysteresis,children:(0,n.jsx)(l.I,{label:(0,r.t)("alerting.rule-form.threshold.recovery.stop-alerting-less","Stop alerting (or pending state) when less than"),labelWidth:"auto",invalid:!!w,error:w,children:(0,n.jsx)(f.p,{type:"number",width:10,onBlur:I=>{X.current&&V(I,0)},defaultValue:K.unloadEvaluator?.params[0]})})});case x.p.IsLessThanEqual:return(0,n.jsx)(o.C,{className:N.hysteresis,children:(0,n.jsx)(l.I,{label:(0,r.t)("alerting.rule-form.threshold.recovery.stop-alerting-more","Stop alerting (or pending state) when more than"),labelWidth:"auto",invalid:!!w,error:w,children:(0,n.jsx)(f.p,{type:"number",width:10,onBlur:I=>{X.current&&V(I,0)},defaultValue:K.unloadEvaluator?.params[0]})})});default:return null}}}const S=_=>({range:(0,a.css)({width:"min-content"}),hysteresis:(0,a.css)({marginTop:_.spacing(2)}),switch:(0,a.css)({paddingLeft:_.spacing(1)}),noMargin:(0,a.css)({margin:0})})},81988:(te,R,e)=>{"use strict";e.d(R,{E:()=>u});var n=e(74848),a=e(22803),s=e(63142),i=e(15356),r=e(4651);function u({onChange:l,value:g}){const f=(0,s.of)(o);return(0,n.jsx)(i.f,{className:f.buttonSelectText,options:r.zd,onChange:l,value:g})}const o=l=>({buttonSelectText:(0,a.css)({color:l.colors.primary.text,fontSize:l.typography.bodySmall.fontSize,textTransform:"uppercase",padding:`0 ${l.spacing(1)}`})})},66258:(te,R,e)=>{"use strict";e.d(R,{Y:()=>r});var n=e(74848),a=e(22803),s=e(92745),i=e(63142);function r(){const o=(0,i.of)(u);return(0,n.jsx)("div",{className:o.button,children:(0,n.jsx)(s.x6,{i18nKey:"alerting.threshold.to",children:"TO"})})}const u=o=>({button:(0,a.css)({height:"32px",color:o.colors.primary.text,fontSize:o.typography.bodySmall.fontSize,display:"flex",alignItems:"center",fontWeight:o.typography.fontWeightBold,padding:`0 ${o.spacing(1)}`})})},44022:(te,R,e)=>{"use strict";e.d(R,{f:()=>s,z:()=>i});var n=e(36580),a=e(4651);const s=r=>{if(!r)return!1;if((0,n.s9)(r.datasource))return!0;const u=r;return typeof u.type!="string"?!1:Object.values(a.Tz).includes(u.type)};function i(r){return["avg","min","max","sum","count","last","median","diff","diff_abs","percent_diff","percent_diff_abs","count_non_null"].includes(r)}},4651:(te,R,e)=>{"use strict";e.d(R,{Cu:()=>l,HZ:()=>f,Mt:()=>g,NI:()=>u,PN:()=>p,Tz:()=>r,Uj:()=>i,iX:()=>c,uQ:()=>o,zd:()=>x});var n=e(46644),a=e(65642),s=e(2954);const i="__expr__";var r=(v=>(v.math="math",v.reduce="reduce",v.resample="resample",v.classic="classic_conditions",v.threshold="threshold",v.sql="sql",v))(r||{});const u=v=>{switch(v){case"math":return"Math";case"reduce":return"Reduce";case"resample":return"Resample";case"classic_conditions":return"Classic condition (legacy)";case"threshold":return"Threshold";case"sql":return"SQL"}},o=[{value:"math",label:"Math",description:"Free-form math formulas on time series or number data."},{value:"reduce",label:"Reduce",description:"Takes one or more time series returned from a query or an expression and turns each series into a single number."},{value:"resample",label:"Resample",description:"Changes the time stamps in each time series to have a consistent time interval."},{value:"classic_conditions",label:"Classic condition (legacy)",description:"Takes one or more time series returned from a query or an expression and checks if any of the series match the condition. Disables multi-dimensional alerts for this rule."},{value:"threshold",label:"Threshold",description:"Takes one or more time series returned from a query or an expression and checks if any of the series match the threshold condition."},{value:"sql",label:"SQL",description:"Transform data using SQL. Supports MySQL syntax."}].filter(v=>v.value==="sql"?a.$W?.featureToggles?.sqlExpressions:!0),l=[{value:n.gy.min,label:"Min",description:"Get the minimum value"},{value:n.gy.max,label:"Max",description:"Get the maximum value"},{value:n.gy.mean,label:"Mean",description:"Get the average value"},{value:n.gy.median,label:"Median",description:"Get the median value"},{value:n.gy.sum,label:"Sum",description:"Get the sum of all values"},{value:n.gy.count,label:"Count",description:"Get the number of values"},{value:n.gy.last,label:"Last",description:"Get the last value"}];var g=(v=>(v.Strict="",v.ReplaceNonNumbers="replaceNN",v.DropNonNumbers="dropNN",v))(g||{});const f=[{value:"",label:"Strict",description:"Result can be NaN if series contains non-numeric data"},{value:"dropNN",label:"Drop Non-numeric Values",description:"Drop NaN, +/-Inf and null from input series before reducing"},{value:"replaceNN",label:"Replace Non-numeric Values",description:"Replace NaN, +/-Inf and null with a constant value before reducing"}],p=[{value:n.gy.last,label:"Last",description:"Fill with the last value"},{value:n.gy.min,label:"Min",description:"Fill with the minimum value"},{value:n.gy.max,label:"Max",description:"Fill with the maximum value"},{value:n.gy.mean,label:"Mean",description:"Fill with the average value"},{value:n.gy.sum,label:"Sum",description:"Fill with the sum of all values"}],c=[{value:"pad",label:"pad",description:"fill with the last known value"},{value:"backfilling",label:"backfilling",description:"fill with the next known value"},{value:"fillna",label:"fillna",description:"Fill with NaNs"}],x=[{value:s.p.IsAbove,label:"Is above"},{value:s.p.IsBelow,label:"Is below"},{value:s.p.IsEqual,label:"Is equal to"},{value:s.p.IsNotEqual,label:"Is not equal to"},{value:s.p.IsGreaterThanEqual,label:"Is above or equal to"},{value:s.p.IsLessThanEqual,label:"Is below or equal to"},{value:s.p.IsWithinRange,label:"Is within range"},{value:s.p.IsOutsideRange,label:"Is outside range"},{value:s.p.IsWithinRangeIncluded,label:"Is within range included"},{value:s.p.IsOutsideRangeIncluded,label:"Is outside range included"}]},82779:(te,R,e)=>{"use strict";e.d(R,{D5:()=>g,H3:()=>o,OC:()=>l,P0:()=>u,hJ:()=>p,rV:()=>r,sk:()=>f});var n=e(46644),a=e(2954),s=e(44022),i=e(4651);const r=c=>{switch(c.type){case i.Tz.reduce:c.reducer||(c.reducer=n.gy.mean);break;case i.Tz.resample:c.downsampler||(c.downsampler=n.gy.mean),c.upsampler||(c.upsampler="fillna"),c.reducer=void 0;break;case i.Tz.math:c.expression=void 0;break;case i.Tz.classic:c.conditions||(c.conditions=[u]);break;default:c.reducer=void 0}return c},u={type:"query",reducer:{params:[],type:"avg"},operator:{type:"and"},query:{params:[]},evaluator:{params:[0,0],type:a.p.IsAbove}};function o(c){if((0,s.z)(c))return c}function l(c){if(!g(c))return!1;const x=c.settings?.mode;return x===i.Mt.Strict||x===void 0}function g(c){return c.type===i.Tz.reduce}function f(c){return c.type===i.Tz.threshold}function p(c){return c===a.p.IsWithinRange||c===a.p.IsOutsideRange||c===a.p.IsOutsideRangeIncluded||c===a.p.IsWithinRangeIncluded}},66198:(te,R,e)=>{"use strict";e.d(R,{Cg:()=>o,Fk:()=>g,R4:()=>c,Rj:()=>u,pq:()=>l});var n=e(92745),a=e(43173),s=e(15130),i=e(18832),r=e(11257);const u="manage-folder",o=v=>`folder-dashboards-${v}`,l=v=>`folder-library-panels-${v}`,g=v=>`folder-alerting-${v}`,f=v=>`folder-permissions-${v}`,p=v=>`folder-settings-${v}`;function c(v,m){const y=m??("parents"in v?v.parents:void 0),h={icon:"folder",id:u,subTitle:(0,i.o)("manage-folder"),url:v.url,text:v.title,children:[{active:!1,icon:"apps",id:o(v.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.dashboards","Dashboards"),url:v.url}]};if(y&&y.length>0){const d=y[y.length-1],E=y.slice(0,y.length-1);h.parentItem=c(d,E)}return h.children.push({active:!1,icon:"library-panel",id:l(v.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.panels","Panels"),url:`${v.url}/library-panels`}),s.TP.hasPermission(r.w.AlertingRuleRead)&&a.$.unifiedAlertingEnabled&&h.children.push({active:!1,icon:"bell",id:g(v.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.alert-rules","Alert rules"),url:`${v.url}/alerting`}),h}function x(v){const m=c({created:"",createdBy:"",hasAcl:!1,updated:"",updatedBy:"",id:1,uid:"loading",title:t("folders.get-loading-nav.main.title.loading","Loading"),url:"url",canSave:!0,canEdit:!0,canAdmin:!0,canDelete:!0,version:0});return m.children[v].active=!0,{main:m,node:m.children[v]}}},17621:(te,R,e)=>{"use strict";e.d(R,{Ay:()=>g,jl:()=>u});var n=e(65307),a=e(18346);const s={id:0,uid:"loading",title:"loading",url:"",canSave:!1,canDelete:!1,hasChanged:!1,version:1},i=(f,p)=>({...f,...p.payload,hasChanged:!1}),r=(0,n.Z0)({name:"folder",initialState:s,reducers:{loadFolder:i,setFolderTitle:(f,p)=>({...f,title:p.payload,hasChanged:p.payload.trim().length>0})},extraReducers:f=>{f.addMatcher(a.vZ.getFolder.matchFulfilled,i)}}),{loadFolder:u,setFolderTitle:o}=r.actions,g={folder:r.reducer}},93139:(te,R,e)=>{"use strict";e.d(R,{G:()=>g});var n=e(74848),a=e(22803),s=e(96540),i=e(63142),r=e(18857),u=e(34999),o=e(46189);const l=[{label:"Countries",description:"Lookup countries by name, two letter code, or three letter code",value:o.fx},{label:"USA States",description:"Lookup states by name or 2 ",value:"public/gazetteer/usa-states.json"},{label:"Airports",description:"Lookup airports by id or code",value:"public/gazetteer/airports.geojson"}],g=({value:p,onChange:c,context:x,item:v})=>{const m=(0,i.of)(f),[y,h]=(0,s.useState)(),d=v.settings;(0,s.useEffect)(()=>{async function D(){const C=await(0,o.q3)(p);h(C)}D()},[p,h]);const{current:E,options:b}=(0,s.useMemo)(()=>{let D=d?.options?[...d.options]:[...l],C=D?.find(P=>P.value===y?.path);return!C&&y&&(C={label:y.path,value:y.path},D.push(C)),{options:D,current:C}},[y,d?.options]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.l6,{value:E,options:b,onChange:D=>c(D.value),allowCustomValue:!0,formatCreateLabel:D=>`Load from URL: ${D}`}),y&&(0,n.jsxs)(n.Fragment,{children:[y.error&&(0,n.jsx)(u.F,{title:y.error,severity:"warning"}),y.count&&(0,n.jsxs)("div",{className:m.keys,children:[(0,n.jsxs)("b",{children:["(",y.count,")"]}),y.examples(10).map(D=>(0,n.jsxs)("span",{children:[D,","]},D)),y.count>10&&" ..."]})]})]})},f=p=>({keys:(0,a.css)({marginTop:p.spacing(.5),textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap","> span":{marginLeft:p.spacing(.5)}})})},90267:(te,R,e)=>{"use strict";e.d(R,{G:()=>d});var n=e(95004),a=e(92745),s=e(739),i=e(93139),r=e(74848),u=e(22803),o=e(96540),l=e(51898),g=e(63142),f=e(34999),p=e(30703),c=e(18857),x=e(32881),v=e(87039);const m="https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/geomap/#location",y=({value:E,onChange:b,context:D,item:C})=>{const[P,M]=(0,o.useState)(),O=[{value:s.aG.Auto,label:(0,a.t)("geo.location-more-editor.mode-options.label-auto","Auto"),ariaLabel:l.Tp.components.Transforms.SpatialOperations.location.autoOption,description:(0,a.t)("geo.location-more-editor.mode-options.description-auto","Automatically identify location data based on default field names")},{value:s.aG.Coords,label:(0,a.t)("geo.location-more-editor.mode-options.label-coords","Coords"),ariaLabel:l.Tp.components.Transforms.SpatialOperations.location.coords.option,description:(0,a.t)("geo.location-more-editor.mode-options.description-coords","Specify latitude and longitude fields")},{value:s.aG.Geohash,label:(0,a.t)("geo.location-more-editor.mode-options.label-geohash","Geohash"),ariaLabel:l.Tp.components.Transforms.SpatialOperations.location.geohash.option,description:(0,a.t)("geo.location-more-editor.mode-options.description-geohash","Specify geohash field")},{value:s.aG.Lookup,label:(0,a.t)("geo.location-more-editor.mode-options.label-lookup","Lookup"),ariaLabel:l.Tp.components.Transforms.SpatialOperations.location.lookup.option,description:(0,a.t)("geo.location-more-editor.mode-options.description-lookup","Specify Gazetteer and lookup field")}];(0,o.useEffect)(()=>{C.settings?.source&&C.settings?.data?.length&&C.settings.data[0]&&(0,v.nE)(C.settings.source).then(W=>{C.settings&&C.settings.data&&M((0,v.FM)(C.settings.data[0],W))})},[C.settings]);const j=(0,g.of)(h),U=()=>{if(P){if(P.warning)return(0,r.jsx)(f.F,{title:P.warning,severity:"warning",buttonContent:(0,r.jsx)(p.I,{name:"question-circle",size:"xl"}),className:j.alert,onRemove:()=>{const W=window.open(m,"_blank","noopener,noreferrer");W&&(W.opener=null)}});if(E===s.aG.Auto&&P.description)return(0,r.jsx)("span",{children:P.description})}return null};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.l6,{options:O,value:E,onChange:W=>{b(W.value)}}),(0,r.jsx)(x.Gy,{className:j.hGroup,children:U()})]})},h=E=>({alert:(0,u.css)({"& div":{padding:E.spacing(.5)},marginBottom:"0px",marginTop:"5px",padding:E.spacing(.25)}),hGroup:(0,u.css)({"& div":{width:"100%"}})});function d(E,b,D,C,P){switch(D.addCustomEditor({id:"modeEditor",path:`${b}mode`,name:(0,a.t)("geo.location-editor.name-location-mode","Location Mode"),editor:y,settings:{data:P,source:C}}),C?.mode){case s.aG.Coords:D.addFieldNamePicker({path:`${b}latitude`,name:(0,a.t)("geo.location-editor.name-latitude-field","Latitude field"),settings:{filter:M=>M.type===n.PU.number,noFieldsMessage:(0,a.t)("geo.location-editor.latitude-field.no-fields-message","No numeric fields found")}}).addFieldNamePicker({path:`${b}longitude`,name:(0,a.t)("geo.location-editor.name-longitude-field","Longitude field"),settings:{filter:M=>M.type===n.PU.number,noFieldsMessage:(0,a.t)("geo.location-editor.longitude-field.no-fields-message","No numeric fields found")}});break;case s.aG.Geohash:D.addFieldNamePicker({path:`${b}geohash`,name:(0,a.t)("geo.location-editor.name-geohash-field","Geohash field"),settings:{filter:M=>M.type===n.PU.string,noFieldsMessage:(0,a.t)("geo.location-editor.geohash-field.no-fields-message","No strings fields found")}});break;case s.aG.Lookup:D.addFieldNamePicker({path:`${b}lookup`,name:(0,a.t)("geo.location-editor.name-lookup-field","Lookup field"),settings:{filter:M=>M.type===n.PU.string,noFieldsMessage:(0,a.t)("geo.location-editor.lookup-field.no-fields-message","No strings fields found")}}).addCustomEditor({id:"gazetteer",path:`${b}gazetteer`,name:(0,a.t)("geo.location-editor.name-gazetteer","Gazetteer"),editor:i.G})}}},98643:(te,R,e)=>{"use strict";e.d(R,{RA:()=>c,XR:()=>x,Dc:()=>p,qy:()=>g,Pz:()=>f});var n=e(44294),a=e(34338),s=e(11217),i=e(22796),r=e(95004),u=e(78089);function o(m){if(!m?.length)return;const y=[16,8,4,2,1],h="0123456789bcdefghjkmnpqrstuvwxyz";let d=!0;const E=[],b=[];E[0]=-90,E[1]=90,b[0]=-180,b[1]=180;let D;m.split("").forEach(M=>{D=h.indexOf(M),y.forEach(O=>{l(d?b:E,D,O),d=!d})});const C=(E[0]+E[1])/2;return[(b[0]+b[1])/2,C]}function l(m,y,h){y&h?m[0]=(m[0]+m[1])/2:m[1]=(m[0]+m[1])/2}function g(m){return{name:m.name??"Point",type:r.PU.geo,values:m.values.map(y=>{const h=o(y);if(h)return new n.A((0,i.Rb)(h))}),config:v}}function f(m,y){const h=new Array(m.values.length);for(let d=0;d<m.values.length;d++){const E=m.values[d],b=y.values[d];E===null||b===null||(h[d]=new n.A((0,i.Rb)([E,b])))}return{name:"Point",type:r.PU.geo,values:h,config:v}}function p(m,y){const h=y.values.length,d=new Array(h);for(let E=0;E<h;E++)d[E]=m.find(y.values[E])?.geometry();return{name:"Geometry",type:r.PU.geo,values:d,config:v}}function c(m,y){const h=m.values,d=y.values;if(!h||!d)throw"missing src/dest";if(h.length!==d.length)throw"Source and destination field lengths do not match";const E=m.values.length,b=new Array(E);for(let D=0;D<E;D++){const C=h[D],P=d[D];C&&P?b[D]=new a.A([C,P]):C?b[D]=C:P&&(b[D]=P)}return{name:"Geometry",type:r.PU.geo,values:b,config:v}}function x(m,y){const h=m.values,d=y.values;if(!h||!d)throw"missing src/dest";if(h.length!==d.length)throw"Source and destination field lengths do not match";const E=m.values.length,b=new Array(E);for(let D=0;D<E;D++){const C=h[D],P=d[D];C&&P&&(b[D]=new s.A([(0,u.EX)(C),(0,u.EX)(P)]))}return{name:"Geometry",type:r.PU.geo,values:b,config:v}}const v=Object.freeze({custom:{hideFrom:{tooltip:!0}}})},46189:(te,R,e)=>{"use strict";e.d(R,{fx:()=>m,q3:()=>y});var n=e(70915),a=e(44294),s=e(41119),i=e(95004),r=e(68143),u=e(11365);function o(h){const d=new u.A().readFeatures(h,{featureProjection:"EPSG:3857"}),E=d.length,b=new Array(E).fill(null),D=[],C=new Map,P=U=>{let W=C.get(U);return W||(W={types:new Set,values:new Array(E).fill(null),count:0},D.push(U),C.set(U,W)),W},M=(...U)=>{for(const W of U)if(!C.has(W))return W;return"___"+U[0]},O={types:new Set,values:new Array(E).fill(null),count:0};for(let U=0;U<E;U++){const W=d[U];b[U]=W.getGeometry();const B=W.getId();B!=null&&(O.values[U]=B,O.types.add((0,s.oE)(B)),O.count++);for(const S of W.getKeys()){const _=W.get(S);if(_===b[U]||_==null)continue;const K=P(S);K.values[U]=_,K.types.add((0,s.oE)(_)),K.count++}}const j=[];if(O.count>0){const U=l(O);j.push({name:M("id","_id","__id"),type:U,values:O.values,config:{}})}j.push({name:M("geo","geometry"),type:i.PU.geo,values:b,config:{}});for(const U of D){const W=C.get(U);if(!W)continue;const B=l(W);j.push({name:U,type:B,values:W.values,config:{}})}return{fields:j,length:E}}function l(h){return h.count<1?i.PU.other:h.types.size>1?(h.values=h.values.map(d=>d!=null?`${d}`:d),i.PU.string):h.types.values().next().value??i.PU.other}var g=e(98643),f=e(22796);function p(h,d){let E=0;const b=new Map;for(const D of d){const C=new a.A((0,f.Rb)([D.longitude,D.latitude])),P={point:()=>C,geometry:()=>C};if(D.name&&(b.set(D.name,P),b.set(D.name.toUpperCase(),P)),D.key&&(b.set(D.key,P),b.set(D.key.toUpperCase(),P)),D.keys)for(const M of D.keys)b.set(M,P),b.set(M.toUpperCase(),P);E++}return{path:h,find:D=>{let C=b.get(D);return!C&&typeof D=="string"&&(C=b.get(D.toUpperCase())),C},count:E,examples:D=>{const C=[];if(b.size<1)C.push("no values found");else for(const P of b.keys())if(C.push(P),C.length>=D)break;return C}}}function c(h,d){let E;if(Array.isArray(d)){const b=d[0];if(b.latitude&&b.longitude&&(b.key||b.keys))return p(h,d)}else Array.isArray(d?.features)&&d?.type==="FeatureCollection"&&(E=o(d));if(!E)try{E=(0,s.Vc)(d)}catch(b){return{path:h,error:`${b}`,find:D=>{},examples:D=>[]}}return x(E,{path:h})}function x(h,d){const E=[];let b,D,C,P,M;for(const U of h.fields)if(U.type===i.PU.geo&&(b=U),!M&&U.type===i.PU.string&&(M=U),U.name){d.keys&&d.keys.includes(U.name)&&E.push(U);const W=U.name.toUpperCase();switch(W){case"LAT":case"LATITUTE":D=U;break;case"LON":case"LNG":case"LONG":case"LONGITUE":C=U;break;case"GEOHASH":P=U;break;case"ID":case"UID":case"KEY":case"CODE":d.keys||E.push(U);break;default:d.keys||(W.endsWith("_ID")||W.endsWith("_CODE"))&&E.push(U)}}!E.length&&M&&E.push(M);let O=!1;b?O=b.values[0]?.getType()==="Point":P?(b=(0,g.qy)(P),O=!0):D&&C&&(b=(0,g.Pz)(C,D),O=!0);const j=new Map;return E.forEach(U=>{U.values.forEach((W,B)=>{const S=`${W}`;j.set(S.toUpperCase(),B),j.set(S,B)})}),{path:d.path,find:U=>{const W=j.get(U);if(W!=null){const B=b?.values[W];return{frame:h,index:W,point:()=>!B||O?B:new a.A((0,n.q1)(B.getExtent())),geometry:()=>B}}},examples:U=>{const W=[];for(let B of j.keys())if(W.push(B),W.length>U)break;return W},frame:()=>h,count:h.length}}const v={},m="public/gazetteer/countries.json";async function y(h){h||(h=m);let d=v[h];if(!d){try{const E=await(0,r.AI)().get(h);d=c(h,E)}catch(E){console.warn("Error loading placename lookup",h,E),d={path:h,error:"Error loading URL",find:b=>{},examples:b=>[]}}v[h]=d}return d}},87039:(te,R,e)=>{"use strict";e.d(R,{FM:()=>v,nE:()=>c});var n=e(16515),a=e(95004),s=e(36638),i=e(57866),r=e(92745),u=e(739),o=e(98643),l=e(46189);function g(m){return y=>{for(const h of y.fields)if(m(h,y,[]))return h}}function f(m){return y=>{for(const h of y.fields){if(m.has(h.name.toLowerCase()))return h;const d=(0,n.Ct)(h,y);if(m.has(d))return h}}}const p={mode:u.aG.Auto,geohash:f(new Set(["geohash"])),latitude:f(new Set(["latitude","lat"])),longitude:f(new Set(["longitude","lon","lng"])),h3:f(new Set(["h3"])),wkt:f(new Set(["wkt"])),lookup:f(new Set(["lookup"])),geo:m=>m.fields.find(y=>y.type===a.PU.geo)};async function c(m){const y={...p,mode:m?.mode??u.aG.Auto};switch(y.gazetteer=await(0,l.q3)(m?.gazetteer),y.mode){case u.aG.Geohash:m?.geohash?y.geohash=g((0,s.NS)({id:i.Ct.byName,options:m.geohash})):y.geohash=()=>{};break;case u.aG.Lookup:const h=m?.lookup?.length?(0,s.NS)({id:i.Ct.byName,options:m.lookup}):(0,s.NS)({id:i.Ct.byType,options:a.PU.string});y.lookup=g(h);break;case u.aG.Coords:m?.latitude?y.latitude=g((0,s.NS)({id:i.Ct.byName,options:m.latitude})):y.latitude=()=>{},m?.longitude?y.longitude=g((0,s.NS)({id:i.Ct.byName,options:m.longitude})):y.longitude=()=>{};break}return y}function x(m,y){const h={mode:y.mode??u.aG.Auto};if(h.mode===u.aG.Auto){if(h.geo=y.geo(m),h.geo)return h;if(h.latitude=y.latitude(m),h.longitude=y.longitude(m),h.latitude&&h.longitude)return h.mode=u.aG.Coords,h;if(h.geohash=y.geohash(m),h.geohash)return h.mode=u.aG.Geohash,h;if(h.lookup=y.lookup(m),h.lookup)return h.mode=u.aG.Lookup,h}switch(h.mode){case u.aG.Coords:h.latitude=y.latitude(m),h.longitude=y.longitude(m);break;case u.aG.Geohash:h.geohash=y.geohash(m);break;case u.aG.Lookup:h.lookup=y.lookup(m);break}return h}function v(m,y){const h=x(m,y);switch(h.mode){case u.aG.Auto:return h.geo?{field:h.geo}:{warning:(0,r.t)("geo.get-geometry-field.warning-unable-to-find","Unable to find location fields")};case u.aG.Coords:return h.latitude&&h.longitude?{field:(0,o.Pz)(h.longitude,h.latitude),derived:!0,description:`${h.mode}: ${h.latitude.name}, ${h.longitude.name}`}:{warning:(0,r.t)("geo.get-geometry-field.warning-select-lat-long","Select latitude/longitude fields")};case u.aG.Geohash:return h.geohash?{field:(0,o.qy)(h.geohash),derived:!0,description:`${h.mode}`}:{warning:(0,r.t)("geo.get-geometry-field.warning-select-geohash","Select geohash field")};case u.aG.Lookup:return h.lookup?y.gazetteer?{field:(0,o.Dc)(y.gazetteer,h.lookup),derived:!0,description:`${h.mode}: ${y.gazetteer.path}`}:{warning:(0,r.t)("geo.get-geometry-field.warning-gazetteer-not-found","Gazetteer not found")}:{warning:(0,r.t)("geo.get-geometry-field.warning-select-lookup","Select lookup field")}}return{warning:(0,r.t)("geo.get-geometry-field.warning-no-geometry","unable to find geometry")}}},42836:(te,R,e)=>{"use strict";e.d(R,{q:()=>S});var n=e(74848),a=e(2543),s=e(96540),i=e(70713),r=e(64761),u=e(2197),o=e(60519),l=e(51898),g=e(92745),f=e(27489),p=e(2863),c=e(45861),x=e(68079),v=e(24343),m=e(65642),y=e(37234),h=e(16515),d=e(63142),E=e(32881),b=e(37386),D=e(18857),C=e(21285),P=e(85348),M=e(22803);const O=K=>(0,M.css)({padding:K.spacing(0,2),fontSize:K.typography.bodySmall.fontSize,color:K.colors.text.secondary,overflow:"hidden",textOverflow:"ellipsis"}),j=({children:K})=>{const T=(0,d.of)(O);return(0,n.jsx)("div",{className:T,children:K})};var U=e(89460);const W=({options:K,actions:T,formattedDataDescription:L,onOptionsChange:A,hasTransformations:N,data:V,dataFrames:z,transformationOptions:w,selectedDataFrame:H,onDataFrameChange:Q,downloadForExcel:Z,toggleDownloadForExcel:Y})=>{const X=(0,d.of)(U.A);let I=z;H===r.F.joinByField&&(I=V);const J=I.map((ne,se)=>({value:se,label:`${(0,h.Ri)(ne)} (${se})`})),ee=[...w,...J];function q(){let ne="";if(!V)return ne;const se=[];return H===r.F.joinByField?se.push((0,g.t)("dashboard.inspect-data.series-to-columns","Series joined by time")):V.length>1&&se.push((0,h.Ri)(V[H])),(K.withTransforms||K.withFieldConfig)&&(K.withTransforms&&se.push((0,g.t)("dashboard.inspect-data.panel-transforms","Panel transforms")),K.withTransforms&&K.withFieldConfig,K.withFieldConfig&&se.push((0,g.t)("dashboard.inspect-data.formatted","Formatted data"))),Z&&se.push((0,g.t)("dashboard.inspect-data.excel-header","Excel header")),se.join(", ")}return(0,n.jsx)("div",{className:X.dataDisplayOptions,children:(0,n.jsx)(P.u,{id:"Data options",index:0,title:(0,g.t)("dashboard.inspect-data.data-options","Data options"),headerElement:(0,n.jsx)(j,{children:q()}),isOpen:!1,actions:T,children:(0,n.jsx)("div",{className:X.options,"data-testid":"dataOptions",children:(0,n.jsxs)(E.gW,{spacing:"none",children:[V.length>1&&(0,n.jsx)(b.D,{label:(0,g.t)("dashboard.inspect-data.dataframe-label","Show data frame"),children:(0,n.jsx)(D.l6,{options:ee,value:H,onChange:Q,width:30,"aria-label":(0,g.t)("dashboard.inspect-data.dataframe-aria-label","Select dataframe")})}),(0,n.jsxs)(E.Gy,{children:[N&&A&&(0,n.jsx)(b.D,{label:(0,g.t)("dashboard.inspect-data.transformations-label","Apply panel transformations"),description:(0,g.t)("dashboard.inspect-data.transformations-description","Table data is displayed with transformations defined in the panel Transform tab."),children:(0,n.jsx)(C.d,{value:!!K.withTransforms,onChange:()=>A({...K,withTransforms:!K.withTransforms})})}),A&&(0,n.jsx)(b.D,{label:(0,g.t)("dashboard.inspect-data.formatted-data-label","Formatted data"),description:L||(0,g.t)("dashboard.inspect-data.formatted-data-description","Table data is formatted with options defined in the Field and Override tabs."),children:(0,n.jsx)(C.d,{id:"formatted-data-toggle",value:!!K.withFieldConfig,onChange:()=>A({...K,withFieldConfig:!K.withFieldConfig})})}),(0,n.jsx)(b.D,{label:(0,g.t)("dashboard.inspect-data.download-excel-label","Download for Excel"),description:(0,g.t)("dashboard.inspect-data.download-excel-description","Adds header to CSV for use with Excel"),children:(0,n.jsx)(C.d,{id:"excel-toggle",value:Z,onChange:Y})})]})]})})})})};var B=e(54334);class S extends s.PureComponent{constructor(T){super(T),this.onExportLogsAsTxt=()=>{const{data:L,dataName:A,app:N}=this.props;(0,f.rR)("grafana_logs_download_logs_clicked",{app:N,format:"logs",area:"inspector"});const V=(0,y.HT)(L||[]);(0,B.Zy)(V,A)},this.onExportTracesAsJson=()=>{const{data:L,dataName:A,app:N}=this.props;if(L)for(const V of L){if(V.meta?.preferredVisualisationType!=="trace")continue;const z=(0,B.ek)(V,A+"-traces");(0,f.rR)("grafana_traces_download_traces_clicked",{app:N,grafana_version:m.$W.buildInfo.version,trace_format:z,location:"inspector"})}},this.onExportServiceGraph=()=>{const{data:L,dataName:A,app:N}=this.props;(0,f.rR)("grafana_traces_download_service_graph_clicked",{app:N,grafana_version:m.$W.buildInfo.version,location:"inspector"}),L&&(0,B.ny)(L,A)},this.onDataFrameChange=L=>{this.setState({transformId:L.value===r.F.joinByField?r.F.joinByField:r.F.noop,dataFrameIndex:typeof L.value=="number"?L.value:0,selectedDataFrame:L.value})},this.onToggleDownloadForExcel=()=>{this.setState(L=>({downloadForExcel:!L.downloadForExcel}))},this.state={selectedDataFrame:0,dataFrameIndex:0,transformId:r.F.noop,transformationOptions:_(),transformedData:T.data??[],downloadForExcel:!1}}componentDidUpdate(T,L){if(!this.props.data){this.setState({transformedData:[]});return}if(this.props.options.withTransforms){this.setState({transformedData:this.props.data});return}if(T.data!==this.props.data||L.transformId!==this.state.transformId){const A=this.state.transformationOptions.find(N=>N.value===this.state.transformId);if(A&&A.transformer.id!==r.F.noop){const N=this.state.selectedDataFrame,V=this.state.dataFrameIndex,z=(0,u.m)([A.transformer],this.props.data).subscribe(w=>{this.setState({transformedData:w,selectedDataFrame:N,dataFrameIndex:V},()=>z.unsubscribe())});return}this.setState({transformedData:this.props.data});return}}exportCsv(T,L){const{dataName:A}=this.props,{transformId:N}=this.state,V=T[this.state.dataFrameIndex];L&&(0,f.rR)("grafana_logs_download_clicked",{app:this.props.app,format:"csv"}),(0,B.EM)(V,A,{useExcelHeader:this.state.downloadForExcel},N)}getProcessedData(){const{options:T,panelPluginId:L,fieldConfig:A,timeZone:N}=this.props,V=this.state.transformedData;if(!T.withFieldConfig)return(0,o.K3)(V);let z=A??{defaults:{},overrides:[]};return L==="table"&&A&&(z=this.cleanTableConfigFromFieldConfig(A)),(0,o.we)({data:V,theme:m.$W.theme2,fieldConfig:z,timeZone:N,replaceVariables:(w,H,Q)=>(0,p.w)().replace(w,H,Q)})}cleanTableConfigFromFieldConfig(T){T=(0,a.cloneDeep)(T),T.defaults.custom={};for(const L of T.overrides)for(const A of L.properties)if(A.id.startsWith("custom.")){const N=L.properties.indexOf(A);L.properties.slice(N,1)}return T}renderActions(T,L,A,N){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.$n,{variant:"primary",onClick:()=>this.exportCsv(T,L),size:"sm",children:(0,n.jsx)(g.x6,{i18nKey:"dashboard.inspect-data.download-csv",children:"Download CSV"})}),L&&!m.$W.exploreHideLogsDownload&&(0,n.jsx)(c.$n,{variant:"primary",onClick:this.onExportLogsAsTxt,size:"sm",children:(0,n.jsx)(g.x6,{i18nKey:"dashboard.inspect-data.download-logs",children:"Download logs"})}),A&&(0,n.jsx)(c.$n,{variant:"primary",onClick:this.onExportTracesAsJson,size:"sm",children:(0,n.jsx)(g.x6,{i18nKey:"dashboard.inspect-data.download-traces",children:"Download traces"})}),N&&(0,n.jsx)(c.$n,{variant:"primary",onClick:this.onExportServiceGraph,size:"sm",children:(0,n.jsx)(g.x6,{i18nKey:"dashboard.inspect-data.download-service",children:"Download service graph"})})]})}render(){const{isLoading:T,options:L,data:A,formattedDataDescription:N,onOptionsChange:V,hasTransformations:z}=this.props,{dataFrameIndex:w,transformationOptions:H,selectedDataFrame:Q,downloadForExcel:Z}=this.state,Y=(0,U.c)();if(T)return(0,n.jsxs)("div",{children:[(0,n.jsx)(x.y,{inline:!0})," ",(0,n.jsx)(g.x6,{i18nKey:"inspector.inspect-data-tab.loading",children:"Loading"})]});const X=this.getProcessedData();if(!X||!X.length)return(0,n.jsx)("div",{children:(0,n.jsx)(g.x6,{i18nKey:"inspector.inspect-data-tab.no-data",children:"No data"})});const I=X[w]?w:0,J=X[I],ee=X.some(se=>se?.meta?.preferredVisualisationType==="logs"),q=X.some(se=>se?.meta?.preferredVisualisationType==="trace"),ne=X.some(se=>se?.meta?.preferredVisualisationType==="nodeGraph");return(0,n.jsxs)("div",{className:Y.wrap,"aria-label":l.Tp.components.PanelInspector.Data.content,children:[(0,n.jsx)("div",{className:Y.toolbar,children:(0,n.jsx)(W,{data:A,hasTransformations:z,options:L,dataFrames:X,transformationOptions:H,selectedDataFrame:Q,downloadForExcel:Z,formattedDataDescription:N,onOptionsChange:V,onDataFrameChange:this.onDataFrameChange,toggleDownloadForExcel:this.onToggleDownloadForExcel,actions:this.renderActions(X,ee,q,ne)})}),(0,n.jsx)("div",{className:Y.content,children:(0,n.jsx)(i.Ay,{children:({width:se,height:oe})=>se===0?null:(0,n.jsx)(v.X,{width:se,height:oe,data:J,showTypeIcons:!0})})})]})}}function _(){return[{value:r.F.joinByField,label:(0,g.t)("dashboard.inspect-data.transformation","Series joined by time"),transformer:{id:r.F.joinByField,options:{byField:void 0}}}]}},55072:(te,R,e)=>{"use strict";e.d(R,{N:()=>v});var n=e(74848),a=e(22803),s=e(51898),i=e(92745),r=e(11576),u=e(95004),o=e(55386),l=e(63142);const g=({timeZone:y,name:h,stats:d})=>{const E=(0,l.$j)(),b=(0,l.of)(p);return!d||!d.length?null:(0,n.jsxs)("div",{className:b.wrapper,children:[(0,n.jsx)("div",{className:b.heading,children:h}),(0,n.jsx)("table",{className:"filter-table width-30",children:(0,n.jsx)("tbody",{children:d.map((D,C)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:D.displayName}),(0,n.jsx)("td",{className:b.cell,children:f(D,y,E)})]},`${D.displayName}-${C}`))})})]})};function f(y,h,d){const E=(0,r.J)({field:{type:u.PU.number,config:y},theme:d,timeZone:h});return(0,o.cN)(E(y.value))}const p=y=>({heading:(0,a.css)({fontSize:y.typography.body.fontSize,marginBottom:y.spacing(1)}),wrapper:(0,a.css)({paddingBottom:y.spacing(2)}),cell:(0,a.css)({textAlign:"right"})}),c=({name:y,traceIds:h})=>{const d=(0,l.of)(x);return h.length===0?null:(0,n.jsxs)("div",{className:d.wrapper,children:[(0,n.jsx)("div",{className:d.heading,children:y}),(0,n.jsx)("table",{className:"filter-table width-30",children:(0,n.jsx)("tbody",{children:h.map((E,b)=>(0,n.jsx)("tr",{children:(0,n.jsx)("td",{children:E})},`${E}-${b}`))})})]})},x=y=>({heading:(0,a.css)({fontSize:y.typography.body.fontSize,marginBottom:y.spacing(1)}),wrapper:(0,a.css)({paddingBottom:y.spacing(2)}),cell:(0,a.css)({textAlign:"right"})}),v=({data:y,timeZone:h})=>{if(!y.request)return null;let d=[];const E=y.request.endTime?y.request.endTime-y.request.startTime:-1,b=y.timings?.dataProcessingTime||-1;let D=0;for(const j of y.series)D+=j.length;E>0&&d.push({displayName:(0,i.t)("dashboard.inspect-stats.request-time","Total request time"),value:E,unit:"ms"}),b>0&&d.push({displayName:(0,i.t)("dashboard.inspect-stats.processing-time","Data processing time"),value:b,unit:"ms"}),d.push({displayName:(0,i.t)("dashboard.inspect-stats.queries","Number of queries"),value:y.request.targets?.length??0}),d.push({displayName:(0,i.t)("dashboard.inspect-stats.rows","Total number rows"),value:D});let C=[];for(const j of y.series)j.meta&&j.meta.stats&&(C=C.concat(j.meta.stats));const P=(0,i.t)("dashboard.inspect-stats.table-title","Stats"),M=(0,i.t)("dashboard.inspect-stats.data-title","Data source stats"),O=(0,i.t)("dashboard.inspect-stats.data-traceids","Trace IDs");return(0,n.jsxs)("div",{"aria-label":s.Tp.components.PanelInspector.Stats.content,className:m,children:[(0,n.jsx)(g,{timeZone:h,name:P,stats:d}),(0,n.jsx)(g,{timeZone:h,name:M,stats:C}),(0,n.jsx)(c,{name:O,traceIds:y.traceIds??[]})]})},m=(0,a.css)({height:"100%",overflowY:"scroll"})},96065:(te,R,e)=>{"use strict";e.d(R,{e:()=>h});var n=e(74848),a=e(22803),s=e(96540),i=e(64423),r=e(28105),u=e(51898),o=e(92745),l=e(43173),g=e(41654),f=e(45861),p=e(47931),c=e(35137),x=e(6975),v=e(50275),m=e(83873),y=e(89460);class h extends s.PureComponent{constructor(E){super(E),this.subs=new i.yU,this.setFormattedJson=b=>{this.formattedJson=b},this.getTextForClipboard=()=>JSON.stringify(this.formattedJson,null,2),this.onToggleExpand=()=>{this.setState(b=>({...b,allNodesExpanded:!this.state.allNodesExpanded}))},this.onToggleMocking=()=>{this.setState(b=>({...b,isMocking:!this.state.isMocking}))},this.getNrOfOpenNodes=()=>this.state.allNodesExpanded===null?3:this.state.allNodesExpanded?20:1,this.state={executedQueries:[],allNodesExpanded:null,isMocking:!1,mockedResponse:"",response:{}}}componentDidMount(){this.subs.add(m.IB.getInspectorStream().subscribe({next:E=>{let b=!0;if(this.props.instanceId&&E?.requestId&&(b=E.requestId.startsWith(this.props.instanceId)),b)return this.onDataSourceResponse(E.response)}}))}componentDidUpdate(E){this.props.data!==E.data&&this.updateQueryList()}updateQueryList(){const{data:E}=this.props,b=E.series,D=[];if(b?.length){let C;b.forEach((P,M)=>{const O=P.meta?.executedQueryString;if(O){const j=P.refId||"?";C?.refId===j?(C.frames++,C.rows+=P.length):(C={refId:j,frames:0,rows:P.length,query:O},D.push(C))}})}this.setState({executedQueries:D})}componentWillUnmount(){this.subs.unsubscribe()}onDataSourceResponse(E){E.config?.hideFromInspector||(E={...E},E.headers&&delete E.headers,E.config&&(E.request=E.config,delete E.config,delete E.request.transformRequest,delete E.request.transformResponse,delete E.request.paramSerializer,delete E.request.jsonpCallbackParam,delete E.request.headers,delete E.request.requestId,delete E.request.inspect,delete E.request.retry,delete E.request.timeout),E.data&&(E.response=E.data,delete E.config,delete E.data,delete E.status,delete E.statusText,delete E.ok,delete E.url,delete E.redirected,delete E.type,delete E.$$config),this.setState({response:E}))}renderExecutedQueries(E){if(!E.length)return null;const b={refId:(0,a.css)({fontWeight:l.$.theme.typography.weight.semibold,color:l.$.theme.colors.textBlue,marginRight:"8px"})};return(0,n.jsx)("div",{children:E.map(D=>(0,n.jsxs)(g.B,{gap:1,direction:"column",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("span",{className:b.refId,children:[D.refId,":"]}),D.frames>1&&(0,n.jsx)("span",{children:(0,n.jsxs)(o.x6,{i18nKey:"inspector.query-inspector.count-frames",count:D.frames,children:["{{count}}"," frames,"," "]})}),(0,n.jsx)("span",{children:(0,n.jsxs)(o.x6,{i18nKey:"inspector.query-inspector.count-rows",count:D.rows,children:["{{count}}"," rows"]})})]}),(0,n.jsx)("pre",{children:D.query})]},D.refId))})}render(){const{allNodesExpanded:E,executedQueries:b,response:D}=this.state,{onRefreshQuery:C,data:P}=this.props,M=this.getNrOfOpenNodes(),O=(0,y.A)(l.$.theme2),j=Object.keys(D).length>0,U=P.state===r.Gu.Loading;return(0,n.jsxs)("div",{className:O.wrap,children:[(0,n.jsxs)("div",{"aria-label":u.Tp.components.PanelInspector.Query.content,children:[(0,n.jsx)("h3",{className:O.heading,children:(0,n.jsx)(o.x6,{i18nKey:"inspector.query-inspector.query-inspector",children:"Query inspector"})}),(0,n.jsx)("p",{className:"small muted",children:(0,n.jsx)(o.x6,{i18nKey:"inspector.query.description",children:"Query inspector allows you to view raw request and response. To collect this data Grafana needs to issue a new query. Click refresh button below to trigger a new query."})})]}),this.renderExecutedQueries(b),(0,n.jsxs)(g.B,{direction:"row",gap:2,justifyContent:"flex-start",wrap:!0,children:[(0,n.jsx)(f.$n,{icon:"sync",onClick:C,"aria-label":u.Tp.components.PanelInspector.Query.refreshButton,children:(0,n.jsx)(o.x6,{i18nKey:"inspector.query.refresh",children:"Refresh"})}),j&&E&&(0,n.jsx)(f.$n,{icon:"minus",variant:"secondary",onClick:this.onToggleExpand,children:(0,n.jsx)(o.x6,{i18nKey:"inspector.query.collapse-all",children:"Collapse all"})}),j&&!E&&(0,n.jsx)(f.$n,{icon:"plus",variant:"secondary",onClick:this.onToggleExpand,children:(0,n.jsx)(o.x6,{i18nKey:"inspector.query.expand-all",children:"Expand all"})}),j&&(0,n.jsx)(p.b,{getText:this.getTextForClipboard,icon:"copy",variant:"secondary",children:(0,n.jsx)(o.x6,{i18nKey:"inspector.query.copy-to-clipboard",children:"Copy to clipboard"})})]}),(0,n.jsx)(c.$,{v:2}),(0,n.jsxs)("div",{className:O.content,children:[U&&(0,n.jsx)(x._,{text:(0,o.t)("inspector.query-inspector.text-loading-query-inspector","Loading query inspector...")}),!U&&j&&(0,n.jsx)(v.B,{json:D,open:M,onDidRender:this.setFormattedJson}),!U&&!j&&(0,n.jsx)("p",{className:"muted",children:(0,n.jsx)(o.x6,{i18nKey:"inspector.query.no-data",children:"No request and response collected yet. Hit refresh button"})})]})]})}}},89460:(te,R,e)=>{"use strict";e.d(R,{A:()=>r,c:()=>i});var n=e(22803),a=e(65240),s=e(65642);const i=(0,a.N)(()=>r(s.$W.theme2)),r=u=>({heading:(0,n.css)({fontSize:u.typography.body.fontSize,marginBottom:u.spacing(1)}),wrap:(0,n.css)({display:"flex",flexDirection:"column",height:"100%",width:"100%",flex:"1 1 0",minHeight:0}),toolbar:(0,n.css)({display:"flex",width:"100%",flexGrow:0,alignItems:"center",justifyContent:"flex-end",marginBottom:u.v1.spacing.sm}),toolbarItem:(0,n.css)({marginLeft:u.v1.spacing.md}),content:(0,n.css)({flexGrow:1,height:"100%"}),editor:(0,n.css)({fontFamily:"monospace",height:"100%",flexGrow:1}),viewer:(0,n.css)({overflow:"scroll"}),dataFrameSelect:(0,n.css)({flexGrow:2}),leftActions:(0,n.css)({display:"flex",flexGrow:1,maxWidth:"85%","@media (max-width: 1345px)":{maxWidth:"75%"}}),options:(0,n.css)({paddingTop:u.v1.spacing.sm}),dataDisplayOptions:(0,n.css)({flexGrow:1,minWidth:"300px",marginRight:u.v1.spacing.sm}),selects:(0,n.css)({display:"flex","> *":{marginRight:u.v1.spacing.sm}})})},26689:(te,R,e)=>{"use strict";e.d(R,{q:()=>n});var n=(a=>(a.Data="data",a.Meta="meta",a.Error="error",a.Stats="stats",a.JSON="json",a.Query="query",a.Help="help",a))(n||{})},54334:(te,R,e)=>{"use strict";e.d(R,{ny:()=>T,EM:()=>K,Zy:()=>_,ek:()=>L});var n=e(4213),a=e.n(n),s=e(25229),i=e(80011),r=e(64761),u=e(68125),o=e(18700),l=e(25192),g=e(2543);const p=Object.defineProperty({archiveEnabled:!1,dependencies:{dagMaxNumServices:100,menuEnabled:!0},linkPatterns:[],search:{maxLookback:{label:"2 Days",value:"2d"},maxLimit:1500},tracking:{gaID:null,trackErrors:!0}},"__mergeFields",{value:["dependencies","search","tracking"]});function c(){return defaultConfig}function x(A){return _get(c(),A)}function v(A){let N;const V=new Set(A.map(({spanID:z})=>z));for(let z=0;z<A.length;z++){if(A[z].references&&A[z].references.some(({traceID:Z,spanID:Y})=>Z===A[z].traceID&&V.has(Y)))continue;if(!N){N=A[z];continue}const H=A[z].references&&A[z].references.length||0,Q=N.references&&N.references.length||0;(H<Q||H===Q&&A[z].startTime<N.startTime)&&(N=A[z])}return N?`${N.process.serviceName}: ${N.operationName}`:""}const m=(0,g.memoize)(v,A=>A.length?A[0].traceID:0);function y(A){const N=new Map,V=A.reduce((w,H)=>(w.some(Q=>Q.key===H.key&&Q.value===H.value)?N.set(`${H.key}:${H.value}`,`Duplicate tag "${H.key}:${H.value}"`):w.push(H),w),[]),z=Array.from(N.values());return{dedupedTags:V,warnings:z}}function h(A,N){const V=A?.slice()??[],z=(N||[]).map(w=>w.toLowerCase());return V.sort((w,H)=>{const Q=w.key.toLowerCase(),Z=H.key.toLowerCase();for(let Y=0;Y<z.length;Y++){const X=z[Y];if(Q.startsWith(X)&&!Z.startsWith(X))return-1;if(!Q.startsWith(X)&&Z.startsWith(X))return 1}return Q>Z?1:Q<Z?-1:0}),V}function d(A){if(!A?.traceID)return null;const N=A.traceID.toLowerCase();let V=0,z=Number.MAX_SAFE_INTEGER;const w=new Map,H=new Map;A.spans=A.spans.filter(ee=>!!ee.startTime),A.processes=Object.entries(A.processes).reduce((ee,[q,ne])=>(ee[q]={...ne,tags:h(ne.tags)},ee),{});const Q=A.spans.length;for(let ee=0;ee<Q;ee++){const q=A.spans[ee],{startTime:ne,duration:se,processID:oe}=q;let de=q.spanID;ne<z&&(z=ne),ne+se>V&&(V=ne+se);const fe=w.get(de);fe!=null?(console.warn(`Dupe spanID, ${fe+1} x ${de}`,q,H.get(de)),_isEqual(q,H.get(de))&&console.warn("	 two spans with same ID have `isEqual(...) === true`"),w.set(de,fe+1),de=`${de}_${fe}`,q.spanID=de):w.set(de,1),q.process=A.processes[oe],H.set(de,q)}const Z=getTraceSpanIdsAsTree(A,H),Y=[],X={};Z.walk((ee,q,ne=0)=>{if(ee==="__root__"||typeof ee!="string")return;const se=H.get(ee);if(!se)return;const{serviceName:oe}=se.process;X[oe]=(X[oe]||0)+1,se.relativeStartTime=se.startTime-z,se.depth=ne-1,se.hasChildren=q.children.length>0,se.childSpanCount=q.children.length,se.warnings=se.warnings||[],se.tags=se.tags||[],se.references=se.references||[],se.childSpanIds=q.children.slice().sort((fe,ae)=>{const ce=H.get(fe.value),ie=H.get(ae.value);return ie.startTime+ie.duration-(ce.startTime+ce.duration)}).map(fe=>fe.value);const de=y(se.tags);se.tags=h(de.dedupedTags,getConfigValue("topTagPrefixes")),se.warnings=se.warnings.concat(de.warnings),se.references.forEach((fe,ae)=>{const ce=H.get(fe.spanID);ce&&(fe.span=ce,ae>0&&(ce.subsidiarilyReferencedBy=ce.subsidiarilyReferencedBy||[],ce.subsidiarilyReferencedBy.push({spanID:ee,traceID:N,span:se,refType:fe.refType})))}),Y.push(se)});const I=getTraceName(Y);return{services:Object.keys(X).map(ee=>({name:ee,numberOfSpans:X[ee]})),spans:Y,traceID:N,traceName:I,processes:A.processes,duration:V-z,startTime:z,endTime:V}}function E(A){const N=A.spans.map(z=>b(z,A.processes)),V=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string},{name:"spanID",type:FieldType.string},{name:"parentSpanID",type:FieldType.string},{name:"operationName",type:FieldType.string},{name:"serviceName",type:FieldType.string},{name:"serviceTags",type:FieldType.other},{name:"startTime",type:FieldType.number},{name:"duration",type:FieldType.number},{name:"logs",type:FieldType.other},{name:"references",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other},{name:"warnings",type:FieldType.other},{name:"stackTraces",type:FieldType.other}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"jaeger"}}});for(const z of N)V.add(z);return V}function b(A,N){const V=A.references?.find(z=>z.refType==="CHILD_OF")?.spanID;return{spanID:A.spanID,traceID:A.traceID,parentSpanID:V,operationName:A.operationName,startTime:A.startTime/1e3,duration:A.duration/1e3,logs:A.logs.map(z=>({...z,timestamp:z.timestamp/1e3})),tags:A.tags,warnings:A.warnings??void 0,stackTraces:A.stackTraces,references:A.references?.filter(z=>z.spanID!==V)??[],serviceName:N[A.processID].serviceName,serviceTags:N[A.processID].tags}}function D(A,N){const V=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Trace ID",links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:N.uid,datasourceName:N.name,query:{query:"${__value.raw}"}}}]}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Trace name"}},{name:"startTime",type:FieldType.time,config:{displayNameFromDS:"Start time"}},{name:"duration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"\xB5s"}}],meta:{preferredVisualisationType:"table"}}),z=A.map(C).sort((w,H)=>H?.startTime-w?.startTime);for(const w of z)V.add(w);return V}function C(A){const N=transformTraceData(A);if(N)return{traceID:N.traceID,startTime:N.startTime/1e3,duration:N.duration,traceName:N.traceName}}function P(A){let N={traceID:"",spans:[],processes:{},warnings:null},V=[];for(let z=0;z<A.length;z++){const w=A.get(z);N.traceID||(N.traceID=w.traceID),V.find(H=>H===w.serviceName)||(V.push(w.serviceName),N.processes[`p${V.length}`]={serviceName:w.serviceName,tags:w.serviceTags}),N.spans.push({traceID:w.traceID,spanID:w.spanID,duration:w.duration*1e3,references:w.parentSpanID?[{refType:"CHILD_OF",spanID:w.parentSpanID,traceID:w.traceID}]:[],flags:0,logs:w.logs.map(H=>({...H,timestamp:H.timestamp*1e3})),operationName:w.operationName,processID:Object.keys(N.processes).find(H=>N.processes[H].serviceName===w.serviceName)||"",startTime:w.startTime*1e3,tags:w.tags,warnings:w.warnings?w.warnings:null})}return{data:[N],total:0,limit:0,offset:0,errors:null}}function M(A){const N=A.map(O),V=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,values:[]},{name:"spanID",type:FieldType.string,values:[]},{name:"parentSpanID",type:FieldType.string,values:[]},{name:"operationName",type:FieldType.string,values:[]},{name:"serviceName",type:FieldType.string,values:[]},{name:"serviceTags",type:FieldType.other,values:[]},{name:"startTime",type:FieldType.number,values:[]},{name:"duration",type:FieldType.number,values:[]},{name:"logs",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"zipkin"}}});for(const z of N)V.add(z);return V}function O(A){const N={traceID:A.traceId,spanID:A.id,parentSpanID:A.parentId,operationName:A.name,serviceName:A.localEndpoint?.serviceName||A.remoteEndpoint?.serviceName||"unknown",serviceTags:U(A),startTime:A.timestamp/1e3,duration:A.duration/1e3,logs:A.annotations?.map(j)??[],tags:Object.keys(A.tags||{}).reduce((V,z)=>z==="error"?(V.push({key:"error",value:!0}),V.push({key:"errorValue",value:A.tags.error}),V):(V.push({key:z,value:A.tags[z]}),V),[])};return A.kind&&(N.tags=[{key:"kind",value:A.kind},...N.tags??[]]),A.shared&&(N.tags=[{key:"shared",value:A.shared},...N.tags??[]]),N}function j(A){return{timestamp:A.timestamp,fields:[{key:"annotation",value:A.value}]}}function U(A){const N=A.localEndpoint||A.remoteEndpoint;return N?[W("ipv4",N.ipv4),W("ipv6",N.ipv6),W("port",N.port),W("endpointType",A.localEndpoint?"local":"remote")].filter(V=>!!V):[]}function W(A,N){if(N)return{key:A,value:N}}const B=A=>{let N=[];for(let V=0;V<A.length;V++){const z=A.get(V);N.push({traceId:z.traceID,parentId:z.parentSpanID,name:z.operationName,id:z.spanID,timestamp:z.startTime*1e3,duration:z.duration*1e3,...S(z),annotations:z.logs.length?z.logs.map(w=>({timestamp:w.timestamp,value:w.fields[0].value})):void 0,tags:z.tags.length?z.tags.filter(w=>w.key!=="kind"&&w.key!=="endpointType"&&w.key!=="shared").reduce((w,H)=>H.key==="error"?{...w,[H.key]:z.tags.find(Q=>Q.key==="errorValue").value||""}:{...w,[H.key]:H.value},{}):void 0,kind:z.tags.find(w=>w.key==="kind")?.value,shared:z.tags.find(w=>w.key==="shared")?.value})}return N},S=A=>{const N=A.serviceTags.find(V=>V.key==="endpointType")?.value==="local"?"localEndpoint":"remoteEndpoint";return A.serviceName!=="unknown"?{[N]:{serviceName:A.serviceName,ipv4:A.serviceTags.find(V=>V.key==="ipv4")?.value,ipv6:A.serviceTags.find(V=>V.key==="ipv6")?.value,port:A.serviceTags.find(V=>V.key==="port")?.value}}:void 0};function _(A,N=""){let V="";A.meta?.forEach(H=>{const Q=`${H.label}: ${JSON.stringify(H.value)}
`;V=V+Q}),V=V+`

`,A.rows.forEach(H=>{const Q=H.timeEpochMs+"	"+(0,s.KQ)(H.timeEpochMs).toISOString()+"	"+H.entry+`
`;V=V+Q});const z=new Blob([V],{type:"text/plain;charset=utf-8"}),w=`${N?`${N}-logs`:"Logs"}-${(0,i.LE)(new Date)}.txt`;a()(z,w)}function K(A,N,V,z=r.F.noop){const w=(0,u._O)([A],V),H=V?.useExcelHeader?"\uFEFF":"",Q=new Blob([H,w],{type:"text/csv;charset=utf-8"}),Z=z!==r.F.noop?"-as-"+z.toLocaleLowerCase():"",Y=`${N}-data${Z}-${(0,i.LE)(new Date)}.csv`;a()(Q,Y)}function T(A,N){const V=new Blob([JSON.stringify(A)],{type:"application/json"}),z=`${N}-${(0,i.LE)(new Date)}.json`;a()(V,z)}function L(A,N){let V="otlp";switch(A.meta?.custom?.traceFormat){case"jaeger":{let z=P(new o.k(A));T(z,N),V="jaeger";break}case"zipkin":{let z=B(new o.k(A));T(z,N),V="zipkin";break}case"otlp":default:{let z=(0,l.xw)(new o.k(A));T(z,N);break}}return V}},8419:(te,R,e)=>{"use strict";e.d(R,{p:()=>s});var n=e(32899),a=e(45229);function s(r){let u="";try{u=JSON.stringify(r,i(),2)}catch(o){o instanceof Error&&(o.toString().includes("RangeError")||o.toString().includes("allocation size overflow"))?a.A.emit(n.r1.alertError,[o.toString(),"Cannot display JSON, the object is too big."]):a.A.emit(n.r1.alertError,[o instanceof Error?o.toString():o])}return u}function i(){const r=new WeakSet;return(u,o)=>{if(u==="__dataContext"||u==="__sceneObject")return"Filtered out in JSON serialization";if(typeof o=="object"&&o!==null){if(r.has(o))return;r.add(o)}return o}}},61666:(te,R,e)=>{"use strict";e.d(R,{G7:()=>r,KU:()=>u,eb:()=>o});var n=e(68143),a=e(73427),s=e(11257),i=e(52763);const r=(0,i.zD)("users/fetchInvitees",async()=>a.TP.hasPermission(s.w.OrgUsersAdd)?await(0,n.AI)().get("/api/org/invites"):[]),u=(0,i.zD)("users/addInvitee",async(l,{dispatch:g})=>{await(0,n.AI)().post("/api/org/invites",l),await g(r())}),o=(0,i.zD)("users/revokeInvite",async l=>(await(0,n.AI)().patch(`/api/org/invites/${l}/revoke`,{}),l))},38748:(te,R,e)=>{"use strict";e.d(R,{Ay:()=>l,Tp:()=>i});var n=e(65307),a=e(61666);const s=(0,n.pU)({selectId:g=>g.code}),i=s.getSelectors(),r=s.getInitialState({status:"idle"}),l={invites:(0,n.Z0)({name:"invites",initialState:r,reducers:{},extraReducers:g=>{g.addCase(a.G7.pending,f=>{f.status="loading"}).addCase(a.G7.fulfilled,(f,{payload:p})=>{s.setAll(f,p),f.status="succeeded"}).addCase(a.G7.rejected,f=>{f.status="failed"}).addCase(a.eb.fulfilled,(f,{payload:p})=>{s.removeOne(f,p),f.status="succeeded"})}}).reducer}},43652:(te,R,e)=>{"use strict";e.d(R,{b:()=>y,o:()=>h});var n=e(74848),a=e(96540),s=e(40996),i=e(16817),r=e(92745),u=e(68143),o=e(43173),l=e(37386),g=e(63527),f=e(41654),p=e(45861),c=e(22787),x=e(91156),v=e(30124),m=e(12048);const y=({panel:d,initialFolderUid:E,onCreateLibraryPanel:b,onDismiss:D})=>{const[C,P]=(0,a.useState)(E),[M,O]=(0,a.useState)(d.title),[j,U]=(0,a.useState)(d.title),[W,B]=(0,a.useState)(!1);(0,a.useEffect)(()=>B(!0),[M]),(0,s.A)(()=>U(M),350,[M]);const{saveLibraryPanel:S}=(0,m.b)(),_=(0,a.useCallback)(()=>{d.libraryPanel={uid:"",name:M},S(d,C).then(L=>{(0,u.NF)(L)?d.libraryPanel=void 0:(D?.(),b?.(L))})},[d,M,S,C,D,b]),K=(0,i.A)(async()=>{try{return!(await(0,v.e9)(M)).some(L=>L.folderUid===C)}catch(L){return(0,u.NF)(L)&&(L.isHandled=!0),!0}finally{B(!1)}},[j,C]),T=!K?.value&&K.value!==void 0&&M===j&&!W;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.D,{label:(0,r.t)("library-panel.add-modal.name","Library panel name"),invalid:T,error:T?(0,r.t)("library-panel.add-modal.error","Library panel with this name already exists"):"",children:(0,n.jsx)(g.p,{id:"share-panel-library-panel-name-input",name:"name",value:M,onChange:L=>O(L.currentTarget.value)})}),(0,n.jsx)(l.D,{label:(0,r.t)("library-panel.add-modal.folder","Save in folder"),description:(0,r.t)("library-panel.add-modal.folder-description","Library panel permissions are derived from the folder permissions"),children:(0,n.jsx)(x.d,{onChange:L=>P(L),value:C})}),o.$.featureToggles.newDashboardSharingComponent?(0,n.jsxs)(f.B,{gap:1,justifyContent:"start",children:[(0,n.jsx)(p.$n,{onClick:_,disabled:T,children:(0,n.jsx)(r.x6,{i18nKey:"share-panel.new-library-panel.create-button",children:"Create library panel"})}),(0,n.jsx)(p.$n,{variant:"secondary",onClick:D,fill:"outline",children:(0,n.jsx)(r.x6,{i18nKey:"share-panel.new-library-panel.cancel-button",children:"Cancel"})})]}):(0,n.jsxs)(c.a.ButtonRow,{children:[(0,n.jsx)(p.$n,{variant:"secondary",onClick:D,fill:"outline",children:(0,n.jsx)(r.x6,{i18nKey:"library-panel.add-modal.cancel",children:"Cancel"})}),(0,n.jsx)(p.$n,{onClick:_,disabled:T,children:(0,n.jsx)(r.x6,{i18nKey:"library-panel.add-modal.create",children:"Create library panel"})})]})]})},h=({isOpen:d=!1,panel:E,initialFolderUid:b,...D})=>(0,n.jsx)(c.a,{title:(0,r.t)("library-panels.add-library-panel-modal.title-create-library-panel","Create library panel"),isOpen:d,onDismiss:D.onDismiss,children:(0,n.jsx)(y,{panel:E,initialFolderUid:b,onDismiss:D.onDismiss})})},70905:(te,R,e)=>{"use strict";e.d(R,{E:()=>S});var n=e(74848),a=e(22803),s=e(96540),i=e(70255),r=e(92745),u=e(43173),o=e(63142),l=e(30703),g=e(20941),f=e(21348),p=e(41097),c=e(54044),x=e(28105),v=e(22787),m=e(45861),y=e(37666),h=e(55290),d=e(30124),E=e(65307);const b={loadingState:x.Gu.Loading,dashboardTitles:[]},D=(0,E.VP)("libraryPanels/delete/searchCompleted"),C=(T=b,L)=>D.match(L)?{...T,dashboardTitles:L.payload.dashboards.map(A=>A.title),loadingState:x.Gu.Done}:T;function P(T){return async function(L){const A=await(0,d.xV)(T.uid);L(D({dashboards:A}))}}const M=({libraryPanel:T,onDismiss:L,onConfirm:A})=>{const N=(0,o.of)(y.o),[{dashboardTitles:V,loadingState:z},w]=(0,s.useReducer)(C,b),H=(0,s.useMemo)(()=>(0,h.QC)(w),[w]);(0,s.useEffect)(()=>{H(P(T))},[H,T]);const Q=!!V.length,Z=z===x.Gu.Done;return(0,n.jsxs)(v.a,{className:N.modal,title:(0,r.t)("library-panels.delete-library-panel-modal.title-delete-library-panel","Delete library panel"),icon:"trash-alt",onDismiss:L,isOpen:!0,children:[Z?null:(0,n.jsx)(O,{}),Z?(0,n.jsxs)("div",{children:[Q?(0,n.jsx)(U,{dashboardTitles:V}):null,Q?null:(0,n.jsx)(j,{}),(0,n.jsxs)(v.a.ButtonRow,{children:[(0,n.jsx)(m.$n,{variant:"secondary",onClick:L,fill:"outline",children:(0,n.jsx)(r.x6,{i18nKey:"library-panels.delete-library-panel-modal.cancel",children:"Cancel"})}),(0,n.jsx)(m.$n,{variant:"destructive",onClick:A,disabled:Q,children:(0,n.jsx)(r.x6,{i18nKey:"library-panels.delete-library-panel-modal.delete",children:"Delete"})})]})]}):null]})},O=()=>(0,n.jsx)("span",{children:(0,n.jsx)(r.x6,{i18nKey:"library-panels.loading-indicator.loading-library-panel",children:"Loading library panel..."})}),j=()=>{const T=(0,o.of)(y.o);return(0,n.jsx)("div",{className:T.modalText,children:(0,n.jsx)(r.x6,{i18nKey:"library-panels.confirm.delete-panel",children:"Do you want to delete this panel?"})})},U=({dashboardTitles:T})=>{const L=(0,o.of)(y.o),A=T.length===1?"dashboard.":"dashboards.",N=`${T.length} ${A}`;return T.length===0?null:(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:L.textInfo,children:["This library panel can not be deleted because it is connected to ",(0,n.jsx)("strong",{children:N})," Remove the library panel from the dashboards listed below and retry."]}),(0,n.jsxs)("table",{className:L.myTable,children:[(0,n.jsx)("thead",{children:(0,n.jsx)("tr",{children:(0,n.jsx)("th",{children:(0,n.jsx)(r.x6,{i18nKey:"library-panels.has-connected-dashboards.dashboard-name",children:"Dashboard name"})})})}),(0,n.jsx)("tbody",{children:T.map((V,z)=>(0,n.jsx)("tr",{children:(0,n.jsx)("td",{children:V})},`dash-title-${z}`))})]})]})},W=({libraryPanel:T,onClick:L,onDelete:A,showSecondaryActions:N})=>{const[V,z]=(0,s.useState)(!1),w=()=>{A?.(T),z(!1)},H=u.$.panels[T.model.type]??(0,p.$)(T.model.type).meta;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.b,{isCurrent:!1,title:T.name,description:T.description,plugin:H,onClick:()=>L?.(T),onDelete:N?()=>z(!0):void 0,children:(0,n.jsx)(_,{libraryPanel:T})}),V&&(0,n.jsx)(M,{libraryPanel:T,onConfirm:w,onDismiss:()=>z(!1)})]})},B=({showSecondaryActions:T,rootProps:L})=>{const A=(0,o.of)(K);return(0,n.jsx)(c.b.Skeleton,{hasDelete:T,...L,children:(0,n.jsx)(i.A,{containerClassName:A.metaContainer,width:80})})},S=(0,f.j)(W,B);function _({libraryPanel:T}){const L=(0,o.of)(K);return!T.meta?.folderUid&&!T.meta?.folderName?null:T.meta.folderUid?(0,n.jsx)("span",{className:L.metaContainer,children:(0,n.jsxs)(g.N,{href:`/dashboards/f/${T.meta.folderUid}`,children:[(0,n.jsx)(l.I,{name:"folder-upload",size:"sm"}),(0,n.jsx)("span",{children:T.meta.folderName})]})}):(0,n.jsxs)("span",{className:L.metaContainer,children:[(0,n.jsx)(l.I,{name:"folder",size:"sm"}),(0,n.jsx)("span",{children:(0,n.jsx)(r.x6,{i18nKey:"library-panels.folder-link.dashboards",children:"Dashboards"})})]})}function K(T){return{metaContainer:(0,a.css)({display:"flex",alignItems:"center",color:T.colors.text.secondary,fontSize:T.typography.bodySmall.fontSize,paddingTop:T.spacing(.5),svg:{marginRight:T.spacing(.5),marginBottom:3}})}}},24438:(te,R,e)=>{"use strict";e.d(R,{j:()=>U,s:()=>j});var n=e(74848),a=e(22803),s=e(96540),i=e(40996),r=e(92745),u=e(63142),o=e(32881),l=e(12737),g=e(76459),f=e.n(g),p=e(45861),c=e(18857),x=e(30703),v=e(65642),m=e(83873),y=e(55860),h=e(83458),d=e(70590);function E({onChange:_,maxMenuHeight:K}){const T=(0,u.of)(D),[L,A]=(0,s.useState)(!1),N=(0,s.useCallback)(Q=>b(Q,A),[]),V=(0,s.useMemo)(()=>f()(N,300),[N]),[z,w]=(0,s.useState)([]),H=(0,s.useCallback)(Q=>{const Z=Q.filter(Y=>!!Y.value).map(Y=>Y.value);_(Z),w(Q)},[_]);return(0,n.jsxs)("div",{className:T.container,children:[z.length>0&&(0,n.jsx)(p.$n,{size:"xs",icon:"trash-alt",fill:"text",className:T.clear,onClick:()=>_([]),children:(0,n.jsx)(r.x6,{i18nKey:"folder-filter.clear-folder-button",children:"Clear folders"})}),(0,n.jsx)(c.Iv,{value:z,onChange:H,isLoading:L,loadOptions:V,maxMenuHeight:K,placeholder:(0,r.t)("folder-filter.select-placeholder","Filter by folder"),noOptionsMessage:(0,r.t)("folder-filter.noOptionsMessage-no-folders-found","No folders found"),prefix:(0,n.jsx)(x.I,{name:"filter"}),"aria-label":(0,r.t)("folder-filter.select-aria-label","Folder filter"),defaultOptions:!0})]})}async function b(_,K){if(K(!0),v.$W.featureToggles.unifiedStorageSearchUI){const z=(await(0,y.S)().search({query:_,kind:["folder"],limit:100,permission:d.RG.View})).view.map(w=>({label:w.name,value:{uid:w.uid,title:w.name}}));return(!_||"dashboards".includes(_.toLowerCase()))&&z.unshift({label:"Dashboards",value:{uid:"general",title:"Dashboards"}}),K(!1),z}const T={query:_,type:h.G.DashFolder,permission:d.RG.View},A=(await(0,m.AI)().search(T)).map(N=>({label:N.title,value:{uid:N.uid,title:N.title}}));return(!_||"dashboards".includes(_.toLowerCase()))&&A.unshift({label:"Dashboards",value:{uid:"general",title:"Dashboards"}}),K(!1),A}function D(_){return{container:(0,a.css)({label:"container",position:"relative",minWidth:"180px",flexGrow:1}),clear:(0,a.css)({label:"clear",fontSize:_.spacing(1.5),position:"absolute",top:-_.spacing(4.5),right:0})}}var C=e(92100),P=e(18552),M=e(95943),O=e(90232),j=(_=>(_.Tight="tight",_.Spacious="spacious",_))(j||{});const U=({onClick:_,variant:K="spacious",currentPanelId:T,currentFolderUID:L,perPage:A=M.FG,showPanelFilter:N=!1,showFolderFilter:V=!1,showSort:z=!1,showSecondaryActions:w=!1})=>{const H=(0,u.of)(W,K),[Q,Z]=(0,s.useState)(""),[Y,X]=(0,s.useState)("");(0,i.A)(()=>X(Q),200,[Q]);const[I,J]=(0,s.useState)({}),[ee,q]=(0,s.useState)(L?[L]:[]),[ne,se]=(0,s.useState)([]),oe=z||N||V,de=K==="tight"?"lg":"xs";return(0,n.jsx)("div",{className:H.container,children:(0,n.jsxs)(o.gW,{spacing:de,children:[(0,n.jsxs)("div",{className:(0,a.cx)(H.gridContainer,{[H.tightLayout]:K==="tight"}),children:[(0,n.jsx)("div",{className:H.filterInputWrapper,children:(0,n.jsx)(l.Z,{value:Q,onChange:Z,placeholder:(0,r.t)("library-panels.library-panels-search.placeholder-search-by-name-or-description","Search by name, description or folder name"),width:0,escapeRegex:!1})}),oe&&(0,n.jsx)(B,{showSort:z,showPanelFilter:N,showFolderFilter:V,onSortChange:J,onFolderFilterChange:q,onPanelFilterChange:se,sortDirection:I.value,variant:K})]}),(0,n.jsx)("div",{className:H.libraryPanelsView,children:(0,n.jsx)(O.y,{onClickCard:_,searchString:Y,sortDirection:I.value,panelFilter:ne,folderFilter:ee,currentPanelId:T,showSecondaryActions:w,perPage:A})})]})})};function W(_,K){return{filterInputWrapper:(0,a.css)({flexGrow:K==="tight"?1:"initial"}),container:(0,a.css)({width:"100%",overflowY:"auto",padding:_.spacing(1)}),libraryPanelsView:(0,a.css)({width:"100%"}),gridContainer:(0,a.css)({display:"flex",flexDirection:"column",width:"100%",columnGap:_.spacing(1),rowGap:_.spacing(1),paddingBottom:_.spacing(2)}),tightLayout:(0,a.css)({flexDirection:"row",rowGap:_.spacing(1)})}}const B=(0,s.memo)(({variant:_="spacious",showSort:K,showPanelFilter:T,showFolderFilter:L,sortDirection:A,onSortChange:N,onFolderFilterChange:V,onPanelFilterChange:z})=>{const w=(0,u.of)(S),H=(0,s.useCallback)(Z=>z(Z.map(Y=>Y.id)),[z]),Q=(0,s.useCallback)(Z=>V(Z.map(Y=>Y.uid??"")),[V]);return(0,n.jsxs)("div",{className:(0,a.cx)(w.container,{[w.containerTight]:_==="tight"}),children:[K&&(0,n.jsx)(P.r,{value:A,onChange:N,filter:["alpha-asc","alpha-desc"]}),(L||T)&&(0,n.jsxs)("div",{className:(0,a.cx)(w.filterContainer,{[w.filterContainerTight]:_==="tight"}),children:[L&&(0,n.jsx)(E,{onChange:Q}),T&&(0,n.jsx)(C.$,{onChange:H})]})]})});B.displayName="SearchControls";function S(_){return{container:(0,a.css)({display:"flex",gap:_.spacing(1),flexGrow:1,flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}),containerTight:(0,a.css)({flexGrow:"initial",flexDirection:"column",justifyContent:"normal"}),filterContainer:(0,a.css)({display:"flex",flexDirection:"row",gap:_.spacing(1)}),filterContainerTight:(0,a.css)({flexDirection:"column",marginLeft:"initial"})}}},90232:(te,R,e)=>{"use strict";e.d(R,{y:()=>m});var n=e(74848),a=e(22803),s=e(96540),i=e(40996),r=e(28105),u=e(92745),o=e(63142),l=e(50201),g=e(89640),f=e(41654),p=e(34213),c=e(70905),x=e(55290),v=e(24381);const m=({onClickCard:h,searchString:d,sortDirection:E,panelFilter:b,folderFilter:D,showSecondaryActions:C,currentPanelId:P,perPage:M=40})=>{const O=(0,o.of)(y),[{libraryPanels:j,page:U,perPage:W,numberOfPages:B,loadingState:S,currentPanelId:_},K]=(0,s.useReducer)(v.w_,{...v.Xb,currentPanelId:P,perPage:M}),T=(0,s.useMemo)(()=>(0,x.QC)(K),[K]);(0,i.A)(()=>T((0,x.IF)({searchString:d,sortDirection:E,panelFilter:b,folderFilterUIDs:D,page:U,perPage:W,currentPanelId:_})),300,[d,E,b,D,U,T]);const L=({uid:V})=>T((0,x.h4)(V,{searchString:d,sortDirection:E,panelFilter:b,folderFilterUIDs:D,page:U,perPage:W})),A=V=>T((0,v.yd)({page:V}));return!(d||b?.length||D?.length)&&S===r.Gu.Done&&j.length<1?(0,n.jsx)(l.p,{variant:"call-to-action",message:(0,u.t)("library-panel.empty-state.message","You haven't created any library panels yet"),children:(0,n.jsxs)(u.x6,{i18nKey:"library-panel.empty-state.more-info",children:["Create a library panel from any existing dashboard panel through the panel context menu."," ",(0,n.jsx)(g.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/manage-library-panels/#create-a-library-panel",children:"Learn more"})]})}):(0,n.jsxs)(f.B,{direction:"column",wrap:"nowrap",children:[S===r.Gu.Loading?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.E.Skeleton,{showSecondaryActions:C}),(0,n.jsx)(c.E.Skeleton,{showSecondaryActions:C}),(0,n.jsx)(c.E.Skeleton,{showSecondaryActions:C})]}):j.length<1?(0,n.jsx)(l.p,{variant:"not-found",message:(0,u.t)("library-panels.empty-state.message","No library panels found")}):j?.map((V,z)=>(0,n.jsx)(c.E,{libraryPanel:V,onDelete:L,onClick:h,showSecondaryActions:C},`library-panel=${z}`)),j.length?(0,n.jsx)("div",{className:O.pagination,children:(0,n.jsx)(p.d,{currentPage:U,numberOfPages:B,onNavigate:A,hideWhenSinglePage:!0})}):null]})},y=h=>({pagination:(0,a.css)({alignSelf:"center",marginTop:h.spacing(1)})})},55290:(te,R,e)=>{"use strict";e.d(R,{IF:()=>v,QC:()=>y,h4:()=>m});var n=e(64423),a=e(65474),s=e(62467),i=e(44240),r=e(39697),u=e(69862),o=e(66847),l=e(69850),g=e(1005),f=e(65961),p=e(67791),c=e(30124),x=e(24381);function v(h){return function(d){const E=new n.yU,b=(0,a.H)((0,c.dq)({searchString:h.searchString,perPage:h.perPage,page:h.page,excludeUid:h.currentPanelId,sortDirection:h.sortDirection,typeFilter:h.panelFilter,folderFilterUIDs:h.folderFilterUIDs})).pipe((0,u.Z)(D=>{const{elements:C}=D;return(0,s.of)({...D,elements:C})}),(0,u.Z)(({perPage:D,elements:C,page:P,totalCount:M})=>(0,s.of)((0,x.c4)({libraryPanels:C,page:P,perPage:D,totalCount:M}))),(0,o.W)(D=>(console.error(D),(0,s.of)((0,x.c4)({...x.Xb,page:h.page,perPage:h.perPage})))),(0,l.j)(()=>E.unsubscribe()),(0,g.u)());E.add((0,i.h)((0,r.O)(50).pipe((0,f.u)((0,x.d9)()),(0,p.Q)(b)),b).subscribe(d))}}function m(h,d){return async function(E){try{await(0,c.h4)(h),v(d)(E)}catch(b){console.error(b)}}}function y(h){return function(d){return d instanceof Function?d(h):h(d)}}},24381:(te,R,e)=>{"use strict";e.d(R,{Xb:()=>s,c4:()=>r,d9:()=>i,w_:()=>o,yd:()=>u});var n=e(65307),a=e(28105);const s={loadingState:a.Gu.Loading,libraryPanels:[],totalCount:0,perPage:40,page:1,numberOfPages:0,currentPanelId:void 0},i=(0,n.VP)("libraryPanels/view/initSearch"),r=(0,n.VP)("libraryPanels/view/searchCompleted"),u=(0,n.VP)("libraryPanels/view/changePage"),o=(l,g)=>{if(i.match(g))return{...l,loadingState:a.Gu.Loading};if(r.match(g)){const{libraryPanels:f,page:p,perPage:c,totalCount:x}=g.payload,v=Math.ceil(x/c);return{...l,libraryPanels:f,perPage:c,totalCount:x,loadingState:a.Gu.Done,numberOfPages:v,page:p>v?p-1:p}}return u.match(g)?{...l,page:g.payload.page}:l}},75515:(te,R,e)=>{"use strict";e.d(R,{X:()=>n});function n(a){return!!a.libraryPanel?.uid}},30124:(te,R,e)=>{"use strict";e.d(R,{DW:()=>E,GN:()=>m,Yr:()=>f,d7:()=>c,dq:()=>g,e9:()=>p,h4:()=>v,jc:()=>x,xV:()=>y});var n=e(75505),a=e(59857),s=e(7817),i=e(93389),r=e(70030),u=e(8285),o=e(83873),l=e(97583);async function g({searchString:b="",perPage:D=100,page:C=1,excludeUid:P="",sortDirection:M="",typeFilter:O=[],folderFilterUIDs:j=[]}={}){const U=new URLSearchParams;U.append("searchString",b),U.append("sortDirection",M),U.append("typeFilter",O.join(",")),U.append("folderFilterUIDs",j.join(",")),U.append("excludeUid",P),U.append("perPage",D.toString(10)),U.append("page",C.toString(10)),U.append("kind",l.i.Panel.toString(10));const{result:W}=await(0,o.AI)().get(`/api/library-elements?${U.toString()}`);return W}async function f(b,D=!1){const C=await(0,n.s)((0,o.AI)().fetch({method:"GET",url:`/api/library-elements/${b}`,showSuccessAlert:!D,showErrorAlert:!D})),{result:P}=C.data,M=new s.G({...a.Ye,schemaVersion:35,panels:[P.model]}),{scopedVars:O,...j}=M.panels[0].getSaveModel();return delete j.gridPos,delete j.id,delete j.libraryPanel,M.destroy(),{...P,model:j}}async function p(b){const{result:D}=await(0,o.AI)().get(`/api/library-elements/name/${b}`,void 0,void 0,{validatePath:!0});return D}async function c(b,D){const{result:C}=await(0,o.AI)().post("/api/library-elements",{folderUid:D,name:b.libraryPanel.name,model:b,kind:l.i.Panel});return C}async function x(b){const{libraryPanel:D,...C}=b,{uid:P,name:M,version:O,folderUid:j}=D,U=l.i.Panel,{result:W}=await(0,o.AI)().patch(`/api/library-elements/${P}`,{folderUid:j,name:M,model:C,version:O,kind:U});return W}function v(b){return(0,o.AI)().delete(`/api/library-elements/${b}`)}async function m(b){const{result:D}=await(0,o.AI)().get(`/api/library-elements/${b}/connections`);return D}async function y(b){const D=await m(b);return D.length===0?[]:await(0,o.AI)().search({dashboardUIDs:D.map(P=>P.connectionUid)})}function h(b){const D=(0,u.iL)(b),{uid:C,name:P,_loadedPanel:M}=D.state;let O=b.parent;if(!O||!(O instanceof i.U))throw new Error("Trying to save a library panel that does not have a DashboardGridItem parent");return{...M,uid:C,name:P,type:b.state.pluginId,model:(0,r.Z6)(b.clone({$behaviors:void 0}),{x:O.state.x??0,y:O.state.y??0,w:O.state.width??0,h:O.state.height??0},!1,O),kind:l.i.Panel,version:M?.version||0}}async function d(b){const{uid:D,folderUid:C,name:P,model:M,version:O,kind:j}=h(b),{result:U}=await(0,o.AI)().patch(`/api/library-elements/${D}`,{folderUid:C,name:P,model:M,version:O,kind:j});return U}async function E(b){const D=await d(b),C=(0,u.iL)(b);if(!C)throw new Error("Could not find library panel behavior for panel");C.setPanelFromLibPanel(D)}},37666:(te,R,e)=>{"use strict";e.d(R,{o:()=>a});var n=e(22803);function a(s){return{myTable:(0,n.css)({maxHeight:"204px",overflowY:"auto",marginTop:"11px",marginBottom:"28px",borderRadius:s.shape.radius.default,border:`1px solid ${s.colors.action.hover}`,background:s.colors.background.primary,color:s.colors.text.secondary,fontSize:s.typography.h6.fontSize,width:"100%",thead:{color:"#538ade",fontSize:s.typography.bodySmall.fontSize},"th, td":{padding:"6px 13px",height:s.spacing(4)},"tbody > tr:nth-child(odd)":{background:s.colors.background.secondary}}),noteTextbox:(0,n.css)({marginBottom:s.spacing(4)}),textInfo:(0,n.css)({color:s.colors.text.secondary,fontSize:s.typography.size.sm}),dashboardSearch:(0,n.css)({marginTop:s.spacing(2)}),modal:(0,n.css)({width:"500px"}),modalText:(0,n.css)({fontSize:s.typography.h4.fontSize,color:s.colors.text.primary,marginBottom:s.spacing(4),paddingTop:s.spacing(2)})}}},97583:(te,R,e)=>{"use strict";e.d(R,{i:()=>n});var n=(s=>(s[s.Panel=1]="Panel",s))(n||{}),a=(s=>(s[s.Dashboard=1]="Dashboard",s))(a||{})},12048:(te,R,e)=>{"use strict";e.d(R,{b:()=>f});var n=e(5805),a=e(92745),s=e(68143),i=e(64762),r=e(30124);async function u(p,c){const x=o(p),v=await g(x,c);return l(p,v),v}function o(p){let{scopedVars:c,...x}=p.getSaveModel();return x={libraryPanel:{name:p.title,uid:void 0},...x},x}function l(p,c){p.restoreModel({...c.model,configRev:0,libraryPanel:c,title:p.title}),p.hasSavedPanelEditChange=!0,p.refresh()}function g(p,c){return p.libraryPanel?p.libraryPanel&&p.libraryPanel.uid===""?(0,r.d7)(p,c):(0,r.jc)(p):Promise.reject()}const f=()=>{const p=(0,i._2)(),[c,x]=(0,n.default)(async(v,m)=>{try{const y=await u(v,m);return p.success((0,a.t)("library-panels.save.success","Library panel saved")),y}catch(y){throw(0,s.NF)(y)&&(y.isHandled=!0,p.error((0,a.t)("library-panels.save.error",'Error saving library panel: "{{errorMsg}}"',{errorMsg:y.message??y.data.message}))),y}},[]);return{state:c,saveLibraryPanel:x}}},79718:(te,R,e)=>{"use strict";e.d(R,{t:()=>b});var n=e(24726),a=e(38619),s=e(32899),i=e(33184),r=e(36490),u=e(73427),o=e(87745),l=e(22429),g=e(74848),f=e(22803),p=e(92745),c=e(63142),x=e(22787),v=e(45861),m=(D=>(D.Saved="saved",D.EditingStarted="editing-started",D.EditingCanceled="editing-cancelled",D.Deleted="deleted",D))(m||{});function y({onDismiss:D,event:C}){const P=(0,c.of)(h),M=()=>{if(C?.action===m.Deleted){r.Ny.push("/");return}b.reloadPage(),D()};return(0,g.jsxs)(x.a,{isOpen:!0,title:(0,p.t)("live.dashboard-changed-modal.title-dashboard-changed","Dashboard changed"),icon:"copy",onDismiss:D,onClickBackdrop:()=>{},className:P.modal,children:[(0,g.jsx)("div",{className:P.description,children:(0,g.jsx)(p.x6,{i18nKey:"live.dashboard-changed-modal.description",children:"The dashboard has been updated by another session. Do you want to continue editing or discard your local changes?"})}),(0,g.jsxs)(x.a.ButtonRow,{children:[(0,g.jsx)(v.$n,{onClick:D,variant:"secondary",fill:"outline",children:(0,g.jsx)(p.x6,{i18nKey:"live.dashboard-changed-modal.continue-editing",children:"Continue editing"})}),(0,g.jsx)(v.$n,{onClick:M,variant:"destructive",children:(0,g.jsx)(p.x6,{i18nKey:"live.dashboard-changed-modal.discard-local-changes",children:"Discard local changes"})})]})]})}const h=D=>({modal:(0,f.css)({width:"600px"}),description:(0,f.css)({color:D.colors.text.secondary,paddingBottom:D.spacing(1)})}),d=(0,n.A)();class E{constructor(){this.editing=!1,this.observer={next:C=>{if((0,a.ew)(C)&&this.editing&&C.state===a.ZF.Connected&&this.sendEditingState(),(0,a.Z7)(C)){if(C.message.sessionId===d)return;const{action:P}=C.message;switch(P){case m.EditingStarted:case m.Saved:{if(this.ignoreSave){this.ignoreSave=!1;return}const M=(0,l.UA)().getCurrent();if(M?.uid!==C.message.uid){console.log("dashboard event for different dashboard?",C,M);return}const O=this.editing||M.hasUnsavedChanges();if(P===m.Saved)O?u.lE.publish(new o.S8({component:y,props:{event:C}})):(u.lE.emit(s.r1.alertSuccess,["Dashboard updated"]),this.reloadPage());else if(O&&P===m.EditingStarted&&!this.hasSeenNotice){const j=C.message,U=this.getRecentEditingEvent();(!U||U.message!==j.message)&&(this.hasSeenNotice=!0,u.lE.emit(s.r1.alertWarning,["Another session is editing this dashboard",j.message])),this.lastEditing=j}return}}}}}}setEditingState(C){const P=this.editing=C;this.editing=C,this.hasSeenNotice=!1,P&&u.TP.isEditor&&this.sendEditingState()}sendEditingState(){const{channel:C,uid:P}=this;C&&P&&(0,i.oF)().publish(C,{sessionId:d,uid:P,action:this.editing?m.EditingStarted:m.EditingCanceled,timestamp:Date.now()})}watch(C){const P=(0,i.oF)();P&&C!==this.uid&&(this.channel={scope:a.qD.Grafana,namespace:"dashboard",path:`uid/${C}`},this.leave(),C&&(this.subscription=P.getStream(this.channel).subscribe(this.observer)),this.uid=C)}leave(){this.subscription&&this.subscription.unsubscribe(),this.subscription=void 0,this.uid=void 0}ignoreNextSave(){this.ignoreSave=!0}getRecentEditingEvent(){return this.lastEditing&&this.lastEditing.timestamp&&Date.now()-this.lastEditing.timestamp>5e3&&(this.lastEditing=void 0),this.lastEditing}reloadPage(){r.Ny.reload()}}const b=new E},46383:(te,R,e)=>{"use strict";e.d(R,{_w:()=>a,o$:()=>u,ot:()=>s});var n=e(41119),a=(o=>(o.NewValuesSameSchema="NewValuesSameSchema",o.FullFrame="FullFrame",o))(a||{});const s=(o,l)=>"type"in o&&o.type===l,i=Object.values(a),r=o=>"type"in o&&i.includes(o.type),u=o=>(0,n.ci)(o)&&"packetInfo"in o},62215:(te,R,e)=>{"use strict";e.d(R,{FE:()=>l,jE:()=>u,qE:()=>o});var n=e(2543),a=e.n(n),s=e(92745),i=e(62635),r=e(46072);const u=(c,x)=>l(c,x),o=c=>{let x=[];return c.forEach(v=>{v.links?.forEach(m=>{if("variables"in m&&m.variables.length>0){const y={href:m.href,title:m.title,origin:m.origin,onClick:m.onClick,target:m.target},h=m.variables.map(E=>{const b=E.variableName,D=E.fieldPath?`.${E.fieldPath}`:"";return`${b}${D}`}),d=m.variables.map(E=>E.found?E.value:"");x.push({keys:h,values:d,links:[y],fieldIndex:v.fieldIndex})}})}),x},l=(c,x)=>p(c).map(m=>{const y={__labels:{text:(0,s.t)("logs.get-dataframe-fields.vars.text.labels","Labels"),value:{tags:{...c.labels}}}},h=x?x(m,c.rowIndex,c.dataFrame,y):[],d=m.values[c.rowIndex],E=typeof d=="string"||typeof d=="number"?d.toString():(0,i.MA)(d);return{keys:[m.name],values:[E],links:h,fieldIndex:m.index}});function g(c,x){const v=(0,r.Os)(c);if(v===null)return new Set;const m=new Set(v.extraFields.map(y=>y.index));return v.severityField!==null&&m.add(v.severityField.index),x.keepBody&&m.add(v.bodyField.index),x.keepTimestamp&&m.add(v.timeField.index),m}function f(c,x){const v=c.fields.map((d,E)=>({...d,index:E})),m=g(c,x??{}),[y,h]=partition(v,d=>d.config.custom?.hidden?!1:(d.config.links??[]).length>0?!0:m.has(d.index));return{visible:y,hidden:h}}function p(c,x){const v=c.dataFrame,m=g(v,x??{}),y=[];for(let h=0;h<v.fields.length;h++){const d=v.fields[h];d.values[c.rowIndex]!=null&&(d.config.custom?.hidden||(d.config.links&&d.config.links.length>0||m.has(h))&&y.push({...d,index:h}))}return y}},46072:(te,R,e)=>{"use strict";e.d(R,{nC:()=>x,ww:()=>v,Os:()=>m});var n=e(10279),a=e(95004),s=e(39443);function i(y,h){const d=y.labels;if(d!==void 0){const E=new Array(h);return E.fill(d),E}else return null}function r(y,h,d){const E=y.getFieldByName("labels");if(E!==void 0&&E.type===a.PU.other){const b=E.values.map(x);return[E,()=>b]}else return[null,()=>i(h,d.length)]}function u(y){const h=new n.L(y),d=h.getFirstFieldOfType(a.PU.time),E=h.getFirstFieldOfType(a.PU.string);if(d===void 0||E===void 0)return null;const b=h.getFieldByName("tsNs")??null,D=h.getFieldByName("level")??h.getFieldByName("detected_level")??null,C=h.getFieldByName("id")??null,[P,M]=r(h,E,y),O=h.fields.filter((j,U)=>U!==d.index&&U!==E.index&&U!==b?.index&&U!==D?.index&&U!==C?.index&&U!==P?.index);return{timeField:d,bodyField:E,timeNanosecondField:b,severityField:D,idField:C,getLogFrameLabels:M,getLogFrameLabelsAsLabels:M,getLabelFieldName:()=>P?.name??null,extraFields:O}}function o(y,h,d){const E=y.getFieldByName(h);if(E!==void 0)return E.type===d?E:void 0}const l="timestamp",g="body",f="severity",p="id",c="labels";function x(y){let h=!1;for(const d in y)if(typeof y[d]!="string"){h=!0;break}if(h){let d={};for(const E in y){const b=y[E];d[E]=typeof b=="string"?b:JSON.stringify(b)}return d}return y}function v(y){const h=new n.L(y),d=o(h,l,a.PU.time),E=o(h,g,a.PU.string);if(d===void 0||E===void 0)return null;const b=o(h,f,a.PU.string)??null,D=o(h,p,a.PU.string)??null,C=o(h,c,a.PU.other)??null,P=C===null?null:C.values,M=h.fields.filter((O,j)=>j!==d.index&&j!==E.index&&j!==b?.index&&j!==D?.index&&j!==C?.index);return{timeField:d,bodyField:E,severityField:b,idField:D,getLogFrameLabels:()=>P,timeNanosecondField:null,getLogFrameLabelsAsLabels:()=>P!==null?P.map(x):null,getLabelFieldName:()=>C!==null?C.name:null,extraFields:M}}function m(y){return y.meta?.type===s.m.LogLines?v(y):u(y)}},37234:(te,R,e)=>{"use strict";e.d(R,{yR:()=>W,cZ:()=>S,HT:()=>Q,M0:()=>z,f8:()=>ae,J9:()=>w,Wr:()=>de,sg:()=>oe});var n=e(88838),a=e(2543),s=e(88483),i=e(50832),r=e(65474),u=e(67770),o=e(739),l=e(41119),g=e(10279),f=e(95004),p=e(64394),c=e(25229),x=e(71642),v=e(63704),m=e(80011),y=e(17548),h=e(28105),d=e(50204),E=e(92745),b=e(43173),D=e(8255),C=e(65642);function P(ce,ie){return C.Ay.bootData?.user?.lightTheme?ie:ce}var M=e(12282),O=e(46072),j=e(74746);const U="Line limit",W="Common labels",B="Total lines",S={[u.$b.critical]:D.Tj[7],[u.$b.error]:D.Tj[4],[u.$b.warning]:D.Tj[1],[u.$b.info]:D.Tj[0],[u.$b.debug]:D.Tj[5],[u.$b.trace]:D.Tj[2],[u.$b.unknown]:P("#8e8e8e","#bdc4cd")},_=1,K=1e3*_,T=60*K,L=60*T,A=24*L,N=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-6]\d[,\.]\d+([+-][0-2]\d:[0-5]\d|Z)/g;function V(ce,ie,ve){switch(ve){case o.fY.exact:return ce.entry.replace(N,"")===ie.entry.replace(N,"");case o.fY.numbers:return ce.entry.replace(/\d/g,"")===ie.entry.replace(/\d/g,"");case o.fY.signature:return ce.entry.replace(/\w/g,"")===ie.entry.replace(/\w/g,"");default:return!1}}function z(ce,ie){return ie===o.fY.none?ce:ce.reduce((ve,le,Ee)=>{const Re=ve[ve.length-1];return Ee>0&&V(le,Re,ie)?Re.duplicates++:ve.push({...le,duplicates:0}),ve},[])}function w(ce,ie){const ve={},le=[];for(const Ee of ce){let Re=ve[Ee.logLevel];Re||(ve[Ee.logLevel]=Re={lastTs:null,datapoints:[],target:Ee.logLevel,color:S[Ee.logLevel]},le.push(Re));const Oe=Math.floor(Ee.timeEpochMs/ie)*ie;Oe===Re.lastTs?Re.datapoints[Re.datapoints.length-1][0]++:(Re.datapoints.push([1,Oe]),Re.lastTs=Oe);for(const Se of le)Se!==Re&&Se.lastTs!==Oe&&(Se.datapoints.push([0,Oe]),Se.lastTs=Oe)}return le.map((Ee,Re)=>{Ee.datapoints.sort((_e,He)=>_e[1]-He[1]);const Oe=(0,l.Vc)(Ee),Te=new g.L(Oe).getFirstFieldOfType(f.PU.number);return Oe.fields[Te.index].config.min=0,Oe.fields[Te.index].config.decimals=0,Oe.fields[Te.index].config.color={mode:p.Y.Fixed,fixedColor:Ee.color},Oe.fields[Te.index].config.custom={drawStyle:o.GR.Bars,barAlignment:o.Nj.Center,barWidthFactor:.9,barMaxWidth:5,lineColor:Ee.color,pointColor:Ee.color,fillColor:Ee.color,lineWidth:0,fillOpacity:100,stacking:{mode:o.gs.Normal,group:"A"}},Oe})}function H(ce){return ce.fields.some(ie=>ie.type===f.PU.time)&&ce.fields.some(ie=>ie.type===f.PU.string)}function Q(ce,ie,ve,le,Ee){const{logSeries:Re}=Y(ce),Oe=I(Re,le,!!Ee);if(Oe){if(Oe.queries=le,ie&&Oe.rows.length>0){const Se=Oe.rows.sort(j.M1),{visibleRange:Te,bucketSize:_e,visibleRangeMs:He,requestedRangeMs:tt}=Z(Se,ie,ve);Oe.visibleRange=Te,Oe.bucketSize=_e,Oe.series=w(Se,_e),Oe.meta&&(Oe.meta=J(Oe,He,tt))}else Oe.series=[];return Oe}return{hasUniqueLabels:!1,rows:[],meta:[],series:[],queries:le}}function Z(ce,ie,ve,le=20,Ee=1e3){let Re=ve,Oe=ie,Se=Math.max(Oe*le,Ee),Te,_e;if(ve){const He=ce[0].timeEpochMs,tt=ce[ce.length-1].timeEpochMs,Je=He<tt?He:tt,Ge=ve.to-Je;if(_e=ve.to-ve.from,Te=Math.abs(He-tt),Te>0){const je=Ge/_e;Oe*=je,Se=Math.max(Math.ceil(Oe*le),Ee),Re={from:Math.floor(Je/Se)*Se,to:ve.to}}else Te=1}return{bucketSize:Se,visibleRange:Re,visibleRangeMs:Te,requestedRangeMs:_e}}function Y(ce){const ie=[],ve=[];for(const le of ce){if(H(le)||!le.fields.length){ve.push(le);continue}le.length>0&&ie.push(le)}return{logSeries:ve,metricSeries:ie}}function X(ce,ie,ve){const le=ce.values[ve],Re=(0,c.yT)(le).valueOf();if(ie)return{ts:le,timeEpochMs:Re,timeEpochNs:ie.values[ve]};if(ce.nanos!==void 0){const Oe=ce.nanos[ve].toString().padStart(6,"0"),Se=`${Re}${Oe}`;return{ts:le,timeEpochMs:Re,timeEpochNs:Se}}return{ts:le,timeEpochMs:Re,timeEpochNs:Re+"000000"}}function I(ce,ie=[],ve=!1){if(ce.length===0)return;const le=[];let Ee=[];const Re=ce.filter(we=>we.fields.length);Re.length&&Re.forEach(we=>{const Xe=(0,O.Os)(we);if(Xe!=null){const nt=Xe.getLogFrameLabelsAsLabels()??void 0,he={rawFrame:we,logsFrame:Xe,frameLabels:nt};Ee.push(he),nt&&nt.length>0&&le.push(nt)}});const Oe=le.flat(),Se=Oe.length>0?(0,x.yO)(Oe):{};let Te=[],_e=!1;const He=(0,j.kA)();for(const we of Ee){const{logsFrame:Xe,rawFrame:nt,frameLabels:he}=we,{timeField:xe,timeNanosecondField:me,bodyField:ye,severityField:De,idField:Le}=Xe;for(let Ve=0;Ve<nt.length;Ve++){const{ts:ze,timeEpochMs:Ze,timeEpochNs:Me}=X(xe,me??void 0,Ve),$e=ye.values[Ve]??"",at=typeof $e=="string"?$e:JSON.stringify($e),ct=v.sQ.hasAnsiCodes(at),ft=!!at.match(/\\n|\\t|\\r/),Et=nt.meta?.custom?.searchWords??nt.meta?.searchWords??[],St=ct?n.Ay.strip(at):at,Pt=he?.[Ve],Dt=(0,x.s6)(Pt,Se);Object.keys(Dt).length>0&&(_e=!0);let Ye=u.$b.unknown;const mt=De&&De.values[Ve]||(Pt?.level??Pt?.detected_level);typeof mt=="number"||typeof mt=="string"?Ye=(0,j.EK)(mt):Ye=(0,j.XM)(St);const zt=ie.find(ln=>ln.refId===nt.refId)?.datasource,Jt=zt?.type,Xt=zt?.uid,En={entryFieldIndex:ye.index,rowIndex:Ve,dataFrame:nt,logLevel:Ye,timeFromNow:(0,m.fq)(ze),timeEpochMs:Ze,timeEpochNs:Me,timeLocal:(0,m.LE)(ze,{timeZone:"browser"}),timeUtc:(0,m.LE)(ze,{timeZone:"utc"}),uniqueLabels:Dt,hasAnsi:ct,hasUnescapedContent:ft,searchWords:Et,entry:St,raw:at,labels:Pt||{},uid:`${nt.refId}_${Le?Le.values[Ve]:Ve.toString()}`,datasourceType:Jt,datasourceUid:Xt};Le!==null&&(En.rowId=Le.values[Ve]),!(ve&&He(En))&&Te.push(En)}}const tt=[],Ge=ce.filter(we=>we?.meta?.custom?.limit??we?.meta?.limit).reduce((we,Xe)=>(we[Xe.refId??""]=Xe.meta?.custom?.limit??Xe.meta?.limit??0,we),{}),je=Object.values(Ge).reduce((we,Xe)=>we+=Xe,0);je>0&&tt.push({label:U,value:je,kind:u.tG.Number});const Fe=ce.reduce((we,Xe)=>we+=Xe.meta?.custom?.total,0);Fe>0&&tt.push({label:B,value:Fe,kind:u.tG.Number});let Be=0;const Ke={};let Ue=!1;for(const we of ce){const Xe=we.meta?.custom?.lokiQueryStatKey,{refId:nt}=we;if(!Ue&&we.meta?.custom?.error&&(tt.push({label:"",value:we.meta?.custom.error,kind:u.tG.Error}),Ue=!0),nt&&!Ke[nt]){if(Xe&&we.meta?.stats){const he=we.meta.stats.find(xe=>xe.displayName===Xe);he&&(Be+=he.value)}Ke[nt]=!0}}if(Be>0){const{text:we,suffix:Xe}=(0,d.rT)("B")(Be);tt.push({label:(0,E.t)("logs.log-series-to-logs-model.label.total-bytes-processed","Total bytes processed"),value:`${we} ${Xe}`,kind:u.tG.String})}return(0,a.size)(Se)>0&&tt.push({label:W,value:Se,kind:u.tG.LabelsMap}),{hasUniqueLabels:_e,meta:tt,rows:Te}}function J(ce,ie,ve){if(!ce.meta)return[];let le=[...ce.meta];const Ee=le.findIndex(Oe=>Oe.label===U),Re=Ee>=0&&le[Ee]?.value;if(Re&&typeof Re=="number"&&Re>0){let Oe;if(Re===ce.rows.length&&ie&&ve){if(Oe=`${Re} reached`,!ce.queries?.some(Te=>"direction"in Te&&Te.direction===M.ti.Scan)){const Te=(ie/ve*100).toFixed(2);Oe=`${Re} lines shown \u2014 ${Te}% (${y.msRangeToTimeString(ie)}) of ${y.msRangeToTimeString(ve)}`}}else{const Se=b.$.featureToggles.logsInfiniteScrolling?"displayed":"returned";Oe=`${ce.rows.length} ${ce.rows.length>1?"lines":"line"} ${Se}`}le[Ee]={label:"",value:Oe,kind:u.tG.String}}return le}function ee(ce,ie){const ve=ie&&ce===u.$b.unknown?"logs":ce,le=S[ce];return{displayNameFromDS:ve,color:{mode:p.Y.Fixed,fixedColor:le},custom:{drawStyle:o.GR.Bars,barAlignment:o.Nj.Center,lineColor:le,pointColor:le,fillColor:le,lineWidth:1,fillOpacity:100,stacking:{mode:o.gs.Normal,group:"A"}}}}const q=(ce,ie,ve)=>(ce.fields=ce.fields.map(le=>(le.type===f.PU.number&&(le.config={...le.config,...ee(ie(ce),ve)}),le)),ce);function ne(ce){let ie;try{ie=new g.L(ce).getFirstFieldOfType(f.PU.number)}catch{}return ie?.labels?se(ie.labels):u.$b.unknown}function se(ce){const ie=ce.level??ce.detected_level??ce.lvl??ce.loglevel??"";return ie?(0,j.EK)(ie):u.$b.unknown}function oe(ce,ie,ve){const le=ie.range,Ee=ve.targets,Re=ne,Oe=le.to.valueOf()-le.from.valueOf(),Se=fe(ie.scopedVars,Oe);return ie.interval=Se.interval,ie.scopedVars.__interval={value:Se.interval,text:Se.interval},Se.intervalMs!==void 0&&(ie.intervalMs=Se.intervalMs,ie.scopedVars.__interval_ms={value:Se.intervalMs,text:Se.intervalMs}),ie.hideFromInspector=!0,new s.c(Te=>{let _e=[];Te.next({state:h.Gu.Loading,error:void 0,data:[]});const He=ce.query(ie),Je=((0,i.A)(He)?He:(0,r.H)(He)).subscribe({complete:()=>{Te.complete()},next:Ge=>{const{error:je}=Ge;if(je!==void 0)Te.next({state:h.Gu.Error,error:je,data:Ge.data}),Te.error(je);else{const Fe=(0,a.groupBy)(Ge.data,"refId");_e=Ge.data.map(Be=>{if(Be.meta?.dataTopic===o.QR.Annotations)return Be;let Ke=Be.refId||"";Ke.startsWith("log-volume-")&&(Ke=Ke.substr(11));const Ue={logsVolumeType:u.Aj.FullRange,absoluteRange:{from:le.from.valueOf(),to:le.to.valueOf()},datasourceName:ce.name,sourceQuery:Ee.find(we=>we.refId===Ke)};return Be.meta={...Be.meta,custom:{...Be.meta?.custom,...Ue}},q(Be,Re,Fe[Be.refId].length===1)}),Te.next({state:Ge.state,error:void 0,data:_e})}},error:Ge=>{Te.next({state:h.Gu.Error,error:Ge,data:[]}),Te.error(Ge)}});return()=>{Je?.unsubscribe()}})}function de(ce,ie){return ie.hideFromInspector=!0,new s.c(ve=>{let le=[];ve.next({state:h.Gu.Loading,error:void 0,data:[]});const Ee=ce.query(ie),Oe=((0,i.A)(Ee)?Ee:(0,r.H)(Ee)).subscribe({complete:()=>{ve.next({state:h.Gu.Done,error:void 0,data:le}),ve.complete()},next:Se=>{const{error:Te}=Se;Te!==void 0?(ve.next({state:h.Gu.Error,error:Te,data:[]}),ve.error(Te)):le=Se.data.map(_e=>{const He=(0,l.Vc)(_e),{timeIndex:tt}=(0,l.KR)(He);return(0,l.ES)(He,tt)})},error:Se=>{ve.next({state:h.Gu.Error,error:Se,data:[]}),ve.error(Se)}});return()=>{Oe?.unsubscribe()}})}function fe(ce,ie){if(ce.__interval_ms){let ve=ce.__interval_ms.value,le="";return ie<K*5?(ve=_,le="1ms"):ve>L?(ve=A,le="1d"):ve>T?(ve=L,le="1h"):ve>K?(ve=T,le="1m"):(ve=K,le="1s"),{interval:le,intervalMs:ve}}else return{interval:"$__interval"}}function ae(ce){const ie=ce.dataFrame;return ie.length===0||ie.length<=ce.rowIndex?null:(0,l.EI)({fields:ie.fields.map(le=>({...le,values:[le.values[ce.rowIndex]]})),refId:ie.refId})}},74746:(te,R,e)=>{"use strict";e.d(R,{Ck:()=>de,Dk:()=>Z,Dm:()=>H,Dx:()=>z,EK:()=>j,Ei:()=>L,Hw:()=>N,K7:()=>ce,M1:()=>S,PO:()=>oe,R:()=>Y,Tj:()=>U,Vu:()=>fe,XM:()=>O,a8:()=>I,dO:()=>q,e3:()=>Q,kA:()=>J,oR:()=>T,oT:()=>w,qR:()=>A,s:()=>ae,s2:()=>W,tX:()=>X,zy:()=>K});var n=e(4213),a=e.n(n),s=e(2543),i=e.n(s),r=e(75505),u=e(81160),o=e(67770),l=e(739),g=e(25229),f=e(18700),p=e(95004),c=e(83175),x=e(92138),v=e(22592),m=e(10279),y=e(16515),h=e(80011),d=e(2197),E=e(41119),b=e(92745),D=e(65642),C=e(67155),P=e(54334),M=e(62215);function O(ve){if(!ve)return o.$b.unknown;let le=o.$b.unknown,Ee;for(const[Re,Oe]of Object.entries(o.$b)){const Te=new RegExp(`\\b${Re}\\b`,"i").exec(ve);Te&&(Ee===void 0||Te.index<Ee)&&(le=Oe,Ee=Te.index)}return le}function j(ve){const le=o.$b[ve.toString().toLowerCase()];if(le)return le;if(typeof ve=="string"){const Ee=parseInt(ve,10);if(ve.length===Ee.toString().length)return o.s5[ve]||o.$b.unknown}else if(typeof ve=="number")return o.s5[ve]||o.$b.unknown;return o.$b.unknown}function U(ve,le){const Ee=ve.filter(Se=>Se.labels[le]!==void 0),Re=Ee.length,Oe=(0,s.countBy)(Ee,Se=>Se.labels[le]);return B(Oe,Re)}function W(ve){const le=ve.filter(Re=>Re!=null),Ee=(0,s.countBy)(le);return B(Ee,le.length)}const B=(ve,le)=>(0,s.chain)(ve).map((Ee,Re)=>({count:Ee,value:Re,proportion:Ee/le})).sortBy("count").reverse().value(),S=(ve,le)=>ve.timeEpochMs<le.timeEpochMs?-1:ve.timeEpochMs>le.timeEpochMs?1:ve.timeEpochNs<le.timeEpochNs?-1:ve.timeEpochNs>le.timeEpochNs?1:0,_=(ve,le)=>ve.timeEpochMs>le.timeEpochMs?-1:ve.timeEpochMs<le.timeEpochMs?1:ve.timeEpochNs>le.timeEpochNs?-1:ve.timeEpochNs<le.timeEpochNs?1:0,K=(ve,le)=>{const Ee=ve?T(ve.rows,le):[];return ve?{...ve,rows:Ee}:{hasUniqueLabels:!1,rows:Ee}},T=(ve,le)=>le===l.uH.Ascending?ve.sort(S):ve.sort(_),L=ve=>ve.labels.__error__,A=ve=>{if(ve.labels.__adaptive_logs_sampled__)return ve.labels.__adaptive_logs_sampled__==="true"?"Logs like this one have been dropped by Adaptive Logs":`${ve.labels.__adaptive_logs_sampled__}% of logs like this one have been dropped by Adaptive Logs`},N=ve=>ve.replace(/\\r\\n|\\n|\\t|\\r/g,le=>le.slice(1)==="t"?"	":`
`);function V(ve){return ve.map(le=>{const Ee=(0,M.FE)(le).reduce((Re,Oe)=>{const Se=Oe.keys[0];return Re[Se]=Oe.values[0],Re},{});return{line:le.entry,timestamp:le.timeEpochNs,date:(0,g.KQ)(le.timeEpochMs).toISOString(),fields:{...Ee,...le.labels}}})}const z=ve=>{let le={from:1/0,to:-1/0};return ve.forEach(Ee=>{const Re=Ee.meta?.custom||{};Re.absoluteRange?.from&&Re.absoluteRange?.to&&(le={from:Math.min(le.from,Re.absoluteRange.from),to:Math.max(le.to,Re.absoluteRange.to)})}),le},w=ve=>{if(ve.length===0)throw new Error("Cannot aggregate data frames: there must be at least one data frame to aggregate");const le={},Ee={};let Re=-1/0;const Oe={};let Se=[];return ve.forEach(Te=>{const{level:_e,valueField:He,timeField:tt}=X(Te,ve);if(!(!tt||!He)){Oe[_e]={meta:Te.meta,valueFieldConfig:He?.config??{},timeFieldConfig:tt?.config??{}};for(let Je=0;Je<Te.length;Je++){const Ge=tt.values[Je],je=He.values[Je];le[_e]??={},le[_e][Ge]=(le[_e][Ge]||0)+je,Ee[Ge]=(Ee[Ge]||0)+je,Ee[Ge]>Re&&(Re=Ee[Ge])}}}),Object.keys(le).forEach(Te=>{const _e=new f.k,{meta:He,timeFieldConfig:tt,valueFieldConfig:Je}=Oe[Te];_e.name=Te,_e.meta=He,_e.addField({name:"Time",type:p.PU.time,config:tt}),_e.addField({name:"Value",type:p.PU.number,config:Je}),Object.entries(le[Te]).sort((Ge,je)=>Number(Ge[0])-Number(je[0])).forEach(([Ge,je])=>{_e.add({Time:Number(Ge),Value:je})}),Se.push(_e)}),{dataFrames:Se,maximum:Re}},H=ve=>{const le=ve[0]?.meta?.custom;return le&&le.datasourceName?{name:le.datasourceName}:null},Q=ve=>ve[0]?.meta?.custom?.logsVolumeType===o.Aj.Limited,Z=async(ve,le)=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(ve);{const Ee=document.createElement("textarea");le.current?.appendChild(Ee),Ee.value=ve,Ee.focus(),Ee.select(),document.execCommand("copy"),Ee.remove()}};async function Y(ve,le,Ee,Re){if(Ee&&(ve.nativeEvent.ctrlKey||ve.nativeEvent.metaKey||ve.nativeEvent.shiftKey)){const Oe=window.open("about:blank"),Se=await Ee(le,void 0,!1);if(Se&&Oe){const Te=c.kM.renderUrl(x.I.assureBaseUrl(`${(0,D.zj)().appSubUrl}explore`),{left:JSON.stringify({datasource:Se.datasource,queries:[Se],range:(0,v.E2)()})});Oe.location=Te;return}Oe?.close()}Re(le)}function X(ve,le){const Ee=new m.L(ve),Re=Ee.getFirstFieldOfType(p.PU.time),Oe=Ee.getFirstFieldOfType(p.PU.number);return Re||console.error("Time field missing in data frame"),Oe||console.error("Value field missing in data frame"),{level:Oe?(0,y.Ct)(Oe,ve,le):"logs",valueField:Oe,timeField:Re}}function I(ve){return ve instanceof Element}function J(){const ve=new Set;return function(le){let Ee=`${le.dataFrame.refId}_${le.rowId?le.rowId:`${le.timeEpochNs}_${le.entry}`}`;return ve.has(Ee)?!0:(ve.add(Ee),!1)}}function ee(ve,le,Ee){const Re=le.fields.find(Oe=>Oe.name==="labelTypes")?.values[Ee];return Re?Re[ve]??null:null}function q(ve,le,Ee=!1){if(!le.datasourceType)return null;const Re=ee(ve,le.dataFrame,le.rowIndex);return Re?ne(Re,le.datasourceType,Ee):null}function ne(ve,le,Ee){switch(le){case"loki":switch(ve){case"I":return(0,b.t)("logs.fields.type.loki.indexed-label","Indexed label",{count:Ee?2:1});case"S":return(0,b.t)("logs.fields.type.loki.structured-metadata","Structured metadata",{count:Ee?2:1});case"P":return(0,b.t)("logs.fields.type.loki.parsedl-label","Parsed field",{count:Ee?2:1});default:return null}default:return null}}const se="logs.popover.disabled";function oe(){localStorage.setItem(se,"true")}function de(){localStorage.removeItem(se)}function fe(){return!!localStorage.getItem(se)}var ae=(ve=>(ve.Text="text",ve.Json="json",ve.CSV="csv",ve))(ae||{});const ce=async(ve,le,Ee)=>{switch(ve){case"text":(0,P.Zy)({meta:Ee,rows:le});break;case"json":const Re=V(le),Oe=new Blob([JSON.stringify(Re)],{type:"application/json;charset=utf-8"}),Se=`Logs-${(0,h.LE)(new Date)}.json`;a()(Oe,Se);break;case"csv":const Te=new Map;le.forEach(_e=>{_e.dataFrame?.refId&&!Te.has(_e.dataFrame?.refId)&&Te.set(_e.dataFrame?.refId,_e.dataFrame)}),Te.forEach(async _e=>{const He=(0,C.v)(_e);He.push({id:"organize",options:{excludeByName:{labels:!0,labelTypes:!0}}},ie);const tt=await(0,r.s)((0,d.m)(He,[_e]));(0,P.EM)(tt[0],`Logs-${_e.refId}`)})}},ie=()=>ve=>ve.pipe((0,u.T)(le=>le.map(Ee=>{const Re=(0,E.KR)(Ee),Oe={name:"Date",values:Re.timeField?Re.timeField?.values.map(Se=>(0,g.KQ)(Se).toISOString()):[],type:p.PU.other,config:{}};return{...Ee,fields:[Oe,...Ee.fields]}})))},61730:(te,R,e)=>{"use strict";e.d(R,{m:()=>l});var n=e(74848),a=e(22803),s=e(92745),i=e(43173),r=e(63142),u=e(71599);const o=()=>{const f=(0,r.of)(g);return(0,n.jsx)("p",{className:f.description,children:i.$.featureToggles.newDashboardSharingComponent?(0,s.t)("shared-dashboard.delete-modal.revoke-body-text","Are you sure you want to revoke this access? The dashboard can no longer be shared."):(0,s.t)("public-dashboard.delete-modal.revoke-body-text","Are you sure you want to revoke this URL? The dashboard will no longer be public.")})},l=({onConfirm:f,onDismiss:p})=>{const c=i.$.featureToggles.newDashboardSharingComponent?(0,s.t)("shared-dashboard.delete-modal.revoke-title","Revoke access"):(0,s.t)("public-dashboard.delete-modal.revoke-title","Revoke public URL");return(0,n.jsx)(u.u,{isOpen:!0,body:(0,n.jsx)(o,{}),onConfirm:f,onDismiss:p,title:c,icon:"trash-alt",confirmText:c})},g=f=>({title:(0,a.css)({marginBottom:f.spacing(1)}),description:(0,a.css)({fontSize:f.typography.body.fontSize})})},89223:(te,R,e)=>{"use strict";e.d(R,{P:()=>i});var n=e(55860);class a extends Error{constructor(u,o){super(o),this.type=u}}class s{constructor(){this.rootName="general"}validateNewDashboardName(u,o){return this.validate(u,o,"A dashboard or a folder with the same name already exists")}validateNewFolderName(u){return this.validate(this.rootName,u,"A folder or dashboard in the general folder with the same name already exists")}async validate(u,o,l){o=(o||"").trim();const g=o.toLowerCase();if(o.length===0)throw new a("REQUIRED","Name is required");if(g===this.rootName)throw new a("EXISTING","This is a reserved name and cannot be used for a folder.");const p=await(0,n.S)().search({kind:["dashboard"],query:o,location:u||"general"});for(const c of p.view)if(g===c.name.toLowerCase())throw new a("EXISTING",l)}}const i=new s},2559:(te,R,e)=>{"use strict";e.d(R,{Ay:()=>y,J7:()=>r,NZ:()=>i,Rp:()=>f,SN:()=>l,V9:()=>u,dW:()=>c,dd:()=>p,f7:()=>v,oQ:()=>x,qx:()=>s,y3:()=>g});var n=e(65307),a=e(28105),s=(h=>(h[h.Gcom=0]="Gcom",h[h.Json=1]="Json",h))(s||{}),i=(h=>(h.DataSource="datasource",h.Constant="constant",h.LibraryPanel="libraryPanel",h))(i||{}),r=(h=>(h.New="new",h.Exists="exists",h.Different="different",h))(r||{});const u={meta:{updatedAt:"",orgName:""},dashboard:{},source:1,inputs:{},state:a.Gu.NotStarted},o=(0,n.Z0)({name:"manageDashboards",initialState:u,reducers:{setGcomDashboard:(h,d)=>{h.dashboard={...d.payload.json,id:null},h.meta={updatedAt:d.payload.updatedAt,orgName:d.payload.orgName},h.source=0,h.state=a.Gu.Done},setJsonDashboard:(h,d)=>{h.dashboard={...d.payload,id:null},h.meta=u.meta,h.source=1,h.state=a.Gu.Done},clearDashboard:h=>{h.dashboard={},h.state=a.Gu.NotStarted},setInputs:(h,d)=>{h.inputs={dataSources:d.payload.filter(E=>E.type==="datasource"),constants:d.payload.filter(E=>E.type==="constant"),libraryPanels:h.inputs.libraryPanels||[]}},setLibraryPanelInputs:(h,d)=>{h.inputs.libraryPanels=d.payload},fetchFailed:h=>{h.dashboard={},h.state=a.Gu.Error},fetchDashboard:h=>{h.state=a.Gu.Loading}}}),{clearDashboard:l,setInputs:g,setGcomDashboard:f,setJsonDashboard:p,setLibraryPanelInputs:c,fetchFailed:x,fetchDashboard:v}=o.actions,y={importDashboard:o.reducer}},2495:(te,R,e)=>{"use strict";e.d(R,{O5:()=>D,r3:()=>c,dX:()=>h,hZ:()=>o,ri:()=>f,WH:()=>d,AC:()=>l,YX:()=>y,bM:()=>E,A_:()=>b,u:()=>P,D0:()=>m,SM:()=>u,M8:()=>v,YD:()=>p,aD:()=>x});var n=e(59253),a=e(73892),s=e(75816);const r=(0,s.xP)({reducerPath:"migrateToCloudGeneratedAPI",baseQuery:(0,a.W)({baseURL:"/api"}),endpoints:()=>({})}).injectEndpoints({endpoints:M=>({getSessionList:M.query({query:()=>({url:"/cloudmigration/migration"})}),createSession:M.mutation({query:O=>({url:"/cloudmigration/migration",method:"POST",body:O.cloudMigrationSessionRequestDto})}),deleteSession:M.mutation({query:O=>({url:`/cloudmigration/migration/${O.uid}`,method:"DELETE"})}),getSession:M.query({query:O=>({url:`/cloudmigration/migration/${O.uid}`})}),createSnapshot:M.mutation({query:O=>({url:`/cloudmigration/migration/${O.uid}/snapshot`,method:"POST",body:O.createSnapshotRequestDto})}),getSnapshot:M.query({query:O=>({url:`/cloudmigration/migration/${O.uid}/snapshot/${O.snapshotUid}`,params:{resultPage:O.resultPage,resultLimit:O.resultLimit,resultSortColumn:O.resultSortColumn,resultSortOrder:O.resultSortOrder,errorsOnly:O.errorsOnly}})}),cancelSnapshot:M.mutation({query:O=>({url:`/cloudmigration/migration/${O.uid}/snapshot/${O.snapshotUid}/cancel`,method:"POST"})}),uploadSnapshot:M.mutation({query:O=>({url:`/cloudmigration/migration/${O.uid}/snapshot/${O.snapshotUid}/upload`,method:"POST"})}),getShapshotList:M.query({query:O=>({url:`/cloudmigration/migration/${O.uid}/snapshots`,params:{page:O.page,limit:O.limit,sort:O.sort}})}),getResourceDependencies:M.query({query:()=>({url:"/cloudmigration/resources/dependencies"})}),getCloudMigrationToken:M.query({query:()=>({url:"/cloudmigration/token"})}),createCloudMigrationToken:M.mutation({query:()=>({url:"/cloudmigration/token",method:"POST"})}),deleteCloudMigrationToken:M.mutation({query:O=>({url:`/cloudmigration/token/${O.uid}`,method:"DELETE"})}),getDashboardByUid:M.query({query:O=>({url:`/dashboards/uid/${O.uid}`})}),getLibraryElementByUid:M.query({query:O=>({url:`/library-elements/${O.libraryElementUid}`})})}),overrideExisting:!1}),{useGetSessionListQuery:u,useCreateSessionMutation:o,useDeleteSessionMutation:l,useGetSessionQuery:g,useCreateSnapshotMutation:f,useGetSnapshotQuery:p,useCancelSnapshotMutation:c,useUploadSnapshotMutation:x,useGetShapshotListQuery:v,useGetResourceDependenciesQuery:m,useGetCloudMigrationTokenQuery:y,useCreateCloudMigrationTokenMutation:h,useDeleteCloudMigrationTokenMutation:d,useGetDashboardByUidQuery:E,useGetLibraryElementByUidQuery:b}=r,D=r.injectEndpoints({endpoints:M=>({getLocalPluginList:M.query({queryFn:async()=>{try{return{data:await(0,n.Gd)()}}catch(O){return(0,a.s)(O)}}})})}).enhanceEndpoints({addTagTypes:["cloud-migration-token","cloud-migration-session","cloud-migration-snapshot","cloud-migration-resource-dependencies"],endpoints:{getCloudMigrationToken:{providesTags:["cloud-migration-token"]},createCloudMigrationToken:{invalidatesTags:["cloud-migration-token"]},deleteCloudMigrationToken:{invalidatesTags:["cloud-migration-token"]},getSessionList:{providesTags:["cloud-migration-session"]},getSession:{providesTags:["cloud-migration-session"]},createSession:{invalidatesTags:["cloud-migration-session"]},deleteSession:{invalidatesTags:["cloud-migration-session","cloud-migration-snapshot"]},getShapshotList:{providesTags:["cloud-migration-snapshot"]},getSnapshot:{providesTags:["cloud-migration-snapshot"]},createSnapshot:{invalidatesTags:["cloud-migration-snapshot"]},uploadSnapshot:{invalidatesTags:["cloud-migration-snapshot"]},getResourceDependencies:{providesTags:["cloud-migration-resource-dependencies"]},getDashboardByUid:C,getLibraryElementByUid:C,getLocalPluginList:C}});function C(M){if(!M.query)return;const O=M.query;M.query=(...j)=>{const U=O(...j);return U.showErrorAlert=!1,U}}const{useGetLocalPluginListQuery:P}=D},93922:(te,R,e)=>{"use strict";e.d(R,{EC:()=>o,L_:()=>r,YS:()=>i,bA:()=>u,wV:()=>l});var n=e(68143),a=e(6890),s=e(74396);function i(g={getBackendSrv:n.AI}){return async f=>{const p=await g.getBackendSrv().get("/api/org");return f((0,s.bK)(p)),p}}function r(g={getBackendSrv:n.AI}){return async(f,p)=>{const c=p().organization.organization;await g.getBackendSrv().put("/api/org",{name:c.name}),f((0,a.YA)(c.name)),f(i(g))}}function u(g,f={getBackendSrv:n.AI}){return async p=>{const c=await f.getBackendSrv().post("/api/user/using/"+g);p((0,a.YA)(c.name))}}function o(g,f={getBackendSrv:n.AI}){return async p=>{const c=await f.getBackendSrv().post("/api/orgs/",g);p(u(c.orgId))}}function l(g={getBackendSrv:n.AI}){return async f=>{const p=await g.getBackendSrv().get("/api/user/orgs");return f((0,s.Bz)(p)),p}}},74396:(te,R,e)=>{"use strict";e.d(R,{Ay:()=>l,Bz:()=>u,bK:()=>r,n:()=>i});var n=e(65307);const a={organization:{},userOrgs:[]},s=(0,n.Z0)({name:"organization",initialState:a,reducers:{organizationLoaded:(g,f)=>({...g,organization:f.payload}),setOrganizationName:(g,f)=>({...g,organization:{...g.organization,name:f.payload}}),userOrganizationsLoaded:(g,f)=>({...g,userOrgs:f.payload})}}),{setOrganizationName:i,organizationLoaded:r,userOrganizationsLoaded:u}=s.actions,l={organization:s.reducer}},88642:(te,R,e)=>{"use strict";e.d(R,{a:()=>M});var n=e(74848),a=e(22803),s=e(38919),i=e(1906),r=e(51898),u=e(92745),o=e(36490),l=e(36674),g=e(63142),f=e(64400),p=e(96540),c=e(30703);const x=p.forwardRef(({icon:U,children:W,onClick:B,...S},_)=>{const K=(0,g.of)(v);return(0,n.jsxs)("button",{...S,className:K.action,onClick:B,children:[(0,n.jsx)(c.I,{name:U,size:"xl"}),W]})});x.displayName="CardButton";const v=U=>({action:(0,a.css)({display:"flex",flexDirection:"column",height:"100%",justifySelf:"center",cursor:"pointer",background:U.colors.background.secondary,borderRadius:U.shape.radius.default,color:U.colors.text.primary,border:"unset",width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center","&:hover":{background:U.colors.emphasize(U.colors.background.secondary)}})});var m=e(95943),y=e(29043),h=e(42795),d=e(62667),E=e(22429),b=e(72746),D=e(8285),C=e(52763),P=e(87390);function M(U){const W=(0,g.of)(j),B=(0,f.d2)(),S=new s.v2(U.data),{dataSummary:_}=S,K=O(U,_),T=(0,C.wA)(),L=window.__grafanaSceneContext;let A;L instanceof b.H$?A=(0,D.vL)(L,(0,D.XA)(U.panelId)):A=(0,E.UA)().getCurrent()?.getPanelById(U.panelId);const N=()=>{if(y.A.setObject(m.wV,d.__.Suggestions),L){L.state.editPanel?.state.optionsPane?.onToggleVizPicker();return}T((0,h.eK)(!0))},V=()=>{if(A){if(A instanceof l.Eb){A.changePluginType("table");return}T((0,P.gW)({panel:A,pluginId:"table"}))}},z=w=>{A&&(A instanceof l.Eb?A.changePluginType(w.pluginId,w.options,w.fieldConfig):T((0,P.gW)({...w,panel:A})),w.transformations&&setTimeout(()=>{o.Ny.partial({tab:"transform"})},100))};return(0,n.jsxs)("div",{className:W.wrapper,children:[(0,n.jsx)("div",{className:W.message,"data-testid":r.Tp.components.Panels.Panel.PanelDataErrorMessage,children:K}),B.app===i.Jk.PanelEditor&&_.hasData&&A&&(0,n.jsxs)("div",{className:W.actions,children:[U.suggestions&&(0,n.jsx)(n.Fragment,{children:U.suggestions.map(w=>(0,n.jsx)(x,{icon:"process",onClick:()=>z(w),children:w.name},w.name))}),(0,n.jsx)(x,{icon:"table",onClick:V,children:(0,n.jsx)(u.x6,{i18nKey:"panel.panel-data-error-view.switch-to-table",children:"Switch to table"})}),(0,n.jsx)(x,{icon:"chart-line",onClick:N,children:(0,n.jsx)(u.x6,{i18nKey:"panel.panel-data-error-view.open-visualization-suggestions",children:"Open visualization suggestions"})})]})]})}function O({data:U,fieldConfig:W,message:B,needsNumberField:S,needsTimeField:_,needsStringField:K},T){return B||(!U.series||U.series.length===0||U.series.every(L=>L.length===0)?W?.defaults.noValue??(0,u.t)("panel.panel-data-error-view.no-value.default","No data"):K&&!T.hasStringField?(0,u.t)("panel.panel-data-error-view.missing-value.string","Data is missing a string field"):S&&!T.hasNumberField?(0,u.t)("panel.panel-data-error-view.missing-value.number","Data is missing a number field"):_&&!T.hasTimeField?(0,u.t)("panel.panel-data-error-view.missing-value.time","Data is missing a time field"):(0,u.t)("panel.panel-data-error-view.missing-value.unknown","Cannot visualize data"))}const j=U=>({wrapper:(0,a.css)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"}),message:(0,a.css)({textAlign:"center",color:U.colors.text.secondary,fontSize:U.typography.size.lg,width:"100%"}),actions:(0,a.css)({marginTop:U.spacing(2),display:"flex",height:"50%",maxHeight:"150px",columnGap:U.spacing(1),rowGap:U.spacing(1),width:"100%",maxWidth:"600px"})})},41097:(te,R,e)=>{"use strict";e.d(R,{$:()=>p,W:()=>f});var n=e(74848),a=e(96540),s=e(16207),i=e(11594),r=e(92745),u=e(34999),o=e(96221),l=e(42581);class g extends a.PureComponent{constructor(x){super(x)}render(){const x={display:"flex",alignItems:"center",justifyContent:"center",height:"100%"};return(0,n.jsx)("div",{style:x,children:(0,n.jsx)(u.F,{severity:o.Qd.Error,...this.props})})}}function f(c,x){const v=class extends a.PureComponent{render(){const h=(0,n.jsxs)(r.x6,{i18nKey:"panel.panel-plugin-error.text-load-error",children:["Check the server startup logs for more information. ",(0,n.jsx)("br",{}),"If this plugin was loaded from Git, then make sure it was compiled."]});return(0,n.jsx)(g,{title:(0,r.t)("panel.panel-plugin-error.title-load-error","Error loading: {{panelId}}",{panelId:c.id}),text:h})}},m=new s.m(v);return m.meta=c,m.loadError=!0,m}function p(c,x){const v=class extends a.PureComponent{render(){return(0,n.jsx)(g,{title:(0,r.t)("panel.panel-plugin-error.title-not-found","Panel plugin not found: {{id}}",{id:c})})}},m=new s.m(x?()=>null:v);return m.meta={id:c,name:c,sort:100,type:i.QE.panel,module:"",baseUrl:"",info:{author:{name:""},description:"",links:[],logos:{large:"",small:l},screenshots:[],updated:"",version:""}},m}},35307:(te,R,e)=>{"use strict";e.d(R,{m:()=>m});var n=e(74848),a=e(96540),s=e(60188),i=e(60519),r=e(20877),u=e(69168),o=e(92745),l=e(2863),g=e(63142),f=e(64400),p=e(36303),c=e(73427),x=e(92391);const v={defaults:{},overrides:[]};function m(h){const{pluginId:d,data:E,timeZone:b=(0,s.O)(),options:D={},width:C,height:P,title:M,onOptionsChange:O=()=>{},onChangeTimeRange:j=()=>{},onFieldConfigChange:U=()=>{},fieldConfig:W=v}=h,B=(0,g.$j)(),S=(0,l.w)(),_=(0,a.useMemo)(()=>S.replace.bind(S),[S]),[K,T]=(0,a.useState)((0,x.PY)(d)),[L,A]=(0,a.useState)(),N=y(K,D,W),{dataLinkPostProcessor:V}=(0,f.d2)(),z=(0,i.rJ)(K,N?.fieldConfig,E,b,B,_,V);if((0,a.useEffect)(()=>{K&&K.hasPluginId(d)||(0,x.TV)(d).then(H=>T(H)).catch(H=>{A(H.message)})},[d,K]),L)return(0,n.jsx)("div",{children:(0,n.jsxs)(o.x6,{i18nKey:"panel.panel-renderer.failed-to-load-plugin",children:["Failed to load plugin: ",{error:L}]})});if(!K||!K.hasPluginId(d))return(0,n.jsx)("div",{children:(0,n.jsx)(o.x6,{i18nKey:"panel.panel-renderer.loading-plugin-panel",children:"Loading plugin panel..."})});if(!K.panel)return(0,n.jsx)("div",{children:(0,n.jsx)(o.x6,{i18nKey:"panel.panel-renderer.no-panel-component",children:"Seems like the plugin you are trying to load does not have a panel component."})});if(!z)return(0,n.jsx)("div",{children:(0,n.jsx)(o.x6,{i18nKey:"panel.panel-renderer.no-panel-data",children:"No panel data"})});const w=K.panel;return(0,n.jsx)(p.Xw,{dependencies:[K,E],children:(0,n.jsx)(r.a,{meta:K.meta,children:(0,n.jsx)(w,{id:1,data:z,title:M,timeRange:z.timeRange,timeZone:b,options:N.options,fieldConfig:W,transparent:!1,width:C,height:P,renderCounter:0,replaceVariables:H=>H,onOptionsChange:O,onFieldConfigChange:U,onChangeTimeRange:j,eventBus:c.lE})})})}function y(h,d,E){return(0,a.useMemo)(()=>{if(h)return(0,u.F)({plugin:h,currentOptions:d,currentFieldConfig:E,isAfterPluginChange:!1})},[h,E,d])}},54044:(te,R,e)=>{"use strict";e.d(R,{b:()=>y});var n=e(74848),a=e(22803),s=e(70255),i=e(11594),r=e(29246),u=e(51898),o=e(92745),l=e(63142),g=e(76319),f=e(63509),p=e(21348),c=e(85622);const x=38,v=({isCurrent:b,title:D,plugin:C,onClick:P,onDelete:M,disabled:O,showBadge:j,description:U,children:W})=>{const B=(0,l.of)(d),S=O||C.state===i.pn.deprecated,_=(0,a.cx)({[B.item]:!0,[B.itemDisabled]:S,[B.current]:b});return(0,n.jsxs)("div",{className:_,"aria-label":u.Tp.components.PluginVisualization.item(C.name),"data-testid":u.Tp.components.PluginVisualization.item(C.name),onClick:S?void 0:P,title:b?(0,o.t)("panel.panel-type-card.title-click-to-close","Click again to close this section"):C.name,children:[(0,n.jsx)("img",{className:(0,a.cx)(B.img,{[B.disabled]:S}),src:C.info.logos.small,alt:""}),(0,n.jsxs)("div",{className:(0,a.cx)(B.itemContent,{[B.disabled]:S}),children:[(0,n.jsx)("div",{className:B.name,children:D}),U?(0,n.jsx)("span",{className:B.description,children:U}):null,W]}),j&&(0,n.jsx)("div",{className:(0,a.cx)(B.badge,{[B.disabled]:S}),children:(0,n.jsx)(E,{plugin:C})}),M&&(0,n.jsx)(g.K,{name:"trash-alt",onClick:K=>{K.stopPropagation(),M()},className:B.deleteButton,"aria-label":(0,o.t)("panel.panel-type-card.aria-label-delete-button-on-panel-type-card","Delete button on panel type card"),tooltip:(0,o.t)("panel.panel-type-card.tooltip-delete","Delete")})]})};v.displayName="PanelTypeCard";const m=({children:b,hasDescription:D,hasDelete:C,rootProps:P})=>{const M=(0,l.of)(d),O=(0,l.of)(h);return(0,n.jsxs)("div",{className:M.item,...P,children:[(0,n.jsx)(s.A,{className:(0,a.cx)(M.img,O.image),width:x,height:x}),(0,n.jsxs)("div",{className:M.itemContent,children:[(0,n.jsx)("div",{className:M.name,children:(0,n.jsx)(s.A,{width:160})}),D?(0,n.jsx)(s.A,{containerClassName:M.description,width:80}):null,b]}),C&&(0,n.jsx)(s.A,{containerClassName:(0,a.cx)(M.deleteButton,O.deleteButton),width:16,height:16})]})},y=(0,p.j)(v,m),h=()=>({deleteButton:(0,a.css)({lineHeight:1}),image:(0,a.css)({lineHeight:1})}),d=b=>({item:(0,a.css)({position:"relative",display:"flex",flexShrink:0,cursor:"pointer",background:b.colors.background.secondary,borderRadius:b.shape.radius.default,boxShadow:b.shadows.z1,border:`1px solid ${b.colors.background.secondary}`,alignItems:"center",padding:b.spacing(1),width:"100%",overflow:"hidden",[b.transitions.handleMotion("no-preference","reduce")]:{transition:b.transitions.create(["background"],{duration:b.transitions.duration.short})},"&:hover":{background:b.colors.emphasize(b.colors.background.secondary,.03)}}),itemContent:(0,a.css)({overflow:"hidden",position:"relative",padding:b.spacing(0,1)}),itemDisabled:(0,a.css)({cursor:"default","&, &:hover":{background:b.colors.action.disabledBackground}}),current:(0,a.css)({label:"currentVisualizationItem",border:`1px solid ${b.colors.primary.border}`,background:b.colors.action.selected}),disabled:(0,a.css)({opacity:.6,filter:"grayscale(1)",cursor:"default",pointerEvents:"none"}),name:(0,a.css)({textOverflow:"ellipsis",overflow:"hidden",fontSize:b.typography.size.sm,fontWeight:b.typography.fontWeightMedium,width:"100%"}),description:(0,a.css)({display:"block",textOverflow:"ellipsis",overflow:"hidden",color:b.colors.text.secondary,fontSize:b.typography.bodySmall.fontSize,fontWeight:b.typography.fontWeightLight,width:"100%",maxHeight:"4.5em"}),img:(0,a.css)({maxHeight:x,width:x,display:"flex",alignItems:"center"}),badge:(0,a.css)({background:b.colors.background.primary}),deleteButton:(0,a.css)({cursor:"pointer",marginLeft:"auto"})}),E=({plugin:b})=>(0,r.x)(b.signature)?(0,n.jsx)(f.B,{status:b.signature}):(0,n.jsx)(c.p,{state:b.state});E.displayName="PanelPluginBadge"},82472:(te,R,e)=>{"use strict";e.d(R,{a:()=>b});var n=e(74848),a=e(22803),s=e(96540),i=e(16817),r=e(70713),u=e(92745),o=e(63142),l=e(38919),g=e(43173),f=e(92391);const p=["timeseries","barchart","gauge","stat","piechart","bargauge","table","state-timeline","status-history","logs","candlestick","flamegraph","traces","nodeGraph"];async function c(P,M){const O=new l.v2(P,M);for(const U of p){const B=(await(0,f.TV)(U)).getSuggestionsSupplier();B&&B.getSuggestionsForData(O)}const j=O.getList();if(O.dataSummary.fieldCount===0)for(const U of Object.values(g.$.panels))!U.skipDataQuery||U.hideFromList||j.push({name:U.name,pluginId:U.id,description:U.info.description,cardOptions:{imgSrc:U.info.logos.small}});return j.sort((U,W)=>{if(O.dataSummary.preferredVisualisationType){if(U.pluginId===O.dataSummary.preferredVisualisationType)return-1;if(W.pluginId===O.dataSummary.preferredVisualisationType)return 1}return(W.score??l.nQ.OK)-(U.score??l.nQ.OK)})}var x=e(2543),v=e(51898),m=e(45967),y=e(35307);function h({data:P,suggestion:M,onChange:O,width:j}){const U=(0,o.of)(d),{innerStyles:W,outerStyles:B,renderWidth:S,renderHeight:_}=E(j),K=M.cardOptions??{},T={"aria-label":M.name,className:U.vizBox,"data-testid":v.Tp.components.VisualizationPreview.card(M.name),style:B,onClick:()=>{O({pluginId:M.pluginId,options:M.options,fieldConfig:M.fieldConfig})}};if(K.imgSrc)return(0,n.jsx)(m.m,{content:M.description??M.name,children:(0,n.jsxs)("button",{...T,className:(0,a.cx)(U.vizBox,U.imgBox),children:[(0,n.jsx)("div",{className:U.name,children:M.name}),(0,n.jsx)("img",{className:U.img,src:K.imgSrc,alt:M.name})]})});let L=M;return M.cardOptions?.previewModifier&&(L=(0,x.cloneDeep)(M),M.cardOptions.previewModifier(L)),(0,n.jsx)("button",{...T,children:(0,n.jsx)(m.m,{content:M.name,children:(0,n.jsxs)("div",{style:W,className:U.renderContainer,children:[(0,n.jsx)(y.m,{title:"",data:P,pluginId:M.pluginId,width:S,height:_,options:L.options,fieldConfig:L.fieldConfig}),(0,n.jsx)("div",{className:U.hoverPane})]})})})}const d=P=>({hoverPane:(0,a.css)({position:"absolute",top:0,right:0,left:0,borderRadius:P.spacing(2),bottom:0}),vizBox:(0,a.css)({position:"relative",background:"none",borderRadius:P.shape.radius.default,cursor:"pointer",border:`1px solid ${P.colors.border.medium}`,[P.transitions.handleMotion("no-preference","reduce")]:{transition:P.transitions.create(["background"],{duration:P.transitions.duration.short})},"&:hover":{background:P.colors.background.secondary}}),imgBox:(0,a.css)({display:"flex",flexDirection:"column",height:"100%",justifySelf:"center",color:P.colors.text.primary,width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center"}),name:(0,a.css)({paddingBottom:P.spacing(.5),marginTop:P.spacing(-1),fontSize:P.typography.bodySmall.fontSize,whiteSpace:"nowrap",overflow:"hidden",color:P.colors.text.secondary,fontWeight:P.typography.fontWeightMedium,textOverflow:"ellipsis"}),img:(0,a.css)({maxWidth:P.spacing(8),maxHeight:P.spacing(8)}),renderContainer:(0,a.css)({position:"absolute",transformOrigin:"left top",top:"6px",left:"6px"})});function E(P){const O=P,j=P*(1/1.6),U=350,W=U*(1/1.6),B=6,S=(O-B*2)/U,_=(j-B*2)/W;return{renderHeight:W,renderWidth:U,outerStyles:{width:O,height:j},innerStyles:{width:U,height:W,transform:`scale(${S}, ${_})`}}}function b({searchQuery:P,onChange:M,data:O,panel:j,trackSearch:U}){const W=(0,o.of)(C),{value:B}=(0,i.A)(()=>c(O,j),[O,j]),S=(0,s.useMemo)(()=>{const _=D(P,B);return U&&U(P,_.length),_},[P,B,U]);return(0,n.jsx)("div",{children:(0,n.jsx)(r.Ay,{disableHeight:!0,style:{width:"100%",height:"100%"},children:({width:_})=>{if(!_)return null;_=_-1;const K=Math.floor(_/200),T=8*(K-1),L=Math.floor((_-T)/K);return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:W.filterRow,children:(0,n.jsx)("div",{className:W.infoText,children:(0,n.jsx)(u.x6,{i18nKey:"panel.visualization-suggestions.based-on-current-data",children:"Based on current data"})})}),(0,n.jsxs)("div",{className:W.grid,style:{gridTemplateColumns:`repeat(auto-fill, ${L}px)`},children:[S.map((A,N)=>(0,n.jsx)(h,{data:O,suggestion:A,onChange:M,width:L-1},N)),P&&S.length===0&&(0,n.jsx)("div",{className:W.infoText,children:(0,n.jsx)(u.x6,{i18nKey:"panel.visualization-suggestions.no-results-matched-your-query",children:"No results matched your query"})})]})]})}})})}function D(P,M){if(!P||!M)return M||[];const O=new RegExp(P,"i");return M.filter(j=>O.test(j.name)||O.test(j.pluginId))}const C=P=>({heading:(0,a.css)({...P.typography.h5,margin:P.spacing(0,.5,1)}),filterRow:(0,a.css)({display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",paddingBottom:"8px"}),infoText:(0,a.css)({fontSize:P.typography.bodySmall.fontSize,color:P.colors.text.secondary,fontStyle:"italic"}),grid:(0,a.css)({display:"grid",gridGap:P.spacing(1),gridTemplateColumns:"repeat(auto-fill, 144px)",marginBottom:P.spacing(1),justifyContent:"space-evenly"})})},72165:(te,R,e)=>{"use strict";e.d(R,{G:()=>f});var n=e(74848),a=e(22803),s=e(96540),i=e(92745),r=e(63142),u=e(74451),o=e(52193),l=e(54044);const g=({isCurrent:c,plugin:x,onClick:v,disabled:m})=>(0,n.jsx)(l.b,{title:x.name,plugin:x,description:x.info.description,onClick:v,isCurrent:c,disabled:m,showBadge:!0});g.displayName="VizTypePickerPlugin";function f({pluginId:c,searchQuery:x,onChange:v,trackSearch:m}){const y=(0,r.of)(p),h=(0,s.useMemo)(o.A4,[]),d=(0,s.useMemo)(()=>{const E=(0,o.CO)(h,x,c);return m&&m(x,E.length),E},[h,x,c,m]);return d.length===0?(0,n.jsx)(u.Z,{children:(0,n.jsx)(i.x6,{i18nKey:"panel.viz-type-picker.could-anything-matching-query",children:"Could not find anything matching your query"})}):(0,n.jsx)("div",{className:y.grid,children:d.map(E=>(0,n.jsx)(g,{disabled:!1,isCurrent:E.id===c,plugin:E,onClick:b=>v({pluginId:E.id,withModKey:b.metaKey||b.ctrlKey||b.altKey})},E.id))})}const p=c=>({grid:(0,a.css)({maxWidth:"100%",display:"grid",gridGap:c.spacing(.5)}),heading:(0,a.css)({...c.typography.h5,margin:c.spacing(0,.5,1)})})},302:(te,R,e)=>{"use strict";e.d(R,{CH:()=>r,E7:()=>i});var n=e(1682),a=e(82345);const s=u=>{const o=u.field.links;if(!(!o||o.length===0))return{getLinks:l=>{const g={};if(u.view){const{dataFrame:p}=u.view;g.__series={value:{name:p.name,refId:p.refId},text:t("panel.get-field-links-supplier.text.series","Series")};const c=u.colIndex!==void 0?p.fields[u.colIndex]:void 0;if(c){if(g.__field={value:{name:c.name,labels:c.labels},text:t("panel.get-field-links-supplier.text.field","Field")},u.rowIndex!==void 0&&u.rowIndex>=0){const{timeField:x}=getTimeField(p);g.__value={value:{raw:c.values[u.rowIndex],numeric:u.display.numeric,text:formattedValueToString(u.display),time:x?x.values[u.rowIndex]:void 0},text:t("panel.get-field-links-supplier.text.value","Value")}}u.view&&(g.__data={value:{name:p.name,refId:p.refId,fields:getFieldDisplayValuesProxy({frame:p,rowIndex:u.rowIndex})},text:t("panel.get-field-links-supplier.text.data","Data")})}else g.__value={value:{raw:u.display.numeric,numeric:u.display.numeric,text:formattedValueToString(u.display),calc:u.name},text:t("panel.get-field-links-supplier.text.value","Value")}}else console.log("VALUE",u);const f=(p,c,x)=>{const v={...g,...c};return l(p,v,x)};return o.map(p=>getLinkSrv().getDataLinkUIModel(p,f,u))}}},i=(u,o)=>{const l=u.links;if(!(!l||l.length===0))return{getLinks:()=>l.map(g=>(0,a.mQ)().getDataLinkUIModel(g,o||u.replaceVariables,u))}},r=(u,o)=>{const l=n.b4.getPanelLinks(u)?.state.rawLinks;if(!(!l||l.length===0))return{getLinks:()=>l.map(g=>(0,a.mQ)().getDataLinkUIModel(g,o,u))}}},82345:(te,R,e)=>{"use strict";e.d(R,{Fq:()=>E,Hf:()=>C,mQ:()=>U});var n=e(2543),a=e.n(n),s=e(38036),i=e(79609),r=e(16515),u=e(95004),o=e(92138),l=e(63704),g=e(83175),f=e(37615),p=e(92745),c=e(2863),x=e(739),v=e(65642);const m=[{value:`${s.c.keepTime}`,label:"Time range",documentation:"Adds current time range",origin:i.$0.BuiltIn},{value:`${s.c.timeRangeFrom}`,label:"Time range: from",documentation:"Adds current time range's from value",origin:i.$0.BuiltIn},{value:`${s.c.timeRangeTo}`,label:"Time range: to",documentation:"Adds current time range's to value",origin:i.$0.BuiltIn}],y=[{value:`${s.c.seriesName}`,label:"Name",documentation:"Name of the series",origin:i.$0.Series}],h=[{value:`${s.c.valueNumeric}`,label:"Numeric",documentation:"Numeric representation of selected value",origin:i.$0.Value},{value:`${s.c.valueText}`,label:"Text",documentation:"Text representation of selected value",origin:i.$0.Value},{value:`${s.c.valueRaw}`,label:"Raw",documentation:"Raw value",origin:i.$0.Value}],d=W=>W.includes(".")||W.trim().includes(" ")?`["${W}"]`:`.${W}`,E=()=>[...(0,c.w)().getVariables().map(W=>({value:W.name,label:W.name,origin:i.$0.Template})),{value:`${s.c.includeVars}`,label:(0,p.t)("panel.get-panel-links-variable-suggestions.label.all-variables","All variables"),documentation:"Adds current variables",origin:i.$0.Template},...m],b=W=>{const B=[];for(const _ of W)for(const K of _.fields)if(K.labels)for(const T of Object.keys(K.labels))B.push(T);const S=(0,n.chain)(B).flatten().uniq().value();return[{value:`${s.c.fieldName}`,label:(0,p.t)("panel.get-field-vars.label.name","Name"),documentation:"Field name of the clicked datapoint (in ms epoch)",origin:i.$0.Field},...S.map(_=>({value:`__field.labels${d(_)}`,label:`labels.${_}`,documentation:`${_} label value`,origin:i.$0.Field}))]},D=W=>{let B,S;const _=[],K={};if(W.length!==1)return[];const T=W[0];for(const L of T.fields){const A=(0,r.Ct)(L,T,W);K[A]||(_.push({value:`__data.fields${d(A)}`,label:`${A}`,documentation:`Formatted value for ${A} on the same row`,origin:i.$0.Fields}),K[A]=!0,!B&&L.type===u.PU.number&&(B={...L,name:A}),!S&&L.config.displayName&&L.config.displayName!==L.name&&(S={...L,name:A}))}return _.length&&_.push({value:"__data.fields[0]",label:"Select by index",documentation:"Enter the field order",origin:i.$0.Fields}),B&&(_.push({value:`__data.fields${d(B.name)}.numeric`,label:"Show numeric value",documentation:"the numeric field value",origin:i.$0.Fields}),_.push({value:`__data.fields${d(B.name)}.text`,label:"Show text value",documentation:"the text value",origin:i.$0.Fields})),S&&_.push({value:`__data.fields${d(S.name)}`,label:"Select by title",documentation:"Use the title to pick the field",origin:i.$0.Fields}),_},C=(W,B)=>{const S={value:`${s.c.valueTime}`,label:(0,p.t)("panel.get-data-links-variable-suggestions.value-time-var.label.time","Time"),documentation:"Time value of the clicked datapoint (in ms epoch)",origin:i.$0.Value};return B===i.uP.Values?[...y,...b(W),...h,S,...D(W),...E()]:[...y,...b(W),...D(W),...E()]},P=W=>{const B=b(W),S={value:`${DataLinkBuiltInVars.valueCalc}`,label:t("panel.get-calculation-value-data-links-variable-suggestions.value-calc-var.label.calculation-name","Calculation name"),documentation:"Name of the calculation the value is a result of",origin:VariableOrigin.Value};return[...y,...B,...h,S,...E()]};class M{constructor(){this.getDataLinkUIModel=(B,S,_)=>{let K=B.url;B.onBuildUrl&&(K=B.onBuildUrl({origin:_,replaceVariables:S}));const T={href:o.I.assureBaseUrl(K.replace(/\n/g,"")),title:B.title??"",target:B.targetBlank!==void 0?B.targetBlank?"_blank":"_self":void 0,origin:_};return S&&(T.href=S(T.href,void 0,x.$m.UriEncode),T.title=S(B.title)),B.onClick&&(T.onClick=L=>{B.onClick({origin:_,replaceVariables:S,e:L})}),T.href=(0,v.zj)().disableSanitizeHtml?T.href:l.sQ.sanitizeUrl(T.href),T}}getLinkUrl(B){let S=B.url??"";return B.keepTime&&(S=g.kM.appendQueryToUrl(S,`$${s.c.keepTime}`)),B.includeVars&&(S=g.kM.appendQueryToUrl(S,`$${s.c.includeVars}`)),S=(0,c.w)().replace(S),S=o.I.assureBaseUrl(S),(0,v.zj)().disableSanitizeHtml?S:l.sQ.sanitizeUrl(S)}getAnchorInfo(B){const S=(0,c.w)();return{href:this.getLinkUrl(B),title:S.replace(B.title||""),tooltip:S.replace(B.tooltip||"")}}getPanelLinkAnchorInfo(B,S){(0,f.l)("link_srv.ts","getPanelLinkAnchorInfo","getDataLinkUIModel");const _=(K,T,L)=>(0,c.w)().replace(K,{...S,...T},L);return this.getDataLinkUIModel(B,_,{})}}let O;function j(W){O=W}function U(){return O||(O=new M),O}},87390:(te,R,e)=>{"use strict";e.d(R,{Ap:()=>o,O6:()=>l,Xk:()=>f,gW:()=>g});var n=e(69168),a=e(30124),s=e(41097),i=e(37256),r=e(87745),u=e(89224);function o(c){return async(x,v)=>{if(c.libraryPanel?.uid&&!("model"in c.libraryPanel)){x(p(c));return}c.maxDataPoints&&(c.maxDataPoints=Number(c.maxDataPoints));let m=c.type,y=v().plugins.panels[m];if(!y)try{y=await x((0,i.y7)(m))}catch{y=(0,s.$)(m,m==="row")}c.plugin||await c.pluginLoaded(y),x((0,u.XM)({key:c.key,plugin:y}))}}function l(c){return x=>{x((0,u.FC)({key:c}))}}function g({panel:c,pluginId:x,options:v,fieldConfig:m,transformations:y}){return async(h,d)=>{if(c.type===x&&!v&&!m&&!y)return;let b=d().plugins.panels[x];if(b||(b=await h((0,i.y7)(x))),c.type!==x&&c.changePlugin(b),v||m||y){const D=(0,n.F)({plugin:b,currentOptions:v||c.options,currentFieldConfig:m||c.fieldConfig,isAfterPluginChange:!1});c.options=D.options,c.fieldConfig=D.fieldConfig,c.transformations=y||c.transformations,c.configRev++}c.generateNewKey(),h((0,u.XM)({key:c.key,plugin:b}))}}function f(c,x){return async(v,m)=>{const y=x.model.type,h=c.type;if(c.restoreModel({...x.model,gridPos:c.gridPos,id:c.id,libraryPanel:x}),c.getQueryRunner().clearLastResult(),h!==y){let E=m().plugins.panels[y];E||(E=await v((0,i.y7)(y))),await c.pluginLoaded(E),c.generateNewKey(),await v((0,u.XM)({key:c.key,plugin:E}))}else{const d=c.key;c.generateNewKey(),v((0,u.io)({oldKey:d,newKey:c.key}))}c.configRev=0,c.hasSavedPanelEditChange=!0,c.refresh(),c.events.publish(r.zq),c.events.publish(r.PR)}}function p(c){return async(x,v)=>{const m=c.libraryPanel.uid;try{const y=await(0,a.Yr)(m,!0);c.initLibraryPanel(y);const h=v().dashboard.getModel();if(c.repeat&&h){const d=h.panels.findIndex(E=>E.id===c.id);h.repeatPanel(c,d),h.sortPanelsByGridPos(),h.events.publish(new r.Q$)}await x(o(c))}catch(y){console.log("ERROR: ",y),x((0,u.XM)({key:c.key,plugin:(0,s.$)("Unable to load library panel: "+m,!1)}))}}}},89224:(te,R,e)=>{"use strict";e.d(R,{Ay:()=>f,FC:()=>o,XM:()=>i,io:()=>u,nF:()=>r,rG:()=>l});var n=e(65307);const a={},s=(0,n.Z0)({name:"panels",initialState:a,reducers:{panelModelAndPluginReady:(p,c)=>{p[c.payload.key]={plugin:c.payload.plugin}},changePanelKey:(p,c)=>{p[c.payload.newKey]=p[c.payload.oldKey],delete p[c.payload.oldKey]},removePanel:(p,c)=>{delete p[c.payload.key]},removeAllPanels:p=>{Object.keys(p).forEach(c=>delete p[c])},setPanelInstanceState:(p,c)=>{p[c.payload.key].instanceState=c.payload.value}}}),{panelModelAndPluginReady:i,setPanelInstanceState:r,changePanelKey:u,removePanel:o,removeAllPanels:l}=s.actions,f={panels:s.reducer}},52193:(te,R,e)=>{"use strict";e.d(R,{A4:()=>i,CO:()=>o});var n=e(11594),a=e(8934),s=e(65642);function i(){const l=s.$W.panels;return Object.keys(l).filter(g=>l[g].hideFromList===!1).map(g=>l[g]).sort((g,f)=>g.sort-f.sort)}function r(){return i().filter(l=>!!l.skipDataQuery)}function u(){return i().filter(l=>!l.skipDataQuery)}function o(l,g,f){if(!g.length)return l.filter(m=>m.state===n.pn.deprecated?f===m.id:!0);const p=(0,a.xb)(g).toLowerCase(),c=[],x=[],v="graph".startsWith(p);for(const m of l){if(m.state===n.pn.deprecated&&f!==m.id)continue;const h=m.name.toLowerCase().indexOf(p);h===0?c.push(m):h>0?x.push(m):v&&m.id==="timeseries"&&c.push(m)}return c.concat(x)}},4590:(te,R,e)=>{"use strict";e.d(R,{_o:()=>p});var n=e(2543),a=e.n(n),s=e(92138),i=e(83175),r=e(17548),u=e(36490),o=e(5114),l=e(18984);const g={kiosk:!0,autofitpanels:!0,orgId:!0,"_dash.hideTimePicker":!0,"_dash.hideVariables":!0,"_dash.hideLinks":!0};class f extends o.Q{constructor(){super({isPlaying:!1}),this.urls=[],this.index=0,this.numberOfLoops=0,this.locationUpdated=this.locationUpdated.bind(this)}navigateToDashboard(x=!1){const v=this.urls[this.index],m=u.Ny.getSearchObject(),y=(0,n.pickBy)(m,(E,b)=>g[b]),h=s.I.stripBaseFromUrl(v);this.index++,this.validPlaylistUrl=h,this.nextTimeoutId=setTimeout(()=>this.next(),this.interval);const d=h+"?"+i.kM.toUrlParams(y);x?u.Ny.getHistory().replace(d):u.Ny.push(d)}next(){if(clearTimeout(this.nextTimeoutId),this.index>this.urls.length-1){if(this.numberOfLoops++,this.numberOfLoops>=3){window.location.href=this.startUrl;return}this.index=0}this.navigateToDashboard()}prev(){this.index=Math.max(this.index-2,0),this.next()}locationUpdated(x){x.pathname!==this.validPlaylistUrl&&this.stop()}async start(x){this.stop(),this.startUrl=window.location.href,this.index=0,this.setState({isPlaying:!0}),this.locationListenerUnsub=u.Ny.getHistory().listen(this.locationUpdated);const v=[];if(!x.spec.items?.length)return;this.interval=r.intervalToMs(x.spec.interval);const m=await(0,l.qY)(x.spec.items);for(const y of m)if(y.dashboards)for(const h of y.dashboards)v.push(h.url);v.length&&(this.urls=v,this.setState({isPlaying:!0}),this.navigateToDashboard(!0))}stop(){this.state.isPlaying&&(this.index=0,this.setState({isPlaying:!1}),this.locationListenerUnsub&&this.locationListenerUnsub(),this.nextTimeoutId&&clearTimeout(this.nextTimeoutId),u.Ny.getSearchObject().kiosk&&u.Ny.partial({kiosk:null}))}}const p=new f},18984:(te,R,e)=>{"use strict";e.d(R,{GM:()=>g,aV:()=>l,qY:()=>o});var n=e(75505),a=e(88673),s=e(43173),i=e(16310),r=e(8095),u=e(55860);async function o(f){let p=0;if(!f?.length)return[];const c=[];for(const m of f){const y={query:"*",kind:["dashboard"],limit:1e3};switch(m.type){case"dashboard_by_id":throw new Error("invalid item (with id)");case"dashboard_by_uid":y.uid=[m.value];break;case"dashboard_by_tag":y.tags=[m.value];break}c.push({refId:`${p++}`,queryType:r.nj.Search,search:y})}if(!s.$.featureToggles.panelTitleSearch){const m=(0,u.S)(),y=[];for(let h=0;h<c.length;h++){const d=(await m.search(c[h].search)).view;y.push({...f[h],dashboards:d.map(E=>({...E}))})}return y}const x=await(0,i.o)(),v=await(0,n.s)(x.query({targets:c}));if(v.data.length!==f.length)throw new Error("unexpected result size");return f.map((m,y)=>{const h=new a.R(v.data[y]);return{...m,dashboards:h.map(d=>({...d}))}})}function l(){return{spec:{items:[],interval:"5m",title:""},metadata:{name:""},status:{}}}function g(f,p){return p?.length?(p=p.toLowerCase(),f.filter(c=>c.spec.title.toLowerCase().includes(p))):f}},59253:(te,R,e)=>{"use strict";e.d(R,{Ap:()=>v,Bj:()=>l,CB:()=>u,Gd:()=>x,T_:()=>o,XP:()=>m,cu:()=>h,ij:()=>d,xZ:()=>y});var n=e(67458),a=e(68143),s=e(81871),i=e(95256),r=e(4476);async function u(b){const D=await g(b),C=!!D,[P,M,O,j]=await Promise.all([x(),f(b,C),p(b),c(b)]),U=P.find(B=>B.id===b),W=U?.dependencies||D?.json?.dependencies;return{grafanaDependency:W?.grafanaDependency??W?.grafanaVersion??"",pluginDependencies:W?.plugins||[],links:U?.info.links||D?.json?.info.links||[],readme:O||D?.readme,versions:M,statusContext:D?.statusContext??"",iam:D?.json?.iam,lastCommitDate:D?.lastCommitDate,changelog:D?.changelog||j,licenseUrl:D?.licenseUrl,documentationUrl:D?.documentationUrl,sponsorshipUrl:D?.sponsorshipUrl,repositoryUrl:D?.repositoryUrl,raiseAnIssueUrl:D?.raiseAnIssueUrl,signatureType:U?.signatureType||(D?.signatureType!==""?D?.signatureType:void 0),signature:U?.signature,screenshots:D?.json?.info.screenshots||U?.info.screenshots}}async function o(){try{const{items:b}=await(0,a.AI)().get(`${i.P5}/plugins`,{includeDeprecated:!0});return b.filter(r.hY)}catch(b){if((0,a.NF)(b))return b.isHandled=!0,console.error("Failed to fetch plugins from catalog (default https://grafana.com/api/plugins)"),[];throw b}}async function l(){try{return await(0,a.AI)().get(`${i.Sw}/errors`)}catch{return[]}}async function g(b){try{return await(0,a.AI)().get(`${i.P5}/plugins/${b}`,{})}catch(D){(0,a.NF)(D)&&(D.isHandled=!0);return}}async function f(b,D){try{return D?((await(0,a.AI)().get(`${i.P5}/plugins/${b}/versions`)).items||[]).map(P=>({version:P.version,createdAt:P.createdAt,updatedAt:P.updatedAt,isCompatible:P.isCompatible,grafanaDependency:P.grafanaDependency,angularDetected:P.angularDetected})):[]}catch(C){return(0,a.NF)(C)&&(C.isHandled=!0),[]}}async function p(b){try{const D=await(0,a.AI)().get(`${i.Sw}/${b}/markdown/README`);return D?(0,n.G)(D):""}catch(D){return(0,a.NF)(D)&&(D.isHandled=!0),""}}async function c(b){try{const D=await(0,a.AI)().get(`${i.Sw}/${b}/markdown/CHANGELOG`);return D?(0,n.G)(D):""}catch(D){return(0,a.NF)(D)&&(D.isHandled=!0),""}}async function x(){return(await(0,a.AI)().get(`${i.Sw}`,(0,s.F)({embedded:0}))).filter(r.Sq)}async function v(){const{items:b}=await(0,a.AI)().get(`${i.Mi}/plugins`);return b}async function m(){const{items:b}=await(0,a.AI)().get(`${i.Mi}/provisioned-plugins`);return b.map(D=>({slug:D.type}))}async function y(b,D){return await(0,a.AI)().post(`${i.Sw}/${b}/install`,{version:D},{showErrorAlert:!1})}async function h(b){return await(0,a.AI)().post(`${i.Sw}/${b}/uninstall`)}async function d(b,D){return(await(0,a.AI)().datasourceRequest({url:`/api/plugins/${b}/settings`,method:"POST",data:D}))?.data}const E={getRemotePlugins:o,getInstalledPlugins:x,installPlugin:y,uninstallPlugin:h}},40203:(te,R,e)=>{"use strict";e.d(R,{G:()=>i});var n=e(74848),a=e(22803),s=e(63142);const i=({children:u,wrap:o,className:l})=>{const g=(0,s.$j)(),f=r(g,o);return(0,n.jsx)("div",{className:(0,a.cx)(f.container,l),children:u})},r=(u,o)=>({container:(0,a.css)({display:"flex",flexDirection:"row",flexWrap:o?"wrap":"nowrap","& > *":{marginBottom:u.spacing(),marginRight:u.spacing()},"& > *:last-child":{marginRight:0}})})},95256:(te,R,e)=>{"use strict";e.d(R,{Mi:()=>a,P5:()=>s,Sw:()=>n,fu:()=>i});const n="/api/plugins",a="/api/instance",s="/api/gnet",i="plugins"},4476:(te,R,e)=>{"use strict";e.d(R,{Gl:()=>E,H2:()=>v,N6:()=>D,Qi:()=>A,Sq:()=>C,TD:()=>S,UI:()=>L,Xc:()=>y,bM:()=>j,by:()=>m,hY:()=>P,j_:()=>b,kH:()=>c,sP:()=>T,td:()=>g,wD:()=>K});var n=e(84139),a=e(11594),s=e(44922),i=e(43173),r=e(62061),u=e(73427),o=e(11257),l=e(13660);function g({local:N=[],remote:V=[],instance:z=[],provisioned:w=[],pluginErrors:H}){const Q=[],Z=h(H),Y=z.reduce((I,J)=>(I.set(J.pluginSlug,J),I),new Map),X=w.reduce((I,J)=>(I.add(J.slug),I),new Set);return N.forEach(I=>{const J=V.find(q=>q.slug===I.id),ee=Z[I.id];J||Q.push(f(I,void 0,ee))}),V.forEach(I=>{const J=N.find(ne=>ne.id===I.slug),ee=Z[I.slug];if(!(I.status===l.Uy.Deprecated&&!J)){const ne=f(J,I,ee);if(i.$.pluginAdminExternalManageEnabled){ne.isFullyInstalled=ne.isCore?!0:(Y.has(I.slug)||X.has(I.slug))&&ne.isInstalled,ne.isInstalled=Y.has(I.slug)||ne.isInstalled;const se=Y.get(I.slug);ne.isUpdatingFromInstance=Y.has(I.slug)&&ne.hasUpdate&&ne.installedVersion!==se?.version,se?.version&&se?.version!==I.version&&(ne.hasUpdate=!0),ne.isUninstallingFromInstance=!!J&&!Y.has(I.slug),ne.isProvisioned=X.has(I.slug)}Q.push(ne)}}),Q}function f(N,V,z){return!N&&V?p(V,z):N&&!V?c(N,z):x(N,V,z)}function p(N,V){const{name:z,slug:w,description:H,version:Q,orgName:Z,popularity:Y,downloads:X,typeCode:I,updatedAt:J,createdAt:ee,status:q,angularDetected:ne,keywords:se,signatureType:oe,versionSignatureType:de,versionSignedByOrgName:fe,url:ae}=N,ce=!!V;return{description:H,downloads:X,id:w,info:{logos:{small:`${i.$.appSubUrl}/api/gnet/plugins/${w}/versions/${Q}/logos/small`,large:`${i.$.appSubUrl}/api/gnet/plugins/${w}/versions/${Q}/logos/large`},keywords:se},name:z,orgName:Z,popularity:Y,publishedAt:ee,signature:d({remote:N,error:V}),signatureType:oe||de||void 0,signatureOrg:fe,updatedAt:J,hasUpdate:!1,isPublished:!0,isInstalled:ce,isDisabled:ce,isManaged:O(w),isPreinstalled:j(w),isDeprecated:q===l.Uy.Deprecated,isCore:N.internal,isDev:!1,isEnterprise:q===l.Uy.Enterprise,type:I,error:V?.errorCode,angularDetected:ne,isFullyInstalled:ce,latestVersion:N.version,url:ae}}function c(N,V){const{name:z,info:{description:w,version:H,logos:Q,updated:Z,author:Y,keywords:X},id:I,dev:J,type:ee,signature:q,signatureOrg:ne,signatureType:se,hasUpdate:oe,accessControl:de,angularDetected:fe}=N,ae=!!V;return{description:w,downloads:0,id:I,info:{logos:Q,keywords:X},name:z,orgName:Y.name,popularity:0,publishedAt:"",signature:d({local:N,error:V}),signatureOrg:ne,signatureType:se,updatedAt:Z,installedVersion:H,hasUpdate:oe,isInstalled:!0,isDisabled:ae,isCore:q==="internal",isPublished:!1,isDeprecated:!1,isDev:!!J,isEnterprise:!1,isManaged:O(I),isPreinstalled:j(I),type:ee,error:V?.errorCode,accessControl:de,angularDetected:fe,isFullyInstalled:!0,iam:N.iam,latestVersion:N.latestVersion}}function x(N,V,z){const w=N?.info.version,H=V?.slug||N?.id||"",Q=N?.type||V?.typeCode,Z=!!z,Y=V?.keywords||N?.info.keywords||[];let X={small:`/public/build/img/icn-${Q}.svg`,large:`/public/build/img/icn-${Q}.svg`};return V?X={small:`${i.$.appSubUrl}/api/gnet/plugins/${H}/versions/${V.version}/logos/small`,large:`${i.$.appSubUrl}/api/gnet/plugins/${H}/versions/${V.version}/logos/large`}:N&&N.info.logos&&(X=N.info.logos),{description:N?.info.description||V?.description||"",downloads:V?.downloads||0,hasUpdate:N?.hasUpdate||!1,id:H,info:{logos:X,keywords:Y},isCore:!!(V?.internal||N?.signature===a.Ac.internal),isDev:!!N?.dev,isEnterprise:V?.status===l.Uy.Enterprise,isInstalled:!!N||Z,isDisabled:Z,isDeprecated:V?.status===l.Uy.Deprecated,isPublished:!0,isManaged:O(H),isPreinstalled:j(H),name:V?.name||N?.name||"",orgName:V?.orgName||N?.info.author.name||"",popularity:V?.popularity||0,publishedAt:V?.createdAt||"",type:Q,signature:d({local:N,remote:V,error:z}),signatureOrg:N?.signatureOrg||V?.versionSignedByOrgName,signatureType:N?.signatureType||V?.versionSignatureType||V?.signatureType||void 0,updatedAt:V?.updatedAt||N?.info.updated||"",installedVersion:w,error:z?.errorCode,accessControl:N?.accessControl,angularDetected:N?.angularDetected??V?.angularDetected,isFullyInstalled:!!N||Z,iam:N?.iam,latestVersion:N?.latestVersion||V?.version||"",url:V?.url||""}}const v=N=>`${i.$.pluginCatalogURL}${N}`;var m=(N=>(N.nameAsc="nameAsc",N.nameDesc="nameDesc",N.updated="updated",N.published="published",N.downloads="downloads",N))(m||{});const y=(N,V)=>{const z={nameAsc:(w,H)=>w.name.localeCompare(H.name),nameDesc:(w,H)=>H.name.localeCompare(w.name),updated:(w,H)=>(0,s.b)(H.updatedAt).valueOf()-(0,s.b)(w.updatedAt).valueOf(),published:(w,H)=>(0,s.b)(H.publishedAt).valueOf()-(0,s.b)(w.publishedAt).valueOf(),downloads:(w,H)=>H.downloads-w.downloads};return z[V]?N.sort(z[V]):N};function h(N=[]){return N.reduce((V,z)=>(V[z.pluginId]=z,V),{})}function d(N){const{error:V,local:z,remote:w}=N;if(V)switch(V.errorCode){case a.ZK.invalidSignature:return a.Ac.invalid;case a.ZK.missingSignature:return a.Ac.missing;case a.ZK.modifiedSignature:return a.Ac.modified}return z?.signature?z.signature:w?.signatureType&&w?.versionSignatureType?a.Ac.valid:a.Ac.missing}function E(N){if(!N)return;const[V]=N.filter(z=>!!z.isCompatible);return V}const b=()=>i.$.pluginAdminEnabled,D=(N,V,z)=>{const w=i.$.pluginAdminExternalManageEnabled,H=u.TP.hasPermission(o.w.PluginsInstall),Q=!!z;return N.type===a.QE.renderer||N.isEnterprise&&!(0,r.a)("enterprise.plugins")||N.isDev||!H&&!w||!N.isPublished||!Q||!V},C=N=>M(N.id),P=N=>M(N.slug);function M(N){const{pluginCatalogHiddenPlugins:V}=i.$;return!V.includes(N)}function O(N){const{pluginCatalogManagedPlugins:V}=i.$;return V?.includes(N)}function j(N){const{pluginCatalogPreinstalledPlugins:V}=i.$,z=V?.find(w=>w.id===N);return{found:!!z?.id,withVersion:!!z?.version}}function U(N){return N?.signature==="internal"}function W(N){return N.split(" - ")[0]}function B(N){return N.reduce((V,{id:z,name:w,type:H,orgName:Q,info:Z})=>{const Y=Z.keywords?.join(" ").toLowerCase(),X=`${z} - ${w} - ${H} - ${Q} - ${Y}`;return V.push(X),V},[])}function S(N,V){const z=B(N);let H=new n.A({intraMode:1,intraSub:0}).filter(z,V);return H===null?null:H.map(Q=>W(z[Q]))}function _(N){return!(N.isProvisioned||N.isCore||N.type===a.QE.renderer||N.isPreinstalled.withVersion||N.isManaged)}function K(N){return!(!_(N)||!N.hasUpdate||N.isUpdatingFromInstance)}function T(N){return!!(!_(N)||N.isEnterprise&&!(0,r.a)("enterprise.plugins")||!N.isPublished||N.isDisabled||!b())}function L(N){return N?N.angularDetected===!1:!1}function A(N){return N.isDisabled&&N.error===a.ZK.angular}},37256:(te,R,e)=>{"use strict";e.d(R,{JC:()=>j,JJ:()=>d,LR:()=>h,NJ:()=>W,aU:()=>b,ai:()=>M,h9:()=>U,mj:()=>y,nT:()=>O,t5:()=>E,y7:()=>B});var n=e(65307),a=e(65474),s=e(62467),i=e(66847),r=e(45650),u=e(12974),o=e(75505),l=e(43173),g=e(68143),f=e(92391),p=e(19203),c=e(59253),x=e(95256),v=e(4476),m=e(13660);const y=(0,n.zD)(`${x.fu}/fetchAll`,async(_,K)=>{try{K.dispatch({type:`${x.fu}/fetchLocal/pending`}),K.dispatch({type:`${x.fu}/fetchRemote/pending`});const T=l.$.pluginAdminExternalManageEnabled?(0,a.H)((0,c.Ap)()):(0,s.of)(void 0),L=l.$.pluginAdminExternalManageEnabled?(0,a.H)((0,c.XP)()):(0,s.of)(void 0),A=500,N=(0,a.H)((0,c.Bj)()),V=(0,a.H)((0,c.Gd)()),z=(0,a.H)((0,c.T_)()).pipe((0,i.W)(w=>(K.dispatch({type:`${x.fu}/fetchRemote/rejected`}),console.error(w),(0,s.of)([]))));return(0,r.p)({local:V,remote:z,instance:T,provisioned:L,pluginErrors:N}).pipe((0,u.w)({each:A,with:()=>(z.subscribe(async w=>{if(K.dispatch({type:`${x.fu}/fetchRemote/fulfilled`}),w.length>0){const H=await(0,o.s)(V),Q=await(0,o.s)(T),Z=await(0,o.s)(L),Y=await(0,o.s)(N);K.dispatch(b((0,v.td)({local:H,remote:w,instance:Q,provisioned:Z,pluginErrors:Y})))}}),(0,r.p)({local:V,instance:T,provisioned:L,pluginErrors:N}))})).subscribe(({local:w,remote:H,instance:Q,provisioned:Z,pluginErrors:Y})=>{w&&H?(K.dispatch({type:`${x.fu}/fetchLocal/fulfilled`}),K.dispatch({type:`${x.fu}/fetchRemote/fulfilled`}),K.dispatch(b((0,v.td)({local:w,remote:H,instance:Q,provisioned:Z,pluginErrors:Y})))):w&&(K.dispatch({type:`${x.fu}/fetchLocal/fulfilled`}),K.dispatch(b((0,v.td)({local:w,pluginErrors:Y}))))},w=>(console.log(w),K.dispatch({type:`${x.fu}/fetchLocal/rejected`}),K.dispatch({type:`${x.fu}/fetchRemote/rejected`}),K.rejectWithValue("Unknown error."))),null}catch{return K.rejectWithValue("Unknown error.")}}),h=(0,n.zD)(`${x.fu}/fetchAllLocal`,async(_,K)=>{try{return(await(0,c.Gd)()).map(L=>(0,v.kH)(L))}catch{return K.rejectWithValue("Unknown error.")}}),d=(0,n.zD)(`${x.fu}/fetchRemotePlugins`,async(_,K)=>{try{return await(0,c.T_)()}catch(T){return(0,g.NF)(T)&&(T.isHandled=!0),K.rejectWithValue([])}}),E=(0,n.zD)(`${x.fu}/fetchDetails`,async(_,K)=>{try{const T=await(0,c.CB)(_);return{id:_,changes:{details:T}}}catch{return K.rejectWithValue("Unknown error.")}}),b=(0,n.VP)(`${x.fu}/addPlugins`),D=(0,n.VP)(`${x.fu}/addLocalPlugins`),C=(0,n.VP)(`${x.fu}/addLocalPlugins`),P=(0,n.VP)(`${x.fu}/addLocalPlugins`),M=(0,n.zD)(`${x.fu}/install`,async({id:_,version:K,installType:T=m.u8.INSTALL},L)=>{const A={isInstalled:!0,installedVersion:K};T===m.u8.UPDATE&&(A.hasUpdate=!1),T===m.u8.DOWNGRADE&&(A.hasUpdate=!0);try{return await(0,c.xZ)(_,K),await S(),T!==m.u8.INSTALL&&(0,p.sk)(_),{id:_,changes:A}}catch(N){return console.error(N),(0,g.NF)(N)?(N.data.id=_,L.rejectWithValue(N.data)):L.rejectWithValue("Unknown error.")}}),O=(0,n.zD)(`${x.fu}/install`,async()=>({})),j=(0,n.zD)(`${x.fu}/uninstall`,async(_,K)=>{try{return await(0,c.cu)(_),await S(),(0,p.sk)(_),{id:_,changes:{isInstalled:!1,installedVersion:void 0,isFullyInstalled:!1}}}catch(T){return console.error(T),K.rejectWithValue("Unknown error.")}}),U=(0,n.zD)(`${x.fu}/loadPluginDashboards`,async(_,K)=>{const A=`api/plugins/${K.getState().dataSources.dataSource.type}/dashboards`;return(0,g.AI)().get(A)}),W=(0,n.VP)(`${x.fu}/panelPluginLoaded`),B=_=>async(K,T)=>{let L=T().plugins.panels[_];return L||(L=await(0,f.TV)(_),T().plugins.panels[_]||K(W(L))),L};function S(){return(0,g.AI)().get("/api/frontend/settings").then(_=>{l.$.panels=_.panels})}},54687:(te,R,e)=>{"use strict";e.d(R,{AI:()=>r,Ff:()=>c});var n=e(65307),a=e(95256),s=e(13660),i=e(37256);const r=(0,n.pU)(),u=x=>new RegExp(`${a.fu}/(.*)/pending`).test(x.type),o=x=>new RegExp(`${a.fu}/(.*)/fulfilled`).test(x.type),l=x=>new RegExp(`${a.fu}/(.*)/rejected`).test(x.type),g=x=>{const v=x.lastIndexOf("/");return x.substring(0,v)},f={items:r.getInitialState(),requests:{},plugins:[],errors:[],searchQuery:"",hasFetched:!1,dashboards:[],isLoadingPluginDashboards:!1,panels:{}},c=(0,n.Z0)({name:"plugins",initialState:f,reducers:{},extraReducers:x=>x.addCase(i.aU,(v,m)=>{r.upsertMany(v.items,m.payload)}).addCase(i.LR.fulfilled,(v,m)=>{r.upsertMany(v.items,m.payload)}).addCase(i.t5.fulfilled,(v,m)=>{r.updateOne(v.items,m.payload)}).addCase(i.ai.fulfilled,(v,m)=>{r.updateOne(v.items,m.payload)}).addCase(i.JC.fulfilled,(v,m)=>{r.updateOne(v.items,m.payload)}).addCase(i.NJ,(v,m)=>{v.panels[m.payload.meta.id]=m.payload}).addCase(i.h9.pending,(v,m)=>{v.isLoadingPluginDashboards=!0,v.dashboards=[]}).addCase(i.h9.fulfilled,(v,m)=>{v.isLoadingPluginDashboards=!1,v.dashboards=m.payload}).addMatcher(u,(v,m)=>{v.requests[g(m.type)]={status:s.IZ.Pending}}).addMatcher(o,(v,m)=>{v.requests[g(m.type)]={status:s.IZ.Fulfilled}}).addMatcher(l,(v,m)=>{v.requests[g(m.type)]={status:s.IZ.Rejected,error:m.payload}})}).reducer},13660:(te,R,e)=>{"use strict";e.d(R,{IZ:()=>o,Ip:()=>a,LZ:()=>u,Uy:()=>s,og:()=>r,u8:()=>i,vk:()=>n});var n=(l=>(l.Home="plugins-home",l.Browse="plugins-browse",l.Details="plugins-details",l))(n||{}),a=(l=>(l.app="apps",l.datasource="database",l.panel="credit-card",l.renderer="capture",l))(a||{}),s=(l=>(l.Deleted="deleted",l.Active="active",l.Pending="pending",l.Deprecated="deprecated",l.Enterprise="enterprise",l))(s||{}),i=(l=>(l.INSTALL="INSTALL",l.UNINSTALL="UNINSTALL",l.UPDATE="UPDATE",l.REINSTALL="REINSTALL",l.DOWNGRADE="DOWNGRADE",l))(i||{}),r=(l=>(l.OVERVIEW="Overview",l.VERSIONS="Version history",l.CONFIG="Config",l.DASHBOARDS="Dashboards",l.USAGE="Usage",l.IAM="IAM",l.CHANGELOG="Changelog",l.PLUGINDETAILS="Plugin details",l.DATASOURCE_CONNECTIONS="Data source connections",l.SCREENSHOTS="Screenshots",l))(r||{}),u=(l=>(l.OVERVIEW="overview",l.VERSIONS="version-history",l.CONFIG="config",l.DASHBOARDS="dashboards",l.USAGE="usage",l.IAM="iam",l.CHANGELOG="changelog",l.PLUGINDETAILS="right-panel",l.DATASOURCE_CONNECTIONS="datasource-connections",l.SCREENSHOTS="screenshots",l))(u||{}),o=(l=>(l.Pending="Pending",l.Fulfilled="Fulfilled",l.Rejected="Rejected",l))(o||{})},22465:(te,R,e)=>{"use strict";e.d(R,{K:()=>i});var n=e(74848),a=e(96540),s=e(79450);class i extends a.Component{static{this.contextType=s.b}constructor(u){super(u),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(u){return{hasError:!0,error:u,errorInfo:null}}componentDidCatch(u,o){this.props.onError?this.props.onError(u,o):console.error(`Plugin "${this.context?.meta.id}" failed to load:`,u,o),this.setState({error:u,errorInfo:o})}render(){const u=this.props.fallback;return this.state.hasError?u?(0,n.jsx)(u,{error:this.state.error,errorInfo:this.state.errorInfo}):null:this.props.children}}},70715:(te,R,e)=>{"use strict";e.d(R,{A:()=>a,S:()=>i});var n=e(96540);const a=(0,n.createContext)(s());a.displayName="PluginPageContext";function s(){return{sectionNav:{main:{text:"Plugin page"},node:{text:"Plugin page"}}}}function i(r){return{sectionNav:r??s().sectionNav}}},85622:(te,R,e)=>{"use strict";e.d(R,{p:()=>r});var n=e(74848),a=e(11594),s=e(92745),i=e(99887);const r=o=>{const l=u(o.state);return l?(0,n.jsx)(i.E,{className:o.className,color:l.color,title:typeof l.tooltip=="string"?l.tooltip:void 0,tooltip:typeof l.tooltip!="string"?l.tooltip:void 0,text:l.text,icon:l.icon}):null};function u(o){switch(o){case a.pn.deprecated:return{text:(0,s.t)("plugins.get-feature-state-info.text.deprecated","Deprecated"),color:"red",tooltip:"This feature is deprecated and will be removed in a future release"};case a.pn.alpha:return{text:(0,s.t)("plugins.get-feature-state-info.text.alpha","Alpha"),color:"blue",tooltip:"This feature is experimental and future updates might not be backward compatible"};case a.pn.beta:return{text:(0,s.t)("plugins.get-feature-state-info.text.beta","Beta"),color:"blue",tooltip:"This feature is close to complete but not fully tested"};default:return null}}},28998:(te,R,e)=>{"use strict";e.d(R,{tR:()=>E,xq:()=>m});var n=e(94644),a=e(32899),s=e(8134),i=e(28105),r=e(2863),u=e(36580),o=e(68143),l=e(78282),g=e(55315),f=e(45229),p=e(65642),c=e(29328),x=e(4651),v=e(59922);class m{constructor(D=(0,r.w)()){this.templateSrv=D,this.datasources={},this.settingsMapByName={},this.settingsMapByUid={},this.settingsMapById={},this.runtimeDataSources={},this.defaultName=""}init(D,C){this.datasources={},this.settingsMapByUid={},this.settingsMapByName=D,this.defaultName=C;for(const P of Object.values(D))P.uid||(P.uid=P.name),this.settingsMapByUid[P.uid]=P,this.settingsMapById[P.id]=P;for(const P of Object.values(this.runtimeDataSources))this.datasources[P.uid]=P,this.settingsMapByUid[P.uid]=P.instanceSettings;this.datasources[u.dR.type]=c.Ex,this.datasources[x.Uj]=c.Ex,this.settingsMapByUid[u.dR.uid]=c.$i,this.settingsMapByUid[x.Uj]=c.$i}registerRuntimeDataSource(D){if(this.runtimeDataSources[D.dataSource.uid])throw new Error(`A runtime data source with uid ${D.dataSource.uid} has already been registered`);if(this.settingsMapByUid[D.dataSource.uid])throw new Error(`A data source with uid ${D.dataSource.uid} has already been registered`);this.runtimeDataSources[D.dataSource.uid]=D.dataSource,this.datasources[D.dataSource.uid]=D.dataSource,this.settingsMapByUid[D.dataSource.uid]=D.dataSource.instanceSettings}getDataSourceSettingsByUid(D){return this.settingsMapByUid[D]}getInstanceSettings(D,C){let P=y(D);if((0,u.s9)(P))return c.$i;if(P==="default"||P==null)return this.settingsMapByUid[this.defaultName]??this.settingsMapByName[this.defaultName];if(P[0]==="$"){const M=this.templateSrv.replace(P,C,h);let O;return M==="default"?O=this.settingsMapByName[this.defaultName]:O=this.settingsMapByUid[M]??this.settingsMapByName[M],O?{...O,isDefault:!1,name:P,uid:P,rawRef:{type:O.type,uid:O.uid}}:void 0}return this.settingsMapByUid[P]??this.settingsMapByName[P]??this.settingsMapById[P]}get(D,C){let P=y(D);if(!P){if(d(D)){const O=this.getList({type:D.type});if(!O?.length)return Promise.reject("no datasource of type");const j=O.find(U=>U.isDefault)??O[0];return this.get(j.uid)}return this.get(this.defaultName)}if((0,u.s9)(D))return Promise.resolve(this.datasources[x.Uj]);const M=this.settingsMapByName[P];return M&&(P=M.uid),this.datasources[P]?Promise.resolve(this.datasources[P]):(P=this.templateSrv.replace(P,C,h),P==="default"&&this.defaultName!=="default"?this.get(this.defaultName):this.datasources[P]?Promise.resolve(this.datasources[P]):this.loadDatasource(P))}async loadDatasource(D){if(this.datasources[D])return Promise.resolve(this.datasources[D]);const C=this.getInstanceSettings(D);if(!C)return Promise.reject({message:`Datasource ${D} was not found`});try{const P=await(0,v.cS)(C.meta);if(this.datasources[D])return this.datasources[D];const M=new P.DataSourceClass(C);if(M.components=P.components,M.userStorage||(M.userStorage=new g.X(C.type)),!(M instanceof n.mA)){const O=M;O.name=C.name,O.id=C.id,O.type=C.type,O.meta=C.meta,O.uid=C.uid,O.getRef=n.mA.prototype.getRef}return this.datasources[D]=M,this.datasources[M.uid]=M,M}catch(P){return P instanceof Error&&f.A.emit(a.r1.alertError,[C.name+" plugin failed",P.toString()]),Promise.reject({message:`Datasource: ${D} was not found`})}}getAll(){return Object.values(this.settingsMapByName)}getList(D={}){const C=Object.values(this.settingsMapByName).filter(M=>{if(M.meta.id==="grafana"||M.meta.id==="mixed"||M.meta.id==="dashboard"||D.metrics&&!M.meta.metrics||D.tracing&&!M.meta.tracing||D.logs&&M.meta.category!=="logging"&&!M.meta.logs||D.annotations&&!M.meta.annotations||D.alerting&&!M.meta.alerting||D.pluginId&&!(0,s._)(D.pluginId,M.meta)||D.filter&&!D.filter(M))return!1;if(D.type){if(Array.isArray(D.type)){if(!D.type.includes(M.type))return!1}else if(!(M.type===D.type||M.meta.aliasIDs?.includes(D.type)))return!1}return!(!D.all&&M.meta.metrics!==!0&&M.meta.annotations!==!0&&M.meta.tracing!==!0&&M.meta.logs!==!0&&M.meta.alerting!==!0)});if(D.variables)for(const M of this.templateSrv.getVariables()){if(M.type!=="datasource")continue;let O=M.current.value==="default"?this.defaultName:M.current.value;Array.isArray(O)&&(O=O[0]);const j=!Array.isArray(O)&&(this.settingsMapByName[O]||this.settingsMapByUid[O]);if(j){const U=`\${${M.name}}`;C.push({...j,isDefault:!1,name:U,uid:U})}}const P=C.sort((M,O)=>M.name.toLowerCase()>O.name.toLowerCase()?1:M.name.toLowerCase()<O.name.toLowerCase()?-1:0);if(!D.pluginId&&!D.alerting){if(D.mixed){const M=this.getInstanceSettings("-- Mixed --");M&&C.push(M)}if(D.dashboard){const M=this.getInstanceSettings("-- Dashboard --");M&&C.push(M)}if(!D.tracing){const M=this.getInstanceSettings("-- Grafana --");M&&D.filter?.(M)!==!1&&C.push(M)}}return P}getExternal(){return this.getList()}getAnnotationSources(){return this.getList({annotations:!0,variables:!0}).map(D=>({name:D.name,value:D.name,meta:D.meta}))}getMetricSources(D){return this.getList({metrics:!0,variables:!D?.skipVariables}).map(C=>({name:C.name,value:C.name,meta:C.meta}))}async reload(){const D=await(0,o.AI)().get("/api/frontend/settings");p.Ay.datasources=D.datasources,p.Ay.defaultDatasource=D.defaultDatasource,this.init(D.datasources,D.defaultDatasource)}}function y(b){return(0,u.s9)(b)?u.dR.uid:typeof b=="string"?b:b?.uid}function h(b){return Array.isArray(b)?b[0]:b}const d=b=>!!(b&&(0,i.Gv)(b)&&"type"in b),E=()=>(0,l.l)()},28337:(te,R,e)=>{"use strict";e.d(R,{AZ:()=>p,OG:()=>o,TX:()=>l,ZV:()=>f,ov:()=>g});var n=e(74848),a=e(96540);const s=(0,a.createContext)(void 0),i=(0,a.createContext)(void 0),r=(0,a.createContext)(void 0),u=(0,a.createContext)(void 0);function o(){const c=(0,a.useContext)(s);if(!c)throw new Error("No `AddedLinksRegistryContext` found.");return c}function l(){const c=(0,a.useContext)(i);if(!c)throw new Error("No `AddedComponentsRegistryContext` found.");return c}function g(){const c=(0,a.useContext)(r);if(!c)throw new Error("No `AddedFunctionsRegistry` found.");return c}function f(){const c=(0,a.useContext)(u);if(!c)throw new Error("No `ExposedComponentsRegistryContext` found.");return c}const p=({registries:c,children:x})=>(0,n.jsx)(s.Provider,{value:c.addedLinksRegistry,children:(0,n.jsx)(i.Provider,{value:c.addedComponentsRegistry,children:(0,n.jsx)(r.Provider,{value:c.addedFunctionsRegistry,children:(0,n.jsx)(u.Provider,{value:c.exposedComponentsRegistry,children:x})})})})},4745:(te,R,e)=>{"use strict";e.d(R,{$$:()=>E,Bc:()=>d,Bs:()=>n,Cf:()=>l,E5:()=>y,FL:()=>x,H$:()=>o,O6:()=>u,Ri:()=>a,Td:()=>f,bw:()=>r,cu:()=>h,iS:()=>m,ij:()=>c,o2:()=>s,sm:()=>v,vT:()=>g,z5:()=>p});const n='Invalid usage of extension point. Reason: Extension point id should be prefixed with your plugin id, e.g "myorg-foo-app/toolbar/v1".',a='Invalid usage of extension point. Reason: The extension point is not recorded in the "plugin.json" file. Extension points must be listed in the section "extensions.extensionPoints[]". Returning an empty array of extensions.',s="Title is missing.",i="Description is missing.",r='The "fn" argument is invalid, it should be a function.',u='The "configure" function is invalid. It should be a function.',o='Either "path" or "onClick" is required.',l='The "path" is required and should start with "/a/<pluginId>".',g="The component id does not match the id naming convention. Id should be prefixed with plugin id. e.g 'myorg-basic-app/my-component-id/v1'.",f="An exposed component with the same id already exists.",p='The exposed component was not recorded in the plugin.json. Exposed component extensions must be listed in the section "extensions.exposedComponents[]". Currently, this is only required in development but will be enforced also in production builds in the future.',c='Invalid usage of extension point. Reason: The exposed component is not recorded in the "plugin.json" file. Exposed components must be listed in the dependencies[] section.',x='The extension was not recorded in the plugin.json. Added component extensions must be listed in the section "extensions.addedComponents[]". Currently, this is only required in development but will be enforced also in production builds in the future.',v=`The "title" doesn't match the title recorded in plugin.json.`,m='The extension was not recorded in the plugin.json. Added link extensions must be listed in the section "extensions.addedLinks[]". Currently, this is only required in development but will be enforced also in production builds in the future.',y='The extension was not recorded in the plugin.json. Added function extensions must be listed in the section "extensions.addedFunction[]". Currently, this is only required in development but will be enforced also in production builds in the future.',h=`The "description" doesn't match the description recorded in plugin.json.`,d='The "targets" for the registered extension does not match the targets recorded in plugin.json. Currently, this is only required in development but will be enforced also in production builds in the future.',E=b=>`The app plugin with plugin id "${b}" was not found.`},8001:(te,R,e)=>{"use strict";e.d(R,{dp:()=>x,m5:()=>p,zN:()=>c});var n=e(2543),a=e.n(n),s=e(49510),i=e(16126),r=e(81160),u=e(54092),o=e(96016),l=e(63629),g=e(3260);const f=m=>(0,s.z)([l.qm.addedComponentsRegistry.asObservable(),l.qm.addedLinksRegistry.asObservable()]).pipe((0,i.p)(([y,h])=>!!y&&!!h),(0,r.T)(([y,h])=>v({...m,addedComponentsRegistry:y,addedLinksRegistry:h}))),p=m=>f(m).pipe((0,r.T)(y=>y.extensions.filter(h=>h.type===u.u.link))),c=m=>f(m).pipe((0,r.T)(y=>y.extensions.filter(h=>h.type===u.u.component)));function x(m){let y,h;return m.addedComponentsRegistry.asObservable().subscribe(d=>{y=d}),m.addedLinksRegistry.asObservable().subscribe(d=>{h=d}),d=>v({...d,addedComponentsRegistry:y,addedLinksRegistry:h})}const v=({context:m,extensionPointId:y,limitPerPlugin:h,addedLinksRegistry:d,addedComponentsRegistry:E})=>{const b=m?(0,g.$Y)(m):{},D=[],C={};for(const M of d?.[y]??[])try{const{pluginId:O}=M;if(h&&C[O]>=h)continue;C[O]===void 0&&(C[O]=0);const j=o.R.child({pluginId:O,extensionPointId:y,path:M.path??"",title:M.title,description:M.description??"",onClick:typeof M.onClick}),U=(0,g.hS)(O,M,j,b);if(M.configure&&U===void 0)continue;const W=U?.path||M.path,B={id:(0,g.yt)(O,y,M.title),type:u.u.link,pluginId:O,onClick:(0,g.dx)(O,y,M,j,b),icon:U?.icon||M.icon,title:U?.title||M.title,description:U?.description||M.description||"",path:(0,n.isString)(W)?(0,g.YS)(O,W,y):void 0,category:U?.category||M.category};D.push(B),C[O]+=1}catch(O){O instanceof Error&&o.R.error(O.message,{stack:O.stack??"",message:O.message})}const P=E?.[y]??[];for(const M of P){if(h&&C[M.pluginId]>=h)continue;C[M.pluginId]===void 0&&(C[M.pluginId]=0);const O=o.R.child({title:M.title,description:M.description??"",pluginId:M.pluginId}),j={id:(0,g.yt)(M.pluginId,y,M.title),type:u.u.component,pluginId:M.pluginId,title:M.title,description:M.description??"",component:(0,g.nv)({pluginId:M.pluginId,extensionTitle:M.title,Component:M.component,log:O})};D.push(j),C[M.pluginId]+=1}return{extensions:D}}},96016:(te,R,e)=>{"use strict";e.d(R,{R:()=>x});var n=e(2543),a=e.n(n),s=e(43561),i=e(39741),r=e(67770),u=e(25992),o=e(43173);const l="ui-extension-logs",g=1e3,f=1e3*60*10,p=(0,u.DW)(l);class c{constructor(m,y,h){this.baseLabels=m,this.channel=h??new BroadcastChannel(l),this.subject=y??new i.m(g,f),h||(this.channel.onmessage=d=>this.subject.next(d.data))}info(m,y){this.log(r.$b.info,m,y)}warning(m,y){p.logWarning(m,{...this.baseLabels,...y}),o.$.buildInfo.env==="development"&&console.warn(m,{...this.baseLabels,...y}),this.log(r.$b.warning,m,y)}error(m,y){p.logError(new Error(m),{...this.baseLabels,...y}),console.error(m,{...this.baseLabels,...y}),this.log(r.$b.error,m,y)}debug(m,y){this.log(r.$b.debug,m,y)}trace(m,y){this.log(r.$b.trace,m,y)}fatal(m,y){this.log(r.$b.fatal,m,y)}log(m,y,h){const d={...h,...this.baseLabels},{pluginId:E,extensionPointId:b}=d,D={level:m,labels:d,timestamp:Date.now(),id:(0,s.Ak)(),message:y,pluginId:(0,n.isString)(E)?E:void 0,extensionPointId:(0,n.isString)(b)?b:void 0};this.subject.next(D),this.channel.postMessage(D)}asObservable(){return this.subject.asObservable()}child(m){return new c({...m,...this.baseLabels},this.subject,this.channel)}}const x=new c},63629:(te,R,e)=>{"use strict";e.d(R,{a9:()=>T,rH:()=>N,lQ:()=>A,eY:()=>L,qm:()=>V});var n=e(74848),a=e(54092),s=e(73427),i=e(8535),r=e(11257),u=e(96016),o=e(3260),l=e(35231),g=e(19050),f=e(49987),p=e(39338);function c(){try{return[(0,o.xJ)({title:"Add to dashboard",description:"Use the query and panel from explore and create/add it to a dashboard",targets:[a.S.ExploreToolbarAction],icon:"apps",category:"Dashboards",configure:()=>{if(s.TP.hasPermission(r.w.DashboardsCreate)||s.TP.hasPermission(r.w.DashboardsWrite))return{}},onClick:(z,{context:w,openModal:H})=>{H({title:(0,p.t)(),body:({onDismiss:Q})=>(0,n.jsx)(f.H,{onClose:Q,exploreId:w?.exploreId})})}}),(0,o.xJ)({title:"Add correlation",description:"Create a correlation from this query",targets:[a.S.ExploreToolbarAction],icon:"link",configure:z=>z?.shouldShowAddCorrelation?{}:void 0,onClick:(z,{context:w})=>{(0,i.JD)((0,l.am)({editorMode:!0})),(0,i.JD)((0,g.Od)({exploreId:w.exploreId}))}})]}catch(z){return u.R.warning(`Could not configure extensions for Explore due to: "${z}"`),[]}}function x(){return[...c()]}var v=e(4745),m=e(9453),y=e(13752),h=e(39741),d=e(29405),E=e(96222),b=e(81160),D=e(72985);const C="Cannot register to a read-only registry";class P{constructor(w){if(this.resultSubject=new y.B,this.logger=w.log??u.R,this.isReadOnly=!1,w.registrySubject){this.registrySubject=w.registrySubject,this.isReadOnly=!0;return}this.registrySubject=new h.m(1),this.resultSubject.pipe((0,d.S)(this.mapToRegistry.bind(this),w.initialState??{}),(0,E.Z)(w.initialState??{}),(0,b.T)(H=>(0,o.ol)(H))).subscribe(this.registrySubject)}register(w){if(this.isReadOnly)throw new Error(C);this.resultSubject.next(w)}asObservable(){return this.registrySubject.asObservable()}getState(){return(0,D._)(this.asObservable())}}const M="Could not register component extension. Reason:";class O extends P{constructor(w={}){super(w)}mapToRegistry(w,H){const{pluginId:Q,configs:Z}=H;for(const Y of Z){const X=this.logger.child({description:Y.description,title:Y.title,pluginId:Q});if(!Y.title){X.error(`${M} ${v.o2}`);continue}if(Q!=="grafana"&&(0,o.V2)()&&(0,m.dt)(Q,Y,X))continue;const I=Array.isArray(Y.targets)?Y.targets:[Y.targets];for(const J of I){const ee=X.child({extensionPointId:J}),q={pluginId:Q,component:(0,o.nv)({pluginId:Q,extensionTitle:Y.title,Component:Y.component,log:ee}),description:Y.description,title:Y.title};ee.debug("Added component extension successfully registered"),J in w?w[J].push(q):w[J]=[q]}}return w}readOnly(){return new O({registrySubject:this.registrySubject})}}var j=e(2543);const U="Could not register function extension. Reason:";class W extends P{constructor(w={}){super(w)}mapToRegistry(w,H){const{pluginId:Q,configs:Z}=H;for(const Y of Z){const X=this.logger.child({title:Y.title,pluginId:Q});if(!Y.title){X.error(`${U} ${v.o2}`);continue}if(!(0,j.isFunction)(Y.fn)){X.error(`${U} ${v.bw}`);continue}if(Q!=="grafana"&&(0,o.V2)()&&(0,m.SY)(Q,Y,X))continue;const I=Array.isArray(Y.targets)?Y.targets:[Y.targets];for(const J of I){const ee=X.child({extensionPointId:J}),q={pluginId:Q,fn:Y.fn,description:Y.description,title:Y.title,extensionPointId:J};ee.debug("Added function extension successfully registered"),J in w?w[J].push(q):w[J]=[q]}}return w}readOnly(){return new W({registrySubject:this.registrySubject})}}const B="Could not register link extension. Reason:";class S extends P{constructor(w={}){super(w)}mapToRegistry(w,H){const{pluginId:Q,configs:Z}=H;for(const Y of Z){const{path:X,title:I,description:J,configure:ee,onClick:q,targets:ne}=Y,se=this.logger.child({path:X??"",description:J??"",title:I,pluginId:Q,onClick:typeof q});if(!I){se.error(`${B} ${v.o2}`);continue}if(!(0,m.jk)(ee)){se.error(`${B} ${v.O6}`);continue}if(!X&&!q){se.error(`${B} ${v.H$}`);continue}if(X&&!(0,m.kl)(Q,X)){se.error(`${B} ${v.Cf}`);continue}if(Q!=="grafana"&&(0,o.V2)()&&(0,m.OO)(Q,Y,se))continue;const oe=Array.isArray(ne)?ne:[ne];for(const de of oe){const fe=se.child({extensionPointId:de}),{targets:ae,...ce}=Y;de in w||(w[de]=[]),fe.debug("Added link extension successfully registered"),w[de].push({...ce,pluginId:Q,extensionPointId:de})}}return w}readOnly(){return new S({registrySubject:this.registrySubject})}}const _="Could not register exposed component. Reason:";class K extends P{constructor(w={}){super(w)}mapToRegistry(w,{pluginId:H,configs:Q}){if(!Q)return w;for(const Z of Q){const{id:Y,description:X,title:I}=Z,J=this.logger.child({extensionPointId:Y,description:X??"",title:I,pluginId:H});if(!Y.startsWith(H)){J.error(`${_} ${v.vT}`);continue}if(w[Y]){J.error(`${_} ${v.Td}`);continue}if(!I){J.error(`${_} ${v.o2}`);continue}H!=="grafana"&&(0,o.V2)()&&(0,m.nl)(H,Z,J)||(J.debug("Exposed component extension successfully registered"),w[Y]={...Z,pluginId:H})}return w}readOnly(){return new K({registrySubject:this.registrySubject})}}const T=new O,L=new K,A=new S,N=new W,V={addedComponentsRegistry:T,exposedComponentsRegistry:L,addedLinksRegistry:A,addedFunctionsRegistry:N};A.register({pluginId:"grafana",configs:x()})},3260:(te,R,e)=>{"use strict";e.d(R,{xJ:()=>V,N9:()=>H,ol:()=>j,yt:()=>U,uS:()=>I,Xs:()=>oe,mi:()=>de,Uy:()=>ne,Ce:()=>ee,UX:()=>q,dx:()=>Z,hS:()=>Q,YS:()=>Y,$Y:()=>_,V2:()=>X,pL:()=>w,nv:()=>M,J7:()=>T});var n=e(74848),a=e(22803),s=e(2543),i=e(16817),r=e(20877),u=e(25229),o=e(83175),l=e(54092),g=e(27489),f=e(43173),p=e(22787),c=e(45229),x=e(95027),v=e(87745),m=e(22465),y=e(92745),h=e(34999);const d=({pluginId:fe,extensionTitle:ae})=>(0,n.jsx)(h.F,{title:(0,y.t)("plugins.extensions.extension-error-alert-title",'Extension failed to load: "{{pluginId}}/{{extensionTitle}}"',{pluginId:fe,extensionTitle:ae}),severity:"error",children:(0,y.t)("plugins.extensions.extension-error-alert-description","Check the console for more details on the error.")});var E=e(96016);const b=({children:fe,pluginId:ae,extensionTitle:ce,log:ie=E.R,fallbackAlwaysVisible:ve=!1})=>(0,n.jsx)(m.K,{onError:(le,Ee)=>{ie.error(`Extension "${ae}/${ce}" failed to load.`,{message:le.message,componentStack:Ee.componentStack??"",digest:Ee.digest??""})},fallback:()=>X()||ve?(0,n.jsx)(d,{pluginId:ae,extensionTitle:ce}):null,children:fe});var D=e(9453);function C(fe,ae=""){return(...ce)=>{try{return fe(...ce)}catch(ie){ie instanceof Error&&console.warn(`${ae}${ie.message}`)}}}function P(fe){return async ae=>{const{title:ce,body:ie,width:ve,height:le}=ae;c.A.publish(new v.S8({component:M({pluginId:fe.pluginId,extensionTitle:fe.title,Component:O({title:ce,body:ie,width:ve,height:le,config:fe}),log:E.R})}))}}const M=({pluginId:fe,extensionTitle:ae,Component:ce,log:ie})=>le=>{const{error:Ee,loading:Re,value:Oe}=(0,i.A)(()=>(0,x.x)(fe,{showErrorAlert:!1}));return Re?null:Ee?(ie.error(`Could not fetch plugin meta information for "${fe}", aborting. (${Ee.message})`,{stack:Ee.stack??"",message:Ee.message}),null):Oe?(0,n.jsx)(r.a,{meta:Oe,children:(0,n.jsx)(b,{pluginId:fe,extensionTitle:ae,log:ie,children:(0,n.jsx)(ce,{...T(le,{log:ie,source:"extension",pluginId:fe})})})}):(ie.error(`Fetched plugin meta information is empty for "${fe}", aborting.`),null)},O=({title:fe,body:ae,width:ce,height:ie,config:ve})=>{const le=(0,a.css)({width:ce,height:ie});return({onDismiss:Re})=>(0,n.jsx)(p.a,{title:fe,className:le,isOpen:!0,onDismiss:Re,onClickBackdrop:Re,children:(0,n.jsx)(b,{pluginId:ve.pluginId,extensionTitle:ve.title,fallbackAlwaysVisible:!0,log:E.R,children:(0,n.jsx)("div",{"data-plugin-sandbox":ve.pluginId,"data-testid":"plugin-sandbox-wrapper",children:(0,n.jsx)(ae,{onDismiss:Re})})})})};function j(fe,ae=new Map){if(!fe||typeof fe!="object"||Object.isFrozen(fe))return fe;const ce=Array.isArray(fe)?[...fe]:{...fe};if(ae.has(fe))return ae.get(fe);ae.set(fe,ce);const ie=Reflect.ownKeys(ce);for(const ve of ie){const le=Array.isArray(ce)?ce[Number(ve)]:ce[ve];le&&(typeof le=="object"||typeof le=="function")&&(Array.isArray(ce)?ce[Number(ve)]=j(le,ae):ce[ve]=j(le,ae))}return Object.freeze(ce)}function U(fe,ae,ce){const ie=`${fe}${ae}${ce}`;return Array.from(ie).reduce((ve,le)=>Math.imul(31,ve)+le.charCodeAt(0)|0,0).toString()}const W=Symbol("isReadOnlyProxy"),B=Symbol("isMutationObserverProxy");class S extends Error{constructor(ae){super(ae??"Mutating a read-only proxy object"),this.name="ReadOnlyProxyError"}}function _(fe){if(!fe||typeof fe!="object"||A(fe))return fe;const ae=new WeakMap;return new Proxy(fe,{defineProperty:()=>!1,deleteProperty:()=>!1,isExtensible:()=>!1,set:()=>!1,get(ce,ie,ve){if(ie===W)return!0;const le=Reflect.get(ce,ie,ve);return(0,u.Ar)(le)?(0,u.KQ)(le):(0,s.isObject)(le)||(0,s.isArray)(le)?(ae.has(le)||ae.set(le,_(le)),ae.get(le)):le}})}function K(fe,ae){if(!fe||typeof fe!="object"||N(fe))return fe;const{log:ce=E.R,source:ie="extension",pluginId:ve="unknown"}=ae??{},le=new WeakMap,Ee=X()?ce.error.bind(ce):ce.warning.bind(ce);return new Proxy(fe,{deleteProperty(Re,Oe){return Ee(`Attempted to delete object property "${String(Oe)}" from ${ie} with id ${ve}`,{stack:new Error().stack??""}),Reflect.deleteProperty(Re,Oe),!0},defineProperty(Re,Oe,Se){return ce.debug(`Attempted to define object property "${String(Oe)}" from ${ie} with id ${ve}`,{stack:new Error().stack??""}),Reflect.defineProperty(Re,Oe,Se),!0},set(Re,Oe,Se){return Ee(`Attempted to mutate object property "${String(Oe)}" from ${ie} with id ${ve}`,{stack:new Error().stack??""}),Reflect.set(Re,Oe,Se),!0},get(Re,Oe,Se){if(Oe===B)return!0;const Te=Reflect.get(Re,Oe,Se),_e=Reflect.getOwnPropertyDescriptor(Re,Oe);return _e&&!_e.configurable&&!_e.writable?Te:(0,u.Ar)(Te)?(0,u.KQ)(Te):(0,s.isObject)(Te)||(0,s.isArray)(Te)?(le.has(Te)||le.set(Te,K(Te,{log:ce,source:ie,pluginId:ve})),le.get(Te)):Te}})}function T(fe,ae){if(!fe||typeof fe!="object")return fe;const{log:ce=E.R,source:ie="extension",pluginId:ve="unknown"}=ae??{};return K((0,s.cloneDeep)(fe),{log:ce,pluginId:ve,source:ie})}function L(fe){return typeof fe=="object"&&fe!==null}function A(fe){return L(fe)&&fe[W]===!0}function N(fe){return L(fe)&&fe[B]===!0}function V(fe){const ae={...fe};return ae}function z(fe){}function w(fe,ae){return fe.length<ae?fe:`${fe.slice(0,ae-3).trimEnd()}...`}function H(fe){const ae={},ce=[];for(const ve of fe){const le=ve.category;if(!le){ce.push({text:w(ve.title,25),href:ve.path,onClick:ve.onClick});continue}Array.isArray(ae[le])||(ae[le]=[]),ae[le].push({text:w(ve.title,25),href:ve.path,onClick:ve.onClick})}const ie=Object.keys(ae).reduce((ve,le)=>(ve.push({text:w(le,25),type:"group",subMenu:ae[le]}),ve),[]);return ce.length>0&&(ie.length>0&&ie.push({text:"divider",type:"divider"}),Array.prototype.push.apply(ie,ce)),ie}function Q(fe,ae,ce,ie){try{const ve=ae.configure?.(ie);if(ve===void 0)return;let{title:le=ae.title,description:Ee=ae.description,path:Re=ae.path,icon:Oe=ae.icon,category:Se=ae.category,...Te}=ve;return(0,D.lq)(ve,`The configure() function for "${ae.title}" returned a promise, skipping updates.`),Re&&(0,D.wy)(fe,Re),(0,D.aY)({title:le,description:Ee},["title","description"]),Object.keys(Te).length>0&&ce.warning(`Extension "${ae.title}", is trying to override restricted properties: ${Object.keys(Te).join(", ")} which will be ignored.`),{title:le,description:Ee,path:Re,icon:Oe,category:Se}}catch(ve){ve instanceof Error&&ce.error(`Failed to configure link with title "${ae.title}"`,{stack:ve.stack??"",message:ve.message});return}}function Z(fe,ae,ce,ie,ve){const{onClick:le}=ce;if(le)return function(Re){try{(0,g.rR)("ui_extension_link_clicked",{pluginId:fe,extensionPointId:ae,title:ce.title,category:ce.category});const Oe={context:ve,openModal:P(ce),openSidebar:(Te,_e)=>{c.A.publish(new v.Am({props:_e,pluginId:fe,componentTitle:Te}))}};ie.debug(`onClick '${ce.title}' at '${ae}'`);const Se=le(Re,Oe);(0,D.yL)(Se)&&Se.catch(Te=>{Te instanceof Error&&ie.error(Te.message,{message:Te.message,stack:Te.stack??""})})}catch(Oe){Oe instanceof Error&&ie.error(Oe.message,{message:Oe.message,stack:Oe.stack??""})}}}function Y(fe,ae,ce){return o.kM.appendQueryToUrl(ae,o.kM.toUrlParams({uel_pid:fe,uel_epid:ce}))}const X=()=>f.$.buildInfo.env==="development",I=(fe=[])=>Object.values(f.$.apps).filter(ae=>fe.includes(ae.id)),J=fe=>fe.split("/")[0],ee=fe=>Object.values(f.$.apps).filter(ae=>ae.extensions.addedLinks.some(ce=>ce.targets.includes(fe))||ae.extensions.addedComponents.some(ce=>ce.targets.includes(fe))).map(ae=>ae.id).reduce((ae,ce)=>[...ae,ce,...se(ce)],[]),q=fe=>new Map(ee(fe).map(ae=>{const ce=f.$.apps[ae];if(!(!ce||!ce.extensions.addedComponents.some(ie=>ie.targets.includes(fe))&&!ce.extensions.addedLinks.some(ie=>ie.targets.includes(fe))))return[ae,{addedComponents:ce.extensions.addedComponents.filter(ie=>ie.targets.includes(fe)),addedLinks:ce.extensions.addedLinks.filter(ie=>ie.targets.includes(fe))}]}).filter(ae=>ae!==void 0)),ne=fe=>[J(fe)].reduce((ce,ie)=>[...ce,ie,...se(ie)],[]),se=(fe,ae=[])=>{if(!f.$.apps[fe])return[];if(ae.includes(fe))return[];const ce=f.$.apps[fe].dependencies.extensions.exposedComponents.map(J);return ce.reduce((ie,ve)=>[...ie,...se(ve,[...ae,fe])],ce).filter(ie=>ie!==fe)},oe=()=>{const fe=["cloud-home-app"];return Object.values(f.$.apps).filter(ae=>fe.includes(ae.id))},de=()=>{const fe=ee(l.S.DashboardPanelMenu),ae=oe().map(ie=>ie.id),ce=ie=>!ae.includes(ie.id);return Object.values(f.$.apps).filter(ie=>ce(ie)&&(ie.preload||fe.includes(ie.id)))}},9453:(te,R,e)=>{"use strict";e.d(R,{Fe:()=>f,OO:()=>E,PW:()=>h,SY:()=>b,aY:()=>o,dt:()=>D,jk:()=>x,kl:()=>g,lq:()=>l,nl:()=>C,wy:()=>i,xM:()=>d,yL:()=>m});var n=e(43173),a=e(4745);function s(P,M="extension is not a link extension"){if(!isPluginExtensionLink(P))throw new Error(M)}function i(P,M){if(!g(P,M))throw new Error(`Invalid link extension. The "path" is required and should start with "/a/${P}/" (currently: "${M}"). Skipping the extension.`)}function r(P){if(!y(P))throw new Error('Invalid component extension, the "component" property needs to be a valid React component.')}function u(P){if(!x(P.configure))throw new Error(`Invalid extension "${P.title}". The "configure" property must be a function. Skipping the extension.`)}function o(P,M){for(const O of M)if(!v(P[O]))throw new Error(`Invalid extension "${P.title}". Property "${O}" must be a string and cannot be empty. Skipping the extension.`)}function l(P,M="The provided value is a Promise."){if(m(P))throw new Error(M)}function g(P,M){return!!(typeof M=="string"&&M.length>0&&M.startsWith(`/a/${P}/`))}function f({extensionPointId:P,pluginId:M}){return P.startsWith("grafana/")?!0:!!(P.startsWith(`plugins/${M}/`)||P.startsWith(`${M}/`))}function p(P){return P.match(/.*\/v\d+$/)}function c(P){return Object.values(PluginExtensionPoints).map(M=>M.toString()).includes(P)}function x(P){return P?typeof P=="function":!0}function v(P){return typeof P=="string"&&P.length>0}function m(P){return P instanceof Promise||typeof P=="object"&&P!==null&&"then"in P&&"catch"in P}function y(P){const M=j=>typeof j=="object"&&j!==null&&"$$typeof"in j;return typeof P=="function"||(j=>M(j)&&j.$$typeof===Symbol.for("react.memo"))(P)}const h=(P,M)=>{const O=M.meta?.extensions?.extensionPoints;return!O||!O.some(j=>j.id===P)},d=(P,M)=>{const O=M.meta?.dependencies?.extensions?.exposedComponents;return!O||!O.includes(P)},E=(P,M,O)=>{const j="Could not register link extension. Reason:",U=n.$.apps[P],W=U?U.extensions.addedLinks.find(({title:S})=>S===M.title):null;return U?W?(Array.isArray(M.targets)?M.targets:[M.targets]).every(S=>W.targets.includes(S))?(W.description!==M.description&&O.warning(a.cu),!1):(O.error(`${j} ${a.Bc}`),!0):(O.error(`${j} ${a.iS}`),!0):(O.error(`${j} ${a.$$(P)}`),!0)},b=(P,M,O)=>{const j="Could not register function extension. Reason:",U=n.$.apps[P],W=U?U.extensions.addedFunctions.find(({title:S})=>S===M.title):null;return U?W?(Array.isArray(M.targets)?M.targets:[M.targets]).every(S=>W.targets.includes(S))?(W.description!==M.description&&O.warning(a.cu),!1):(O.error(`${j} ${a.Bc}`),!0):(O.error(`${j} ${a.E5}`),!0):(O.error(`${j} ${a.$$(P)}`),!0)},D=(P,M,O)=>{const j="Could not register component extension. Reason:",U=n.$.apps[P],W=U?U.extensions.addedComponents.find(({title:S})=>S===M.title):null;return U?W?(Array.isArray(M.targets)?M.targets:[M.targets]).every(S=>W.targets.includes(S))?(W.description!==M.description&&O.warning(a.cu),!1):(O.error(`${j} ${a.Bc}`),!0):(O.error(`${j} ${a.FL}`),!0):(O.error(`${j} ${a.$$(P)}`),!0)},C=(P,M,O)=>{const j="Could not register exposed component extension. Reason:",U=n.$.apps[P],W=U?U.extensions.exposedComponents.find(({id:B})=>B===M.id):null;return U?W?W.title!==M.title?(O.error(`${j} ${a.sm}`),!0):(W.description!==M.description&&O.warning(a.cu),!1):(O.error(`${j} ${a.z5}`),!0):(O.error(`${j} ${a.$$(P)}`),!0)}},92391:(te,R,e)=>{"use strict";e.d(R,{Kk:()=>p,PY:()=>c,TV:()=>l,d4:()=>f,oZ:()=>g});var n=e(78830),a=e(11594),s=e(65642),i=e(41097),r=e(59922);const u={},o={};function l(v){const m=u[v];if(m)return m;const y=f(v);if(!y)throw new Error(`Plugin ${v} not found`);return u[v]=x(y),v!==y.type&&(u[y.type]=u[v]),u[v]}function g(v){return!!f(v)}function f(v){const m=s.Ay.panels[v];if(!m){for(const y of Object.values(s.Ay.panels))if(y.aliasIDs?.includes(v))return y}return m}function p(v){return x(v)}function c(v){return o[v]}function x(v){(0,n.M)(v);const m=v.loadingStrategy??a.xf.fetch;return(0,r.j4)({path:v.module,version:v.info?.version,loadingStrategy:m,pluginId:v.id,moduleHash:v.moduleHash,translations:v.translations}).then(y=>{if(y.plugin)return y.plugin;throw(0,n.M)(y),new Error("missing export: plugin")}).then(y=>(y.meta=v,o[v.id]=y,y)).catch(y=>(console.warn("Error loading panel plugin: "+v.id,y),(0,i.W)(v,y)))}},19203:(te,R,e)=>{"use strict";e.d(R,{GD:()=>i,QO:()=>o,ni:()=>u,sk:()=>r});var n=e(95027),a=e(98060);const s={};function i({path:f,version:p,loadingStrategy:c}){const x=l(f);x&&!s[x]&&(s[x]={version:encodeURI(p),loadingStrategy:c})}function r(f){const p=f;s[p]&&delete s[p],(0,n.o)(f)}function u(f,p=a.x8){const c=g(f);if(!c)return`${f}?_cache=${p}`;const v=s[c]?.version||p;return`${f}?_cache=${v}`}function o(f){const p=g(f);if(p)return s[p]}function l(f){const p=/\/?public\/plugins\/([^\/]+)\//,c=f.match(p);return c?c[1]:null}function g(f){const p=Object.keys(s).find(c=>f.includes(c));if(p)return p}},98060:(te,R,e)=>{"use strict";e.d(R,{$b:()=>a,Bu:()=>s,XV:()=>n,x8:()=>i});const n="package",a=/^plugins.+\.css$/i,s=/^(text|application)\/(x-)?javascript(;|$)/,i=Date.now()},59922:(te,R,e)=>{"use strict";e.d(R,{ui:()=>Og,cS:()=>Sg,j4:()=>ic});var n={};e.r(n),e.d(n,{AbstractLabelOperator:()=>ko.D_,ActionType:()=>Ar.X2,ActionVariableType:()=>Ar.VR,AlertState:()=>yo.O,AnnotationChangeEvent:()=>ln.We,AnnotationEventFieldSource:()=>Do.V,AppEvents:()=>lr.r1,AppPlugin:()=>p.hX,ArrayDataFrame:()=>ct.f,ArrayVector:()=>vc,BinaryOperationID:()=>kt.k,BusEventBase:()=>Xt.a,BusEventWithPayload:()=>Xt.x,ByNamesMatcherMode:()=>ma.PP,CSVHeaderStyle:()=>bt.F7,CSVReader:()=>bt.i8,CircularDataFrame:()=>Jo.x,CircularVector:()=>el.$,CoreApp:()=>p.Jk,CustomVariableSupport:()=>ir.f5,DEFAULT_FIELD_DISPLAY_VALUES_LIMIT:()=>Rt.Pm,DEFAULT_SAML_NAME:()=>Yo.En,DashboardCursorSync:()=>Er.y,DashboardLoadedEvent:()=>ln.gc,DataFrameType:()=>gc.m,DataFrameView:()=>he.R,DataHoverClearEvent:()=>ln.ql,DataHoverEvent:()=>ln.b_,DataLinkBuiltInVars:()=>ca.c,DataLinkConfigOrigin:()=>Yr.x0,DataQueryErrorType:()=>f.v2,DataSelectEvent:()=>ln.LO,DataSourceApi:()=>f.mA,DataSourcePlugin:()=>f.tD,DataSourcePluginContextProvider:()=>fc.p,DataSourceTestFailed:()=>ln.LL,DataSourceTestSucceeded:()=>ln.NI,DataSourceUpdatedSuccessfully:()=>ln.wE,DataSourceVariableSupport:()=>ir.ZV,DataTopic:()=>Pt.QR,DataTransformerID:()=>la.F,DefaultTimeZone:()=>dr.lE,DocsId:()=>ea.f,EventBusSrv:()=>En.o,ExploreMode:()=>f.ZF,FALLBACK_COLOR:()=>cr.F,FeatureState:()=>p.Ay,FieldCache:()=>xe.L,FieldColorModeId:()=>cr.Y,FieldConfigEditorBuilder:()=>_t.bk,FieldConfigOptionsRegistry:()=>Pn.K,FieldConfigProperty:()=>Ks.uo,FieldMatcherID:()=>Kn.Ct,FieldNamePickerBaseNameMode:()=>Ft.X4,FieldType:()=>ls.PU,FrameGeometrySourceMode:()=>Pt.aG,FrameMatcherID:()=>Kn.jR,GAUGE_DEFAULT_MAXIMUM:()=>Yo.d1,GAUGE_DEFAULT_MINIMUM:()=>Yo.tw,GrafanaPlugin:()=>l.Ud,GrafanaThemeType:()=>Yi.I,HttpRequestMethod:()=>Ar.DO,ISO_8601:()=>Ua.mt,InternalTimeZones:()=>es.g$,LanguageProvider:()=>f.Is,LayoutModes:()=>Ho.R,LegacyGraphHoverClearEvent:()=>lr.Tq,LegacyGraphHoverEvent:()=>lr.kb,LegacyMappingType:()=>Da.An,LiveChannelConnectionState:()=>Cs.ZF,LiveChannelEventType:()=>Cs.o4,LiveChannelScope:()=>Cs.qD,LiveChannelType:()=>Cs.os,LoadingState:()=>tn.Gu,LocalStorageValueProvider:()=>fn,LogLevel:()=>Ja.$b,LogRowContextQueryDirection:()=>Ja.ZF,LogSortOrderChangeEvent:()=>Ja.Df,LogsDedupDescription:()=>Ja._C,LogsDedupStrategy:()=>Pt.fY,LogsMetaKind:()=>Ja.tG,LogsSortOrder:()=>Pt.uH,LogsVolumeType:()=>Ja.Aj,MISSING_VALUE:()=>me.p,MappingType:()=>qi.d,MatcherID:()=>Kn.cV,MutableDataFrame:()=>me.k,NodeGraphDataFrameFieldNames:()=>Ln.u,NullValueMode:()=>tn.UW,NumericLogLevel:()=>Ja.s5,OneClickMode:()=>Yr.yd,OrgRole:()=>Qo.X,PageLayoutType:()=>bo.k,PanelEvents:()=>lr.ee,PanelOptionsEditorBuilder:()=>_t.pv,PanelPlugin:()=>Xe.m,PathValidationError:()=>zt.DX,PluginContext:()=>Qi.b,PluginContextProvider:()=>ki.a,PluginErrorCode:()=>l.ZK,PluginExtensionPoints:()=>Xi.S,PluginExtensionTypes:()=>Xi.u,PluginIncludeType:()=>l.ib,PluginLoadingStrategy:()=>l.xf,PluginSignatureStatus:()=>l.Ac,PluginSignatureType:()=>l.kv,PluginState:()=>l.pn,PluginType:()=>l.QE,ReducerID:()=>aa.gy,Registry:()=>Aa.O,SetPanelAttentionEvent:()=>ln.Tp,SpecialValue:()=>Zi.N,SpecialValueMatch:()=>qi.W,StandardVariableSupport:()=>ir.J$,Store:()=>It.i,StreamingDataFrame:()=>at.k9,StreamingFrameAction:()=>at.Kh,SupplementaryQueryType:()=>Ja.cF,SupportedTransformationType:()=>Yr.CC,SystemDateFormatsState:()=>ts.JE,TIME_FORMAT:()=>dr.G$,TIME_SERIES_METRIC_FIELD_NAME:()=>ls.aI,TIME_SERIES_TIME_FIELD_NAME:()=>ls.LE,TIME_SERIES_VALUE_FIELD_NAME:()=>ls.Bc,ThemeContext:()=>vo.D,ThresholdsMode:()=>Ji.O,TransformationApplicabilityLevels:()=>Zi.M,TransformerCategory:()=>Zn.m,UnaryOperationID:()=>bn._,VAR_CALC:()=>Rt.k_,VAR_CELL_PREFIX:()=>Rt.a_,VAR_FIELD_LABELS:()=>Rt.nF,VAR_FIELD_NAME:()=>Rt.py,VAR_SERIES_NAME:()=>Rt.k3,ValueMatcherID:()=>Kn.Js,VariableHide:()=>xo.zL,VariableOrigin:()=>Yr.$0,VariableRefresh:()=>xo.CO,VariableSort:()=>xo.ZG,VariableSuggestionsScope:()=>Yr.uP,VariableSupportBase:()=>ir.xi,VariableSupportType:()=>ir.Qz,VisualizationSuggestionScore:()=>Eo.nQ,VisualizationSuggestionsBuilder:()=>Eo.v2,VisualizationSuggestionsListAppender:()=>Eo.NV,VizOrientation:()=>Eo.wV,addDurationToDate:()=>Zs.Ri,addRow:()=>$e.uY,amendTable:()=>nt.c,anySeriesWithTimeField:()=>$e.tP,anyToNumber:()=>oa.t,applyFieldOverrides:()=>jn.we,applyNullInsertThreshold:()=>_n.M,applyRawFieldOverrides:()=>jn.K3,arrayToDataFrame:()=>ct.I,arrayUtils:()=>Hn,availableIconsIndex:()=>xr.az,binaryOperators:()=>kt.b,booleanOverrideProcessor:()=>Ft.FM,booleanValueFormatter:()=>Ka.Qc,buildHistogram:()=>ta.p3,cacheFieldDisplayNames:()=>gt.Fm,classicColors:()=>Qt.t,closestIdx:()=>at.Ls,colorManipulator:()=>Js.MV,compareArrayValues:()=>Et.J3,compareDataFrameStructures:()=>Et.bW,containsSearchFilter:()=>Fa.E,contentTypeOptions:()=>Ar.Ur,convertOldAngularValueMappings:()=>Da.bh,createDataFrame:()=>ye.EI,createDimension:()=>De,createFieldConfigRegistry:()=>Hi.O,createTheme:()=>Ys.a,dataFrameFromJSON:()=>ft.or,dataFrameToJSON:()=>ft.Nw,dataLinksOverrideProcessor:()=>Ft.Ch,dateMath:()=>zi,dateTime:()=>Ua.KQ,dateTimeAsMoment:()=>Ua.AN,dateTimeForTimeZone:()=>Ua.oZ,dateTimeFormat:()=>Xs.LE,dateTimeFormatISO:()=>Xs.M7,dateTimeFormatTimeAgo:()=>Xs.fq,dateTimeFormatWithAbbrevation:()=>Xs._Q,dateTimeParse:()=>Gi.b,decodeFieldValueEntities:()=>ft.t,decodeFieldValueEnums:()=>ft.EL,defaultActionConfig:()=>Ar.mx,defaultCalcs:()=>aa.C6,deprecationWarning:()=>dt.l,displayNameOverrideProcessor:()=>Ft.AM,doStandardCalcs:()=>aa.H3,durationToMilliseconds:()=>Zs.WT,ensureTimeField:()=>Ya.ks,escapeRegex:()=>Dt.$f,escapeStringForRegex:()=>Dt.jD,eventFactory:()=>Jt.R,fieldColorModeRegistry:()=>cn.uf,fieldMatchers:()=>Fn.sJ,fieldReducers:()=>aa.AS,filterFieldConfigOverrides:()=>kr.aW,findCommonLabels:()=>Mt.yO,findHighlightChunksInText:()=>Ye.Oq,findMatchesInText:()=>Ye.bs,findUniqueLabels:()=>Mt.s6,fixCellTemplateExpressions:()=>Rt.Zo,formatLabels:()=>Mt.h6,formattedValueToString:()=>Ka.cN,frameMatchers:()=>Fn.RE,fuzzySearch:()=>Dn.X,getActiveThreshold:()=>wn.yQ,getAllValuesFromDimension:()=>Ze,getBuiltInThemes:()=>rr.k,getColumnFromDimension:()=>Ve,getColumnsFromDimension:()=>Le,getDataFrameRow:()=>ye.Yn,getDataSourceRef:()=>xt.p$,getDataSourceUID:()=>xt.Iz,getDefaultRelativeTimeRange:()=>dr.Cn,getDefaultTimeRange:()=>dr.E2,getDimensionByName:()=>Me,getDisplayProcessor:()=>Ut.J,getDisplayValueAlignmentFactors:()=>Rt.XS,getFieldColorMode:()=>cn.Hs,getFieldColorModeForField:()=>cn.Qi,getFieldConfigWithMinMax:()=>Lt.xg,getFieldDataContextClone:()=>jn.vd,getFieldDisplayName:()=>gt.Ct,getFieldDisplayValues:()=>Rt.PI,getFieldDisplayValuesProxy:()=>kn.F,getFieldMatcher:()=>Fn.NS,getFieldSeriesColor:()=>cn.lz,getFieldTypeFromValue:()=>ye.oE,getFlotPairs:()=>xn,getFlotPairsConstant:()=>mn,getFrameDisplayName:()=>gt.Ri,getFrameMatchers:()=>Fn.Dq,getHistogramFields:()=>ta.ix,getLinksSupplier:()=>jn._M,getLocale:()=>Ua.JK,getLocaleData:()=>Ua.XN,getMinMaxAndDelta:()=>Lt.AP,getNextRefId:()=>St.M,getPanelOptionsWithDefaults:()=>kr.F,getProcessedDataFrames:()=>ye.Bt,getRawDisplayProcessor:()=>Ut.H,getRowUniqueId:()=>$e.t9,getScaleCalculator:()=>Lt.jc,getSearchFilterScopedVar:()=>Fa.c,getSeriesTimeStep:()=>Zt,getThemeById:()=>rr.g,getTimeField:()=>ye.KR,getTimeZone:()=>_i.O,getTimeZoneGroups:()=>es.U3,getTimeZoneInfo:()=>es.QZ,getTimeZones:()=>es.P3,getUniqueFieldName:()=>gt.fk,getValueFormat:()=>Ka.j_,getValueFormats:()=>Ka.Ke,getValueFormatterIndex:()=>Ka.uH,getValueFromDimension:()=>ze,getValueMatcher:()=>Fn.kK,getWeekdayIndex:()=>Ua.xQ,getWeekdayIndexByEnglishName:()=>Ua.pp,getZone:()=>es.HD,guessDecimals:()=>Bt.E,guessFieldTypeForField:()=>ye.dF,guessFieldTypeFromNameAndValue:()=>ye.by,guessFieldTypeFromValue:()=>ye.HW,guessFieldTypes:()=>ye.XQ,hasLinks:()=>Rt.eG,hasLogsContextSupport:()=>Ja.Ol,hasLogsContextUiSupport:()=>Ja.wj,hasMsResolution:()=>nn,hasQueryExportSupport:()=>ko.Ee,hasQueryImportSupport:()=>ko.FL,hasQueryModificationSupport:()=>Ja._0,hasSupplementaryQuerySupport:()=>Ja.Nc,hasTimeField:()=>$e.S1,hasToggleableQueryFiltersSupport:()=>Ja.FP,histogramBucketSizes:()=>ta.rW,histogramFieldInfo:()=>ta.Rt,histogramFieldsToFrame:()=>ta.cg,histogramFrameBucketMaxFieldName:()=>ta.dA,histogramFrameBucketMinFieldName:()=>ta.d$,histogramTransformer:()=>ta.OA,httpMethodOptions:()=>Ar.ki,identityOverrideProcessor:()=>Ft.hS,incrRound:()=>ta.ZU,incrRoundDn:()=>ta.rs,incrRoundUp:()=>ta.Uh,intervalToAbbreviatedDurationString:()=>Zs.dU,isBooleanUnit:()=>Ka.j9,isCustomFieldProp:()=>kr.TQ,isDataFrame:()=>ye.ci,isDataFrameWithValue:()=>ye.LI,isDataSourcePluginContext:()=>za.S,isDataSourceRef:()=>xt.fN,isDateTime:()=>Ua.Ar,isDateTimeInput:()=>Ua.u8,isEmptyObject:()=>Kt.R,isEqualityOrMultiOperator:()=>qs.RU,isHistogramFrameBucketMaxFieldName:()=>ta.H1,isHistogramFrameBucketMinFieldName:()=>ta.NX,isIconName:()=>xr.n6,isLikelyAscendingVector:()=>ka.g2,isLiveChannelJoinEvent:()=>Cs.Cz,isLiveChannelLeaveEvent:()=>Cs.jQ,isLiveChannelMessageEvent:()=>Cs.Z7,isLiveChannelStatusEvent:()=>Cs.ew,isObject:()=>tn.Gv,isReducerID:()=>aa.Em,isStandardFieldProp:()=>kr.nx,isSystemOverride:()=>Ks.Ow,isSystemOverrideWithRef:()=>Ks.ZW,isTableData:()=>ye.pH,isTimeSeriesField:()=>$e.hF,isTimeSeriesFrame:()=>$e.aH,isTimeSeriesFrames:()=>$e.jq,isTruthy:()=>tn.zz,isUnsignedPluginSignature:()=>pc.x,isValidDate:()=>Zs.vd,isValidDuration:()=>Zs.di,isValidGoDuration:()=>Zs.pp,isValidGrafanaDuration:()=>Zs.V3,isValidLiveChannelAddress:()=>Cs.aj,joinHistograms:()=>ta.EO,localTimeFormat:()=>ts.Od,locale:()=>Ka.Hg,locationUtil:()=>An.I,makeClassES5Compatible:()=>Ca.Y,makeTimeRange:()=>dr.HW,mapInternalLinkToExplore:()=>ca.u,matchAllLabels:()=>Mt._p,matchPluginId:()=>ps._,monacoLanguageRegistry:()=>is.l,nullToValue:()=>Ns.C,numberOverrideProcessor:()=>Ft.m0,objRemoveUndefined:()=>Kt.w,onUpdateDatasourceJsonDataOption:()=>xt.PG,onUpdateDatasourceJsonDataOptionChecked:()=>xt.EX,onUpdateDatasourceJsonDataOptionSelect:()=>xt.BD,onUpdateDatasourceOption:()=>xt.zX,onUpdateDatasourceResetOption:()=>xt.yV,onUpdateDatasourceSecureJsonDataOption:()=>xt.mn,onUpdateDatasourceSecureJsonDataOptionSelect:()=>xt.wY,outerJoinDataFrames:()=>ka.Fd,parseDuration:()=>Zs.E9,parseFlags:()=>Ye.bQ,parseLabels:()=>Mt.Xy,parseLiveChannelAddress:()=>Cs.DG,patchArrayVectorProrotypeMethods:()=>Po,preProcessPanelData:()=>ye.N$,preferredVisualizationTypes:()=>tn.Nx,rangeUtil:()=>hc,readCSV:()=>bt.Jh,reduceField:()=>aa.Nw,renderLegendFormat:()=>Xn.j,renderMarkdown:()=>mt.G,renderTextPanelMarkdown:()=>mt.P,restoreCustomOverrideRules:()=>kr.H9,reverseDataFrame:()=>ye.q7,reverseParseDuration:()=>Zs.Q7,reverseScopeFilterOperatorMap:()=>qs.Dv,roundDecimals:()=>Bt.h,scaledUnits:()=>Ka.yP,scopeFilterOperatorMap:()=>qs.n9,selectOverrideProcessor:()=>Ft.hL,serializeStateToUrlParam:()=>ia.Pp,setLocale:()=>Ua.xS,setTimeZoneResolver:()=>_i.G,setWeekStart:()=>Ua.$D,shallowCompare:()=>Et.ab,simpleCountUnit:()=>Ka.UR,sortDataFrame:()=>ye.ES,sortThresholds:()=>wn.RU,standardEditorsRegistry:()=>Gt.D,standardFieldConfigEditorRegistry:()=>Gt.G,standardTransformers:()=>Wn.c,standardTransformersRegistry:()=>Zn.h,store:()=>It.M,stringFormater:()=>Ka.cH,stringOverrideProcessor:()=>Ft.OU,stringStartsAsRegEx:()=>Dt.AP,stringToJsRegex:()=>Dt.dO,stringToMs:()=>Dt.dc,systemDateFormats:()=>ts.WC,textUtil:()=>zt.sQ,thresholdsOverrideProcessor:()=>Ft.N7,throwIfAngular:()=>g.M,timeZoneAbbrevation:()=>Xs.jw,timeZoneFormatUserFriendly:()=>es.le,toCSV:()=>bt._O,toDataFrame:()=>ye.Vc,toDataFrameDTO:()=>ye.Kl,toDuration:()=>Ua.Ah,toFilteredDataFrameDTO:()=>ye.By,toFixed:()=>Ka.Mg,toFixedScaled:()=>Ka.gZ,toFixedUnit:()=>Ka.G8,toFloatOrUndefined:()=>Dt.$D,toIconName:()=>xr.Uo,toIntegerOrUndefined:()=>Dt.vb,toLegacyResponseData:()=>ye.w3,toLiveChannelId:()=>Cs.Qp,toNumberString:()=>Dt.kT,toOption:()=>Yn.z,toPascalCase:()=>Dt.MX,toURLRange:()=>ia.sQ,toUtc:()=>Ua.yT,transformDataFrame:()=>Ia.m,trimTable:()=>nt.F,unEscapeStringFromRegex:()=>Dt.xb,unaryOperators:()=>bn.j,unitOverrideProcessor:()=>Ft.lG,updateDatasourcePluginJsonDataOption:()=>xt.lO,updateDatasourcePluginOption:()=>xt.pN,updateDatasourcePluginResetOption:()=>xt.QP,updateDatasourcePluginSecureJsonDataOption:()=>xt.wp,urlUtil:()=>ia.kM,useFieldOverrides:()=>jn.rJ,usePluginContext:()=>or.Q,userHasAllPermissions:()=>ur.Fj,userHasAnyPermission:()=>ur.jW,userHasPermission:()=>ur.ZU,userHasPermissionInMetadata:()=>ur.T6,validateFieldConfig:()=>jn.BF,validatePath:()=>zt.iQ,valueMappingsOverrideProcessor:()=>Ft.xT,valueMatchers:()=>Fn.hI,vectorator:()=>mc.E,withLoadingIndicator:()=>Jn.k});var a={};e.r(a),e.d(a,{CopyPanelEvent:()=>Sa.ah,DataSourcePicker:()=>bc.s,DataSourceWithBackend:()=>gs.iy,EchoEventType:()=>Jr.on,EmbeddedDashboard:()=>dl.f,FakeEchoSrv:()=>Jr.c_,FolderPicker:()=>Pr.d,GrafanaBootConfig:()=>v.p,HealthCheckError:()=>gs.b1,HealthStatus:()=>gs.VQ,HistoryWrapper:()=>Ss.K9,LocationServiceProvider:()=>Ss._K,MetaAnalyticsEventName:()=>So.n_,PanelDataErrorView:()=>Ec.a,PanelRenderer:()=>xc.m,PluginPage:()=>Pc.V,QueryEditorWithMigration:()=>Tc,RefreshEvent:()=>Sa._,RuntimeDataSource:()=>yc,ScopesContext:()=>ni.j,StreamingFrameAction:()=>qo.Kh,ThemeChangedEvent:()=>Sa.E8,TimeRangeUpdatedEvent:()=>Sa.sR,config:()=>v.$,createDataSourcePluginEventProperties:()=>si.y,createMonitoringLogger:()=>ws.DW,createPluginEventProperties:()=>si.L,createQueryRunner:()=>Io.d,featureEnabled:()=>rl.a,frameToMetricFindValue:()=>ol.$h,getAppEvents:()=>Sa.J7,getBackendSrv:()=>Co.AI,getCorrelationsService:()=>eo.r,getDataSourceSrv:()=>Xo.l,getEchoSrv:()=>Jr.x$,getGrafanaLiveSrv:()=>qo.oF,getLimitedComponentsToRender:()=>Mo.CP,getLocationSrv:()=>Zo.X,getObservablePluginComponents:()=>To.z,getObservablePluginLinks:()=>sl.m,getPluginImportUtils:()=>ai.o,getRunRequest:()=>Io.XJ,getTemplateSrv:()=>tl.w,hasAllPermissions:()=>Dc,hasAnyPermission:()=>ri,hasPermission:()=>ul,hasPermissionInMetadata:()=>Lr,isExperimentViewEvent:()=>So.p6,isExpressionReference:()=>gs.s9,isFetchError:()=>Co.NF,isInteractionEvent:()=>So.fX,isMigrationHandler:()=>Zr.LZ,isPageviewEvent:()=>So.nB,isPluginExtensionComponent:()=>Mo.aR,isPluginExtensionLink:()=>Mo.DG,loadPluginCss:()=>ai.PL,locationSearchToObject:()=>Ss.SE,locationService:()=>Ss.Ny,logDebug:()=>ws.MD,logError:()=>ws.vV,logInfo:()=>ws.fH,logMeasurement:()=>ws.l$,logWarning:()=>ws.FF,migrateQuery:()=>Zr.aX,migrateRequest:()=>Zr.xt,navigationLogger:()=>Ss.Lc,registerEchoBackend:()=>Jr.pl,renderLimitedComponents:()=>Mo.RC,reportExperimentView:()=>Oo.Xp,reportInteraction:()=>Oo.rR,reportMetaAnalytics:()=>Oo.G$,reportPageview:()=>Oo.Jy,setAppEvents:()=>Sa.H8,setBackendSrv:()=>Co.u5,setChromeHeaderHeightHook:()=>cl._,setCorrelationsService:()=>eo.l,setCurrentUser:()=>jr.l,setDataSourceSrv:()=>Xo.h,setEchoSrv:()=>Jr.H2,setEmbeddedDashboard:()=>dl.p,setFolderPicker:()=>Pr.N,setGrafanaLiveSrv:()=>qo.S8,setLocationService:()=>Ss.vG,setLocationSrv:()=>Zo.T,setPluginComponentHook:()=>ei.A,setPluginComponentsHook:()=>nl.R,setPluginFunctionsHook:()=>ti.U,setPluginImportUtils:()=>ai.se,setPluginLinksHook:()=>al.q,setQueryRunnerFactory:()=>Io.HC,setReturnToPreviousHook:()=>ll._,setRunRequest:()=>Io.pC,setTemplateSrv:()=>tl.d,toDataQueryError:()=>il.u,toDataQueryResponse:()=>ol.bE,useChromeHeaderHeight:()=>cl.k,useLocationService:()=>Ss.at,usePluginComponent:()=>ei.S,usePluginComponents:()=>nl.f,usePluginFunctions:()=>ti.W,usePluginInteractionReporter:()=>Xr.G,usePluginLinks:()=>al.U,usePluginUserStorage:()=>qr.D,useReturnToPrevious:()=>ll.i,useScopes:()=>ni.b});var s={};e.r(s),e.d(s,{ScaleDistributionEditor:()=>$s.W1,StackingEditor:()=>ui.m,addAxisConfig:()=>$s.rg,addAxisPlacement:()=>$s.Wq,addAxisWidth:()=>$s.T4,addHideFrom:()=>Dl.e,addLegendOptions:()=>Ao.H,addStackingConfig:()=>ui.I,addTextSizeOptions:()=>ao.I,addTooltipOptions:()=>Cl.D});var i={};e.r(i),e.d(i,{getNextCharacter:()=>Lc,getPreviousCousin:()=>so});var r={};e.r(r),e.d(r,{ALERTING_COLOR:()=>Hs.xj,Alert:()=>_d.F,AlertingSettings:()=>kh,AsyncMultiSelect:()=>co.Iv,AsyncSelect:()=>co.DW,AsyncVirtualizedSelect:()=>co.gZ,AutoSaveField:()=>wl,AutoSizeInput:()=>Yl.D,Avatar:()=>Xl.e,AxisPlacement:()=>Pt.vM,Badge:()=>jf.E,BarAlignment:()=>Pt.Nj,BarGauge:()=>pr.xE,BarGaugeDisplayMode:()=>Pt.eX,BarValueVisibility:()=>Pt.yL,BigValue:()=>Dr.yV,BigValueColorMode:()=>Dr.yp,BigValueGraphMode:()=>Dr.$p,BigValueJustifyMode:()=>Dr.F8,BigValueTextMode:()=>Dr.SV,Box:()=>au.a,BracesPlugin:()=>Mp,BrowserLabel:()=>Yf.J,Button:()=>Lo.$n,ButtonCascader:()=>Nr,ButtonGroup:()=>tu.e,ButtonSelect:()=>yu.f,CallToActionCard:()=>Qd.c,Card:()=>Jl.Z,CardContainer:()=>vr.Q,Carousel:()=>fi.F,Cascader:()=>Uc.v,CertificationKey:()=>Jh.K,Checkbox:()=>gu.S,ClearPlugin:()=>Sp.v,ClickOutsideWrapper:()=>Ra.N,ClipboardButton:()=>Ol.b,ClipboardPlugin:()=>Op.s,CodeEditor:()=>Ie.B,CodeEditorSuggestionItemKind:()=>Ce.q,CollapsableSection:()=>Wh.M,Collapse:()=>Gd.S,ColorPicker:()=>Al.sk,ColorPickerInput:()=>Pa,Combobox:()=>Gl.G,CompletionItemKind:()=>mp.I,ConfirmButton:()=>Bc.Z,ConfirmModal:()=>yi.u,Container:()=>kl.mc,ContextMenu:()=>kd.t,ControlledCollapse:()=>Gd.a,Counter:()=>qn.p,CustomHeadersSettings:()=>Zc.P,CustomScrollbar:()=>oo.E,DEFAULT_ANNOTATION_COLOR:()=>Hs.Mk,DOMUtil:()=>i,DataLinkButton:()=>Yc.R,DataLinkInput:()=>$h.l,DataLinksContextMenu:()=>zh.e,DataLinksInlineEditor:()=>gr.e,DataLinksInlineEditorBase:()=>Vh.J,DataSourceHttpSettings:()=>Qh.t,DatePicker:()=>_c.l,DatePickerWithInput:()=>Gs.l,DateTimePicker:()=>yn.K,DeleteButton:()=>Sl.e,Divider:()=>$f.c,DrawStyle:()=>Pt.GR,Drawer:()=>af._,Dropdown:()=>xu.m,ElementSelectionContext:()=>zu._,EmptySearchResult:()=>gi.Z,EmptyState:()=>Vc.p,ErrorBoundary:()=>Xc.tH,ErrorBoundaryAlert:()=>Xc.Xw,ErrorWithStack:()=>Hh.D,EventBusPlugin:()=>kf.K,EventsCanvas:()=>ud.a,EventsWithValidation:()=>Fo.Pw,FIXED_UNIT:()=>Tu.s,FadeTransition:()=>Xh.A,FeatureBadge:()=>Zd.y,FeatureInfoBox:()=>qd,Field:()=>fr.D,FieldArray:()=>ou,FieldLinkList:()=>Nh,FieldSet:()=>Pf.n,FieldValidationMessage:()=>su.P,FileDropzone:()=>vu.gH,FileDropzoneDefaultChildren:()=>vu.wI,FileListItem:()=>Wf.I,FileUpload:()=>mu.e,FilterInput:()=>Bf.Z,FilterPill:()=>Vl.m,Form:()=>cf.l,FormattedValueDisplay:()=>id.i,FullWidthButtonContainer:()=>wh,Gauge:()=>Is._,GlobalStyles:()=>Qu.k,Graph:()=>Tr,GraphContextMenu:()=>Mu,GraphContextMenuHeader:()=>fd,GraphGradientMode:()=>Pt.on,GraphNG:()=>rp,GraphSeriesToggler:()=>ju,GraphThresholdsStyleMode:()=>Pt.Ly,GraphWithLegend:()=>Au,Grid:()=>vf.x,HorizontalGroup:()=>kl.Gy,Icon:()=>Fs.I,IconButton:()=>Ml.K,IndentationPlugin:()=>nc.T,InfoBox:()=>Xd.w,InlineField:()=>zl.I,InlineFieldRow:()=>Df.C,InlineFormLabel:()=>Vf.I,InlineLabel:()=>bf.c,InlineSegmentGroup:()=>ru.e,InlineSwitch:()=>qc.K,InlineToast:()=>Uo.r,Input:()=>_l.p,InputControl:()=>ed.e,InteractiveTable:()=>lo.j,JSONFormatter:()=>Gh.B,JsonExplorer:()=>Jc.O,KeyboardPlugin:()=>Cu.Z,Label:()=>xf.J,LegacyForms:()=>Ju,LegacyInputStatus:()=>fl.O,Legend:()=>Ef.s,LegendDisplayMode:()=>Pt.lm,LineInterpolation:()=>Pt.dx,Link:()=>pf.N,LinkButton:()=>Lo.z9,List:()=>io.B,LoadingBar:()=>pi.G,LoadingPlaceholder:()=>Rl._,Marker:()=>Du.p,Menu:()=>Fh.W,MenuGroup:()=>Yd.r,MenuItem:()=>No.D,Modal:()=>ut.a,ModalHeader:()=>vt.r,ModalRoot:()=>Yt.EO,ModalTabContent:()=>jt,ModalTabsHeader:()=>At.J,ModalsContext:()=>Yt.wE,ModalsController:()=>Yt.$s,ModalsProvider:()=>Yt.YO,MultiCombobox:()=>od,MultiSelect:()=>co.KF,NO_DATA_COLOR:()=>Hs.nO,NewlinePlugin:()=>Yu.O,NodeGraphDataFrameFieldNames:()=>xd,OK_COLOR:()=>Hs.Xw,PENDING_COLOR:()=>Hs.ct,PageToolbar:()=>qt.d,Pagination:()=>vi.d,PanelChrome:()=>Fr.NR,PanelChromeLoadingIndicator:()=>Wo.I,PanelContainer:()=>Jf._,PanelContextProvider:()=>Vr.XF,PanelContextRoot:()=>Vr.e4,PlotLegend:()=>dd.$,PluginSignatureBadge:()=>wf.B,PointVisibility:()=>Pt.yL,Popover:()=>_a.A,PopoverController:()=>ro.I,Portal:()=>_s.ZL,PortalContainer:()=>_s.qB,QueryField:()=>kc.X,REGION_FILL_ALPHA:()=>Hs.UJ,RadioButtonDot:()=>Lf.J,RadioButtonGroup:()=>hu.z,RadioButtonList:()=>fu.a,RangeSlider:()=>lf.F,ReactMonacoEditor:()=>pe.m,ReactUtils:()=>zs,RefreshPicker:()=>Ll.cC,RelativeTimeRangePicker:()=>Kf.N,RenderUserContentAsHTML:()=>wr.I,RunnerPlugin:()=>Ip.U,SCHEMA:()=>ec.yx,ScaleDirection:()=>Pt.ON,ScaleDistribution:()=>Pt.L4,ScaleOrientation:()=>Pt.Lt,ScrollContainer:()=>to.P,SearchFunctionType:()=>Pp.T,SecretInput:()=>Uf.L4,SecretTextArea:()=>pu.lp,SecureSocksProxySettings:()=>Yh.Y,Segment:()=>Cr.Y,SegmentAsync:()=>qh.s,SegmentInput:()=>ef.o,SegmentSection:()=>nf.L,SegmentSelect:()=>tf.a,Select:()=>co.l6,SelectContainer:()=>co.KA,SelectMenuOptions:()=>Cf.o5,SelectionShortcutsPlugin:()=>Rp.l,SeriesColorPicker:()=>Al.Dp,SeriesColorPickerPopover:()=>jl.o,SeriesColorPickerPopoverWithTheme:()=>jl.t,SeriesIcon:()=>Jd.p,SeriesTable:()=>xs.o,SeriesTableRow:()=>xs.g,SeriesVisibilityChangeBehavior:()=>Bh.K,SeriesVisibilityChangeMode:()=>hd.B,SetInterval:()=>hn.u,SlatePrism:()=>Ap.D,SlideOutTransition:()=>Zh.n,Slider:()=>$r,Space:()=>yf.$,Sparkline:()=>ms.O,Spinner:()=>As.y,Stack:()=>mf.B,StackingMode:()=>Pt.gs,StatsPicker:()=>br.S,SuggestionsPlugin:()=>jp.Pz,Switch:()=>qc.d,TLSAuthSettings:()=>eu.j,Tab:()=>sa.o,TabContent:()=>cs.J,TabbedContainer:()=>jo.q,Table:()=>Cn.X,TableCellDisplayMode:()=>Pt.ob,TableCellInspector:()=>Nn.s,TableCellInspectorMode:()=>Nn.B,TableInputCSV:()=>Sn,TabsBar:()=>zn.U,Tag:()=>Qc.v,TagList:()=>Fl.L,TagsInput:()=>Kr.u,Text:()=>nu.E,TextArea:()=>In.f,TextLink:()=>gf.Y,ThemeContext:()=>vo.D,TimeOfDayPicker:()=>zc.R,TimePickerTooltip:()=>Bl.xS,TimeRangeInput:()=>Nf.b,TimeRangeLabel:()=>$c.f,TimeRangePicker:()=>Bl.$6,TimeRangeProvider:()=>Os.A,TimeSeries:()=>Fu,TimeZonePicker:()=>Gn.U,ToggleAllState:()=>Tf.X,Toggletip:()=>hi.G,ToolbarButton:()=>df.I,ToolbarButtonRow:()=>uf.U,Tooltip:()=>no.m,TooltipDisplayMode:()=>Pt.$N,TooltipPlugin:()=>hp,TooltipPlugin2:()=>Qf.xl,UPLOT_AXIS_FONT_SIZE:()=>Gf.pi,UPlotChart:()=>bu.Z,UPlotConfigBuilder:()=>cd.e,UnitPicker:()=>La.p,UserIcon:()=>ld.n,UsersIndicator:()=>Eu,ValuePicker:()=>hf.i,VerticalGroup:()=>kl.gW,VerticalTab:()=>pa,VirtualizedSelect:()=>co.ip,VizLayout:()=>$d.KU,VizLegend:()=>zd.t,VizLegendListItem:()=>Uh.M,VizRepeater:()=>xi.S,VizTooltip:()=>Rs,VizTooltipContainer:()=>tr.o,WeekStartPicker:()=>er.l6,WithContextMenu:()=>Ei.n,XYCanvas:()=>Hf._,ZoomPlugin:()=>vd,attachDebugger:()=>Hu.h,buildScaleKey:()=>sp,calculateFontSize:()=>Ko.Vr,clearButtonStyles:()=>Lo.my,colors:()=>Hs.Tj,commonOptionsBuilder:()=>s,convertOldAngularValueMapping:()=>$l.I1,createLogger:()=>Gu.h,createPointerDistance:()=>_u.b,defaultIntervals:()=>Ll.cb,fieldMatchersUI:()=>ff.g,fuzzyMatch:()=>bp.I,getAvailableIcons:()=>wo.GO,getCanvasContext:()=>Ko.Yc,getCardStyles:()=>Jl.H,getCellLinks:()=>xp.k,getDragStyles:()=>zf.l,getFieldTypeIcon:()=>wo.SS,getFieldTypeIconName:()=>wo.lV,getGraphFieldOptions:()=>Pu.P,getInputStyles:()=>_l.n,getPortalContainer:()=>_s.gF,getScrollbarWidth:()=>yp,getSelectStyles:()=>Pi.J,getTagColor:()=>yd.yC,getTagColorIndexFromName:()=>yd.JF,getTagColorsFromName:()=>yd.MC,getTextColorForAlphaBackground:()=>Hs.mZ,getTextColorForBackground:()=>Hs.sg,getTheme:()=>Cp,getWeekStart:()=>er.rL,graphFieldOptions:()=>Pu.t,graphTickFormatter:()=>Su,graphTimeFormat:()=>pd,hasValidationEvent:()=>Fo.K,isIconSize:()=>wo.rJ,isWeekStart:()=>er.rE,linkModelToContextMenuItems:()=>vp.J,logOptions:()=>Dp,makeFragment:()=>ec.dF,makeValue:()=>ec.mO,measureText:()=>Ko.kD,mockTheme:()=>Tp,mockThemeContext:()=>na.fq,preparePlotFrame:()=>Ti,regexValidation:()=>Fo.RP,resetSelectStyles:()=>ii.A,sharedInputStyle:()=>mr.Xb,sharedSingleStatMigrationHandler:()=>$l._$,sharedSingleStatPanelChangedHandler:()=>$l.gl,sortedColors:()=>Hs.Ih,styleMixins:()=>Tl,stylesFactory:()=>li.N,toIconName:()=>xr.Uo,useElementSelection:()=>zu.y,useForceUpdate:()=>Ep.C,useGraphNGContext:()=>dp,usePanelContext:()=>Vr.d2,usePointerDistance:()=>_u.C,useSplitter:()=>_f.h,useStyles:()=>na.IS,useStyles2:()=>na.of,useTheme:()=>na.DP,useTheme2:()=>na.$j,validate:()=>Fo.tf,variableSuggestionToCodeEditorSuggestion:()=>ke.O,withErrorBoundary:()=>Xc.Xc,withTheme:()=>na.SL,withTheme2:()=>na.cV});var u={};e.r(u),e.d(u,{default:()=>ho});var o={};e.r(o),e.d(o,{getPrecision:()=>Vo,getScaledDecimals:()=>Wp,getStringPrecision:()=>$a,grafanaTimeFormat:()=>Np,logp:()=>Kp,tickStep:()=>Up});var l=e(11594),g=e(78830),f=e(94644),p=e(1906),c=e(57002),x=e(92745),v=e(43173);const ve={"core:plugin/graphite":async()=>await e.e(6134).then(e.bind(e,28947)),"core:plugin/cloudwatch":async()=>await Promise.all([e.e(5074),e.e(5610),e.e(3766)]).then(e.bind(e,65610)),"core:plugin/dashboard":async()=>await e.e(9473).then(e.bind(e,39473)),"core:plugin/elasticsearch":async()=>await Promise.all([e.e(5074),e.e(8393),e.e(6260),e.e(1717)]).then(e.bind(e,96260)),"core:plugin/opentsdb":async()=>await e.e(747).then(e.bind(e,90400)),"core:plugin/grafana":async()=>await e.e(3648).then(e.bind(e,51309)),"core:plugin/influxdb":async()=>await Promise.all([e.e(7445),e.e(590),e.e(9404)]).then(e.bind(e,40590)),"core:plugin/mixed":async()=>await e.e(2513).then(e.bind(e,95637)),"core:plugin/prometheus":async()=>await Promise.all([e.e(5074),e.e(8393),e.e(9546)]).then(e.bind(e,38349)),"core:plugin/alertmanager":async()=>await Promise.all([e.e(5074),e.e(4737)]).then(e.bind(e,30876)),"core:plugin/text":async()=>await e.e(404).then(e.bind(e,16373)),"core:plugin/timeseries":async()=>await Promise.all([e.e(362),e.e(428),e.e(5428),e.e(9170),e.e(563)]).then(e.bind(e,55569)),"core:plugin/trend":async()=>await Promise.all([e.e(5428),e.e(2666)]).then(e.bind(e,96827)),"core:plugin/state-timeline":async()=>await Promise.all([e.e(8706),e.e(428),e.e(5974),e.e(6199)]).then(e.bind(e,44372)),"core:plugin/status-history":async()=>await Promise.all([e.e(8706),e.e(428),e.e(5974),e.e(8259)]).then(e.bind(e,24181)),"core:plugin/candlestick":async()=>await Promise.all([e.e(362),e.e(428),e.e(5428),e.e(9170),e.e(3090)]).then(e.bind(e,80959)),"core:plugin/xychart":async()=>await Promise.all([e.e(348),e.e(5594)]).then(e.bind(e,87254)),"core:plugin/geomap":async()=>await Promise.all([e.e(362),e.e(8706),e.e(3474),e.e(6104),e.e(8550),e.e(190)]).then(e.bind(e,98550)),"core:plugin/canvas":async()=>await Promise.all([e.e(6104),e.e(7523)]).then(e.bind(e,51273)),"core:plugin/dashlist":async()=>await e.e(8995).then(e.bind(e,30783)),"core:plugin/alertlist":async()=>await e.e(3375).then(e.bind(e,12915)),"core:plugin/annolist":async()=>await e.e(4979).then(e.bind(e,80537)),"core:plugin/heatmap":async()=>await Promise.all([e.e(362),e.e(407),e.e(5995),e.e(428),e.e(348),e.e(5857)]).then(e.bind(e,17933)),"core:plugin/table":async()=>v.$.featureToggles.tableNextGen?await Promise.all([e.e(9227),e.e(7794)]).then(e.bind(e,14019)):await e.e(3525).then(e.bind(e,45730)),"core:plugin/news":async()=>await e.e(4940).then(e.bind(e,71786)),"core:plugin/live":async()=>await e.e(5413).then(e.bind(e,8149)),"core:plugin/stat":async()=>await Promise.resolve().then(e.bind(e,75663)),"core:plugin/datagrid":async()=>await Promise.all([e.e(7445),e.e(2218),e.e(5939)]).then(e.bind(e,42218)),"core:plugin/debug":async()=>await Promise.all([e.e(362),e.e(2770)]).then(e.bind(e,54952)),"core:plugin/flamegraph":async()=>await Promise.all([e.e(407),e.e(5995),e.e(20),e.e(5686)]).then(e.bind(e,27281)),"core:plugin/gettingstarted":async()=>await e.e(9142).then(e.bind(e,38627)),"core:plugin/gauge":async()=>await Promise.resolve().then(e.bind(e,71843)),"core:plugin/piechart":async()=>await e.e(6105).then(e.bind(e,96894)),"core:plugin/bargauge":async()=>await e.e(3851).then(e.bind(e,62493)),"core:plugin/barchart":async()=>await Promise.all([e.e(8706),e.e(3124)]).then(e.bind(e,24131)),"core:plugin/logs":async()=>await Promise.all([e.e(2516),e.e(8368),e.e(7884)]).then(e.bind(e,2001)),"core:plugin/logs-new":async()=>await Promise.all([e.e(2516),e.e(8368),e.e(3976)]).then(e.bind(e,6567)),"core:plugin/traces":async()=>await Promise.all([e.e(407),e.e(5995),e.e(20),e.e(1213),e.e(4301)]).then(e.bind(e,3627)),"core:plugin/welcome":async()=>await e.e(8463).then(e.bind(e,21369)),"core:plugin/nodeGraph":async()=>await Promise.all([e.e(3474),e.e(9147),e.e(7317)]).then(e.bind(e,39053)),"core:plugin/histogram":async()=>await e.e(323).then(e.bind(e,65672))};var le=e(63629),Ee=e(19203),Re=e(59511),Oe=e(65024),Se=e(82093);const Te=window.System;var _e=e(34796),He=e.n(_e),tt=e(54087),Je=e(80851),Ge=e(32176),je=e(31221),Fe=e(91520),Be=e(92275),Ke=e(82013),Ue=e(2341),we=e(19538),Xe=e(16207),nt=e(15083),he=e(88673),xe=e(10279),me=e(18700),ye=e(41119);const De=(be,Ne)=>({name:be,columns:Ne}),Le=be=>be.columns,Ve=(be,Ne)=>be.columns[Ne],ze=(be,Ne,Qe)=>be.columns[Ne].values[Qe],Ze=(be,Ne,Qe)=>be.columns.map(st=>st.values[Qe]),Me=(be,Ne)=>be[Ne];var $e=e(17503),at=e(51388),ct=e(27359),ft=e(77154),Et=e(76732),St=e(39796),Pt=e(739),Dt=e(8934),Ye=e(38388),mt=e(67458),zt=e(63704),Jt=e(36819),Xt=e(68388),En=e(19379),ln=e(57852),cn=e(76637),Pn=e(76803),wn=e(36394),jn=e(60519),kn=e(7102),gt=e(16515),Lt=e(79118),Rt=e(44232),Ut=e(11576),Gt=e(53543),Ft=e(38809),_t=e(52205),tn=e(28105);function xn({xField:be,yField:Ne,nullValueMode:Qe}){const st=be.values,ot=Ne.values,it=st.length;if(ot.length!==it)throw new Error("Unexpected field length");const Ot=Qe===tn.UW.Ignore,Tt=Qe===tn.UW.AsZero,Nt=[];for(let wt=0;wt<it;wt++){const Ht=st[wt];let rn=ot[wt];if(rn===null){if(Ot)continue;Tt&&(rn=0)}Ht!==null&&Nt.push([Ht,rn])}return Nt}function mn(be,Ne){if(!Ne.from||!Ne.to||!be||be.length===0)return[];const Qe=Ne.from.valueOf(),st=Ne.to.valueOf(),ot=be[0][1];return[[Qe,ot],[st,ot]]}var An=e(92138),ia=e(83175),ca=e(38036),ea=e(28882),Ca=e(35814),oa=e(13227),Jn=e(47520),Da=e(35987),Fa=e(94452),Xn=e(428),ps=e(8134),Aa=e(42954),xt=e(48480),dt=e(37615),bt=e(68125),Mt=e(71642),Bt=e(79243),Kt=e(3594),Qt=e(33985);const Zt=be=>{let Ne,Qe,st=Number.MAX_VALUE;for(let ot=0;ot<be.values.length;ot++){const it=be.values[ot];if(Ne!==void 0){const Ot=it-Ne;Qe===void 0&&(st=Ot),Ot<st&&(st=Ot)}Ne=it}return st},nn=be=>{for(let Ne=0;Ne<be.values.length;Ne++){const Qe=be.values[Ne];if(Qe!=null){const st=Qe.toString();if(st.length===13&&st%1e3!==0)return!0}}return!1};var kt=e(12823),bn=e(48233),Ln=e(14613),Yn=e(47184),Hn=e(46635),It=e(78012),yt=e(74848),Vt=e(96540);const fn=be=>{const{children:Ne,storageKey:Qe,defaultValue:st}=be,[ot,it]=(0,Vt.useState)({value:It.M.getObject(be.storageKey,be.defaultValue)});(0,Vt.useEffect)(()=>{const Nt=wt=>{wt.key===Qe&&it({value:It.M.getObject(be.storageKey,be.defaultValue)})};return window.addEventListener("storage",Nt),()=>{window.removeEventListener("storage",Nt)}});const Ot=Nt=>{try{It.M.setObject(Qe,Nt)}catch(wt){console.error(wt)}it({value:Nt})},Tt=()=>{try{It.M.delete(Qe)}catch(Nt){console.log(Nt)}it({value:st})};return(0,yt.jsx)(yt.Fragment,{children:Ne(ot.value,Ot,Tt)})};var Dn=e(99885),Wn=e(96702),Fn=e(36638),la=e(64761),Kn=e(57866),aa=e(46644),Ia=e(2197),Zn=e(8642),ma=e(4575),ka=e(8721),ta=e(74261),Ya=e(406),_n=e(63409),Ns=e(34455),is=e(54734),Ys=e(69884),rr=e(47070),Js=e(6773),vo=e(35555),Ka=e(55386),zi=e(33239),hc=e(17548),_i=e(60188),Ua=e(25229),es=e(62717),ts=e(5421),Xs=e(80011),Gi=e(44922),Zs=e(74529),Ho=e(78479),kr=e(69168),Hi=e(37297),Qi=e(79450),ki=e(20877),fc=e(62392),or=e(31595),za=e(17564),pc=e(29246),xr=e(30360),yo=e(76190),ir=e(48592),lr=e(32899),Qo=e(90382),Yi=e(68492),cr=e(64394),xo=e(7389),Ji=e(33553),Cs=e(38619),Xi=e(54092),qs=e(27164),Eo=e(38919);function Po(){Object.getOwnPropertyDescriptor(Array.prototype,"toArray")||Object.defineProperties(Array.prototype,{get:{value:function(be){return this[be]},writable:!0,enumerable:!1,configurable:!0},set:{value:function(be,Ne){this[be]=Ne},writable:!0,enumerable:!1,configurable:!0},add:{value:function(be){this.push(be)},writable:!0,enumerable:!1,configurable:!0},toArray:{value:function(){return this},writable:!0,enumerable:!1,configurable:!0}})}Po();var Ks=e(83340),Zi=e(79319),qi=e(18600),dr=e(22592),bo=e(75683),Ja=e(67770),Do=e(88907),ko=e(46933),Er=e(84229),Yr=e(79609),Ar=e(85891),gc=e(39443),ls=e(95004),Yo=e(48588),el=e(94777),mc=e(96453);const ba="ArrayVector is deprecated and will be removed in Grafana 11. Please use plain arrays for field.values.";let Ta=!1;class vc extends Array{get buffer(){return this}set buffer(Ne){this.length=0;const Qe=Ne?.length;if(Qe){let st=65e3,ot=Math.ceil(Qe/st);for(let it=0;it<ot;it++)this.push.apply(this,Ne.slice(it*st,(it+1)*st))}}constructor(Ne){super(),this.buffer=Ne??[],Ta||(console.warn(ba),Ta=!0)}toJSON(){return[...this]}}var Jo=e(35479),ur=e(7918),Co=e(68143),Xo=e(78282),Zo=e(48072),Jr=e(78646),tl=e(2863),qo=e(33184),Ss=e(36490),Sa=e(75234),ei=e(33005),nl=e(33604),al=e(46907),ti=e(33707),sl=e(58873),To=e(2874),Mo=e(22099),jr=e(6201);class yc extends f.mA{constructor(Ne,Qe){const st={name:"RuntimeDataSource-"+Ne,uid:Qe,type:Ne,id:1,readOnly:!0,jsonData:{},access:"direct",meta:{id:Ne,name:"RuntimeDataSource-"+Ne,type:l.QE.datasource,info:{author:{name:""},description:"",links:[],logos:{large:"",small:""},screenshots:[],updated:"",version:""},module:"",baseUrl:""}};super(st),this.instanceSettings=st}testDatasource(){return Promise.resolve({status:"success",message:""})}}var ni=e(69896),So=e(33749),ai=e(39698),Oo=e(27489),rl=e(62061),ws=e(25992),gs=e(36580),ol=e(38866),xc=e(60311),Ec=e(14477),il=e(97534),Io=e(83734),Pc=e(88806),bc=e(80839),si=e(61190),Xr=e(77010),ll=e(41071),cl=e(92293),dl=e(43122);const ul=be=>(0,ur.ZU)(be,(0,jr.H)()),Lr=(be,Ne)=>(0,ur.T6)(be,Ne),Dc=be=>(0,ur.Fj)(be,(0,jr.H)()),ri=be=>(0,ur.jW)(be,(0,jr.H)());var Cc=e(70255),Zr=e(38353);function Tc(be){return Qe=>{const[st,ot]=(0,Vt.useState)(!1),[it,Ot]=(0,Vt.useState)(Qe.query);return(0,Vt.useEffect)(()=>{Qe.query&&(0,Zr.LZ)(Qe.datasource)?(0,Zr.aX)(Qe.datasource,Qe.query).then(Tt=>{Qe.onChange(Tt),Ot(Tt),ot(!0)}):ot(!0)},[]),(0,Vt.useEffect)(()=>{Ot(Qe.query)},[Qe.query]),st?(0,yt.jsx)(be,{...Qe,query:it}):(0,yt.jsx)(Cc.A,{containerTestId:"react-loading-skeleton-testid",height:75})}}var qr=e(55315),Pr=e(47700),eo=e(25076),hl=e(94959),fl=e(32581),Ro=e(73757),Fs=e(30703);const pl=be=>{const Ne=be.selectProps.menuIsOpen;return(0,yt.jsx)(Ro.c.IndicatorsContainer,{...be,children:(0,yt.jsx)(Fs.I,{name:Ne?"angle-up":"angle-down",style:{marginTop:"7px"}})})},gl=pl,ml=be=>{const{children:Ne}=be;return(0,yt.jsx)(Ro.c.NoOptionsMessage,{...be,children:(0,yt.jsx)("div",{className:"gf-form-select-box__desc-option",children:(0,yt.jsx)("div",{className:"gf-form-select-box__desc-option__body",children:Ne})})})},Mc=ml;var vl=e(46942),yl=e.n(vl),Sc=e(46005),Oc=e(8539),Ic=e(66963),to=e(92807),oi=e(89534),ii=e(57830),no=e(45967);const Vs=be=>{const{children:Ne,isSelected:Qe,data:st}=be;return(0,yt.jsx)(Ro.c.Option,{...be,children:(0,yt.jsxs)("div",{className:"gf-form-select-box__desc-option",children:[st.imgUrl&&(0,yt.jsx)("img",{className:"gf-form-select-box__desc-option__img",src:st.imgUrl,alt:""}),(0,yt.jsxs)("div",{className:"gf-form-select-box__desc-option__body",children:[(0,yt.jsx)("div",{children:Ne}),st.description&&(0,yt.jsx)("div",{className:"gf-form-select-box__desc-option__desc",children:st.description})]}),Qe&&(0,yt.jsx)(Fs.I,{name:"check","aria-hidden":"true"})]})})},xl=null;var Mn=e(22803),na=e(63142),li=e(65240);const ci=(0,li.N)(be=>({header:(0,Mn.css)({display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%",borderBottom:`1px solid ${be.colors.background.secondary}`,"&:hover":{color:be.colors.text.maxContrast}}),label:(0,Mn.css)({flexGrow:1}),icon:(0,Mn.css)({paddingRight:"2px"})}));class El extends Vt.PureComponent{constructor(){super(...arguments),this.state={expanded:!1},this.onToggleChildren=()=>{this.setState(Ne=>({expanded:!Ne.expanded}))}}componentDidMount(){if(this.props.data.expanded)this.setState({expanded:!0});else if(this.props.selectProps&&this.props.selectProps.value){const{value:Ne}=this.props.selectProps.value;Ne&&this.props.options.some(Qe=>Qe.value===Ne)&&this.setState({expanded:!0})}}componentDidUpdate(Ne){Ne.selectProps.inputValue!==""&&this.setState({expanded:!0})}render(){const{children:Ne,label:Qe,theme:st}=this.props,{expanded:ot}=this.state,it=ci(st);return(0,yt.jsxs)("div",{children:[(0,yt.jsxs)("div",{className:it.header,onClick:this.onToggleChildren,role:"presentation",children:[(0,yt.jsx)("span",{className:it.label,children:Qe}),(0,yt.jsx)(Fs.I,{className:it.icon,name:ot?"angle-up":"angle-down"})]}),ot&&Ne]})}}const Br=(0,na.cV)(El),Pl=be=>(0,yt.jsx)(Ro.c.MenuList,{...be,children:(0,yt.jsx)(to.P,{showScrollIndicators:!0,overflowX:"hidden",maxHeight:"inherit",children:be.children})});class di extends Vt.PureComponent{static{this.contextType=vo.D}static{this.defaultProps={className:"",isDisabled:!1,isSearchable:!0,isClearable:!1,isMulti:!1,openMenuOnFocus:!1,autoFocus:!1,isLoading:!1,backspaceRemovesValue:!0,maxMenuHeight:300,tabSelectsValue:!0,allowCustomValue:!1,components:{Option:Vs,SingleValue:oi.K,IndicatorsContainer:gl,MenuList:Pl,Group:Br}}}render(){const{defaultValue:Ne,getOptionLabel:Qe,getOptionValue:st,onChange:ot,options:it,placeholder:Ot,width:Tt,value:Nt,className:wt,isDisabled:Ht,isLoading:rn,isSearchable:sn,isClearable:pn,backspaceRemovesValue:Vn,isMulti:va,autoFocus:Qn,openMenuOnFocus:ss,onBlur:Ga,maxMenuHeight:Ha,noOptionsMessage:Na,isOpen:Ps,components:On,tooltipContent:dn,tabSelectsValue:ra,onCloseMenu:Tn,onOpenMenu:da,allowCustomValue:ua,formatCreateLabel:ga,"aria-label":ha}=this.props;let Oa="";Tt&&(Oa="width-"+Tt);let Va=Sc.Ay;const vs={};ua&&(Va=Ic.A,vs.formatCreateLabel=ga??(os=>os));const rs=yl()("gf-form-input","gf-form-input--form-dropdown",Oa,wt),js={...di.defaultProps.components,...On};return(0,yt.jsx)(Ur,{onCloseMenu:Tn,onOpenMenu:da,tooltipContent:dn,isOpen:Ps,children:(os,Ui)=>(0,yt.jsx)(Va,{captureMenuScroll:!1,classNamePrefix:"gf-form-select-box",className:rs,components:js,defaultValue:Ne,value:Nt,getOptionLabel:Qe,getOptionValue:st,menuShouldScrollIntoView:!1,isSearchable:sn,onChange:ot,options:it,placeholder:Ot||"Choose",styles:(0,ii.A)(this.context),isDisabled:Ht,isLoading:rn,isClearable:pn,autoFocus:Qn,onBlur:Ga,openMenuOnFocus:ss,maxMenuHeight:Ha,noOptionsMessage:Na,isMulti:va,backspaceRemovesValue:Vn,menuIsOpen:Ps,onMenuOpen:os,onMenuClose:Ui,tabSelectsValue:ra,"aria-label":ha,...vs})})}}class Rc extends Vt.PureComponent{static{this.contextType=vo.D}static{this.defaultProps={className:"",components:{},loadingMessage:()=>"Loading...",isDisabled:!1,isClearable:!1,isMulti:!1,isSearchable:!0,backspaceRemovesValue:!0,autoFocus:!1,openMenuOnFocus:!1,maxMenuHeight:300}}render(){const{defaultValue:Ne,getOptionLabel:Qe,getOptionValue:st,onChange:ot,placeholder:it,width:Ot,value:Tt,className:Nt,loadOptions:wt,defaultOptions:Ht,isLoading:rn,loadingMessage:sn,noOptionsMessage:pn,isDisabled:Vn,isSearchable:va,isClearable:Qn,backspaceRemovesValue:ss,autoFocus:Ga,onBlur:Ha,openMenuOnFocus:Na,maxMenuHeight:Ps,isMulti:On,tooltipContent:dn,onCloseMenu:ra,onOpenMenu:Tn,isOpen:da}=this.props;let ua="";Ot&&(ua="width-"+Ot);const ga=yl()("gf-form-input","gf-form-input--form-dropdown",ua,Nt);return(0,yt.jsx)(Ur,{onCloseMenu:ra,onOpenMenu:Tn,tooltipContent:dn,isOpen:da,children:(ha,Oa)=>(0,yt.jsx)(Oc.A,{captureMenuScroll:!1,classNamePrefix:"gf-form-select-box",className:ga,components:{Option:Vs,SingleValue:oi.K,IndicatorsContainer:gl,NoOptionsMessage:Mc},defaultValue:Ne,value:Tt,getOptionLabel:Qe,getOptionValue:st,menuShouldScrollIntoView:!1,onChange:ot,loadOptions:wt,isLoading:rn,defaultOptions:Ht,placeholder:it||"Choose",styles:(0,ii.A)(this.context),loadingMessage:sn,noOptionsMessage:pn,isDisabled:Vn,isSearchable:va,isClearable:Qn,autoFocus:Ga,onBlur:Ha,openMenuOnFocus:Na,maxMenuHeight:Ps,isMulti:On,backspaceRemovesValue:ss})})}}class Ur extends Vt.PureComponent{constructor(){super(...arguments),this.state={isOpenInternal:!1},this.onOpenMenu=()=>{const{onOpenMenu:Ne}=this.props;Ne&&Ne(),this.setState({isOpenInternal:!0})},this.onCloseMenu=()=>{const{onCloseMenu:Ne}=this.props;Ne&&Ne(),this.setState({isOpenInternal:!1})}}render(){const{children:Ne,isOpen:Qe,tooltipContent:st}=this.props,{isOpenInternal:ot}=this.state;let it;return(ot||Qe)&&(it=!1),st?(0,yt.jsx)(no.m,{show:it,content:st,placement:"bottom",children:(0,yt.jsx)("div",{children:Ne(this.onOpenMenu,this.onCloseMenu)})}):(0,yt.jsx)("div",{children:Ne(this.onOpenMenu,this.onCloseMenu)})}}const Vd=null;var Wa=e(2543);class bl extends Vt.PureComponent{constructor(){super(...arguments),this.state={id:(0,Wa.uniqueId)()},this.internalOnChange=Ne=>{Ne.stopPropagation(),this.props.onChange(Ne)}}render(){const{labelClass:Ne="",switchClass:Qe="",label:st,checked:ot,disabled:it,transparent:Ot,className:Tt,theme:Nt,tooltip:wt,tooltipPlacement:Ht}=this.props,rn=jc(Nt),sn=this.state.id,pn=`gf-form-label ${Ne} ${Ot?"gf-form-label--transparent":""} pointer`,Vn=(0,Mn.cx)(rn.switch,Qe,{[rn.switchTransparent]:Ot});return(0,yt.jsx)("div",{className:rn.container,children:(0,yt.jsxs)("label",{htmlFor:sn,className:(0,Mn.cx)("gf-form",rn.labelContainer,Tt),children:[st&&(0,yt.jsxs)("div",{className:pn,children:[st,wt&&(0,yt.jsx)(no.m,{placement:Ht||"auto",content:wt,theme:"info",children:(0,yt.jsx)(Fs.I,{name:"info-circle",size:"sm",style:{marginLeft:"10px"}})})]}),(0,yt.jsxs)("div",{className:Vn,children:[(0,yt.jsx)("input",{disabled:it,id:sn,type:"checkbox",checked:ot,onChange:this.internalOnChange}),(0,yt.jsx)("span",{className:rn.slider})]})]})})}}const Ac=(0,na.cV)(bl),jc=be=>{const Ne=(0,Mn.css)({background:be.v1.palette.gray1,borderRadius:be.shape.radius.pill,height:"16px",width:"32px",display:"block",position:"relative","&::before":{position:"absolute",content:"''",height:"12px",width:"12px",left:"2px",top:"2px",background:be.components.input.background,transition:"0.4s",borderRadius:be.shape.radius.circle,boxShadow:be.shadows.z1}});return{container:(0,Mn.css)({display:"flex",flexShrink:0}),labelContainer:(0,Mn.css)({display:"flex",cursor:"pointer",marginRight:be.spacing(.5)}),switch:(0,Mn.css)({display:"flex",position:"relative",width:"56px",height:be.spacing(4),background:be.components.input.background,border:`1px solid ${be.components.input.borderColor}`,borderRadius:be.shape.radius.default,alignItems:"center",justifyContent:"center",input:{opacity:0,width:0,height:0},[`input:checked + .${Ne}`]:{background:be.colors.primary.main},[`input:checked + .${Ne}::before`]:{transform:"translateX(16px)"}}),switchTransparent:(0,Mn.css)({background:"transparent",border:0,width:"40px"}),slider:Ne}};var Wr=e(23659),$s=e(44017),Dl=e(45013),Ao=e(41069),Cl=e(79277),ao=e(14099),ui=e(81082),Tl=e(35484);typeof window<"u"&&"Element"in window&&!Element.prototype.closest&&(Element.prototype.closest=function(be){const Ne=(this.document||this.ownerDocument).querySelectorAll(be);let Qe=this,st;do{for(st=Ne.length;--st>=0&&Ne.item(st)!==Qe;);Qe=Qe.parentElement}while(st<0&&Qe);return Qe});function so(be,Ne){let Qe=be.parentElement?.previousSibling,st;for(;Qe;){if(Qe instanceof HTMLElement&&(st=Qe.querySelector(Ne)),st)return st;Qe=Qe.previousSibling}}function Lc(be){const Ne=(be||window).getSelection();if(!Ne||!Ne.anchorNode)return null;const Qe=Ne.getRangeAt(0),st=Ne.anchorNode.textContent,ot=Qe.startOffset;return st.slice(ot,ot+1)}var zs=e(44019),Ml=e(76319),Bc=e(7075),Sl=e(44458),ro=e(43533),_a=e(2381),hi=e(59243),_s=e(15245),oo=e(52718),jo=e(64467),Ol=e(47931),Uc=e(64913),fi=e(56873),Wc=e(38092),Lo=e(45861),Il=e(78121),Bo=e(21133);const Nr=be=>{const{onChange:Ne,className:Qe,loadData:st,icon:ot,buttonProps:it,hideDownIcon:Ot,variant:Tt,disabled:Nt,...wt}=be,Ht=(0,na.of)(Nc),rn=(0,na.of)(Bo.T);let sn=be.children;return Ot||(sn=[be.children,(0,yt.jsx)(Fs.I,{name:"angle-down",className:Ht.icons.right},"down-icon")]),(0,yt.jsx)(Wc.A,{onChange:(0,Il.k)(Ne),loadData:(0,Il.W)(st),dropdownClassName:(0,Mn.cx)(rn.dropdown,Ht.popup),...wt,expandIcon:null,children:(0,yt.jsx)(Lo.$n,{icon:ot,disabled:Nt,variant:Tt,...it??{},children:sn})})};Nr.displayName="ButtonCascader";const Nc=be=>({popup:(0,Mn.css)({label:"popup",zIndex:be.zIndex.dropdown}),icons:{right:(0,Mn.css)({margin:"1px 0 0 4px"}),left:(0,Mn.css)({margin:"-1px 4px 0 0"})}});var Uo=e(53371),Rl=e(6975),pi=e(47327),Al=e(35427),Kc=e(7612),wc=e(65229),Ra=e(8135),Fc=e(12173),hr=e(32550);const Pa=(0,Vt.forwardRef)(({value:be="",onChange:Ne,returnColorAs:Qe="rgb",...st},ot)=>{const[it,Ot]=(0,Vt.useState)(be),[Tt,Nt]=(0,Vt.useState)(!1),wt=(0,na.$j)(),Ht=(0,na.of)(ja),rn=(0,na.of)(hr.$);(0,wc.A)(pn=>{if(pn===be)return;if(!pn){Ne("");return}const Vn=wt.visualization.getColorByName(pn);Ne(Qe==="rgb"?Js.MV.asRgbString(Vn):Js.MV.asHexString(Vn))},500,[it]);const sn=pn=>{document.querySelector('[data-testid="color-popover"]')?.contains(pn.relatedTarget)||Nt(!1)};return(0,yt.jsx)(Ra.N,{onClick:()=>Nt(!1),children:(0,yt.jsxs)("div",{className:Ht.wrapper,children:[Tt&&!st.disabled&&(0,yt.jsx)(Kc.p9,{"data-testid":"color-popover",color:it,onChange:Ot,className:(0,Mn.cx)(rn.root,Ht.picker)}),(0,yt.jsx)(Fc.A,{...st,theme:wt,color:it,onChange:Ot,buttonAriaLabel:"Open color picker",onClick:()=>Nt(!0),onBlur:pn=>sn(pn),ref:ot,isClearable:!0})]})})});Pa.displayName="ColorPickerInput";const ja=be=>({wrapper:(0,Mn.css)({position:"relative"}),picker:(0,Mn.css)({"&.react-colorful":{position:"absolute",width:"100%",zIndex:11,bottom:"36px"}}),inner:(0,Mn.css)({position:"absolute"})});var jl=e(57339),gi=e(74451),Vc=e(50201),La=e(12965),br=e(34107),Ll=e(90811),Bl=e(91867),Os=e(72296),$c=e(83692),zc=e(11527),Gn=e(59310),er=e(5857),_c=e(96396),Gs=e(43482),yn=e(27282),io=e(5585),lo=e(27594),Kr=e(10928),fr=e(37386);const Ul=(0,Vt.memo)(()=>{const be=(0,na.of)(mi);return(0,yt.jsxs)("div",{className:be.ellipsis,children:[(0,yt.jsx)("span",{className:be.firstDot,children:"."}),(0,yt.jsx)("span",{className:be.secondDot,children:"."}),(0,yt.jsx)("span",{className:be.thirdDot,children:"."})]})});Ul.displayName="EllipsisAnimated";const mi=be=>({ellipsis:(0,Mn.css)({display:"inline"}),firstDot:(0,Mn.css)({[be.transitions.handleMotion("no-preference","reduce")]:{animation:`${Wl} 2s linear infinite`}}),secondDot:(0,Mn.css)({[be.transitions.handleMotion("no-preference","reduce")]:{animation:`${Gc} 2s linear infinite`}}),thirdDot:(0,Mn.css)({[be.transitions.handleMotion("no-preference","reduce")]:{animation:`${Nl} 2s linear infinite`}})}),Wl=(0,Mn.keyframes)`
  0% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,Gc=(0,Mn.keyframes)`
  0% {
    opacity: 0;
  }
  21% {
    opacity: 0.5;
  }
  22% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,Nl=(0,Mn.keyframes)`
  0% {
    opacity: 0;
  }
  43% {
    opacity: 0.5;
  }
  44% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,Kl=2*1e3;function wl(be){const{invalid:Ne,loading:Qe,onFinishChange:st,saveErrorMessage:ot="Error saving this value",error:it,children:Ot,disabled:Tt,...Nt}=be,[wt,Ht]=Vt.useState({isLoading:!1,showSuccess:!1,showError:Ne}),rn=(0,Vt.useRef)(null);Vt.useEffect(()=>{let Qn;if(wt.showSuccess){const ss=wt.showError?0:Kl;Qn=setTimeout(()=>{Ht({...wt,showSuccess:!1})},ss)}return()=>{window.clearTimeout(Qn)}},[wt]);const sn=(0,Vt.useCallback)(Qn=>{Ne||(Ht({...wt,isLoading:!0,showSuccess:!1}),st(Qn).then(()=>{Ht({isLoading:!1,showSuccess:!0,showError:!1})}).catch(()=>{Ht({...wt,isLoading:!1,showError:!0})}))},[Ne,wt,st]),pn=(0,Vt.useMemo)(()=>(0,Wa.debounce)(sn,600,{leading:!1}),[sn]),Vn=Ne||wt.showError||void 0,va=(0,na.of)(Hc);return(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)(fr.D,{...Nt,loading:Qe||void 0,invalid:Vn,disabled:Tt,error:it||wt.showError&&ot,ref:rn,className:va.widthFitContent,children:Vt.cloneElement(Ot(Qn=>{pn(Qn)}))}),wt.isLoading&&(0,yt.jsx)(Uo.r,{referenceElement:rn.current,placement:"right",children:(0,yt.jsxs)(x.x6,{i18nKey:"grafana-ui.auto-save-field.saving",children:["Saving ",(0,yt.jsx)(Ul,{})]})}),wt.showSuccess&&(0,yt.jsx)(Uo.r,{suffixIcon:"check",referenceElement:rn.current,placement:"right",children:(0,yt.jsx)(x.x6,{i18nKey:"grafana-ui.auto-save-field.saved",children:"Saved!"})})]})}wl.displayName="AutoSaveField";const Hc=()=>({widthFitContent:(0,Mn.css)({width:"fit-content"})});var vi=e(34213),Qc=e(94018),Fl=e(37658),Vl=e(34343),yi=e(71599),kc=e(92505),Ie=e(50992),pe=e(65232),Ce=e(78193),ke=e(13477),ut=e(22787),vt=e(53428),At=e(52792);const jt=({children:be})=>{const Ne=(0,na.of)($t);return(0,yt.jsx)("div",{children:(0,yt.jsx)("div",{className:Ne.header,children:(0,yt.jsx)("div",{className:Ne.content,children:be})})})},$t=be=>({header:(0,Mn.css)({display:"flex",margin:be.spacing(0,0,3,0)}),content:(0,Mn.css)({flexGrow:1})});var Yt=e(8515),qt=e(84600),hn=e(82143),Cn=e(24343),Nn=e(64780),In=e(87105);class un extends Vt.PureComponent{constructor(Ne){super(Ne),this.readCSV=(0,Wa.debounce)(()=>{const{config:ot}=this.props,{text:it}=this.state;this.setState({data:(0,bt.Jh)(it,{config:ot})})},150),this.onTextChange=ot=>{this.setState({text:ot.target.value})};const{text:Qe,config:st}=Ne;this.state={text:Qe,data:(0,bt.Jh)(Qe,{config:st})}}componentDidUpdate(Ne,Qe){const{text:st}=this.state;(st!==Qe.text||this.props.config!==Ne.config)&&this.readCSV(),this.props.text!==Ne.text&&this.props.text!==st&&this.setState({text:this.props.text}),this.state.data!==Qe.data&&this.props.onSeriesParsed(this.state.data,this.state.text)}render(){const{width:Ne,height:Qe,theme:st}=this.props,{data:ot}=this.state,it=fa(st);return(0,yt.jsxs)("div",{className:it.tableInputCsv,children:[(0,yt.jsx)(In.f,{style:{width:Ne,height:Qe},placeholder:(0,x.t)("grafana-ui.table.csv-placeholder","Enter CSV here..."),value:this.state.text,onChange:this.onTextChange,className:it.textarea}),ot&&(0,yt.jsx)("footer",{className:it.footer,children:ot.map((Ot,Tt)=>{const Nt=Ot.length,wt=Ot.fields.length;return(0,yt.jsx)("span",{children:(0,yt.jsxs)(x.x6,{i18nKey:"grafana-ui.table.csv-counts",children:["Rows:",{rows:Nt},", Columns:",{columns:wt}," \xA0",(0,yt.jsx)(Fs.I,{name:"check-circle"})]})},Tt)})})]})}}const Sn=(0,na.cV)(un);Sn.displayName="TableInputCSV";const fa=(0,li.N)(be=>({tableInputCsv:(0,Mn.css)({position:"relative"}),textarea:(0,Mn.css)({height:"100%",width:"100%"}),footer:(0,Mn.css)({position:"absolute",bottom:"15px",right:"15px",border:"1px solid #222",background:be.colors.success.main,padding:`1px ${be.spacing(.5)}`,fontSize:"80%"})}));var zn=e(54314),sa=e(60208),Bn=e(51898),qn=e(72489);const pa=(0,Vt.forwardRef)(({label:be,active:Ne,icon:Qe,counter:st,className:ot,suffix:it,onChangeTab:Ot,href:Tt,...Nt},wt)=>{const Ht=(0,na.of)(Un),rn=()=>(0,yt.jsxs)(yt.Fragment,{children:[Qe&&(0,yt.jsx)(Fs.I,{name:Qe}),be,typeof st=="number"&&(0,yt.jsx)(qn.p,{value:st}),it&&(0,yt.jsx)(it,{className:Ht.suffix})]}),sn=(0,Mn.cx)(Ht.link,Ne&&Ht.activeStyle);return(0,yt.jsx)("a",{href:Tt,className:sn,...Nt,onClick:Ot,"aria-label":Nt["aria-label"]||Bn.Tp.components.Tab.title(be),role:"tab","aria-selected":Ne,ref:wt,children:rn()})});pa.displayName="Tab";const Un=be=>({link:(0,Mn.css)({padding:"6px 12px",display:"block",height:"100%",cursor:"pointer",position:"relative",color:be.colors.text.primary,svg:{marginRight:be.spacing(1)},"&:hover, &:focus":{textDecoration:"underline"}}),activeStyle:(0,Mn.css)({label:"activeTabStyle",color:be.colors.text.maxContrast,overflow:"hidden","&::before":{display:"block",content:'" "',position:"absolute",left:0,width:"4px",bottom:"2px",top:"2px",borderRadius:be.shape.radius.default,backgroundImage:"linear-gradient(0deg, #f05a28 30%, #fbca0a 99%)"}}),suffix:(0,Mn.css)({marginLeft:be.spacing(1)})});var cs=e(13941),wr=e(70663),Dr=e(97611),ms=e(53431),Is=e(18627),pr=e(98005),tr=e(71076);const Rs=({content:be,position:Ne,offset:Qe})=>{const st=(0,na.of)(ns);return Ne?(0,yt.jsx)(_s.ZL,{className:st.portal,children:(0,yt.jsx)(tr.o,{position:Ne,offset:Qe||{x:0,y:0},children:be})}):null};Rs.displayName="VizTooltip";const ns=()=>({portal:(0,Mn.css)({position:"absolute",top:0,left:0,pointerEvents:"none",width:"100%",height:"100%"})});var xs=e(63428),xi=e(33352),Fr=e(67522),Wo=e(39884),Vr=e(64400),$d=e(54735),Bh=e(22940),zd=e(4268),Uh=e(89123),_d=e(34999),Gd=e(89599),Wh=e(74475),Yc=e(28134);function Nh({links:be}){const Ne=(0,na.of)(Kh);if(be.length===1)return(0,yt.jsx)(Yc.R,{link:be[0]});const Qe=be.filter(ot=>ot.target==="_blank"),st=be.filter(ot=>ot.target==="_self");return(0,yt.jsxs)(yt.Fragment,{children:[st.map((ot,it)=>(0,yt.jsx)(Yc.R,{link:ot},it)),(0,yt.jsxs)("div",{className:Ne.wrapper,children:[(0,yt.jsx)("p",{className:Ne.externalLinksHeading,children:(0,yt.jsx)(x.x6,{i18nKey:"grafana-ui.field-link-list.external-links-heading",children:"External links"})}),Qe.map((ot,it)=>(0,yt.jsxs)("a",{href:ot.href,target:ot.target,className:Ne.externalLink,children:[(0,yt.jsx)(Fs.I,{name:"external-link-alt"}),ot.title]},it))]})]})}const Kh=be=>({wrapper:(0,Mn.css)({flexBasis:"150px",width:"100px",marginTop:be.spacing(1)}),externalLinksHeading:(0,Mn.css)({color:be.colors.text.secondary,fontWeight:be.typography.fontWeightRegular,fontSize:be.typography.size.sm,margin:0}),externalLink:(0,Mn.css)({color:be.colors.text.link,fontWeight:be.typography.fontWeightRegular,display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","&:hover":{textDecoration:"underline"},div:{marginRight:be.spacing(1)}})}),wh=({className:be,children:Ne})=>{const Qe=(0,na.of)(Hd);return(0,yt.jsx)("div",{className:(0,Mn.cx)(Qe,be),children:Ne})},Hd=()=>(0,Mn.css)({display:"flex",button:{flexGrow:1,justifyContent:"center"},"> *":{flexGrow:1},label:{flexGrow:1,textAlign:"center"}});var $l=e(59795),Qd=e(43951),kd=e(97375),Fh=e(87063),Yd=e(30930),No=e(94535),Ei=e(41479),gr=e(96822),Vh=e(73628),$h=e(81917),zh=e(6399),Jd=e(71479),Xd=e(79331),Zd=e(991);const qd=(0,Vt.memo)((0,Vt.forwardRef)(({title:be,featureState:Ne,...Qe},st)=>{const ot=(0,na.of)(_h),it=Ne?(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)("div",{className:ot.badge,children:(0,yt.jsx)(Zd.y,{featureState:Ne})}),(0,yt.jsx)("h3",{children:be})]}):(0,yt.jsx)("h3",{children:be});return(0,yt.jsx)(Xd.w,{branded:!0,title:it,urlTitle:"Read documentation",ref:st,...Qe})}));qd.displayName="FeatureInfoBox";const _h=be=>({badge:(0,Mn.css)({marginBottom:be.spacing(1)})});var Gh=e(50275),Jc=e(22658),Xc=e(36303),Hh=e(56297),Qh=e(96004),Zc=e(55803),qc=e(21285),zl=e(18027);function kh({options:be,onOptionsChange:Ne}){return(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)("h3",{className:"page-heading",children:(0,yt.jsx)(x.x6,{i18nKey:"grafana-ui.data-source-settings.alerting-settings-heading",children:"Alerting"})}),(0,yt.jsx)("div",{className:"gf-form-group",children:(0,yt.jsx)("div",{className:"gf-form-inline",children:(0,yt.jsx)("div",{className:"gf-form",children:(0,yt.jsx)(zl.I,{labelWidth:29,label:(0,x.t)("grafana-ui.data-source-settings.alerting-settings-label","Manage alert rules in Alerting UI"),disabled:be.readOnly,tooltip:(0,x.t)("grafana-ui.data-source-settings.alerting-settings-tooltip","Manage alert rules for this data source. To manage other alerting resources, add an Alertmanager data source."),children:(0,yt.jsx)(qc.K,{value:be.jsonData.manageAlerts!==!1,onChange:Qe=>Ne({...be,jsonData:{...be.jsonData,manageAlerts:Qe.currentTarget.checked}})})})})})})]})}var Yh=e(3936),eu=e(37235),Jh=e(45558),As=e(68079),Xh=e(19052),Zh=e(4819),Cr=e(61875),qh=e(76671),ef=e(3263),tf=e(89467),nf=e(52042),af=e(8207),sf=e(17437),rf=e(69156),_l=e(63527),Ba=e(91302);const $r=({min:be,max:Ne,onChange:Qe,onAfterChange:st,orientation:ot="horizontal",reverse:it,step:Ot,value:Tt,ariaLabelForHandle:Nt,marks:wt,included:Ht})=>{const rn=ot==="horizontal",sn=(0,na.of)(Ba.$,rn,!!wt),pn=rf.A,[Vn,va]=(0,Vt.useState)(Tt??be),Qn=(0,Vt.useCallback)(On=>{const dn=typeof On=="number"?On:On[0];va(dn),Qe?.(dn)},[va,Qe]),ss=(0,Vt.useCallback)(On=>{let dn=+On.target.value;Number.isNaN(dn)&&(dn=0),va(dn),Qe&&Qe(dn),st&&st(dn)},[Qe,st]),Ga=(0,Vt.useCallback)(On=>{const dn=+On.target.value;dn>Ne?va(Ne):dn<be&&va(be)},[Ne,be]),Ha=(0,Vt.useCallback)(On=>{const dn=typeof On=="number"?On:On[0];st?.(dn)},[st]),Na=rn?[]:[sn.sliderInputVertical],Ps=rn?[]:[sn.sliderInputFieldVertical];return(0,yt.jsxs)("div",{className:(0,Mn.cx)(sn.container,sn.slider),children:[(0,yt.jsx)(sf.Global,{styles:sn.tooltip}),(0,yt.jsxs)("div",{className:(0,Mn.cx)(sn.sliderInput,...Na),children:[(0,yt.jsx)(pn,{min:be,max:Ne,step:Ot,defaultValue:Tt,value:Vn,onChange:Qn,onChangeComplete:Ha,vertical:!rn,reverse:it,ariaLabelForHandle:Nt,marks:wt,included:Ht}),(0,yt.jsx)(_l.p,{type:"text",width:7.5,className:(0,Mn.cx)(sn.sliderInputField,...Ps),value:Vn,onChange:ss,onBlur:Ga,min:be,max:Ne})]})]})};$r.displayName="Slider";var lf=e(21103),cf=e(50426),mr=e(3343),ed=e(26987),tu=e(93256),df=e(7895),uf=e(36219),hf=e(59695),ff=e(63152),pf=e(20941),gf=e(89640),nu=e(66404),au=e(31286),mf=e(41654),vf=e(13943),yf=e(35137),xf=e(72636),Ef=e(53487),Pf=e(16780),su=e(12594),ru=e(83871),bf=e(79233),Df=e(97095),td=e(49785);const ou=({name:be,control:Ne,children:Qe,...st})=>{const{fields:ot,append:it,prepend:Ot,remove:Tt,swap:Nt,move:wt,insert:Ht}=(0,td.jz)({control:Ne,name:be,...st});return Qe({fields:ot,append:it,prepend:Ot,remove:Tt,swap:Nt,move:wt,insert:Ht})};var co=e(18857),Cf=e(72508),Pi=e(69665),Tf=e(29362),Gl=e(43243),ds=e(31033),Mf=e(70733),Sf=e(92842);const Of=(0,Vt.forwardRef)(({children:be,onRemove:Ne,disabled:Qe,...st},ot)=>{const it=(0,na.of)(Hl,Qe),Ot=(0,x.t)("grafana-ui.value-pill.remove-button","Remove {{children}}",{children:be});return(0,yt.jsxs)("span",{className:it.wrapper,...st,ref:ot,children:[(0,yt.jsx)("span",{className:it.text,children:be}),!Qe&&(0,yt.jsxs)(yt.Fragment,{children:[(0,yt.jsx)("span",{className:it.separator}),(0,yt.jsx)(Ml.K,{name:"times",size:"md","aria-label":Ot,onClick:Tt=>{Tt.stopPropagation(),Ne()}})]})]})}),Hl=(be,Ne)=>({wrapper:(0,Mn.css)({display:"inline-flex",borderRadius:be.shape.radius.default,color:be.colors.text.primary,background:be.colors.background.secondary,padding:be.spacing(.25),border:Ne?`1px solid ${be.colors.border.weak}`:"none",fontSize:be.typography.bodySmall.fontSize,flexShrink:0,minWidth:"50px",alignItems:"center","&:first-child:has(+ div)":{flexShrink:1}}),text:(0,Mn.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:be.spacing(0,1,0,.75)}),separator:(0,Mn.css)({background:be.colors.border.weak,width:"2px",height:"100%",marginRight:be.spacing(.5)})});var nd=e(74440),bi=e(98869);const If=(be,Ne,Qe,st,ot,it,Ot,Tt)=>{const Nt=(0,_l.n)({theme:be,invalid:Qe}),wt=(0,Tl.getFocusStyles)(be),Ht=ot&&ot!=="auto"?be.spacing(ot):"100%",rn=it?be.spacing(it):"",sn=Ot?be.spacing(Ot):"";return{container:(0,Mn.css)({width:ot==="auto"?"auto":Ht,minWidth:rn,maxWidth:sn,display:ot==="auto"?"inline-block":"block"}),wrapper:(0,Mn.cx)(Nt.input,(0,Mn.css)({display:"flex",width:"100%",gap:be.spacing(.5),padding:be.spacing(.5),paddingRight:Tt?be.spacing(5):28,"&:focus-within":{...wt}})),input:(0,Mn.css)({border:"none",outline:"none",background:"transparent",flexGrow:1,maxWidth:"100%",minWidth:40,"&::placeholder":{color:be.colors.text.disabled},"&:focus":{outline:"none",cursor:"text"},cursor:"pointer"}),pillWrapper:(0,Mn.css)({display:"inline-flex",flexWrap:Ne?"wrap":"nowrap",flexGrow:1,minWidth:"50px",gap:be.spacing(.5)}),restNumber:(0,Mn.css)({display:"inline-flex",alignItems:"center",justifyContent:"center",padding:be.spacing(0,1),border:st?`1px solid ${be.colors.border.weak}`:"none",borderRadius:be.shape.radius.default,backgroundColor:be.colors.background.secondary,cursor:"pointer","&:hover":{backgroundColor:be.colors.action.hover}}),suffix:Nt.suffix,disabled:Nt.inputDisabled}};var ad=e(33605),Rf=e(75168),sd=e(49185),Ko=e(53568);const Af=12,zr=50,iu=10,lu=15;function cu(be,Ne,Qe){const[st,ot]=(0,Vt.useState)(be.length),[it,{width:Ot}]=(0,sd.A)(),[Tt,{width:Nt}]=(0,sd.A)(),[wt,{width:Ht}]=(0,sd.A)(),rn=Ne&&Ne!=="auto"?Ne:Ot;return(0,Vt.useEffect)(()=>{const sn=rn-Nt-Ht;let pn=0;for(let Vn=0;Vn<be.length;Vn++){if(pn+=(0,Ko.kD)(be[Vn].label||"",Af).width+(Qe?iu:zr),pn>sn){ot(Math.min(Vn,lu)||1);break}Vn===be.length-1&&ot(be.length)}},[rn,Nt,Ht,be,ot,Qe]),{measureRef:it,counterMeasureRef:Tt,suffixMeasureRef:wt,shownItems:st}}function rd(be){const Ne=(0,Vt.useRef)(null),Qe=(0,Vt.useRef)(0),[st,ot]=(0,Vt.useState)("");return(0,Vt.useLayoutEffect)(()=>{if(Ne.current&&be==null&&Qe.current===0&&(Qe.current=Ne?.current.getBoundingClientRect().width),!Ne.current||be==null){ot("");return}const it=window.getComputedStyle(Ne.current).fontSize,Ot=(0,Ko.kD)(Ne.current.value||"",parseInt(it,10)).width;Ot<Qe.current?ot(""):ot(`${Ot+5}px`)},[be]),{inputRef:Ne,inputWidth:st}}var Ql=e(5320);const od=be=>{const{placeholder:Ne,onChange:Qe,value:st,width:ot,enableAllOption:it,invalid:Ot,disabled:Tt,minWidth:Nt,maxWidth:wt,isClearable:Ht,createCustomValue:rn=!1}=be,sn=(0,na.of)(bi.C3),[pn,Vn]=(0,Vt.useState)(""),va=(0,Vt.useMemo)(()=>({label:pn===""?(0,x.t)("multicombobox.all.title","All"):(0,x.t)("multicombobox.all.title-filtered","All (filtered)"),value:ad.A}),[pn]),{options:Qn,updateOptions:ss,asyncLoading:Ga,asyncError:Ha}=(0,Ql.I)(be.options,rn),Na=(0,Vt.useMemo)(()=>it&&Qn.length>1?[va,...Qn]:Qn,[Qn,it,va]),Ps=be.loading||Ga,On=(0,Vt.useMemo)(()=>st?du(st,typeof be.options!="function"?be.options:Qn):[],[st,be.options,Qn]),{measureRef:dn,counterMeasureRef:ra,suffixMeasureRef:Tn,shownItems:da}=cu(On,ot,Tt),ua=(0,Vt.useCallback)(ya=>On.some(wa=>wa.value===ya.value),[On]),{getSelectedItemProps:ga,getDropdownProps:ha,setSelectedItems:Oa,addSelectedItem:Va,removeSelectedItem:vs,reset:rs}=(0,ds.mH)({selectedItems:On,onStateChange:({type:ya,selectedItems:wa})=>{switch(ya){case ds.mH.stateChangeTypes.SelectedItemKeyDownBackspace:case ds.mH.stateChangeTypes.SelectedItemKeyDownDelete:case ds.mH.stateChangeTypes.DropdownKeyDownBackspace:case ds.mH.stateChangeTypes.FunctionRemoveSelectedItem:case ds.mH.stateChangeTypes.FunctionAddSelectedItem:case ds.mH.stateChangeTypes.FunctionSetSelectedItems:case ds.mH.stateChangeTypes.FunctionReset:Qe(wa??[]);break;default:break}},stateReducer:(ya,wa)=>{const{changes:Us}=wa;return{...Us,activeIndex:-999}}}),{getToggleButtonProps:js,isOpen:os,highlightedIndex:Ui,getMenuProps:Qa,getInputProps:Ls,getItemProps:Ms}=(0,ds.Bp)({items:Na,itemToString:nd.y,inputValue:pn,selectedItem:null,stateReducer:(ya,wa)=>{const{type:Us}=wa;let{changes:Ws}=wa;switch(ya.isOpen===!1&&Ws.isOpen===!0&&Ws.inputValue===ya.inputValue&&(Ws={...Ws,inputValue:""}),Us){case ds.Bp.stateChangeTypes.InputKeyDownEnter:case ds.Bp.stateChangeTypes.ItemClick:return{...Ws,isOpen:!0,highlightedIndex:ya.highlightedIndex};case ds.Bp.stateChangeTypes.InputBlur:Vn("");default:return Ws}},onIsOpenChange:({isOpen:ya,inputValue:wa})=>{ya&&wa===""&&ss(wa)},onStateChange:({inputValue:ya,type:wa,selectedItem:Us})=>{switch(wa){case ds.Bp.stateChangeTypes.InputKeyDownEnter:case ds.Bp.stateChangeTypes.ItemClick:if(Us?.value===ad.A){const Ws=On.length===Na.length-1,ar=Na.slice(1);let sr=Ws&&pn===""?[]:ar;if(!Ws&&pn!==""&&(sr=[...new Set([...On,...ar])]),Ws&&pn!==""){const Eh=new Set(ar.map(Ld=>Ld.value));sr=On.filter(Ld=>!Eh.has(Ld.value))}Oa(sr)}else Us&&ua(Us)?vs(Us):Us&&Va(Us);break;case ds.Bp.stateChangeTypes.InputChange:Vn(ya??""),ss(ya??"");break;default:break}}}),{inputRef:Xa,floatingRef:bs,floatStyles:us,scrollRef:Bs}=(0,Rf.l)(Na,os),Za=(0,na.of)(If,os,Ot,Tt,ot,Nt,wt,Ht),Or=os?On.slice(0,lu):On.slice(0,da),{inputRef:Qr,inputWidth:Wi}=rd(pn);return(0,yt.jsxs)("div",{className:Za.container,ref:Xa,children:[(0,yt.jsx)("div",{className:(0,Mn.cx)(Za.wrapper,{[Za.disabled]:Tt}),ref:dn,children:(0,yt.jsxs)("span",{className:Za.pillWrapper,children:[Or.map((ya,wa)=>(0,yt.jsx)(Of,{disabled:Tt,onRemove:()=>{vs(ya)},...ga({selectedItem:ya,index:wa}),children:(0,nd.y)(ya)},`${ya.value}${wa}`)),On.length>Or.length&&(0,yt.jsxs)(au.a,{display:"flex",direction:"row",marginLeft:.5,gap:1,ref:ra,children:[(0,yt.jsx)(nu.E,{children:"..."}),(0,yt.jsx)(no.m,{interactive:!0,content:(0,yt.jsx)(yt.Fragment,{children:On.slice(Or.length).map(ya=>(0,yt.jsx)("div",{children:(0,nd.y)(ya)},ya.value))}),children:(0,yt.jsx)("div",{className:Za.restNumber,children:On.length-da})})]}),(0,yt.jsx)("input",{className:Za.input,...Ls(ha({disabled:Tt,preventKeyAction:os,placeholder:Or.length===0?Ne:"",ref:Qr,style:{width:Wi}}))}),(0,yt.jsxs)("div",{className:Za.suffix,ref:Tn,...js(),children:[Ht&&On.length>0&&(0,yt.jsx)(Fs.I,{name:"times",className:sn.clear,title:(0,x.t)("multicombobox.clear.title","Clear all"),tabIndex:0,role:"button",onClick:ya=>{ya.stopPropagation(),rs()},onKeyDown:ya=>{(ya.key==="Enter"||ya.key===" ")&&rs()}}),(0,yt.jsx)(Sf.f,{isLoading:Ps||!1,isOpen:os})]})]})}),(0,yt.jsx)(_s.ZL,{children:(0,yt.jsx)("div",{className:(0,Mn.cx)(sn.menu,!os&&sn.menuClosed),style:{...us,width:us.width+24},...Qa({ref:bs}),children:os&&(0,yt.jsx)(Mf.e,{options:Na,highlightedIndex:Ui,selectedItems:On,scrollRef:Bs,getItemProps:Ms,enableAllOption:it,isMultiSelect:!0,error:Ha})})})]})};function du(be,Ne){if(uu(be))return be;const Qe=new Map(be.map((ot,it)=>[ot,it])),st=[];for(const ot of Ne){const it=Qe.get(ot.value);if(it!==void 0&&(st[it]=ot,Qe.delete(ot.value)),Qe.size===0)break}for(const[ot,it]of Qe)st[it]={value:ot};return st}function uu(be){return typeof be[0]=="object"}var kl=e(32881),jf=e(99887),hu=e(77824),Lf=e(45450),fu=e(16203),Yl=e(33033),Bf=e(12737),Uf=e(48767),pu=e(40601),gu=e(32635),mu=e(57688),vu=e(40279),Wf=e(48431),Nf=e(56265),Kf=e(90929),Jl=e(8073),vr=e(43856),id=e(21539),yu=e(15356),xu=e(88559),wf=e(63509),ld=e(35942);const Eu=({users:be,onClick:Ne,limit:Qe=4})=>{const st=(0,na.of)(Ff);if(!be.length)return null;Qe=Qe>0?Qe:4;const ot=be.length>Qe,it=be.length-Qe,Ot=it>99;return(0,yt.jsxs)("div",{className:st.container,"aria-label":(0,x.t)("grafana-ui.users-indicator.container-label","Users indicator container"),children:[ot&&(0,yt.jsx)(ld.n,{onClick:Ne,userView:{user:{name:"Extra users"},lastActiveAt:""},showTooltip:!1,children:Ot?"...":`+${it}`}),be.slice(0,ot?Qe:Qe+1).reverse().map(Tt=>(0,yt.jsx)(ld.n,{userView:Tt},Tt.user.name))]})},Ff=be=>({container:(0,Mn.css)({display:"flex",justifyContent:"center",flexDirection:"row-reverse",marginLeft:be.spacing(1),"& > button":{marginLeft:be.spacing(-1)}}),dots:(0,Mn.css)({marginBottom:"3px"})});var Xl=e(71555),Vf=e(51115),$f=e(3271),zf=e(45897),_f=e(93008),Pu=e(99555),cd=e(47276),Gf=e(23414),bu=e(92790),dd=e(61897),Hf=e(16477),Du=e(73858),ud=e(7515),Qf=e(69234),kf=e(18667),Cu=e(93630),Tu=e(62748),hd=e(49256),Yf=e(88977),Jf=e(3023);const Mu=({getContextMenuSource:be,timeZone:Ne,itemsGroup:Qe,dimensions:st,contextDimensions:ot,...it})=>{const Ot=be(),Tt=Qe?Qe.map(Ht=>({...Ht,items:Ht.items?.filter(rn=>rn.label)})):[],Nt=()=>{if(!Ot)return null;let Ht;if(st?.yAxis&&ot?.yAxis?.[1]){const sn=ze(st.yAxis,ot.yAxis[0],ot.yAxis[1]),pn=Ot.series.valueField.display;Ht=pn(sn)}const rn=(0,Xs.LE)(Ot.datapoint[0],{defaultWithMS:Ot.series.hasMsResolution,timeZone:Ne});return(0,yt.jsx)(fd,{timestamp:rn,seriesColor:Ot.series.color,displayName:Ot.series.alias||Ot.series.label,displayValue:Ht})},wt=()=>Tt?.map((Ht,rn)=>(0,yt.jsx)(Yd.r,{label:Ht.label,children:(Ht.items||[]).map(sn=>(0,yt.jsx)(No.D,{url:sn.url,label:sn.label,target:sn.target,icon:sn.icon,active:sn.active,onClick:sn.onClick},`${sn.label}`))},`${Ht.label}${rn}`));return(0,yt.jsx)(kd.t,{...it,renderMenuItems:wt,renderHeader:Nt})},fd=({timestamp:be,seriesColor:Ne,displayName:Qe,displayValue:st})=>{const ot=(0,na.of)(Xf);return(0,yt.jsxs)("div",{className:ot.wrapper,children:[(0,yt.jsx)("strong",{children:be}),(0,yt.jsxs)(kl.Gy,{children:[(0,yt.jsxs)("div",{children:[(0,yt.jsx)(Jd.p,{color:Ne}),(0,yt.jsx)("span",{className:ot.displayName,children:Qe})]}),st&&(0,yt.jsx)(id.i,{value:st})]})]})};function Xf(be){return{wrapper:(0,Mn.css)({padding:be.spacing(.5,1),fontSize:be.typography.size.sm,zIndex:be.zIndex.tooltip}),displayName:(0,Mn.css)({whiteSpace:"nowrap",paddingLeft:be.spacing(.5)})}}const Zf=(be,Ne)=>{let Qe=0,st=be.values.length-1,ot;for(;;){if(Qe>st)return Math.max(st,0);ot=Math.floor((Qe+st)/2);const it=be.values[ot];if(it===Ne)return ot;it&&it<Ne?Qe=ot+1:st=ot-1}},qf=(be,Ne,Qe,st)=>{let ot,it,Ot,Tt,Nt;const wt=[];let Ht,rn;for(ot=0;ot<be.length;ot++){it=be[ot];const sn=Ne[ot];Ot=Zf(sn,Qe),Tt=Qe-sn.values[Ot],Nt=sn.values[Ot],(Ht===void 0||Tt>=0&&(Tt<Ht||Ht<0)||Tt<0&&Tt>Ht)&&(Ht=Tt,rn=sn.display?(0,Ka.cN)(sn.display(Nt)):Nt);const pn=it.display(it.values[Ot]);wt.push({value:(0,Ka.cN)(pn),datapointIndex:Ot,seriesIndex:ot,color:pn.color,label:(0,gt.Ct)(it),time:sn.display?(0,Ka.cN)(sn.display(Nt)):Nt})}return{results:wt,time:rn}},Su=(be,Ne)=>(0,Xs.LE)(be,{format:Ne?.options?.timeformat,timeZone:Ne?.options?.timezone}),pd=(be,Ne,Qe)=>{if(Ne&&Qe&&be){const st=Qe-Ne,ot=st/be/1e3,it=86400010,Ot=31536e6;return ot<=10?ts.WC.interval.millisecond:ot<=45?ts.WC.interval.second:st<=it?ts.WC.interval.minute:ot<=8e4?ts.WC.interval.hour:st<=Ot?ts.WC.interval.day:ot<=31536e3?ts.WC.interval.month:ts.WC.interval.year}return ts.WC.interval.minute},Ou=({dimensions:be,activeDimensions:Ne,pos:Qe,timeZone:st})=>{let ot=null;if(Ne.xAxis===null)return null;Ne.yAxis&&(ot=Ne.yAxis[0]);const it=Ne.xAxis[1]?ze(be.xAxis,Ne.xAxis[0],Ne.xAxis[1]):Qe.x,Ot=qf(be.yAxis.columns,be.xAxis.columns,it,st),Tt=Ot.time,Nt=Ot.results.map((wt,Ht)=>({color:wt.color,label:wt.label,value:wt.value,isActive:ot===Ht}));return(0,yt.jsx)(xs.o,{series:Nt,timestamp:Tt})};Ou.displayName="MultiModeGraphTooltip";const Iu=({dimensions:be,activeDimensions:Ne,timeZone:Qe})=>{if(Ne.yAxis===null||Ne.yAxis[1]===void 0||Ne.xAxis===null||Ne.xAxis[1]===void 0)return null;const st=ze(be.xAxis,Ne.xAxis[0],Ne.xAxis[1]),ot=Ve(be.xAxis,Ne.xAxis[0]),it=ot.display?(0,Ka.cN)(ot.display(st)):st,Ot=Ve(be.yAxis,Ne.yAxis[0]),Tt=ze(be.yAxis,Ne.yAxis[0],Ne.yAxis[1]),Nt=Ot.display,wt=Nt(Tt);return(0,yt.jsx)(xs.o,{series:[{color:wt.color,label:(0,gt.Ct)(Ot),value:(0,Ka.cN)(wt)}],timestamp:it})};Iu.displayName="SingleModeGraphTooltip";const Ru=({mode:be=Pt.$N.Single,dimensions:Ne,activeDimensions:Qe,pos:st,timeZone:ot})=>!Qe||!Qe.xAxis?null:be==="single"?(0,yt.jsx)(Iu,{dimensions:Ne,activeDimensions:Qe,timeZone:ot}):(0,yt.jsx)(Ou,{dimensions:Ne,activeDimensions:Qe,pos:st,timeZone:ot});Ru.displayName="GraphTooltip";class Tr extends Vt.PureComponent{constructor(){super(...arguments),this.state={isTooltipVisible:!1,isContextVisible:!1},this.element=null,this.$element=null,this.onPlotSelected=(Ne,Qe)=>{const{onHorizontalRegionSelected:st}=this.props;st&&st(Qe.xaxis.from,Qe.xaxis.to)},this.onPlotHover=(Ne,Qe,st)=>{this.setState({isTooltipVisible:!0,activeItem:st,pos:Qe})},this.onPlotClick=(Ne,Qe,st)=>{this.setState({isContextVisible:!0,isTooltipVisible:!1,contextItem:st,contextPos:Qe})},this.renderTooltip=()=>{const{children:Ne,series:Qe,timeZone:st}=this.props,{pos:ot,activeItem:it,isTooltipVisible:Ot}=this.state;let Tt;if(!Ot||!ot||Qe.length===0||(Vt.Children.forEach(Ne,Qn=>{if(Tt)return;(Qn&&Qn.type&&(Qn.type.displayName||Qn.type.name))===Rs.displayName&&(Tt=Qn)}),!Tt))return null;const Nt=Tt.props,wt=Nt.mode||"single";if(!it&&wt==="single")return null;const Ht=Nt.tooltipComponent||Ru,rn=it?it.series.seriesIndex:0,sn=it?it.dataIndex:void 0,pn={xAxis:[rn,sn],yAxis:it?[it.series.seriesIndex,it.dataIndex]:null},Vn={dimensions:{xAxis:De("xAxis",Qe.map(Qn=>Qn.timeField)),yAxis:De("yAxis",Qe.map(Qn=>Qn.valueField))},activeDimensions:pn,pos:ot,mode:Nt.mode||Pt.$N.Single,timeZone:st},va=Vt.createElement(Ht,{...Vn});return Vt.cloneElement(Tt,{content:va,position:{x:ot.pageX,y:ot.pageY},offset:{x:10,y:10}})},this.renderContextMenu=()=>{const{series:Ne}=this.props,{contextPos:Qe,contextItem:st,isContextVisible:ot}=this.state;if(!ot||!Qe||!st||Ne.length===0)return null;const it=st?st.series.seriesIndex:0,Ot=st?st.dataIndex:void 0,Tt={xAxis:[it,Ot],yAxis:st?[st.series.seriesIndex,st.dataIndex]:null},Nt={xAxis:De("xAxis",Ne.map(sn=>sn.timeField)),yAxis:De("yAxis",Ne.map(sn=>sn.valueField))},wt=()=>this.setState({isContextVisible:!1}),Ht=()=>({datapoint:st.datapoint,dataIndex:st.dataIndex,series:st.series,seriesIndex:st.series.seriesIndex,pageX:Qe.pageX,pageY:Qe.pageY}),rn={x:Qe.pageX,y:Qe.pageY,onClose:wt,getContextMenuSource:Ht,timeZone:this.props.timeZone,dimensions:Nt,contextDimensions:Tt};return(0,yt.jsx)(Mu,{...rn})},this.getBarWidth=()=>{const{series:Ne}=this.props;return Math.min(...Ne.map(Qe=>Qe.timeStep))}}static{this.defaultProps={showLines:!0,showPoints:!1,showBars:!1,isStacked:!1,lineWidth:1}}componentDidUpdate(Ne,Qe){Ne!==this.props&&this.draw()}componentDidMount(){this.draw(),this.element&&(this.$element=He()(this.element),this.$element.bind("plotselected",this.onPlotSelected),this.$element.bind("plothover",this.onPlotHover),this.$element.bind("plotclick",this.onPlotClick))}componentWillUnmount(){this.$element&&this.$element.unbind("plotselected",this.onPlotSelected)}getYAxes(Ne){return Ne.length===0?[{show:!0,min:-1,max:1}]:(0,Wa.uniqBy)(Ne.map(Qe=>{const st=Qe.yAxis?Qe.yAxis.index:1,ot=Qe.yAxis&&Qe.yAxis.min&&!isNaN(Qe.yAxis.min)?Qe.yAxis.min:null,it=Qe.yAxis&&Qe.yAxis.tickDecimals&&!isNaN(Qe.yAxis.tickDecimals)?Qe.yAxis.tickDecimals:null;return{show:!0,index:st,position:st===1?"left":"right",min:ot,tickDecimals:it}}),Qe=>Qe.index)}draw(){if(this.element===null)return;const{width:Ne,series:Qe,timeRange:st,showLines:ot,showBars:it,showPoints:Ot,isStacked:Tt,lineWidth:Nt,timeZone:wt,onHorizontalRegionSelected:Ht}=this.props;if(!Ne)return;const rn=Ne/100,sn=st.from.valueOf(),pn=st.to.valueOf(),Vn=this.getYAxes(Qe),va={legend:{show:!1},series:{stack:Tt,lines:{show:ot,lineWidth:Nt,zero:!1},points:{show:Ot,fill:1,fillColor:!1,radius:2},bars:{show:it,fill:1,barWidth:it?this.getBarWidth()/1.5:1,zero:!1,lineWidth:Nt},shadowSize:0},xaxis:{timezone:wt,show:!0,mode:"time",min:sn,max:pn,label:"Datetime",ticks:rn,timeformat:pd(rn,sn,pn),tickFormatter:Su},yaxes:Vn,grid:{minBorderMargin:0,markings:[],backgroundColor:null,borderWidth:0,hoverable:!0,clickable:!0,color:"#a1a1a1",margin:{left:0,right:0},labelMarginX:0,mouseActiveRadius:30},selection:{mode:Ht?"x":null,color:"#666"},crosshair:{mode:"x"}};try{He().plot(this.element,Qe.filter(Qn=>Qn.isVisible),va)}catch(Qn){throw console.error("Graph rendering error",Qn,va,Qe),new Error("Error rendering panel")}}render(){const{ariaLabel:Ne,height:Qe,width:st,series:ot}=this.props,it=ot.length===0,Ot=this.renderTooltip(),Tt=this.renderContextMenu();return(0,yt.jsxs)("div",{className:"graph-panel","aria-label":Ne,children:[(0,yt.jsx)("div",{className:"graph-panel__chart",ref:Nt=>this.element=Nt,style:{height:Qe,width:st},onMouseLeave:()=>{this.setState({isTooltipVisible:!1})}}),it&&(0,yt.jsx)("div",{className:"datapoints-warning",children:"No data"}),Ot,Tt]})}}const Di=null,gd=(be,Ne=!1,Qe=!1)=>{const st=be.reduce((it,Ot)=>it+(Ot[1]||0),0)===0,ot=!be.reduce((it,Ot)=>it&&Ot[1]!==null,!0);return Ne&&ot||Qe&&st},Au=be=>{const{series:Ne,timeRange:Qe,width:st,height:ot,showBars:it,showLines:Ot,showPoints:Tt,sortLegendBy:Nt,sortLegendDesc:wt,legendDisplayMode:Ht,legendVisibility:rn,placement:sn,onSeriesToggle:pn,onToggleSort:Vn,hideEmpty:va,hideZero:Qn,isStacked:ss,lineWidth:Ga,onHorizontalRegionSelected:Ha,timeZone:Na,children:Ps,ariaLabel:On}=be,{graphContainer:dn,wrapper:ra,legendContainer:Tn}=(0,na.of)(ep,be.placement),da=Ne.reduce((ua,ga)=>gd(ga.data,va,Qn)?ua:ua.concat([{label:ga.label,color:ga.color||"",disabled:!ga.isVisible,yAxis:ga.yAxis.index,getDisplayValues:()=>ga.info||[]}]),[]);return(0,yt.jsxs)("div",{className:ra,"aria-label":On,children:[(0,yt.jsx)("div",{className:dn,children:(0,yt.jsx)(Tr,{series:Ne,timeRange:Qe,timeZone:Na,showLines:Ot,showPoints:Tt,showBars:it,width:st,height:ot,isStacked:ss,lineWidth:Ga,onHorizontalRegionSelected:Ha,children:Ps})}),rn&&(0,yt.jsx)("div",{className:Tn,children:(0,yt.jsx)(oo.E,{hideHorizontalTrack:!0,children:(0,yt.jsx)(zd.t,{items:da,displayMode:Ht,placement:sn,sortBy:Nt,sortDesc:wt,onLabelClick:(ua,ga)=>{pn&&pn(ua.label,ga)},onToggleSort:Vn})})})]})},ep=(be,Ne)=>({wrapper:(0,Mn.css)({display:"flex",flexDirection:Ne==="bottom"?"column":"row"}),graphContainer:(0,Mn.css)({minHeight:"65%",flexGrow:1}),legendContainer:(0,Mn.css)({padding:"10px 0",maxHeight:Ne==="bottom"?"35%":"none"})});class ju extends Vt.Component{constructor(Ne){super(Ne),this.onSeriesToggle=this.onSeriesToggle.bind(this),this.state={hiddenSeries:[],toggledSeries:Ne.series}}componentDidUpdate(Ne){const{series:Qe}=this.props;(0,Wa.isEqual)(Ne.series,Qe)||this.setState({hiddenSeries:[],toggledSeries:Qe})}onSeriesToggle(Ne,Qe){const{series:st,onHiddenSeriesChanged:ot}=this.props,{hiddenSeries:it}=this.state;if(Qe.ctrlKey||Qe.metaKey||Qe.shiftKey){const wt=it.indexOf(Ne)>-1?it.filter(rn=>rn!==Ne):it.concat([Ne]),Ht=st.map(rn=>({...rn,isVisible:wt.indexOf(rn.label)===-1}));this.setState({hiddenSeries:wt,toggledSeries:Ht},()=>ot?ot(wt):void 0);return}const Ot=st.map(wt=>wt.label),Tt=it.length+1===Ot.length?[]:(0,Wa.difference)(Ot,[Ne]),Nt=st.map(wt=>({...wt,isVisible:Tt.indexOf(wt.label)===-1}));this.setState({hiddenSeries:Tt,toggledSeries:Nt},()=>ot?ot(Tt):void 0)}render(){const{children:Ne}=this.props,{toggledSeries:Qe}=this.state;return Ne({onSeriesToggle:this.onSeriesToggle,toggledSeries:Qe})}}var tp=e(64423),md=e(99165),_r=e(36192);const np={threshold:(be,Ne,Qe)=>be+Qe,midpoint:(be,Ne,Qe)=>(be+Ne)/2,plusone:(be,Ne,Qe)=>be+1};function ap(be){if(be.frame.length===0)return be.frame;let Ne=!0,{frame:Qe,refFieldName:st,refFieldPseudoMax:ot,refFieldPseudoMin:it,insertMode:Ot}=be;Ot||(Ot=np.threshold);const Tt=Zl(Qe,st);if(Tt==null)return Qe;Tt.state={...Tt.state,nullThresholdApplied:!0};const Nt=Qe.fields.map(Ht=>Ht.config.custom?.insertNulls||Tt.config.interval||null),wt=new Set(Nt);if(wt.delete(null),wt.size===0)return Qe;if(wt.size===1){const Ht=wt.values().next().value;if(!Ht||Ht<=0)return Qe;const rn=Tt.values,sn=Qe.fields.map(Vn=>Vn.values),pn=yr(rn,sn,Ht,it,ot,Ot,Ne);return pn===sn?Qe:{...Qe,length:pn[0].length,fields:Qe.fields.map((Vn,va)=>({...Vn,values:pn[va]}))}}return Qe}function yr(be,Ne,Qe,st=null,ot=null,it,Ot){const Tt=be.length,Nt=[];if(st!=null&&st<be[0]){let sn=Math.ceil((be[0]-st)/Qe),pn=be[0]-sn*Qe;for(;pn<be[0];)Nt.push(it(pn-Qe,pn,Qe)),pn+=Qe}Nt.push(be[0]);let wt=be[0];for(let sn=1;sn<Tt;sn++){const pn=be[sn];for(;pn-wt>Qe&&(Nt.push(it(wt,pn,Qe)),wt+=Qe,!!Ot););Nt.push(pn),wt=pn}if(ot!=null&&ot>wt)for(;wt+Qe<ot;)Nt.push(it(wt,ot,Qe)),wt+=Qe;const Ht=Nt.length;if(Ht===Tt)return Ne;const rn=[];for(let sn of Ne){let pn;if(sn!==be){pn=Array(Ht);for(let Vn=0,va=0;Vn<Ht;Vn++)pn[Vn]=be[va]===Nt[Vn]?sn[va++]:null}else pn=Nt;rn.push(pn)}return rn}function Lu(be,Ne,Qe){let st,ot;for(let it=0;it<Ne.length;it++)if(Ne[it]==null)ot==null&&st!=null&&(ot=it);else{if(ot!=null){if(be[it]-st<Qe)for(;ot<it;)Ne[ot++]=void 0;ot=null}st=be[it]}return Ne}function uo(be){return be.type===ls.PU.number&&be.config.custom?.drawStyle===Pt.GR.Bars&&!be.config.custom?.hideFrom?.viz}function Zl(be,Ne){return be.fields.find(Qe=>Ne!=null?Qe.name===Ne:Qe.type===ls.PU.time)}function Ci(be,Ne){const Qe=Zl(be,Ne);let st=Qe?.values;for(let ot=0;ot<be.fields.length;ot++){let it=be.fields[ot];if(it===Qe||uo(it))continue;let Ot=it.config.custom?.spanNulls;typeof Ot=="number"&&Ot!==-1&&st&&(it.values=Lu(st,it.values,Ot))}return be}function Ti(be,Ne,Qe){let st;e:for(let Tt of be)for(let Nt of Tt.fields)if(Ne.x(Nt,Tt,be)){st=Nt;break e}be=be.map(Tt=>st?.state?.nullThresholdApplied?Tt:ap({frame:Tt,refFieldName:st.name,refFieldPseudoMin:Qe?.from.valueOf(),refFieldPseudoMax:Qe?.to.valueOf()}));let ot=0;be.forEach(Tt=>{Tt.fields.forEach(Nt=>{uo(Nt)&&(Nt.config.custom={...Nt.config.custom,spanNulls:-1},ot++)})});let it=1/0;ot>1&&be.forEach(Tt=>{if(!Tt.fields.some(uo))return;const Nt=st.values;for(let wt=0;wt<Nt.length;wt++)wt>0&&(it=Math.min(it,Nt[wt]-Nt[wt-1]))});let Ot=(0,ka.Fd)({frames:be,joinBy:Ne.x,keep:Ne.y,keepOriginIndices:!0});return Ot?(Ot=Ci(Ot,st.name),it!==1/0&&(Ot.fields.forEach((Tt,Nt)=>{let wt=Tt.values;if(Nt===0){let Ht=wt[wt.length-1];wt.push(Ht+it,Ht+2*it)}else uo(Tt)?wt.push(null,null):wt.push(void 0,void 0)}),Ot.length+=2),Ot):null}function sp(be,Ne){const Qe="na",st=`${be.min!==void 0?be.min:Qe}-${be.max!==void 0?be.max:Qe}`,ot=`${be.custom?.axisSoftMin!==void 0?be.custom.axisSoftMin:Qe}-${be.custom?.axisSoftMax!==void 0?be.custom.axisSoftMax:Qe}`,it=`${be.custom?.axisPlacement!==void 0?be.custom?.axisPlacement:Pt.vM.Auto}`,Ot=be.unit??Tu.s,Tt=be.custom?.scaleDistribution?Bu(be.custom.scaleDistribution):Pt.L4.Linear,Nt=be.custom?.axisLabel?be.custom.axisLabel:Qe;return`${Ot}/${st}/${ot}/${it}/${Tt}/${Nt}/${Ne}`}function Bu(be){return be.type===Pt.L4.Log?`${be.type}${be.log}`:be.type}function Uu(be,Ne,Qe=[]){for(const st of Qe)if(typeof st=="function"){if(!st(be,Ne))return!1}else if(Ne[st]!==be[st])return!1;return!0}class rp extends Vt.Component{constructor(Ne){super(Ne),this.panelContext={},this.subscription=new tp.yU,this.getTimeRange=()=>this.props.timeRange;let Qe=this.prepState(Ne);Qe.alignedData=Qe.config.prepData([Qe.alignedFrame]),this.state=Qe,this.plotInstance=Vt.createRef()}static{this.contextType=Vr.e4}prepState(Ne,Qe=!0){let st=null;const{frames:ot,fields:it,preparePlotFrame:Ot}=Ne,Nt=(Ot||Ti)(ot,it||{x:Fn.sJ.get(Kn.Ct.firstTimeField).get({}),y:Fn.sJ.get(Kn.Ct.byTypes).get(new Set([ls.PU.number,ls.PU.enum]))},Ne.timeRange);if((0,_r.uY)("GraphNG",!1,"data aligned",Nt),Nt){let wt=this.state?.config;Qe&&(wt=Ne.prepConfig(Nt,this.props.frames,this.getTimeRange),(0,_r.uY)("GraphNG",!1,"config prepared",wt)),st={alignedFrame:Nt,config:wt},(0,_r.uY)("GraphNG",!1,"data prepared",st.alignedData)}return st}handleCursorUpdate(Ne){const Qe=Ne.payload?.point?.time,st=this.plotInstance.current;if(st&&Qe){const ot=st.valToPos(Qe,"x");let it;if(ot&&(it=(0,_r.sw)(st,st.posToIdx(ot))),!it||!ot)return;st.setCursor({left:ot,top:it})}}componentDidMount(){this.panelContext=this.context;const{eventBus:Ne}=this.panelContext;this.subscription.add(Ne.getStream(ln.b_).pipe((0,md.c)(50)).subscribe({next:Qe=>{Ne!==Qe.origin&&this.handleCursorUpdate(Qe)}})),this.subscription.add(Ne.getStream(lr.kb).pipe((0,md.c)(50)).subscribe({next:Qe=>this.handleCursorUpdate(Qe)})),this.subscription.add(Ne.getStream(ln.ql).pipe((0,md.c)(50)).subscribe({next:()=>{const Qe=this.plotInstance?.current;Qe&&!Qe.cursor._lock&&Qe.setCursor({left:-10,top:-10})}}))}componentDidUpdate(Ne){const{frames:Qe,structureRev:st,timeZone:ot,propsToDiff:it}=this.props,Ot=!Uu(Ne,this.props,it);if(Qe!==Ne.frames||Ot||ot!==Ne.timeZone){let Tt=this.prepState(this.props,!1);Tt&&((this.state.config===void 0||ot!==Ne.timeZone||st!==Ne.structureRev||!st||Ot)&&(Tt.config=this.props.prepConfig(Tt.alignedFrame,this.props.frames,this.getTimeRange),(0,_r.uY)("GraphNG",!1,"config recreated",Tt.config)),Tt.alignedData=Tt.config.prepData([Tt.alignedFrame]),this.setState(Tt))}}componentWillUnmount(){this.subscription.unsubscribe()}render(){const{width:Ne,height:Qe,children:st,renderLegend:ot}=this.props,{config:it,alignedFrame:Ot,alignedData:Tt}=this.state;return it?(0,yt.jsx)($d.KU,{width:Ne,height:Qe,legend:ot(it),children:(Nt,wt)=>(0,yt.jsx)(bu.Z,{config:it,data:Tt,width:Nt,height:wt,plotRef:Ht=>this.plotInstance.current=Ht,children:st?st(it,Ot):null})}):null}}var Wu=e(36613),op=e(66650);const Yg=new Set(["bytes","bits","kbytes","mbytes","gbytes","tbytes","pbytes","binBps","binbps","KiBs","Kibits","MiBs","Mibits","GiBs","Gibits","TiBs","Tibits","PiBs","Pibits"]),nr=Array(53);for(let be=0;be<nr.length;be++)nr[be]=2**be;const Nu=(be,Ne=1)=>be==null?"-":be.toFixed(Ne),Ku={drawStyle:Pt.GR.Line,showPoints:Pt.yL.Auto,axisPlacement:Pt.vM.Auto},ip=({frame:be,theme:Ne,timeZones:Qe,getTimeRange:st,sync:ot,allFrames:it,renderers:Ot,tweakScale:Tt=wt=>wt,tweakAxis:Nt=wt=>wt})=>{const wt="__global_",Ht=new cd.e(Qe[0]);let rn;Ht.setPrepData(On=>(rn=On[0],(0,_r.bq)(On[0],Ht.getStackingGroups())));const sn=be.fields[0];if(!sn)return Ht;const pn="x";let Vn="";const va=sn.config.custom?.axisPlacement!==Pt.vM.Hidden?Pt.vM.Bottom:Pt.vM.Hidden,Qn=sn.config.custom?.axisPlacement!==Pt.vM.Hidden;if(sn.type===ls.PU.time){Ht.addScale({scaleKey:pn,orientation:Pt.Lt.Horizontal,direction:Pt.ON.Right,isTime:!0,range:()=>{const dn=st();return[dn.from.valueOf(),dn.to.valueOf()]}});const On=Qe.length>1?(dn,ra)=>ra.map((Tn,da)=>da<2?null:Tn):void 0;for(let dn=0;dn<Qe.length;dn++){const ra=Qe[dn];Ht.addAxis({scaleKey:pn,isTime:!0,placement:va,show:Qn,label:sn.config.custom?.axisLabel,timeZone:ra,theme:Ne,grid:{show:dn===0&&sn.config.custom?.axisGridShow},filter:On})}Qe.length>1&&Ht.addHook("drawAxes",dn=>{dn.ctx.save(),dn.ctx.fillStyle=Ne.colors.text.primary,dn.ctx.textAlign="left",dn.ctx.textBaseline="bottom";let ra=0;dn.axes.forEach(Tn=>{if(Tn.side===2){let da=Tn._pos+Tn._size;dn.ctx.fillText(Qe[ra],dn.bbox.left,da*Wu.A.pxRatio),ra++}}),dn.ctx.restore()})}else Ht.addScale({scaleKey:pn,orientation:Pt.Lt.Horizontal,direction:Pt.ON.Right,range:(On,dn,ra)=>[sn.config.min??dn,sn.config.max??ra]}),Ht.addAxis({scaleKey:pn,placement:va,show:Qn,label:sn.config.custom?.axisLabel,theme:Ne,grid:{show:sn.config.custom?.axisGridShow},formatValue:(On,dn)=>(0,Ka.cN)(sn.display(On,dn))});let ss=Ot?.flatMap(On=>Object.values(On.fieldMap).filter(dn=>On.indicesOnly.indexOf(dn)===-1))??[],Ga;for(let On=1;On<be.fields.length;On++){const dn=be.fields[On],ra={...dn.config,custom:{...Ku,...dn.config.custom}},Tn=ra.custom;if(dn===sn||dn.type!==ls.PU.number&&dn.type!==ls.PU.enum)continue;let da=dn.display??Nu;dn.config.custom?.stacking?.mode===Pt.gs.Percent&&(da=(0,Ut.J)({field:{...dn,config:{...dn.config,unit:"percentunit"}},theme:Ne}));const ua=sp(ra,dn.type),ga=(0,cn.Qi)(dn),Oa=(0,cn.lz)(dn,Ne).color;if(Ht.addScale(Tt({scaleKey:ua,orientation:Pt.Lt.Vertical,direction:Pt.ON.Up,distribution:Tn.scaleDistribution?.type,log:Tn.scaleDistribution?.log,linearThreshold:Tn.scaleDistribution?.linearThreshold,min:dn.config.min,max:dn.config.max,softMin:Tn.axisSoftMin,softMax:Tn.axisSoftMax,centeredZero:Tn.axisCenteredZero,range:Tn.stacking?.mode===Pt.gs.Percent?(Qa,Ls,Ms)=>(Ls=Ls<0?-1:0,Ms=Ms>0?1:0,[Ls,Ms]):dn.type===ls.PU.enum?(Qa,Ls,Ms)=>[-1,dn.config.type.enum.text.length]:void 0,decimals:dn.config.decimals},dn)),Vn||(Vn=ua),Tn.axisPlacement!==Pt.vM.Hidden){let Qa;Tn.axisColorMode===Pt.Y$.Series&&(ga.isByValue&&dn.config.custom?.gradientMode===Pt.on.Scheme&&ga.id===cr.Y.Thresholds?Qa=(0,op.pl)(1,Ne,ga,dn.config.thresholds):Qa=Oa);const Ls={border:{show:Tn.axisBorderShow||!1,width:1/devicePixelRatio,stroke:Qa||Ne.colors.text.primary},ticks:{show:Tn.axisBorderShow||!1,stroke:Qa||Ne.colors.text.primary},color:Qa||Ne.colors.text.primary};let Ms,Xa,bs;if(Yg.has(ra.unit))Ms=nr;else if(dn.type===ls.PU.enum){let us=dn.config.type.enum.text;bs=us.map((Bs,Za)=>Za),Xa=us}Ht.addAxis(Nt({scaleKey:ua,label:Tn.axisLabel,size:Tn.axisWidth,placement:Tn.axisPlacement??Pt.vM.Auto,formatValue:(us,Bs)=>(0,Ka.cN)(da(us,Bs)),theme:Ne,grid:{show:Tn.axisGridShow},decimals:dn.config.decimals,distr:Tn.scaleDistribution?.type,splits:bs,values:Xa,incrs:Ms,...Ls},dn))}const Va=Tn.drawStyle===Pt.GR.Points?Pt.yL.Always:Tn.showPoints;let vs=()=>null;Tn.spanNulls!==!0&&(vs=(Qa,Ls,Ms,Xa)=>{let bs=[],us=Qa.series[Ls];if(!Ms&&Xa&&Xa.length){const[Bs,Za]=us.idxs,Or=Qa.data[0],Qr=Qa.data[Ls],Wi=Math.round(Qa.valToPos(Or[Bs],"x",!0)),ya=Math.round(Qa.valToPos(Or[Za],"x",!0));Xa[0][0]===Wi&&bs.push(Bs);for(let wa=0;wa<Xa.length;wa++){let Us=Xa[wa],Ws=Xa[wa+1];if(Ws&&Us[1]===Ws[0]){let ar=Qa.posToIdx(Us[1],!0);if(Qr[ar]==null)for(let sr=1;sr<100;sr++){if(Qr[ar+sr]!=null){ar+=sr;break}if(Qr[ar-sr]!=null){ar-=sr;break}}bs.push(ar)}}Xa[Xa.length-1][1]===ya&&bs.push(Za)}return bs.length?bs:null});let{fillOpacity:rs}=Tn,js=null,os=null;if(dn.state?.origin){Ga||(Ga=wu(be,it));const Qa=it[dn.state.origin.frameIndex],Ls=Qa?.fields[dn.state.origin.fieldIndex],Ms=(0,gt.Ct)(Ls??dn,Qa,it);if(ss.indexOf(Ms)>=0)js=()=>null,os=()=>{};else if(Tn.transform===Pt.NU.Constant){const Xa=Wu.A.paths.linear();js=(bs,us)=>{const Bs=bs._data,Za=st();let Or=[Za.from.valueOf(),Za.to.valueOf()],Qr=Bs[us].find(wa=>wa!=null),Wi=[Qr,Qr],ya=Bs.slice();return ya[0]=Or,ya[us]=Wi,Xa({...bs,_data:ya},us,0,1)}}if(Tn.fillBelowTo){const Xa=be.fields.find(Za=>Tn.fillBelowTo===Za.name||Tn.fillBelowTo===Za.config?.displayNameFromDS||Tn.fillBelowTo===(0,gt.Ct)(Za,be,it)),bs=Xa?(0,gt.Ct)(Xa,be,it):Tn.fillBelowTo,us=Ga.get(Ms),Bs=Ga.get(bs);(0,Wa.isNumber)(Bs)&&(0,Wa.isNumber)(us)?(Ht.addBand({series:[us,Bs],fill:void 0}),rs||(rs=35)):rs=0}}let Ui;ga.id===cr.Y.Thresholds&&(Ui=Qa=>(0,cn.lz)(rn.fields[Qa],Ne).color),Ht.addSeries({pathBuilder:js,pointsBuilder:os,scaleKey:ua,showPoints:Va,pointsFilter:vs,colorMode:ga,fillOpacity:rs,theme:Ne,dynamicSeriesColor:Ui,drawStyle:Tn.drawStyle,lineColor:Tn.lineColor??Oa,lineWidth:Tn.lineWidth,lineInterpolation:Tn.lineInterpolation,lineStyle:Tn.lineStyle,barAlignment:Tn.barAlignment,barWidthFactor:Tn.barWidthFactor,barMaxWidth:Tn.barMaxWidth,pointSize:Tn.pointSize,spanNulls:Tn.spanNulls||!1,show:!Tn.hideFrom?.viz,gradientMode:Tn.gradientMode,thresholds:ra.thresholds,hardMin:dn.config.min,hardMax:dn.config.max,softMin:Tn.axisSoftMin,softMax:Tn.axisSoftMax,dataFrameFieldIndex:dn.state?.origin}),Tn.thresholdsStyle&&ra.thresholds&&(Tn.thresholdsStyle.mode??Pt.Ly.Off)!==Pt.Ly.Off&&Ht.addThresholds({config:Tn.thresholdsStyle,thresholds:ra.thresholds,scaleKey:ua,theme:Ne,hardMin:dn.config.min,hardMax:dn.config.max,softMin:Tn.axisSoftMin,softMax:Tn.axisSoftMax})}let Ha=(0,_r.ro)(be);Ht.setStackingGroups(Ha),Ot?.forEach(On=>{Ga||(Ga=wu(be,it));let dn={};for(let ra in On.fieldMap){let Tn=On.fieldMap[ra];dn[ra]=Ga.get(Tn)}On.init(Ht,dn)}),Ht.scaleKeys=[pn,Vn];const Na=15;let Ps={dataIdx:(On,dn,ra,Tn)=>{let da=On.data[dn];if(da[ra]==null){let ua=null,ga=null,ha;for(ha=ra;ua==null&&ha-- >0;)da[ha]!=null&&(ua=ha);for(ha=ra;ga==null&&ha++<da.length;)da[ha]!=null&&(ga=ha);let Oa=On.data[0],Va=On.valToPos(Tn,"x"),vs=ga==null?1/0:On.valToPos(Oa[ga],"x"),rs=ua==null?-1/0:On.valToPos(Oa[ua],"x"),js=Va-rs,os=vs-Va;js<=os?js<=Na&&(ra=ua):os<=Na&&(ra=ga)}return ra}};return ot&&ot()!==Er.y.Off&&(Ps.sync={key:wt,scales:[pn,null]}),Ht.setCursor(Ps),Ht};function wu(be,Ne){const Qe=new Map;return be.fields.forEach((st,ot)=>{const it=st.state?.origin;if(it){const Ot=Ne[it.frameIndex]?.fields[it.fieldIndex];Ot&&Qe.set((0,gt.Ct)(Ot,Ne[it.frameIndex],Ne),ot)}}),Qe}const Mi=["legend","options","theme"];class lp extends Vt.Component{constructor(){super(...arguments),this.prepConfig=(Ne,Qe,st)=>{const{sync:ot}=this.context,{theme:it,timeZone:Ot,renderers:Tt,tweakAxis:Nt,tweakScale:wt}=this.props;return ip({frame:Ne,theme:it,timeZones:Array.isArray(Ot)?Ot:[Ot],getTimeRange:st,sync:ot,allFrames:Qe,renderers:Tt,tweakScale:wt,tweakAxis:Nt})},this.renderLegend=Ne=>{const{legend:Qe,frames:st}=this.props;return!Ne||Qe&&!Qe.showLegend||!(0,dd.t)(Ne,st)?null:(0,yt.jsx)(dd.$,{data:st,config:Ne,...Qe})}}static{this.contextType=Vr.e4}render(){return(0,yt.jsx)(rp,{...this.props,prepConfig:this.prepConfig,propsToDiff:Mi,renderLegend:this.renderLegend})}}const Fu=(0,na.cV)(lp);Fu.displayName="TimeSeries";const cp=(0,Vt.createContext)({}),dp=()=>{const{data:be,dimFields:Ne,mapSeriesIndexToDataFrameFieldIndex:Qe}=(0,Vt.useContext)(cp),st=(0,Vt.useCallback)(()=>{const ot=Ne.x;let it=null;for(let Ot=0;Ot<be.fields.length;Ot++)if(ot(be.fields[Ot],be,[be])){it=be.fields[Ot];break}return it},[be,Ne]);return{dimFields:Ne,mapSeriesIndexToDataFrameFieldIndex:Qe,getXAxisField:st,alignedData:be}},Vu=5,ql=be=>be!=null&&!be.ctrlKey&&!be.metaKey,vd=({onZoom:be,config:Ne,withZoomY:Qe=!1})=>((0,Vt.useLayoutEffect)(()=>{let st=!1,ot=!1;Qe&&Ne.addHook("init",it=>{it.over.addEventListener("mousedown",Ot=>{if(ql(Ot)&&Ot.button===0&&Ot.shiftKey){ot=!0,it.cursor.drag.x=!1,it.cursor.drag.y=!0;let Tt=Nt=>{it.cursor.drag.x=!0,it.cursor.drag.y=!1,document.removeEventListener("mouseup",Tt,!0)};document.addEventListener("mouseup",Tt,!0)}},!0)}),Ne.addHook("setSelect",it=>{const Ot=it.scales.x.ori===0;if(ql(it.cursor.event)){if(Qe&&ot){if(it.select.height>=Vu){for(let Tt in it.scales)if(Tt!=="x"){const Nt=Ot?it.posToVal(it.select.top,Tt):it.posToVal(it.select.left+it.select.width,Tt),wt=Ot?it.posToVal(it.select.top+it.select.height,Tt):it.posToVal(it.select.left,Tt);it.setScale(Tt,{min:wt,max:Nt})}st=!0}ot=!1}else if(it.select.width>=Vu){const Tt=Ot?it.posToVal(it.select.left,"x"):it.posToVal(it.select.top+it.select.height,"x"),Nt=Ot?it.posToVal(it.select.left+it.select.width,"x"):it.posToVal(it.select.top,"x");be({from:Tt,to:Nt}),st=!1}}it.setSelect({left:0,width:0,top:0,height:0},!1)}),Ne.setCursor({bind:{dblclick:it=>()=>{if(!ql(it.cursor.event))return null;if(Qe&&st){for(let Ot in it.scales)Ot!=="x"&&it.setScale(Ot,{min:null,max:null});st=!1}else{let Ot=it.scales.x;const Tt=Ot.min,Nt=Ot.max,wt=(Nt-Tt)/2;be({from:Tt-wt,to:Nt+wt})}return null}}})},[Ne,be,Qe]),null);var up=e(1604);const $u=10,hp=({mode:be=Pt.$N.Single,sortOrder:Ne=Pt.xB.None,sync:Qe,timeZone:st,config:ot,renderTooltip:it,...Ot})=>{const Tt=(0,Vt.useRef)(),Nt=(0,na.$j)(),[wt,Ht]=(0,Vt.useState)(null),[rn,sn]=(0,Vt.useState)(null),[pn,Vn]=(0,Vt.useState)([]),[va,Qn]=(0,Vt.useState)(null),[ss,Ga]=(0,Vt.useState)(!1),Ha=(0,up.A)();let Na=null;const Ps=(0,na.of)(gp);if((0,Vt.useLayoutEffect)(()=>{let da;const ua=()=>{Ha()&&(Ga(!0),Tt.current?.root.classList.add("plot-active"))},ga=()=>{Ha()&&(Qn(null),Ga(!1),Tt.current?.root.classList.remove("plot-active"))};return ot.addHook("syncRect",(ha,Oa)=>da=Oa),ot.addHook("init",ha=>{Tt.current=ha,ha.over.addEventListener("mouseenter",ua),ha.over.addEventListener("mouseleave",ga),Na=ha.root.closest("[tabindex]"),Na&&(Na.addEventListener("focus",ua),Na.addEventListener("blur",ga)),Qe&&Qe()===Er.y.Crosshair&&ha.root.classList.add("shared-crosshair")}),ot.addHook("setLegend",ha=>{Ha()&&(sn(ha.legend.idx),Vn(ha.legend.idxs.slice()))}),ot.addHook("setCursor",ha=>{if(!da||!Ha())return;const{x:Oa,y:Va}=pp(ha,da);Qn(Oa!==void 0&&Va!==void 0?{x:Oa,y:Va}:null)}),ot.addHook("setSeries",(ha,Oa)=>{Ha()&&Ht(Oa)}),()=>{Qn(null),Tt.current&&(Tt.current.over.removeEventListener("mouseleave",ga),Tt.current.over.removeEventListener("mouseenter",ua),Na&&(Na.removeEventListener("focus",ua),Na.removeEventListener("blur",ga)))}},[ot,Qn,Ga,sn,Vn]),rn===null||!ss&&Qe&&Qe()===Er.y.Crosshair)return null;let On=Ot.data.fields[0];if(!On)return null;const dn=On.display||(0,Ut.J)({field:On,timeZone:st,theme:Nt});let ra=null,Tn=dn(On.values[rn]).text;if(it)ra=it(Ot.data,wt,rn);else{if(be===Pt.$N.Single&&wt!==null){const da=Ot.data.fields[wt];if(!da)return null;const ua=pn?.[wt]??rn;Tn=dn(On.values[ua]).text;const ha=(da.display||(0,Ut.J)({field:da,timeZone:st,theme:Nt}))(da.values[ua]);ra=(0,yt.jsx)(xs.o,{series:[{color:ha.color||cr.F,label:(0,gt.Ct)(da,Ot.data,Ot.frames),value:ha?(0,Ka.cN)(ha):null}],timestamp:Tn})}if(be===Pt.$N.Multi){let da=[];const ua=Ot.data,ga=ua.fields,ha=[];for(let Oa=0;Oa<ga.length;Oa++){const Va=ua.fields[Oa];if(!Va||Va===On||Va.type===ls.PU.time||Va.type!==ls.PU.number||Va.config.custom?.hideFrom?.tooltip||Va.config.custom?.hideFrom?.viz)continue;const vs=Ot.data.fields[Oa].values[pn[Oa]],rs=Va.display(vs);ha.push(vs),da.push({color:rs.color||cr.F,label:(0,gt.Ct)(Va,ua,Ot.frames),value:rs?(0,Ka.cN)(rs):null,isActive:wt===Oa})}if(Ne!==Pt.xB.None){const Oa=[...da],Va=Hn.sortValues(Ne);da.sort((vs,rs)=>{const js=Oa.indexOf(vs),os=Oa.indexOf(rs);return Va(ha[js],ha[os])})}ra=(0,yt.jsx)(xs.o,{series:da,timestamp:Tn})}}return(0,yt.jsx)(_s.ZL,{className:ss?Ps.tooltipWrapper:void 0,children:ra&&va&&(0,yt.jsx)(tr.o,{position:{x:va.x,y:va.y},offset:{x:$u,y:$u},children:ra})})};function fp({left:be,top:Ne},Qe){return be===void 0||Ne===void 0?!1:be<0||be>Qe.width||Ne<0||Ne>Qe.height}function pp(be,Ne){let Qe,st;const ot=be.cursor.left||0,it=be.cursor.top||0;if(fp(be.cursor,Ne)){const Ot=be.posToIdx(ot);if(it<0||it>Ne.height){let Tt=(0,_r.sw)(be,Ot);Tt&&(st=Ne.top+Tt,ot>=0&&ot<=Ne.width&&(Qe=Ne.left+be.valToPos(be.data[0][be.posToIdx(ot)],be.series[0].scale)))}}else Qe=Ne.left+ot,st=Ne.top+it;return{x:Qe,y:st}}const gp=be=>({tooltipWrapper:(0,Mn.css)({"z-index":be.zIndex.portal+1+" !important"})});var zu=e(56887),mp=e(53926),wo=e(97958),Hs=e(8255),Fo=e(75745),ec=e(35458),vp=e(75254),yd=e(48542);let Si=null;function yp(){if(Si!==null)return Si;if(typeof document<"u"){const be=document.createElement("div"),Ne={width:"100px",height:"100px",position:"absolute",top:"-9999px",overflow:"scroll",MsOverflowStyle:"scrollbar"};Object.keys(Ne).map(Qe=>{be.style[Qe]=Ne[Qe]}),document.body.appendChild(be),Si=be.offsetWidth-be.clientWidth,document.body.removeChild(be)}else Si=0;return Si||0}var xp=e(86059),_u=e(36324),Ep=e(79104),Pp=e(59258),Gu=e(60379),Hu=e(20720),xd=(be=>(be.id="id",be.title="title",be.subTitle="subTitle",be.mainStat="mainStat",be.secondaryStat="secondaryStat",be.source="source",be.target="target",be.detail="detail__",be.arc="arc__",be.color="color",be))(xd||{}),bp=e(63267);function Dp(be,Ne,Qe,st){if(be>Ne){const ot=`[Combobox] Items exceed the recommended amount ${Ne}.`;console.warn(ot,{itemsCount:""+be,recommendedAmount:""+Ne,"aria-labelledby":st??"",id:Qe??""})}}let tc;const Cp=(be="dark")=>tc?tc(be):(0,Ys.a)({colors:{mode:be}}).v1,Tp=be=>(tc=be,()=>{tc=null});var Qu=e(77345),ku=e(24726);const Gr={"[":"]","{":"}","(":")"},Ed="brace_match";function Mp(){return{onKeyDown(be,Ne,Qe){const{value:st}=Ne;switch(be.key){case"(":case"{":case"[":{const{start:{offset:ot,key:it},end:{offset:Ot,key:Tt},focus:{offset:Nt}}=st.selection,wt=st.focusText.text;if(st.selection.isExpanded)return be.preventDefault(),Ne.insertTextByKey(it,ot,be.key).insertTextByKey(Tt,Ot+1,Gr[be.key]).moveEndBackward(1),!0;if(Nt===wt.length||wt[Nt]===" "||Object.values(Gr).includes(wt[Nt])){be.preventDefault();const Ht=Gr[be.key],rn={key:`${Ed}-${(0,ku.A)()}`,type:`${Ed}-${Ht}`,anchor:{key:it,offset:ot,object:"point"},focus:{key:Tt,offset:Ot+1,object:"point"},object:"annotation"};return Ne.insertText(be.key).insertText(Ht).addAnnotation(rn).moveBackward(1),!0}break}case")":case"}":case"]":{const ot=st.anchorText.text,it=st.selection.anchor.offset,Ot=ot[it],Tt=be.key,Nt=`${Ed}-${Tt}`,wt=st.annotations.find(Ht=>Ht?.type===Nt&&Ht.anchor.key===st.anchorText.key);if(wt&&Ot===Tt&&!st.selection.isExpanded)return be.preventDefault(),Ne.moveFocusForward(1).removeAnnotation(wt).moveAnchorForward(1),!0;break}case"Backspace":{const ot=st.anchorText.text,it=st.selection.anchor.offset,Ot=ot[it-1],Tt=ot[it];if(Gr[Ot]&&Gr[Ot]===Tt)return be.preventDefault(),Ne.deleteBackward(1).deleteForward(1).focus(),!0}default:break}return Qe()}}}var Sp=e(16123),Op=e(54024),nc=e(52513),Yu=e(21266),Ip=e(59490),Rp=e(91272),Ap=e(56103),jp=e(93427);const Ju={SecretFormField:Wr.L,FormField:hl.z,Select:di,AsyncSelect:Rc,IndicatorsContainer:pl,NoOptionsMessage:ml,Input:fl.p,Switch:Ac};var Lp=e(873),ac=e(65642),Oi=e(73427),Xu=e(83873),Zu=e(67020),qu=e(58047),Bp=e(49344);function ho(be,Ne){Ne=Ne||{};const Qe=Ne.delimiter||".";let st=Ne.maxDepth||3,ot=1;const it={};function Ot(Tt,Nt){Object.entries(Tt).forEach(([wt,Ht])=>{const rn=Ne?.safe&&Array.isArray(Ht),pn=Object.prototype.toString.call(Ht)==="[object Object]",Vn=Nt?Nt+Qe+wt:wt;if(Ne?.maxDepth||(st=ot+1),!rn&&pn&&Object.keys(Ht).length&&ot<st)return++ot,Ot(Ht,Vn);it[Vn]=Ht})}return Ot(be,null),it}var Pd=e(77197);function Up(be,Ne,Qe){const st=Math.sqrt(50),ot=Math.sqrt(10),it=Math.sqrt(2),Ot=Math.abs(Ne-be)/Math.max(0,Qe);let Tt=Math.pow(10,Math.floor(Math.log(Ot)/Math.LN10));const Nt=Ot/Tt;return Nt>=st?Tt*=10:Nt>=ot?Tt*=5:Nt>=it&&(Tt*=2),Ne<be?-Tt:Tt}function Wp(be,Ne){return be-Math.floor(Math.log(Ne)/Math.LN10)}function Np(be,Ne,Qe){if(Ne&&Qe&&be){const st=Qe-Ne,ot=st/be/1e3,it=864e5,Ot=31536e6;return ot<=45?"HH:mm:ss":ot<=7200||st<=it?"HH:mm":ot<=8e4?"MM/DD HH:mm":ot<=2419200||st<=Ot?"MM/DD":"YYYY-MM"}return"HH:mm"}function Kp(be,Ne){return Math.log(be)/Math.log(Ne)}function Vo(be){const Ne=be.toString();return $a(Ne)}function $a(be){if(isNaN(be))return 0;const Ne=be.indexOf(".");return Ne===-1?0:be.length-Ne-1}const Ii=r;Ii.PanelPlugin=Xe.m,Ii.DataSourcePlugin=f.tD,Ii.AppPlugin=p.hX,Ii.DataSourceApi=f.mA;const eh=["jquery.flot.crosshair","jquery.flot.events","jquery.flot.fillbelow","jquery.flot.gauge","jquery.flot.pie","jquery.flot.selection","jquery.flot.stack","jquery.flot.stackpercent","jquery.flot.time","jquery.flot"].reduce((be,Ne)=>({...be,[Ne]:{fakeDep:1}}),{}),wp={"@emotion/css":()=>Promise.resolve().then(e.bind(e,22803)),"@emotion/react":()=>Promise.resolve().then(e.bind(e,17437)),"@grafana/data":n,"@grafana/data/unstable":()=>e.e(2223).then(e.bind(e,2223)),"@grafana/runtime":a,"@grafana/runtime/unstable":()=>e.e(3259).then(e.bind(e,83259)),"@grafana/slate-react":()=>Promise.resolve().then(e.bind(e,29317)),"@grafana/ui":Ii,"@grafana/ui/unstable":()=>Promise.all([e.e(9227),e.e(1492)]).then(e.bind(e,58045)),"@kusto/monaco-kusto":()=>Promise.all([e.e(630),e.e(7396),e.e(4350)]).then(e.bind(e,20582)),"app/core/app_events":{default:Oi.lE,__useDefault:!0},"app/core/config":{default:ac.Ay,__useDefault:!0},"app/core/core":{appEvents:Oi.lE,contextSrv:Oi.TP},"app/core/services/backend_srv":{BackendSrv:Xu.Mf,getBackendSrv:Xu.AI},"app/core/table_model":{default:Lp.A,__useDefault:!0},"app/core/time_series":{default:qu.A,__useDefault:!0},"app/core/time_series2":{default:qu.A,__useDefault:!0},"app/core/utils/datemath":zi,"app/core/utils/flatten":u,"app/core/utils/kbn":{default:Pd.A,__useDefault:!0},"app/core/utils/ticks":o,"app/features/dashboard/impression_store":{impressions:Zu.A},d3:()=>Promise.all([e.e(407),e.e(5995)]).then(e.bind(e,55995)),emotion:()=>Promise.resolve().then(e.bind(e,22803)),i18next:()=>e.e(5757).then(e.bind(e,55757)).then(be=>be.getI18nInstance()),jquery:{default:He(),__useDefault:!0},...eh,lodash:()=>Promise.resolve().then(e.t.bind(e,2543,23)).then(be=>({...be,move:Bp.b,__useDefault:!0})),moment:()=>Promise.resolve().then(e.t.bind(e,95093,23)).then(be=>({...be,__useDefault:!0})),prismjs:()=>Promise.resolve().then(e.t.bind(e,28848,23)),react:()=>Promise.resolve().then(e.t.bind(e,96540,19)),"react-dom":()=>Promise.resolve().then(e.t.bind(e,40961,19)),"react-inlinesvg":()=>Promise.resolve().then(e.bind(e,55494)),"react-redux":()=>Promise.resolve().then(e.bind(e,71468)),"react-router-dom":()=>Promise.resolve().then(e.bind(e,61417)),"react-router":()=>Promise.resolve().then(e.bind(e,35557)),redux:()=>Promise.resolve().then(e.bind(e,14644)),rxjs:()=>Promise.all([e.e(4251),e.e(5091)]).then(e.bind(e,75091)),"rxjs/operators":()=>Promise.all([e.e(4251),e.e(2975)]).then(e.bind(e,32975)),slate:()=>Promise.resolve().then(e.bind(e,82611)),"slate-plain-serializer":()=>Promise.resolve().then(e.bind(e,52845)),"slate-react":()=>Promise.resolve().then(e.bind(e,29317))};function Ri({url:be,source:Ne,transformSourceMapURL:Qe=!1,transformAssets:st=!0}){const ot=be.split("/public/plugins/"),it=ot[0],Ot=ot[1].split("/")[0];let Tt=Ne;return st&&(Tt=Tt.replace(/(\/?)(public\/plugins)/g,`${it}/$2`),Tt=Tt.replace(/(["|'])(plugins\/.+?.css)(["|'])/g,`$1${it}/public/$2$3`)),Qe&&(Tt=Tt.replace(/(\/\/#\ssourceMappingURL=)(.+)\.map/g,`$1${it}/public/plugins/${Ot}/$2.map`)),Tt}var sc=e(98060);const th=new Map([]);function nh(be){return Object.keys(be).reduce((Ne,Qe)=>{const st=`${sc.XV}:${Qe}`;return Fp(st,be[Qe]),th.set(Qe,be[Qe]),Ne[Qe]=st,Ne},{})}function Fp(be,Ne){if(Te.has(be))return;let Qe;try{Qe=Te.resolve(be)}catch(ot){console.log(ot)}if(Qe&&Te.has(Qe))return;const st=Qe||be;typeof Ne=="function"?Te.register(be,[],ot=>({execute:async function(){const it=await Ne();ot(it)}})):Te.set(st,Ne)}function Ai(be){return!!v.$.pluginsCDNBaseURL&&be.startsWith(v.$.pluginsCDNBaseURL)}function bd(be){return be.startsWith("http")||be.startsWith("/")?be:`${v.$.appSubUrl??""}/${be}`}async function Dd(be,Ne,Qe){const st=await be(Ne,Qe),ot=st.headers.get("content-type")||"";if(sc.Bu.test(ot)){let Ot=await st.text();if(Ai(st.url)){const Tt=Ri({url:st.url,source:Ot});return new Response(new Blob([Tt],{type:"text/javascript"}))}return new Response(new Blob([Ot],{type:"text/javascript"}))}return st}function ah(be,Ne,Qe){try{const st=be.apply(this,[Ne,Qe]),ot=Vp(st);return(ot.endsWith(".js")||ot.endsWith(".css"))&&!Ai(ot)?(0,Ee.ni)(ot):ot}catch{if(sc.$b.test(Ne)){const ot=Cd(Ne),it=be.apply(this,[ot,Qe]);return(0,Ee.ni)(it)}return console.warn(`SystemJS: failed to resolve '${Ne}'`),Ne}}function ji(be,Ne){if(new URL(Ne,window.location.origin).pathname.endsWith(".css")&&!be){const ot=Te.get(Ne)?.default;ot&&(document.adoptedStyleSheets=[...document.adoptedStyleSheets,ot])}}function Vp(be){return be.startsWith(`${sc.XV}:`)?be:(be.endsWith("!")&&(be=be.slice(0,-1)),["css","js","json","wasm"].some(st=>be.endsWith(st))?be:be+".js")}function Cd(be){const Ne=be.split("/")[1];let Qe="";for(const[it]of Te.entries())if(it.includes(Ne)){Qe=it;break}const st=Qe.lastIndexOf("/plugins");return st===-1?`${v.$.appSubUrl??""}/public/${be}`:`${Qe.substring(0,st)}/${be}`}var Td=e(44436),$p=e(48307);function sh(be){const Ne=new URL(window.location.href),Qe=new URL(be);return Ne.host===Qe.host}async function zp(be,Ne){let Qe="";if(sh(be)?(Qe=await(await fetch(be)).text(),Qe=Ri({url:be,source:Qe,transformSourceMapURL:!0,transformAssets:!1})):Ai(be)&&(Qe=await(await fetch(be)).text(),Qe=Ri({url:be,source:Qe,transformSourceMapURL:!0,transformAssets:!0})),Qe.length===0)throw new Error("Only same domain scripts are allowed in sandboxed plugins");Qe=Mr(Qe),Ne.evaluate(Qe)}async function rh(be){if(Ai(be.module)){const Ne=be.module;let st=await(await fetch(Ne)).text();if(!oh(st,be.moduleHash))throw new Error("Invalid SRI for plugin module file");return st=Ri({url:Ne,source:st,transformSourceMapURL:!0,transformAssets:!0}),st}else{let Ne=bd(be.module);const Qe=(0,Ee.ni)(Ne);let ot=await(await fetch(Qe)).text();if(!oh(ot,be.moduleHash))throw new Error("Invalid SRI for plugin module file");return ot=Ri({url:Qe,source:ot,transformSourceMapURL:!0,transformAssets:!1}),ot=Mr(ot),ot}}async function oh(be,Ne){if(!v.$.featureToggles.pluginsSriChecks||!Ne||Ne.length===0)return!0;const[Qe,st]=Ne.split("-"),ot=Qe.replace("sha","SHA-"),Ot=new TextEncoder().encode(be),Tt=await crypto.subtle.digest(ot,Ot),Nt=btoa(String.fromCharCode(...new Uint8Array(Tt)));return`${Qe}-${Nt}`===Ne}function Mr(be){return be.replace(/window\.location/gi,"window.locationSandbox")}function _p(be){be.evaluate(`${Po.toString()};${Po.name}()`)}function Md(be){for(const Ne of Object.values(v.$.datasources))if(Ne.type===be)return Ne.meta;for(const Ne of Object.values(v.$.panels))if(Ne.id===be)return Ne;for(const Ne of Object.values(v.$.apps))if(Ne.id===be)return{id:be,type:l.QE.app,module:Ne.path,moduleHash:Ne.moduleHash};throw new Error(`Could not find plugin ${be}`)}var ih=e(99418);const Hr=["iframe"];var Sd=e(7077),Gp=e(28848),Hp=e.n(Gp);function Qp(be){return!!be&&typeof be=="object"&&be?.hasOwnProperty("plugin")}function $o(be){throw new Error(`Unexpected object: ${be}. This should never happen.`)}const Od=(0,ws.DW)("sandbox");function kp(be){return be instanceof Vt.Component}function Ts(be,Ne){Od.logWarning(be,Ne)}function Li(be,Ne){Od.logError(be,Ne)}function lh(be,Ne){Od.logInfo(be,Ne)}function Id(be){return be?.constructor?.name==="RegExp"}function as(be){return be&&(Id(be)&&(0,Sd.U)(be)?new RegExp(be):Array.isArray(be)?be.map(as):typeof be=="object"?Object.keys(be).reduce((Ne,Qe)=>(Reflect.set(Ne,Qe,as(Reflect.get(be,Qe))),Ne),{}):be)}function Rd(be){return be&&((0,Sd.U)(be)?(0,Wa.cloneDeep)(be):Array.isArray(be)?be.map(Rd):typeof be=="object"?Object.keys(be).reduce((Ne,Qe)=>(Reflect.set(Ne,Qe,Rd(Reflect.get(be,Qe))),Ne),{}):be)}const Qs=Symbol.for("@@SANDBOX_LIVE_VALUE");function Yp(be,Ne){const Qe=Reflect.get(be,"nodeName");if(Qe==="body"||be===document.body)return document.body;if(Qe==="head"||be===document.head||be===document.documentElement)return be;if(Hr.includes(Qe))throw Ts("<"+Qe+"> is not allowed in sandboxed plugins",{pluginId:Ne,param:Qe}),new Error("<"+Qe+"> is not allowed in sandboxed plugins");if(Zp(be,Ne)||be.parentNode===document.body||be.closest("#reactRoot")===null)return be;const st=document.createElement(Qe);return st.dataset.grafanaPluginSandboxElement="true",st}function ch(be){if(typeof be=="object"&&be instanceof Element)try{return be.nodeName!==void 0}catch{return!1}return!1}function Jp(be){const Ne=Reflect.get(be,"style");Object.hasOwn(Ne,Qs)||Reflect.defineProperty(Ne,Qs,{})}function Ad(be){be&&(Array.isArray(be)?(be.forEach(Ad),dh(be)):typeof be=="object"&&(Object.values(be).forEach(Ad),dh(be)))}function dh(be){if(be)return Object.hasOwn(be,Qs)||Reflect.defineProperty(be,Qs,{}),be}function Xp(be){be&&(Object.hasOwn(be,Qs)||((0,Sd.U)(be)&&!(be instanceof Function)&&(kp(be)||be instanceof f.mA||be instanceof ir.f5)?Reflect.defineProperty(be,Qs,{}):be===Hp().languages&&Object.defineProperty(be,Qs,{})))}function uh(be){return Object.hasOwn(be,Qs)}function Zp(be,Ne){return!document.contains(be)||be.closest(`[data-plugin-sandbox=${Ne}]`)!==null}let ks;function qp(){return ks||(ks=document.createElement("div"),ks.setAttribute("id","grafana-plugin-sandbox-body"),ks.setAttribute("data-plugin-sandbox","true"),ks.dataset.pluginSandbox="sandboxed-plugin",ks.style.width="100%",ks.style.height="0%",ks.style.overflow="hidden",ks.style.top="0",ks.style.left="0",document.body.appendChild(ks)),ks}let hh=!1;function Bi(){hh||(hh=!0,eg(),fh())}function fh(){const be=Worker.prototype.postMessage;Object.defineProperty(Worker.prototype,"postMessage",{value:function(...Ne){return be.apply(this,Rd(Ne))}})}function eg(){const be=window.history.replaceState;Object.defineProperty(window.history,"replaceState",{value:function(...Ne){let Qe=Ne;try{Qe=(0,Wa.cloneDeep)(Ne)}catch(st){Ts("Error cloning args in window.history.replaceState",{error:String(st)})}return Reflect.apply(be,this,Qe)},writable:!0,configurable:!0,enumerable:!1})}const Es=new Map,ph=Symbol.for("@SANDBOX_LIVE_API_PATCHED");function tg(){return Es.size===0&&(ng(Es),ag(Es),sg(Es),lg(Es),ig(Es),rg(Es),og(Es),gh(Es),cg(Es),fo(Es),dg(Es),hg(Es)),Es}function rc(be,Ne){return Ts(`Plugin ${Ne.id} tried to set a sandboxed property`,{pluginId:Ne.id,attrOrMethod:String(be),entity:"window"}),()=>{throw new Error("Plugins are not allowed to set sandboxed properties")}}function ng(be){const Ne=["contentDocument","contentWindow","src","srcdoc","srcObject","srcset"];for(const st of Ne){const ot=Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,st);if(ot){let it=function(Ot,Tt){const Nt=Tt.id;return Ts(`Plugin ${Nt} tried to access iframe.${st}`,{pluginId:Nt,attrOrMethod:st,entity:"iframe"}),()=>{throw new Error("iframe."+st+" is not allowed in sandboxed plugins")}};var Qe=it;ot.value&&be.set(ot.value,it),ot.set&&be.set(ot.set,it),ot.get&&be.set(ot.get,it)}}}function ag(be){const Ne=Object.getOwnPropertyDescriptor(window,"console");if(Ne?.value){let st=function(ot,it){const Ot=it.id;function Tt(...Nt){console.log(`[plugin ${Ot}]`,...Nt)}return{log:Tt,warn:Tt,error:Tt,info:Tt,debug:Tt,table:Tt}};var Qe=st;be.set(Ne.value,st)}Ne?.set&&be.set(Ne.set,rc)}function sg(be){function Ne(st,ot){const it=ot.id;return Ts(`Plugin ${it} accessed window.alert`,{pluginId:it,attrOrMethod:"alert",entity:"window"}),function(...Ot){console.log(`[plugin ${it}]`,...Ot)}}const Qe=Object.getOwnPropertyDescriptor(window,"alert");Qe?.value&&be.set(Qe.value,Ne),Qe?.set&&be.set(Qe.set,rc)}function rg(be){function Ne(st,ot){const it=ot.id;return function(...Tt){for(let Nt=0;Nt<Tt.length;Nt++){const wt=Tt[Nt],Ht=String(wt||"").toLowerCase();for(const rn of Hr)if(Ht.includes("<"+rn))throw Ts(`Plugin ${it} tried to set ${rn} in innerHTML`,{pluginId:it,attrOrMethod:"innerHTML",param:rn,entity:"HTMLElement"}),new Error("<"+rn+"> is not allowed in sandboxed plugins");Ht.match(/onerror|onload|onsuccess|onbeforeunload/)&&(Ts(`Plugin ${it} tried to set forbidden attribute in innerHTML`,{pluginId:it,attrOrMethod:"innerHTML",param:wt,entity:"HTMLElement"}),Tt[Nt]=ih.A.sanitize(Tt[Nt]))}if((0,Wa.isFunction)(st))return st.apply(this,Tt)}}const Qe=[Object.getOwnPropertyDescriptor(Element.prototype,"innerHTML"),Object.getOwnPropertyDescriptor(Element.prototype,"outerHTML"),Object.getOwnPropertyDescriptor(Element.prototype,"insertAdjacentHTML"),Object.getOwnPropertyDescriptor(DOMParser.prototype,"parseFromString")];for(const st of Qe)st?.set&&be.set(st.set,Ne),st?.value&&be.set(st.value,Ne)}function og(be){function Ne(st,ot){const it=ot.id;return function(Tt,Nt){if(Tt&&Hr.includes(Tt))return Ts(`Plugin ${it} tried to create ${Tt}`,{pluginId:it,attrOrMethod:"createElement",param:Tt,entity:"document"}),document.createDocumentFragment();if((0,Wa.isFunction)(st))return st.apply(this,[Tt,Nt])}}const Qe=Object.getOwnPropertyDescriptor(Document.prototype,"createElement");Qe?.value&&be.set(Qe.value,Ne)}function ig(be){function Ne(it,Ot){const Tt=Ot.id;return function(wt,Ht){const rn=wt?.nodeName?.toLowerCase()||"";if(wt&&Hr.includes(rn))return Ts(`Plugin ${Tt} tried to insert ${rn}`,{pluginId:Tt,attrOrMethod:"insertChild",param:rn,entity:"HTMLElement"}),document.createDocumentFragment();if((0,Wa.isFunction)(it))return it.call(this,wt,Ht)}}function Qe(it,Ot){const Tt=Ot.id;return function(wt,Ht){const rn=Ht?.nodeName?.toLowerCase()||"";if(Ht&&Hr.includes(rn))return Ts(`Plugin ${Tt} tried to insert ${rn}`,{pluginId:Tt,attrOrMethod:"insertAdjacentElement",param:rn,entity:"HTMLElement"}),document.createDocumentFragment();if((0,Wa.isFunction)(it))return it.call(this,wt,Ht)}}const st=[Object.getOwnPropertyDescriptor(Node.prototype,"insertBefore"),Object.getOwnPropertyDescriptor(Node.prototype,"replaceChild")];for(const it of st)it?.value&&be.set(it.set,Ne);const ot=Object.getOwnPropertyDescriptor(Element.prototype,"insertAdjacentElement");ot?.value&&be.set(ot.set,Qe)}function lg(be){function Ne(it,Ot){const Tt=Ot.id;return function(...wt){let Ht=wt;const rn=wt?.filter(sn=>!Hr.includes(sn.nodeName.toLowerCase()));Ht=rn,Ht.length!==rn.length&&Ts(`Plugin ${Tt} tried to append fobiddenElements`,{pluginId:Tt,attrOrMethod:"append",param:wt?.filter(sn=>Hr.includes(sn.nodeName.toLowerCase()))?.join(",")||"",entity:"HTMLElement"}),(0,Wa.isFunction)(it)&&it.apply(this,Ht)}}function Qe(it,Ot,Tt){const Nt=Ot.id;return function(Ht){const rn=Ht?.nodeName?.toLowerCase()||"";if(Ht&&Hr.includes(rn))return Ts(`Plugin ${Nt} tried to append ${rn}`,{pluginId:Nt,attrOrMethod:"appendChild",param:rn,entity:"HTMLElement"}),document.createDocumentFragment();if(Tt&&Ht&&rn==="script"&&Ht instanceof HTMLScriptElement){zp(Ht.src,Tt).then(()=>{Ht.onload?.call(Ht,new Event("load"))}).catch(sn=>{Ht.onerror?.call(Ht,new ErrorEvent("error",{error:sn}))});return}if((0,Wa.isFunction)(it))return it.call(this,Ht)}}const st=[Object.getOwnPropertyDescriptor(Element.prototype,"append"),Object.getOwnPropertyDescriptor(Element.prototype,"prepend"),Object.getOwnPropertyDescriptor(Element.prototype,"after"),Object.getOwnPropertyDescriptor(Element.prototype,"before"),Object.getOwnPropertyDescriptor(Document.prototype,"append"),Object.getOwnPropertyDescriptor(Document.prototype,"prepend")];for(const it of st)it?.value&&be.set(it.value,Ne);const ot=Object.getOwnPropertyDescriptor(Node.prototype,"appendChild");ot?.value&&be.set(ot.value,Qe)}function gh(be){const Ne=Object.getOwnPropertyDescriptor(Worker.prototype,"postMessage");function Qe(st){return function(...it){try{const Ot=(0,Wa.cloneDeep)(it);(0,Wa.isFunction)(st)&&st.apply(this,Ot)}catch{throw new Error("postMessage arguments are invalid objects")}}}Ne?.value&&be.set(Ne.value,Qe)}function cg(be){const Ne=Object.getOwnPropertyDescriptor(Document.prototype,"defaultView");Ne?.get&&be.set(Ne.get,()=>()=>window);const Qe=["write"];for(const st of Qe){const ot=Object.getOwnPropertyDescriptor(Document.prototype,st);ot?.set&&be.set(ot.set,rc),ot?.value&&be.set(ot.value,rc)}}async function fo(be){const Ne=Reflect.get(window,"monaco");if(!Ne||Object.hasOwn(Ne,ph))return;const Qe=Ne.languages.setMonarchTokensProvider;function st(){return function(...ot){return ot.length!==2?Qe.apply(Ne,ot):Qe.call(Ne,ot[0],as(ot[1]))}}be.set(Ne.languages.setMonarchTokensProvider,st),Reflect.set(Ne,ph,{})}async function dg(be){const Ne=Object.getOwnPropertyDescriptor(window,"postMessage");function Qe(st){return function(...it){try{const Ot=(0,Wa.cloneDeep)(it);(0,Wa.isFunction)(st)&&st.apply(this,Ot)}catch{throw new Error("postMessage arguments are invalid objects")}}}Ne?.value&&be.set(Ne.value,Qe)}function ug(be){fo(Es)}function hg(be){function Ne(Qe){return(0,Wa.isFunction)(Qe)?function(...st){const ot=Qe.apply(this,st);return Ad(ot),ot}:Qe}be.set(Wa.cloneDeep,Ne)}async function fg(be,Ne){if(!Qp(be))return be;const Qe=await Promise.resolve(be.plugin);if(Reflect.has(Qe,"panel")&&Reflect.set(Qe,"panel",zo(Reflect.get(Qe,"panel"),Ne)),Reflect.has(Qe,"components")){const st=Reflect.get(Qe,"components");Object.entries(st).forEach(([ot,it])=>{Reflect.set(st,ot,zo(it,Ne))}),Reflect.set(Qe,"components",st)}if(Reflect.has(Qe,"root")&&Reflect.set(Qe,"root",zo(Reflect.get(Qe,"root"),Ne)),Reflect.has(Qe,"addedComponentConfigs")){const st=Reflect.get(Qe,"addedComponentConfigs");for(const ot of st)Reflect.has(ot,"component")&&Reflect.set(ot,"component",zo(Reflect.get(ot,"component"),Ne));Reflect.set(Qe,"addedComponentConfigs",st)}if(Reflect.has(Qe,"exposedComponentConfigs")){const st=Reflect.get(Qe,"exposedComponentConfigs");for(const ot of st)Reflect.has(ot,"component")&&Reflect.set(ot,"component",zo(Reflect.get(ot,"component"),Ne));Reflect.set(Qe,"exposedComponentConfigs",st)}if(Reflect.has(Qe,"configPages")){const st=Reflect.get(Qe,"configPages")??[];for(const[ot,it]of Object.entries(st))!it.body||!(0,Wa.isFunction)(it.body)||Reflect.set(st,ot,{...it,body:zo(it.body,Ne)});Reflect.set(Qe,"configPages",st)}return be}const zo=(be,Ne)=>{const Qe=Vt.memo(st=>(0,yt.jsx)("div",{"data-plugin-sandbox":Ne.id,style:{height:Ne.type===l.QE.app||Ne.type===l.QE.panel?"100%":"auto"},children:(0,yt.jsx)(be,{...st})}));return Qe.displayName=`GrafanaSandbox(${be.displayName||be.name||"Component"})`,Qe},oc=new Map,mh={};async function pg({pluginId:be}){Bi();try{const Ne=Md(be);return oc.has(be)||oc.set(be,gg(Ne)),oc.get(be)}catch(Ne){const Qe=new Error(`Could not import plugin ${be} inside sandbox: `+Ne);throw Li(Qe,{pluginId:be,error:String(Ne)}),Qe}}async function gg(be){return lh("Loading with sandbox",{pluginId:be.id}),new Promise(async(Ne,Qe)=>{const st=tg();let ot;function it(Tt){if(ch(Tt)){const Ht=Yp(Tt,be.id);return Jp(Ht),Ht}else Xp(Tt);const Nt=st.get(Tt);if(Nt)return Nt(Tt,be,ot);const wt=ug(Tt);return wt||Tt}ot=(0,Td.A)(window,{distortionCallback:it,defaultPolicy:$p.G,liveTargetCallback:uh,endowments:Object.getOwnPropertyDescriptors({locationSandbox:window.location,setImmediate:function(Tt,...Nt){return setTimeout(Tt,0,...Nt)},get monaco(){return Reflect.get(window,"monaco")},get Prism(){return Reflect.get(window,"Prism")},get jQuery(){return Reflect.get(window,"jQuery")},get $(){return Reflect.get(window,"jQuery")},get grafanaBootData(){if(mh[be.id+"-grafanaBootData"]||(mh[be.id+"-grafanaBootData"]=!0,lh("Plugin using window.grafanaBootData",{sandbox:"true",pluginId:be.id,guessedPluginName:be.id,parent:"window",packageName:"window",key:"grafanaBootData"})),v.$.buildInfo.env==="development")throw new Error(`Error in ${be.id}: Plugins should not use window.grafanaBootData. Use "config" from "@grafana/runtime" instead.`);return console.error(`${be.id.toUpperCase()}: Plugins should not use window.grafanaBootData. Use "config" from "@grafana/runtime" instead.`),v.$.bootData},async define(Tt,Nt,wt){let Ht,rn;Array.isArray(Tt)?(Ht=Tt,rn=Nt):(Ht=Nt,rn=wt);try{const sn=await vh(Ht,be),pn=rn.apply(null,sn),Vn=await fg(pn,be);Ne(Vn)}catch(sn){const pn=new Error(`Could not execute plugin's define ${be.id}: `+sn);Li(pn,{pluginId:be.id,error:String(sn)}),Qe(pn)}}})}),_p(ot);let Ot="";try{Ot=await rh(be)}catch(Tt){const Nt=new Error(`Could not load plugin code ${be.id}: `+Tt);Li(Nt,{pluginId:be.id,error:String(Tt)}),Qe(Nt)}try{ot.evaluate(Ot)}catch(Tt){const Nt=new Error(`Could not run plugin ${be.id} inside sandbox: `+Tt);Li(Nt,{pluginId:be.id,error:String(Tt)}),Qe(Nt)}})}async function vh(be,Ne){const Qe={},st={id:Ne.id,uri:Ne.module,exports:Qe},ot=[];for(const it of be){let Ot=th.get(it);if(typeof Ot=="function"&&(Ot=await Ot()),Ot?.__useDefault&&(Ot=Ot.default),it==="module"&&(Ot=st),it==="exports"&&(Ot=Qe),!Ot){const Tt=new Error(`[sandbox] Could not resolve dependency ${it}`);throw Li(Tt,{pluginId:Ne.id,dependency:it,error:String(Tt)}),Tt}ot.push(Ot)}return ot}var mg=e(59253),vg=e(95027);let yh=Pg;function Jg(be){yh=be}async function yg({pluginId:be}){return await xg({pluginId:be})?yh({pluginId:be}):!1}async function xg({pluginId:be}){return!v.$.featureToggles.pluginsFrontendSandbox||window.location.search.includes("nosandbox")&&v.$.buildInfo.env==="development"||!Oi.TP.isSignedIn?!1:Eg({pluginId:be})}async function Eg({pluginId:be}){try{const Ne=await(0,vg.x)(be,{showErrorAlert:!1});return Ne.signatureType!==l.kv.grafana&&Ne.signature!=="internal"}catch{try{const Qe=await(0,mg.CB)(be);return Qe.signatureType!==l.kv.grafana&&Qe.signature!=="internal"}catch{return!1}}}async function Pg({pluginId:be}){return!!v.$.enableFrontendSandboxForPlugins?.includes(be)}var bg=e(37640);const Dg=nh(wp);Te.addImportMap({imports:Dg});const Sr=Te.constructor.prototype;Sr.shouldFetch=function(be){const Ne=(0,Ee.QO)(be);return/^[^#?]+\.(js)([?#].*)?$/.test(be)?Ne?.loadingStrategy!==l.xf.script:!0};const Cg=Sr.import;Sr.import=function(...be){return Cg.apply(this,be).then(Ne=>Ne&&Ne.__useDefault?Ne.default:Ne)};const Tg=Sr.fetch;Sr.fetch=function(be,Ne){return Dd(Tg,be,Ne)};const Mg=Sr.resolve;Sr.resolve=ah.bind(Sr,Mg),Sr.onload=ji;async function ic({path:be,pluginId:Ne,loadingStrategy:Qe,version:st,moduleHash:ot,translations:it}){st&&(0,Ee.GD)({path:be,version:st,loadingStrategy:Qe}),v.$.featureToggles.localizationForPlugins&&it&&await Ig({resolvedLanguage:(0,x.Ph)(),fallbackLanguage:c.Nm,pluginId:Ne,translations:it});const Ot=ve[be];if(Ot)return typeof Ot=="function"?await Ot():Ot;const Tt=bd(be);if(v.$.featureToggles.pluginsSriChecks){const Nt=System.resolve(Tt),wt=System.getImportMap().integrity;ot&&wt&&!wt[Nt]&&Te.addImportMap({integrity:{[Nt]:ot}})}return await yg({pluginId:Ne})?pg({pluginId:Ne}):Te.import(Tt).catch(Nt=>{let wt=new Error("Could not load plugin: "+Nt);throw console.error(wt),bg.z4.logError(wt,{path:be,pluginId:Ne,pluginVersion:st??"",expectedHash:ot??"",loadingStrategy:Qe.toString(),sriChecksEnabled:(v.$.featureToggles.pluginsSriChecks??!1).toString()}),wt})}function Sg(be){(0,g.M)(be);const Ne=be.loadingStrategy??l.xf.fetch;return ic({path:be.module,version:be.info?.version,loadingStrategy:Ne,pluginId:be.id,moduleHash:be.moduleHash,translations:be.translations}).then(Qe=>{if(Qe.plugin){const st=Qe.plugin;return st.meta=be,st}if(Qe.Datasource){const st=new f.tD(Qe.Datasource);return st.setComponentsFromLegacyExports(Qe),st.meta=be,st}throw new Error("Plugin module is missing DataSourcePlugin or Datasource constructor export")})}const jd={};async function Og(be){const Ne=be.id;return jd[Ne]===void 0&&(jd[Ne]=xh(be)),jd[Ne]}async function xh(be){(0,g.M)(be);const Ne=await ic({path:be.module,version:be.info?.version,pluginId:be.id,loadingStrategy:be.loadingStrategy??l.xf.fetch,moduleHash:be.moduleHash,translations:be.translations}),{plugin:Qe=new p.hX}=Ne;return Qe.init(be),Qe.meta=be,Qe.setComponentsFromLegacyExports(Ne),le.eY.register({pluginId:be.id,configs:Qe.exposedComponentConfigs||[]}),le.a9.register({pluginId:be.id,configs:Qe.addedComponentConfigs||[]}),le.lQ.register({pluginId:be.id,configs:Qe.addedLinkConfigs||[]}),le.rH.register({pluginId:be.id,configs:Qe.addedFunctionConfigs||[]}),Qe}async function Ig({resolvedLanguage:be,fallbackLanguage:Ne,pluginId:Qe,translations:st}){const ot=st[be],it=st[Ne],Ot=ot??it;if(!Ot){console.warn(`Could not find any translation for plugin ${Qe}`,{resolvedLanguage:be,fallbackLanguage:Ne});return}try{const Tt=await Te.import(bd(Ot));if(!Tt.default){console.warn(`Could not find default export for plugin ${Qe}`,{resolvedLanguage:be,fallbackLanguage:Ne,path:Ot});return}const Nt=ot?be:Ne;(0,x.eI)(Nt,Qe,Tt.default)}catch(Tt){console.warn(`Could not load translation for plugin ${Qe}`,{resolvedLanguage:be,fallbackLanguage:Ne,error:Tt,path:Ot})}}},95027:(te,R,e)=>{"use strict";e.d(R,{o:()=>i,x:()=>s});var n=e(68143);const a={};function s(r,u){const o=a[r];return o?Promise.resolve(o):(0,n.AI)().get(`/api/plugins/${r}/settings`,void 0,void 0,{...u,validatePath:!0}).then(l=>(a[r]=l,l)).catch(l=>typeof l=="object"&&l!==null&&"status"in l&&l.status===403?(l.isHandled=!0,Promise.reject(l)):Promise.reject(new Error("Unknown Plugin")))}const i=r=>r?delete a[r]:Object.keys(a).forEach(u=>delete a[u])},37168:(te,R,e)=>{"use strict";e.d(R,{X:()=>H,v:()=>Q});var n=e(74848),a=e(84057),s=e(65307),i=e(96540),r=e(54148),u=e(20877),o=e(90382),l=e(32899),g=e(11594),f=e(92745),p=e(43173),c=e(36490),x=e(56297),v=e(34999),m=e(13791),y=e(11098),h=e(1506),d=e(27963),E=e(73427);function b(Z){return console.error(Z),C("Exception thrown","See console for details")}function D(){return C("Page not found","404 Error")}function C(Z,Y){const X={text:Z,subTitle:Y,icon:"exclamation-triangle"};return{node:X,main:X}}var P=e(47797),M=e(28337),O=e(59922),j=e(95027),U=e(37640),W=e(22465),B=e(70715);const S={loading:!0,loadingError:!1,pluginNav:null,plugin:null};function _({pluginId:Z,pluginNavSection:Y}){const{pluginId:X=""}=(0,r.g)();Z=Z||X;const I=(0,M.OG)(),J=(0,M.TX)(),ee=(0,M.ZV)(),q=(0,M.ov)(),ne=(0,r.zy)(),[se,oe]=(0,i.useReducer)(K.reducer,S),de=p.$.appSubUrl+ne.pathname+ne.search,{plugin:fe,loading:ae,loadingError:ce,pluginNav:ie}=se,ve=(0,U.Wy)(de,Y),le=(0,i.useMemo)(()=>(0,c.SE)(ne.search),[ne.search]),Ee=(0,i.useMemo)(()=>(0,B.S)(ve),[ve]),Re=(0,d.Il)();(0,i.useEffect)(()=>{T(Z,oe)},[Z]);const Oe=(0,i.useCallback)(He=>oe(K.actions.changeNav(He)),[]);if(!fe||Z!==fe.meta.id){const He=Re.chrome.state.getValue().layout;return(0,n.jsxs)(m.Y,{navModel:ve,pageNav:{text:""},layout:He,children:[ae&&(0,n.jsx)(y.A,{}),!ae&&ce&&(0,n.jsx)(h.L,{entity:"App"})]})}if(!fe.root)return(0,n.jsx)(m.Y,{navModel:ve??C("Plugin load error"),children:(0,n.jsx)("div",{children:(0,n.jsx)(f.x6,{i18nKey:"plugins.app-root-page.no-root-app-page-component-found",children:"No root app page component found"})})});const Se=fe.root&&(0,n.jsx)(u.a,{meta:fe.meta,children:(0,n.jsx)(W.K,{fallback:({error:He,errorInfo:tt})=>(0,n.jsx)(x.D,{title:(0,f.t)("plugins.app-root-page.error-loading-plugin","Plugin failed to load"),error:He,errorInfo:tt}),children:(0,n.jsx)(M.AZ,{registries:{addedLinksRegistry:I.readOnly(),addedComponentsRegistry:J.readOnly(),exposedComponentsRegistry:ee.readOnly(),addedFunctionsRegistry:q.readOnly()},children:(0,n.jsx)(fe.root,{meta:fe.meta,basename:ne.pathname,onNavChanged:Oe,query:le,path:ne.pathname})})})}),Te=()=>{if(!fe.meta?.includes)return!0;const He=fe.meta?.includes.find(Je=>Je.path===ne.pathname);if(!He)return!0;if(He?.action)return E.TP.hasPermission(He.action);if(E.TP.isGrafanaAdmin||E.TP.user.orgRole===o.X.Admin)return!0;const tt=He?.role||"";return!tt||E.TP.isEditor&&tt===o.X.Viewer?!0:E.TP.hasRole(tt)},_e=()=>(0,n.jsx)(v.F,{severity:"warning",title:(0,f.t)("plugins.app-root-page.access-denied.title-access-denied","Access denied"),children:(0,n.jsx)(f.x6,{i18nKey:"plugins.app-root-page.access-denied.permission",children:"You do not have permission to see this page."})});return Te()?ie?(0,n.jsx)(n.Fragment,{children:ve?(0,n.jsx)(m.Y,{navModel:ve,pageNav:ie?.node,children:(0,n.jsx)(m.Y.Contents,{isLoading:ae,children:Se})}):(0,n.jsx)(m.Y,{children:Se})}):(0,n.jsx)(B.A.Provider,{value:Ee,children:Se}):(0,n.jsx)(_e,{})}const K=(0,s.Z0)({name:"prom-builder-container",initialState:S,reducers:{setState:(Z,Y)=>{Object.assign(Z,Y.payload)},changeNav:(Z,Y)=>{let X=Y.payload;X&&X.node.children&&(X={...X,node:{...X.main,hideFromBreadcrumbs:!0}}),Z.pluginNav=X}}});async function T(Z,Y){try{const X=await(0,j.x)(Z).then(I=>{const J=L(I);return J?(E.lE.emit(l.r1.alertError,[J]),Y(K.actions.setState({pluginNav:C(J)})),null):(0,O.ui)(I)});Y(K.actions.setState({plugin:X,loading:!1,loadingError:!1,pluginNav:null}))}catch(X){Y(K.actions.setState({plugin:null,loading:!1,loadingError:!0,pluginNav:D()}));const I=X instanceof Error?X:new Error((0,P.q6)(X));U.z4.logError(I),console.error(I)}}function L(Z){return Z?Z.type!==g.QE.app?"Plugin must be an app":Z.enabled?null:"Application Not Enabled":"Unknown Plugin"}const A=_;var N=e(8535);const V=Z=>"pluginId"in Z&&"id"in Z,z=Z=>Z.startsWith("standalone-plugin-page-/");function w(Z){const Y=(0,a.rH)(Z),X=`/a/${Z.pluginId}`,I=z(Z.id)&&Z.url||X,J=z(Z.id)&&!Z.url?.startsWith("/a/");return{path:`${I}/*`,sensitive:J,component:()=>(0,n.jsx)(A,{pluginId:Z.pluginId,pluginNavSection:Y})}}function H(){const Z=(0,N.Gu)(),{navIndex:Y}=Z;return[...Object.values(Y).filter(V).map(w),{path:"/a/:pluginId/*",component:()=>(0,n.jsx)(A,{pluginNavSection:Y.home})}]}function Q(Z){const Y=(0,N.Gu)(),{navIndex:X}=Y,I=Object.values(X).filter(V).find(J=>J.pluginId===Z);return I?w(I):{path:"/a/:pluginId/*",component:()=>(0,n.jsx)(A,{pluginNavSection:X.home})}}},37640:(te,R,e)=>{"use strict";e.d(R,{W3:()=>u,Wy:()=>o,z4:()=>l});var n=e(11594),a=e(25992),s=e(92391),i=e(59922),r=e(95027);async function u(g){const f=await(0,r.x)(g);let p;if(f.type===n.QE.app&&(p=await(0,i.ui)(f)),f.type===n.QE.datasource&&(p=await(0,i.cS)(f)),f.type===n.QE.panel&&(p=await(0,s.Kk)(f)),f.type===n.QE.renderer&&(p={meta:f}),!p)throw new Error("Unknown Plugin type: "+f.type);return p}function o(g,f){if(!f)return;const p=10;let c={...f},x;function v(y,h){return!h.startsWith(y.url??"")||x&&(x.url?.length??0)>(y.url?.length??0)?y:(x&&(x.active=!1),x={...y,active:!0},x)}function m(y,h=0){if(h>p)return y;if(y.children){const d=y.children.map(E=>m(E,h+1));return{...v(y,g),children:d}}return v(y,g)}return c.children=(c?.children??[]).map(m),{main:c,node:x??c}}const l=(0,a.DW)("features.plugins")},1492:(te,R,e)=>{"use strict";e.d(R,{Pj:()=>l,o:()=>g,Aj:()=>p});var n=e(75816),a=e(73892);const i=(0,n.xP)({reducerPath:"userPreferencesAPI",baseQuery:(0,a.W)({baseURL:"/api"}),endpoints:()=>({})}).injectEndpoints({endpoints:c=>({getUserPreferences:c.query({query:()=>({url:"/user/preferences"})}),patchUserPreferences:c.mutation({query:x=>({url:"/user/preferences",method:"PATCH",body:x.patchPrefsCmd})}),updateUserPreferences:c.mutation({query:x=>({url:"/user/preferences",method:"PUT",body:x.updatePrefsCmd})})}),overrideExisting:!1}),{useGetUserPreferencesQuery:r,usePatchUserPreferencesMutation:u,useUpdateUserPreferencesMutation:o}=i,{useGetUserPreferencesQuery:l,usePatchUserPreferencesMutation:g,useUpdateUserPreferencesMutation:f}=i,p=i.enhanceEndpoints({addTagTypes:["UserPreferences"],endpoints:{getUserPreferences:{providesTags:["UserPreferences"]},updateUserPreferences:{invalidatesTags:["UserPreferences"]},patchUserPreferences:{invalidatesTags:["UserPreferences"]}}})},69289:(te,R,e)=>{"use strict";e.d(R,{Ay:()=>U,Cj:()=>c,HO:()=>E,Mj:()=>m,Nm:()=>v,Q9:()=>d,RS:()=>C,c1:()=>p,g$:()=>b,ny:()=>y,ri:()=>h,uh:()=>D,xu:()=>x});var n=e(65307),a=e(2543),s=e.n(a),i=e(80011),r=e(25229),u=e(5857),o=e(65642),l=e(73427);const g={orgId:o.Ay.bootData.user.orgId,timeZone:o.Ay.bootData.user.timezone,weekStart:o.Ay.bootData.user.weekStart,fiscalYearStartMonth:0,orgsAreLoading:!1,sessionsAreLoading:!1,teamsAreLoading:!1,isUpdating:!1,orgs:[],sessions:[],teams:[],user:null},f=(0,n.Z0)({name:"user/profile",initialState:g,reducers:{updateTimeZone:(W,B)=>{W.timeZone=B.payload.timeZone},updateWeekStart:(W,B)=>{W.weekStart=B.payload.weekStart},updateFiscalYearStartMonth:(W,B)=>{W.fiscalYearStartMonth=B.payload.fiscalYearStartMonth},setUpdating:(W,B)=>{W.isUpdating=B.payload.updating},userLoaded:(W,B)=>{W.user=B.payload.user},initLoadTeams:(W,B)=>{W.teamsAreLoading=!0},teamsLoaded:(W,B)=>{W.teams=B.payload.teams,W.teamsAreLoading=!1},initLoadOrgs:(W,B)=>{W.orgsAreLoading=!0},orgsLoaded:(W,B)=>{W.orgs=B.payload.orgs,W.orgsAreLoading=!1},initLoadSessions:(W,B)=>{W.sessionsAreLoading=!0},sessionsLoaded:(W,B)=>{const S=B.payload.sessions.sort((_,K)=>Number(K.isActive)-Number(_.isActive));W.sessions=S.map(_=>({id:_.id,isActive:_.isActive,seenAt:(0,i.fq)(_.seenAt),createdAt:_.createdAt,clientIp:_.clientIp,browser:_.browser,browserVersion:_.browserVersion,authModule:_.authModule,os:_.os,osVersion:_.osVersion,device:_.device})),W.sessionsAreLoading=!1},userSessionRevoked:(W,B)=>{W.sessions=W.sessions.filter(S=>S.id!==B.payload.tokenId),W.isUpdating=!1}}}),p=W=>async B=>{(0,a.set)(l.TP,"user.fiscalYearStartMonth",W),B(O({fiscalYearStartMonth:W}))},c=W=>async B=>{(!(0,a.isString)(W)||(0,a.isEmpty)(W))&&(W=o.Ay?.bootData?.user?.timezone),(0,a.set)(l.TP,"user.timezone",W),B(P({timeZone:W}))},x=W=>async B=>{W||(W=(0,u.rL)()),(0,a.set)(l.TP,"user.weekStart",W),B(M({weekStart:W})),(0,r.$D)(W)},{setUpdating:v,initLoadOrgs:m,orgsLoaded:y,initLoadTeams:h,teamsLoaded:d,userLoaded:E,userSessionRevoked:b,initLoadSessions:D,sessionsLoaded:C,updateTimeZone:P,updateWeekStart:M,updateFiscalYearStartMonth:O}=f.actions,j=f.reducer,U={user:f.reducer}},34984:(te,R,e)=>{"use strict";e.d(R,{O:()=>n,q:()=>a});const n=s=>s.timeZone,a=s=>s.fiscalYearStartMonth},53247:(te,R,e)=>{"use strict";e.d(R,{ED:()=>i,Hv:()=>s,NY:()=>u,hF:()=>r});var n=e(43173);const a=["provisioning","kubernetesDashboards","kubernetesClientDashboardsFolders"],s=()=>{const o=n.$.featureToggles||{};return a.every(l=>o[l])},i=()=>!!(n.$.appUrl&&n.$.appUrl.indexOf("://localhost")<0),r=()=>!!n.$.rendererAvailable,u=()=>{const o=s(),l=i(),g=r();return{hasRequiredFeatures:o,hasPublicAccess:l,hasImageRenderer:g,missingOnlyOptionalFeatures:o&&(!l||!g),missingRequiredFeatures:!o,everythingConfigured:o&&l&&g}}},91555:(te,R,e)=>{"use strict";e.d(R,{mL:()=>n,pd:()=>a,zM:()=>s});const n="/admin/provisioning",a=`${n}/connect`,s=`${n}/getting-started`},55266:(te,R,e)=>{"use strict";e.d(R,{T:()=>r});var n=e(10378),a=e(87161),s=e(33680),i=e(75735);const r=({name:u,folderName:o})=>{const{data:l,isLoading:g}=(0,s.F9)(),f=!o,{data:p,isLoading:c}=(0,a.k)(f?n.hT:{name:o});if(g||c)return{isLoading:!0,isInstanceManaged:!1};const x=l?.items??[];if(!x.length)return{folder:p,isInstanceManaged:!1};const v=x.find(y=>y.target==="instance"),m=!!v;if(u){const y=x.find(h=>h.name===u);if(y)return{repository:y,folder:p,isInstanceManaged:m}}if(o){let y=x.find(d=>d.name===o);if(y)return{repository:y,folder:p,isInstanceManaged:m};const h=p?.metadata?.annotations?.[i.Jw];if(h&&(y=x.find(d=>d.name===h),y))return{repository:y,folder:p,isInstanceManaged:m}}return{repository:v,folder:p,isInstanceManaged:m}}},27321:(te,R,e)=>{"use strict";e.d(R,{F:()=>i});var n=e(10378),a=e(43173),s=e(33680);function i(r){const u=(0,s.F9)(r||!a.$.featureToggles.provisioning?n.hT:void 0);return r||(r=u.data),r?.items?.some(o=>o.target==="instance")}},92784:(te,R,e)=>{"use strict";e.d(R,{a:()=>a,e:()=>n});function n(s){return s&&/^(?!\/|.*\/\/|.*\.\.|.*@{)(?!.*[~^:?*[\]\\]).+(?<!\/|\.|\s)$/.test(s)}const a=s=>{if(s?.url)return s.branch?`${s.url}/tree/${s.branch}`:s.url}},23117:(te,R,e)=>{"use strict";e.d(R,{d:()=>s,m:()=>a});class n{constructor(){this.extraRenderActions=[],this.keyedScopedExtraRenderActions=new Map}addExtraRenderAction(r){this.extraRenderActions=this.extraRenderActions.concat(r)}addKeyedExtraRenderAction(r,u){this.keyedScopedExtraRenderActions.set(r,u)}getAllExtraRenderAction(){return this.extraRenderActions}getScopedExtraRenderAction(r){return Array.from(this.keyedScopedExtraRenderActions,o=>o[1]).filter(o=>o.scope===r).map(o=>o.queryActionComponent)}}const a=new n,s=new n},67042:(te,R,e)=>{"use strict";e.d(R,{c:()=>V,E:()=>z});var n=e(74848),a=e(46942),s=e.n(a),i=e(2543),r=e(55127),u=e.n(r),o=e(96540),l=e(1906),g=e(62392),f=e(48480),p=e(28105),c=e(54092),x=e(51898),v=e(92745),m=e(78282),y=e(27489),h=e(33604),d=e(22099),E=e(5585),b=e(99887),D=e(36303),C=e(68805),P=e(43260),M=e(85348),O=e(98838),j=e(23117),U=e(22803),W=e(63142),B=e(30703),S=e(63527),_=e(12594),K=e(76792);const T=Z=>{const{query:Y,queries:X,onChange:I,collapsedText:J,renderExtras:ee,hidden:q,hideRefId:ne=!1}=Z,se=(0,W.of)(A),[oe,de]=(0,o.useState)(!1),[fe,ae]=(0,o.useState)(null),ce=Oe=>{de(!0)},ie=Oe=>{if(de(!1),fe){ae(null);return}Y.refId!==Oe&&I({...Y,refId:Oe})},ve=Oe=>{const Se=Oe.currentTarget.value.trim();if(Se.length===0){ae("An empty query name is not allowed");return}for(const Te of X)if(Te!==Y&&Se===Te.refId){ae("Query name already exists");return}fe&&ae(null)},le=Oe=>{ie(Oe.currentTarget.value.trim())},Ee=Oe=>{Oe.key==="Enter"&&ie(Oe.currentTarget.value)},Re=Oe=>{Oe.target.select()};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:se.wrapper,children:[!ne&&!oe&&(0,n.jsxs)("button",{className:se.queryNameWrapper,"aria-label":x.Tp.components.QueryEditorRow.title(Y.refId),title:(0,v.t)("query.query-editor-row-header.query-name-div-title-edit-query-name","Edit query name"),onClick:ce,"data-testid":"query-name-div",type:"button",children:[(0,n.jsx)("span",{className:se.queryName,children:Y.refId}),(0,n.jsx)(B.I,{name:"pen",className:se.queryEditIcon,size:"sm"})]}),!ne&&oe&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(S.p,{type:"text",defaultValue:Y.refId,onBlur:le,autoFocus:!0,onKeyDown:Ee,onFocus:Re,invalid:fe!==null,onChange:ve,className:se.queryNameInput,"data-testid":"query-name-input"}),fe&&(0,n.jsx)(_.P,{horizontal:!0,children:fe})]}),L(Z,se),ee&&(0,n.jsx)("div",{className:se.itemWrapper,children:ee()}),q&&(0,n.jsx)("em",{className:se.contextInfo,children:(0,n.jsx)(v.x6,{i18nKey:"query.query-editor-row-header.hidden",children:"Hidden"})})]}),J&&(0,n.jsx)("div",{className:se.collapsedText,children:J})]})},L=(Z,Y)=>{const{alerting:X,dataSource:I,onChangeDataSource:J}=Z;return J?(0,n.jsx)("div",{className:Y.itemWrapper,children:(0,n.jsx)(K.s,{dashboard:!0,variables:!0,alerting:X,current:I.name,onChange:J})}):(0,n.jsxs)("em",{className:Y.contextInfo,children:["(",I.name,")"]})},A=Z=>({wrapper:(0,U.css)({label:"Wrapper",display:"flex",alignItems:"center",marginLeft:Z.spacing(.5),overflow:"hidden"}),queryNameWrapper:(0,U.css)({display:"flex",cursor:"pointer",border:"1px solid transparent",borderRadius:Z.shape.radius.default,alignItems:"center",padding:Z.spacing(0,0,0,.5),margin:0,background:"transparent",overflow:"hidden","&:hover":{background:Z.colors.action.hover,border:`1px dashed ${Z.colors.border.strong}`},"&:focus":{border:`2px solid ${Z.colors.primary.border}`},"&:hover, &:focus":{".query-name-edit-icon":{visibility:"visible"}}}),queryName:(0,U.css)({fontWeight:Z.typography.fontWeightMedium,color:Z.colors.primary.text,cursor:"pointer",overflow:"hidden",marginLeft:Z.spacing(.5)}),queryEditIcon:(0,U.cx)((0,U.css)({marginLeft:Z.spacing(2),visibility:"hidden"}),"query-name-edit-icon"),queryNameInput:(0,U.css)({maxWidth:"300px",margin:"-4px 0"}),collapsedText:(0,U.css)({fontWeight:Z.typography.fontWeightRegular,fontSize:Z.typography.bodySmall.fontSize,color:Z.colors.text.secondary,paddingLeft:Z.spacing(1),alignItems:"center",overflow:"hidden",fontStyle:"italic",whiteSpace:"nowrap",textOverflow:"ellipsis"}),contextInfo:(0,U.css)({fontSize:Z.typography.bodySmall.fontSize,fontStyle:"italic",color:Z.colors.text.secondary,paddingLeft:"10px",paddingRight:"10px"}),itemWrapper:(0,U.css)({display:"flex",marginLeft:"4px"})});var N=e(76874);class V extends o.PureComponent{constructor(){super(...arguments),this.dataSourceSrv=(0,m.l)(),this.id="",this.state={datasource:null,data:void 0,isOpen:!0,showingHelp:!1},this.renderPluginEditor=()=>{const{query:Y,onChange:X,queries:I,onRunQuery:J,onAddQuery:ee,range:q,app:ne=l.Jk.PanelEditor,history:se}=this.props,{datasource:oe,data:de}=this.state;if(this.isWaitingForDatasourceToLoad())return null;if(oe){let fe=this.getQueryEditor(oe);if(fe)return(0,n.jsx)(g.p,{instanceSettings:this.props.dataSource,children:(0,n.jsx)(fe,{query:Y,datasource:oe,onChange:X,onRunQuery:J,onAddQuery:ee,data:de,range:q,queries:I,app:ne,history:se},oe?.name)})}return(0,n.jsx)("div",{children:(0,n.jsx)(v.x6,{i18nKey:"query-operation.query-editor-not-exported",children:"Data source plugin does not export any Query Editor component"})})},this.onRemoveQuery=()=>{const{onRemoveQuery:Y,query:X,onQueryRemoved:I}=this.props;Y(X),I&&I()},this.onCopyQuery=()=>{const{query:Y,onAddQuery:X,onQueryCopied:I}=this.props,J=(0,i.cloneDeep)(Y);X(J),I&&I()},this.onHideQuery=()=>{const{query:Y,onChange:X,onRunQuery:I,onQueryToggled:J}=this.props;X({...Y,hide:!Y.hide}),I(),J&&J(Y.hide),(0,y.rR)("query_editor_row_hide_query_clicked",{hide:!Y.hide})},this.onToggleHelp=()=>{this.setState(Y=>({showingHelp:!Y.showingHelp}))},this.onClickExample=Y=>{Y.datasource===void 0&&(Y.datasource=(0,f.p$)(this.props.dataSource)),this.props.onChange({...Y,refId:this.props.query.refId}),this.onToggleHelp()},this.renderWarnings=Y=>{const{data:X,query:I}=this.props,ee=(z(X,I.refId)?.series??[]).reduce((ce,ie)=>{if(!ie.meta?.notices)return ce;const ve=(0,i.filter)(ie.meta.notices,le=>le.severity===Y)??[];return ce.concat(ve)},[]),q=(0,i.uniqBy)(ee,"text");if(!(q.length>0))return null;const se="query-"+Y+"s",oe=Y==="warning"?"orange":"blue",de=Y==="warning"?"exclamation-triangle":"file-landscape-alt",fe=q.map(ce=>ce.text),ae=(0,n.jsx)(E.B,{items:fe,renderItem:ce=>(0,n.jsx)(n.Fragment,{children:ce})});return(0,n.jsx)(b.E,{color:oe,icon:de,text:(0,n.jsxs)(n.Fragment,{children:[q.length," ",u()(Y,q.length)]}),tooltip:ae},se)},this.renderExtraActions=()=>{const{query:Y,queries:X,data:I,onAddQuery:J,dataSource:ee,app:q}=this.props,ne=j.d.getAllExtraRenderAction();let se=[];q!==void 0&&(se=j.d.getScopedExtraRenderAction(q));const oe=[...ne,...se].map((de,fe)=>de({query:Y,queries:X,timeRange:I.timeRange,onAddQuery:J,dataSource:ee,key:fe})).filter(Boolean);return oe.push(this.renderWarnings("info")),oe.push(this.renderWarnings("warning")),oe.push((0,n.jsx)(Q,{query:Y},"adaptive-telemetry-actions")),oe},this.renderActions=Y=>{const{query:X,hideHideQueryButton:I=!1,onReplace:J,onQueryReplacedFromLibrary:ee}=this.props,{datasource:q,showingHelp:ne}=this.state,se=!!X.hide,oe=q?.components?.QueryEditorHelp;return(0,n.jsxs)(n.Fragment,{children:[oe&&(0,n.jsx)(P.A,{title:(0,v.t)("query-operation.header.datasource-help","Show data source help"),icon:"question-circle",onClick:this.onToggleHelp,active:ne}),this.renderExtraActions(),(0,n.jsx)(w,{query:X}),(0,n.jsx)(P.q,{title:(0,v.t)("query-operation.header.duplicate-query","Duplicate query"),icon:"copy",onClick:this.onCopyQuery}),(0,n.jsx)(H,{datasourceFilters:q?.name?[q.name]:[],onSelectQuery:de=>{ee?.(),J?.(de)}}),I?null:(0,n.jsx)(P.A,{dataTestId:x.Tp.components.QueryEditorRow.actionButton("Hide response"),title:X.hide?(0,v.t)("query-operation.header.show-response","Show response"):(0,v.t)("query-operation.header.hide-response","Hide response"),icon:se?"eye-slash":"eye",active:se,onClick:this.onHideQuery}),(0,n.jsx)(P.q,{title:(0,v.t)("query-operation.header.remove-query","Remove query"),icon:"trash-alt",onClick:this.onRemoveQuery})]})},this.renderHeader=Y=>{const{app:X,query:I,dataSource:J,onChangeDataSource:ee,onChange:q,queries:ne,renderHeaderExtras:se,hideRefId:oe}=this.props;return(0,n.jsx)(T,{query:I,queries:ne,onChangeDataSource:ee,dataSource:J,hidden:I.hide,onChange:q,collapsedText:Y.isOpen?null:this.renderCollapsedText(),renderExtras:se,alerting:X===l.Jk.UnifiedAlerting,hideRefId:oe})}}componentDidMount(){const{data:Y,query:X,id:I}=this.props,J=z(Y,X.refId);this.id=(0,i.uniqueId)(I+"_"),this.setState({data:J}),this.loadDatasource()}getInterpolatedDataSourceUID(){if(this.props.query.datasource){const Y=this.dataSourceSrv.getInstanceSettings(this.props.query.datasource);return Y?.rawRef?.uid??Y?.uid}return this.props.dataSource.rawRef?.uid??this.props.dataSource.uid}async loadDatasource(){let Y;const X=this.getInterpolatedDataSourceUID();try{Y=await this.dataSourceSrv.get(X)}catch{Y=await this.dataSourceSrv.get()}typeof this.props.onDataSourceLoaded=="function"&&this.props.onDataSourceLoaded(Y),this.setState({datasource:Y,queriedDataSourceIdentifier:X})}componentDidUpdate(Y){const{datasource:X,queriedDataSourceIdentifier:I}=this.state,{data:J,query:ee}=this.props;if(Y.id!==this.props.id&&(this.id=(0,i.uniqueId)(this.props.id+"_")),J!==Y.data){const q=z(J,ee.refId);this.setState({data:q})}if(X&&I!==this.getInterpolatedDataSourceUID()){this.loadDatasource();return}}getQueryEditor(Y){if(Y)switch(this.props.app){case l.Jk.Explore:return Y.components?.ExploreMetricsQueryField||Y.components?.ExploreLogsQueryField||Y.components?.ExploreQueryField||Y.components?.QueryEditor;case l.Jk.PanelEditor:case l.Jk.Dashboard:default:return Y.components?.QueryEditor}}isWaitingForDatasourceToLoad(){return this.getInterpolatedDataSourceUID()!==this.state.queriedDataSourceIdentifier}renderCollapsedText(){const{datasource:Y}=this.state;return Y?.getQueryDisplayText?Y.getQueryDisplayText(this.props.query):null}render(){const{query:Y,index:X,visualization:I,collapsable:J,hideActionButtons:ee}=this.props,{datasource:q,showingHelp:ne,data:se}=this.state,oe=Y.hide,de=se?.error&&se.error.refId===Y.refId?se.error:se?.errors?.find(ie=>ie.refId===Y.refId),fe=s()("query-editor-row",{"query-editor-row--disabled":oe,"gf-form-disabled":oe});if(!q)return null;const ae=this.renderPluginEditor(),ce=q.components?.QueryEditorHelp;return(0,n.jsx)("div",{"data-testid":"query-editor-row","aria-label":x.Tp.components.QueryEditorRows.rows,children:(0,n.jsx)(M.u,{id:this.id,draggable:!ee,collapsable:J,index:X,headerElement:this.renderHeader,actions:ee?void 0:this.renderActions,children:(0,n.jsxs)("div",{className:fe,id:this.id,children:[(0,n.jsxs)(D.Xw,{children:[ne&&ce&&(0,n.jsx)(C.j,{children:(0,n.jsx)(ce,{onClickExample:ie=>this.onClickExample(ie),query:this.props.query,datasource:q})}),ae]}),de&&(0,n.jsx)(N.x,{error:de}),I]})})})}}function z(Z,Y){const X=Z.series.filter(q=>q.refId===Y);if(Z.state!==p.Gu.Loading&&(Z.error||Z.errors?.length)&&!Z.series.length)return{...Z,state:p.Gu.Error};let I=Z.state,J=Z.errors?.find(q=>q.refId===Y);!J&&Z.error&&(J=Z.error.refId===Y?Z.error:void 0),I!==p.Gu.Loading&&(J?I=p.Gu.Error:Z.state===p.Gu.Error&&(I=p.Gu.Done));const ee=Z.timeRange;return{...Z,state:I,series:X,error:J,errors:J?[J]:void 0,timeRange:ee}}function w(Z){const{renderSaveQueryButton:Y}=(0,O.Y)();return Y(Z.query)}function H({datasourceFilters:Z,onSelectQuery:Y}){const{openDrawer:X,queryLibraryEnabled:I}=(0,O.Y)(),J=()=>{X(Z,Y,{isReplacingQuery:!0})};return I?(0,n.jsx)(P.q,{title:(0,v.t)("query-operation.header.replace-query-from-library","Replace with query from library"),icon:"book",onClick:J}):null}function Q({query:Z}){try{const{isLoading:Y,components:X}=(0,h.f)({extensionPointId:c.S.QueryEditorRowAdaptiveTelemetryV1});return Y||!X.length?null:(0,d.RC)({props:{query:Z,contextHints:["queryeditorrow","header"]},components:X,limit:1,pluginId:/grafana-adaptive.*/})}catch{return null}}},65966:(te,R,e)=>{"use strict";e.d(R,{L:()=>f});var n=e(74848),a=e(89332),s=e(96540),i=e(48480),r=e(27489),u=e(78282),o=e(75421),l=e(18615),g=e(67042);class f extends s.PureComponent{constructor(){super(...arguments),this.onRemoveQuery=x=>{this.props.onQueriesChange(this.props.queries.filter(v=>v!==x))},this.onDragStart=x=>{const{queries:v,dsSettings:m}=this.props;(0,r.rR)("query_row_reorder_started",{startIndex:x.source.index,numberOfQueries:v.length,datasourceType:m.type})},this.onDragEnd=x=>{const{queries:v,onQueriesChange:m,dsSettings:y}=this.props;if(!x||!x.destination)return;const h=x.source.index,d=x.destination.index;if(h===d){(0,r.rR)("query_row_reorder_canceled",{startIndex:h,endIndex:d,numberOfQueries:v.length,datasourceType:y.type});return}const E=Array.from(v),[b]=E.splice(h,1);E.splice(d,0,b),m(E),(0,r.rR)("query_row_reorder_ended",{startIndex:h,endIndex:d,numberOfQueries:v.length,datasourceType:y.type})}}onChangeQuery(x,v){const{queries:m,onQueriesChange:y}=this.props;y(m.map((h,d)=>d===v?x:h))}onReplaceQuery(x,v){const{queries:m,onQueriesChange:y,onUpdateDatasources:h,dsSettings:d}=this.props,E=m.map((b,D)=>D===v?x:b);if(y(E),x.datasource?.uid){const C={uid:new Set(E.map(M=>M.datasource?.uid)).size>1?l.uv:x.datasource.uid};d.uid!==C.uid&&h?.(C)}}onDataSourceChange(x,v){const{queries:m,onQueriesChange:y}=this.props;y(m.map((h,d)=>{if(d!==v)return h;const E=(0,i.p$)(x);return h.datasource&&(0,u.l)().getInstanceSettings(h.datasource)?.type===x.type?{...h,datasource:E}:{refId:h.refId,hide:h.hide,datasource:E}}))}render(){const{dsSettings:x,data:v,queries:m,app:y,history:h,eventBus:d,onAddQuery:E,onRunQueries:b,onQueryCopied:D,onQueryRemoved:C,onQueryToggled:P,onQueryReplacedFromLibrary:M,queryRowWrapper:O}=this.props;return(0,n.jsx)(a.JY,{onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,children:(0,n.jsx)(a.gL,{droppableId:"transformations-list",direction:"vertical",children:j=>(0,n.jsxs)("div",{"data-testid":"query-editor-rows",ref:j.innerRef,...j.droppableProps,children:[m.map((U,W)=>{const B=p(U,x),S=x.meta.mixed?K=>this.onDataSourceChange(K,W):void 0,_=(0,n.jsx)(g.c,{id:U.refId,index:W,data:v,query:U,dataSource:B,onChangeDataSource:S,onChange:K=>this.onChangeQuery(K,W),onReplace:K=>this.onReplaceQuery(K,W),onRemoveQuery:this.onRemoveQuery,onAddQuery:E,onRunQuery:b,onQueryCopied:D,onQueryRemoved:C,onQueryToggled:P,onQueryReplacedFromLibrary:M,queries:m,app:y,range:(0,o.jG)().timeRange(),history:h,eventBus:d},U.refId);return O?O(_,U.refId):_}),j.placeholder]})})})}}const p=(c,x)=>c.datasource&&(0,u.l)().getInstanceSettings(c.datasource)||x},76874:(te,R,e)=>{"use strict";e.d(R,{x:()=>u});var n=e(74848),a=e(22803),s=e(92745),i=e(63142),r=e(30703);function u({error:l}){const g=(0,i.of)(o),f=l?.message??l?.data?.message??"Query error";return(0,n.jsxs)("div",{className:g.wrapper,children:[(0,n.jsx)("div",{className:g.icon,children:(0,n.jsx)(r.I,{name:"exclamation-triangle"})}),(0,n.jsxs)("div",{className:g.message,children:[f,l.traceId!=null&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("br",{})," ",(0,n.jsx)("span",{children:(0,n.jsxs)(s.x6,{i18nKey:"query.query-error-alert.trace-id",values:{traceId:l.traceId},children:["(Trace ID: ","{{traceId}}",")"]})})]})]})]})}const o=l=>({wrapper:(0,a.css)({marginTop:l.spacing(.5),background:l.colors.background.secondary,display:"flex"}),icon:(0,a.css)({background:l.colors.error.main,color:l.colors.error.contrastText,padding:l.spacing(1)}),message:(0,a.css)({fontSize:l.typography.bodySmall.fontSize,fontFamily:l.typography.fontFamilyMonospace,padding:l.spacing(1)})})},32154:(te,R,e)=>{"use strict";e.d(R,{g:()=>Y,K:()=>I});var n=e(74848),a=e(22803),s=e(96540),i=e(28105),r=e(22592),u=e(48480),o=e(1906),l=e(51898),g=e(92745),f=e(78282),p=e(36490),c=e(32881),x=e(45861),v=e(92807),m=e(22787),y=e(65240),h=e(51115),d=e(16817),E=e(67458),b=e(68143),D=e(6975);function C({pluginId:ee}){const{value:q,loading:ne,error:se}=(0,d.A)(async()=>(0,b.AI)().get(`/api/plugins/${ee}/markdown/query_help`),[]),oe=(0,E.G)(q);return ne?(0,n.jsx)(D._,{text:(0,g.t)("plugins.plugin-help.loading","Loading help...")}):se?(0,n.jsx)("h3",{children:(0,n.jsx)(g.x6,{i18nKey:"plugins.plugin-help.error",children:"An error occurred when loading help."})}):q===""?(0,n.jsx)("h3",{children:(0,n.jsx)(g.x6,{i18nKey:"plugins.plugin-help.not-found",children:"No query help could be found."})}):(0,n.jsx)("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:oe}})}var P=e(65642),M=e(83873),O=e(1404),j=e(41776),U=e(76792),W=e(29328),B=e(73601),S=e(57204),_=e(23117),K=e(65966),T=e(17548),L=e(63142),A=e(79233),N=e(63527),V=e(21285),z=e(85348);const w=s.memo(({options:ee,dataSource:q,data:ne,onChange:se})=>{const[oe,de]=(0,s.useState)(ee.timeRange?.from||""),[fe,ae]=(0,s.useState)(ee.timeRange?.shift||""),[ce,ie]=(0,s.useState)(ee.timeRange?.hide??!1),[ve,le]=(0,s.useState)(!1),[Ee,Re]=(0,s.useState)(!0),[Oe,Se]=(0,s.useState)(!0),Te=(0,L.of)(Z),_e=(0,s.useCallback)(ye=>{de(ye.target.value)},[]),He=(0,s.useCallback)(ye=>{ae(ye.target.value)},[]),tt=(0,s.useCallback)(ye=>{const De=Q(ye.target.value),Le=H(De);Le&&ee.timeRange?.from!==De&&se({...ee,timeRange:{...ee.timeRange??{},from:De}}),Re(Le)},[se,ee]),Je=(0,s.useCallback)(ye=>{const De=Q(ye.target.value),Le=H(De);Le&&ee.timeRange?.shift!==De&&se({...ee,timeRange:{...ee.timeRange??{},shift:De}}),Se(Le)},[se,ee]),Ge=(0,s.useCallback)(()=>{const ye=!ce;ie(ye),se({...ee,timeRange:{...ee.timeRange??{},hide:ye}})},[se,ee,ce]),je=(0,s.useCallback)(ye=>{se({...ee,cacheTimeout:Q(ye.target.value)})},[se,ee]),Fe=(0,s.useCallback)(ye=>{let De=parseInt(ye.target.value,10);(isNaN(De)||De===0)&&(De=null),se({...ee,queryCachingTTL:De})},[se,ee]),Be=(0,s.useCallback)(ye=>{let De=parseInt(ye.currentTarget.value,10);(isNaN(De)||De===0)&&(De=null),De!==ee.maxDataPoints&&se({...ee,maxDataPoints:De})},[se,ee]),Ke=(0,s.useCallback)(ye=>{const De=Q(ye.target.value);De!==ee.minInterval&&se({...ee,minInterval:De})},[se,ee]),Ue=(0,s.useCallback)(()=>{le(!0)},[]),we=(0,s.useCallback)(()=>{le(!1)},[]),Xe=()=>{const ye=`If your time series store has a query cache this option can override the default cache timeout. Specify a
    numeric value in seconds.`;return q.meta.queryOptions?.cacheTimeout?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(A.c,{tooltip:ye,htmlFor:"cache-timeout-id",children:(0,n.jsx)(g.x6,{i18nKey:"query.query-group-options-editor.render-cache-timeout-option.cache-timeout",children:"Cache timeout"})}),(0,n.jsx)(N.p,{id:"cache-timeout-id",type:"text",placeholder:"60",spellCheck:!1,onBlur:je,defaultValue:ee.cacheTimeout??""})]}):null},nt=()=>{const ye="Cache time-to-live: How long results from this queries in this panel will be cached, in milliseconds. Defaults to the TTL in the caching configuration for this datasource.";return q.cachingConfig?.enabled?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(A.c,{tooltip:ye,children:(0,n.jsx)(g.x6,{i18nKey:"query.query-group-options-editor.render-query-caching-ttloption.cache-ttl",children:"Cache TTL"})}),(0,n.jsx)(N.p,{type:"number",placeholder:`${q.cachingConfig.TTLMs}`,spellCheck:!1,onBlur:Fe,defaultValue:ee.queryCachingTTL??void 0})]}):null},he=()=>{const ye=ne.request?.maxDataPoints,De=ee.maxDataPoints??"",Le=De==="";return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(A.c,{htmlFor:"max-data-points-input",tooltip:(0,n.jsx)(g.x6,{i18nKey:"query.query-group-options-editor.render-max-data-points-option.max-data-points-tooltip",children:"The maximum data points per series. Used directly by some data sources and used in calculation of auto interval. With streaming data this value is used for the rolling buffer."}),children:(0,n.jsx)(g.x6,{i18nKey:"query.query-group-options-editor.render-max-data-points-option.max-data-points",children:"Max data points"})}),(0,n.jsx)(N.p,{id:"max-data-points-input",type:"number",placeholder:`${ye}`,spellCheck:!1,onBlur:Be,defaultValue:De}),Le&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:(0,a.cx)(Te.noSquish,Te.operator),children:"="}),(0,n.jsx)("span",{className:(0,a.cx)(Te.noSquish,Te.left),children:(0,n.jsx)(g.x6,{i18nKey:"query.query-group-options-editor.render-max-data-points-option.width-of-panel",children:"Width of panel"})})]})]})},xe=()=>{const ye=ne.request?.interval,De=q.interval??"No limit";return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(A.c,{className:Te.firstColumn,tooltip:(0,n.jsxs)(g.x6,{i18nKey:"query.query-group-options-editor.render-interval-option.min-interval-tooltip",children:["A lower limit for the interval. Recommended to be set to write frequency, for example ",(0,n.jsx)("code",{children:"1m"})," if your data is written every minute. Default value can be set in data source settings for most data sources."]}),htmlFor:"min-interval-input",children:(0,n.jsx)(g.x6,{i18nKey:"query.query-group-options-editor.render-interval-option.min-interval",children:"Min interval"})}),(0,n.jsx)(N.p,{id:"min-interval-input",type:"text",placeholder:`${De}`,spellCheck:!1,onBlur:Ke,defaultValue:ee.minInterval??""}),(0,n.jsx)(A.c,{className:Te.firstColumn,tooltip:(0,n.jsxs)(g.x6,{i18nKey:"query.query-group-options-editor.render-interval-option.interval-tooltip",children:["The evaluated interval that is sent to data source and is used in ",(0,n.jsx)("code",{children:"$__interval"})," and"," ",(0,n.jsx)("code",{children:"$__interval_ms"}),". This value is not exactly equal to ",(0,n.jsx)("code",{children:"Time range / max data points"}),", it will approximate a series of magic number."]}),children:(0,n.jsx)(g.x6,{i18nKey:"query.query-group-options-editor.render-interval-option.interval",children:"Interval"})}),(0,n.jsx)("span",{className:Te.noSquish,children:ye}),(0,n.jsx)("span",{className:(0,a.cx)(Te.noSquish,Te.operator),children:"="}),(0,n.jsx)("span",{className:(0,a.cx)(Te.noSquish,Te.left),children:(0,n.jsx)(g.x6,{i18nKey:"query.query-group-options-editor.render-interval-option.time-range-max-data-points",children:"Time range / max data points"})})]})},me=()=>{if(ve)return;let ye=ee.maxDataPoints??"";ye===""&&ne.request&&(ye=`auto = ${ne.request.maxDataPoints}`);const De=ne.request?.interval??ee.minInterval;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:Te.collapsedText,children:(0,n.jsxs)(g.x6,{i18nKey:"query.query-group-options-editor.collapsed-max-data-points",children:["MD = ",{mdDesc:ye}]})}),(0,n.jsx)("span",{className:Te.collapsedText,children:(0,n.jsxs)(g.x6,{i18nKey:"query.query-group-options-editor.collapsed-interval",children:["Interval = ",{intervalDesc:De}]})})]})};return(0,n.jsx)(z.u,{id:"Query options",index:0,title:(0,g.t)("query.query-group-options-editor.Query options-title-query-options","Query options"),headerElement:me(),isOpen:ve,onOpen:Ue,onClose:we,children:(0,n.jsxs)("div",{className:Te.grid,children:[he(),xe(),Xe(),nt(),(0,n.jsx)(A.c,{htmlFor:"relative-time-input",tooltip:(0,n.jsxs)(g.x6,{i18nKey:"query.query-group-options-editor.relative-time-tooltip",values:{relativeFrom:"now-5m",relativeTo:"5m",variable:"$_relativeTime"},children:["Overrides the relative time range for individual panels, which causes them to be different than what is selected in the dashboard time picker in the top-right corner of the dashboard. For example to configure the Last 5 minutes the Relative time should be ",(0,n.jsx)("code",{children:"{{relativeFrom}}"})," and"," ",(0,n.jsx)("code",{children:"{{relativeTo}}"}),", or variables like ",(0,n.jsx)("code",{children:"{{variable}}"}),"."]}),children:(0,n.jsx)(g.x6,{i18nKey:"query.query-group-options-editor.relative-time",children:"Relative time"})}),(0,n.jsx)(N.p,{id:"relative-time-input",type:"text",placeholder:"1h",onChange:_e,onBlur:tt,invalid:!Ee,value:oe}),(0,n.jsx)(A.c,{htmlFor:"time-shift-input",className:Te.firstColumn,tooltip:(0,n.jsxs)(g.x6,{i18nKey:"query.query-group-options-editor.time-shift-tooltip",values:{relativeFrom:"now-1h",relativeTo:"1h",variable:"$_timeShift"},children:["Overrides the time range for individual panels by shifting its start and end relative to the time picker. For example to configure the Last 1h the Time shift should be ",(0,n.jsx)("code",{children:"{{relativeFrom}}"})," and"," ",(0,n.jsx)("code",{children:"{{relativeTo}}"}),", or variables like ",(0,n.jsx)("code",{children:"{{variable}}"}),"."]}),children:(0,n.jsx)(g.x6,{i18nKey:"query.query-group-options-editor.time-shift",children:"Time shift"})}),(0,n.jsx)(N.p,{id:"time-shift-input",type:"text",placeholder:"1h",onChange:He,onBlur:Je,invalid:!Oe,value:fe}),(fe||oe)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(A.c,{htmlFor:"hide-time-info-switch",className:Te.firstColumn,children:(0,n.jsx)(g.x6,{i18nKey:"query.query-group-options-editor.hide-time-info",children:"Hide time info"})}),(0,n.jsx)(V.K,{id:"hide-time-info-switch",className:Te.left,value:ce,onChange:Ge})]})]})})});w.displayName="QueryGroupOptionsEditor";function H(ee){return!ee||T.isValidTimeSpan(ee)}function Q(ee){return ee===""?null:ee}function Z(ee){return{grid:(0,a.css)({display:"grid",gridTemplateColumns:"auto minmax(5em, 1fr) auto 1fr",gap:ee.spacing(.5),gridAutoRows:ee.spacing(4),whiteSpace:"nowrap"}),firstColumn:(0,a.css)({gridColumn:1}),collapsedText:(0,a.css)({marginLeft:ee.spacing(2),fontSize:ee.typography.size.sm,color:ee.colors.text.secondary}),noSquish:(0,a.css)({display:"flex",alignItems:"center",padding:ee.spacing(0,1),fontWeight:ee.typography.fontWeightMedium,fontSize:ee.typography.size.sm,backgroundColor:ee.colors.background.secondary,borderRadius:ee.shape.radius.default}),left:(0,a.css)({justifySelf:"left"}),operator:(0,a.css)({color:ee.v1.palette.orange})}}class Y extends s.PureComponent{constructor(){super(...arguments),this.backendSrv=M.IB,this.dataSourceSrv=(0,f.l)(),this.querySubscription=null,this.state={isDataSourceModalOpen:!!p.Ny.getSearchObject().firstPanel,isLoadingHelp:!1,helpContent:null,isPickerOpen:!1,isHelpOpen:!1,queries:[],data:{state:i.Gu.NotStarted,series:[],timeRange:(0,r.E2)()}},this.onChangeDataSource=async(q,ne)=>{const{dsSettings:se}=this.state,oe=se?await(0,f.l)().get(se.uid):void 0,de=await(0,f.l)().get(q.uid),fe=ne||await(0,S.y)(de,q.uid,this.state.queries,oe),ae=await this.dataSourceSrv.get(q.name);this.onChange({queries:fe,dataSource:{name:q.name,uid:q.uid,...(0,u.p$)(q)}}),this.setState({queries:fe,dataSource:ae,dsSettings:q}),ne&&this.props.onRunQueries()},this.onAddQueryClick=()=>{const{queries:q}=this.state;this.onQueriesChange((0,O.U7)(q,this.newQuery())),this.onScrollBottom()},this.onAddExpressionClick=()=>{this.onQueriesChange((0,O.U7)(this.state.queries,W.Ex.newQuery())),this.onScrollBottom()},this.onScrollBottom=()=>{setTimeout(()=>{this.state.scrollElement&&this.state.scrollElement.scrollTo({top:1e4})},20)},this.onUpdateAndRun=q=>{this.props.onOptionsChange(q),this.props.onRunQueries()},this.onOpenHelp=()=>{this.setState({isHelpOpen:!0})},this.onCloseHelp=()=>{this.setState({isHelpOpen:!1})},this.onCloseDataSourceModal=()=>{this.setState({isDataSourceModalOpen:!1})},this.onAddQuery=q=>{const{dsSettings:ne,queries:se}=this.state;this.onQueriesChange((0,O.U7)(se,q,ne?(0,u.p$)(ne):{type:void 0,uid:void 0})),this.onScrollBottom()},this.onQueriesChange=q=>{this.onChange({queries:q}),this.setState({queries:q})},this.setScrollRef=q=>{this.setState({scrollElement:q})}}async componentDidMount(){const{options:q,queryRunner:ne}=this.props;this.querySubscription=ne.getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:se=>this.onPanelDataUpdate(se)}),this.setNewQueriesAndDatasource(q)}componentWillUnmount(){this.querySubscription&&(this.querySubscription.unsubscribe(),this.querySubscription=null)}async componentDidUpdate(){const{options:q}=this.props,ne=await(0,f.l)().get(q.dataSource);this.state.dataSource&&ne.uid!==this.state.dataSource?.uid&&this.setNewQueriesAndDatasource(q)}async setNewQueriesAndDatasource(q){try{const ne=await this.dataSourceSrv.get(q.dataSource),se=this.dataSourceSrv.getInstanceSettings(q.dataSource),oe=await this.dataSourceSrv.get(),de=ne.getRef(),fe=q.queries.map(ae=>({...(0,O.Ih)(ae)&&ne?.getDefaultQuery?.(o.Jk.PanelEditor),datasource:de,...ae}));this.setState({queries:fe,dataSource:ne,dsSettings:se,defaultDataSource:oe})}catch(ne){console.error("failed to load data source",ne)}}onPanelDataUpdate(q){this.setState({data:q})}newQuery(){const{dsSettings:q,defaultDataSource:ne}=this.state,se=q&&!q.meta.mixed?(0,u.p$)(q):ne?ne.getRef():{type:void 0,uid:void 0};return{...this.state.dataSource?.getDefaultQuery?.(o.Jk.PanelEditor),datasource:se}}onChange(q){this.props.onOptionsChange({...this.props.options,...q})}renderTopSection(q){const{onOpenQueryInspector:ne,options:se}=this.props,{dataSource:oe,data:de,dsSettings:fe}=this.state;return!fe||!oe?null:(0,n.jsx)(I,{data:de,dataSource:oe,options:se,dsSettings:fe,onOptionsChange:this.onUpdateAndRun,onDataSourceChange:this.onChangeDataSource,onOpenQueryInspector:ne})}renderQueries(q){const{onRunQueries:ne}=this.props,{data:se,queries:oe}=this.state;return(0,n.jsx)("div",{"aria-label":l.Tp.components.QueryTab.content,children:(0,n.jsx)(K.L,{queries:oe,dsSettings:q,onQueriesChange:this.onQueriesChange,onAddQuery:this.onAddQuery,onRunQueries:ne,data:se})})}isExpressionsSupported(q){return(q.meta.backend||q.meta.alerting||q.meta.mixed)===!0}renderExtraActions(){return _.m.getAllExtraRenderAction().map((q,ne)=>q({onAddQuery:this.onAddQuery,onChangeDataSource:this.onChangeDataSource,key:ne})).filter(Boolean)}renderAddQueryRow(q,ne){const se=!(0,B.k)(q.name);return(0,n.jsxs)(c.Gy,{spacing:"md",align:"flex-start",children:[se&&(0,n.jsx)(x.$n,{icon:"plus",onClick:this.onAddQueryClick,variant:"secondary","data-testid":l.Tp.components.QueryTab.addQuery,children:(0,n.jsx)(g.x6,{i18nKey:"query.query-group.add-query",children:"Add query"})}),P.Ay.expressionsEnabled&&this.isExpressionsSupported(q)&&(0,n.jsx)(x.$n,{icon:"plus",onClick:this.onAddExpressionClick,variant:"secondary",className:ne.expressionButton,"data-testid":"query-tab-add-expression",children:(0,n.jsx)("span",{children:(0,n.jsx)(g.x6,{i18nKey:"query.query-group.expression",children:"Expression"})})}),this.renderExtraActions()]})}render(){const{isHelpOpen:q,dsSettings:ne}=this.state,se=X();return(0,n.jsx)(v.P,{minHeight:"100%",ref:this.setScrollRef,children:(0,n.jsxs)("div",{className:se.innerWrapper,children:[this.renderTopSection(se),ne&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:se.queriesWrapper,children:this.renderQueries(ne)}),this.renderAddQueryRow(ne,se),q&&(0,n.jsx)(m.a,{title:(0,g.t)("query.query-group.title-data-source-help","Data source help"),isOpen:!0,onDismiss:this.onCloseHelp,children:(0,n.jsx)(C,{pluginId:ne.meta.id})})]})]})})}}const X=(0,y.N)(()=>{const{theme:ee}=P.Ay;return{innerWrapper:(0,a.css)({display:"flex",flexDirection:"column",padding:ee.spacing.md}),dataSourceRow:(0,a.css)({display:"flex",marginBottom:ee.spacing.md}),dataSourceRowItem:(0,a.css)({marginRight:ee.spacing.inlineFormMargin}),dataSourceRowItemOptions:(0,a.css)({flexGrow:1,marginRight:ee.spacing.inlineFormMargin}),queriesWrapper:(0,a.css)({paddingBottom:"16px"}),expressionWrapper:(0,a.css)({}),expressionButton:(0,a.css)({marginRight:ee.spacing.sm})}});function I({dataSource:ee,options:q,data:ne,dsSettings:se,onDataSourceChange:oe,onOptionsChange:de,onOpenQueryInspector:fe}){const ae=X(),[ce,ie]=(0,s.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{"data-testid":l.Tp.components.QueryTab.queryGroupTopSection,children:(0,n.jsxs)("div",{className:ae.dataSourceRow,children:[(0,n.jsx)(h.I,{htmlFor:"data-source-picker",width:"auto",children:(0,n.jsx)(g.x6,{i18nKey:"query.query-group-top-section.data-source",children:"Data source"})}),(0,n.jsx)("div",{className:ae.dataSourceRowItem,children:(0,n.jsx)(J,{options:q,onChange:async(ve,le)=>await oe?.(ve,le),isDataSourceModalOpen:!!p.Ny.getSearchObject().firstPanel})}),ee&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:ae.dataSourceRowItem,children:(0,n.jsx)(x.$n,{variant:"secondary",icon:"question-circle",title:(0,g.t)("query.query-group-top-section.query-tab-help-button-title-open-data-source-help","Open data source help"),onClick:()=>ie(!0),"data-testid":"query-tab-help-button"})}),(0,n.jsx)("div",{className:ae.dataSourceRowItemOptions,children:(0,n.jsx)(w,{options:q,dataSource:ee,data:ne,onChange:ve=>{de?.(ve)}})}),fe&&(0,n.jsx)("div",{className:ae.dataSourceRowItem,children:(0,n.jsx)(x.$n,{variant:"secondary",onClick:fe,"aria-label":l.Tp.components.QueryTab.queryInspectorButton,children:(0,n.jsx)(g.x6,{i18nKey:"query.query-group-top-section.query-inspector",children:"Query inspector"})})})]})]})}),ce&&(0,n.jsx)(m.a,{title:(0,g.t)("query.query-group-top-section.title-data-source-help","Data source help"),isOpen:!0,onDismiss:()=>ie(!1),children:(0,n.jsx)(C,{pluginId:se.meta.id})})]})}function J({options:ee,onChange:q,...ne}){const[se,oe]=(0,s.useState)(!!ne.isDataSourceModalOpen);(0,s.useEffect)(()=>{p.Ny.getSearchObject().firstPanel&&p.Ny.partial({firstPanel:null},!0)},[]);const de={metrics:!0,mixed:!0,dashboard:!0,variables:!0,current:ee.dataSource,uploadFile:!0,onChange:async(fe,ae)=>{await q(fe,ae),oe(!1)}};return(0,n.jsxs)(n.Fragment,{children:[se&&(0,n.jsx)(j.p,{...de,onDismiss:()=>oe(!1)}),(0,n.jsx)(U.s,{...de})]})}},32380:(te,R,e)=>{"use strict";e.d(R,{nm:()=>oe,Dh:()=>q});var n=e(39741),a=e(13752),s=e(64423),i=e(44240),r=e(39697),u=e(81160),o=e(67791),l=e(93031),g=e(71030),f=e(69850),p=e(1005),c=e(65961),x=e(75234),v=e(2543);function m(de){let fe=[];const ae=(0,v.partition)(de,"id"),ce=(0,v.groupBy)(ae[0],"id");return fe=(0,v.map)(ce,ie=>ie.length>1&&!(0,v.every)(ie,y)?(0,v.find)(ie,ve=>ve.eventType!=="panel-alert"):(0,v.head)(ie)),fe=(0,v.concat)(fe,ae[1]),fe}function y(de){return de.eventType==="panel-alert"}var h=e(75421),d=e(62467),E=e(65474),b=e(66847),D=e(69862),C=e(16126),P=e(43173),M=e(78282),O=e(42942),j=e(87745),U=e(87033),W=e(92511);class B{canRun(fe){return fe?!!(!fe.annotationQuery||fe.annotations):!1}run({annotation:fe,datasource:ae,dashboard:ce,range:ie}){if(!this.canRun(ae))return(0,d.of)([]);const ve={};return(0,U.b)({dashboard:ce,range:ie,panel:ve},ae,fe).pipe((0,u.T)(le=>le.events??[]),(0,b.W)(W.SD))}}var S=e(90696);class _{canRun(fe){return fe?(0,S.E7)(fe)?!0:!!(fe.annotationQuery&&!fe.annotations):!1}run({annotation:fe,datasource:ae,dashboard:ce,range:ie}){if(!this.canRun(ae))return(0,d.of)([]);if(ae?.annotationQuery===void 0)return console.warn("datasource does not have an annotation query"),(0,d.of)([]);const ve=ae.annotationQuery({range:ie,rangeRaw:ie.raw,annotation:fe,dashboard:ce});return ve===void 0?(console.warn("datasource does not have an annotation query"),(0,d.of)([])):(0,E.H)(ve).pipe((0,b.W)(W.SD))}}class K{constructor(fe=[new _,new B]){this.runners=fe}canWork({dashboard:fe}){return!!fe.annotations.list.find(K.getAnnotationsToProcessFilter)}work(fe){if(!this.canWork(fe))return(0,W.$)();const{dashboard:ae,range:ce}=fe;let ie=ae.annotations.list.filter(K.getAnnotationsToProcessFilter);P.$.publicDashboardAccessToken&&ie.length>0&&(ie=[ie[0]]);const ve=ie.map(le=>{let Ee;if(P.$.publicDashboardAccessToken){const Re=new O.X;Ee=(0,d.of)(Re).pipe((0,b.W)(W.H0))}else Ee=(0,E.H)((0,M.l)().get(le.datasource)).pipe((0,b.W)(W.H0));return Ee.pipe((0,D.Z)(Re=>{const Oe=this.runners.find(Se=>Se.canRun(Re));return Oe?(ae.events.publish(new j.xc(le)),Oe.run({annotation:le,datasource:Re,dashboard:ae,range:ce}).pipe((0,o.Q)(q().cancellations().pipe((0,C.p)(Se=>Se===le))),(0,u.T)(Se=>(ae.snapshot&&(le.snapshotData=(0,v.cloneDeep)(Se)),P.$.publicDashboardAccessToken?Se:(0,W.G9)(le,Se))),(0,f.j)(()=>{ae.events.publish(new j.yj(le))}))):(0,d.of)([])}))});return(0,i.h)(ve).pipe((0,l.U)(),(0,g.T)((le,Ee)=>le.concat(Ee)),(0,u.T)(le=>({annotations:le,alertStates:[]})))}static getAnnotationsToProcessFilter(fe){return fe.enable&&!fe.snapshotData}}var T=e(18030),L=e(76190),A=e(15130),N=e(70327),V=e(78467),z=e(95443),w=e(52161),H=e(29609),Q=e(7498),Z=e(8535),Y=e(11257);class X{constructor(){this.hasAlertRules={}}canWork({dashboard:fe,range:ae}){return!(!fe.uid||P.$.publicDashboardAccessToken||ae.raw.to!=="now"||this.hasAlertRules[fe.uid]===!1||!(A.TP.hasPermission(Y.w.AlertingRuleRead)&&A.TP.hasPermission(Y.w.AlertingRuleExternalRead)))}work(fe){if(!this.canWork(fe))return(0,W.$)();const{dashboard:ae}=fe,ce=async()=>(await(0,Z.JD)(N.hK.endpoints.prometheusRuleNamespaces.initiate({ruleSourceName:w.hY,dashboardUid:ae.uid},{forceRefetch:!0}))).data;return(0,E.H)(ce()).pipe((0,u.T)(ve=>(0,V.Kw)(ve))).pipe((0,u.T)(ve=>{this.hasAlertRules[ae.uid]=!1;const le={};return ve.forEach(Ee=>Ee.rules.forEach(Re=>{if(H.R$.alertingRule(Re)&&Re.annotations&&Re.annotations[z.YH.panelID]){this.hasAlertRules[ae.uid]=!0;const Oe=Number(Re.annotations[z.YH.panelID]),Se=(0,Q.S)(Re.state);le[Oe]?Se===L.O.Alerting&&le[Oe].state!==L.O.Alerting?le[Oe].state=L.O.Alerting:Se===L.O.Pending&&le[Oe].state!==L.O.Alerting&&le[Oe].state!==L.O.Pending&&(le[Oe].state=L.O.Pending):le[Oe]={state:Se,id:Object.keys(le).length,panelId:Oe,dashboardId:ae.id}}})),{alertStates:Object.values(le),annotations:[]}}),(0,b.W)(W.Zr))}}class I{constructor(fe,ae=(0,h.jG)(),ce=[new X,new T.F,new K]){this.dashboard=fe,this.timeSrv=ae,this.workers=ce,this.run=this.run.bind(this),this.getResult=this.getResult.bind(this),this.cancel=this.cancel.bind(this),this.destroy=this.destroy.bind(this),this.executeRun=this.executeRun.bind(this),this.results=new n.m(1),this.runs=new a.B,this.cancellationStream=new a.B,this.runsSubscription=this.runs.subscribe(ie=>this.executeRun(ie)),this.eventsSubscription=fe.events.subscribe(x._,ie=>{this.run({dashboard:this.dashboard,range:this.timeSrv.timeRange()})})}run(fe){this.runs.next(fe)}getResult(fe){return this.results.asObservable().pipe((0,u.T)(ae=>{const ce=(0,W.FK)(ae.annotations,fe),ie=ae.alertStates.find(ve=>!!fe&&ve.panelId===fe);return{annotations:m(ce),alertState:ie}}))}executeRun(fe){const ce=this.workers.filter(Re=>Re.canWork(fe)).map(Re=>Re.work(fe)),ie=new s.yU,ve=(0,i.h)(ce).pipe((0,o.Q)(this.runs.asObservable()),(0,l.U)(),(0,g.T)((Re,Oe)=>(Re.annotations=Re.annotations.concat(Oe.annotations),Re.alertStates=Re.alertStates.concat(Oe.alertStates),Re)),(0,f.j)(()=>{ie.unsubscribe()}),(0,p.u)()),le=new s.yU,Ee=(0,r.O)(200).pipe((0,c.u)({annotations:[],alertStates:[]}),(0,o.Q)(ve),(0,f.j)(()=>{le.unsubscribe()}));le.add(Ee.subscribe(Re=>{this.results.next(Re)})),ie.add(ve.subscribe(Re=>{this.results.next(Re)}))}cancel(fe){this.cancellationStream.next(fe)}cancellations(){return this.cancellationStream.asObservable().pipe((0,p.u)())}destroy(){this.results.complete(),this.runs.complete(),this.cancellationStream.complete(),this.runsSubscription.unsubscribe(),this.eventsSubscription.unsubscribe()}}let J;function ee(de){J&&J.destroy(),J=de}function q(){if(!J)throw new Error("getDashboardQueryRunner can only be used after Grafana instance has started.");return J}let ne;function se(de){ne=de}function oe(de){ne||(ne=({dashboard:ae,timeSrv:ce,workers:ie})=>new I(ae,ce,ie));const fe=ne(de);return ee(fe),fe}},42942:(te,R,e)=>{"use strict";e.d(R,{X:()=>f});var n=e(62467),a=e(65474),s=e(94644),i=e(41119),r=e(68143),u=e(43173),o=e(52161),l=e(8095);const g="-- Public --";class f extends s.mA{constructor(){let c={};super({name:"public-ds",id:0,type:"public-ds",meta:c,uid:g,jsonData:{},access:"proxy",readOnly:!0}),this.annotations={prepareQuery(x){return{...x,queryType:l.nj.Annotations,refId:"anno"}}}}query(c){return c.targets.length?c.targets[0]?.datasource?.uid===o.vv?(0,a.H)(this.getAnnotations(c)):(0,n.of)({data:[]}):(0,n.of)({data:[]})}async getAnnotations(c){const{range:{to:x,from:v}}=c,m={from:v.valueOf(),to:x.valueOf()},y=await(0,r.AI)().get(`/api/public/dashboards/${u.$.publicDashboardAccessToken}/annotations`,m);return{data:[(0,i.Vc)(y)]}}testDatasource(){return Promise.resolve({message:"",status:""})}}},18030:(te,R,e)=>{"use strict";e.d(R,{F:()=>s});var n=e(62467),a=e(92511);class s{canWork({dashboard:r}){return r?.annotations?.list?.some(u=>u.enable&&!!u.snapshotData)}work(r){if(!this.canWork(r))return(0,a.$)();const u=this.getAnnotationsFromSnapshot(r.dashboard);return(0,n.of)({annotations:u,alertStates:[]})}getAnnotationsFromSnapshot(r){return(r?.annotations?.list?.filter(g=>g.enable)).filter(g=>!!g.snapshotData).reduce((g,f)=>g.concat((0,a.G9)(f,f.snapshotData)),[])}getAnnotationsInSnapshot(r,u){const o=this.getAnnotationsFromSnapshot(r);return(0,a.FK)(o,u)}}},92511:(te,R,e)=>{"use strict";e.d(R,{$:()=>p,FK:()=>v,G9:()=>m,H0:()=>f,SD:()=>g,Zr:()=>c});var n=e(2543),a=e.n(n),s=e(62467),i=e(97534),r=e(43173),u=e(8535),o=e(64762),l=e(12066);function g(h){return h.cancelled?(0,s.of)([]):(x("AnnotationQueryRunner failed",h),(0,s.of)([]))}function f(h){return x("Failed to retrieve datasource",h),(0,s.of)(void 0)}const p=()=>(0,s.of)({annotations:[],alertStates:[]});function c(h){return h.cancelled||x("DashboardQueryRunner failed",h),p()}function x(h,d){const E=(0,i.u)(d);console.error("handleAnnotationQueryRunnerError",E);const b=(0,o.gi)(h,E.message);(0,u.JD)((0,l.dx)(b))}function v(h,d){return d==null?h:h.filter(E=>{let b;if(b=E.source,!b)return!0;if(b.filter){const D=(b.filter.ids??[]).includes(d);if(b.filter.exclude){if(D)return!1}else if(!D)return!1}return E.panelId&&E.source.type==="dashboard"?E.panelId===d:!0})}function m(h,d){h.snapshotData&&(h=(0,n.cloneDeep)(h),delete h.snapshotData);for(const E of d)switch(E.source=h,E.color=r.$.theme2.visualization.getColorByName(h.iconColor),E.type=h.name,E.isRegion=!!(E.timeEnd&&E.time!==E.timeEnd),E.newState?.toLowerCase()){case"pending":E.color="yellow";break;case"alerting":E.color="red";break;case"ok":E.color="green";break;case"normal":E.color="green";break;case"no_data":E.color="gray";break;case"nodata":E.color="gray";break}return d}function y(h){if(!h||!h.length)return[];const d=[];for(const E of h){const b=new DataFrameView(E);for(let D=0;D<E.length;D++){const C=cloneDeep(b.get(D));d.push(C)}}return d}},96215:(te,R,e)=>{"use strict";e.d(R,{Z:()=>S,S:()=>B});var n=e(2543),a=e(39741),s=e(62467),i=e(69862),r=e(81160),u=e(66847),o=e(28105),l=e(41119),g=e(22592),f=e(60519),p=e(76732),c=e(739),x=e(2197),v=e(1906),m=e(17548),y=e(97534),h=e(36580),d=e(46383),E=e(28998),b=e(59373),D=e(73601),C=e(32380),P=e(49510),M=e(27359);function O(K=[]){K.forEach(T=>{T.meta={...T.meta,dataTopic:c.QR.Annotations}})}function j(K,T){return(0,P.z)([K,T]).pipe((0,i.Z)(L=>{const[A,N]=L;if(N.annotations?.length||N.alertState){A.annotations||(A.annotations=[]);const V=A.annotations.concat((0,M.I)(N.annotations));O(V);const z=N.alertState;return(0,s.of)({...A,annotations:V,alertState:z})}return O(A.annotations),(0,s.of)(A)}))}var U=e(71393);let W=100;function B(){return"Q"+W++}class S{constructor(T){this.templateSrv=(0,b.w)(),this.resendLastResult=()=>{this.lastResult&&this.subject.next(this.lastResult)},this.subject=new a.m(1),this.dataConfigSource=T}getData(T){const{withFieldConfig:L,withTransforms:A}=T;let N=1,V,z=[],w=[],H,Q=!0,Z=-1;if(this.dataConfigSource.snapshotData){const Y={state:o.Gu.Done,series:this.dataConfigSource.snapshotData.map(X=>(0,l.Vc)(X)),timeRange:(0,g.E2)(),structureRev:N};return(0,s.of)(Y)}return this.subject.pipe((0,i.Z)(Y=>{let X=this.dataConfigSource.getFieldOverrideOptions(),I=this.dataConfigSource.getTransformations();if(Y.series===w&&V?.fieldConfig===X?.fieldConfig&&H===I)return(0,s.of)({...Y,structureRev:N,series:z});V=X,H=I,w=Y.series;let J=(0,s.of)(Y);return A&&(J=this.applyTransformations(Y)),J.pipe((0,r.T)(ee=>{let q=ee,ne=!1;if(L&&ee.series?.length){if(Z===this.dataConfigSource.configRev){let se;for(const oe of ee.series)if((0,d.o$)(oe)){se=oe;break}se&&!se.packetInfo.schemaChanged&&z[0].fields.length===se.fields.length&&(q={...q,series:z.map((oe,de)=>({...oe,length:ee.series[de].length,fields:oe.fields.map((fe,ae)=>({...fe,values:ee.series[de].fields[ae].values,state:{...fe.state,calcs:void 0,range:void 0}}))}))},ne=!0)}X!=null&&(Q||!ne)&&(Z=this.dataConfigSource.configRev,q={...q,series:(0,f.we)({timeZone:ee.request?.timezone??"browser",data:q.series,...X})},q.annotations&&(q.annotations=(0,f.we)({data:q.annotations,...X,fieldConfig:{defaults:{},overrides:[]}})),Q=!1)}return!ne&&!(0,p.J3)(z,q.series,p.bW)&&N++,z=q.series,{...q,structureRev:N}}))}))}applyTransformations(T){const L=this.dataConfigSource.getTransformations();if(L&&L.every(Q=>Q.disabled)||!L||L.length===0)return(0,s.of)(T);const N={interpolate:Q=>this.templateSrv.replace(Q,T?.request?.scopedVars)};let V=L.filter(Q=>Q.topic==null||Q.topic===c.QR.Series),z=L.filter(Q=>Q.topic===c.QR.Annotations),w=(0,x.m)(V,T.series,N),H=(0,x.m)(z,T.annotations??[],N);return(0,n.merge)(w,H).pipe((0,r.T)(Q=>{let Y=Q.some(X=>X.meta?.dataTopic===c.QR.Annotations)?{annotations:Q}:{series:Q};return{...T,...Y}}),(0,u.W)(Q=>(console.warn("Error running transformation:",Q),(0,s.of)({...T,state:o.Gu.Error,errors:[(0,y.u)(Q)]}))))}async run(T){const{queries:L,timezone:A,datasource:N,panelId:V,panelName:z,panelPluginId:w,dashboardUID:H,dashboardTitle:Q,timeRange:Z,timeInfo:Y,cacheTimeout:X,queryCachingTTL:I,maxDataPoints:J,scopedVars:ee,minInterval:q,app:ne}=T;if((0,D.k)(N)){this.pipeToSubject((0,D.m)(T,L[0]),V,!0);return}const se=this.shouldAddErrorWhenDatasourceVariableIsMultiple(N,ee),oe={app:ne??v.Jk.Dashboard,requestId:B(),timezone:A,panelId:V,panelName:z,panelPluginId:w,dashboardUID:H,dashboardTitle:Q,range:Z,timeInfo:Y,interval:"",intervalMs:0,targets:(0,n.cloneDeep)(L),maxDataPoints:J,scopedVars:ee||{},cacheTimeout:X,queryCachingTTL:I,startTime:Date.now(),rangeRaw:Z.raw};try{const de=await _(N,oe.scopedVars),fe=de.meta?.mixed;oe.targets=oe.targets.map(ie=>{const ve=ie.datasource?.type===h.dR.type;return(!ie.datasource||ie.datasource.uid!==de.uid&&!fe&&!ve)&&(ie.datasource=de.getRef()),ie});const ae=q?this.templateSrv.replace(q,oe.scopedVars):de.interval,ce=m.calculateInterval(Z,J,ae);oe.scopedVars=Object.assign({},oe.scopedVars,{__interval:{text:ce.interval,value:ce.interval},__interval_ms:{text:ce.intervalMs.toString(),value:ce.intervalMs}}),oe.interval=ce.interval,oe.intervalMs=ce.intervalMs,oe.filters=this.templateSrv.getAdhocFilters(de.name,!0),oe.panelId=V,oe.panelName=z,this.lastRequest=oe,this.pipeToSubject((0,U.BN)(de,oe),V,!1,se)}catch(de){this.pipeToSubject((0,s.of)({state:o.Gu.Error,error:(0,y.u)(de),series:[],timeRange:oe.range}),V)}}pipeToSubject(T,L,A=!1,N=!1){this.subscription&&this.subscription.unsubscribe();let V=T;const z=this.dataConfigSource.getDataSupport();if(z.alertStates||z.annotations){const w=this.dataConfigSource;V=j(T,(0,C.Dh)().getResult(w.id))}this.subscription=V.subscribe({next:w=>{const H=this.lastResult,Q=A?w:(0,l.N$)(w,H);if(H!=null&&Q.state!==o.Gu.Streaming){let Z=(0,p.J3)(H.series??[],Q.series??[],(J,ee)=>J===ee),Y=(0,p.J3)(H.annotations??[],Q.annotations??[],(J,ee)=>J===ee),X=H.state===Q.state,I=(0,p.J3)(H.errors??[],Q.errors??[],(J,ee)=>(0,n.isEqual)(J,ee));if(Z&&(Q.series=H.series),Y&&(Q.annotations=H.annotations),Z&&Y&&X&&I)return}this.lastResult=Q,N&&(Q.errors=[{message:"Panel is using a variable datasource with multiple values without repeat option. Please configure the panel to be repeated by the same datasource variable."}],Q.state=o.Gu.Error),this.subject.next(Q)}})}cancelQuery(){this.subscription&&(this.subscription.unsubscribe(),this.lastResult&&(this.lastResult.state===o.Gu.Loading||this.lastResult.state===o.Gu.Streaming)&&this.subject.next({...this.lastResult,state:o.Gu.Done}))}clearLastResult(){this.lastResult=void 0,this.subject=new a.m(1)}destroy(){this.subject&&this.subject.complete(),this.subscription&&this.subscription.unsubscribe()}useLastResultFrom(T){this.lastResult=T.getLastResult(),this.lastResult&&this.subject.next(this.lastResult)}setLastResult(T){this.lastResult=T}getLastResult(){return this.lastResult}getLastRequest(){return this.lastRequest}shouldAddErrorWhenDatasourceVariableIsMultiple(T,L){let A=!1;return T?.uid?.startsWith("${")&&this.templateSrv.replace(T.uid,L,N=>(Array.isArray(N)&&N.length>1&&(A=!0),"")),A}}async function _(K,T){return K&&typeof K=="object"&&"query"in K?K:await(0,E.tR)().get(K,T)}},77526:(te,R,e)=>{"use strict";e.d(R,{N:()=>a});var n=e(69850);function a(s,i){return(0,n.j)(()=>{i&&s.resolveCancelerIfExists(i)})}},39050:(te,R,e)=>{"use strict";e.d(R,{B:()=>a});var n=e(76732);const a=(s,i)=>{let r=1;return i?.structureRev&&i.series&&(r=i.structureRev,(0,n.J3)(s.series,i.series,n.bW)||r++),s.structureRev=r,s}},71393:(te,R,e)=>{"use strict";e.d(R,{BN:()=>A});var n=e(2543),a=e(62467),s=e(44240),i=e(39697),r=e(65474),u=e(81160),o=e(66847),l=e(59099),g=e(1005),f=e(65961),p=e(67791),c=e(69862),x=e(28105),v=e(739),m=e(33239),y=e(1906),h=e(97534),d=e(38353),E=e(43173),b=e(36580),D=e(83873),C=e(1404),P=e(29328),M=e(25992);const O=(0,M.DW)("features.query");var j=e(77526),U=e(83175),W=e(33749),B=e(27489),S=e(22429);function _(z){let w=!1;return Q=>{if(!Q.request||w||U.kM.getUrlSearchParams().editPanel!=null||Q.state!==x.Gu.Done&&Q.state!==x.Gu.Error)return;const Y={eventName:W.n_.DataRequest,source:Q.request.app,datasourceName:z.name,datasourceId:z.id,datasourceUid:z.uid,datasourceType:z.type,dataSize:0,panelId:0,panelPluginId:Q.request?.panelPluginId,duration:Q.request.endTime-Q.request.startTime,...Q?.request?.panelId&&Number.isInteger(Q.request.panelId)&&{panelId:Q.request.panelId},...Q?.request?.panelName&&{panelName:Q.request.panelName}};H(Y,Q),Q.request.app!==y.Jk.Explore&&Q.request.app!==y.Jk.Correlations&&K(Y,Q),Q.series&&Q.series.length>0&&(Y.dataSize=Q.series.length),(0,B.G$)(Y),w=!0};function H(Q,Z){const Y={};for(let I=0;I<Z.series.length;I++){const J=Z.series[I].refId;J&&!Y[J]&&(Y[J]=Z.series[I].meta?.isCachedResponse??!1)}Q.totalQueries=Object.keys(Y).length,Q.cachedQueries=Object.values(Y).filter(I=>I===!0).length;const X=(0,S.UA)().getCurrent();X&&(Q.dashboardId=X.id,Q.dashboardName=X.title,Q.dashboardUid=X.uid,Q.folderName=X.meta.folderTitle)}}function K(z,w){w.errors?.length?z.error=w.errors.map(H=>H.message).join(", "):w.error&&(z.error=w.error.message)}function T(z,w){const H=w.panelData.request,Q={...w.packets},Z=z.key??z.data?.[0]?.refId??"A";Q[Z]=z;let Y=z.state||x.Gu.Done,X,I;const J=[],ee=[];for(const oe in Q){const de=Q[oe];if((de.error||de.errors?.length)&&(Y=x.Gu.Error,X=de.error,I=de.errors),de.data&&de.data.length)for(const fe of de.data){if(fe.meta?.dataTopic===v.QR.Annotations){ee.push(fe);continue}J.push(fe)}}const q=L(H,Y),ne={state:Y,series:J,annotations:ee,error:X,errors:I,request:H,timeRange:q},se=new Set([...w.panelData.traceIds??[],...z.traceIds??[]]);return se.size>0&&(ne.traceIds=Array.from(se)),{packets:Q,panelData:ne}}function L(z,w){const H=z.range;return!(0,n.isString)(H.raw.from)||w!==x.Gu.Streaming?H:{...H,from:m.parse(H.raw.from,!1),to:m.parse(H.raw.to,!0)}}function A(z,w,H){let Q={panelData:{state:x.Gu.Loading,series:[],request:w,timeRange:w.range},packets:{}};if(!w.targets.length)return w.endTime=Date.now(),Q.panelData.state=x.Gu.Done,(0,a.of)(Q.panelData);const Z=N(z,w,H).pipe((0,u.T)(Y=>{if(!(0,n.map)(Y.data))throw new Error(`Expected response data to be array, got ${typeof Y.data}.`);const X=w.targets.filter(I=>I.hide);for(const I of X)Y.data=Y.data.filter(J=>J.refId!==I.refId);return w.endTime=Date.now(),Q=T(Y,Q),Q.panelData}),(0,o.W)(Y=>(console.error("runRequest.catchError",Y),O.logError(Y),(0,a.of)({...Q.panelData,state:x.Gu.Error,error:(0,h.u)(Y)}))),(0,l.M)(_(z)),(0,j.N)(D.IB,w.requestId),(0,g.u)());return(0,s.h)((0,i.O)(200).pipe((0,f.u)(Q.panelData),(0,p.Q)(Z)),Z)}function N(z,w,H){if((0,d.LZ)(z)){const Q=(0,d.xt)(z,w);return(0,r.H)(Q).pipe((0,c.Z)(Z=>V(z,Z,H)))}return V(z,w,H)}function V(z,w,H){if(w.targets=w.targets.map(Z=>(0,C.Ih)(Z)?{...z?.getDefaultQuery?.(y.Jk.PanelEditor),...Z}:Z),E.$.publicDashboardAccessToken)return(0,r.H)(z.query(w));for(const Z of w.targets)if((0,b.s9)(Z.datasource))return P.Ex.query(w);if(H||(w.targets=w.targets.filter(Z=>z.filterQuery?.(Z)??!0)),w.targets.length===0)return(0,a.of)({data:[]});const Q=H?H(w):z.query(w);return(0,r.H)(Q)}},57204:(te,R,e)=>{"use strict";e.d(R,{y:()=>u});var n=e(1906),a=e(46933),s=e(39796),i=e(2863),r=e(36580);async function u(o,l,g,f){let p=g;const c={...o.getRef(),uid:l},x={...o?.getDefaultQuery?.(n.Jk.PanelEditor),datasource:c,refId:"A"};if(f?.meta.id!==o.meta.id){if(o.meta.mixed)return g;if((0,a.Ee)(f)&&(0,a.FL)(o)){const v=await f.exportToAbstractQueries(g);p=await o.importFromAbstractQueries(v)}else if(f&&o.importQueries)p=await o.importQueries(g,f);else{if(f){const v=(0,i.w)(),m=[];let y=o.uid;const h=v.containsTemplate(l);h&&(y=v.replace(o.uid));const d=g.reduce((E,b)=>{if(b.datasource){let D=b.datasource.uid;const C=v.containsTemplate(D);if(C&&(D=v.replace(b.datasource.uid)),D===y&&C===h)return b.refId=(0,s.M)(E),E.concat([b])}return E},m);if(d.length>0)return d}return[x]}}return p.length===0?[x]:p.map(v=>(!(0,r.s9)(v.datasource)&&!o.meta.mixed&&(v.datasource=c),v))}},99090:(te,R,e)=>{"use strict";e.d(R,{G3:()=>u,TF:()=>g,XJ:()=>v,YU:()=>c,d7:()=>p,if:()=>m,r4:()=>r,w7:()=>x});var n=e(83458);const a=null,s=58,i=8,r={label:"A\u2013Z",value:"alpha-asc"},u="search.sections",o="grafana.search.expanded-folder",l=0,g="general",f="Dashboards",p="grafana.search.include.panels",c="grafana.search.layout",x="grafana.search.sort",v={dashboard:n.G.DashDB,folder:n.G.DashFolder,home:n.G.DashHome},m=1e3},5478:(te,R,e)=>{"use strict";e.d(R,{d:()=>r,n:()=>u});var n=e(96540),a=e(13752),s=e(92138),i=e(36490);function r(){const o=(0,n.useRef)(new a.B);return{keyboardEvents:o.current,onKeyDown:l=>{switch(l.code){case"ArrowDown":case"ArrowUp":case"ArrowLeft":case"ArrowRight":case"Enter":case"Escape":o.current.next(l);default:}}}}function u(o,l,g){const f=(0,n.useRef)({x:0,y:-1}),[p,c]=(0,n.useState)({x:0,y:-1}),x=(0,n.useRef)();return(0,n.useEffect)(()=>{x.current=g.view.fields.url,f.current.x=0,f.current.y=-1,c({...f.current})},[g]),(0,n.useEffect)(()=>{const v=o.subscribe({next:m=>{switch(m?.code){case"ArrowDown":{f.current.y++,c({...f.current});break}case"ArrowUp":f.current.y=Math.max(0,f.current.y-1),c({...f.current});break;case"ArrowRight":{l>0&&(f.current.x=Math.min(l,f.current.x+1),c({...f.current}));break}case"ArrowLeft":{l>0&&(f.current.x=Math.max(0,f.current.x-1),c({...f.current}));break}case"Enter":if(!x.current)break;const y=f.current.x*l+f.current.y;if(y<0){f.current.x=0,f.current.y=0,c({...f.current});break}const h=x.current.values?.[y];typeof h=="string"&&i.Ny.push(s.I.stripBaseFromUrl(h))}}});return()=>v.unsubscribe()},[o,l]),p}},67497:(te,R,e)=>{"use strict";e.d(R,{B9:()=>u,J$:()=>i,KZ:()=>r,MK:()=>s,Pf:()=>a});var n=e(27489);const a=(l,g)=>{(0,n.rR)(`${l}_viewed`,o(g))},s=(l,g)=>{(0,n.rR)(`${l}_result_clicked`,o(g))},i=(l,g)=>{(0,n.rR)(`${l}_query_submitted`,o(g))},r=(l,{error:g,...f})=>{(0,n.rR)(`${l}_query_failed`,{...o(f),error:g})},u=(l,g,f)=>{(0,n.rR)(`grafana_panel_inspect_${l}_${g}_clicked`,f)},o=l=>({layout:l.layout,starredFilter:l.starred??!1,sort:l.sortValue??"",tagCount:l.tagCount??0,queryLength:l.query?.length??0,includePanels:l.includePanels??!1,deleted:l.deleted??!1})},42361:(te,R,e)=>{"use strict";e.d(R,{v:()=>r});var n=e(66402),a=e(13956),s=e(93854);class i{constructor(){this.cache=null,this.promise=null}async get(){if(this.cache!==null)return this.cache;if(this.promise!==null)return this.promise;this.promise=this.fetch();try{return this.cache=await this.promise,this.cache}catch(o){throw this.promise=null,o}}clear(){this.cache=null,this.promise=null}async fetch(){try{const l=await(0,a.n)().listDeletedDashboards({limit:1e3});return(0,n.F)(l)?(0,s.A5)(l):[]}catch(o){return console.error("Failed to fetch deleted dashboards:",o),[]}}}const r=new i},55860:(te,R,e)=>{"use strict";e.d(R,{S:()=>Z});var n=e(43173),a=e(88673),s=e(41119),i=e(11576),r=e(92745),u=e(68143),o=e(93854);const l="Loading",g="api/search-v2",f="name_sort";class p{constructor(X){this.fallbackSearcher=X}async search(X){if(X.facet?.length)throw new Error("facets not supported!");return this.doSearchQuery(X)}async starred(X){if(X.facet?.length)throw new Error("facets not supported!");const I=await(0,u.AI)().get("api/user/stars");return I?.length?this.doSearchQuery({uid:I,query:X.query??"*"}):{view:new a.R({length:0,fields:[]}),totalRows:0,loadMoreItems:async(J,ee)=>{},isItemLoaded:J=>!0}}async tags(X){const I={...X,query:X.query??"*",sort:void 0,facet:[{field:"tag"}],limit:1},ee=(await(0,u.AI)().post(g,I)).frames.map(q=>(0,s.Vc)(q));if(ee[0]?.name===l)return this.fallbackSearcher.tags(X);for(const q of ee)if(q.fields[0].name==="tag")return v(q);return[]}getSortOptions(){const X=[{value:f,label:(0,r.t)("search.bluge-searcher.opts.label.alphabetically-az","Alphabetically (A-Z)")},{value:"-name_sort",label:(0,r.t)("search.bluge-searcher.opts.label.alphabetically-za","Alphabetically (Z-A)")}];if(n.$.licenseInfo.enabledFeatures.analytics){for(const I of m)X.push({value:`-${I.name}`,label:`${I.display} (most)`}),X.push({value:`${I.name}`,label:`${I.display} (least)`});for(const I of y)X.push({value:`-${I.name}`,label:`${I.display} (recent)`}),X.push({value:`${I.name}`,label:`${I.display} (oldest)`})}return Promise.resolve(X)}async doSearchQuery(X){X=await(0,o.u4)(X);const I={...X,query:X.query??"*",limit:X.limit??c},ee=(await(0,u.AI)().post(g,I)).frames.map(ae=>(0,s.Vc)(ae)),q=ee.length?(0,s.Vc)(ee[0]):{fields:[],length:0};if(q.name===l)return this.fallbackSearcher.search(X);for(const ae of q.fields)ae.display=(0,i.J)({field:ae,theme:n.$.theme2});q.meta?.custom||(q.meta={...q.meta,custom:{count:q.length,max_score:1}});const ne=q.meta.custom;if(ne.locationInfo||(ne.locationInfo={}),ne.sortBy?.length){const ae=q.fields.find(ce=>ce.name===ne.sortBy);if(ae){const ce=h(ae.name);ne.sortBy=ce,ae.name=ce}}let se=0,oe;const de=async()=>{for(;se>fe.dataFrame.length;){const ae=fe.dataFrame.length;if(ae>=ne.count)return;const ce=await(0,u.AI)().post(g,{...I??{},from:ae,limit:x}),ie=(0,s.Vc)(ce.frames[0]);if(!ie){console.log("no results",ie);return}if(ie.fields.length!==fe.dataFrame.fields.length){console.log("invalid shape",ie,fe.dataFrame);return}const ve=ie.length+fe.dataFrame.length;for(let Ee=0;Ee<ie.fields.length;Ee++)fe.dataFrame.fields[Ee].values.push(...ie.fields[Ee].values);fe.dataFrame.length=ve;const le=ie.meta?.custom;if(le?.locationInfo&&ne)for(const[Ee,Re]of Object.entries(le.locationInfo))ne.locationInfo[Ee]=Re}oe=void 0},fe=new a.R(q);return{totalRows:ne.count??q.length,view:fe,loadMoreItems:async(ae,ce)=>(se=Math.max(se,ce),oe||(oe=de()),oe),isItemLoaded:ae=>ae<fe.dataFrame.length}}getFolderViewSort(){return"name_sort"}}const c=50,x=100;function v(Y){const X=Y.fields[0].values,I=Y.fields[1].values,J=[];for(let ee=0;ee<Y.length;ee++)J.push({term:X[ee],count:I[ee]});return J}const m=[{name:"views_total",display:"Views total"},{name:"views_last_30_days",display:"Views 30 days"},{name:"errors_total",display:"Errors total"},{name:"errors_last_30_days",display:"Errors 30 days"}],y=[{name:"created_at",display:"Created time"},{name:"updated_at",display:"Updated time"}];function h(Y){for(const X of m)if(X.name===Y)return X.display;for(const X of y)if(X.name===Y)return X.display;return Y}var d=e(84139);class E{constructor(X){this.parent=X,this.cache=new Map,this.sortPlaceholder="Default (Relevance)"}async search(X){if(X.facet?.length)throw new Error("facets not supported!");if(X.sort!=null)throw new Error("custom sorting is not supported yet");if(X.tags?.length||X.ds_uid?.length)return this.parent.search(X);const J=(await this.getCache(X.kind)).search(X.query);return{isItemLoaded:()=>!0,loadMoreItems:async(ee,q)=>{},totalRows:J.length,view:J}}async getCache(X){const I=X?X.sort().join(","):"*",J=this.cache.get(I);if(J)try{return await J}catch{return this.cache.delete(I),new b(new a.R({name:"error",fields:[],length:0}))}const ee=this.parent.search({kind:X,limit:5e3}).then(q=>new b(q.view));return this.cache.set(I,ee),ee}async starred(X){return this.parent.starred(X)}async getSortOptions(){return this.parent.getSortOptions()}async tags(X){return this.parent.tags(X)}getFolderViewSort(){return this.parent.getFolderViewSort()}}class b{constructor(X){this.full=X,this.ufuzzy=new d.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1}),this.names=this.full.fields.name.values,this.empty=new a.R({...this.full.dataFrame,fields:this.full.dataFrame.fields.map(I=>({...I,values:[]})),length:0})}search(X){if(!X?.length||X==="*")return this.full;const I=this.full.dataFrame.fields,J=this.names,ee=I.map(oe=>[]);let[q,ne,se]=this.ufuzzy.search(J,X,5);for(let oe=0;oe<I.length;oe++){let de=I[oe].values,fe=ee[oe];if(ne&&se)for(let ae=0;ae<se.length;ae++){let ce=ne.idx[se[ae]];fe.push(de[ce])}else if(q)for(let ae=0;ae<q.length;ae++){let ce=q[ae];fe.push(de[ce])}}return this.empty.dataFrame.fields.forEach((oe,de)=>{oe.values=ee[de]}),this.empty.dataFrame.length=this.empty.dataFrame.fields[0].values.length,this.empty}}var D=e(95004),C=e(83873),P=e(99090),M=e(42361);class O{constructor(){this.locationInfo={general:{kind:"folder",name:"Dashboards",url:"/dashboards"}},this.getFolderViewSort=()=>""}async composeQuery(X,I){const J=await(0,o.u4)(I);return J.query?.length&&J.query!=="*"&&(X.query=J.query),J.kind?.length===1&&P.XJ[J.kind[0]]&&(X.type=P.XJ[J.kind[0]]),J.uid?X.dashboardUID=J.uid:J.location?.length&&(X.folderUIDs=[J.location]),X}async search(X){if(X.facet?.length)throw new Error("facets not supported!");if(X.from!==void 0){if(!X.limit)throw new Error("Must specify non-zero limit parameter when using from");if(X.from/X.limit%1!==0)throw new Error("From parameter must be a multiple of limit")}const I=X.limit??(X.from!==void 0?1:P.if),J=X.from!==void 0?X.from/I+1:void 0,ee=await this.composeQuery({limit:I,tag:X.tags,sort:X.sort,permission:X.permission,page:J,deleted:X.deleted},X);return this.doAPIQuery(ee)}async starred(X){if(X.facet?.length)throw new Error("facets not supported!");const I=await this.composeQuery({limit:X.limit??P.if,tag:X.tags,sort:X.sort,starred:X.starred},X);return this.doAPIQuery(I)}async getSortOptions(){return(await C.IB.get("/api/search/sorting")).sortOptions.map(I=>({value:I.name,label:I.displayName}))}async tags(X){return(await C.IB.get("/api/dashboards/tags")).sort((J,ee)=>ee.count-J.count)}async doAPIQuery(X){let I;if(X.deleted){const le=await M.v.get();I=(0,o.m6)((0,o.Tm)(le,X))}else I=await C.IB.get("/api/search",X);const J=[],ee=[],q=[],ne=[],se=[],oe=[],de=[],fe=[],ae=[];let ce;for(let le of I){const Ee=le.type==="dash-folder"?"folder":"dashboard";J.push(Ee),ee.push(le.title),q.push(le.uid),ne.push(le.url),se.push(le.tags),de.push(le.sortMeta),fe.push(le.isDeleted??!1),ae.push(le.permanentlyDeleteDate?new Date(le.permanentlyDeleteDate):void 0);let Re=le.folderUid;!Re&&Ee==="dashboard"&&(Re=P.TF),oe.push(Re),le.sortMetaName?.length&&(ce=le.sortMetaName),le.folderUid&&le.folderTitle?this.locationInfo[le.folderUid]={kind:"folder",name:le.folderTitle,url:le.folderUrl,folderUid:le.folderUid}:Ee==="folder"&&(this.locationInfo[le.uid]={kind:Ee,name:le.title,url:le.url,folderUid:le.folderUid})}const ie={fields:[{name:"kind",type:D.PU.string,config:{},values:J},{name:"name",type:D.PU.string,config:{},values:ee},{name:"uid",type:D.PU.string,config:{},values:q},{name:"url",type:D.PU.string,config:{},values:ne},{name:"tags",type:D.PU.other,config:{},values:se},{name:"location",type:D.PU.string,config:{},values:oe},{name:"isDeleted",type:D.PU.boolean,config:{},values:fe},{name:"permanentlyDeleteDate",type:D.PU.time,config:{},values:ae}],length:ee.length,meta:{custom:{count:ee.length,max_score:1,locationInfo:this.locationInfo}}};ce?.length&&de.length&&(ie.meta.custom.sortBy=ce,ie.fields.push({name:ce,type:D.PU.number,config:{},values:de}));for(const le of ie.fields)le.display=(0,i.J)({field:le,theme:n.$.theme2});const ve=new a.R(ie);return{totalRows:ie.length,view:ve,loadMoreItems:async(le,Ee)=>{},isItemLoaded:le=>!0}}}var j=e(2543),U=e(85618),W=e(77197);const B="Loading",_=`${(0,U.TP)("dashboard.grafana.app","v0alpha1")}/search`,K="name_sort";class T{constructor(X){this.fallbackSearcher=X,this.locationInfo=w()}async search(X){if(X.facet?.length)throw new Error("facets not supported!");return this.doSearchQuery(X)}async starred(X){if(X.facet?.length)throw new Error("facets not supported!");const I=await(0,u.AI)().get("api/user/stars");return I?.length?this.doSearchQuery({...X,name:I,query:X.query??"*"}):N()}async tags(X){const I=X.query??"*";let J=`${_}?facet=tags&query=${I}&limit=1`;return(await(0,u.AI)().get(J)).facets?.tags?.terms||[]}getSortOptions(){const X=[{value:K,label:(0,r.t)("search.unified-searcher.opts.label.alphabetically-az","Alphabetically (A-Z)")},{value:"-name_sort",label:(0,r.t)("search.unified-searcher.opts.label.alphabetically-za","Alphabetically (Z-A)")}];if(n.$.licenseInfo.enabledFeatures.analytics)for(const I of A)X.push({value:`-${I.name}`,label:`${I.display} (most)`}),X.push({value:`${I.name}`,label:`${I.display} (least)`});return Promise.resolve(X)}async doSearchQuery(X){const I=await this.newRequest(X);let J;if(X.deleted){const ae=await M.v.get(),ce=(0,o.Tm)(ae,X);J={hits:ce,totalHits:ce.length}}else J=await this.fetchResponse(I);const ee=z(J,X.sort??"");if(ee.name===B)return this.fallbackSearcher.search(X);const q=ee.meta?.custom,ne={count:q?.count??ee.length,max_score:q?.max_score??1,locationInfo:q?.locationInfo??{},sortBy:q?.sortBy};if(ne.locationInfo=await this.locationInfo,ee.meta&&(ee.meta.custom=ne),ne.sortBy?.length){const ae=ee.fields.find(ce=>ce.name===ne.sortBy);if(ae){const ce=V(ae.name);ne.sortBy=ce,ae.name=ce}}let se=0,oe;const de=async()=>{for(;se>fe.dataFrame.length;){const ae=fe.dataFrame.length;if(ae>=ne.count)return;const ce=`${I}&offset=${ae}`,ie=await this.fetchResponse(ce),ve=z(ie,X.sort??"");if(!ve){console.log("no results",ve);return}if(ve.fields.length!==fe.dataFrame.fields.length){console.log("invalid shape",ve,fe.dataFrame);return}const le=ve.length+fe.dataFrame.length;ve.fields.forEach(Re=>{const Oe=fe.dataFrame.fields.find(Se=>Se.name===Re.name);Oe&&Oe.values.push(...Re.values)}),fe.dataFrame.length=le;const Ee=ve.meta?.custom;if(Ee?.locationInfo&&ne){const Re=Ee.locationInfo;Re&&typeof Re=="object"&&Object.assign(ne.locationInfo,Re)}}oe=void 0},fe=new a.R(ee);return{totalRows:ne.count??ee.length,view:fe,loadMoreItems:async(ae,ce)=>(se=Math.max(se,ce),oe||(oe=de()),oe),isItemLoaded:ae=>ae<fe.dataFrame.length}}async fetchResponse(X){const I=await(0,u.AI)().get(X);if(!await this.isFolderCacheStale(I.hits)||(this.locationInfo=w(),!await this.isFolderCacheStale(I.hits)))return I;const q=await this.locationInfo,ne=I.hits.map(oe=>oe.folder===void 0?{...oe,location:"general",folder:"general"}:q[oe.folder]===void 0?{...oe,location:"sharedwithme",folder:"sharedwithme"}:oe),se=I.totalHits-(I.hits.length-ne.length);return{...I,hits:ne,totalHits:se}}async isFolderCacheStale(X){const I=await this.locationInfo;return X.some(J=>J.folder!==void 0&&I[J.folder]===void 0)}async newRequest(X){X=await(0,o.u4)(X);let I=_;if(I+=`?query=${encodeURIComponent(X.query??"*")}`,I+=`&limit=${X.limit??L}`,(0,j.isEmpty)(X.location)||(I+=`&folder=${X.location}`),X.kind&&(I+="&"+X.kind.map(J=>`type=${J}`).join("&")),X.tags?.length&&(I+="&"+X.tags.map(J=>`tag=${encodeURIComponent(J)}`).join("&")),X.sort){const J=X.sort.replace("_sort","").replace("name","title");I+=`&sort=${J}`;const ee=J.startsWith("-")?J.substring(1):J;I+=`&field=${ee}`}return X.name?.length&&(I+="&"+X.name.map(J=>`name=${encodeURIComponent(J)}`).join("&")),X.uid?.length&&(I+="&"+X.uid.map(J=>`name=${encodeURIComponent(J)}`).join("&")),X.deleted&&(I=`${(0,U.TP)("dashboard.grafana.app","v1beta1")}/dashboards/?labelSelector=grafana.app/get-trash=true`),I}getFolderViewSort(){return"name_sort"}}const L=50,A=[{name:"views_total",display:"Views total"},{name:"views_last_30_days",display:"Views 30 days"},{name:"errors_total",display:"Errors total"},{name:"errors_last_30_days",display:"Errors 30 days"}];function N(){return{view:new a.R({length:0,fields:[]}),totalRows:0,loadMoreItems:async(Y,X)=>{},isItemLoaded:Y=>!0}}function V(Y){for(const X of A)if(X.name===Y)return X.display;return Y}function z(Y,X){const I=Y.hits;if(I.length<1)return{fields:[],length:0};const J=I.map(q=>{let ne=q.folder;q.resource==="dashboards"&&(0,j.isEmpty)(ne)&&(ne="general");const se=Object.fromEntries(Object.entries(q.field??{}).map(([oe,de])=>[oe,de??"-"]));return{...q,uid:q.name,url:H(q.resource,q.name,q.title),tags:q.tags||[],folder:q.folder||"general",location:ne,name:q.title,kind:q.resource.substring(0,q.resource.length-1),...se}}),ee=(0,s.Vc)(J);ee.meta={custom:{count:Y.totalHits,max_score:1}},X&&ee.meta.custom&&(ee.meta.custom.sortBy=X.startsWith("-")?X.substring(1):X);for(const q of ee.fields)q.display=(0,i.J)({field:q,theme:n.$.theme2});return ee}async function w(){const Y=`${_}?type=folders`;return(0,u.AI)().get(Y).then(I=>{const J={general:{kind:"folder",name:"Dashboards",url:"/dashboards"},sharedwithme:{kind:"sharedwithme",name:"Shared with me",url:""}};for(const ee of I.hits)J[ee.name]={name:ee.title,kind:"folder",url:H("folders",ee.name,ee.title)};return J})}function H(Y,X,I){if(Y==="folders")return`/dashboards/f/${X}`;const J=W.A.slugifyForUrl(I);return`/d/${X}/${J}`}let Q;function Z(){if(!Q){const Y=new O,X=n.$.featureToggles.panelTitleSearch;if(Q=X?new p(Y):Y,X&&window.location.search.includes("do-frontend-query"))return new E(Q);Q=n.$.featureToggles.unifiedStorageSearchUI?new T(Y):Y}return Q}},93854:(te,R,e)=>{"use strict";e.d(R,{A5:()=>v,TM:()=>g,Tm:()=>y,cu:()=>f,hI:()=>x,m6:()=>m,u4:()=>u});var n=e(99885),a=e(62963),s=e(22429),i=e(75735),r=e(83458);async function u(h){return h.query&&h.query.indexOf("folder:current")>=0&&(h={...h,location:await o(),query:h.query.replace("folder:current","").trim()},h.query?.length||(h.query="*")),Promise.resolve(h)}async function o(){try{let h=(0,s.UA)().getCurrent();return h||(await l(500),h=(0,s.UA)().getCurrent()),Promise.resolve(h?.meta?.folderUid)}catch(h){console.error(h)}}function l(h){return new Promise(d=>setTimeout(d,h))}function g(h,d){return h==="dashboard"?"apps":h==="folder"?d?"folder-open":"folder":h==="sharedwithme"?"users-alt":"question-circle"}function f(h,d){return h&&(0,a.I2)(h.uid)?"users-alt":g(h.kind,d)}function p(h){switch(h){case"dashboard":case"folder":case"panel":return h;default:return"dashboard"}}function c(h){return h!==null&&typeof h=="object"&&"locationInfo"in h}function x(h,d){const E=d?.dataFrame.meta?.custom,b=c(E)?E:void 0,D={kind:p(h.kind),uid:h.uid,title:h.name,url:h.url,tags:h.tags??[],managedBy:h.managedBy},C=b?.sortBy;if(C){const P=h[C];(typeof P=="string"||typeof P=="number")&&(D.sortMetaName=C,D.sortMeta=P)}if(h.location){const P=h.location.split("/"),M=P[P.length-1],O=b?.locationInfo[M];O&&(D.parentTitle=O.name,D.parentKind=O.kind,D.parentUID=M)}return D}function v(h){return h.items.map(d=>{const E={resource:"dashboards",name:d.metadata.name,title:d.spec?.title,location:"general",folder:d?.metadata?.annotations?.[i.ew]??"general",tags:d.spec?.tags||[],field:{},url:""};return E.folder?E:{...E,location:"general",folder:"general"}})}function m(h){return h.map(d=>{const E={type:d.resource==="folders"?r.G.DashFolder:r.G.DashDB,title:d.title,uid:d.name,url:d.url,tags:d.tags||[],isDeleted:!0,sortMeta:0};return d.folder&&d.folder!=="general"&&(E.folderUid=d.folder),E})}function y(h,d){let E=h;if(d.query&&d.query.trim()!==""&&d.query!=="*"||d.tag&&d.tag.length>0){const b=d.query||d.tag?.join(",")||"",D=h.map(P=>`${P.title},${P.tags.join(",")}`);E=(0,n.X)(D,b).map(P=>h[P])}if(d.sort){const b=new Intl.Collator,D=d.sort==="alpha-desc"?-1:1;E.sort((C,P)=>D*b.compare(C.title,P.title))}return E}},83458:(te,R,e)=>{"use strict";e.d(R,{G:()=>n,P:()=>a});var n=(s=>(s.DashDB="dash-db",s.DashHome="dash-home",s.DashFolder="dash-folder",s))(n||{}),a=(s=>(s.List="list",s.Folders="folders",s))(a||{})},35886:(te,R,e)=>{"use strict";e.d(R,{N1:()=>r,W1:()=>s});var n=e(99090);const a=u=>u?!!(u.query||u.tag?.length>0||u.starred||u.sort):!1,s=()=>{const u=n.G3+".";for(let o=0;o<window.localStorage.length;o++){const l=window.localStorage.key(o);l?.startsWith(u)&&window.localStorage.removeItem(l)}},i=(u="General")=>`${SECTION_STORAGE_KEY}.${u.toLowerCase()}`,r=u=>{const o=Object.entries(u).reduce((l,[g,f])=>{if(f){if(g==="tag"&&!Array.isArray(f))return{...l,tag:[f]}}else return l;return{...l,[g]:f}},{});if(u.folder){const l=`folder:${u.folder}`;return{...o,query:`${l} ${(o.query??"").replace(l,"")}`}}return{...o}}},91259:(te,R,e)=>{"use strict";e.d(R,{Ay:()=>C,EC:()=>E,FW:()=>m,G3:()=>l,L5:()=>D,QM:()=>u,Yh:()=>y,aD:()=>g,c3:()=>b,ch:()=>o,dJ:()=>f,ew:()=>d,jE:()=>p,zh:()=>h});var n=e(65307),a=e(92654);const s={serviceAccount:{},isLoading:!0,tokens:[]},i=(0,n.Z0)({name:"serviceaccount",initialState:s,reducers:{serviceAccountFetchBegin:P=>({...P,isLoading:!0}),serviceAccountFetchEnd:P=>({...P,isLoading:!1}),serviceAccountLoaded:(P,M)=>({...P,serviceAccount:M.payload,isLoading:!1}),serviceAccountTokensLoaded:(P,M)=>({...P,tokens:M.payload,isLoading:!1}),rolesFetchBegin:P=>({...P,rolesLoading:!0}),rolesFetchEnd:P=>({...P,rolesLoading:!1})}}),r=i.reducer,{serviceAccountLoaded:u,serviceAccountTokensLoaded:o,serviceAccountFetchBegin:l,serviceAccountFetchEnd:g,rolesFetchBegin:f,rolesFetchEnd:p}=i.actions,c={serviceAccounts:[],isLoading:!0,roleOptions:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,serviceAccountStateFilter:a.i.All},x=(0,n.Z0)({name:"serviceaccounts",initialState:c,reducers:{serviceAccountsFetched:(P,M)=>{const{totalCount:O,perPage:j,...U}=M.payload,W=Math.ceil(O/j);return{...P,...U,totalPages:W,perPage:j,showPaging:W>1,isLoading:!1}},serviceAccountsFetchBegin:P=>({...P,isLoading:!0}),serviceAccountsFetchEnd:P=>({...P,isLoading:!1}),acOptionsLoaded:(P,M)=>({...P,roleOptions:M.payload}),queryChanged:(P,M)=>({...P,query:M.payload,page:0}),pageChanged:(P,M)=>({...P,page:M.payload}),stateFilterChanged:(P,M)=>({...P,serviceAccountStateFilter:M.payload})}}),v=x.reducer,{serviceAccountsFetchBegin:m,serviceAccountsFetchEnd:y,serviceAccountsFetched:h,acOptionsLoaded:d,pageChanged:E,stateFilterChanged:b,queryChanged:D}=x.actions,C={serviceAccountProfile:r,serviceAccounts:v}},69807:(te,R,e)=>{"use strict";e.d(R,{Ay:()=>x,NV:()=>p,Y1:()=>l,j7:()=>o,kH:()=>u,pB:()=>f,s7:()=>g,sF:()=>r,sJ:()=>i});var n=e(65307);const a={supportBundles:[],isLoading:!1,supportBundleCollectors:[],createBundlePageLoading:!1,loadBundlesError:"",createBundleError:""},s=(0,n.Z0)({name:"supportBundles",initialState:a,reducers:{supportBundlesLoaded:(v,m)=>({...v,supportBundles:m.payload,isLoading:!1}),fetchBegin:v=>({...v,isLoading:!0}),fetchEnd:v=>({...v,isLoading:!1}),collectorsFetchBegin:v=>({...v,createBundlePageLoading:!0}),collectorsFetchEnd:v=>({...v,createBundlePageLoading:!1}),supportBundleCollectorsLoaded:(v,m)=>({...v,supportBundleCollectors:m.payload,createBundlePageLoading:!1}),setLoadBundleError:(v,m)=>({...v,loadBundlesError:m.payload,supportBundleCollectors:[]}),setCreateBundleError:(v,m)=>({...v,createBundleError:m.payload})}}),{supportBundlesLoaded:i,fetchBegin:r,fetchEnd:u,supportBundleCollectorsLoaded:o,collectorsFetchBegin:l,collectorsFetchEnd:g,setLoadBundleError:f,setCreateBundleError:p}=s.actions,x={supportBundles:s.reducer}},27104:(te,R,e)=>{"use strict";e.d(R,{$T:()=>x,$u:()=>o,Ay:()=>d,EC:()=>u,L5:()=>r,Q9:()=>i,dJ:()=>l,jE:()=>g,tC:()=>v});var n=e(65307);const a={teams:[],page:1,query:"",perPage:30,totalPages:0,noTeams:!1,hasFetched:!1},s=(0,n.Z0)({name:"teams",initialState:a,reducers:{teamsLoaded:(E,b)=>{const{totalCount:D,perPage:C,...P}=b.payload,M=Math.ceil(D/C);return{...E,...P,totalPages:M,perPage:C,hasFetched:!0}},queryChanged:(E,b)=>({...E,page:1,query:b.payload}),pageChanged:(E,b)=>({...E,page:b.payload}),sortChanged:(E,b)=>({...E,sort:b.payload,page:1}),rolesFetchBegin:E=>({...E,rolesLoading:!0}),rolesFetchEnd:E=>({...E,rolesLoading:!1})}}),{teamsLoaded:i,queryChanged:r,pageChanged:u,sortChanged:o,rolesFetchBegin:l,rolesFetchEnd:g}=s.actions,f=s.reducer,p={team:{},members:[],groups:[],searchMemberQuery:""},c=(0,n.Z0)({name:"team",initialState:p,reducers:{teamLoaded:(E,b)=>({...E,team:b.payload}),teamMembersLoaded:(E,b)=>({...E,members:b.payload}),setSearchMemberQuery:(E,b)=>({...E,searchMemberQuery:b.payload}),teamGroupsLoaded:(E,b)=>({...E,groups:b.payload})}}),{teamLoaded:x,teamGroupsLoaded:v,teamMembersLoaded:m,setSearchMemberQuery:y}=c.actions,h=c.reducer,d={teams:f,team:h}},59373:(te,R,e)=>{"use strict";e.d(R,{w:()=>ee});var n=e(2543),a=e(37615),s=e(78282),i=e(2863),r=e(36674),u=e(739),o=e(13241),l=e(54742),g=e(8921),f=e(67933),p=e(93612),c=e(99305);let x={};function v(q){const ne=x[q];return ne||(x[q]=(0,n.property)(q))}class m{constructor(ne,se,oe){this.state={name:ne.name,value:se,text:oe,type:ne.type}}getValue(ne){let{value:se}=this.state;return se==="string"||se==="number"||se==="boolean"?se:String(se)}getValueText(){const{value:ne,text:se}=this.state;return typeof se=="string"?ne===g.To?g.Zm:se:Array.isArray(se)?se.join(" + "):(console.log("value",se),String(se))}}let y;function h(q,ne,se){return y?(y.state.name=q.name,y.state.type=q.type,y.state.value=ne,y.state.text=se):y=new m(q,ne,se),y}function d(q,ne,se,oe){if(se=se||{},q==null||(0,f.EW)(se)&&ne!==u.$m.QueryParam)return"";if(!Array.isArray(q)&&typeof q=="object"&&(q=`${q}`),typeof ne=="function")return ne(q,se,d);ne||(ne=u.$m.Glob);let de=ne.split(":");de.length>1?(ne=de[0],de=de.slice(1)):de=[];let fe=r.vz.getIfExists(ne);fe||(console.error(`Variable format ${ne} not found. Using glob format as fallback.`),fe=r.vz.get(u.$m.Glob));const ae=h(se,q,oe??q);return fe.formatter(q,de,ae)}var E=e(84743),b=e.n(E),D=e(38036),C=e(83175),P=e(60188),M=e(75421),O=e(66223),j=e(55386),U=e(95004),W=e(7102),B=e(11576),S=e(16515),_=e(71642);function K(q,ne,se){return new Proxy({},{get:(oe,de)=>{if(de==="name")return q.name;if(de==="displayName")return(0,S.Ct)(q,ne,se);if(de==="labels"||de==="formattedLabels")return q.labels?{...q.labels,__values:Object.values(q.labels).sort().join(", "),toString:()=>(0,_.h6)(q.labels,"",!0)}:""}})}function T(q,ne,se,oe){const de=L(q,ne,se);return d(de,oe)}function L(q,ne,se){const oe=se?.__dataContext;if(!oe)return q;const{frame:de,rowIndex:fe,field:ae,calculatedValue:ce}=oe.value;if(ce)switch(ne){case"numeric":return ce.numeric.toString();case"raw":return ce.numeric;case"time":return"";case"text":default:return(0,j.cN)(ce)}if(fe===void 0)return q;if(ne==="time"){const Ee=de.fields.find(Re=>Re.type===U.PU.time);return Ee?Ee.values[fe]:void 0}const ie=ae.values[fe];if(ne==="raw")return ie;const le=(ae.display??V())(ie);switch(ne){case"numeric":return le.numeric;case"text":return le.text;default:return(0,j.cN)(le)}}function A(q,ne,se,oe){const de=se?.__dataContext;if(!de||!ne)return q;const{frame:fe,rowIndex:ae}=de.value;if(ae===void 0||ne===void 0)return q;const ce={name:fe.name,refId:fe.refId,fields:(0,W.F)({frame:fe,rowIndex:ae})},ie=v(ne)(ce)??"";return d(ie,oe)}let N;function V(){return N||(N=(0,B.J)()),N}function z(q,ne,se,oe){const de=se?.__dataContext;if(!de||ne!=="name")return q;const{frame:fe,frameIndex:ae}=de.value,ce=(0,S.Ri)(fe,ae);return d(ce,oe)}function w(q,ne,se,oe){const de=se?.__dataContext;if(!de||ne===void 0||ne==="")return q;const{frame:fe,field:ae,data:ce}=de.value,ie=K(ae,fe,ce),ve=v(ne)(ie)??"";return d(ve,oe)}const H={__value:T,__data:A,__series:z,__field:w,[D.c.includeVars]:Q,[D.c.keepTime]:Z,__timezone:Y};function Q(q,ne,se){const oe=(0,O.z)(se);return C.kM.toUrlParams(oe)}function Z(){return C.kM.toUrlParams((0,M.jG)().timeRangeForUrl())}function Y(){const q=(0,P.O)({timeZone:(0,M.jG)().timeModel?.getTimezone()});return q==="browser"?b().tz.guess():q}const X={getFilteredVariables:p.bZ,getVariables:p.UN,getVariableWithName:p._2};class I{constructor(ne=X){this.dependencies=ne,this.regex=c.SY,this.index={},this.grafanaVariables=new Map,this._timeRange=null,this._adhocFiltersDeprecationWarningLogged=new Map,this._variables=[]}init(ne,se){this._variables=ne,this._timeRange=se,this.updateIndex()}get variables(){return(0,a.l)("template_srv.ts","variables","getVariables"),this.getVariables()}getVariables(){return window.__grafanaSceneContext?(0,o.E)(window.__grafanaSceneContext):this.dependencies.getVariables()}get timeRange(){return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?r.jh.getTimeRange(window.__grafanaSceneContext).state.value:this._timeRange}updateIndex(){const ne=se=>se||se==="";if(this.index=this._variables.reduce((se,oe)=>(oe.current&&(oe.current.isNone||ne(oe.current.value))&&(se[oe.name]=oe),se),{}),this.timeRange){const se=this.timeRange.from.valueOf().toString(),oe=this.timeRange.to.valueOf().toString();this.index={...this.index,__from:{current:{value:se,text:se}},__to:{current:{value:oe,text:oe}}}}}updateTimeRange(ne){this._timeRange=ne,this.updateIndex()}variableInitialized(ne){this.index[ne.name]=ne}getAdhocFilters(ne,se){let oe=[],de=(0,s.l)().getInstanceSettings(ne);if(!de)return[];!se&&!this._adhocFiltersDeprecationWarningLogged.get(de.type)&&((0,a.l)(`DataSource ${de.type}`,"templateSrv.getAdhocFilters","filters property on the request (DataQueryRequest). Or if this is called from interpolateVariablesInQueries or applyTemplateVariables it is passed as a new argument"),this._adhocFiltersDeprecationWarningLogged.set(de.type,!0));for(const fe of this.getAdHocVariables()){const ae=fe.datasource?.uid;(ae===de.uid||ae?.indexOf("$")===0&&this.replace(ae)===de.uid)&&(oe=oe.concat(fe.filters))}return oe}setGrafanaVariable(ne,se){this.grafanaVariables.set(ne,se)}setGlobalVariable(ne,se){(0,a.l)("template_srv.ts","setGlobalVariable",""),this.index={...this.index,[ne]:{current:se}}}getVariableName(ne){this.regex.lastIndex=0;const se=this.regex.exec(ne);return se?se.slice(1).find(de=>de!==void 0):null}containsTemplate(ne){if(!ne)return!1;if(window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive)return this.regex.lastIndex=0,!!this.regex.exec(ne);const se=this.getVariableName(ne),oe=se&&this.getVariableAtIndex(se);return oe!=null}variableExists(ne){return(0,a.l)("template_srv.ts","variableExists","containsTemplate"),this.containsTemplate(ne)}highlightVariablesAsHtml(ne){return!ne||!(0,n.isString)(ne)?ne:(ne=(0,n.escape)(ne),this._replaceWithVariableRegex(ne,void 0,(se,oe)=>this.getVariableAtIndex(oe)?'<span class="template-variable">'+se+"</span>":se))}getAllValue(ne){if(ne.allValue)return ne.allValue;const se=[];for(let oe=1;oe<ne.options.length;oe++)se.push(ne.options[oe].value);return se}getVariableValue(ne,se){return se?v(se)(ne.value):ne.value}getVariableText(ne,se){return ne.value===se||typeof se!="string"?ne.text:se}replace(ne,se,oe,de){if(se&&se.__sceneObject){const fe=se.__sceneObject.value.valueOf();return r.jh.interpolate(fe,ne,se,oe,de)}return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?r.jh.interpolate(window.__grafanaSceneContext,ne,se,oe,de):ne?(this.regex.lastIndex=0,this._replaceWithVariableRegex(ne,oe,(fe,ae,ce,ie)=>{const ve=this._evaluateVariableExpression(fe,ae,ce,ie,se);return de&&de.push({match:fe,variableName:ae,fieldPath:ce,format:ie,value:ve,found:ve!==fe}),ve})):ne??""}_evaluateVariableExpression(ne,se,oe,de,fe){const ae=this.getVariableAtIndex(se),ce=fe?.[se];if(ce){const Ee=this.getVariableValue(ce,oe),Re=this.getVariableText(ce,Ee);if(Ee!=null)return d(Ee,de,ae,Re)}if(!ae){const Ee=H[se];return Ee?Ee(ne,oe,fe,de):ne}if(de===u.$m.QueryParam||(0,f.EW)(ae)){const Ee=l.B.get(ae.type).getValueForUrl(ae),Re=(0,f.EW)(ae)?ae.id:ae.current.text;return d(Ee,de,ae,Re)}const ie=this.grafanaVariables.get(ae.current.value);if(ie)return d(ie,de,ae);let ve=ae.current.value,le=ae.current.text;if(this.isAllValue(ve)&&(ve=this.getAllValue(ae),le=g.Zm,ae.allValue&&de!==u.$m.Text&&de!==u.$m.PercentEncode))return this.replace(ve);if(oe){const Ee=this.getVariableValue({value:ve,text:le},oe);if(Ee!=null)return d(Ee,de,ae,le)}return d(ve,de,ae,le)}_replaceWithVariableRegex(ne,se,oe){return this.regex.lastIndex=0,ne.replace(this.regex,(de,fe,ae,ce,ie,ve,le)=>oe(de,fe||ae||ie,ve,ce||le||se))}isAllValue(ne){return ne===g.To||Array.isArray(ne)&&ne[0]===g.To}replaceWithText(ne,se){return(0,a.l)("template_srv.ts","replaceWithText()","replace(), and specify the :text format"),this.replace(ne,se,"text")}getVariableAtIndex(ne){if(ne)return this.index[ne]?this.index[ne]:this.dependencies.getVariableWithName(ne)}getAdHocVariables(){return this.dependencies.getFilteredVariables(f.EW)}}const J=new I;(0,i.d)(J);const ee=()=>J},13572:(te,R,e)=>{"use strict";e.d(R,{J:()=>v});var n=e(92745),a=e(739),s=e(44017),i=e(74848),r=e(96540),u=e(79609),o=e(2863),l=e(32881),g=e(77824),f=e(17200),p=e(72598),c=e(16553);const x=({value:m,onChange:y,item:h})=>{const[d,E]=(0,r.useState)(!1),b=(0,r.useRef)(0),D=[{label:(0,n.t)("transformers.axis-editor.mode-options.label.size","Size"),value:a.J1.Size,description:(0,n.t)("transformers.axis-editor.mode-options.description.split-the-buckets-based-on-size","Split the buckets based on size")},{label:(0,n.t)("transformers.axis-editor.mode-options.label.count","Count"),value:a.J1.Count,description:(0,n.t)("transformers.axis-editor.mode-options.description.split-the-buckets-based-on-count","Split the buckets based on count")}],C=[{label:(0,n.t)("transformers.axis-editor.log-mode-options.label.split","Split"),value:a.J1.Size,description:(0,n.t)("transformers.axis-editor.log-mode-options.description.split-the-buckets-based-on-size","Split the buckets based on size")}],P=h.settings?.allowInterval??!1,M=({mode:U,scale:W,value:B=""})=>{let S=!0;U!==a.J1.Count&&(P?B!==""&&(0,c.Fv)(B)===void 0&&(S=!1):S=(0,p.N_)(B)),E(!S),y({mode:U,scale:W,value:B})},j=(0,o.w)().getVariables().map(U=>({value:U.name,label:U.label||U.name,origin:u.$0.Template}));return(0,i.jsxs)(l.Gy,{children:[(0,i.jsx)(g.z,{value:m?.mode||a.J1.Size,options:m?.scale?.type===a.L4.Log?C:D,onChange:U=>{b.current++,M({...m,value:"",mode:U})}}),(0,i.jsx)(f.y,{invalid:d,error:"Value needs to be an integer or a variable",value:m?.value??"",placeholder:(0,n.t)("transformers.axis-editor.placeholder-auto","Auto"),onChange:U=>{M({...m,value:U})},suggestions:j},b.current)]})};function v(m,y,h,d){y.addCustomEditor({id:"xBuckets",path:`${m}xBuckets`,name:(0,n.t)("transformers.calculate-heatmap.add-heatmap-calculation-options.name-x-bucket","X Bucket"),editor:x,category:d,defaultValue:{mode:a.J1.Size},settings:{allowInterval:!0}}),y.addCustomEditor({id:"yBuckets",path:`${m}yBuckets`,name:(0,n.t)("transformers.calculate-heatmap.add-heatmap-calculation-options.name-y-bucket","Y Bucket"),editor:x,category:d,defaultValue:{mode:a.J1.Size}}),y.addCustomEditor({id:"yBuckets-scale",path:`${m}yBuckets.scale`,name:(0,n.t)("transformers.calculate-heatmap.add-heatmap-calculation-options.name-y-bucket-scale","Y Bucket scale"),category:d,editor:s.W1,defaultValue:{type:a.L4.Linear}})}},48264:(te,R,e)=>{"use strict";e.d(R,{Nb:()=>y,VQ:()=>E,eE:()=>m,wY:()=>c,yJ:()=>h});var n=e(81160),a=e(64761),s=e(79319),i=e(95004),r=e(16515),u=e(55386),o=e(39443),l=e(74261),g=e(8721),f=e(739),p=e(16553);const c={id:a.F.heatmap,name:"Create heatmap",description:"Generate heatmap data from source data.",defaultOptions:{},isApplicable:P=>{const{xField:M,yField:O,xs:j,ys:U}=b(P);return M||O||!j.length||!U.length?s.M.NotPossible:s.M.Applicable},isApplicableDescription:"The Heatmap transformation requires fields with Heatmap compatible data. No fields with Heatmap data could be found.",operator:(P,M)=>O=>O.pipe((0,n.T)(j=>c.transformer(P,M)(j))),transformer:P=>M=>{const O=E(M,P);return P.keepOriginalData?[O,...M]:[O]}};function x(P){return P==="+Inf"?1/0:P==="-Inf"?-1/0:+(P??0)}function v(P,M){return x(P)-x(M)}function m(P){return P?.meta?.custom??{}}function y(P){let M=!1;for(let O of P.fields)switch(O.name){case"y":case"yMin":case"yMax":if(M)return!1;M=!0}return M}function h(P){const M=P.frame.fields[0],O=M.values,j=P.frame.fields.filter((N,V)=>N.type===i.PU.number&&V>0),U=O.length*j.length,W=new Array(U),B=new Array(U),S=new Array(U),_=j.map(N=>N.values.slice());_.forEach((N,V)=>{for(let z=0;z<N.length;z++)S[_.length*z+V]=N[z]});const K=Array.from({length:j.length},(N,V)=>V);for(let N=0,V=0,z=0;N<U;V=++N%K.length)B[N]=K[V],V===0&&N>=K.length&&z++,W[N]=O[z];let T=j[0].labels?.le!=null?"yMax":"y";switch(P.layout){case f.D7.le:T="yMax";break;case f.D7.ge:T="yMin";break;case f.D7.unknown:T="y";break}const L={yOrdinalDisplay:j.map(N=>(0,r.Ct)(N,P.frame)),yMatchWithLabel:Object.keys(j[0].labels??{})[0]};if(L.yMatchWithLabel&&(L.yOrdinalLabel=j.map(N=>N.labels?.[L.yMatchWithLabel]??""),L.yMatchWithLabel==="le"&&(L.yMinDisplay="0.0")),P.unit?.length||P.decimals!=null){const N=(0,u.j_)(P.unit??"short");L.yMinDisplay&&(L.yMinDisplay=(0,u.cN)(N(0,P.decimals))),L.yOrdinalDisplay=L.yOrdinalDisplay.map(V=>{let z=+V;return Number.isNaN(z)?V:(0,u.cN)(N(z,P.decimals))})}const A={...j[0].config};return A.displayNameFromDS&&delete A.displayNameFromDS,{length:W.length,refId:P.frame.refId,meta:{type:o.m.HeatmapCells,custom:L},fields:[{name:M.type===i.PU.time?"xMax":"x",type:M.type,values:W,config:M.config},{name:T,type:i.PU.number,values:B,config:{unit:"short"}},{name:P.value?.length?P.value:"Value",type:i.PU.number,values:S,config:A,display:j[0].display}]}}function d(P){P=P.slice(),P.sort((O,j)=>v(O.name,j.name));const M=P.map(O=>O.fields[1].values.slice());return M.reverse(),M.forEach((O,j)=>{if(j<M.length-1)for(let U=0;U<O.length;U++)O[U]-=M[j+1][U]}),M.reverse(),P.map((O,j)=>({...O,fields:[O.fields[0],{...O.fields[1],values:M[j]}]}))}function E(P,M){const{xField:O,yField:j,xs:U,ys:W}=b(P);if(!O||!j)throw"no heatmap fields found";if(!U.length||!W.length)throw"no values found";const B=M.xBuckets??{},S=M.yBuckets??{};if(B.scale?.type===f.L4.Log)throw"X axis only supports linear buckets";const _=M.yBuckets?.scale??{type:f.L4.Linear},K=D(U,W,{xSorted:(0,g.g2)(U),xTime:O.type===i.PU.time,xMode:B.mode,xSize:B.mode===f.J1.Size?(0,p.Fv)(B.value??""):B.value?+B.value:void 0,yMode:S.mode,ySize:S.value?+S.value:void 0,yLog:_?.type===f.L4.Log?_?.log:void 0,xMin:M.timeRange?.from.valueOf(),xMax:M.timeRange?.to.valueOf()});return{length:K.x.length,name:(0,r.Ct)(j),meta:{type:o.m.HeatmapCells},fields:[{name:"xMin",type:O.type,values:K.x,config:O.config},{name:"yMin",type:i.PU.number,values:K.y,config:{...j.config,custom:{scaleDistribution:_}}},{name:"Count",type:i.PU.number,values:K.count,config:{unit:"short"}}]}}function b(P){let M,O,j=0;for(let S of P)S.fields.find(K=>K.type===i.PU.time)&&(j+=S.length);let U=Array(j),W=Array(j),B=0;for(let S of P){const _=S.fields.find(T=>T.type===i.PU.time);if(!_)continue;M||(M=_);const K=_.values;for(let T of S.fields)if(T!==_&&T.type===i.PU.number){const L=T.values;for(let A=0;A<K.length;A++,B++)U[B]=K[A],W[B]=L[A];O||(O=T)}}return{xField:M,yField:O,xs:U,ys:W}}function D(P,M,O){let j=P.length,U=O?.xSorted??!1,W=O?.ySorted??!1,B=O?.xMin??(U?P[0]:1/0),S=W?M[0]:1/0,_=O?.xMax??(U?P[j-1]:-1/0),K=W?M[j-1]:-1/0,T=O?.yLog,L=O?.xMin!=null&&O?.xMax!=null,A=O?.yMin!=null&&O?.yMax!=null;for(let oe=0;oe<j;oe++)!U&&!L&&(B=Math.min(B,P[oe]),_=Math.max(_,P[oe])),!W&&!A&&(!T||M[oe]>0)&&(S=Math.min(S,M[oe]),K=Math.max(K,M[oe]));let N=O?.xSize??0,V=O?.ySize??0,z=O?.xMode,w=O?.yMode;if((!Number.isFinite(N)||N<=0)&&(z=f.J1.Count,N=20),(!Number.isFinite(V)||V<=0)&&(w=f.J1.Count,V=10),z===f.J1.Count){let oe=(_-B)/Math.max(N-1,1),de=O?.xTime?p.q_:p.eO,fe=de.findIndex(ae=>ae>oe)-1;N=de[Math.max(fe,0)]}if(w===f.J1.Count){let oe=(K-S)/Math.max(V-1,1),de=O?.yTime?p.q_:p.eO,fe=de.findIndex(ae=>ae>oe)-1;V=de[Math.max(fe,0)]}let H=O?.xCeil?oe=>(0,l.Uh)(oe,N):oe=>(0,l.rs)(oe,N),Q=O?.yCeil?oe=>(0,l.Uh)(oe,V):oe=>(0,l.rs)(oe,V);if(T){V=1/(O?.ySize??1);let oe=T===2?Math.log2:Math.log10;Q=O?.yCeil?de=>(0,l.Uh)(oe(de),V):de=>(0,l.rs)(oe(de),V)}let Z=H(B),Y=H(_),X=Q(S),I=Q(K),J=Math.round((Y-Z)/N)+1,ee=Math.round((I-X)/V)+1,[q,ne,se]=C(J,ee,Z,N,X,V,T);for(let oe=0;oe<j;oe++){if(T&&M[oe]<=0)continue;const de=(H(P[oe])-Z)/N,fe=(Q(M[oe])-X)/V,ae=de*ee+fe;se[ae]++}return{x:q,y:ne,count:se}}function C(P,M,O,j,U,W,B){const S=P*M,_=new Array(S),K=new Array(S),T=new Array(S);for(let L=0,A=0,N=O;L<S;A=++L%M)T[L]=0,B?K[L]=B**(U+A*W):K[L]=U+A*W,A===0&&L>=M&&(N+=j),_[L]=N;return[_,K,T]}},16553:(te,R,e)=>{"use strict";e.d(R,{Fv:()=>D,eO:()=>v,q_:()=>b});var n=e(79243),a=e(74529),s=e(72598);const{abs:i,pow:r}=Math,u=new Map;function o(C,P,M,O){let j=[],U=O.map(n.E);for(let W=P;W<M;W++){let B=i(W),S=(0,n.h)(r(C,W),B);for(let _=0;_<O.length;_++){let K=O[_]*S,T=(K>=0&&W>=0?0:B)+(W>=U[_]?0:U[_]),L=(0,n.h)(K,T);j.push(L),u.set(L,T)}}return j}const l=C=>C%1===0,g=[1,1.5,2,2.5,3,3.5,4,4.5,5,5.5,6,6.5,7,7.5,8,8.5,9,9.5],f=o(10,-16,0,g),p=o(10,0,16,g),c=p.filter(l),x=f.concat(p),v=f.concat(c),m=1*1e3,y=60*m,h=60*y,d=24*h,E=365*d,b=[1,2,4,5,10,20,25,40,50,100,200,250,400,500,m,2*m,4*m,5*m,10*m,15*m,20*m,30*m,y,2*y,4*y,5*y,10*y,15*y,20*y,30*y,h,2*h,4*h,6*h,8*h,12*h,18*h,d,2*d,3*d,4*d,5*d,6*d,7*d,10*d,15*d,30*d,45*d,60*d,90*d,180*d,E,2*E,3*E,4*E,5*E,6*E,7*E,8*E,9*E,10*E],D=C=>{if((0,s.N_)(C)){const M=Number.parseInt(C,10);return Number.isNaN(M)?void 0:M}else{if((0,a.di)(C))return(0,a.WT)((0,a.E9)(C));{const O=C.match(/(\d+)ms$/i);if(O){const j=Number.parseInt(O[1],10);return Number.isNaN(j)?void 0:j}else return}}}},84510:(te,R,e)=>{"use strict";e.d(R,{$n:()=>s,g_:()=>n,uk:()=>a});var n=(r=>(r.ShortcodeFigure="shortcodeFigure",r.UIImage="uiImage",r))(n||{});const a={calculateField:{name:"Add field from calculation",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to add a new field calculated from two other fields. Each transformation allows you to add one new field.

- **Mode** - Select a mode:
  - **Reduce row** - Apply selected calculation on each row of selected fields independently.
  - **Binary operation** - Apply basic binary operations (for example, sum or multiply) on values in a single row from two selected fields.
  - **Unary operation** - Apply basic unary operations on values in a single row from a selected field. The available operations are:
    - **Absolute value (abs)** - Returns the absolute value of a given expression. It represents its distance from zero as a positive number.
    - **Natural exponential (exp)** - Returns _e_ raised to the power of a given expression.
    - **Natural logarithm (ln)** - Returns the natural logarithm of a given expression.
    - **Floor (floor)** - Returns the largest integer less than or equal to a given expression.
    - **Ceiling (ceil)** - Returns the smallest integer greater than or equal to a given expression.
  - **Cumulative functions** - Apply functions on the current row and all preceding rows.
    - **Total** - Calculates the cumulative total up to and including the current row.
    - **Mean** - Calculates the mean up to and including the current row.
  - **Window functions** - Apply window functions. The window can either be **trailing** or **centered**.
    With a trailing window the current row will be the last row in the window.
    With a centered window the window will be centered on the current row.
    For even window sizes, the window will be centered between the current row, and the previous row.
    - **Mean** - Calculates the moving mean or running average.
    - **Stddev** - Calculates the moving standard deviation.
    - **Variance** - Calculates the moving variance.
  - **Row index** - Insert a field with the row index.
- **Field name** - Select the names of fields you want to use in the calculation for the new field.
- **Calculation** - If you select **Reduce row** mode, then the **Calculation** field appears. Click in the field to see a list of calculation choices you can use to create the new field. For information about available calculations, refer to [Calculation types][].
- **Operation** - If you select **Binary operation** or **Unary operation** mode, then the **Operation** fields appear. These fields allow you to apply basic math operations on values in a single row from selected fields. You can also use numerical values for binary operations.
  - **All number fields** - Set the left side of a **Binary operation** to apply the calculation to all number fields.
- **As percentile** - If you select **Row index** mode, then the **As percentile** switch appears. This switch allows you to transform the row index as a percentage of the total number of rows.
- **Alias** - (Optional) Enter the name of your new field. If you leave this blank, then the field will be named to match the calculation.
> **Note:** If a variable is used in this transformation, the default alias will be interpolated with the value of the variable. If you want an alias to be unaffected by variable changes, explicitly define the alias.
- **Replace all fields** - (Optional) Select this option if you want to hide all other fields and display only your calculated field in the visualization.

In the example below, we added two fields together and named them Sum.

${i("/static/img/docs/transformations/add-field-from-calc-stat-example-7-0.png",r,"A stat visualization including one field called Sum")}
  `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},concatenate:{name:"Concatenate fields",getHelperDocs:function(){return`
Use this transformation to combine all fields from all frames into one result.

For example, if you have separate queries retrieving temperature and uptime data (Query A) and air quality index and error information (Query B), applying the concatenate transformation yields a consolidated data frame with all relevant information in one view.

Consider the following:

**Query A:**

| Temp  | Uptime  |
| ----- | ------- |
| 15.4  | 1230233 |

**Query B:**

| AQI   | Errors |
| ----- | ------ |
| 3.2   | 5      |

After you concatenate the fields, the data frame would be:

| Temp | Uptime  | AQI | Errors |
| ---- | ------- | --- | ------ |
| 15.4 | 1230233 | 3.2 | 5      |

This transformation simplifies the process of merging data from different sources, providing a comprehensive view for analysis and visualization.
  `}},configFromData:{name:"Config from query results",getHelperDocs:function(){return`
Use this transformation to select a query and extract standard options, such as **Min**, **Max**, **Unit**, and **Thresholds**, and apply them to other query results. This feature enables dynamic visualization configuration based on the data returned by a specific query.

#### Options

- **Config query** - Select the query that returns the data you want to use as configuration.
- **Apply to** - Select the fields or series to which the configuration should be applied.
- **Apply to options** - Specify a field type or use a field name regex, depending on your selection in **Apply to**.

#### Field mapping table

Below the configuration options, you'll find the field mapping table. This table lists all fields found in the data returned by the config query, along with **Use as** and **Select** options. It provides control over mapping fields to config properties, and for multiple rows, it allows you to choose which value to select.

#### Example

Input[0] (From query: A, name: ServerA)

| Time          | Value |
| ------------- | ----- |
| 1626178119127 | 10    |
| 1626178119129 | 30    |

Input[1] (From query: B)

| Time          | Value |
| ------------- | ----- |
| 1626178119127 | 100   |
| 1626178119129 | 100   |

Output (Same as Input[0] but now with config on the Value field)

| Time          | Value (config: Max=100) |
| ------------- | ----------------------- |
| 1626178119127 | 10                      |
| 1626178119129 | 30                      |

Each row in the source data becomes a separate field. Each field now has a maximum configuration option set. Options such as **Min**, **Max**, **Unit**, and **Thresholds** are part of the field configuration. If set, they are used by the visualization instead of any options manually configured in the panel editor options pane.

#### Value mappings

You can also transform a query result into value mappings. With this option, every row in the configuration query result defines a single value mapping row. See the following example.

Config query result:

| Value | Text   | Color |
| ----- | ------ | ----- |
| L     | Low    | blue  |
| M     | Medium | green |
| H     | High   | red   |

In the field mapping specify:

| Field | Use as                  | Select     |
| ----- | ----------------------- | ---------- |
| Value | Value mappings / Value  | All values |
| Text  | Value mappings / Text   | All values |
| Color | Value mappings / Color | All values |

Grafana builds value mappings from your query result and applies them to the real data query results. You should see values being mapped and colored according to the config query results.

> **Note:** When you use this transformation for thresholds, the visualization continues to use the panel's base threshold.

  `}},convertFieldType:{name:"Convert field type",getHelperDocs:function(){return`
Use this transformation to modify the field type of a specified field.

This transformation has the following options:

- **Field** - Select from available fields
- **as** - Select the FieldType to convert to
  - **Numeric** - attempts to make the values numbers
  - **String** - will make the values strings
  - **Time** - attempts to parse the values as time
    - The input will be parsed according to the [Moment.js parsing format](https://momentjs.com/docs/#/parsing/)
    - It will parse the numeric input as a Unix epoch timestamp in milliseconds.
      You must multiply your input by 1000 if it's in seconds.
    - Will show an option to specify a DateFormat as input by a string like yyyy-mm-dd or DD MM YYYY hh:mm:ss
  - **Boolean** - will make the values booleans
  - **Enum** - will make the values enums
    - Will show a table to manage the enums
  - **Other** - attempts to parse the values as JSON

For example, consider the following query that could be modified by selecting the time field as Time and specifying Date Format as YYYY.

#### Sample Query

| Time       | Mark  | Value |
|------------|-------|-------|
| 2017-07-01 | above | 25    |
| 2018-08-02 | below | 22    |
| 2019-09-02 | below | 29    |
| 2020-10-04 | above | 22    |

The result:

#### Transformed Query

| Time                | Mark  | Value |
|---------------------|-------|-------|
| 2017-01-01 00:00:00 | above | 25    |
| 2018-01-01 00:00:00 | below | 22    |
| 2019-01-01 00:00:00 | below | 29    |
| 2020-01-01 00:00:00 | above | 22    |

This transformation allows you to flexibly adapt your data types, ensuring compatibility and consistency in your visualizations.
  `}},extractFields:{name:"Extract fields",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to select a source of data and extract content from it in different formats. This transformation has the following fields:

- **Source** - Select the field for the source of data.
- **Format** - Choose one of the following:
  - **JSON** - Parse JSON content from the source.
  - **Key+value pairs** - Parse content in the format 'a=b' or 'c:d' from the source.
  - **RegExp** - Parse content using a regular expression with [named capturing group(s)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions/Named_capturing_group) like \`/(?<NewField>.*)/\`.
  ${i("/media/docs/grafana/panels-visualizations/screenshot-regexp-detail-v11.3-2.png",r,"Example of a regular expression")}
  - **Auto** - Discover fields automatically.
- **Replace All Fields** - (Optional) Select this option to hide all other fields and display only your calculated field in the visualization.
- **Keep Time** - (Optional) Available only if **Replace All Fields** is true. Keeps the time field in the output.

Consider the following dataset:

#### Dataset Example

| Timestamp           | json_data     |
|---------------------|---------------|
| 1636678740000000000 | {"value": 1}  |
| 1636678680000000000 | {"value": 5}  |
| 1636678620000000000 | {"value": 12} |

You could prepare the data to be used by a [Time series panel][] with this configuration:

- Source: json_data
- Format: JSON
  - Field: value
  - Alias: my_value
- Replace all fields: true
- Keep time: true

This will generate the following output:

#### Transformed Data

| Timestamp           | my_value |
|---------------------|----------|
| 1636678740000000000 | 1        |
| 1636678680000000000 | 5        |
| 1636678620000000000 | 12       |

This transformation allows you to extract and format data in various ways. You can customize the extraction format based on your specific data needs.
  `},links:[{title:"Time series panel",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/time-series/"}]},fieldLookup:{name:"Lookup fields from resource",getHelperDocs:function(){return`
Use this transformation to enrich a field value by looking up additional fields from an external source. 
  
This transformation has the following fields:

- **Field** - Select a text field from your dataset.
- **Lookup** - Choose from **Countries**, **USA States**, and **Airports**.

This transformation currently supports spatial data.

For example, if you have this data:

#### Dataset Example

| Location  | Values |
|-----------|--------|
| AL        | 0      |
| AK        | 10     |
| Arizona   | 5      |
| Arkansas  | 1      |
| Somewhere | 5      |

With this configuration:

- Field: location
- Lookup: USA States

You'll get the following output:

#### Transformed Data

| Location  | ID | Name     | Lng         | Lat       | Values |
|-----------|----|----------|-------------|-----------|--------|
| AL        | AL | Alabama  | -80.891064  | 12.448457 | 0      |
| AK        | AK | Arkansas | -100.891064 | 24.448457 | 10     |
| Arizona   |    |          |             |           | 5      |
| Arkansas  |    |          |             |           | 1      |
| Somewhere |    |          |             |           | 5      |

This transformation lets you augment your data by fetching additional information from external sources, providing a more comprehensive dataset for analysis and visualization.
  `}},filterByRefId:{name:"Filter data by query refId",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to hide one or more queries in panels that have multiple queries.

Grafana displays the query identification letters in dark gray text. Click a query identifier to toggle filtering. If the query letter is white, then the results are displayed. If the query letter is dark, then the results are hidden.

> **Note:** This transformation is not available for Graphite because this data source does not support correlating returned data with queries.

In the example below, the panel has three queries (A, B, C). We removed the B query from the visualization.

${i("/static/img/docs/transformations/filter-by-query-stat-example-7-0.png",r,"A stat visualization with results from two queries, A and C")}
  `}},filterByValue:{name:"Filter data by values",getHelperDocs:function(){return`
Use this transformation to selectively filter data points directly within your visualization. This transformation provides options to include or exclude data based on one or more conditions applied to a selected field.

This transformation is very useful if your data source does not natively filter by values. You might also use this to narrow values to display if you are using a shared query.

The available conditions for all fields are:

- **Regex** - Match a regex expression.
- **Is Null** - Match if the value is null.
- **Is Not Null** - Match if the value is not null.
- **Equal** - Match if the value is equal to the specified value.
- **Different** - Match if the value is different than the specified value.

The available conditions for string fields are:

- **Contains substring** - Match if the value contains the specified substring (case insensitive).
- **Does not contain substring** - Match if the value doesn't contain the specified substring (case insensitive).

The available conditions for number and time fields are:

- **Greater** - Match if the value is greater than the specified value.
- **Lower** - Match if the value is lower than the specified value.
- **Greater or equal** - Match if the value is greater or equal.
- **Lower or equal** - Match if the value is lower or equal.
- **Range** - Match a range between a specified minimum and maximum, min and max included. A time field will pre-populate with variables to filter by selected time.

Consider the following dataset:

#### Dataset Example

| Time                | Temperature | Altitude |
|---------------------|-------------|----------|
| 2020-07-07 11:34:23 | 32          | 101      |
| 2020-07-07 11:34:22 | 28          | 125      |
| 2020-07-07 11:34:21 | 26          | 110      |
| 2020-07-07 11:34:20 | 23          | 98       |
| 2020-07-07 10:32:24 | 31          | 95       |
| 2020-07-07 10:31:22 | 20          | 85       |
| 2020-07-07 09:30:57 | 19          | 101      |

If you **Include** the data points that have a temperature below 30\xB0C, the configuration will look as follows:

- Filter Type: 'Include'
- Condition: Rows where 'Temperature' matches 'Lower Than' '30'

And you will get the following result, where only the temperatures below 30\xB0C are included:

#### Transformed Data

| Time                | Temperature | Altitude |
|---------------------|-------------|----------|
| 2020-07-07 11:34:22 | 28          | 125      |
| 2020-07-07 11:34:21 | 26          | 110      |
| 2020-07-07 11:34:20 | 23          | 98       |
| 2020-07-07 10:31:22 | 20          | 85       |
| 2020-07-07 09:30:57 | 19          | 101      |

You can add more than one condition to the filter. For example, you might want to include the data only if the altitude is greater than 100. To do so, add that condition to the following configuration:

- Filter type: 'Include' rows that 'Match All' conditions
- Condition 1: Rows where 'Temperature' matches 'Lower' than '30'
- Condition 2: Rows where 'Altitude' matches 'Greater' than '100'

When you have more than one condition, you can choose if you want the action (include/exclude) to be applied on rows that **Match all** conditions or **Match any** of the conditions you added.

In the example above, we chose **Match all** because we wanted to include the rows that have a temperature lower than 30\xB0C *AND* an altitude higher than 100. If we wanted to include the rows that have a temperature lower than 30\xB0C *OR* an altitude higher than 100 instead, then we would select **Match any**. This would include the first row in the original data, which has a temperature of 32\xB0C (does not match the first condition) but an altitude of 101 (which matches the second condition), so it is included.

Conditions that are invalid or incompletely configured are ignored.

This versatile data filtering transformation lets you to selectively include or exclude data points based on specific conditions. Customize the criteria to tailor your data presentation to meet your unique analytical needs.
  `}},filterFieldsByName:{name:"Filter fields by name",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to selectively remove parts of your query results. There are three ways to filter field names:

- [Using a regular expression](#use-a-regular-expression)
- [Manually selecting included fields](#manually-select-included-fields)
- [Using a dashboard variable](#use-a-dashboard-variable)

#### Use a regular expression

When you filter using a regular expression, field names that match the regular expression are included. 

For example, from the input data:

| Time                | dev-eu-west | dev-eu-north | prod-eu-west | prod-eu-north |
| ------------------- | ----------- | ------------ | ------------ | ------------- |
| 2023-03-04 23:56:23 | 23.5        | 24.5         | 22.2         | 20.2          |
| 2023-03-04 23:56:23 | 23.6        | 24.4         | 22.1         | 20.1          |

The result from using the regular expression 'prod.*' would be:

| Time                | prod-eu-west | prod-eu-north |
| ------------------- | ------------ | ------------- |
| 2023-03-04 23:56:23 | 22.2         | 20.2          |
| 2023-03-04 23:56:23 | 22.1         | 20.1          |

The regular expression can include an interpolated dashboard variable by using the \${variableName} syntax.

#### Manually select included fields

Click and uncheck the field names to remove them from the result. Fields that are matched by the regular expression are still included, even if they're unchecked.

#### Use a dashboard variable

Enable 'From variable' to let you select a dashboard variable that's used to include fields. By setting up a [dashboard variable][] with multiple choices, the same fields can be displayed across multiple visualizations.

${i("/static/img/docs/transformations/filter-name-table-before-7-0.png",r,"A table visualization with time, value, Min, and Max columns")}

Here's the table after we applied the transformation to remove the Min field.

${i("/static/img/docs/transformations/filter-name-table-after-7-0.png",r,"A table visualization with time, value, and Max columns")}

Here is the same query using a Stat visualization.

${i("/static/img/docs/transformations/filter-name-stat-after-7-0.png",r,"A stat visualization with value and Max fields")}

This transformation provides flexibility in tailoring your query results to focus on the specific fields you need for effective analysis and visualization.
  `}},formatString:{name:"Format string",getHelperDocs:function(){return`
Use this transformation to customize the output of a string field. This transformation has the following fields:

- **Upper case** - Formats the entire string in uppercase characters.
- **Lower case** - Formats the entire string in lowercase characters.
- **Sentence case** - Formats the first character of the string in uppercase.
- **Title case** - Formats the first character of each word in the string in uppercase.
- **Pascal case** - Formats the first character of each word in the string in uppercase and doesn't include spaces between words.
- **Camel case** - Formats the first character of each word in the string in uppercase, except the first word, and doesn't include spaces between words.
- **Snake case** - Formats all characters in the string in lowercase and uses underscores instead of spaces between words.
- **Kebab case** - Formats all characters in the string in lowercase and uses dashes instead of spaces between words.
- **Trim** - Removes all leading and trailing spaces from the string.
- **Substring** - Returns a substring of the string, using the specified start and end positions.

This transformation provides a convenient way to standardize and tailor the presentation of string data for better visualization and analysis.`}},formatTime:{name:"Format time",getHelperDocs:function(){return`
Use this transformation to customize the output of a time field. Output can be formatted using [Moment.js format strings](https://momentjs.com/docs/#/displaying/). For example, if you want to display only the year of a time field, the format string 'YYYY' can be used to show the calendar year (for example, 1999 or 2012).

**Before Transformation:**

| Timestamp           | Event        |
| ------------------- | ------------ |
| 1636678740000000000 | System Start |
| 1636678680000000000 | User Login   |
| 1636678620000000000 | Data Updated |

**After applying 'YYYY-MM-DD HH:mm:ss':**

| Timestamp           | Event        |
| ------------------- | ------------ |
| 2021-11-12 14:25:40 | System Start |
| 2021-11-12 14:24:40 | User Login   |
| 2021-11-12 14:23:40 | Data Updated |

This transformation lets you tailor the time representation in your visualizations, providing flexibility and precision in displaying temporal data.

> **Note:** This transformation is available in Grafana 10.1+ as an alpha feature.
  `}},groupBy:{name:"Group by",getHelperDocs:function(){return`
Use this transformation to group the data by a specified field (column) value and process calculations on each group. Click to see a list of calculation choices. For information about available calculations, refer to [Calculation types][].

Here's an example of original data.

| Time                | Server ID | CPU Temperature | Server Status |
| ------------------- | --------- | --------------- | ------------- |
| 2020-07-07 11:34:20 | server 1  | 80              | Shutdown      |
| 2020-07-07 11:34:20 | server 3  | 62              | OK            |
| 2020-07-07 10:32:20 | server 2  | 90              | Overload      |
| 2020-07-07 10:31:22 | server 3  | 55              | OK            |
| 2020-07-07 09:30:57 | server 3  | 62              | Rebooting     |
| 2020-07-07 09:30:05 | server 2  | 88              | OK            |
| 2020-07-07 09:28:06 | server 1  | 80              | OK            |
| 2020-07-07 09:25:05 | server 2  | 88              | OK            |
| 2020-07-07 09:23:07 | server 1  | 86              | OK            |

This transformation goes in two steps. First you specify one or multiple fields to group the data by. This will group all the same values of those fields together, as if you sorted them. For instance if we group by the Server ID field, then it would group the data this way:

| Time                | Server ID      | CPU Temperature | Server Status |
| ------------------- | -------------- | --------------- | ------------- |
| 2020-07-07 11:34:20 | **server 1**   | 80              | Shutdown      |
| 2020-07-07 09:28:06 | **server 1**   | 80              | OK            |
| 2020-07-07 09:23:07 | **server 1**   | 86              | OK            |
| 2020-07-07 10:32:20 | server 2       | 90              | Overload      |
| 2020-07-07 09:30:05 | server 2       | 88              | OK            |
| 2020-07-07 09:25:05 | server 2       | 88              | OK            |
| 2020-07-07 11:34:20 | **_server 3_** | 62              | OK            |
| 2020-07-07 10:31:22 | **_server 3_** | 55              | OK            |
| 2020-07-07 09:30:57 | **_server 3_** | 62              | Rebooting     |

All rows with the same value of Server ID are grouped together.

After choosing which field you want to group your data by, you can add various calculations on the other fields, and apply the calculation to each group of rows. For instance, we could want to calculate the average CPU temperature for each of those servers. So we can add the _mean_ calculation applied on the CPU Temperature field to get the following:

| Server ID | CPU Temperature (mean) |
| --------- | ---------------------- |
| server 1  | 82                     |
| server 2  | 88.6                   |
| server 3  | 59.6                   |

And we can add more than one calculation. For instance:

- For field Time, we can calculate the _Last_ value, to know when the last data point was received for each server
- For field Server Status, we can calculate the _Last_ value to know what is the last state value for each server
- For field Temperature, we can also calculate the _Last_ value to know what is the latest monitored temperature for each server

We would then get:

| Server ID | CPU Temperature (mean) | CPU Temperature (last) | Time (last)         | Server Status (last) |
| --------- | ---------------------- | ---------------------- | ------------------- | -------------------- |
| server 1  | 82                     | 80                     | 2020-07-07 11:34:20 | Shutdown             |
| server 2  | 88.6                   | 90                     | 2020-07-07 10:32:20 | Overload             |
| server 3  | 59.6                   | 62                     | 2020-07-07 11:34:20 | OK                   |

This transformation allows you to extract essential information from your time series and present it conveniently.
  `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},groupingToMatrix:{name:"Grouping to matrix",getHelperDocs:function(){return`
Use this transformation to combine three fields\u2014which are used as input for the **Column**, **Row**, and **Cell value** fields from the query output\u2014and generate a matrix. The matrix is calculated as follows:

**Original data**

| Server ID | CPU Temperature | Server Status |
| --------- | --------------- | ------------- |
| server 1  | 82              | OK            |
| server 2  | 88.6            | OK            |
| server 3  | 59.6            | Shutdown      |

We can generate a matrix using the values of 'Server Status' as column names, the 'Server ID' values as row names, and the 'CPU Temperature' as content of each cell. The content of each cell will appear for the existing column ('Server Status') and row combination ('Server ID'). For the rest of the cells, you can select which value to display between: **Null**, **True**, **False**, or **Empty**.

**Output**

| Server IDServer Status | OK   | Shutdown |
| ----------------------- | ---- | -------- |
| server 1                | 82   |          |
| server 2                | 88.6 |          |
| server 3                |      | 59.6     |

Use this transformation to construct a matrix by specifying fields from your query results. The matrix output reflects the relationships between the unique values in these fields. This helps you present complex relationships in a clear and structured matrix format.
  `}},groupToNestedTable:{name:"Group to nested tables",getHelperDocs:function(r="shortcodeFigure"){return`
  Use this transformation to group the data by a specified field (column) value and process calculations on each group. Records are generated that share the same grouped field value, to be displayed in a nested table.
    
  To calculate a statistic for a field, click the selection box next to it and select the **Calculate** option:

  ${i("/static/img/docs/transformations/nested-table-select-calculation.png",r,"A select box showing the Group and Calculate options for the transformation.")}

  Once **Calculate** has been selected, another selection box will appear next to the respective field which will allow statistics to be selected:

  ${i("/static/img/docs/transformations/nested-table-select-stat.png",r,"A select box showing available statistic calculations once the calculate option for the field has been selected.")}

  For information about available calculations, refer to [Calculation types][].

  Here's an example of original data:

  | Time                | Server ID | CPU Temperature | Server Status |
  | ------------------- | --------- | --------------- | ------------- |
  | 2020-07-07 11:34:20 | server 1  | 80              | Shutdown      |
  | 2020-07-07 11:34:20 | server 3  | 62              | OK            |
  | 2020-07-07 10:32:20 | server 2  | 90              | Overload      |
  | 2020-07-07 10:31:22 | server 3  | 55              | OK            |
  | 2020-07-07 09:30:57 | server 3  | 62              | Rebooting     |
  | 2020-07-07 09:30:05 | server 2  | 88              | OK            |
  | 2020-07-07 09:28:06 | server 1  | 80              | OK            |
  | 2020-07-07 09:25:05 | server 2  | 88              | OK            |
  | 2020-07-07 09:23:07 | server 1  | 86              | OK            |

  This transformation has two steps. First, specify one or more fields by which to group the data. This groups all the same values of those fields together, as if you sorted them. For instance, if you group by the Server ID field, Grafana groups the data this way:

  | Server ID      |  |
  | -------------- | ------------- |
  | server 1 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>80</td><td>Shutdown</td></tr><tr><td>2020-07-07 09:28:06</td><td>80</td><td>OK</td></tr><tr><td>2020-07-07 09:23:07</td><td>86</td><td>OK</td></tr></tbody></table> |
  | server 2 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 10:32:20</td><td>90</td><td>Overload</td></tr><tr><td>2020-07-07 09:30:05</td><td>88</td><td>OK</td></tr><tr><td>2020-07-07 09:25:05</td><td>88</td><td>OK</td></tr></tbody></table> |
  | server 3 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>62</td><td>OK</td></tr><tr><td>2020-07-07 10:31:22</td><td>55</td><td>OK</td></tr><tr><td>2020-07-07 09:30:57</td><td>62</td><td>Rebooting</td></tr></tbody></table> |

  After choosing the field by which you want to group your data, you can add various calculations on the other fields and apply the calculation to each group of rows. For instance, you might want to calculate the average CPU temperature for each of those servers. To do so, add the **mean calculation** applied on the CPU Temperature field to get the following result:

  | Server ID      | CPU Temperatute (mean) | |
  | -------------- | ------------- | ------------- |
  | server 1 | 82 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>Shutdown</td></tr><tr><td>2020-07-07 09:28:06</td><td>OK</td></tr><tr><td>2020-07-07 09:23:07</td><td>OK</td></tr></tbody></table> |
  | server 2 | 88.6 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 10:32:20</td><td>Overload</td></tr><tr><td>2020-07-07 09:30:05</td><td>OK</td></tr><tr><td>2020-07-07 09:25:05</td><td>OK</td></tr></tbody></table> |
  | server 3 | 59.6 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>OK</td></tr><tr><td>2020-07-07 10:31:22</td><td>OK</td></tr><tr><td>2020-07-07 09:30:57</td><td>Rebooting</td></tr></tbody></table> |
      `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},heatmap:{name:"Create heatmap",getHelperDocs:function(){return`
Use this transformation to prepare histogram data for visualizing trends over time. Similar to the heatmap visualization, this transformation converts histogram metrics into temporal buckets.

#### X Bucket

This setting determines how the x-axis is split into buckets.

- **Size** - Specify a time interval in the input field. For example, a time range of '1h' creates cells one hour wide on the x-axis.
- **Count** - For non-time-related series, use this option to define the number of elements in a bucket.

#### Y Bucket

This setting determines how the y-axis is split into buckets.

- **Linear**
- **Logarithmic** - Choose between log base 2 or log base 10.
- **Symlog** - Uses a symmetrical logarithmic scale. Choose between log base 2 or log base 10, allowing for negative values.

Assume you have the following dataset:

| Timestamp           | Value |
|-------------------- |-------|
| 2023-01-01 12:00:00 | 5     |
| 2023-01-01 12:15:00 | 10    |
| 2023-01-01 12:30:00 | 15    |
| 2023-01-01 12:45:00 | 8     |

- With X Bucket set to 'Size: 15m' and Y Bucket as 'Linear', the histogram organizes values into time intervals of 15 minutes on the x-axis and linearly on the y-axis.
- For X Bucket as 'Count: 2' and Y Bucket as 'Logarithmic (base 10)', the histogram groups values into buckets of two on the x-axis and use a logarithmic scale on the y-axis.
  `}},histogram:{name:"Histogram",getHelperDocs:function(){return`
Use this transformation to generate a histogram based on input data, allowing you to visualize the distribution of values.

- **Bucket size** - The range between the lowest and highest items in a bucket (xMin to xMax).
- **Bucket offset** - The offset for non-zero-based buckets.
- **Combine series** - Create a unified histogram using all available series.

**Original data**

Series 1:

| A | B | C |
| - | - | - |
| 1 | 3 | 5 |
| 2 | 4 | 6 |
| 3 | 5 | 7 |
| 4 | 6 | 8 |
| 5 | 7 | 9 |

Series 2:

| C |
| - |
| 5 |
| 6 |
| 7 |
| 8 |
| 9 |

**Output**

| xMin | xMax | A | B | C | C |
| ---- | ---- | --| --| --| --|
| 1    | 2    | 1 | 0 | 0 | 0 |
| 2    | 3    | 1 | 0 | 0 | 0 |
| 3    | 4    | 1 | 1 | 0 | 0 |
| 4    | 5    | 1 | 1 | 0 | 0 |
| 5    | 6    | 1 | 1 | 1 | 1 |
| 6    | 7    | 0 | 1 | 1 | 1 |
| 7    | 8    | 0 | 1 | 1 | 1 |
| 8    | 9    | 0 | 0 | 1 | 1 |
| 9    | 10   | 0 | 0 | 1 | 1 |

Visualize the distribution of values using the generated histogram, providing insights into the data's spread and density.
  `}},joinByField:{name:"Join by field",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to merge multiple results into a single table, enabling the consolidation of data from different queries.

This is especially useful for converting multiple time series results into a single wide table with a shared time field.

#### Inner join (for Time Series or SQL-like data)

An inner join merges data from multiple tables where all tables share the same value from the selected field. This type of join excludes data where values do not match in every result.

Use this transformation to combine the results from multiple queries (combining on a passed join field or the first time column) into one result, and drop rows where a successful join cannot occur. This is not optimized for large Time Series datasets.

In the following example, two queries return Time Series data. It is visualized as two separate tables before applying the inner join transformation.

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |
| 2020-07-07 11:14:20 | postgre | 345001233 |

**Query B:**

| Time                | Server   | Errors |
| ------------------- | -------- | ------ |
| 2020-07-07 11:34:20 | server 1 | 15     |
| 2020-07-07 11:24:20 | server 2 | 5      |
| 2020-07-07 11:04:20 | server 3 | 10     |

The result after applying the inner join transformation looks like the following:

| Time                | Job     | Uptime    | Server   | Errors |
| ------------------- | ------- | --------- | -------- | ------ |
| 2020-07-07 11:34:20 | node    | 25260122  | server 1 | 15     |
| 2020-07-07 11:24:20 | postgre | 123001233 | server 2 | 5      |

This works in the same way for non-Time Series tabular data as well.

**Students**

| StudentID | Name     | Major            |
| --------- | -------- | ---------------- |
| 1         | John     | Computer Science |
| 2         | Emily    | Mathematics      |
| 3         | Michael  | Physics          |
| 4         | Jennifer | Chemistry        |

**Enrollments**

| StudentID | CourseID | Grade |
|-----------|----------|-------|
| 1         | CS101    | A     |
| 1         | CS102    | B     |
| 2         | MATH201  | A     |
| 3         | PHYS101  | B     |
| 5         | HIST101  | B     |

The result after applying the inner join transformation looks like the following:

| StudentID | Name    | Major            | CourseID | Grade |
| --------- | ------- | ---------------- | -------  | ----- |
| 1         | John    | Computer Science | CS101    | A     |
| 1         | John    | Computer Science | CS102    | B     |
| 2         | Emily   | Mathematics      | MATH201  | A     |
| 3         | Michael | Physics          | PHYS101  | B     |

The inner join only includes rows where there is a match between the "StudentID" in both tables. In this case, the result does not include "Jennifer" from the "Students" table because there are no matching enrollments for her in the "Enrollments" table.

#### Outer join (for Time Series data)

An outer join includes all data from an inner join and rows where values do not match in every input. While the inner join joins Query A and Query B on the time field, the outer join includes all rows that don't match on the time field.

In the following example, two queries return table data. It is visualized as two tables before applying the outer join transformation.

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |
| 2020-07-07 11:14:20 | postgre | 345001233 |

**Query B:**

| Time                | Server   | Errors |
| ------------------- | -------- | ------ |
| 2020-07-07 11:34:20 | server 1 | 15     |
| 2020-07-07 11:24:20 | server 2 | 5      |
| 2020-07-07 11:04:20 | server 3 | 10     |

The result after applying the outer join transformation looks like the following:

| Time                | Job     | Uptime    | Server   | Errors |
| ------------------- | ------- | --------- | -------- | ------ |
| 2020-07-07 11:04:20 |         |           | server 3 | 10     |
| 2020-07-07 11:14:20 | postgre | 345001233 |          |        |
| 2020-07-07 11:34:20 | node    | 25260122  | server 1 | 15     |
| 2020-07-07 11:24:20 | postgre | 123001233 | server 2 | 5      |

In the following example, a template query displays time series data from multiple servers in a table visualization. The results of only one query can be viewed at a time.

${i("/static/img/docs/transformations/join-fields-before-7-0.png",r,"A table visualization showing results for one server")}

I applied a transformation to join the query results using the time field. Now I can run calculations, combine, and organize the results in this new table.

${i("/static/img/docs/transformations/join-fields-after-7-0.png",r,"A table visualization showing results for multiple servers")}

#### Outer join (for SQL-like data)

A tabular outer join combining tables so that the result includes matched and unmatched rows from either or both tables.

| StudentID | Name      | Major            |
| --------- | --------- | ---------------- |
| 1         | John      | Computer Science |
| 2         | Emily     | Mathematics      |
| 3         | Michael   | Physics          |
| 4         | Jennifer  | Chemistry        |

Can now be joined with:

| StudentID | CourseID | Grade |
| --------- | -------- | ----- |
| 1         | CS101    | A     |
| 1         | CS102    | B     |
| 2         | MATH201  | A     |
| 3         | PHYS101  | B     |
| 5         | HIST101  | B     |

The result after applying the outer join transformation looks like the following:

| StudentID | Name     | Major            | CourseID | Grade |
| --------- | -------- | ---------------- | -------- | ----- |
| 1         | John     | Computer Science | CS101    | A     |
| 1         | John     | Computer Science | CS102    | B     |
| 2         | Emily    | Mathematics      | MATH201  | A     |
| 3         | Michael  | Physics          | PHYS101  | B     |
| 4         | Jennifer | Chemistry        | NULL     | NULL  |
| 5         | NULL     | NULL             | HIST101  | B     |

Combine and analyze data from various queries with table joining for a comprehensive view of your information.
  `}},joinByLabels:{name:"Join by labels",getHelperDocs:function(){return`
Use this transformation to join multiple results into a single table.

This is especially useful for converting multiple time series results into a single wide table with a shared **Label** field.

- **Join** - Select the label to join by between the labels available or common across all time series.
- **Value** - The name for the output result.

#### Example

##### Input

series1{what="Temp", cluster="A", job="J1"}

| Time | Value |
| ---- | ----- |
| 1    | 10    |
| 2    | 200   |

series2{what="Temp", cluster="B", job="J1"}

| Time | Value |
| ---- | ----- |
| 1    | 10    |
| 2    | 200   |

series3{what="Speed", cluster="B", job="J1"}

| Time | Value |
| ---- | ----- |
| 22   | 22    |
| 28   | 77    |

##### Config

value: "what"

##### Output

| cluster | job | Temp | Speed |
| ------- | --- | ---- | ----- |
| A       | J1  | 10   |       |
| A       | J1  | 200  |       |
| B       | J1  | 10   | 22    |
| B       | J1  | 200  | 77    |

Combine and organize time series data effectively with this transformation for comprehensive insights.
  `}},labelsToFields:{name:"Labels to fields",getHelperDocs:function(){return`
Use this transformation to convert time series results with labels or tags into a table, including each label's keys and values in the result. Display labels as either columns or row values for enhanced data visualization.

Given a query result of two time series:

- Series 1: labels Server=Server A, Datacenter=EU
- Series 2: labels Server=Server B, Datacenter=EU

In "Columns" mode, the result looks like this:

| Time                | Server   | Datacenter | Value |
| ------------------- | -------- | ---------- | ----- |
| 2020-07-07 11:34:20 | Server A | EU         | 1     |
| 2020-07-07 11:34:20 | Server B | EU         | 2     |

In "Rows" mode, the result has a table for each series and show each label value like this:

| label      | value    |
| ---------- | -------- |
| Server     | Server A |
| Datacenter | EU       |

| label      | value    |
| ---------- | -------- |
| Server     | Server B |
| Datacenter | EU       |

#### Value field name

If you selected Server as the **Value field name**, then you would get one field for every value of the Server label.

| Time                | Datacenter | Server A | Server B |
| ------------------- | ---------- | -------- | -------- |
| 2020-07-07 11:34:20 | EU         | 1        | 2        |

#### Merging behavior

The labels to fields transformer is internally two separate transformations. The first acts on single series and extracts labels to fields. The second is the [merge](#merge) transformation that joins all the results into a single table. The merge transformation tries to join on all matching fields. This merge step is required and cannot be turned off.

To illustrate this, here is an example where you have two queries that return time series with no overlapping labels.

- Series 1: labels Server=ServerA
- Series 2: labels Datacenter=EU

This will first result in these two tables:

| Time                | Server  | Value |
| ------------------- | ------- | ----- |
| 2020-07-07 11:34:20 | ServerA | 10    |

| Time                | Datacenter | Value |
| ------------------- | ---------- | ----- |
| 2020-07-07 11:34:20 | EU         | 20    |

After merge:

| Time                | Server  | Value | Datacenter |
| ------------------- | ------- | ----- | ---------- |
| 2020-07-07 11:34:20 | ServerA | 10    |            |
| 2020-07-07 11:34:20 |         | 20    | EU         |

Convert your time series data into a structured table format for a clearer and more organized representation.
  `}},limit:{name:"Limit",getHelperDocs:function(){return`
Use this transformation to restrict the number of rows displayed, providing a more focused view of your data. This is particularly useful when dealing with large datasets.

Below is an example illustrating the impact of the **Limit** transformation on a response from a data source:

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |

Here is the result after adding a Limit transformation with a value of '3':

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |

Using a negative number, you can keep values from the end of the set. Here is the result after adding a Limit transformation with a value of '-3':

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |


This transformation helps you tailor the visual presentation of your data to focus on the most relevant information.
  `}},merge:{name:"Merge series/tables",getHelperDocs:function(){return`
Use this transformation to combine the results from multiple queries into a single result, which is particularly useful when using the table panel visualization. This transformation merges values into the same row if the shared fields contain the same data.

Here's an example illustrating the impact of the **Merge series/tables** transformation on two queries returning table data:

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |

**Query B:**

| Time                | Job     | Errors |
| ------------------- | ------- | ------ |
| 2020-07-07 11:34:20 | node    | 15     |
| 2020-07-07 11:24:20 | postgre | 5      |

Here is the result after applying the Merge transformation.

| Time                | Job     | Errors | Uptime    |
| ------------------- | ------- | ------ | --------- |
| 2020-07-07 11:34:20 | node    | 15     | 25260122  |
| 2020-07-07 11:24:20 | postgre | 5      | 123001233 |

This transformation combines values from Query A and Query B into a unified table, enhancing the presentation of data for better insights.
  `},links:[{title:"Table panel",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/table/"}]},organize:{name:"Organize fields by name",getHelperDocs:function(){return`
Use this transformation to provide the flexibility to rename, reorder, or hide fields returned by a single query in your panel. This transformation is applicable only to panels with a single query. If your panel has multiple queries, consider using an "Outer join" transformation or removing extra queries.

#### Transforming fields

Grafana displays a list of fields returned by the query, allowing you to perform the following actions:

- **Set field order mode** - If the mode is **Manual**, you can change the field order by hovering the cursor over a field and dragging the field to its new position. If it's **Auto**, use the **OFF**, **ASC**, and **DESC** options to order by any labels on the field or by the field name. For any field that is sorted **ASC** or **DESC**, you can drag the option to set the priority of the sorting.
- **Change field order** - Hover over a field, and when your cursor turns into a hand, drag the field to its new position.
- **Hide or show a field** - Use the eye icon next to the field name to toggle the visibility of a specific field.
- **Rename fields** - Type a new name in the "Rename <field>" box to customize field names.

#### Example:

##### Original Query Result

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |

##### After Applying Field Overrides

| Time                | Sensor      | Reading |
| ------------------- | ----------- | ------- |
| 2020-07-07 11:34:20 | Temperature | 25      |
| 2020-07-07 11:34:20 | Humidity    | 22      |
| 2020-07-07 10:32:20 | Humidity    | 29      |

This transformation lets you to tailor the display of query results, ensuring a clear and insightful representation of your data in Grafana.
  `}},partitionByValues:{name:"Partition by values",getHelperDocs:function(){return`
Use this transformation to streamline the process of graphing multiple series without the need for multiple queries with different 'WHERE' clauses.

This is particularly useful when dealing with a metrics SQL table, as illustrated below:

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | US     | 1520  |
| 2022-10-20 12:00:00 | EU     | 2936  |
| 2022-10-20 01:00:00 | US     | 1327  |
| 2022-10-20 01:00:00 | EU     | 912   |

With the **Partition by values** transformation, you can issue a single query and split the results by unique values in one or more columns (fields) of your choosing. The following example uses 'Region':

'SELECT Time, Region, Value FROM metrics WHERE Time > "2022-10-20"'

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | US     | 1520  |
| 2022-10-20 01:00:00 | US     | 1327  |

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | EU     | 2936  |
| 2022-10-20 01:00:00 | EU     | 912   |

This transformation simplifies the process and enhances the flexibility of visualizing multiple series within the same time series visualization.
  `}},prepareTimeSeries:{name:"Prepare time series",getHelperDocs:function(){return`
Use this transformation to address issues when a data source returns time series data in a format that isn't compatible with the desired visualization. This transformation allows you to convert time series data between wide and long formats, providing flexibility in data frame structures.

#### Available options

##### Wide time series

Select this option to transform the time series data frame from the long format to the wide format. If your data source returns time series data in a long format and your visualization requires a wide format, this transformation simplifies the process.

A wide time series combines data into a single frame with one shared, ascending time field. Time fields do not repeat and multiple values extend in separate columns.

**Example: Converting from long to wide format**

| Timestamp           | Variable | Value |
|---------------------|----------|-------|
| 2023-01-01 00:00:00 | Value1   | 10    |
| 2023-01-01 00:00:00 | Value2   | 20    |
| 2023-01-01 01:00:00 | Value1   | 15    |
| 2023-01-01 01:00:00 | Value2   | 25    |

**Transformed to:**

| Timestamp           | Value1 | Value2 |
|---------------------|--------|--------|
| 2023-01-01 00:00:00 | 10     | 20     |
| 2023-01-01 01:00:00 | 15     | 25     |

##### Multi-frame time series

Multi-frame time series break data into multiple frames that all contain two fields: a time field and a numeric value field. Time is always ascending. String values are represented as field labels.

##### Long time series

A long time series combines data into one frame, with the first field being an ascending time field. The time field might have duplicates. String values are in separate fields, and there might be more than one. 

**Example: Converting to long format**

| Value1 | Value2 |  Timestamp          |
|--------|--------|---------------------|
| 10     | 20     | 2023-01-03 00:00:00 |
| 30     | 40     | 2023-01-02 00:00:00 |
| 50     | 60     | 2023-01-01 00:00:00 |
| 70     | 80     | 2023-01-01 00:00:00 |

**Transformed to:**

| Timestamp           | Value1 | Value2 |
|---------------------|--------|--------|
| 2023-01-01 00:00:00 | 70     | 80     |
| 2023-01-01 01:00:00 | 50     | 60     |
| 2023-01-02 01:00:00 | 30     | 40     |
| 2023-01-03 01:00:00 | 10     | 20     |

  `},links:[{title:"Data frames",url:"https://grafana.com/docs/grafana/latest/developers/plugins/introduction-to-plugin-development/data-frames/"}]},reduce:{name:"Reduce",getHelperDocs:function(){return`
Use this transformation to apply a calculation to each field in the data frame and return a single value. This transformation is particularly useful for consolidating multiple time series data into a more compact, summarized format. Time fields are removed when applying this transformation.

Consider the input:

**Query A:**

| Time                | Temp | Uptime  |
| ------------------- | ---- | ------- |
| 2020-07-07 11:34:20 | 12.3 | 256122  |
| 2020-07-07 11:24:20 | 15.4 | 1230233 |

**Query B:**

| Time                | AQI | Errors |
| ------------------- | --- | ------ |
| 2020-07-07 11:34:20 | 6.5 | 15     |
| 2020-07-07 11:24:20 | 3.2 | 5      |

The reduce transformer has two modes:

- **Series to rows** - Creates a row for each field and a column for each calculation.
- **Reduce fields** - Keeps the existing frame structure, but collapses each field into a single value.

For example, if you used the **First** and **Last** calculation with a **Series to rows** transformation, then
the result would be:

| Field  | First  | Last    |
| ------ | ------ | ------- |
| Temp   | 12.3   | 15.4    |
| Uptime | 256122 | 1230233 |
| AQI    | 6.5    | 3.2     |
| Errors | 15     | 5       |

The **Reduce fields** with the **Last** calculation,
results in two frames, each with one row:

**Query A:**

| Temp | Uptime  |
| ---- | ------- |
| 15.4 | 1230233 |

**Query B:**

| AQI | Errors |
| --- | ------ |
| 3.2 | 5      |

This flexible transformation simplifies the process of consolidating and summarizing data from multiple time series into a more manageable and organized format.
  `}},renameByRegex:{name:"Rename by regex",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to rename parts of the query results using a regular expression and replacement pattern.

You can specify a regular expression, which is only applied to matches, along with a replacement pattern that support back references. For example, let's imagine you're visualizing CPU usage per host and you want to remove the domain name. You could set the regex to '/^([^.]+).*/' and the replacement pattern to '$1', 'web-01.example.com' would become 'web-01'.

> **Note:** The Rename by regex transformation was improved in Grafana v9.0.0 to allow global patterns of the form '/<stringToReplace>/g'. Depending on the regex match used, this may cause some transformations to behave slightly differently. You can guarantee the same behavior as before by wrapping the match string in forward slashes '(/)', e.g. '(.*)' would become '/(.*)/'.

In the following example, we are stripping the 'A-' prefix from field names. In the before image, you can see everything is prefixed with 'A-':

${i("/media/docs/grafana/panels-visualizations/screenshot-rename-by-regex-before-v11.0.png",r,"A time series with full series names")}

With the transformation applied, you can see we are left with just the remainder of the string.

${i("/media/docs/grafana/panels-visualizations/screenshot-rename-by-regex-after-v11.0.png",r,"A time series with shortened series names")}

This transformation lets you to tailor your data to meet your visualization needs, making your dashboards more informative and user-friendly.
  `}},rowsToFields:{name:"Rows to fields",getHelperDocs:function(){return`
Use this transformation to convert rows into separate fields. This can be useful because fields can be styled and configured individually. It can also use additional fields as sources for dynamic field configuration or map them to field labels. The additional labels can then be used to define better display names for the resulting fields.

This transformation includes a field table which lists all fields in the data returned by the configuration query. This table gives you control over what field should be mapped to each configuration property (the **Use as** option). You can also choose which value to select if there are multiple rows in the returned data.

This transformation requires:

- One field to use as the source of field names.

  By default, the transform uses the first string field as the source. You can override this default setting by selecting **Field name** in the **Use as** column for the field you want to use instead.

- One field to use as the source of values.

  By default, the transform uses the first number field as the source. But you can override this default setting by selecting **Field value** in the **Use as** column for the field you want to use instead.

Useful when visualizing data in:

- Gauge
- Stat
- Pie chart

#### Map extra fields to labels

If a field does not map to config property Grafana will automatically use it as source for a label on the output field-

**Example:**

| Name    | DataCenter | Value |
| ------- | ---------- | ----- |
| ServerA | US         | 100   |
| ServerB | EU         | 200   |

**Output:**

| ServerA (labels: DataCenter: US) | ServerB (labels: DataCenter: EU) |
| -------------------------------- | -------------------------------- |
| 10                               | 20                               |

The extra labels can now be used in the field display name provide more complete field names.

If you want to extract config from one query and apply it to another you should use the config from query results transformation.

#### Example

**Input:**

| Name    | Value | Max |
| ------- | ----- | --- |
| ServerA | 10    | 100 |
| ServerB | 20    | 200 |
| ServerC | 30    | 300 |

**Output:**

| ServerA (config: max=100) | ServerB (config: max=200) | ServerC (config: max=300) |
| ------------------------- | ------------------------- | ------------------------- |
| 10                        | 20                        | 30                        |

As you can see each row in the source data becomes a separate field. Each field now also has a max config option set. Options like **Min**, **Max**, **Unit** and **Thresholds** are all part of field configuration and if set like this will be used by the visualization instead of any options manually configured in the panel editor options pane.

This transformation enables the conversion of rows into individual fields, facilitates dynamic field configuration, and maps additional fields to labels.
  `}},seriesToRows:{name:"Series to rows",getHelperDocs:function(){return`
Use this transformation to combine the result from multiple time series data queries into one single result. This is helpful when using the table panel visualization.

The result from this transformation will contain three columns: Time, Metric, and Value. The Metric column is added so you easily can see from which query the metric originates from. Customize this value by defining Label on the source query.

In the example below, we have two queries returning time series data. It is visualized as two separate tables before applying the transformation.

**Query A:**

| Time                | Temperature |
| ------------------- | ----------- |
| 2020-07-07 11:34:20 | 25          |
| 2020-07-07 10:31:22 | 22          |
| 2020-07-07 09:30:05 | 19          |

**Query B:**

| Time                | Humidity |
| ------------------- | -------- |
| 2020-07-07 11:34:20 | 24       |
| 2020-07-07 10:32:20 | 29       |
| 2020-07-07 09:30:57 | 33       |

Here is the result after applying the Series to rows transformation.

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |

This transformation facilitates the consolidation of results from multiple time series queries, providing a streamlined and unified dataset for efficient analysis and visualization in a tabular format.

  `}},sortBy:{name:"Sort by",getHelperDocs:function(){return`
Use this transformation to sort each frame within a query result based on a specified field, making your data easier to understand and analyze. By configuring the desired field for sorting, you can control the order in which the data is presented in the table or visualization.

Use the **Reverse** switch to inversely order the values within the specified field. This functionality is particularly useful when you want to quickly toggle between ascending and descending order to suit your analytical needs.

For example, in a scenario where time-series data is retrieved from a data source, the **Sort by** transformation can be applied to arrange the data frames based on the timestamp, either in ascending or descending order, depending on the analytical requirements. This capability ensures that you can easily navigate and interpret time-series data, gaining valuable insights from the organized and visually coherent presentation.
  `}},spatial:{name:"Spatial",getHelperDocs:function(){return`
Use this transformation to apply spatial operations to query results.

- **Action** - Select an action:
  - **Prepare spatial field** - Set a geometry field based on the results of other fields.
    - **Location mode** - Select a location mode (these options are shared by the **Calculate value** and **Transform** modes):
      - **Auto** - Automatically identify location data based on default field names.
      - **Coords** - Specify latitude and longitude fields.
      - **Geohash** - Specify a geohash field.
      - **Lookup** - Specify Gazetteer location fields.
  - **Calculate value** - Use the geometry to define a new field (heading/distance/area).
    - **Function** - Choose a mathematical operation to apply to the geometry:
      - **Heading** - Calculate the heading (direction) between two points.
      - **Area** - Calculate the area enclosed by a polygon defined by the geometry.
      - **Distance** - Calculate the distance between two points.
  - **Transform** - Apply spatial operations to the geometry.
    - **Operation** - Choose an operation to apply to the geometry:
      - **As line** - Create a single line feature with a vertex at each row.
      - **Line builder** - Create a line between two points.

This transformation allows you to manipulate and analyze geospatial data, enabling operations such as creating lines between points, calculating spatial properties, and more.
  `}},timeSeriesTable:{name:"Time series to table transform",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to convert time series results into a table, transforming a time series data frame into a **Trend** field which can then be used with the [sparkline cell type][]. If there are multiple time series queries, each will result in a separate table data frame. These can be joined using join or merge transforms to produce a single table with multiple sparklines per row.

${i("/static/img/docs/transformations/table-sparklines.png",r,"A table panel showing multiple values and their corresponding sparklines.")}

For each generated **Trend** field value, a calculation function can be selected. This value is displayed next to the sparkline and will be used for sorting table rows.

${i("/static/img/docs/transformations/timeseries-table-select-stat.png",r,"A select box showing available statistics that can be calculated.")}


> **Note:** This transformation is available in Grafana 9.5+ as an opt-in beta feature. Modify the Grafana [configuration file][] to use it.
  `},links:[{title:"sparkline cell type",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/table/#sparkline"},{title:"configuration file",url:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-grafana/"}]},transpose:{name:"Transpose",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to pivot the data frame, converting rows into columns and columns into rows. This transformation is particularly useful when you want to switch the orientation of your data to better suit your visualization needs.
If you have multiple types it will default to string type.

**Before Transformation:**

| env  | January   | February |
| ---- | --------- | -------- |
| prod | 1 | 2 |
| dev | 3 | 4 |

**After applying transpose transformation:**

| Field  | prod   | dev |
| ---- | --------- | -------- |
| January | 1 | 3 |
| February  | 2 | 4 |

${i("/media/docs/grafana/transformations/screenshot-grafana-11-2-transpose-transformation.png",r,"Before and after transpose transformation")}
  `}},regression:{name:"Regression analysis",getHelperDocs:function(r="shortcodeFigure"){return`
Use this transformation to create a new data frame containing values predicted by a statistical model. This is useful for finding a trend in chaotic data. It works by fitting a mathematical function to the data, using either linear or polynomial regression. The data frame can then be used in a visualization to display a trendline.

There are two different models:

- **Linear regression** - Fits a linear function to the data.
${i("/static/img/docs/transformations/linear-regression.png",r,"A time series visualization with a straight line representing the linear function")}
- **Polynomial regression** - Fits a polynomial function to the data.
${i("/static/img/docs/transformations/polynomial-regression.png",r,"A time series visualization with a curved line representing the polynomial function")}
  `}}};function s(){return`
  Go to the <a href="https://grafana.com/docs/grafana/latest/panels/transformations/?utm_source=grafana" target="_blank" rel="noreferrer">
  transformation documentation
  </a> for more general documentation.
  `}function i(r,u,o){return u==="shortcodeFigure"?`{{< figure src="${r}" class="docs-image--no-shadow" max-width= "1100px" alt="${o}" >}}`:`![${o}](https://grafana.com${r})`}},90176:(te,R,e)=>{"use strict";e.d(R,{YD:()=>i,dy:()=>a,kD:()=>s});var n=e(739),a=(u=>(u.Prepare="prepare",u.Calculate="calculate",u.Modify="modify",u))(a||{}),s=(u=>(u.Heading="heading",u.Distance="distance",u.Area="area",u))(s||{}),i=(u=>(u.AsLine="asLine",u.LineBuilder="lineBuilder",u))(i||{});const r={action:"prepare",source:{mode:n.aG.Auto}}},78089:(te,R,e)=>{"use strict";e.d(R,{EX:()=>f,pp:()=>c,tt:()=>l});var n=e(70915),a=e(11217),s=e(44294),i=e(22796),r=e(52490),u=e(95004),o=e(90176);function l(x){const v=[];for(const m of x.values)m&&v.push(f(m));return new a.A(v)}function g(x){const v=new Array(x.length);if(x.length>1){let m=p(x[0]);for(let y=1;y<x.length;y++){let h=p(x[y]);if(m&&h){let d=Math.atan2(h[0]-m[0],h[1]-m[1])*180/Math.PI;d<0&&(d+=360),v[y-1]=v[y]=d}}}else v.fill(0);return v}function f(x){return x instanceof s.A?x.getCoordinates():(0,n.q1)(x.getExtent())}function p(x){if(x)return(0,i.WP)(f(x))}function c(x,v){const m=x.values,y=new Array(x.values.length),h=v.calc??o.kD.Heading,d=v.field??h;switch(h){case o.kD.Area:{for(let E=0;E<m.length;E++){const b=m[E];b&&(y[E]=(0,r.UG)(b))}return{name:d,type:u.PU.number,config:{unit:"areaM2"},values:y}}case o.kD.Distance:{for(let E=0;E<m.length;E++){const b=m[E];b&&(y[E]=(0,r.R3)(b))}return{name:d,type:u.PU.number,config:{unit:"lengthm"},values:y}}case o.kD.Heading:default:return{name:d,type:u.PU.number,config:{unit:"degree"},values:g(m)}}}},17200:(te,R,e)=>{"use strict";e.d(R,{c:()=>y,y:()=>d});var n=e(74848),a=e(22803),s=e(34743),i=e(83505),r=e(46885),u=e(96540),o=e(63142),l=e(15245),g=e(92807),f=e(12594),p=e(63527),c=e(87105),x=e(81563);const v=(b,D)=>b-D*Math.floor(b/D),m=8;var y=(b=>(b.InputElement="input",b.TextAreaElement="textarea",b))(y||{});const h=(b,D)=>({suggestionsWrapper:(0,a.css)({boxShadow:b.shadows.z2}),errorTooltip:(0,a.css)({position:"absolute",top:D+m+"px",zIndex:b.zIndex.tooltip}),inputWrapper:(0,a.css)({position:"relative"})}),d=({value:b="",onChange:D,suggestions:C,placeholder:P,error:M,invalid:O,type:j="input",style:U,autoFocus:W=!1})=>{const[B,S]=(0,u.useState)(!1),[_,K]=(0,u.useState)(0),[T,L]=(0,u.useState)(b.toString()),A=(0,u.useRef)(null),[N,V]=(0,u.useState)(0),[z,w]=(0,u.useState)(0),[H,Q]=(0,u.useState)(0),Z=(0,o.$j)(),Y=h(Z,z),X=(0,u.useRef)();(0,u.useEffect)(()=>{A.current?.scrollTo(0,N)},[N]);const I=[(0,s.UU)({fallbackAxisSideDirection:"start",crossAxis:!1,boundary:document.body}),(0,s.BN)()],{refs:J,floatingStyles:ee}=(0,i.we)({open:B,placement:"bottom-start",onOpenChange:S,middleware:I,whileElementsMounted:r.ll,strategy:"fixed"}),q=(0,u.useCallback)(ce=>{J.setReference(ce),X.current=ce},[J]),ne=(0,u.useRef)(null);(0,u.useEffect)(()=>{V(E(ne.current,_))},[_]);const se=u.useCallback((ce,ie=X.current)=>{const ve=ie.selectionStart,le=ie.value;le[H-1]==="$"?ie.value=le.slice(0,H)+ce.value+le.slice(ve):ie.value=le.slice(0,H)+`\${${ce.value}}`+le.slice(ve),L(ie.value),S(!1),K(0),D(ie.value)},[D,H]),oe=u.useCallback(ce=>{if(!B){if(ce.key==="$"||ce.key===" "&&ce.ctrlKey){Q(X.current.selectionStart||0),S(!0);return}return}switch(ce.key){case"Backspace":case"Escape":case"ArrowLeft":case"ArrowRight":return S(!1),K(0);case"Enter":return ce.preventDefault(),se(C[_]);case"ArrowDown":case"ArrowUp":ce.preventDefault();const ie=ce.key==="ArrowDown"?1:-1;return K(ve=>v(ve+ie,C.length));default:return}},[B,C,_,se]),de=u.useCallback(ce=>{L(ce.currentTarget.value)},[]),fe=u.useCallback(ce=>{D(ce.currentTarget.value)},[D]);(0,u.useEffect)(()=>{w(X.current.clientHeight)},[]);const ae={placeholder:P,invalid:O,value:T,onChange:de,onBlur:fe,onKeyDown:oe};return(0,n.jsxs)("div",{className:Y.inputWrapper,style:U??{},children:[B&&(0,n.jsx)(l.ZL,{children:(0,n.jsx)("div",{ref:J.setFloating,style:ee,className:Y.suggestionsWrapper,children:(0,n.jsx)(g.P,{maxHeight:"300px",onScroll:ce=>V(ce.currentTarget.scrollTop??0),ref:A,children:(0,n.jsx)(x.k,{activeRef:ne,suggestions:C,onSuggestionSelect:se,onClose:()=>S(!1),activeIndex:_})})})}),O&&M&&(0,n.jsx)("div",{className:Y.errorTooltip,children:(0,n.jsx)(f.P,{children:M})}),j==="input"?(0,n.jsx)(p.p,{...ae,ref:q,autoFocus:W}):(0,n.jsx)(c.f,{...ae,ref:q,autoFocus:W,rows:5})]})};d.displayName="SuggestionsInput";function E(b,D){return(b?.clientHeight??0)*D}},72598:(te,R,e)=>{"use strict";e.d(R,{I9:()=>v,N_:()=>c,ZI:()=>g,aG:()=>f,eJ:()=>p,gD:()=>l,qt:()=>x});var n=e(96540),a=e(16515),s=e(62717),i=e(79609),r=e(92745),u=e(2863),o=e(99305);const l=(m,y=!1)=>{let h=m.flatMap(d=>d.fields.map(E=>(0,a.Ct)(E,d,m)));if(y){let d=new Map;m.forEach(b=>b.fields.forEach(D=>{let C=d.get(D.name)??0;d.set(D.name,C+1)}));let E=[];d.forEach((b,D)=>{b>1&&E.push(D)}),h=[...new Set(E.concat(h))]}return h};function g(m,y=!1){return(0,n.useMemo)(()=>l(m,y),[m,y])}function f(m){const y=new Set;for(const h of m)for(const d of h.fields)if(d.labels)for(const E of Object.keys(d.labels))y.add(E);return y}const p={combine:"Combine",calculateNewFields:"Calculate new fields",createNewVisualization:"Create new visualization",filter:"Filter",performSpatialOperations:"Perform spatial operations",reformat:"Reformat",reorderAndRename:"Reorder and rename"},c=m=>{if(typeof m=="number"||!Number.isNaN(Number(m)))return!0;const y=o.SY.test(m);return o.SY.lastIndex=0,!!y};function x(m){const y=[];m&&(y.push({label:(0,r.t)("transformers.get-timezone-options.label.browser","Browser"),value:"browser"}),y.push({label:(0,r.t)("transformers.get-timezone-options.label.utc","UTC"),value:"utc"}));const h=(0,s.P3)();for(const d of h)y.push({label:d,value:d});return y}function v(){return(0,u.w)().getVariables().map(m=>({value:m.name,label:m.label||m.name,origin:i.$0.Template}))}},1302:(te,R,e)=>{"use strict";e.d(R,{$u:()=>p,Ay:()=>m,Cj:()=>l,EC:()=>f,Y_:()=>o,dJ:()=>c,g4:()=>g,jE:()=>x,t_:()=>r});var n=e(65307),a=e(65642);const s={users:[],searchQuery:"",page:0,perPage:30,totalPages:1,externalUserMngInfo:a.Ay.externalUserMngInfo,externalUserMngLinkName:a.Ay.externalUserMngLinkName,externalUserMngLinkUrl:a.Ay.externalUserMngLinkUrl,isLoading:!1,rolesLoading:!1},i=(0,n.Z0)({name:"users",initialState:s,reducers:{usersLoaded:(y,h)=>{const{totalCount:d,perPage:E,page:b,orgUsers:D}=h.payload,C=Math.ceil(d/E);return{...y,isLoading:!0,users:D,perPage:E,page:b,totalPages:C}},searchQueryChanged:(y,h)=>({...y,searchQuery:h.payload,page:s.page}),setUsersSearchPage:(y,h)=>({...y,page:h.payload}),pageChanged:(y,h)=>({...y,page:h.payload}),sortChanged:(y,h)=>({...y,sort:h.payload}),usersFetchBegin:y=>({...y,isLoading:!0}),usersFetchEnd:y=>({...y,isLoading:!1}),rolesFetchBegin:y=>({...y,rolesLoading:!0}),rolesFetchEnd:y=>({...y,rolesLoading:!1})}}),{searchQueryChanged:r,setUsersSearchPage:u,usersLoaded:o,usersFetchBegin:l,usersFetchEnd:g,pageChanged:f,sortChanged:p,rolesFetchBegin:c,rolesFetchEnd:x}=i.actions,m={users:i.reducer}},79776:(te,R,e)=>{"use strict";e.d(R,{o:()=>a});var n=e(43173);function a(s){const i=new URL(n.$.externalUserMngLinkUrl);return n.$.externalUserMngAnalytics&&(n.$.externalUserMngAnalyticsParams&&n.$.externalUserMngAnalyticsParams.split("&").forEach(u=>{const[o,l]=u.split("=");i.searchParams.append(o,l)}),i.searchParams.append("cnt",s)),i.toString()}},54742:(te,R,e)=>{"use strict";e.d(R,{B:()=>a});var n=e(42954);const a=new n.O},48421:(te,R,e)=>{"use strict";e.d(R,{$u:()=>v,D4:()=>h,Iv:()=>d,U2:()=>y,VT:()=>m,z_:()=>x});var n=e(2543),a=e.n(n),s=e(28998),i=e(17752),r=e(67933),u=e(39167),o=e(74887),l=e(93612),g=e(88681),f=e(99305),p=e(25206);const c="Filters",x=D=>async(C,P)=>{let M=b(D,P());if(!M&&(C(E(D)),M=b(D,P()),!M))return;const O=M.filters.findIndex(U=>U.key===D.key&&U.value===D.value);if(O===-1){const{value:U,key:W,operator:B}=D,S={value:U,key:W,operator:B};return await C(y((0,f.jX)(M),S))}const j={...M.filters[O],operator:D.operator};return await C(v((0,f.jX)(M),{index:O,filter:j}))},v=(D,C)=>async(P,M)=>{const O=(0,l.dn)(D,M());P((0,o.kb)(D.rootStateKey,(0,p.E2)((0,f.qD)(O,C)))),await P((0,u.us)((0,f.jX)(O),!0))},m=(D,C)=>async(P,M)=>{const O=(0,l.dn)(D,M());P((0,o.kb)(D.rootStateKey,(0,p.D$)((0,f.qD)(O,C)))),await P((0,u.us)((0,f.jX)(O),!0))},y=(D,C)=>async(P,M)=>{const O=(0,l.dn)(D,M());P((0,o.kb)(D.rootStateKey,(0,p.xt)((0,f.qD)(O,C)))),await P((0,u.us)((0,f.jX)(O),!0))},h=(D,C)=>async(P,M)=>{const O=(0,l.dn)(D,M());P((0,o.kb)(D.rootStateKey,(0,p.qZ)((0,f.qD)(O,C)))),await P((0,u.us)((0,f.jX)(O),!0))},d=(D,C)=>async(P,M)=>{const O=(0,l.dn)(D,M());P((0,o.kb)(D.rootStateKey,(0,g.QP)((0,f.qD)(O,{propName:"datasource",propValue:C}))));const U=(await(0,s.tR)().get(C))?.getTagKeys?"Ad hoc filters are applied automatically to all queries that target this data source":"This data source does not support ad hoc filters yet.";P((0,o.kb)(D.rootStateKey,(0,i.BC)({infoText:U})))},E=D=>(C,P)=>{const M=(0,l.y7)(P()),O={...(0,n.cloneDeep)(p.MK),datasource:D.datasource,name:c,id:c,rootStateKey:M},j=!1,U=(0,l.hk)(M,P()),W={type:"adhoc",id:O.id,rootStateKey:M};C((0,o.kb)(M,(0,g.QV)((0,f.qD)(W,{global:j,model:O,index:U}))))},b=(D,C)=>{const P=(0,l.y7)(C),M=(0,l.nx)(P,C);let O;for(const j of Object.values(M.variables))if((0,r.EW)(j)&&j.datasource?.uid===D.datasource.uid){O=j;break}return O}},25206:(te,R,e)=>{"use strict";e.d(R,{AA:()=>p,D$:()=>l,E2:()=>g,MK:()=>r,qZ:()=>f,xt:()=>o});var n=e(65307),a=e(88813),s=e(93612),i=e(96120);const r={...a.Vg,type:"adhoc",datasource:null,filters:[]},u=(0,n.Z0)({name:"templating/adhoc",initialState:i.j,reducers:{filterAdded:(c,x)=>{const v=(0,s.Fs)(c,x.payload.id);v.type==="adhoc"&&v.filters.push(x.payload.data)},filterRemoved:(c,x)=>{const v=(0,s.Fs)(c,x.payload.id);if(v.type!=="adhoc")return;const m=x.payload.data;v.filters.splice(m,1)},filterUpdated:(c,x)=>{const v=(0,s.Fs)(c,x.payload.id);if(v.type!=="adhoc")return;const{filter:m,index:y}=x.payload.data;v.filters[y]=m},filtersRestored:(c,x)=>{const v=(0,s.Fs)(c,x.payload.id);v.type==="adhoc"&&(v.filters=x.payload.data)}}}),{filterAdded:o,filterRemoved:l,filterUpdated:g,filtersRestored:f}=u.actions,p=u.reducer},8921:(te,R,e)=>{"use strict";e.d(R,{Ek:()=>r,To:()=>s,Zm:()=>a,ou:()=>i,qF:()=>n,qz:()=>u});const n="00000000-0000-0000-0000-000000000000",a="All",s="$__all",i="None",r="",u="var-"},56404:(te,R,e)=>{"use strict";e.d(R,{c:()=>g,z:()=>f});var n=e(74848),a=e(92145),s=e(96540),i=e(51898),r=e(92745),u=e(63142),o=e(87105),l=e(25379);const g="Grafana-LegacyVariableQueryEditor",f=({onChange:p,query:c})=>{const x=(0,u.of)(l.$),[v,m]=(0,s.useState)(c),y=E=>{m(E.currentTarget.value)},h=(0,s.useCallback)(E=>{p(E.currentTarget.value,E.currentTarget.value)},[p]),d=(0,a.Bi)();return(0,n.jsx)(o.f,{id:d,rows:2,value:v,onChange:y,onBlur:h,placeholder:(0,r.t)("variables.legacy-variable-query-editor.placeholder-metric-name-or-tags-query","Metric name or tags query"),required:!0,"data-testid":i.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsQueryInput,cols:52,className:x.textarea})};f.displayName=g},38681:(te,R,e)=>{"use strict";e.d(R,{y:()=>o});var n=e(74848),a=e(96540),s=e(2863),i=e(59922),r=e(67933),u=e(56404);async function o(g,f=i.cS){if((0,r.zs)(g))return g.variables.editor;if((0,r.X3)(g)){const p=await f(g.meta);if(!p.components.QueryEditor)throw new Error("Missing QueryEditor in plugin definition.");return p.components.QueryEditor??null}return(0,r.Hf)(g)?l:(0,r.d5)(g)?(await f(g.meta)).components.VariableQueryEditor??u.z:null}function l({datasource:g,query:f,onChange:p}){const c=(0,a.useCallback)(x=>{p({refId:"StandardVariableQuery",query:x})},[p]);return(0,n.jsx)(u.z,{query:f.query,onChange:c,datasource:g,templateSrv:(0,s.w)()})}},17752:(te,R,e)=>{"use strict";e.d(R,{BC:()=>g,DW:()=>u,Eo:()=>p,FN:()=>r,NY:()=>f,T7:()=>l,nS:()=>a,sJ:()=>o,wf:()=>i,y8:()=>c});var n=e(65307);const a={id:"",isValid:!0,errors:{},name:"",extended:null},s=(0,n.Z0)({name:"templating/editor",initialState:a,reducers:{variableEditorMounted:(x,v)=>{x.name=v.payload.name,x.id=v.payload.id},variableEditorUnMounted:(x,v)=>a,changeVariableNameSucceeded:(x,v)=>{x.name=v.payload.data.newName,delete x.errors.name,x.isValid=Object.keys(x.errors).length===0},changeVariableNameFailed:(x,v)=>{x.name=v.payload.newName,x.errors.name=v.payload.errorText,x.isValid=Object.keys(x.errors).length===0},addVariableEditorError:(x,v)=>{x.errors[v.payload.errorProp]=v.payload.errorText,x.isValid=Object.keys(x.errors).length===0},removeVariableEditorError:(x,v)=>{delete x.errors[v.payload.errorProp],x.isValid=Object.keys(x.errors).length===0},changeVariableEditorExtended:(x,v)=>{x.extended={...x.extended,...v.payload}},cleanEditorState:()=>a}}),i=s.reducer,{changeVariableNameSucceeded:r,changeVariableNameFailed:u,variableEditorMounted:o,variableEditorUnMounted:l,changeVariableEditorExtended:g,addVariableEditorError:f,removeVariableEditorError:p,cleanEditorState:c}=s.actions},73829:(te,R,e)=>{"use strict";e.d(R,{M:()=>n});var n=(a=>(a[a.MaxSize=50]="MaxSize",a))(n||{})},66223:(te,R,e)=>{"use strict";e.d(R,{z:()=>i});var n=e(2863),a=e(54742),s=e(8921);function i(r){const u={},o=(0,n.w)().getVariables();for(let l=0;l<o.length;l++){const g=o[l],f=r&&r[g.name];g.skipUrlSync||(f?u[s.qz+g.name]=f.value:u[s.qz+g.name]=a.B.get(g.type).getValueForUrl(g))}return u}},67933:(te,R,e)=>{"use strict";e.d(R,{CH:()=>m,EW:()=>i,Hf:()=>p,P4:()=>s,SP:()=>o,VN:()=>v,VO:()=>r,X3:()=>x,d5:()=>f,iv:()=>u,m8:()=>l,zs:()=>c});var n=e(48592),a=e(56404);const s=y=>y.type==="query",i=y=>y.type==="adhoc",r=y=>y.type==="constant",u=y=>"multi"in y,o=y=>"options"in y,l=y=>"current"in y;function g(y){return y===null?!1:typeof y=="string"}const f=y=>!!y.metricFindQuery&&!y.variables,p=y=>{if(!y.variables||y.variables.getType()!==n.Qz.Standard)return!1;const h=y.variables;return"toDataQuery"in h&&!!h.toDataQuery},c=y=>{if(!y.variables||y.variables.getType()!==n.Qz.Custom)return!1;const h=y.variables;return"query"in h&&"editor"in h&&!!h.query&&!!h.editor},x=y=>y.variables?y.variables.getType()===n.Qz.Datasource:!1;function v(y,h){return y?y.displayName===a.c||f(h):!1}function m(y,h){return y?y.displayName!==a.c&&(x(h)||p(h)||c(h)):!1}},27690:(te,R,e)=>{"use strict";e.d(R,{i:()=>o});var n=e(74848),a=e(96540),s=e(22787);const i=({nodes:l,edges:g,direction:f,width:p,height:c})=>{const x=(0,a.useRef)(null),v=(0,a.useRef)(null);return(0,a.useEffect)(()=>{(async()=>{const y=await e.e(502).then(e.t.bind(e,78993,23)),h=await e.e(9020).then(e.t.bind(e,373,23)),d={nodes:r(h,l),edges:u(h,g)},E={width:"100%",height:"100%",autoResize:!0,layout:{improvedLayout:!0,hierarchical:{enabled:!0,direction:f??"DU",sortMethod:"directed"}},interaction:{navigationButtons:!0,dragNodes:!1}};v.current&&(x.current=new y.Network(v.current,d,E))})()},[f,g,l]),(0,n.jsx)("div",{children:(0,n.jsx)("div",{ref:v,style:{width:p??"100%",height:c??"60vh"}})})};function r(l,g){const f=g.map(p=>({...p,shape:"box"}));return new l.DataSet(f)}function u(l,g){const f=g.map(p=>({...p,arrows:"to",dashes:!0}));return new l.DataSet(f)}function o({edges:l,nodes:g,show:f,title:p,children:c}){const[x,v]=(0,a.useState)(f),m=(0,a.useCallback)(()=>v(!0),[v]),y=(0,a.useCallback)(()=>v(!1),[v]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.a,{isOpen:x,title:p,icon:"info-circle",iconTooltip:"The graph can be moved, zoomed in, and zoomed out.",onClickBackdrop:y,onDismiss:y,children:(0,n.jsx)(i,{nodes:g,edges:l})}),c({showModal:m})]})}},99703:(te,R,e)=>{"use strict";e.d(R,{WT:()=>a,bX:()=>r,t4:()=>i});var n=e(65307);const a={usages:[],usagesNetwork:[]},s=(0,n.Z0)({name:"templating/inspect",initialState:a,reducers:{initInspect:(u,o)=>{const{usages:l,usagesNetwork:g}=o.payload;u.usages=l,u.usagesNetwork=g}}}),i=s.reducer,{initInspect:r}=s.actions},47969:(te,R,e)=>{"use strict";e.d(R,{qJ:()=>p,hI:()=>g,hM:()=>y,H7:()=>f,xU:()=>E,P5:()=>j,Jx:()=>m,g0:()=>h,PK:()=>M,Ow:()=>C});var n=e(38036),a=e(92745);function s(U,W){const B=new Set;for(const S of U)B.add(W(S));return B}var i=e(82612),r=e(62635),u=e(54742),o=e(67933),l=e(99305);const g=U=>{const W=[];for(const B of U)W.push({id:B.id,label:`${B.id}`});return W},f=(U,W)=>U.filter(B=>W.some(S=>S.from===B.id||S.to===B.id)),p=U=>{const W=[];for(const B of U)for(const S of U){if(B===S)continue;u.B.get(B.type).dependsOn(B,S)&&W.push({from:B.id,to:S.id})}return W};function c(U){const W=(0,l.t4)(U);if(!W)return;const B=W.slice(1).find(S=>S!==void 0);if(!(B in{}))return B}const x=(U,W)=>{l.SY.lastIndex=0;const B=[],_=(0,r.MA)(W,2).match(l.SY);if(!_)return B;for(const K of _){if(!K||K.indexOf("$__")!==-1||K.indexOf("${__")!==-1||K.indexOf("$hashKey")!==-1)continue;const T=c(K);U.some(L=>L.id===T)||B.find(L=>L===T)||T&&B.push(T)}return B},v={alias:[/^m$/,/^measurement$/,/^col$/,/^tag_(\w+|\d+)$/],query:[/^timeFilter$/]},m=(U,W,B)=>{const S=Object.keys(W.value).reduce((K,T)=>{const L=W.value[T];if(!L||typeof L!="string")return K;const A=v[T]?v[T].find(V=>V.test(U)):void 0;let N=(0,l.wJ)(L,U);return T==="repeat"&&L===U&&(N=!0),!A&&N&&(K={...K,[T]:L}),K},{}),_=Object.keys(W.value).reduce((K,T)=>{const L=W.value[T];if(L&&typeof L=="object"&&Object.keys(L).length){let A=L.title||L.name||L.id||T;Array.isArray(W.value)&&W.key==="panels"&&(A=`${A}[${L.id}]`);const N=m(U,{key:T,value:L},{});Object.keys(N).length&&(K={...K,[A]:N})}return K},{});return(Object.keys(S).length||Object.keys(_).length)&&(B={...B,...S,..._}),B},y=(U,W)=>{if(!W)return{unUsed:[],usages:[]};const B=[];let S=[];const _=W.getSaveModelCloneOld();for(const K of U){const T=K.id,L=m(T,{key:"model",value:_},{});!Object.keys(L).length&&!(0,o.EW)(K)&&B.push(K),Object.keys(L).length&&S.push({variable:K,tree:L})}return{unUsed:B,usages:S}};async function h(U,W){return new Promise((B,S)=>{setTimeout(()=>{try{const _=d(U,W);B(C(_))}catch(_){S(_)}},200)})}function d(U,W){if(!W)return[];let B=[];const S=W.getSaveModelCloneOld(),_=x(U,S);for(const K of _){const T=m(K,{key:"model",value:S},{});if(Object.keys(T).length){const L={id:K,name:K};B.push({variable:L,tree:T})}}return B}function E(U,W,B){const S=s(W.descendants(U),K=>K.name);S.add(n.c.includeVars);for(const K of U)S.add(K);return b([...S],B)}function b(U,W){const B=[];for(const S of U)W[S]&&B.push(...W[S]);return new Set(B)}const D=(U,W)=>{const{id:B,value:S}=W,{nodes:_,edges:K}=U;if(S&&typeof S=="string"){const T=`${W.id}-${S}`;return _.push({id:T,label:S}),K.push({from:T,to:B}),U}if(S&&typeof S=="object"){const T=Object.keys(S);for(const L of T){const A=`${W.id}-${L}`;_.push({id:A,label:L}),K.push({from:A,to:B}),U=D(U,{id:A,value:S[L]})}return U}return U},C=U=>{const W=[];for(const B of U){const{variable:S,tree:_}=B,K={variable:S,nodes:[{id:"dashboard",label:(0,a.t)("variables.transform-usages-to-network.result.label.dashboard","dashboard")}],edges:[],showGraph:!1};W.push(D(K,{id:"dashboard",value:_}))}return W},P=U=>Object.values(U).reduce((B,S)=>typeof S=="object"?B+P(S):B+1,0),M=(U,W)=>{const B=W.find(S=>S.variable.id===U);return B?P(B.tree):0};function O(U){const W=[];for(const B of U)W.push(B),B.panels?.length&&W.push(...O(B.panels.map(S=>new PanelModel(S))));return W}function j(U){const W={};for(const B of U){const S=(0,i.tw)(B),_=[...S.matchAll(/"repeat":"([^"]+)"/g)].map(L=>L[1]),K=S.match(l.SY)?.map(L=>c(L))??[],T=[..._,...K];for(const L of T)L in W?W[L].add(B.id):W[L]=new Set([B.id])}return W}},98732:(te,R,e)=>{"use strict";e.d(R,{E5:()=>f,Ez:()=>l,mn:()=>p});var n=e(65307),a=e(2543),s=e.n(a),i=e(7389),r=e(93612),u=e(96120),o=e(88813);const l={...o.Vg,type:"interval",auto_count:30,auto_min:"10s",options:[],auto:!1,query:"1m,10m,30m,1h,6h,12h,1d,7d,14d,30d",refresh:i.CO.onTimeRangeChanged,current:{}},g=(0,n.Z0)({name:"templating/interval",initialState:u.j,reducers:{createIntervalOptions:(c,x)=>{const v=(0,r.Fs)(c,x.payload.id);if(v.type!=="interval")return;const m=(0,a.map)(v.query.match(/(["'])(.*?)\1|\w+/g),y=>(y=y.replace(/["']+/g,""),{text:y.trim(),value:y.trim(),selected:!1}));v.auto&&m.length&&m[0].text!=="auto"&&m.unshift({text:"auto",value:"$__auto_interval_"+v.name,selected:!1}),v.options=m}}}),f=g.reducer,{createIntervalOptions:p}=g.actions},99598:(te,R,e)=>{"use strict";e.d(R,{jR:()=>U,Fu:()=>D,$z:()=>g,O$:()=>C,ho:()=>W,MO:()=>b,an:()=>P,U9:()=>E,fx:()=>O,qh:()=>j,S8:()=>M});var n=e(84139),a=e(65307),s=e(2543),i=e(94452);const r=(B,...S)=>S.reduce((_,K)=>K(_),B);var u=e(8921),o=e(67933);const l=/[^ -~]/m,g={id:"",highlightIndex:-1,queryValue:"",selectedValues:[],options:[],multi:!1},f=1e3,p=new n.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1}),c=B=>Array.isArray(B)?B.reduce((S,_)=>((0,s.isString)(_.value)&&(S[_.value]=_),S),{}):{},x=B=>{if(!Array.isArray(B.options))return B.options=[],B;const S=c(B.selectedValues);return B.selectedValues=Object.values(S),B.options=B.options.map(_=>{if(!(0,s.isString)(_.value))return _;const K=!!S[_.value];return _.selected===K?_:{..._,selected:K}}),B.options=v(B.options),B},v=B=>Array.isArray(B)?B.length<=f?B:B.slice(0,f):[],m=B=>{const{options:S,selectedValues:_}=B;return S.length===0||_.length>0||!S[0]||S[0].value!==u.To||(B.selectedValues=[{...S[0],selected:!0}]),B},y=B=>{const{selectedValues:S}=B;return S.length>1&&(B.selectedValues=S.filter(_=>_.value!==u.To)),B},h=B=>B.filter(S=>S.value!==u.To).map(S=>({...S,selected:!0})),d=(0,a.Z0)({name:"templating/optionsPicker",initialState:g,reducers:{showOptions:(B,S)=>{const{query:_,options:K}=S.payload;if(B.highlightIndex=-1,B.options=(0,s.cloneDeep)(K),B.id=S.payload.id,B.queryValue="",B.multi=!1,(0,o.iv)(S.payload)&&(B.multi=S.payload.multi??!1),(0,o.P4)(S.payload)){const{queryValue:T}=S.payload,L=(0,i.E)(_);B.queryValue=L&&T?T:""}return B.selectedValues=B.options.filter(T=>T.selected),r(B,m,x)},hideOptions:(B,S)=>({...g}),toggleOption:(B,S)=>{const{option:_,clearOthers:K,forceSelect:T}=S.payload,{multi:L,selectedValues:A}=B;if(_){const N=!A.find(V=>V.value===_.value&&V.text===_.text);if(_.value===u.To||!L||K)return N||T?B.selectedValues=[{..._,selected:!0}]:B.selectedValues=[],r(B,m,y,x);if(T||N)return B.selectedValues.push({..._,selected:!0}),r(B,m,y,x);B.selectedValues=A.filter(V=>V.value!==_.value&&V.text!==_.text)}else B.selectedValues=[];return r(B,m,y,x)},moveOptionsHighlight:(B,S)=>{let _=B.highlightIndex+S.payload;return _<0?_=-1:_>=B.options.length&&(_=B.options.length-1),{...B,highlightIndex:_}},toggleAllOptions:(B,S)=>{const _=B.selectedValues.find(T=>T.value===u.To),K=B.options.find(T=>T.value===u.To);return B.selectedValues.length>0&&K&&!_?(B.selectedValues=[],B.selectedValues.push({text:K.text??"All",value:K.value,selected:!0}),r(B,x)):_&&B.selectedValues.length===1?(B.selectedValues=h(B.options),r(B,x)):B.selectedValues.length>0&&!K?(B.selectedValues=[],r(B,x)):(B.selectedValues=h(B.options),r(B,x))},updateSearchQuery:(B,S)=>(B.queryValue=S.payload,B),updateOptionsAndFilter:(B,S)=>{const _=B.queryValue.trim();let K=[];if(_==="")K=S.payload;else if(l.test(_))K=S.payload.filter(T=>T.text.includes(_));else{const T=S.payload.map(({text:V})=>Array.isArray(V)?V.toString():V),[L,A,N]=p.search(T,_,5);L?.length&&(A&&N?K=N.map(V=>S.payload[A.idx[V]]):K=L.map(V=>S.payload[V]),K.sort((V,z)=>(V.value===u.To?-1:0)-(z.value===u.To?-1:0)))}if(B.highlightIndex=0,_!==""){let T=K.findIndex(L=>L.value!==u.To);(T===-1||K[T].value!==_)&&(K.unshift({selected:!1,text:"> "+_,value:_}),B.highlightIndex=T===-1?0:T+1)}return B.options=K,r(B,m,x)},updateOptionsFromSearch:(B,S)=>(B.options=S.payload,B.highlightIndex=0,r(B,m,x)),cleanPickerState:()=>g}}),{toggleOption:E,showOptions:b,hideOptions:D,moveOptionsHighlight:C,toggleAllOptions:P,updateSearchQuery:M,updateOptionsAndFilter:O,updateOptionsFromSearch:j,cleanPickerState:U}=d.actions,W=d.reducer},56620:(te,R,e)=>{"use strict";e.d(R,{U:()=>g});var n=e(74848),a=e(96540),s=e(7389),i=e(92745),r=e(37386),u=e(77824),o=e(51702);const l=[{label:"On dashboard load",value:s.CO.onDashboardLoad},{label:"On time range change",value:s.CO.onTimeRangeChanged}];function g({onChange:f,refresh:p,testId:c}){const x=!(0,o.i)("sm"),v=(0,a.useMemo)(()=>l.find(m=>m.value===p)?.value??l[0].value,[p]);return(0,n.jsx)(r.D,{label:(0,i.t)("variables.query-variable-refresh-select.label-refresh","Refresh"),description:(0,i.t)("variables.query-variable-refresh-select.description-update-values-variable","When to update the values of this variable"),"data-testid":c,children:(0,n.jsx)(u.z,{options:l,onChange:f,value:v,size:x?"sm":"md"})})}},83501:(te,R,e)=>{"use strict";e.d(R,{z:()=>u});var n=e(74848),a=e(96540),s=e(7389),i=e(92745),r=e(68577);function u({onChange:o,sort:l,testId:g}){const f=(0,a.useMemo)(()=>[{label:(0,i.t)("variables.query-variable-sort-select.sort_options.label.disabled","Disabled"),value:s.ZG.disabled},{label:(0,i.t)("variables.query-variable-sort-select.sort_options.label.alphabetical-asc","Alphabetical (asc)"),value:s.ZG.alphabeticalAsc},{label:(0,i.t)("variables.query-variable-sort-select.sort_options.label.alphabetical-desc","Alphabetical (desc)"),value:s.ZG.alphabeticalDesc},{label:(0,i.t)("variables.query-variable-sort-select.sort_options.label.numerical-asc","Numerical (asc)"),value:s.ZG.numericalAsc},{label:(0,i.t)("variables.query-variable-sort-select.sort_options.label.numerical-desc","Numerical (desc)"),value:s.ZG.numericalDesc},{label:(0,i.t)("variables.query-variable-sort-select.sort_options.label.alphabetical-caseinsensitive-asc","Alphabetical (case-insensitive, asc)"),value:s.ZG.alphabeticalCaseInsensitiveAsc},{label:(0,i.t)("variables.query-variable-sort-select.sort_options.label.alphabetical-caseinsensitive-desc","Alphabetical (case-insensitive, desc)"),value:s.ZG.alphabeticalCaseInsensitiveDesc},{label:(0,i.t)("variables.query-variable-sort-select.sort_options.label.natural-asc","Natural (asc)"),value:s.ZG.naturalAsc},{label:(0,i.t)("variables.query-variable-sort-select.sort_options.label.natural-desc","Natural (desc)"),value:s.ZG.naturalDesc}],[]),p=(0,a.useMemo)(()=>f.find(c=>c.value===l)??f[0],[l,f]);return(0,n.jsx)(r.v,{name:(0,i.t)("variables.query-variable-sort-select.name-sort","Sort"),description:(0,i.t)("variables.query-variable-sort-select.description-values-variable","How to sort the values of this variable"),value:p,options:f,onChange:o,testId:g,width:25})}},78763:(te,R,e)=>{"use strict";e.d(R,{C:()=>n});const n=(i,r)=>i&&(r&&!Array.isArray(i.value)?{...i,value:s(i.value),text:s(i.text)}:!r&&Array.isArray(i.value)?{...i,value:a(i.value),text:a(i.text)}:i),a=i=>Array.isArray(i)?i.length>0?i[0]:"":i,s=i=>Array.isArray(i)?i:[i]},39167:(te,R,e)=>{"use strict";e.d(R,{Y7:()=>Be,TI:()=>J,_q:()=>Ge,RK:()=>Te,t9:()=>ie,x7:()=>fe,Hn:()=>He,mZ:()=>Ke,kl:()=>ce,us:()=>le});var n=e(2543),a=e(7389),s=e(3594),i=e(28105),r=e(48480),u=e(36490),o=e(25992),l=e(43173),g=e(6890),f=e(15130),p=e(75421),c=e(8535),x=e(64762),v=e(73427),m=e(83873),y=e(68220),h=e(28998),d=e(59373),E=e(54742),b=e(8921),D=e(17752),C=e(67933),P=e(47969),M=e(99598),O=e(78763),j=e(88813),U=e(99305),W=e(21275),B=e(37918),S=e(74887),_=e(38221);const K=(he,xe=-1,me=!1,ye=!1)=>{const De={};if(ye){const Le={...initialVariableModelState,id:"__dashboard",name:"__dashboard",type:"system",index:-3,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{name:"A dashboard title",uid:"An dashboard UID",toString:()=>"A dashboard title"}}},Ve={...initialVariableModelState,id:"__org",name:"__org",type:"system",index:-2,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{name:"An org name",id:1,toString:()=>"1"}}},ze={...initialVariableModelState,id:"__user",name:"__user",type:"system",index:-1,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{login:"admin",id:1,email:"admin@test",toString:()=>"1"}}};De[Le.id]=Le,De[Ve.id]=Ve,De[ze.id]=ze}for(let Le=0;Le<he;Le++)De[Le]=createQueryVariable({id:Le.toString(),name:`Name-${Le}`,label:`Label-${Le}`,index:Le});return me&&(De[NEW_VARIABLE_ID]=createQueryVariable({id:NEW_VARIABLE_ID,name:`Name-${NEW_VARIABLE_ID}`,label:`Label-${NEW_VARIABLE_ID}`,index:he})),De},T=(he,xe={})=>{const me={id:"0",rootStateKey:"key",index:0,name:"0"};return{initialState:{0:{...{...he.initialState,...me},...xe}}}},L=()=>combineReducers({dashboard:dashboardReducer,templating:keyedVariablesReducer}),A=()=>combineReducers({templating:keyedVariablesReducer});function N(he,xe){return{templating:{lastKey:he,keys:{[he]:{...getInitialTemplatingState(),...xe}}}}}function V(he,xe){return he.find(ye=>ye.name===xe)}function z(he){return(he.type==="query"||he.type==="datasource"||he.type==="interval")&&he.refresh===W.CO.onTimeRangeChanged}var w=e(93612),H=e(88681),Q=e(74276),Z=e(77839);const Y=(he,xe)=>(me,ye)=>{let De=0;const Le=xe.templating.list;for(let ze=0;ze<Le.length;ze++){const Ze=X(Le[ze]);Ze.rootStateKey=he,E.B.getIfExists(Ze.type)&&me((0,S.kb)(he,(0,H.QV)((0,U.qD)(Ze,{global:!1,index:De++,model:Ze}))))}(0,d.w)().updateTimeRange((0,p.jG)().timeRange());const Ve=(0,w.SS)(he,ye());for(const ze of Ve)me((0,S.kb)(he,(0,H.wB)((0,U.qD)(ze))))};function X(he){if(!(0,C.SP)(he))return he;let xe=!1;for(const me of he.options)if(me.selected=!1,Array.isArray(he.current.value))for(const ye of he.current.value)me.value===ye&&(me.selected=xe=!0);else me.value===he.current.value&&(me.selected=xe=!0);return!xe&&he.options.length&&(he.options[0].selected=!0),he}const I=(he,xe)=>me=>{const ye={...j.Vg,id:"__dashboard",name:"__dashboard",type:"system",index:-3,skipUrlSync:!0,hide:a.zL.hideVariable,current:{value:{name:xe.title,uid:xe.uid,toString:()=>xe.title}}};me((0,S.kb)(he,(0,H.QV)((0,U.qD)(ye,{global:ye.global,index:ye.index,model:ye}))));const De={...j.Vg,id:"__org",name:"__org",type:"system",index:-2,skipUrlSync:!0,hide:a.zL.hideVariable,current:{value:{name:f.TP.user.orgName,id:f.TP.user.orgId,toString:()=>f.TP.user.orgId.toString()}}};me((0,S.kb)(he,(0,H.QV)((0,U.qD)(De,{global:De.global,index:De.index,model:De}))));const Le={...j.Vg,id:"__user",name:"__user",type:"system",index:-1,skipUrlSync:!0,hide:a.zL.hideVariable,current:{value:{login:f.TP.user.login,id:f.TP.user.id,email:f.TP.user.email,toString:()=>f.TP.user.id.toString()}}};me((0,S.kb)(he,(0,H.QV)((0,U.qD)(Le,{global:Le.global,index:Le.index,model:Le}))))},J=(he,xe)=>(me,ye)=>{const{rootStateKey:De}=he,Le=(0,w.dn)(he,ye());if(!(0,C.iv)(Le)||(0,s.R)(Le.current))return;const Ve=(0,O.C)(Le.current,xe);me((0,S.kb)(De,(0,H.QP)((0,U.qD)(he,{propName:"multi",propValue:xe})))),me((0,S.kb)(De,(0,H.QP)((0,U.qD)(he,{propName:"current",propValue:Ve}))))},ee=async(he,xe)=>{if(!he.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${he.id}`);if(q(he,xe))throw new Error("Circular dependency in dashboard variables detected. Dashboard may not work as expected.");const me=ne(he,xe);se(he.rootStateKey,me,xe)&&await new Promise(ye=>{const De=c.M_.subscribe(()=>{if(!he.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${he.id}`);se(he.rootStateKey,me,c.M_.getState())||(De(),ye())})})},q=(he,xe,me=new Set)=>me.has(he.id)?!0:(me=new Set([...me,he.id]),ne(he,xe).some(ye=>q(ye,xe,me))),ne=(he,xe)=>{if(!he.rootStateKey)return[];const me=[];for(const ye of(0,w.SS)(he.rootStateKey,xe))he!==ye&&E.B.getIfExists(he.type)&&E.B.get(he.type).dependsOn(he,ye)&&me.push(ye);return me},se=(he,xe,me)=>{if(xe.length===0)return!1;const ye=(0,w.SS)(he,me);return xe.filter(Le=>ye.some(Ve=>Ve.id===Le.id&&(Ve.state===i.Gu.NotStarted||Ve.state===i.Gu.Loading))).length>0},oe=(he,xe)=>async(me,ye)=>{const De=(0,w.dn)(he,ye());await ee(De,ye());const Le=xe[b.qz+De.name];if(Le!==void 0){const Ve=(0,U.QT)(Le);await E.B.get(De.type).setValueFromUrl(De,Ve);return}if(De.hasOwnProperty("refresh")){const Ve=De;if(Ve.refresh===a.CO.onDashboardLoad||Ve.refresh===a.CO.onTimeRangeChanged){await me(Ke((0,U.jX)(Ve)));return}}if(De.type==="custom"){await me(Ke((0,U.jX)(De)));return}me(we(he))},de=he=>async(xe,me)=>{const ye=u.Ny.getSearchObject(),De=(0,w.SS)(he,me()).map(async Le=>await xe(oe((0,U.jX)(Le),ye)));await Promise.all(De)},fe=(he,xe)=>async(me,ye)=>{const De=(0,U.QT)(xe),Le=(0,w.dn)(he,ye());(0,U.q$)(Le)!==a.CO.never&&await me(Ke((0,U.jX)(Le)));const Ve=(0,w.dn)((0,U.jX)(Le),ye());if(!(0,C.SP)(Ve))return;if(!Ve)throw new Error(`Couldn't find variable with name: ${Le.name}`);let ze=Ve.options.find(Ze=>Ze.text===De||Ze.value===De);if(!ze&&(0,C.iv)(Ve)&&Ve.allValue&&De===Ve.allValue&&(ze={text:b.Zm,value:b.To,selected:!1}),!ze){let Ze=De;const Me=De;Array.isArray(De)&&(Ze=De.reduce(($e,at)=>{const ct=Ve.options.find(ft=>ft.value===at);return ct?[].concat($e,[ct.text]):[].concat($e,[at])},[])),ze={text:Ze,value:Me,selected:!1}}(0,C.iv)(Ve)&&(ze=(0,O.C)({text:(0,n.castArray)(ze.text),value:(0,n.castArray)(ze.value),selected:!1},Ve.multi)),await E.B.get(Le.type).setValue(Ve,ze)},ae=he=>{let xe,me,ye,De;const Le=[];for(xe=0;xe<he.options.length;xe++)if(De={...he.options[xe]},De.selected=!1,Array.isArray(he.current.value))for(me=0;me<he.current.value.length;me++)ye=he.current.value[me],De.value===ye&&(De.selected=!0,Le.push(De));else De.value===he.current.value&&(De.selected=!0,Le.push(De));return Le},ce=(he,xe)=>(me,ye)=>{const De=(0,w.dn)(he,ye());if(!(0,C.SP)(De))return Promise.resolve();const Le=De.current||{},Ve=E.B.get(De.type).setValue;if(Array.isArray(Le.value)){const $e=ae(De);if($e.length===0){const ct=De.options[0];return Ve(De,{value:typeof ct.value=="string"?[ct.value]:ct.value,text:typeof ct.text=="string"?[ct.text]:ct.text,selected:!0})}const at={value:$e.map(ct=>ct.value),text:$e.map(ct=>ct.text),selected:!0};return Ve(De,at)}let ze=null;const Ze=(0,U.Nz)(De),Me=(0,U.Lz)(De);if(ze=De.options?.find($e=>$e.text===Ze||$e.value===Me),ze||xe&&(ze=De.options?.find($e=>$e.text===xe||$e.value===xe),ze))return Ve(De,ze);if(De.options){const $e=De.options[0];if($e)return Ve(De,$e)}return Promise.resolve()},ie=(he,xe,me)=>async ye=>{const{rootStateKey:De}=he;return ye((0,S.kb)(De,(0,H.dE)((0,U.qD)(he,{option:xe})))),await ye(le(he,me))},ve=he=>{const xe=new y.TS;return he.forEach(me=>{xe.createNode(me.name)}),he.forEach(me=>{he.forEach(ye=>{if(me!==ye&&E.B.get(me.type).dependsOn(me,ye))try{xe.link(me.name,ye.name)}catch(De){const Le=De instanceof Error?De.message:"Unknown error";(0,o.FF)("Error linking variables",{error:Le})}})}),xe},le=(he,xe,me=v.lE)=>async(ye,De)=>{const Le=De(),{rootStateKey:Ve}=he,ze=(0,w.dn)(he,Le);if((0,w.nx)(Ve,Le).transaction.status===j.x8.Fetching)return(0,U.q$)(ze)===a.CO.never&&(await ye(Xe((0,U.jX)(ze))),ye(we(he))),Promise.resolve();const Ze=(0,w.SS)(Ve,Le),Me=ve(Ze),$e=Le.dashboard?.getModel()?.panels??[],at=(0,P.P5)($e),ct=ze.type==="adhoc"?{refreshAll:!0,panelIds:[]}:{refreshAll:!1,panelIds:Array.from((0,P.xU)([ze.id],Me,at)),variable:(0,w.dn)(he,Le)},ft=Me.getNode(ze.name);let Et=[];return ft&&(Et=ft.getOptimizedInputEdges().map(St=>{const Pt=Ze.find(Dt=>Dt.name===St.inputNode?.name);return Pt?ye(Ke((0,U.jX)(Pt))):Promise.resolve()})),Promise.all(Et).then(()=>{xe&&(me.publish(new j.og(ct)),u.Ny.partial(Je(Ve,De)))})},Ee=(he,xe,me,ye)=>(xe.includes(he.name)||xe.push(he.name),he.outputEdges.forEach(De=>{const Le=De.outputNode;if(Le&&!xe.includes(Le.name)){const Ve=me.find(ze=>ze.name===Le.name);Ve&&Ve.refresh===a.CO.onTimeRangeChanged&&ye.indexOf(Ve)===-1?(ye.push(Ve),xe.push(Le.name)):Ee(Le,xe,me,ye)}}),ye),Re=(he,xe)=>he.outputEdges.every(me=>{const ye=me.outputNode;if(ye){const De=V(xe,ye.name);if(De&&De.type==="query")return De.refresh!==a.CO.onTimeRangeChanged}return!0}),Oe=(he,xe)=>{const me=(0,w.SS)(he,xe),ye=ve(me),De=[],Le=[];return me.forEach(Ve=>{const ze=ye.getNode(Ve.name);if(!De.includes(Ve.name)&&ze){const Ze=V(me,ze.name);if(!Ze)return;const Me=z(Ze);Me&&ze.outputEdges.length===0&&Le.push(Ze),Me&&Le.includes(Ze)&&ze.outputEdges.length>0&&(Le.push(Ze),Ee(ze,De,me,Le)),Me&&ze.outputEdges.length>0&&Re(ze,me)&&(Le.includes(Ze)||Le.push(Ze)),!Me&&ze.outputEdges.length>0&&Ee(ze,De,me,Le)}}),Le},Se=(he,xe)=>(0,w.SS)(he,xe).filter(De=>"refresh"in De&&"options"in De?De.refresh===a.CO.onTimeRangeChanged:!1),Te=(he,xe,me={templateSrv:(0,d.w)(),events:v.lE})=>async(ye,De)=>{me.templateSrv.updateTimeRange(xe);let Le=[];l.$.featureToggles.refactorVariablesTimeRange?Le=Oe(he,De()):Le=Se(he,De());const Ve=Le.map(Ze=>Ze.id),ze=Le.map(Ze=>ye(_e((0,U.jX)(Ze))));try{await Promise.all(ze),me.events.publish(new j.BS({variableIds:Ve}))}catch(Ze){console.error(Ze),ye((0,g.dx)(Ue("Template variable service failed",Ze)))}},_e=he=>async(xe,me)=>{const ye=(0,w.dn)(he,me());if(!(0,C.SP)(ye))return;const De=ye.options.slice();await xe(Ke((0,U.jX)(ye),!0));const Le=(0,w.dn)(he,me());if(!(0,C.SP)(Le))return;const Ve=Le.options;JSON.stringify(De)!==JSON.stringify(Ve)&&me().dashboard.getModel()?.templateVariableValueUpdated()},He=(he,xe,me=v.lE)=>async(ye,De)=>{const Le=[],Ve=De().dashboard.getModel(),ze=(0,w.SS)(he,De());for(const ct of ze){const ft=b.qz+ct.name;if(!xe.hasOwnProperty(ft)||!tt(ct,xe[ft].value))continue;let Et=xe[ft].value;if(xe[ft].removed){const Pt=Ve?.templating.list.find(Dt=>Dt.name===ct.name);Pt&&(0,C.m8)(Pt)&&(Et=Pt.current.value),Pt&&Pt.type==="constant"&&(Et=Pt.query)}const St=E.B.get(ct.type).setValueFromUrl(ct,Et);Le.push(St)}const Ze=ze.filter(ct=>{const ft=b.qz+ct.name;return xe.hasOwnProperty(ft)&&tt(ct,xe[ft].value)&&ct.type!=="adhoc"}),Me=ve(ze),$e=(0,P.P5)(Ve?.panels??[]),at=(0,P.xU)(Ze.map(ct=>ct.id),Me,$e);Le.length&&(await Promise.all(Le),me.publish(new j.eF({refreshAll:at.size===0,panelIds:Array.from(at)})))};function tt(he,xe){const me=E.B.get(he.type).getValueForUrl(he);let ye=(0,U.QT)(xe);return Array.isArray(me)&&!Array.isArray(ye)&&(ye=[ye]),!(0,n.isEqual)(me,ye)}const Je=(he,xe)=>{const me=u.Ny.getSearchObject(),ye=Object.keys(me).filter(De=>De.indexOf(b.qz)===-1).reduce((De,Le)=>(De[Le]=me[Le],De),{});for(const De of(0,w.SS)(he,xe())){if(De.skipUrlSync)continue;const Le=E.B.get(De.type);ye[b.qz+De.name]=Le.getValueForUrl(De)}return ye},Ge=(he,xe)=>async(me,ye)=>{try{const De=(0,U.q4)(he),Le=ye(),Ve=(0,w.Tk)(Le);Ve&&(0,w.nx)(Ve,Le).transaction.status===j.x8.Fetching&&me(Be(Ve)),me((0,S.kb)(De,(0,Q.kH)({uid:De}))),me(I(De,xe)),me(Y(De,xe)),me(je(De)),await me(de(De)),me((0,S.kb)(De,(0,Q.$O)({uid:De})))}catch(De){me((0,g.dx)(Ue("Templating init failed",De))),console.error(De)}};function je(he,xe=h.tR){return(me,ye)=>{const De=(0,w.SS)(he,ye());for(const Le of De){if(Le.type!=="adhoc"&&Le.type!=="query")continue;const{datasource:Ve}=Le;if((0,r.fN)(Ve))continue;const ze=xe().getInstanceSettings(Ve),Ze=ze?(0,r.p$)(ze):{uid:Ve};me((0,S.kb)(he,(0,H.QP)((0,U.qD)(Le,{propName:"datasource",propValue:Ze}))))}}}const Fe=he=>xe=>{xe((0,S.kb)(he,(0,Z.v)())),xe((0,S.kb)(he,(0,D.y8)())),xe((0,S.kb)(he,(0,M.jR)())),xe((0,S.kb)(he,(0,Q.pu)()))},Be=(he,xe={getBackendSrv:m.AI})=>me=>{xe.getBackendSrv().cancelAllInFlightRequests(),me(Fe(he))},Ke=(he,xe=!1)=>async(me,ye)=>{const{rootStateKey:De}=he;try{if(!(0,U.sN)(De,ye()))return;const Le=(0,w.dn)(he,ye());me((0,S.kb)(De,(0,H.a7)((0,U.qD)(Le)))),await me(Xe((0,U.jX)(Le))),await E.B.get(Le.type).updateOptions(Le),me(we(he))}catch(Le){if(me((0,S.kb)(De,(0,H.Te)((0,U.qD)(he,{error:Le})))),xe||(console.error(Le),me((0,g.dx)(Ue("Error updating options:",Le,he)))),xe)throw Le}},Ue=(he,xe,me)=>(0,x.gi)(`${me?`Templating [${me.id}]`:"Templating"}`,xe instanceof Error?`${he} ${xe.message}`:`${he}`),we=he=>(xe,me)=>{const{rootStateKey:ye}=he;if(!(0,U.sN)(ye,me()))return;const De=(0,w.dn)(he,me());De.state!==i.Gu.Done&&xe((0,S.kb)(he.rootStateKey,(0,H.Pu)((0,U.qD)(De))))};function Xe(he,xe=h.tR){return async function(me,ye){const{id:De,rootStateKey:Le}=he;if(!(0,U.sN)(Le,ye()))return;const Ve=(0,w.dn)(he,ye());if(Ve.type==="query")try{const ze=await xe().get(Ve.datasource??"");if((0,C.d5)(ze)||!(0,C.Hf)(ze)||nt(Ve.query))return;const Ze={refId:`${ze.name}-${De}-Variable-Query`,query:Ve.query};me((0,S.kb)(Le,(0,H.QP)((0,U.qD)(he,{propName:"query",propValue:Ze}))))}catch(ze){me((0,g.dx)(Ue("Failed to upgrade legacy queries",ze))),console.error(ze)}}}function nt(he){return(0,i.Gv)(he)&&"refId"in he&&typeof he.refId=="string"}},74887:(te,R,e)=>{"use strict";e.d(R,{Ay:()=>g,L1:()=>i,kb:()=>u});var n=e(99305),a=e(38221),s=e(74276);const i={keys:{}},r=f=>({type:`templating/keyed/${f.action.type.replace(/^templating\//,"")}`,payload:f});function u(f,p){const c=(0,n.q4)(f);return r({key:c,action:p})}const o=f=>typeof f.type=="string"&&f.type.startsWith("templating/keyed")&&"payload"in f&&typeof f.payload.key=="string";function l(f=i,p){if(o(p)){const{key:c,action:x}=p.payload,v=(0,n.q4)(c),m=s.kH.match(x)?v:f.lastKey,y=(0,a.H)(),h=f.keys[v],d=y(h,x);return{...f,lastKey:m,keys:{...f.keys,[v]:d}}}return f}const g={templating:l}},38221:(te,R,e)=>{"use strict";e.d(R,{H:()=>g,x:()=>f});var n=e(14644),a=e(17752),s=e(99703),i=e(99598),r=e(74276),u=e(96120),o=e(77839);let l;function g(){return l||(l=(0,n.combineReducers)({editor:a.wf,variables:o.Y,optionsPicker:i.ho,transaction:r.Dd,inspect:s.t4})),l}function f(){return{editor:a.nS,variables:u.j,optionsPicker:i.$z,transaction:r.i3,inspect:s.WT}}},93612:(te,R,e)=>{"use strict";e.d(R,{Fs:()=>b,SS:()=>l,Tk:()=>m,UN:()=>d,_2:()=>E,bZ:()=>h,dn:()=>r,hk:()=>c,nS:()=>p,nx:()=>o,pi:()=>f,wk:()=>x,y7:()=>y});var n=e(41811),a=e(8535),s=e(99305),i=e(38221);function r(D,C=(0,a.Gu)(),P=!0){const{id:M,rootStateKey:O}=D,U=o(O,C).variables[M];if(!U){if(P)throw new Error(`Couldn't find variable with id:${M}`);return}return U}function u(D,C,P=(0,a.Gu)()){return Object.values(o(C,P).variables).filter(D).sort((M,O)=>M.index-O.index)}function o(D,C=(0,a.Gu)()){return C.templating.keys[(0,s.q4)(D)]??(0,i.x)()}function l(D,C=(0,a.Gu)()){return u(g,D,C)}function g(D){return D.type!=="system"}const f=(0,n.default)((D,C)=>l(D,(0,a.Gu)())),p=(D,C)=>l(D,C);function c(D,C=(0,a.Gu)()){return x(Object.values(o(D,C).variables))}function x(D){const C=D.filter(g).sort((P,M)=>P.index-M.index);return C.length>0?C[C.length-1].index+1:0}function v(D,C=getState()){return o(D,C).transaction.isDirty}function m(D=(0,a.Gu)()){return D.templating?.lastKey}function y(D=(0,a.Gu)()){if(!D.templating?.lastKey)throw new Error("Accessing lastKey without initializing it variables");return D.templating.lastKey}function h(D,C=(0,a.Gu)()){const P=m(C);return P?u(D,P,C):[]}function d(D=(0,a.Gu)()){const C=m(D);return C?l(C,D):[]}function E(D,C=(0,a.Gu)()){const P=m(C);if(P)return r({id:D,rootStateKey:P,type:"query"},C,!1)}function b(D,C){return D[C]}},88681:(te,R,e)=>{"use strict";e.d(R,{Hr:()=>x,Pu:()=>C,QP:()=>m,QV:()=>v,Te:()=>P,a7:()=>D,dE:()=>d,hj:()=>y,l_:()=>E,qi:()=>c,ut:()=>h,wB:()=>b});var n=e(65307),a=e(2543),s=e.n(a),i=e(28105),r=e(54742),u=e(17752),o=e(67933),l=e(99305),g=e(93612),f=e(96120);const p=(0,n.Z0)({name:"templating/shared",initialState:f.j,reducers:{addVariable:(M,O)=>{const j=O.payload.id??O.payload.data.model.name,U=r.B.get(O.payload.type),W=(0,a.cloneDeep)(U.initialState),B=U.beforeAdding?U.beforeAdding(O.payload.data.model):(0,a.cloneDeep)(O.payload.data.model),S={...(0,a.defaults)({},B,W),id:j,index:O.payload.data.index,global:O.payload.data.global};M[j]=S},variableStateNotStarted:(M,O)=>{const j=(0,g.Fs)(M,O.payload.id);j.state=i.Gu.NotStarted,j.error=null},variableStateFetching:(M,O)=>{const j=(0,g.Fs)(M,O.payload.id);j.state=i.Gu.Loading,j.error=null},variableStateCompleted:(M,O)=>{const j=(0,g.Fs)(M,O.payload.id);j&&(j.state=i.Gu.Done,j.error=null)},variableStateFailed:(M,O)=>{const j=(0,g.Fs)(M,O.payload.id);j&&(j.state=i.Gu.Error,j.error=O.payload.data.error)},removeVariable:(M,O)=>{if(delete M[O.payload.id],!O.payload.data.reIndex)return;const j=Object.values(M).sort((U,W)=>U.index-W.index);for(let U=0;U<j.length;U++)j[U].index=U},duplicateVariable:(M,O)=>{function j(A){return A.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const U=(0,a.cloneDeep)(M[O.payload.id]),W=new RegExp(`^copy_of_${j(U.name)}(_(\\d+))?$`),B=Object.values(M).map(({name:A})=>A.match(W)).filter(A=>A!=null),S=B.map(A=>A[2]).filter(A=>A!=null),_=B.length===0?null:S.length===0?1:S.map(A=>+A).sort((A,N)=>N-A)[0]+1,K=`copy_of_${U.name}${_?`_${_}`:""}`,T=O.payload.data?.newId??K,L=(0,g.wk)(Object.values(M));M[T]={...(0,a.cloneDeep)(r.B.get(O.payload.type).initialState),...U,id:T,name:K,index:L}},changeVariableOrder:(M,O)=>{const{toIndex:j,fromIndex:U}=O.payload.data,W=Object.values(M);for(let B=0;B<W.length;B++){const S=W[B];S.index===U?S.index=j:S.index>U&&S.index<=j?S.index--:S.index<U&&S.index>=j&&S.index++}},changeVariableType:(M,O)=>{const{id:j}=O.payload,{label:U,name:W,index:B,description:S,rootStateKey:_}=M[j];M[j]={...(0,a.cloneDeep)(r.B.get(O.payload.data.newType).initialState),id:j,rootStateKey:_,label:U,name:W,index:B,description:S}},setCurrentVariableValue:(M,O)=>{if(!O.payload.data.option)return;const j=(0,g.Fs)(M,O.payload.id);if(!(0,o.SP)(j))return;const{option:U}=O.payload.data,W={...U,text:(0,l.QT)(U?.text),value:(0,l.QT)(U?.value)};j.current=W,j.options=j.options.map(B=>{B.value=(0,l.QT)(B.value),B.text=(0,l.QT)(B.text);let S=!1;if(Array.isArray(W.value))for(let _=0;_<W.value.length;_++){const K=W.value[_];if(B.value===K){S=!0;break}}else B.value===W.value&&(S=!0);return B.selected=S,B})},changeVariableProp:(M,O)=>{const j=(0,g.Fs)(M,O.payload.id);j[O.payload.data.propName]=O.payload.data.propValue}},extraReducers:M=>M.addCase(u.FN,(O,j)=>{const U=(0,g.Fs)(O,j.payload.id);U.name=j.payload.data.newName})}),c=p.reducer,{removeVariable:x,addVariable:v,changeVariableProp:m,changeVariableOrder:y,duplicateVariable:h,setCurrentVariableValue:d,changeVariableType:E,variableStateNotStarted:b,variableStateFetching:D,variableStateCompleted:C,variableStateFailed:P}=p.actions},74276:(te,R,e)=>{"use strict";e.d(R,{$O:()=>g,Dd:()=>f,i3:()=>i,kH:()=>o,pu:()=>l});var n=e(65307),a=e(88813),s=e(88681);const i={uid:null,status:a.x8.NotStarted,isDirty:!1},r=(0,n.Z0)({name:"templating/transaction",initialState:i,reducers:{variablesInitTransaction:(p,c)=>{p.uid=c.payload.uid,p.status=a.x8.Fetching},variablesCompleteTransaction:(p,c)=>{p.uid===c.payload.uid&&(p.status=a.x8.Completed)},variablesClearTransaction:(p,c)=>{p.uid=null,p.status=a.x8.NotStarted,p.isDirty=!1}},extraReducers:p=>p.addMatcher(u,(c,x)=>{c.status===a.x8.Completed&&(c.isDirty=!0)})});function u(p){return s.Hr.match(p)||s.QV.match(p)||s.QP.match(p)||s.hj.match(p)||s.ut.match(p)||s.l_.match(p)}const{variablesInitTransaction:o,variablesClearTransaction:l,variablesCompleteTransaction:g}=r.actions,f=r.reducer},96120:(te,R,e)=>{"use strict";e.d(R,{j:()=>n});const n={}},77839:(te,R,e)=>{"use strict";e.d(R,{Y:()=>u,v:()=>r});var n=e(65307),a=e(54742),s=e(88681),i=e(96120);const r=(0,n.VP)("templating/cleanVariables"),u=(o=i.j,l)=>{if(r.match(l)){const g=Object.values(o).filter(p=>p.global);return g?g.reduce((p,c)=>(p[c.id]=c,p),{}):i.j}return l?.payload?.type&&a.B.getIfExists(l?.payload?.type)?a.B.get(l.payload.type).reducer((0,s.qi)(o,l),l):o}},88813:(te,R,e)=>{"use strict";e.d(R,{BS:()=>l,Vg:()=>u,eF:()=>g,og:()=>o,x8:()=>r});var n=e(7389),a=e(28105),s=e(68388),i=e(8921),r=(f=>(f.NotStarted="Not started",f.Fetching="Fetching",f.Completed="Completed",f))(r||{});const u={id:i.qF,rootStateKey:null,name:"",type:"query",global:!1,index:-1,hide:n.zL.dontHide,skipUrlSync:!1,state:a.Gu.NotStarted,error:null,description:null};class o extends s.x{static{this.type="variables-changed"}}class l extends s.x{static{this.type="variables-time-range-process-done"}}class g extends s.x{static{this.type="variables-changed-in-url"}}},99305:(te,R,e)=>{"use strict";e.d(R,{AX:()=>b,Lz:()=>y,ML:()=>v,Nz:()=>m,QT:()=>P,SY:()=>p,Wz:()=>C,iP:()=>d,jX:()=>j,q$:()=>E,q4:()=>O,qD:()=>U,sN:()=>M,t4:()=>c,u7:()=>h,wJ:()=>x});var n=e(2543),a=e.n(n),s=e(7389),i=e(2863),r=e(62635),u=e(8535),o=e(54742),l=e(8921),g=e(93612),f=e(88813);const p=/\$(\w+)|\[\[(\w+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g,c=B=>(p.lastIndex=0,p.exec(B));function x(...B){const S=B[B.length-1];B[0]=typeof B[0]=="string"?B[0]:(0,r.MA)(B[0]);const K=B.slice(0,-1).join(" ").match(p);return!!(K!==null?K.find(L=>{const A=c(L);return A!==null&&A.indexOf(S)>-1}):!1)}const v=B=>{if(!B||!B.current)return!1;if(B.current.value){const S=Array.isArray(B.current.value);if(S&&B.current.value.length&&B.current.value[0]===l.To||!S&&B.current.value===l.To)return!0}if(B.current.text){const S=Array.isArray(B.current.text);if(S&&B.current.text.length&&B.current.text[0]===l.Zm||!S&&B.current.text===l.Zm)return!0}return!1},m=B=>!B||!B.current||!B.current.text?"":Array.isArray(B.current.text)?B.current.text.toString():typeof B.current.text!="string"?"":B.current.text,y=B=>!B||!B.current||B.current.value===void 0||B.current.value===null?null:Array.isArray(B.current.value)?B.current.value.toString():typeof B.current.value!="string"?null:B.current.value;function h(B,S=(0,i.w)()){return!B||!B.regex?"":S.replace(B.regex,{},"regex")}function d(B,S,_,K){const T={range:void 0,variable:B,searchFilter:S,scopedVars:K};return(B.refresh===s.CO.onTimeRangeChanged||B.refresh===s.CO.onDashboardLoad)&&(T.range=_.timeRange()),T}function E(B){return B?.type==="custom"?s.CO.onDashboardLoad:!B||!("refresh"in B)||B.refresh!==s.CO.onTimeRangeChanged&&B.refresh!==s.CO.onDashboardLoad?s.CO.never:B.refresh}function b(){return o.B.list().filter(B=>B.id!=="system").map(({id:B,name:S,description:_})=>({label:S,value:B,description:_}))}function D(B){return(0,n.isArray)(B)&&(B.length===0?B=void 0:B.length===1&&(B=B[0])),B}function C(B,S){let _=0;const K={};for(const T in B){if(!T.startsWith(l.qz))continue;let L=D(S[T]),A=D(B[T]);(0,n.isEqual)(A,L)||(K[T]={value:B[T]},_++)}for(const T in S){if(!T.startsWith(l.qz))continue;const L=S[T];(0,n.isArray)(L)&&L.length===0||B.hasOwnProperty(T)||(K[T]={value:"",removed:!0},_++)}return _?K:void 0}function P(B){return Array.isArray(B)?B.map(String):B==null?"":typeof B=="number"?B.toString(10):typeof B=="string"?B:typeof B=="boolean"?B.toString():""}function M(B,S=(0,u.Gu)()){return(0,g.nx)(B,S).transaction.status!==f.x8.NotStarted}function O(B){return String(B)}const j=B=>{if(!B.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${B.id}`);return{type:B.type,id:B.id,rootStateKey:B.rootStateKey}};function U(B,S){return{type:B.type,id:B.id,data:S}}function W(){const B=getTemplateSrv().getVariables(),S=locationService.getSearchObject();return Object.keys(S).filter(_=>_.indexOf(VARIABLE_PREFIX)!==-1&&B.some(K=>K.name===_.replace(VARIABLE_PREFIX,""))).reduce((_,K)=>{const T=K.replace(VARIABLE_PREFIX,"");return _[T]=S[K],_},{})}},10572:(te,R,e)=>{"use strict";window.public_cdn_path&&(e.p=window.public_cdn_path),window.__grafana_public_path__=e.p.substring(0,e.p.lastIndexOf("build/"))||e.p,window.nonce&&(e.nc=window.nonce),window.__grafana_app_bundle_loaded=!0;async function n(){await window.__grafana_boot_data_promise,await Promise.resolve().then(e.bind(e,44821))}n().catch(a=>{console.error("Error bootstrapping Grafana",a),window.__grafana_load_failed()})},44821:(te,R,e)=>{"use strict";var n=e(48307),a=e(9423),s=e(7452),i=e(5086),r=e(78624),u=e(4213),o=e(34796),l=e(96540),g=e.t(l,2),f=e(5338),p=e(25229),c=e(60188),x=e(53543),v=e(8642),m=e(54734),y=e(92138),h=e(57002),d=e(92745),E=e(68143),b=e(47700),D=e(48072),C=e(36490),P=e(25076),M=e(43122),O=e(6201),j=e(75234),U=e(83734),W=e(39698),B=e(78282),S=e(46907),_=e(33005),K=e(33604),T=e(33707),L=e(41071),A=e(92293),N=e(78646),V=e(60311),z=e(88806),w=e(14477),H=e(58873),Q=e(2874),Z=e(36674),Y=e(65642),X=e(43173),I=e(74848),J=e(2543),ee=e(95004),q=e(36638),ne=e(57866),se=e(16515),oe=e(64761),de=e(96702),fe=e(68779),ae=e(18027),ce=e(77824),ie=e(31286),ve=e(45861),le=e(84510);function Ee(F){if(F in le.uk){const{name:G,getHelperDocs:k,links:re}=le.uk[F],ue=k(le.g_.UIImage),ge=Re(ue);if(re?.length){const Pe=re.map(Ae=>`
  Or visit <a href="${Ae.url}" target="_blank">${Ae.title}</a>

  `).join("");return{name:G,helperDocs:`
        ${ge}
        ${(0,le.$n)()}
  ${Pe}
        `}}return{name:G,helperDocs:`
      ${ge}
      ${(0,le.$n)()}
      `}}return{name:"No documentation found",helperDocs:(0,le.$n)()}}const Re=F=>F.replace(/\[(.*?)\]\(#.*?\)/g,"$1").replace(/\[[^\]]*\]\[\]/g,"");var Oe=e(97095),Se=e(18857),Te=e(42954),_e=e(17200),He=e(72598);function tt(F){return function({options:k,onChange:re}){const{validator:ue}=F,{value:ge}=k,[Pe,Ae]=(0,l.useState)(!ue(ge)),We=(0,l.useCallback)(qe=>{Ae(!ue(qe)),re({...k,value:qe})},[Ae,ue,re,k]);return(0,I.jsx)(_e.y,{invalid:Pe,value:ge,error:"Value needs to be a number or a variable",onChange:We,placeholder:(0,d.t)("transformers.basic-matcher-editor.placeholder-value-or-variable","Value or variable"),suggestions:(0,He.I9)()})}}const Je=()=>[{name:"Is greater",id:ne.Js.greater,component:tt({validator:He.N_})},{name:"Is greater or equal",id:ne.Js.greaterOrEqual,component:tt({validator:He.N_})},{name:"Is lower",id:ne.Js.lower,component:tt({validator:He.N_})},{name:"Is lower or equal",id:ne.Js.lowerOrEqual,component:tt({validator:He.N_})},{name:"Is equal",id:ne.Js.equal,component:tt({validator:()=>!0})},{name:"Is not equal",id:ne.Js.notEqual,component:tt({validator:()=>!0})},{name:"Is Substring",id:ne.Js.substring,component:tt({validator:()=>!0})},{name:"Is not substring",id:ne.Js.notSubstring,component:tt({validator:()=>!0})}],Ge=F=>null,je=()=>[{name:"Is null",id:ne.Js.isNull,component:Ge},{name:"Is not null",id:ne.Js.isNotNull,component:Ge}];var Fe=e(79233);function Be(F){return function({options:k,onChange:re}){const{validator:ue}=F,[ge,Pe]=(0,l.useState)({from:!ue(k.from),to:!ue(k.to)}),Ae=(0,l.useCallback)((qe,et)=>{const rt=!ue(qe);Pe({...ge,[et]:rt}),!rt&&re({...k,[et]:qe})},[k,re,ge,Pe,ue]),We=(0,He.I9)();return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(_e.y,{value:String(k.from),invalid:ge.from,error:"Value needs to be a number or a variable",placeholder:(0,d.t)("transformers.range-matcher-editor.placeholder-from","From"),onChange:qe=>Ae(qe,"from"),suggestions:We}),(0,I.jsx)(Fe.c,{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.range-matcher-editor.and",children:"and"})}),(0,I.jsx)(_e.y,{invalid:ge.to,error:"Value needs to be a number or a variable",value:String(k.to),placeholder:(0,d.t)("transformers.range-matcher-editor.placeholder-to","To"),suggestions:We,onChange:qe=>Ae(qe,"to")})]})}}const Ke=()=>[{name:"Is between",id:ne.Js.between,component:Be({validator:He.N_})}];function Ue(F){return function({options:k,onChange:re}){const{validator:ue}=F,{value:ge}=k,[Pe,Ae]=(0,l.useState)(!ue(ge)),We=(0,He.I9)().reduce((et,rt)=>(et.push(rt),et.push({...rt,documentation:(0,d.t)("transformers.regex-matcher-editor.variable-regex-documentation","Formats multi-value variable into a regex string"),label:rt.label.concat(":regex"),value:rt.value.concat(":regex")}),et),[]),qe=(0,l.useCallback)(et=>{Ae(!ue(et)),re({...k,value:et})},[Ae,ue,re,k]);return(0,I.jsx)(_e.y,{invalid:Pe,value:ge,onChange:qe,placeholder:(0,d.t)("transformers.regex-matcher-editor.placeholder-value-or-variable","Value or variable"),suggestions:We})}}const we=()=>[{name:"Regex",id:ne.Js.regex,component:Ue({validator:()=>!0})}],Xe=new Te.O(()=>[...Je(),...je(),...Ke(),...we()]),nt=F=>{const{onDelete:G,onChange:k,filter:re,fieldsInfo:ue}=F,{fieldsAsOptions:ge,fieldByDisplayName:Pe}=ue,Ae=me(re,ge)??"",We=Pe[Ae],qe=We?he(We):[],et=xe(re,qe),rt=Xe.getIfExists(et),lt=(0,l.useCallback)(Ct=>{Ct?.value&&k({...re,fieldName:Ct.value})},[k,re]),pt=(0,l.useCallback)(Ct=>{if(!Ct?.value)return;const Wt=Ct.value,en=q.hI.get(Wt).getDefaultOptions(We);k({...re,config:{id:Wt,options:en}})},[k,re,We]),ht=(0,l.useCallback)(Ct=>{k({...re,config:{...re.config,options:Ct}})},[k,re]);return!We||!rt||!rt.component?null:(0,I.jsxs)(Oe.C,{children:[(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.filter-by-value-filter-editor.label-field","Field"),labelWidth:14,children:(0,I.jsx)(Se.l6,{className:"min-width-15 max-width-24",placeholder:(0,d.t)("transformers.filter-by-value-filter-editor.placeholder-field-name","Field name"),options:ge,value:re.fieldName,onChange:lt})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.filter-by-value-filter-editor.label-match","Match"),children:(0,I.jsx)(Se.l6,{className:"width-12",placeholder:(0,d.t)("transformers.filter-by-value-filter-editor.placeholder-select-test","Select test"),options:qe,value:et,onChange:pt})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.filter-by-value-filter-editor.label-value","Value"),grow:!0,children:(0,I.jsx)(rt.component,{field:We,options:re.config.options??{},onChange:ht})}),(0,I.jsx)(ie.a,{marginBottom:.5,children:(0,I.jsx)(ve.$n,{icon:"times",onClick:G,variant:"secondary"})})]})},he=F=>{const G=[];for(const k of q.hI.list())!k.isApplicable(F)||!Xe.getIfExists(k.id)||G.push({value:k.id,label:k.name,description:k.description});return G},xe=(F,G)=>{const k=G.find(re=>re.value===F.config.id);if(k&&k.value)return k.value;if(G[0]?.value)return G[0]?.value},me=(F,G)=>{const k=G.find(re=>re.value===F.fieldName);if(k&&k.value)return k.value;if(G[0]?.value)return G[0]?.value},ye=F=>{const{input:G,options:k,onChange:re}=F,ue=Le(G),ge=[{label:(0,d.t)("transformers.filter-by-value-transformer-editor.filter-types.label.include","Include"),value:fe.j4.include},{label:(0,d.t)("transformers.filter-by-value-transformer-editor.filter-types.label.exclude","Exclude"),value:fe.j4.exclude}],Pe=[{label:(0,d.t)("transformers.filter-by-value-transformer-editor.filter-match.label.match-all","Match all"),value:fe.Sm.all},{label:(0,d.t)("transformers.filter-by-value-transformer-editor.filter-match.label.match-any","Match any"),value:fe.Sm.any}],Ae=(0,l.useCallback)(()=>{const lt=G[0],pt=lt.fields.find(Wt=>Wt.type!==ee.PU.time);if(!pt)return;const ht=(0,J.cloneDeep)(k.filters),Ct=q.hI.get(ne.Js.isNull);ht.push({fieldName:(0,se.Ct)(pt,lt,G),config:{id:Ct.id,options:Ct.getDefaultOptions(pt)}}),re({...k,filters:ht})},[re,k,G]),We=(0,l.useCallback)(lt=>{let pt=(0,J.cloneDeep)(k.filters);pt.splice(lt,1),re({...k,filters:pt})},[k,re]),qe=(0,l.useCallback)((lt,pt)=>{let ht=(0,J.cloneDeep)(k.filters);ht[pt]=lt,re({...k,filters:ht})},[k,re]),et=(0,l.useCallback)(lt=>{re({...k,type:lt??fe.j4.include})},[k,re]),rt=(0,l.useCallback)(lt=>{re({...k,match:lt??fe.Sm.all})},[k,re]);return(0,I.jsxs)("div",{children:[(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.filter-by-value-transformer-editor.label-filter-type","Filter type"),labelWidth:16,children:(0,I.jsx)("div",{className:"width-15",children:(0,I.jsx)(ce.z,{options:ge,value:k.type,onChange:et,fullWidth:!0})})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.filter-by-value-transformer-editor.label-conditions","Conditions"),labelWidth:16,children:(0,I.jsx)("div",{className:"width-15",children:(0,I.jsx)(ce.z,{options:Pe,value:k.match,onChange:rt,fullWidth:!0})})}),(0,I.jsxs)(ie.a,{paddingLeft:2,children:[k.filters.map((lt,pt)=>(0,I.jsx)(nt,{filter:lt,fieldsInfo:ue,onChange:ht=>qe(ht,pt),onDelete:()=>We(pt)},pt)),(0,I.jsx)(ve.$n,{icon:"plus",size:"sm",onClick:Ae,variant:"secondary",children:(0,I.jsx)(d.x6,{i18nKey:"transformers.filter-by-value-transformer-editor.add-condition",children:"Add condition"})})]})]})},De={id:oe.F.filterByValue,editor:ye,transformation:de.c.filterByValueTransformer,name:de.c.filterByValueTransformer.name,description:"Removes rows of the query results using user-defined filters. This is useful if you can not filter your data in the data source.",categories:new Set([v.m.Filter]),help:Ee(oe.F.filterByValue).helperDocs},Le=F=>(0,l.useMemo)(()=>{const G={fieldsAsOptions:[],fieldByDisplayName:{}};return Array.isArray(F)?F.reduce((k,re)=>re.fields.reduce((ue,ge)=>{const Pe=(0,se.Ct)(ge,re,F);return ue.fieldByDisplayName[Pe]||(ue.fieldsAsOptions.push({label:Pe,value:Pe,type:ge.type}),ue.fieldByDisplayName[Pe]=ge),ue},k),G):G},[F]);var Ve=e(11594),ze=e(52205),Ze=e(25797),Me=e(56424),$e=e(61215);function at(F,G){const k={data:F.input,options:F.options},re=new Ze.C({id:"root",title:(0,d.t)("transformers.get-transformer-option-pane.root.title.root","root")}),ue=Pe=>{if(Pe?.length){const Ae=Pe[0];let We=re.categories.find(qe=>qe.props.id===Ae);return We||(We=new Ze.C({id:Ae,title:Ae}),re.categories.push(We)),We}return re},ge={getValue:Pe=>(0,J.get)(F.options,Pe),onChange:(Pe,Ae)=>{F.onChange((0,$e.Sf)(F.options,Pe,Ae))}};return(0,Me.g5)(G,ge,ue,k),re}function ct(F){const G={data:[],options:{}},k={},re=new ze.pv;F(re,G);for(const ue of re.getItems())ue.defaultValue!=null&&(0,J.set)(k,ue.path,ue.defaultValue);return k}var ft=e(13572),Et=e(48264);const St=(F,G)=>{const k=G.options??{};(0,ft.J)("",F,k)},Pt=F=>{(0,l.useEffect)(()=>{if(!F.options.xBuckets?.mode){const k=ct(St);F.onChange({...k,...F.options})}});const G=at(F,St);return(0,I.jsx)("div",{children:(0,I.jsx)("div",{children:G.items.map(k=>k.render())})})},Dt={id:Et.wY.id,editor:Pt,transformation:Et.wY,name:Et.wY.name,description:Et.wY.description,state:Ve.pn.alpha,categories:new Set([v.m.CreateNewVisualization]),help:Ee(Et.wY.id).helperDocs};var Ye=e(22803),mt=e(63142),zt=e(63152),Jt=e(46644),Xt=e(34107),En=e(64394),ln=e(13227),cn=e(33553),Pn=e(18600);function wn(F,G,k){const re={},ue={};for(const ge of F.fields){const Pe=(0,se.Ct)(ge,F),Ae=k.index[Pe],We=Ae.handler;if(!We)continue;const qe=ge.values[G];if(qe==null)continue;const et=We.processor(qe,re,ue,Ae.handlerArguments);et!=null&&(re[We.targetProperty??We.key]=et)}return ue.mappingValues&&(re.mappings=gt(ue)),re}var jn=(F=>(F.Name="field.name",F.Value="field.value",F.Label="field.label",F.Ignore="__ignore",F))(jn||{});const kn=[{key:"field.name",name:"Field name",processor:()=>{}},{key:"field.value",name:"Field value",processor:()=>{}},{key:"field.label",name:"Field label",processor:()=>{}},{key:"__ignore",name:"Ignore",processor:()=>{}},{key:"max",processor:Ut},{key:"min",processor:Ut},{key:"unit",processor:F=>F.toString()},{key:"decimals",processor:Ut},{key:"displayName",name:"Display name",processor:F=>F.toString()},{key:"color",processor:F=>({fixedColor:F,mode:En.Y.Fixed})},{key:"threshold1",name:"Threshold",targetProperty:"thresholds",processor:(F,G,k,re)=>{const ue=(0,ln.t)(F);if(!isNaN(ue))return G.thresholds||(G.thresholds={mode:cn.O.Absolute,steps:[]}),G.thresholds.steps.push({value:ue,color:re.threshold?.color??"red"}),G.thresholds}},{key:"mappings.value",name:"Value mappings / Value",targetProperty:"mappings",defaultReducer:Jt.gy.allValues,processor:(F,G,k)=>{if((0,J.isArray)(F))return k.mappingValues=F,G.mappings}},{key:"mappings.color",name:"Value mappings / Color",targetProperty:"mappings",defaultReducer:Jt.gy.allValues,processor:(F,G,k)=>{if((0,J.isArray)(F))return k.mappingColors=F,G.mappings}},{key:"mappings.text",name:"Value mappings / Display text",targetProperty:"mappings",defaultReducer:Jt.gy.allValues,processor:(F,G,k)=>{if((0,J.isArray)(F))return k.mappingTexts=F,G.mappings}}];function gt(F){const G={type:Pn.d.ValueToText,options:{}};if(!F.mappingValues)return[];for(let k=0;k<F.mappingValues.length;k++){const re=F.mappingValues[k];re!=null&&(G.options[re.toString()]={color:F.mappingColors&&F.mappingColors[k],text:F.mappingTexts&&F.mappingTexts[k],index:k})}return[G]}let Lt=null;function Rt(){if(Lt===null){Lt={};for(const F of kn)Lt[F.key]=F}return Lt}function Ut(F){const G=(0,ln.t)(F);if(!isNaN(G))return G}function Gt(F,G){for(const k of G)if(F===k.fieldName)return k.handlerKey;return F.toLowerCase()}function Ft(F){return F?Rt()[F]:null}function _t(F,G,k){const re={index:{}};let ue=G.find(Pe=>Pe.handlerKey==="field.name"),ge=G.find(Pe=>Pe.handlerKey==="field.value");for(const Pe of F.fields){const Ae=(0,se.Ct)(Pe,F),We=G.find(rt=>rt.fieldName===Ae),qe=We?We.handlerKey:Ae.toLowerCase();let et=Ft(qe);k&&(et?(et.key==="field.name"&&(re.nameField=Pe),et.key==="field.value"&&(re.valueField=Pe)):We||(!re.nameField&&!ue&&Pe.type===ee.PU.string&&(re.nameField=Pe,et=Ft("field.name")),!re.valueField&&!ge&&Pe.type===ee.PU.number&&(re.valueField=Pe,et=Ft("field.value")))),!et&&k&&(et=Ft("field.label")),re.index[Ae]={automatic:!We,handler:et,handlerArguments:We?.handlerArguments??{},reducerId:We?.reducerId??et?.defaultReducer??Jt.gy.lastNotNull}}return re}var tn=e(63527),xn=e(35427);function mn(F){switch(F){case"threshold1":return!0;default:return!1}}function An({handlerArguments:F,handlerKey:G,onChange:k}){const re=ue=>{k(ue?{...F,threshold:{...F.threshold,color:ue}}:{...F,threshold:void 0})};return(0,I.jsx)(I.Fragment,{children:G==="threshold1"&&(0,I.jsx)(tn.p,{type:"text",value:"Threshold color","aria-label":(0,d.t)("transformers.field-config-mapping-handler-arguments-editor.aria-label-threshold-color","Threshold color"),disabled:!0,width:20,prefix:(0,I.jsx)(xn.sk,{color:F.threshold?.color??"red",onChange:re,enableNamedColors:!0})})})}function ia({frame:F,mappings:G,onChange:k,withReducers:re,withNameAndValue:ue}){const ge=(0,mt.of)(Ca),Pe=ca(F,G,ue),Ae=kn.map(lt=>ea(lt,!1)),We=G.reduce((lt,pt)=>lt||mn(pt.handlerKey),!1),qe=(lt,pt)=>{const ht=G.findIndex(Ct=>Ct.fieldName===lt.fieldName);if(pt)if(ht!==-1){const Ct=[...G];Ct.splice(ht,1,{...G[ht],handlerKey:pt.value}),k(Ct)}else k([...G,{fieldName:lt.fieldName,handlerKey:pt.value}]);else k(ht!==-1?G.filter((Ct,Wt)=>Wt!==ht):[...G,{fieldName:lt.fieldName,handlerKey:"__ignore"}])},et=(lt,pt)=>{const ht=G.findIndex(Ct=>Ct.fieldName===lt.fieldName);if(ht!==-1){const Ct=[...G];Ct.splice(ht,1,{...G[ht],reducerId:pt}),k(Ct)}else k([...G,{fieldName:lt.fieldName,handlerKey:lt.handlerKey,reducerId:pt}])},rt=(lt,pt)=>{const ht=G.findIndex(Ct=>Ct.fieldName===lt.fieldName);if(ht!==-1){const Ct=[...G];Ct.splice(ht,1,{...G[ht],handlerArguments:pt}),k(Ct)}else k([...G,{fieldName:lt.fieldName,handlerKey:lt.handlerKey,handlerArguments:pt}])};return(0,I.jsxs)("table",{className:ge.table,children:[(0,I.jsx)("thead",{children:(0,I.jsxs)("tr",{children:[(0,I.jsx)("th",{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.field-to-config-mapping-editor.field",children:"Field"})}),(0,I.jsx)("th",{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.field-to-config-mapping-editor.use-as",children:"Use as"})}),re&&(0,I.jsx)("th",{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.field-to-config-mapping-editor.select",children:"Select"})}),We&&(0,I.jsx)("th",{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.field-to-config-mapping-editor.additional-settings",children:"Additional settings"})})]})}),(0,I.jsx)("tbody",{children:Pe.map(lt=>(0,I.jsxs)("tr",{children:[(0,I.jsx)("td",{className:ge.labelCell,children:lt.fieldName}),(0,I.jsx)("td",{className:ge.selectCell,"data-testid":`${lt.fieldName}-config-key`,children:(0,I.jsx)(Se.l6,{options:Ae,value:lt.configOption,placeholder:lt.placeholder,isClearable:!0,onChange:pt=>qe(lt,pt)})}),re&&(0,I.jsx)("td",{"data-testid":`${lt.fieldName}-reducer`,className:ge.selectCell,children:(0,I.jsx)(Xt.S,{stats:[lt.reducerId],defaultStat:lt.reducerId,onChange:pt=>et(lt,pt[0])})}),We&&(0,I.jsx)("td",{"data-testid":`${lt.fieldName}-handler-arg`,className:ge.selectCell,children:(0,I.jsx)(An,{handlerKey:lt.handlerKey,handlerArguments:lt.handlerArguments,onChange:pt=>rt(lt,pt)})})]},lt.fieldName))})]})}function ca(F,G,k){const re=[],ue=_t(F,G??[],k);for(const ge of F.fields){const Pe=(0,se.Ct)(ge,F),Ae=ue.index[Pe],We=ea(Ae.handler,Ae.automatic);re.push({fieldName:Pe,configOption:Ae.automatic?null:We,placeholder:Ae.automatic?We?.label:"Choose",handlerKey:Ae.handler?.key??null,reducerId:Ae.reducerId,handlerArguments:Ae.handlerArguments})}for(const ge of G)if(!re.find(Pe=>Pe.fieldName===ge.fieldName)){const Pe=Ft(ge.handlerKey);re.push({fieldName:ge.fieldName,handlerKey:ge.handlerKey,configOption:ea(Pe,!1),missingInFrame:!0,reducerId:ge.reducerId??Jt.gy.lastNotNull,handlerArguments:{}})}return Object.values(re)}function ea(F,G){if(!F)return null;let k=F.name??(0,J.capitalize)(F.key);return G&&(k=`${k} (auto)`),{label:k,value:F.key}}const Ca=F=>({table:(0,Ye.css)({marginTop:F.spacing(1),"td, th":{borderRight:`4px solid ${F.colors.background.primary}`,borderBottom:`4px solid ${F.colors.background.primary}`,whiteSpace:"nowrap"},th:{fontSize:F.typography.bodySmall.fontSize,lineHeight:F.spacing(4),padding:F.spacing(0,1)}}),labelCell:(0,Ye.css)({fontSize:F.typography.bodySmall.fontSize,background:F.colors.background.secondary,padding:F.spacing(0,1),maxWidth:"400px",overflow:"hidden",textOverflow:"ellipsis",minWidth:"140px"}),selectCell:(0,Ye.css)({padding:0,minWidth:"161px"})});var oa=e(81160);function Jn(F,G){let k=null;for(const Ae of G)if(Ae.refId===F.configRefId){k=Ae;break}if(!k)return G;const re={fields:[],length:1},ue=_t(k,F.mappings??[],!1);for(const Ae of k.fields){const We={...Ae},qe=(0,se.Ct)(Ae,k),et=ue.index[qe],rt=(0,Jt.Nw)({field:Ae,reducers:[et.reducerId]});We.values=[rt[et.reducerId]],re.fields.push(We)}const ge=[],Pe=(0,q.NS)(F.applyTo||{id:ne.Ct.numeric});for(const Ae of G){if(Ae===k&&G.length>1)continue;const We={fields:[],length:Ae.length,refId:Ae.refId};for(const qe of Ae.fields)if(Pe(qe,Ae,G)){const et=wn(re,0,ue);We.fields.push({...qe,config:{...qe.config,...et}})}else We.fields.push(qe);ge.push(We)}return ge}const Da={id:oe.F.configFromData,name:"Config from query results",description:"Set unit, min, max and more from data.",defaultOptions:{configRefId:"config",mappings:[]},operator:F=>G=>G.pipe((0,oa.T)(k=>Jn(F,k)))};function Fa({input:F,onChange:G,options:k}){const re=(0,mt.of)(ps),ue=F.map(pt=>pt.refId).filter(pt=>pt!=null).map(pt=>({label:pt,value:pt})),ge=k.configRefId||"config",Pe=k.applyTo??{id:ne.Ct.byType,options:"number"},Ae=zt.g.get(Pe.id),We=F.find(pt=>pt.refId===ge),qe=pt=>{G({...k,configRefId:pt.value||"config"})},et=pt=>{G({...k,applyTo:{id:pt.value}})},rt=pt=>{G({...k,applyTo:{id:Pe.id,options:pt}})},lt=zt.g.list().filter(pt=>!pt.excludeFromPicker).map(pt=>({label:pt.name,value:pt.id,description:pt.description}));return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.config-from-query-transformer-editor.label-config-query","Config query"),labelWidth:20,children:(0,I.jsx)(Se.l6,{onChange:qe,options:ue,value:ge,width:30})})}),(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.config-from-query-transformer-editor.label-apply-to","Apply to"),labelWidth:20,children:(0,I.jsx)(Se.l6,{onChange:et,options:lt,value:Pe.id,width:30})})}),(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.config-from-query-transformer-editor.label-apply-to-options","Apply to options"),labelWidth:20,className:re.matcherOptions,children:(0,I.jsx)(Ae.component,{matcher:Ae.matcher,data:F,options:Pe.options,onChange:rt})})}),(0,I.jsx)(Oe.C,{children:We&&(0,I.jsx)(ia,{frame:We,mappings:k.mappings,onChange:pt=>G({...k,mappings:pt}),withReducers:!0})})]})}const Xn={id:Da.id,editor:Fa,transformation:Da,name:Da.name,description:Da.description,state:Ve.pn.beta,categories:new Set([v.m.CalculateNewFields]),help:Ee(Da.id).helperDocs},ps=F=>({matcherOptions:(0,Ye.css)({minWidth:"404px"})});var Aa=e(62467),xt=e(84691),dt=e(2863),bt=e(21285),Mt=e(12823),Bt=e(97958);const Kt=17,Qt=F=>{const{options:G,onChange:k}=F,re=(0,xt.pR)(F.options.binary?.left??"",F.names),ue=(0,xt.pR)(F.options.binary?.right??"",F.names);(re!==F.options.binary?.left||ue!==F.options.binary?.right)&&k({...G,mode:xt.UY.BinaryOperation,binary:{operator:G.binary?.operator,left:re,right:ue}});const{binary:ge}=G;let Pe=!ge?.left,Ae=!ge?.right;const We=!ge?.left?.matcher,qe=!ge?.right?.matcher,et=ge?.left?.matcher?.options,rt=ge?.right?.matcher?.options,lt=ge?.left?.matcher?.id===ne.Ct.byName,pt=ge?.right?.matcher?.id===ne.Ct.byName,ht=F.names.map($n=>(lt&&$n===et&&(Pe=!0),pt&&$n===rt&&(Ae=!0),{label:$n,value:JSON.stringify({matcher:{id:ne.Ct.byName,options:$n}})})),Ct=Pe?[...ht]:lt?[...ht,{label:et,value:JSON.stringify(ge.left),icon:""}]:[...ht],Wt=Ae?[...ht]:pt?[...ht,{label:rt,value:JSON.stringify(ge.right),icon:""}]:[...ht];Ct.push({label:`All ${ee.PU.number} fields`,value:JSON.stringify({matcher:{id:ne.Ct.byType,options:ee.PU.number}}),icon:(0,Bt.lV)(ee.PU.number)}),We&&ge?.left?.fixed&&Ct.push({label:ge.left.fixed,value:JSON.stringify(ge.left)??"",icon:""}),qe&&ge?.right?.fixed&&Wt.push({label:ge.right.fixed,value:JSON.stringify(ge.right)??"",icon:""});const en=Mt.b.list().map($n=>({label:$n.binaryOperationID,value:$n.binaryOperationID})),on=$n=>{k({...G,mode:xt.UY.BinaryOperation,binary:$n})},vn=$n=>{const Ea=JSON.parse($n.value??"");Ea.matcher?on({...ge,left:Ea}):on({...ge,left:{fixed:Ea.fixed??$n.value?.toString()}})},an=$n=>{const Ea=JSON.parse($n.value??"");Ea.matcher?on({...ge,right:Ea}):on({...ge,right:{fixed:Ea.fixed??$n.value?.toString()}})},gn=$n=>{on({...ge,operator:$n.value})};return(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)(Oe.C,{children:[(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.binary-operation-options-editor.label-operation","Operation"),labelWidth:Kt,children:(0,I.jsx)(Se.l6,{allowCustomValue:!0,placeholder:(0,d.t)("transformers.binary-operation-options-editor.placeholder-fields-or-number","Field(s) or number"),options:Ct,className:"min-width-18",value:JSON.stringify(ge?.left),onChange:vn})}),(0,I.jsx)(ae.I,{children:(0,I.jsx)(Se.l6,{className:"width-4",options:en,value:ge?.operator??en[0].value,onChange:gn})}),(0,I.jsx)(ae.I,{children:(0,I.jsx)(Se.l6,{allowCustomValue:!0,placeholder:(0,d.t)("transformers.binary-operation-options-editor.placeholder-field-or-number","Field or number"),className:"min-width-10",options:Wt,value:JSON.stringify(ge?.right),onChange:an})})]})})},Zt=F=>{const{names:G,onChange:k,options:re}=F,{cumulative:ue}=re,ge=G.map(qe=>({label:qe,value:qe})),Pe=qe=>{const et=qe.length?qe[0]:Jt.gy.sum;Ae({...ue,reducer:et})},Ae=qe=>{k({...re,mode:xt.UY.CumulativeFunctions,cumulative:qe})},We=qe=>{Ae({...ue,field:qe.value})};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.cumulative-options-editor.label-field","Field"),labelWidth:Kt,children:(0,I.jsx)(Se.l6,{placeholder:(0,d.t)("transformers.cumulative-options-editor.placeholder-field","Field"),options:ge,className:"min-width-18",value:ue?.field,onChange:We})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.cumulative-options-editor.label-calculation","Calculation"),labelWidth:Kt,children:(0,I.jsx)(Xt.S,{allowMultiple:!1,className:"width-18",stats:[ue?.reducer||Jt.gy.sum],onChange:Pe,defaultStat:Jt.gy.sum,filterOptions:qe=>qe.id===Jt.gy.sum||qe.id===Jt.gy.mean})})]})},nn=F=>{const{options:G,onChange:k}=F,{index:re}=G,ue=ge=>{k({...G,index:{asPercentile:ge.currentTarget.checked}})};return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(ae.I,{labelWidth:Kt,label:(0,d.t)("transformers.index-options-editor.label-as-percentile","As percentile"),tooltip:(0,d.t)("transformers.index-options-editor.tooltip-transform-index-percentile","Transform the row index as a percentile."),children:(0,I.jsx)(bt.K,{value:!!re?.asPercentile,onChange:ue})})})};var kt=e(41654),bn=e(34343);const Ln=F=>{const{names:G,selected:k,onChange:re,options:ue}=F,{reduce:ge}=ue,Pe=et=>{re({...ue,reduce:et})},Ae=et=>{k.indexOf(et)>-1?We(k.filter(rt=>rt!==et)):We([...k,et])},We=et=>{Pe({...ge,include:et})},qe=et=>{const rt=et.length?et[0]:Jt.gy.sum,{reduce:lt}=ue;Pe({...lt,reducer:rt})};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.reduce-row-options-editor.label-operation","Operation"),labelWidth:Kt,shrink:!0,children:(0,I.jsx)(kt.B,{gap:.5,direction:"row",alignItems:"flex-start",wrap:!0,children:G.map((et,rt)=>(0,I.jsx)(bn.m,{onClick:()=>{Ae(et)},label:et,selected:k.indexOf(et)>-1},`${et}/${rt}`))})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.reduce-row-options-editor.label-calculation","Calculation"),labelWidth:Kt,children:(0,I.jsx)(Xt.S,{allowMultiple:!1,className:"width-18",stats:[ge?.reducer||Jt.gy.sum],onChange:qe,defaultStat:Jt.gy.sum})})]})};var Yn=e(48233);const Hn=F=>{const{options:G,onChange:k}=F,{unary:re}=G,ue=rt=>{k({...G,mode:xt.UY.UnaryOperation,unary:rt})},ge=rt=>{ue({...re,operator:rt.value})},Pe=rt=>{ue({...re,fieldName:rt.value})};let Ae=!re?.fieldName;const We=F.names.map(rt=>(rt===re?.fieldName&&(Ae=!0),{label:rt,value:rt})),qe=Yn.j.list().map(rt=>({label:rt.unaryOperationID,value:rt.unaryOperationID})),et=Ae?We:[...We,{label:re?.fieldName,value:re?.fieldName}];return(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)(Oe.C,{children:[(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.unary-operation-editor.label-operation","Operation"),labelWidth:Kt,children:(0,I.jsx)(Se.l6,{options:qe,value:re?.operator??qe[0].value,onChange:ge})}),(0,I.jsx)(ae.I,{label:"(",labelWidth:2,children:(0,I.jsx)(Se.l6,{placeholder:(0,d.t)("transformers.unary-operation-editor.placeholder-field","Field"),className:"min-width-11",options:et,value:re?.fieldName,onChange:Pe})}),(0,I.jsx)(Fe.c,{width:2,children:")"})]})})};var It=e(19753);const yt=F=>{const{options:G,names:k,onChange:re}=F,{window:ue}=G,ge=k.map(ht=>({label:ht,value:ht})),Pe=[{label:(0,d.t)("transformers.window-options-editor.type-options.label.trailing","Trailing"),value:xt.ip.Trailing},{label:(0,d.t)("transformers.window-options-editor.type-options.label.centered","Centered"),value:xt.ip.Centered}],Ae=[{label:(0,d.t)("transformers.window-options-editor.window-size-mode-options.label.percentage","Percentage"),value:xt.Bp.Percentage},{label:(0,d.t)("transformers.window-options-editor.window-size-mode-options.label.fixed","Fixed"),value:xt.Bp.Fixed}],We=ht=>{re({...G,mode:xt.UY.WindowFunctions,window:ht})},qe=ht=>{We({...ue,field:ht.value})},et=ht=>{We({...ue,windowSize:ht&&ue?.windowSizeMode===xt.Bp.Percentage?ht/100:ht})},rt=ht=>{We({...ue,windowSize:ue?.windowSize?ht===xt.Bp.Percentage?ue.windowSize/100:ue.windowSize*100:void 0,windowSizeMode:ht})},lt=ht=>{const Ct=ht.length?ht[0]:Jt.gy.sum;We({...ue,reducer:Ct})},pt=ht=>{We({...ue,windowAlignment:ht})};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.window-options-editor.label-field","Field"),labelWidth:Kt,children:(0,I.jsx)(Se.l6,{placeholder:(0,d.t)("transformers.window-options-editor.placeholder-field","Field"),options:ge,className:"min-width-18",value:ue?.field,onChange:qe})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.window-options-editor.label-calculation","Calculation"),labelWidth:Kt,children:(0,I.jsx)(Xt.S,{allowMultiple:!1,className:"width-18",stats:[ue?.reducer||Jt.gy.mean],onChange:lt,defaultStat:Jt.gy.mean,filterOptions:ht=>ht.id===Jt.gy.mean||ht.id===Jt.gy.variance||ht.id===Jt.gy.stdDev})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.window-options-editor.label-type","Type"),labelWidth:Kt,children:(0,I.jsx)(ce.z,{value:ue?.windowAlignment??xt.ip.Trailing,options:Pe,onChange:pt})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.window-options-editor.label-window-size-mode","Window size mode"),labelWidth:Kt,children:(0,I.jsx)(ce.z,{value:ue?.windowSizeMode??xt.Bp.Percentage,options:Ae,onChange:rt})}),(0,I.jsx)(ae.I,{label:ue?.windowSizeMode===xt.Bp.Percentage?(0,d.t)("transformers.window-options-editor.label-window-size-percent","Window size %"):(0,d.t)("transformers.window-options-editor.label-window-size","Window size"),labelWidth:Kt,tooltip:ue?.windowSizeMode===xt.Bp.Percentage?(0,d.t)("transformers.window-options-editor.tooltip-window-size-percent","Set the window size as a percentage of the total data"):(0,d.t)("transformers.window-options-editor.tooltip-window-size","Window size"),children:(0,I.jsx)(It.Q,{placeholder:(0,d.t)("transformers.window-options-editor.placeholder-auto","Auto"),min:.1,value:ue?.windowSize&&ue.windowSizeMode===xt.Bp.Percentage?ue.windowSize*100:ue?.windowSize,onChange:et})})]})},Vt=[{value:xt.UY.BinaryOperation,label:"Binary operation"},{value:xt.UY.UnaryOperation,label:"Unary operation"},{value:xt.UY.ReduceRow,label:"Reduce row"},{value:xt.UY.Index,label:"Row index"}];X.$.featureToggles.addFieldFromCalculationStatFunctions&&Vt.push({value:xt.UY.CumulativeFunctions,label:"Cumulative functions"},{value:xt.UY.WindowFunctions,label:"Window functions"});const fn=new Set([ee.PU.time,ee.PU.number,ee.PU.string,ee.PU.boolean]),Dn=F=>{const{options:G,onChange:k,input:re}=F,ue=G?.reduce?.include,[ge,Pe]=(0,l.useState)({names:[],selected:[]});(0,l.useEffect)(()=>{const Ct={interpolate:en=>en},Wt=(0,Aa.of)(re).pipe(de.c.ensureColumnsTransformer.operator(null,Ct),We(),Ae(),qe(ue||[])).subscribe(({selected:en,names:on})=>{Pe({names:on,selected:en})});return()=>{Wt.unsubscribe()}},[re,ue]);const Ae=()=>{const Ct=(0,dt.w)();return Wt=>Wt.pipe((0,oa.T)(en=>(en.push(...Ct.getVariables().map(on=>"$"+on.name)),en)))},We=()=>Ct=>Ct.pipe((0,oa.T)(Wt=>{const en=[],on={};for(const vn of Wt)for(const an of vn.fields){if(!fn.has(an.type))continue;const gn=(0,se.Ct)(an,vn,Wt);on[gn]||(on[gn]=!0,en.push(gn))}return en})),qe=Ct=>Wt=>Wt.pipe((0,oa.T)(en=>{if(!Ct.length)return{names:en,selected:[]};const on=[],vn=[];for(const an of en)Ct.includes(an)&&vn.push(an),on.push(an);return{names:on,selected:vn}})),et=Ct=>{k({...G,replaceFields:Ct.currentTarget.checked})},rt=Ct=>{const Wt=Ct.value??xt.UY.BinaryOperation;Wt===xt.UY.WindowFunctions&&(G.window=G.window??xt.Uj),k({...G,mode:Wt})},lt=Ct=>{k({...G,alias:Ct.target.value})},pt=G.mode??xt.UY.BinaryOperation,ht=pt===xt.UY.BinaryOperation&&G.binary?.left.matcher?.id===ne.Ct.byType;return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(ae.I,{labelWidth:Kt,label:(0,d.t)("transformers.calculate-field-transformer-editor.label-mode","Mode"),children:(0,I.jsx)(Se.l6,{className:"width-18",options:Vt,value:Vt.find(Ct=>Ct.value===pt),onChange:rt})}),pt===xt.UY.BinaryOperation&&(0,I.jsx)(Qt,{options:G,names:ge.names,onChange:F.onChange}),pt===xt.UY.UnaryOperation&&(0,I.jsx)(Hn,{names:ge.names,options:G,onChange:F.onChange}),pt===xt.UY.ReduceRow&&(0,I.jsx)(Ln,{names:ge.names,selected:ge.selected,options:G,onChange:F.onChange}),pt===xt.UY.CumulativeFunctions&&(0,I.jsx)(Zt,{names:ge.names,options:G,onChange:F.onChange}),pt===xt.UY.WindowFunctions&&(0,I.jsx)(yt,{names:ge.names,options:G,onChange:F.onChange}),pt===xt.UY.Index&&(0,I.jsx)(nn,{options:G,onChange:F.onChange}),(0,I.jsx)(ae.I,{labelWidth:Kt,label:(0,d.t)("transformers.calculate-field-transformer-editor.label-alias","Alias"),disabled:ht,children:(0,I.jsx)(tn.p,{className:"width-18",value:G.alias??"",placeholder:(0,xt.sw)(G),onChange:lt})}),(0,I.jsx)(ae.I,{labelWidth:Kt,label:(0,d.t)("transformers.calculate-field-transformer-editor.label-replace-all-fields","Replace all fields"),children:(0,I.jsx)(bt.K,{value:!!G.replaceFields,onChange:et})})]})},Wn={id:oe.F.calculateField,editor:Dn,transformation:de.c.calculateFieldTransformer,name:de.c.calculateFieldTransformer.name,description:"Use the row values to calculate a new field.",categories:new Set([v.m.CalculateNewFields]),help:Ee(oe.F.calculateField).helperDocs};var Fn=e(9287);const la=[{value:Fn.x1.FieldName,label:"Copy frame name to field name"},{value:Fn.x1.Label,label:"Add a label with the frame name"},{value:Fn.x1.Drop,label:"Ignore the frame name"}];class Kn extends l.PureComponent{constructor(G){super(G),this.onModeChanged=k=>{const{options:re,onChange:ue}=this.props,ge=k.value??Fn.x1.FieldName;ue({...re,frameNameMode:ge})},this.onLabelChanged=k=>{const{options:re}=this.props;this.props.onChange({...re,frameNameLabel:k.target.value})}}render(){const{options:G}=this.props,k=G.frameNameMode??Fn.x1.FieldName;return(0,I.jsxs)("div",{children:[(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.concatenate-transformer-editor.label-name","Name"),labelWidth:16,grow:!0,children:(0,I.jsx)(Se.l6,{width:36,options:la,value:la.find(re=>re.value===k),onChange:this.onModeChanged})}),k===Fn.x1.Label&&(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.concatenate-transformer-editor.label-label","Label"),labelWidth:16,grow:!0,children:(0,I.jsx)(tn.p,{width:36,value:G.frameNameLabel??"",placeholder:(0,d.t)("transformers.concatenate-transformer-editor.placeholder-frame","Frame"),onChange:this.onLabelChanged})})]})}}const aa={id:oe.F.concatenate,editor:Kn,transformation:de.c.concatenateTransformer,name:de.c.concatenateTransformer.name,description:"Combine all fields into a single frame.  Values will be appended with undefined values if not the same length.",categories:new Set([v.m.Combine]),help:Ee(oe.F.concatenate).helperDocs};var Ia=e(62717),Zn=e(62693),ma=e(48457),ka=e(32503),ta=e(89332),Ya=e(32881),_n=e(30703),Ns=e(12594),is=e(76319);const Ys=({transformIndex:F,value:G,index:k,mappedIndex:re,onChangeEnumValue:ue,onRemoveEnumRow:ge,checkIsEnumUniqueValue:Pe})=>{const Ae=(0,mt.of)(rr),[We,qe]=(0,l.useState)(G),[et,rt]=(0,l.useState)(We===""),[lt,pt]=(0,l.useState)(null),ht=(0,l.useRef)(null);(0,l.useEffect)(()=>{ht.current&&ht.current.focus()},[ht]);const Ct=an=>{an.currentTarget.value!==""&&Pe(an.currentTarget.value)&&an.currentTarget.value!==G?pt("Enum value already exists"):pt(null),qe(an.currentTarget.value)},Wt=()=>{if(rt(!1),pt(null),We===""||lt!==null){ge(re);return}ue(re,We)},en=an=>{an.key==="Enter"&&(an.preventDefault(),Wt())},on=()=>{rt(!0)},vn=()=>{ge(re)};return(0,I.jsx)(ta.sx,{draggableId:`${F}/${G}`,index:k,children:an=>(0,I.jsxs)("tr",{ref:an.innerRef,...an.draggableProps,children:[(0,I.jsx)("td",{children:(0,I.jsx)("div",{className:Ae.dragHandle,...an.dragHandleProps,children:(0,I.jsx)(_n.I,{name:"draggabledots",size:"lg"})})}),et?(0,I.jsxs)("td",{children:[(0,I.jsx)(tn.p,{ref:ht,type:"text",value:We,onChange:Ct,onBlur:Wt,onKeyDown:en}),lt&&(0,I.jsx)(Ns.P,{children:lt})]}):(0,I.jsx)("td",{onClick:on,className:Ae.clickableTableCell,children:G&&G!==""?G:(0,d.t)("transformers.enum-mapping-row.click-to-edit","Click to edit")}),(0,I.jsx)("td",{className:Ae.textAlignCenter,children:(0,I.jsx)(Ya.Gy,{spacing:"sm",children:(0,I.jsx)(is.K,{name:"trash-alt",onClick:vn,"data-testid":"remove-enum-row","aria-label":(0,d.t)("transformers.enum-mapping-row.remove-enum-row-aria-label-delete-enum-row","Delete enum row"),tooltip:(0,d.t)("transformers.enum-mapping-row.remove-enum-row-tooltip-delete","Delete")})})})]},k)},`${F}/${G}`)},rr=F=>({dragHandle:(0,Ye.css)({cursor:"grab"}),textAlignCenter:(0,Ye.css)({textAlign:"center"}),clickableTableCell:(0,Ye.css)({cursor:"pointer",width:"100px","&:hover":{color:F.colors.text.maxContrast}})}),Js=Ys,vo=({input:F,options:G,transformIndex:k,onChange:re})=>{const ue=(0,mt.of)(Ka),[ge,Pe]=(0,l.useState)(G.conversions[k].enumConfig?.text??[]);(0,l.useEffect)(()=>{!G.conversions[k].enumConfig?.text?.length&&F.length&&Ae()},[F]),(0,l.useEffect)(()=>{(()=>{const Ct=ge.map(on=>on),Wt=G.conversions,en={text:Ct};Wt[k]={...Wt[k],enumConfig:en},re({...G,conversions:Wt})})()},[k,ge]);const Ae=()=>{const ht=F.flatMap(Wt=>Wt?.fields??[]).find(Wt=>Wt.name===G.conversions[k].targetField);if(!ht)return;const Ct=new Set(ht?.values);ge.length>0&&!(0,J.isEqual)(ge,Array.from(Ct))&&!window.confirm("This action will overwrite the existing configuration. Are you sure you want to continue?")||Pe([...Ct])},We=(ht,Ct)=>{const Wt=[...ge];Wt.splice(ht,1,Ct),Pe(Wt)},qe=ht=>{const Ct=[...ge];Ct.splice(ht,1),Pe(Ct)},et=()=>{Pe(["",...ge])},rt=(ht,Ct)=>{ge.includes(Ct)||We(ht,Ct)},lt=ht=>ge.includes(ht),pt=ht=>{if(!ht.destination)return;const Ct=ge.length-ht.source.index-1,Wt=ge.length-ht.destination.index-1,en=[...ge],on=en[Ct];en.splice(Ct,1),en.splice(Wt,0,on),Pe(en)};return(0,I.jsxs)(Oe.C,{children:[(0,I.jsxs)(Ya.Gy,{children:[(0,I.jsx)(ve.$n,{size:"sm",icon:"plus",onClick:()=>Ae(),className:ue.button,children:(0,I.jsx)(d.x6,{i18nKey:"transformers.enum-mapping-editor.generate-enum-values-from-data",children:"Generate enum values from data"})}),(0,I.jsx)(ve.$n,{size:"sm",icon:"plus",onClick:()=>et(),className:ue.button,children:(0,I.jsx)(d.x6,{i18nKey:"transformers.enum-mapping-editor.add-enum-value",children:"Add enum value"})})]}),(0,I.jsx)(Ya.gW,{children:(0,I.jsx)("table",{className:ue.compactTable,children:(0,I.jsx)(ta.JY,{onDragEnd:pt,children:(0,I.jsx)(ta.gL,{droppableId:"sortable-enum-config-mappings",direction:"vertical",children:ht=>(0,I.jsxs)("tbody",{ref:ht.innerRef,...ht.droppableProps,children:[[...ge].reverse().map((Ct,Wt)=>{const en=ge.length-Wt-1;return(0,I.jsx)(Js,{transformIndex:k,value:Ct,index:Wt,mappedIndex:en,onChangeEnumValue:rt,onRemoveEnumRow:qe,checkIsEnumUniqueValue:lt},`${k}/${Ct}`)}),ht.placeholder]})})})})})]})},Ka=F=>({compactTable:(0,Ye.css)({"tbody td":{padding:F.spacing(.5)},marginTop:F.spacing(1),marginBottom:F.spacing(2)}),button:(0,Ye.css)({marginTop:F.spacing(1)})}),zi={settings:{width:24,isClearable:!1}},hc=({input:F,options:G,onChange:k})=>{const re=Zn.bx.filter(pt=>pt.value!==ee.PU.trace),ue=(0,He.qt)(!0),ge=(0,Ia.P3)();ue.push({label:(0,d.t)("transformers.convert-field-type-transformer-editor.label.browser","Browser"),value:"browser"}),ue.push({label:(0,d.t)("transformers.convert-field-type-transformer-editor.label.utc","UTC"),value:"utc"});for(const pt of ge)ue.push({label:pt,value:pt});const Pe=(0,l.useCallback)(pt=>ht=>{const Ct=[...G.conversions];Ct[pt]={...Ct[pt],targetField:ht??"",dateFormat:void 0},k({...G,conversions:Ct})},[k,G]),Ae=(0,l.useCallback)(pt=>ht=>{const Ct=G.conversions;Ct[pt]={...Ct[pt],destinationType:ht.value},k({...G,conversions:Ct})},[k,G]),We=(0,l.useCallback)(pt=>ht=>{const Ct=G.conversions;Ct[pt]={...Ct[pt],dateFormat:ht.currentTarget.value},k({...G,conversions:Ct})},[k,G]),qe=(0,l.useCallback)(pt=>ht=>{const Ct=G.conversions;Ct[pt]={...Ct[pt],joinWith:ht.currentTarget.value},k({...G,conversions:Ct})},[k,G]),et=(0,l.useCallback)(()=>{k({...G,conversions:[...G.conversions,{targetField:void 0,destinationType:void 0,dateFormat:void 0}]})},[k,G]),rt=(0,l.useCallback)(pt=>{const ht=G.conversions;ht.splice(pt,1),k({...G,conversions:ht})},[k,G]),lt=(0,l.useCallback)(pt=>ht=>{const Ct=G.conversions;Ct[pt]={...Ct[pt],timezone:ht?.value},k({...G,conversions:Ct})},[k,G]);return(0,I.jsxs)(I.Fragment,{children:[G.conversions.map((pt,ht)=>{const Ct=(0,ka.UI)(F?.[0],pt.targetField),Wt=pt.joinWith?.length||Ct?.type&&[ee.PU.other,ee.PU.string].includes(Ct.type);return(0,I.jsxs)("div",{children:[(0,I.jsxs)(Oe.C,{children:[(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.convert-field-type-transformer-editor.label-field","Field"),children:(0,I.jsx)(ma.O,{context:{data:F},value:pt.targetField??"",onChange:Pe(ht),item:zi})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.convert-field-type-transformer-editor.label-as","as"),children:(0,I.jsx)(Se.l6,{options:re,value:pt.destinationType,placeholder:(0,d.t)("transformers.convert-field-type-transformer-editor.placeholder-type","Type"),onChange:Ae(ht),width:18})}),pt.destinationType===ee.PU.time&&(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.convert-field-type-transformer-editor.label-input-format","Input format"),tooltip:(0,d.t)("transformers.convert-field-type-transformer-editor.tooltip-input-format","Specify the format of the input field so Grafana can parse the date string correctly."),children:(0,I.jsx)(tn.p,{value:pt.dateFormat,placeholder:"e.g. YYYY-MM-DD",onChange:We(ht),width:24})}),pt.destinationType===ee.PU.string&&(0,I.jsxs)(I.Fragment,{children:[Wt&&(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.convert-field-type-transformer-editor.label-join-with","Join with"),tooltip:(0,d.t)("transformers.convert-field-type-transformer-editor.tooltip-explicit-separator-joining-array-values","Use an explicit separator when joining array values"),children:(0,I.jsx)(tn.p,{value:pt.joinWith,placeholder:"JSON",onChange:qe(ht),width:16})}),Ct?.type===ee.PU.time&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.convert-field-type-transformer-editor.label-date-format","Date format"),tooltip:(0,d.t)("transformers.convert-field-type-transformer-editor.tooltip-specify-the-output-format","Specify the output format."),children:(0,I.jsx)(tn.p,{value:pt.dateFormat,placeholder:"e.g. YYYY-MM-DD",onChange:We(ht),width:24})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.convert-field-type-transformer-editor.label-set-timezone","Set timezone"),tooltip:(0,d.t)("transformers.convert-field-type-transformer-editor.tooltip-timezone-manually","Set the timezone of the date manually"),children:(0,I.jsx)(Se.l6,{options:ue,value:pt.timezone,onChange:lt(ht),isClearable:!0})})]})]}),(0,I.jsx)(ve.$n,{size:"md",icon:"trash-alt",variant:"secondary",onClick:()=>rt(ht),"aria-label":(0,d.t)("transformers.convert-field-type-transformer-editor.aria-label-remove-convert-field-type-transformer","Remove convert field type transformer")})]}),pt.destinationType===ee.PU.enum&&(0,I.jsx)(vo,{input:F,options:G,transformIndex:ht,onChange:k})]},`${pt.targetField}-${ht}`)}),(0,I.jsx)(ve.$n,{size:"sm",icon:"plus",onClick:et,variant:"secondary","aria-label":(0,d.t)("transformers.convert-field-type-transformer-editor.aria-label-add-a-convert-field-type-transformer","Add a convert field type transformer"),children:(0,I.jsx)(d.x6,{i18nKey:"transformers.convert-field-type-transformer-editor.convert-field-type",children:"Convert field type"})})]})},_i={id:oe.F.convertFieldType,editor:hc,transformation:de.c.convertFieldTypeTransformer,name:de.c.convertFieldTypeTransformer.name,description:de.c.convertFieldTypeTransformer.description,categories:new Set([v.m.Reformat]),help:Ee(oe.F.convertFieldType).helperDocs};var Ua=e(8934);class es extends l.PureComponent{constructor(G){super(G),this.onFieldToggle=k=>{const{selected:re}=this.state;re.indexOf(k)>-1?this.onChange(re.filter(ue=>ue!==k)):this.onChange([...re,k])},this.onChange=k=>{const{regex:re,isRegexValid:ue}=this.state,ge={...this.props.options,include:{names:k}};re&&ue&&(ge.include=ge.include??{},ge.include.pattern=re),this.setState({selected:k},()=>{this.props.onChange(ge)})},this.onInputBlur=k=>{const{selected:re,regex:ue}=this.state;let ge=!0;try{ue&&(0,Ua.dO)(ue)}catch{ge=!1}ge?this.props.onChange({...this.props.options,include:{pattern:ue}}):this.props.onChange({...this.props.options,include:{names:re}}),this.setState({isRegexValid:ge})},this.onVariableChange=k=>{this.props.onChange({...this.props.options,include:{variable:k.value}}),this.setState({variable:k.value})},this.onFromVariableChange=k=>{const re=k.currentTarget.checked;this.props.onChange({...this.props.options,byVariable:re}),this.setState({byVariable:re})},this.state={include:G.options.include?.names||[],regex:G.options.include?.pattern,variable:G.options.include?.variable,byVariable:G.options.byVariable||!1,options:[],variables:[],selected:[],isRegexValid:!0}}componentDidMount(){this.initOptions()}componentDidUpdate(G){this.props.input!==G.input&&this.initOptions()}initOptions(){const{input:G,options:k}=this.props,re=Array.from(k.include?.names??[]),ue=(0,dt.w)().getVariables().map(Ae=>({label:"$"+Ae.name,value:"$"+Ae.name})),ge=[],Pe={};for(const Ae of G)for(const We of Ae.fields){const qe=(0,se.Ct)(We,Ae,G);let et=Pe[qe];et||(et=Pe[qe]={name:qe,count:0},ge.push(et)),et.count++}if(k.include?.pattern)try{const Ae=(0,Ua.dO)(k.include.pattern);for(const We of ge)Ae.test(We.name)&&re.push(We.name)}catch(Ae){console.error(Ae)}if(re.length){const Ae=ge.filter(We=>re.includes(We.name));this.setState({options:ge,selected:Ae.map(We=>We.name),variables:ue,byVariable:k.byVariable||!1,variable:k.include?.variable,regex:k.include?.pattern})}else this.setState({options:ge,selected:ge.map(Ae=>Ae.name),variables:ue,byVariable:k.byVariable||!1,variable:k.include?.variable,regex:k.include?.pattern})}render(){const{options:G,selected:k,isRegexValid:re}=this.state;return(0,I.jsxs)("div",{children:[(0,I.jsx)(Oe.C,{label:(0,d.t)("transformers.filter-by-name-transformer-editor.label-use-variable","Use variable"),children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.filter-by-name-transformer-editor.label-from-variable","From variable"),children:(0,I.jsx)(bt.K,{value:this.state.byVariable,onChange:this.onFromVariableChange})})}),this.state.byVariable?(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.filter-by-name-transformer-editor.label-variable","Variable"),children:(0,I.jsx)(Se.l6,{value:this.state.variable,onChange:this.onVariableChange,options:this.state.variables||[]})})}):(0,I.jsxs)(Oe.C,{label:(0,d.t)("transformers.filter-by-name-transformer-editor.label-identifier","Identifier"),children:[(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.filter-by-name-transformer-editor.label-identifier","Identifier"),invalid:!re,error:re?void 0:"Invalid pattern",children:(0,I.jsx)(tn.p,{placeholder:(0,d.t)("transformers.filter-by-name-transformer-editor.placeholder-regular-expression-pattern","Regular expression pattern"),value:this.state.regex||"",onChange:ue=>this.setState({regex:ue.currentTarget.value}),onBlur:this.onInputBlur,width:25})}),G.map((ue,ge)=>{const Pe=`${ue.name}${ue.count>1?" ("+ue.count+")":""}`,Ae=k.indexOf(ue.name)>-1;return(0,I.jsx)(bn.m,{onClick:()=>{this.onFieldToggle(ue.name)},label:Pe,selected:Ae},`${ue.name}/${ge}`)})]})]})}}const ts={id:oe.F.filterFieldsByName,editor:es,transformation:de.c.filterFieldsByNameTransformer,name:de.c.filterFieldsByNameTransformer.name,description:"Removes part of the query results using a regex pattern. The pattern can be inclusive or exclusive.",categories:new Set([v.m.Filter]),help:Ee(oe.F.filterFieldsByName).helperDocs};var Xs=e(42240);const Gi=F=>(0,I.jsx)(Xs.M,{value:{id:ne.jR.byRefId,options:F.options.include||""},onChange:G=>{F.onChange({...F.options,include:G?.options||""})},context:{data:F.input}}),Zs={id:oe.F.filterByRefId,editor:Gi,transformation:de.c.filterFramesByRefIdTransformer,name:de.c.filterFramesByRefIdTransformer.name,description:"Filter data by query. This is useful if you are sharing the results from a different panel that has many queries and you want to only visualize a subset of that in this panel.",categories:new Set([v.m.Filter]),help:Ee(oe.F.filterByRefId).helperDocs};var Ho=e(40041);function kr({input:F,options:G,onChange:k}){const re={settings:{width:30,filter:qe=>qe.type===ee.PU.string,placeholderText:(0,d.t)("transformers.format-string-transfomer-editor.field-name-picker-settings.placeholderText.select-text-field","Select text field"),noFieldsMessage:(0,d.t)("transformers.format-string-transfomer-editor.field-name-picker-settings.noFieldsMessage.no-text-fields-found","No text fields found")},name:"",id:"",editor:()=>null},ue=(0,l.useCallback)(qe=>{k({...G,stringField:qe??""})},[k,G]),ge=(0,l.useCallback)(qe=>{const et=qe.value??Ho.gs.UpperCase;k({...G,outputFormat:et})},[k,G]),Pe=(0,l.useCallback)(qe=>{k({...G,substringStart:qe??0})},[k,G]),Ae=(0,l.useCallback)(qe=>{k({...G,substringEnd:qe??0})},[k,G]),We=Object.values(Ho.gs).map(qe=>({label:qe,value:qe}));return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(Oe.C,{children:[(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.format-string-transfomer-editor.label-field","Field"),labelWidth:10,children:(0,I.jsx)(ma.O,{context:{data:F},value:G.stringField??"",onChange:ue,item:re})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.format-string-transfomer-editor.label-format","Format"),labelWidth:10,children:(0,I.jsx)(Se.l6,{options:We,value:G.outputFormat,onChange:ge,width:20})})]}),G.outputFormat===Ho.gs.Substring&&(0,I.jsxs)(Oe.C,{children:[(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.format-string-transfomer-editor.label-substring-range","Substring range"),labelWidth:15,children:(0,I.jsx)(It.Q,{min:0,value:G.substringStart??0,onChange:Pe,width:7})}),(0,I.jsx)(ae.I,{children:(0,I.jsx)(It.Q,{min:0,value:G.substringEnd??0,onChange:Ae,width:7})})]})]})}const Hi={id:oe.F.formatString,editor:kr,transformation:de.c.formatStringTransformer,name:de.c.formatStringTransformer.name,state:Ve.pn.beta,description:de.c.formatStringTransformer.description,categories:new Set([v.m.Reformat])};var Qi=e(89640);function ki({input:F,options:G,onChange:k}){const re=[],ue=(0,He.qt)(!0);for(const We of F)for(const qe of We.fields)if(qe.type==="time"){const et=(0,se.Ct)(qe,We,F);re.push({label:et,value:et})}const ge=(0,l.useCallback)(We=>{const qe=We?.value!==void 0?We.value:"";k({...G,timeField:qe})},[k,G]),Pe=(0,l.useCallback)(We=>{const qe=We.target.value;k({...G,outputFormat:qe})},[k,G]),Ae=(0,l.useCallback)(We=>{const qe=We?.value!==void 0?We.value:"";k({...G,timezone:qe})},[k,G]);return(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)(Oe.C,{children:[(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.format-time-transfomer-editor.label-time-field","Time field"),labelWidth:15,grow:!0,children:(0,I.jsx)(Se.l6,{options:re,value:G.timeField,onChange:ge,placeholder:"time",isClearable:!0})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.format-time-transfomer-editor.label-format","Format"),labelWidth:10,tooltip:(0,I.jsxs)(d.x6,{i18nKey:"transformers.format-time-transfomer-editor.tooltip-format",children:["The output format for the field specified as a"," ",(0,I.jsx)(Qi.Y,{href:"https://momentjs.com/docs/#/displaying/",external:!0,children:"Moment.js format string"}),"."]}),interactive:!0,children:(0,I.jsx)(tn.p,{onChange:Pe,value:G.outputFormat})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.format-time-transfomer-editor.label-set-timezone","Set timezone"),tooltip:(0,d.t)("transformers.format-time-transfomer-editor.tooltip-timezone-manually","Set the timezone of the date manually"),labelWidth:20,children:(0,I.jsx)(Se.l6,{options:ue,value:G.timezone,onChange:Ae,isClearable:!0})})]})})}const fc={id:oe.F.formatTime,editor:ki,transformation:de.c.formatTimeTransformer,name:de.c.formatTimeTransformer.name,state:Ve.pn.alpha,description:de.c.formatTimeTransformer.description,help:Ee(oe.F.formatTime).helperDocs};var or=e(47433),za=e(34999);const pc=({input:F,options:G,onChange:k})=>{const re=(0,He.ZI)(F,!0),ue=(0,l.useCallback)(We=>qe=>{k({...G,fields:{...G.fields,[We]:qe}})},[k]);let ge,Pe=!1;for(const We of Object.values(G.fields))We.aggregations.length>0&&We.operation!==null&&(Pe=!0),We.operation===or.R3.groupBy&&(ge=!0);const Ae=Pe&&!ge;return(0,I.jsxs)(kt.B,{direction:"column",children:[Ae&&(0,I.jsx)(za.F,{title:(0,d.t)("transformers.group-by-transformer-editor.title-calc-alert","Calculations will not have an effect if no fields are being grouped on"),severity:"warning"}),re.map(We=>(0,I.jsx)(yo,{onConfigChange:ue(We),fieldName:We,config:G.fields[We]},We))]})},xr=[{label:"Group by",value:or.R3.groupBy},{label:"Calculate",value:or.R3.aggregate}],yo=({fieldName:F,config:G,onConfigChange:k})=>{const re=(0,mt.$j)(),ue=ir(re),ge=(0,l.useCallback)(Pe=>{k({aggregations:G?.aggregations??[],operation:Pe?.value??null})},[G,k]);return(0,I.jsx)(ae.I,{className:ue.label,label:F,grow:!0,shrink:!0,children:(0,I.jsxs)(kt.B,{gap:.5,direction:"row",children:[(0,I.jsx)("div",{className:ue.operation,children:(0,I.jsx)(Se.l6,{options:xr,value:G?.operation,placeholder:(0,d.t)("transformers.group-by-field-configuration.placeholder-ignored","Ignored"),onChange:ge,isClearable:!0})}),G?.operation===or.R3.aggregate&&(0,I.jsx)(Xt.S,{className:ue.aggregations,placeholder:(0,d.t)("transformers.group-by-field-configuration.placeholder-select-stats","Select stats"),allowMultiple:!0,stats:G.aggregations,onChange:Pe=>{k({...G,aggregations:Pe})}})]})})},ir=F=>({label:(0,Ye.css)({label:{minWidth:F.spacing(32)}}),operation:(0,Ye.css)({flexShrink:0,height:"100%",width:F.spacing(24)}),aggregations:(0,Ye.css)({flexGrow:1})}),lr={id:oe.F.groupBy,editor:pc,transformation:de.c.groupByTransformer,name:de.c.groupByTransformer.name,description:de.c.groupByTransformer.description,categories:new Set([v.m.Combine,v.m.CalculateNewFields,v.m.Reformat]),help:Ee(oe.F.groupBy).helperDocs};var Qo=e(25260),Yi=e(37386);const cr=({input:F,options:G,onChange:k})=>{const re=(0,He.ZI)(F),ue=G.showSubframeHeaders===void 0?Qo.l:G.showSubframeHeaders,ge=(0,l.useCallback)(et=>rt=>{k({...G,fields:{...G.fields,[et]:rt}})},[k]),Pe=(0,l.useCallback)(()=>{const et=G.showSubframeHeaders===void 0?!Qo.l:!G.showSubframeHeaders;k({showSubframeHeaders:et,fields:{...G.fields}})},[k]);let Ae,We=!1;for(const et of Object.values(G.fields))et.aggregations.length>0&&et.operation!==null&&(We=!0),et.operation===or.R3.groupBy&&(Ae=!0);const qe=We&&!Ae;return(0,I.jsxs)(kt.B,{direction:"column",children:[qe&&(0,I.jsx)(za.F,{title:(0,d.t)("transformers.group-to-nested-table-transformer-editor.title-calc-alert","Calculations will not have an effect if no fields are being grouped on."),severity:"warning"}),(0,I.jsx)("div",{children:re.map(et=>(0,I.jsx)(Ji,{onConfigChange:ge(et),fieldName:et,config:G.fields[et]},et))}),(0,I.jsx)(Yi.D,{label:(0,d.t)("transformers.group-to-nested-table-transformer-editor.label-show-field-names-in-nested-tables","Show field names in nested tables"),description:(0,d.t)("transformers.group-to-nested-table-transformer-editor.description-show-field-names","If enabled nested tables will show field names as a table header"),children:(0,I.jsx)(bt.d,{value:ue,onChange:Pe})})]})},xo=[{label:"Group by",value:or.R3.groupBy},{label:"Calculate",value:or.R3.aggregate}],Ji=({fieldName:F,config:G,onConfigChange:k})=>{const re=(0,mt.$j)(),ue=Cs(re),ge=(0,l.useCallback)(Pe=>{k({aggregations:G?.aggregations??[],operation:Pe?.value??null})},[G,k]);return(0,I.jsx)(ae.I,{className:ue.label,label:F,grow:!0,shrink:!0,children:(0,I.jsxs)(kt.B,{gap:.5,direction:"row",wrap:!1,children:[(0,I.jsx)("div",{className:ue.operation,children:(0,I.jsx)(Se.l6,{options:xo,value:G?.operation,placeholder:(0,d.t)("transformers.group-by-field-configuration.placeholder-ignored","Ignored"),onChange:ge,isClearable:!0})}),G?.operation===or.R3.aggregate&&(0,I.jsx)(Xt.S,{className:ue.aggregations,placeholder:(0,d.t)("transformers.group-by-field-configuration.placeholder-select-stats","Select stats"),allowMultiple:!0,stats:G.aggregations,onChange:Pe=>{k({...G,aggregations:Pe})}})]})})},Cs=F=>({label:(0,Ye.css)({minWidth:F.spacing(32)}),operation:(0,Ye.css)({flexShrink:0,height:"100%",width:F.spacing(24)}),aggregations:(0,Ye.css)({flexGrow:1})}),Xi={id:oe.F.groupToNestedTable,editor:cr,transformation:de.c.groupToNestedTable,name:de.c.groupToNestedTable.name,description:de.c.groupToNestedTable.description,categories:new Set([v.m.Combine,v.m.CalculateNewFields,v.m.Reformat]),state:Ve.pn.beta};var qs=e(79319);const Eo=({input:F,options:G,onChange:k})=>{const re=(0,He.ZI)(F).map(et=>({label:et,value:et})),ue=(0,dt.w)().getVariables().map(et=>({value:"$"+et.name,label:"$"+et.name})),ge=(0,l.useCallback)(et=>{k({...G,columnField:et?.value})},[k,G]),Pe=(0,l.useCallback)(et=>{k({...G,rowField:et?.value})},[k,G]),Ae=(0,l.useCallback)(et=>{k({...G,valueField:et?.value})},[k,G]),We=[{label:(0,d.t)("transformers.grouping-to-matrix-transformer-editor.special-value-options.label.null","Null"),value:qs.N.Null,description:(0,d.t)("transformers.grouping-to-matrix-transformer-editor.special-value-options.description.null-value","Null value")},{label:(0,d.t)("transformers.grouping-to-matrix-transformer-editor.special-value-options.label.true","True"),value:qs.N.True,description:(0,d.t)("transformers.grouping-to-matrix-transformer-editor.special-value-options.description.boolean-true-value","Boolean true value")},{label:(0,d.t)("transformers.grouping-to-matrix-transformer-editor.special-value-options.label.false","False"),value:qs.N.False,description:(0,d.t)("transformers.grouping-to-matrix-transformer-editor.special-value-options.description.boolean-false-value","Boolean false value")},{label:(0,d.t)("transformers.grouping-to-matrix-transformer-editor.special-value-options.label.zero","Zero"),value:qs.N.Zero,description:(0,d.t)("transformers.grouping-to-matrix-transformer-editor.special-value-options.description.number-value","Number 0 value")},{label:(0,d.t)("transformers.grouping-to-matrix-transformer-editor.special-value-options.label.empty","Empty"),value:qs.N.Empty,description:(0,d.t)("transformers.grouping-to-matrix-transformer-editor.special-value-options.description.empty-string","Empty string")}],qe=(0,l.useCallback)(et=>{k({...G,emptyValue:et?.value})},[k,G]);return(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)(Oe.C,{children:[(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.grouping-to-matrix-transformer-editor.label-column","Column"),labelWidth:8,children:(0,I.jsx)(Se.l6,{options:[...re,...ue],value:G.columnField,onChange:ge,isClearable:!0})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.grouping-to-matrix-transformer-editor.label-row","Row"),labelWidth:8,children:(0,I.jsx)(Se.l6,{options:[...re,...ue],value:G.rowField,onChange:Pe,isClearable:!0})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.grouping-to-matrix-transformer-editor.label-cell-value","Cell value"),labelWidth:10,children:(0,I.jsx)(Se.l6,{options:[...re,...ue],value:G.valueField,onChange:Ae,isClearable:!0})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.grouping-to-matrix-transformer-editor.label-empty-value","Empty value"),children:(0,I.jsx)(Se.l6,{options:We,value:G.emptyValue,onChange:qe,isClearable:!0})})]})})},Po={id:oe.F.groupingToMatrix,editor:Eo,transformation:de.c.groupingToMatrixTransformer,name:de.c.groupingToMatrixTransformer.name,description:"Takes a three fields combination and produces a Matrix.",categories:new Set([v.m.Combine,v.m.Reformat]),help:Ee(oe.F.groupingToMatrix).helperDocs};var Ks=e(74261);const Zi=({input:F,options:G,onChange:k})=>{const[ue,ge]=(0,l.useState)({bucketCount:!(0,He.N_)(G.bucketCount||""),bucketSize:!(0,He.N_)(G.bucketSize||""),bucketOffset:!(0,He.N_)(G.bucketOffset||"")}),Pe=(0,l.useCallback)(rt=>{ge({...ue,bucketCount:!(0,He.N_)(rt)}),k({...G,bucketCount:Number(rt)===0?void 0:Number(rt)})},[k,G,ue]),Ae=(0,l.useCallback)(rt=>{ge({...ue,bucketSize:!(0,He.N_)(rt)}),k({...G,bucketSize:rt})},[k,G,ue,ge]),We=(0,l.useCallback)(rt=>{ge({...ue,bucketOffset:!(0,He.N_)(rt)}),k({...G,bucketOffset:rt})},[k,G,ue,ge]),qe=(0,l.useCallback)(()=>{k({...G,combine:!G.combine})},[k,G]),et=(0,He.I9)();return(0,I.jsxs)("div",{children:[(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{invalid:ue.bucketCount,error:"Value needs to be an integer or a variable",labelWidth:18,label:Ks.Rt.bucketCount.name,tooltip:Ks.Rt.bucketCount.description,children:(0,I.jsx)(_e.y,{suggestions:et,value:G.bucketCount,placeholder:(0,d.t)("transformers.histogram-transformer-editor.placeholder-default","Default: 30"),onChange:Pe})})}),(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{invalid:ue.bucketSize,error:"Value needs to be an integer or a variable",labelWidth:18,label:Ks.Rt.bucketSize.name,tooltip:Ks.Rt.bucketSize.description,children:(0,I.jsx)(_e.y,{suggestions:et,value:G.bucketSize,placeholder:(0,d.t)("transformers.histogram-transformer-editor.placeholder-auto","Auto"),onChange:Ae})})}),(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{labelWidth:18,label:Ks.Rt.bucketOffset.name,tooltip:Ks.Rt.bucketOffset.description,invalid:ue.bucketOffset,error:"Value needs to be an integer or a variable",children:(0,I.jsx)(_e.y,{suggestions:et,value:G.bucketOffset,placeholder:(0,d.t)("transformers.histogram-transformer-editor.placeholder-none","None"),onChange:We})})}),(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{labelWidth:18,label:Ks.Rt.combine.name,tooltip:Ks.Rt.combine.description,children:(0,I.jsx)(bt.K,{value:G.combine??!1,onChange:qe})})})]})},qi={id:oe.F.histogram,editor:Zi,transformation:de.c.histogramTransformer,name:de.c.histogramTransformer.name,description:de.c.histogramTransformer.description,categories:new Set([v.m.CreateNewVisualization]),help:Ee(oe.F.histogram).helperDocs};var dr=e(6684),bo=e(56755);const Ja=[{value:dr.W.outer,label:"OUTER (TIME SERIES)",description:"Keep all rows from any table with a value. Join on distinct field values. Performant and best used for time series."},{value:dr.W.outerTabular,label:"OUTER (TABULAR)",description:"Join on a field value with duplicated values. Non performant outer join best used for tabular(SQL like) data."},{value:dr.W.inner,label:"INNER",description:"Combine data from two tables whenever there are matching values in a fields common to both tables."}];function Do({input:F,options:G,onChange:k}){const re=(0,bo.sE)(F),ue=(0,bo.m3)(re),ge=(0,dt.w)().getVariables().map(We=>({value:"$"+We.name,label:"$"+We.name})),Pe=(0,l.useCallback)(We=>{k({...G,byField:We?.value})},[k,G]),Ae=(0,l.useCallback)(We=>{k({...G,mode:We?.value})},[k,G]);return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.series-to-fields-transformer-editor.label-mode","Mode"),labelWidth:8,grow:!0,children:(0,I.jsx)(Se.l6,{options:Ja,value:G.mode??dr.W.outer,onChange:Ae})})}),(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.series-to-fields-transformer-editor.label-field","Field"),labelWidth:8,grow:!0,children:(0,I.jsx)(Se.l6,{options:[...ue,...ge],value:G.byField,onChange:Pe,placeholder:"time",isClearable:!0})})})]})}const ko={id:oe.F.joinByField,aliasIds:[oe.F.seriesToColumns],editor:Do,transformation:de.c.joinByFieldTransformer,name:de.c.joinByFieldTransformer.name,description:de.c.joinByFieldTransformer.description,categories:new Set([v.m.Combine]),help:Ee(oe.F.joinByField).helperDocs};var Er=e(79184);const Yr=[{value:Er.n.Columns,label:"Columns"},{value:Er.n.Rows,label:"Rows"}],Ar=({input:F,options:G,onChange:k})=>{const{labelNames:ue,selected:ge}=(0,l.useMemo)(()=>{let We=[],qe={};for(const rt of F)for(const lt of rt.fields)if(lt.labels)for(const pt of Object.keys(lt.labels))qe[pt]||(We.push({value:pt,label:pt}),qe[pt]=!0);const et=new Set(G.keepLabels?.length?G.keepLabels:Object.keys(qe));return{labelNames:We,selected:et}},[G.keepLabels,F]),Pe=We=>{k({...G,valueLabel:We?.value})},Ae=We=>{if(ge.has(We)?ge.delete(We):ge.add(We),ge.size===ue.length||!ge.size){const{keepLabels:qe,...et}=G;k(et)}else k({...G,keepLabels:[...ge]})};return(0,I.jsxs)("div",{children:[(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.labels-as-fields-transformer-editor.label-mode","Mode"),labelWidth:20,children:(0,I.jsx)(ce.z,{options:Yr,value:G.mode??Er.n.Columns,onChange:We=>k({...G,mode:We})})})}),(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.labels-as-fields-transformer-editor.label-labels","Labels"),labelWidth:20,shrink:!0,children:(0,I.jsx)(kt.B,{gap:.5,wrap:"wrap",children:ue.map((We,qe)=>{const et=We.label;return(0,I.jsx)(bn.m,{onClick:()=>Ae(et),label:et,selected:ge.has(et)},`${et}/${qe}`)})})})}),G.mode!==Er.n.Rows&&(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.labels-as-fields-transformer-editor.label-value-field-name","Value field name"),labelWidth:20,tooltip:(0,d.t)("transformers.labels-as-fields-transformer-editor.tooltip-replace-value-field-label","Replace the value field name with a label"),htmlFor:"labels-to-fields-as-name",children:(0,I.jsx)(Se.l6,{inputId:"labels-to-fields-as-name",isClearable:!0,allowCustomValue:!1,placeholder:(0,d.t)("transformers.labels-as-fields-transformer-editor.placeholder-optional-select-label","(Optional) Select label"),options:ue,value:G?.valueLabel,onChange:Pe,className:"min-width-16"})})})]})},gc={id:oe.F.labelsToFields,editor:Ar,transformation:de.c.labelsToFieldsTransformer,name:de.c.labelsToFieldsTransformer.name,description:`Groups series by time and return labels or tags as fields.
                Useful for showing time series with labels in a table where each label key becomes a separate column.`,categories:new Set([v.m.Reformat]),help:Ee(oe.F.labelsToFields).helperDocs},ls=({options:F,onChange:G})=>{const[k,re]=(0,l.useState)(!1),ue=(0,l.useCallback)(ge=>{re(!(0,He.N_)(ge)),G({...F,limitField:ge})},[G,F]);return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(Oe.C,{children:(0,I.jsx)(_e.y,{invalid:k,error:"Value needs to be an integer or a variable",value:String(F.limitField),onChange:ue,placeholder:(0,d.t)("transformers.limit-transformer-editor.placeholder-value-or-variable","Value or variable"),suggestions:(0,He.I9)()})})})},Yo={id:oe.F.limit,editor:ls,transformation:de.c.limitTransformer,name:de.c.limitTransformer.name,description:"Limit the number of items displayed.",categories:new Set([v.m.Filter]),help:Ee(oe.F.limit).helperDocs},el=({input:F,options:G,onChange:k})=>F.length<=1?(0,I.jsx)(Ns.P,{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.merge-transformer-editor.merge-effect-applied-single-frame",children:"Merge has no effect when applied on a single frame."})}):null,mc={id:oe.F.merge,editor:el,transformation:de.c.mergeTransformer,name:de.c.mergeTransformer.name,description:`Merge many series/tables and return a single table where mergeable values will be combined into the same row.
                Useful for showing multiple series, tables or a combination of both visualized in a table.`,categories:new Set([v.m.Combine]),help:Ee(oe.F.merge).helperDocs};var ba=e(95575),Ta=e(66404);function vc(F,G,k){F.splice(k,0,F.splice(G,1)[0])}const Jo=({options:F,input:G,onChange:k})=>{const{indexByName:re,excludeByName:ue,renameByName:ge,includeByName:Pe,orderBy:Ae,orderByMode:We}=F,qe=(0,He.ZI)(G),et=(0,l.useMemo)(()=>{if(G.length>0&&We===ba.NU.Auto){const an=(0,ba.wx)(Ae??[]);return(0,He.gD)([{...G[0],fields:an(G[0].fields)}],!1)}return tl(qe,re)},[G,qe,re,We,Ae]),rt=(0,l.useMemo)(()=>{const an=[];if(We===ba.NU.Auto){const gn=(0,He.aG)(G);let $n=!1;Ae?.forEach((Ea,Rr)=>{let uc=Ea.desc?ba.pH.Desc:ba.pH.Asc;Ea.type===ba.Mq.Name?(an.push({type:ba.Mq.Name,order:uc}),$n=!0):gn.has(Ea.name)&&(an.push({type:ba.Mq.Label,name:Ea.name,order:uc}),gn.delete(Ea.name))}),$n||an.push({type:ba.Mq.Name,order:ba.pH.Off}),gn.forEach(Ea=>{an.push({type:ba.Mq.Label,name:Ea,order:ba.pH.Off})})}return an},[G,We,Ae]),lt=Pe&&Object.keys(Pe).length>0?"include":"exclude",pt=(0,l.useCallback)((an,gn)=>{k({...F,excludeByName:{...ue,[an]:gn}})},[k,F,ue]),ht=(0,l.useCallback)((an,gn)=>{const $n={...F,includeByName:{...Pe,[an]:!gn}};k($n)},[k,F,Pe]),Ct=(0,l.useCallback)(an=>{if(!an||!an.destination)return;const gn=an.source.index,$n=an.destination.index;gn!==$n&&k({...F,indexByName:Jr(qe,gn,$n)})},[k,F,qe]),Wt=(0,l.useCallback)((an,gn)=>{k({...F,renameByName:{...F.renameByName,[an]:gn}})},[k,F]),en=(0,l.useCallback)((an,gn)=>{an.order=gn;const $n=[];rt.forEach(Ea=>{Ea.order!==ba.pH.Off&&$n.push({type:Ea.type,name:Ea.name,desc:Ea.order===ba.pH.Desc})}),k({...F,orderBy:$n})},[F,rt,k]),on=(0,l.useCallback)(an=>{if(an.destination==null)return;const gn=an.source.index,$n=an.destination.index;if(gn===$n)return;vc(rt,gn,$n);const Ea=[];rt.forEach(Rr=>{Rr.order!==ba.pH.Off&&Ea.push({type:Rr.type,name:Rr.name,desc:Rr.order===ba.pH.Desc})}),k({...F,orderBy:Ea})},[F,k,rt]);if(G.length>1)return(0,I.jsx)(Ns.P,{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.organize-fields-transformer-editor.first-frame-warning",children:"Organize fields only works with a single frame. Consider applying a join transformation or filtering the input first."})});const vn=(0,mt.of)(ur);return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(Oe.C,{className:vn.fieldOrderRadio,children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.organize-fields-transformer-editor.field-order","Field order"),children:(0,I.jsx)(ce.z,{options:[{label:(0,d.t)("transformers.organize-fields-transformer-editor.field-order-manual","Manual"),value:ba.NU.Manual},{label:(0,d.t)("transformers.organize-fields-transformer-editor.field-order-auto","Auto"),value:ba.NU.Auto}],value:F.orderByMode??ba.NU.Manual,onChange:an=>k({...F,orderByMode:an})})})}),(0,I.jsx)(ta.JY,{onDragEnd:on,children:F.orderByMode===ba.NU.Auto&&(0,I.jsx)(ta.gL,{droppableId:"sortable-labels-transformer",direction:"vertical",children:an=>(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("div",{ref:an.innerRef,className:vn.labelsDraggable,...an.droppableProps,children:rt.map((gn,$n)=>(0,I.jsx)(Xo,{item:gn,index:$n,onChangeSort:en}))}),an.placeholder]})})}),(0,I.jsx)(ta.JY,{onDragEnd:Ct,children:(0,I.jsx)(ta.gL,{droppableId:"sortable-fields-transformer",direction:"vertical",children:an=>(0,I.jsxs)("div",{ref:an.innerRef,...an.droppableProps,children:[et.map((gn,$n)=>{const Ea=Pe&&gn in Pe?Pe[gn]:!1,Rr=lt==="include"?Ea:!ue[gn],uc=lt==="include"?ht:pt;return(0,I.jsx)(Co,{fieldName:gn,renamedFieldName:ge[gn],index:$n,onToggleVisibility:uc,onRenameField:Wt,visible:Rr,isDragDisabled:F.orderByMode===ba.NU.Auto},gn)}),an.placeholder]})})})]})},ur=F=>({fieldOrderRadio:(0,Ye.css)({marginBottom:F.spacing(1)}),labelsDraggable:(0,Ye.css)({marginBottom:F.spacing(3)})});Jo.displayName="OrganizeFieldsTransformerEditor";const Co=({fieldName:F,renamedFieldName:G,index:k,visible:re,onToggleVisibility:ue,onRenameField:ge,isDragDisabled:Pe})=>{const Ae=(0,mt.of)(Zo);return(0,I.jsx)(ta.sx,{draggableId:F,index:k,isDragDisabled:Pe,children:We=>(0,I.jsxs)(ie.a,{display:"flex",gap:0,ref:We.innerRef,...We.draggableProps,children:[(0,I.jsx)(Fe.c,{width:60,as:"div",children:(0,I.jsxs)(kt.B,{gap:0,justifyContent:"flex-start",alignItems:"center",width:"100%",children:[!Pe&&(0,I.jsx)("span",{...We.dragHandleProps,children:(0,I.jsx)(_n.I,{name:"draggabledots",title:(0,d.t)("transformers.draggable-field-name.title-drag-and-drop-to-reorder","Drag and drop to reorder"),size:"lg",className:Ae.draggable})}),(0,I.jsx)(is.K,{className:Ae.toggle,size:"md",name:re?"eye":"eye-slash",onClick:()=>ue(F,re),tooltip:re?(0,d.t)("transformers.draggable-field-name.tooltip-disable","Disable"):(0,d.t)("transformers.draggable-field-name.tooltip-enable","Enable")}),(0,I.jsx)(Ta.E,{truncate:!0,element:"p",variant:"bodySmall",weight:"bold",children:F})]})}),(0,I.jsx)(tn.p,{defaultValue:G||"",placeholder:(0,d.t)("transformers.draggable-field-name.rename-placeholder","Rename {{fieldName}}",{fieldName:F,interpolation:{escapeValue:!1}}),onBlur:qe=>ge(F,qe.currentTarget.value)})]})})};Co.displayName="DraggableFieldName";const Xo=({index:F,item:G,onChangeSort:k})=>{const re=(0,mt.of)(Zo),ue=(0,l.useId)();return(0,I.jsx)(ta.sx,{draggableId:ue,index:F,isDragDisabled:G.order===ba.pH.Off,children:ge=>(0,I.jsxs)(ie.a,{marginBottom:.5,display:"flex",gap:0,ref:ge.innerRef,...ge.draggableProps,children:[(0,I.jsx)(Fe.c,{width:60,as:"div",children:(0,I.jsxs)(kt.B,{gap:3,justifyContent:"flex-start",alignItems:"center",width:"100%",children:[(0,I.jsx)("span",{...ge.dragHandleProps,children:(0,I.jsx)(_n.I,{name:"draggabledots",title:(0,d.t)("transformers.draggable-field-name.title-drag-and-drop-to-reorder","Drag and drop to reorder"),size:"lg",className:(0,Ye.cx)(re.draggable,{[re.disabled]:G.order===ba.pH.Off})})}),(0,I.jsx)(Ta.E,{truncate:!0,element:"p",variant:"bodySmall",weight:"bold",children:G.type===ba.Mq.Label?`Label: ${G.name}`:"Field name"})]})}),(0,I.jsx)(ce.z,{options:[{label:(0,d.t)("transformers.draggable-sort-order.off","Off"),value:ba.pH.Off},{label:(0,d.t)("transformers.draggable-sort-order.asc","ASC"),value:ba.pH.Asc},{label:(0,d.t)("transformers.draggable-sort-order.desc","DESC"),value:ba.pH.Desc}],value:G.order,onChange:Pe=>{k(G,Pe)}})]})})};Xo.displayName="DraggableUIOrderByItem";const Zo=F=>({toggle:(0,Ye.css)({margin:F.spacing(0,1),color:F.colors.text.secondary}),draggable:(0,Ye.css)({opacity:.4,"&:hover":{color:F.colors.text.maxContrast}}),disabled:(0,Ye.css)({color:F.colors.text.disabled,pointerEvents:"none"})}),Jr=(F,G,k)=>{const re=Array.from(F),[ue]=re.splice(G,1);return re.splice(k,0,ue),re.reduce((ge,Pe,Ae)=>(ge[Pe]=Ae,ge),{})},tl=(F,G={})=>{if(!G||Object.keys(G).length===0)return F;const k=(0,ba.Xz)(G);return F.sort(k)},qo={id:oe.F.organize,editor:Jo,transformation:de.c.organizeFieldsTransformer,name:de.c.organizeFieldsTransformer.name,description:"Allows the user to re-order, hide, or rename fields / columns. Useful when data source doesn't allow overrides for visualizing data.",categories:new Set([v.m.ReorderAndRename]),help:Ee(oe.F.organize).helperDocs};var Ss=e(32157),Sa=e(51898);const ei=({options:F,onChange:G})=>{const k=[{label:(0,d.t)("transformers.reduce-transformer-editor.modes.label.series-to-rows","Series to rows"),value:Ss.rV.SeriesToRows,description:(0,d.t)("transformers.reduce-transformer-editor.modes.description.create-table-series-value","Create a table with one row for each series value")},{label:(0,d.t)("transformers.reduce-transformer-editor.modes.label.reduce-fields","Reduce fields"),value:Ss.rV.ReduceFields,description:(0,d.t)("transformers.reduce-transformer-editor.modes.description.collapse-field-single-value","Collapse each field into a single value")}],re=(0,l.useCallback)(Pe=>{const Ae=Pe.value;G({...F,mode:Ae,includeTimeField:Ae===Ss.rV.ReduceFields?!!F.includeTimeField:!1})},[G,F]),ue=(0,l.useCallback)(()=>{G({...F,includeTimeField:!F.includeTimeField})},[G,F]),ge=(0,l.useCallback)(()=>{G({...F,labelsToFields:!F.labelsToFields})},[G,F]);return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.reduce-transformer-editor.label-mode","Mode"),"data-testid":Sa.Tp.components.Transforms.Reduce.modeLabel,grow:!0,labelWidth:16,children:(0,I.jsx)(Se.l6,{options:k,value:k.find(Pe=>Pe.value===F.mode)||k[0],onChange:re})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.reduce-transformer-editor.label-calculations","Calculations"),"data-testid":Sa.Tp.components.Transforms.Reduce.calculationsLabel,grow:!0,labelWidth:16,children:(0,I.jsx)(Xt.S,{placeholder:(0,d.t)("transformers.reduce-transformer-editor.placeholder-choose-stat","Choose stat"),allowMultiple:!0,stats:F.reducers||[],onChange:Pe=>{G({...F,reducers:Pe})}})}),F.mode===Ss.rV.ReduceFields&&(0,I.jsx)(ae.I,{htmlFor:"include-time-field",labelWidth:16,label:(0,d.t)("transformers.reduce-transformer-editor.label-include-time","Include time"),children:(0,I.jsx)(bt.K,{id:"include-time-field",value:!!F.includeTimeField,onChange:ue})}),F.mode!==Ss.rV.ReduceFields&&(0,I.jsx)(ae.I,{htmlFor:"labels-to-fields",labelWidth:16,label:(0,d.t)("transformers.reduce-transformer-editor.label-labels-to-fields","Labels to fields"),children:(0,I.jsx)(bt.K,{id:"labels-to-fields",value:!!F.labelsToFields,onChange:ge})})]})},nl={id:oe.F.reduce,editor:ei,transformation:de.c.reduceTransformer,name:de.c.reduceTransformer.name,description:de.c.reduceTransformer.description,categories:new Set([v.m.CalculateNewFields]),help:Ee(oe.F.reduce).helperDocs};class al extends l.PureComponent{constructor(G){super(G),this.handleRegexChange=k=>{const re=k.currentTarget.value;let ue=!0;if(re)try{re&&(0,Ua.dO)(re)}catch{ue=!1}this.setState(ge=>({...ge,regex:re,isRegexValid:ue}))},this.handleRenameChange=k=>{const re=k.currentTarget.value;this.setState(ue=>({...ue,renamePattern:re}))},this.handleRegexBlur=k=>{const re=k.currentTarget.value;let ue=!0;try{re&&(0,Ua.dO)(re)}catch{ue=!1}this.setState({isRegexValid:ue},()=>{ue&&this.props.onChange({...this.props.options,regex:re})})},this.handleRenameBlur=k=>{const re=k.currentTarget.value;this.setState({renamePattern:re},()=>this.props.onChange({...this.props.options,renamePattern:re}))},this.state={regex:G.options.regex,renamePattern:G.options.renamePattern,isRegexValid:!0}}render(){const{regex:G,renamePattern:k,isRegexValid:re}=this.state;return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.rename-by-regex-transformer-editor.label-match","Match"),labelWidth:16,invalid:!re,error:re?void 0:"Invalid pattern",children:(0,I.jsx)(tn.p,{placeholder:(0,d.t)("transformers.rename-by-regex-transformer-editor.placeholder-regular-expression-pattern","Regular expression pattern"),value:G||"",onChange:this.handleRegexChange,onBlur:this.handleRegexBlur,width:25})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.rename-by-regex-transformer-editor.label-replace","Replace"),labelWidth:16,children:(0,I.jsx)(tn.p,{placeholder:(0,d.t)("transformers.rename-by-regex-transformer-editor.placeholder-replacement-pattern","Replacement pattern"),value:k||"",onChange:this.handleRenameChange,onBlur:this.handleRenameBlur,width:25})})]})}}const ti={id:oe.F.renameByRegex,editor:al,transformation:de.c.renameByRegexTransformer,name:de.c.renameByRegexTransformer.name,description:"Renames part of the query result by using regular expression with placeholders.",categories:new Set([v.m.ReorderAndRename]),help:Ee(oe.F.renameByRegex).helperDocs},sl=({input:F,options:G,onChange:k})=>null,To={id:oe.F.seriesToRows,editor:sl,transformation:de.c.seriesToRowsTransformer,name:de.c.seriesToRowsTransformer.name,description:`Merge many series and return a single series with time, metric and value as columns.
                Useful for showing multiple time series visualized in a table.`,categories:new Set([v.m.Combine,v.m.Reformat]),help:Ee(oe.F.seriesToRows).helperDocs},Mo=({input:F,options:G,onChange:k})=>{const re=(0,He.ZI)(F).map(We=>({label:We,value:We})),ge=(0,dt.w)().getVariables().map(We=>({label:"$"+We.name,value:"$"+We.name})),Pe=(0,l.useCallback)((We,qe)=>{k({...G,sort:[qe]})},[k,G]),Ae=G.sort?.length?G.sort:[{}];return(0,I.jsx)("div",{children:Ae.map((We,qe)=>(0,I.jsxs)(Oe.C,{children:[(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.sort-by-transformer-editor.label-field","Field"),labelWidth:10,grow:!0,children:(0,I.jsx)(Se.l6,{options:[...re,...ge],value:We.field,placeholder:(0,d.t)("transformers.sort-by-transformer-editor.placeholder-select-field","Select field"),onChange:et=>{Pe(qe,{...We,field:et.value})}})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.sort-by-transformer-editor.label-reverse","Reverse"),children:(0,I.jsx)(bt.K,{value:!!We.desc,onChange:()=>{Pe(qe,{...We,desc:!We.desc})}})})]},`${We.field}/${qe}`))})},jr={id:oe.F.sortBy,editor:Mo,transformation:de.c.sortByTransformer,name:de.c.sortByTransformer.name,description:de.c.sortByTransformer.description,categories:new Set([v.m.ReorderAndRename]),help:Ee(oe.F.sortBy).helperDocs},yc=({options:F,onChange:G})=>(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.transpose-transfomer-editor.label-first-field-name","First field name"),labelWidth:24,children:(0,I.jsx)(tn.p,{placeholder:(0,d.t)("transformers.transpose-transfomer-editor.placeholder-field","Field"),value:F.firstFieldName,onChange:k=>G({...F,firstFieldName:k.currentTarget.value}),width:25})})}),(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.transpose-transfomer-editor.label-remaining-fields-name","Remaining fields name"),tooltip:(0,d.t)("transformers.transpose-transfomer-editor.tooltip-name-for-value-fields","Name for value fields"),labelWidth:24,children:(0,I.jsx)(tn.p,{placeholder:(0,d.t)("transformers.transpose-transfomer-editor.placeholder-value","Value"),value:F.restFieldsName,onChange:k=>G({...F,restFieldsName:k.currentTarget.value}),width:25})})})]}),ni={id:oe.F.transpose,editor:yc,transformation:de.c.transposeTransformer,name:de.c.transposeTransformer.name,description:de.c.transposeTransformer.description,categories:new Set([v.m.Reformat])};var So=e(43243);function ai({options:F,onChange:G}){const[k,re]=(0,l.useState)(F),ue=Oo(),ge=rl(),Pe=()=>{k.push({path:""}),re([...k]),qe()},Ae=et=>{k&&(k.splice(et,1),re([...k]),qe())},We=(et,rt,lt)=>{k&&(lt==="alias"?k[rt].alias=et.currentTarget.value??"":k[rt].path=et.currentTarget.value??"",re([...k]))},qe=()=>{G(k)};return(0,I.jsxs)("ol",{className:(0,Ye.cx)(ge.list),children:[k&&k.map((et,rt)=>(0,I.jsx)("li",{children:(0,I.jsxs)(Oe.C,{children:[(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.jsonpath-editor.label-field","Field"),tooltip:ue.field,grow:!0,children:(0,I.jsx)(tn.p,{onBlur:qe,onChange:lt=>We(lt,rt,"path"),value:et.path,placeholder:(0,d.t)("transformers.jsonpath-editor.placeholder-valid-objectvalue",'A valid json path, e.g. "object.value1" or "object.value2[0]"')})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.jsonpath-editor.label-alias","Alias"),tooltip:ue.alias,children:(0,I.jsx)(tn.p,{width:12,value:et.alias,onBlur:qe,onChange:lt=>We(lt,rt,"alias")})}),(0,I.jsx)(ae.I,{className:(0,Ye.cx)(ge.removeIcon),children:(0,I.jsx)(is.K,{onClick:()=>Ae(rt),name:"trash-alt",tooltip:(0,d.t)("transformers.jsonpath-editor.tooltip-remove-path","Remove path")})})]})},rt)),(0,I.jsx)(ae.I,{children:(0,I.jsx)(ve.$n,{icon:"plus",onClick:()=>Pe(),variant:"secondary",children:(0,I.jsx)(d.x6,{i18nKey:"transformers.jsonpath-editor.add-path",children:"Add path"})})})]})}const Oo=()=>{const F=[{path:"object",description:(0,d.t)("transformers.get-tooltips.map-valid-paths.description.extract-fields-from-object","=> extract fields from object")},{path:"object.value1",description:(0,I.jsxs)(d.x6,{i18nKey:"transformers.get-tooltips.map-valid-paths.description.extract-value",values:{value:"value1"},children:["=> extract ",(0,I.jsx)("code",{children:"{{ value }}"})]})},{path:"object.value2",description:(0,I.jsxs)(d.x6,{i18nKey:"transformers.get-tooltips.map-valid-paths.description.extract-value",values:{value:"value2"},children:["=> extract ",(0,I.jsx)("code",{children:"{{ value }}"})]})},{path:"object.value2[0]",description:(0,I.jsxs)(d.x6,{i18nKey:"transformers.get-tooltips.map-valid-paths.description.extract-value-first-element",values:{value:"value2"},children:["=> extract ",(0,I.jsx)("code",{children:"{{ value }}"})," first element"]})},{path:"object.value2[1]",description:(0,I.jsxs)(d.x6,{i18nKey:"transformers.get-tooltips.map-valid-paths.description.extract-value-second-element",values:{value:"value2"},children:["=> extract ",(0,I.jsx)("code",{children:"{{ value }}"})," second element"]})}];return{field:(0,I.jsxs)("div",{children:[(0,I.jsx)(d.x6,{i18nKey:"transformers.get-tooltips.description",children:"A valid path of an json object."}),(0,I.jsx)("div",{children:(0,I.jsx)("strong",{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.get-tooltips.json-value",children:"JSON Value:"})})}),(0,I.jsx)("pre",{children:(0,I.jsx)("code",{children:["{",'  "object": {','    "value1": "hello world"','    "value2": [1, 2, 3, 4]',"  }","}"].join(`
`)})}),(0,I.jsx)("strong",{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.get-tooltips.valid-paths",children:"Valid Paths:"})}),F.map((G,k)=>(0,I.jsxs)("p",{children:[(0,I.jsx)("code",{children:G.path}),(0,I.jsx)("i",{children:G.description})]},k))]}),alias:"An alias name for the variable in the dashboard. If left blank the given path will be used."}};function rl(){return{list:(0,Ye.css)({marginLeft:"20px"}),removeIcon:(0,Ye.css)({margin:"0 0 0 4px",alignItems:"center"})}}var ws=e(41119),gs=(F=>(F.JSON="json",F.KeyValues="kvp",F.Auto="auto",F.RegExp="regexp",F.Delimiter="delimiter",F))(gs||{});const ol={id:gs.JSON,name:"JSON",description:"Parse JSON string",getParser:F=>G=>JSON.parse(G)},xc={id:gs.RegExp,name:"RegExp",description:"Parse with RegExp",getParser:F=>{let G=/(?<NewField>.*)/;if((0,Ua.AP)(F.regExp))try{G=(0,Ua.dO)(F.regExp)}catch(k){k instanceof Error&&console.warn(k.message)}return k=>k.match(G)?.groups}};function Ec(F){const G=[];let k="",re="";const ue={};for(let ge=0;ge<F.length;ge++){let Pe=F[ge];Pe===k&&(k="",Pe=F[++ge]);const Ae=Pe==="\\";if(Ae&&(Pe=F[++ge]),Ae||k.length){G.push(Pe);continue}switch((Pe==='"'||Pe==="'")&&(k=Pe),Pe){case":":case"=":G.length&&(re&&(ue[re]=""),re=G.join(""),G.length=0);break;case'"':case"'":case" ":case"	":case"\r":case`
`:G.length&&re===""&&(ue[G.join("")]="",G.length=0);case",":case";":case"&":case"{":case"}":if(G.length){const We=G.join("");re.length?(ue[re]=We,re=""):re=We,G.length=0}break;default:G.push(Pe),ge===F.length-1&&re===""&&G.length&&(ue[G.join("")]="",G.length=0)}}return re.length&&(ue[re]=G.join("")),ue}const il={id:gs.KeyValues,name:"Key+value pairs",description:"Look for a=b, c: d values in the line",getParser:F=>Ec},Io={id:gs.Delimiter,name:"Split by delimiter",description:"Splits at delimited values, such as commas",getParser:({delimiter:F=","})=>{const G=new RegExp(`\\s*${(0,Ua.jD)(F)}\\s*`,"g");return k=>{const re=k.trim().split(G),ue={};for(const ge of re)ue[ge]=1;return ue}}},Pc=[ol,il,Io,xc],bc={id:gs.Auto,name:"Auto",description:"parse new fields automatically",getParser:F=>{const G=Pc.map(k=>k.getParser(F));return k=>{for(const re of G)try{const ue=re(k);if(ue!=null)return ue}catch{}}}},si=new Te.O(()=>[...Pc,bc]),Xr={id:oe.F.extractFields,name:"Extract fields",description:"Parse fields from the contends of another",defaultOptions:{delimiter:","},operator:(F,G)=>k=>k.pipe((0,oa.T)(re=>Xr.transformer(F,G)(re))),transformer:F=>G=>G.map(k=>ll(k,F))};function ll(F,G){if(!G.source)return F;const k=(0,ka.UI)(F,G.source);if(!k)return F;const re=si.getIfExists(G.format??gs.Auto);if(!re)throw new Error("unkonwn extractor");const ue=F.length,ge=[],Pe=new Map,Ae=re.getParser(G);for(let qe=0;qe<ue;qe++){let et=k.values[qe];if((0,J.isString)(et))try{et=Ae(et)}catch{et={}}if(et!=null){if(G.format===gs.JSON&&G.jsonPaths&&G.jsonPaths?.length>0){const rt={},lt=G.jsonPaths.filter(pt=>pt.path);lt.length>0&&(lt.forEach(pt=>{const ht=pt.alias&&pt.alias.length>0?pt.alias:pt.path;rt[ht]=(0,J.get)(et,pt.path)??"Not Found"}),et=rt)}for(const[rt,lt]of Object.entries(et)){let pt=Pe.get(rt);pt==null&&(pt=new Array(ue).fill(void 0),Pe.set(rt,pt),ge.push(rt)),pt[qe]=lt}}}const We=ge.map(qe=>{const et=Pe.get(qe);if(!et)throw new Error(`Could not find field with name: ${qe}`);const rt={name:qe,values:et,type:et?(0,ws.oE)(et.find(lt=>lt!=null)):ee.PU.other,config:{}};return X.$.featureToggles.extractFieldsNameDeduplication&&(rt.name=(0,se.fk)(rt,F)),rt});if(G.keepTime){const qe=(0,ka.UI)(F,"Time")||(0,ka.UI)(F,"time");qe&&We.unshift(qe)}return G.replace||We.unshift(...F.fields),{...F,fields:We}}const cl=({input:F,options:G={delimiter:","},onChange:k})=>{const re={settings:{width:30,placeholderText:(0,d.t)("transformers.extract-fields-transformer-editor.field-name-picker-settings.placeholderText.select-field","Select field")},name:"",id:"",editor:()=>null},ue=lt=>{k({...G,source:lt})},ge=lt=>{k({...G,format:lt?.value})},Pe=lt=>{k({...G,jsonPaths:lt})},Ae=lt=>{k({...G,regExp:lt.target.value})},We=lt=>{k({...G,delimiter:lt.value})},qe=()=>{G.replace&&(G.keepTime=!1),k({...G,replace:!G.replace})},et=()=>{k({...G,keepTime:!G.keepTime})},rt=si.selectOptions(G.format?[G.format]:void 0);return(0,I.jsxs)("div",{children:[(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.extract-fields-transformer-editor.label-source","Source"),labelWidth:16,children:(0,I.jsx)(ma.O,{context:{data:F},value:G.source??"",onChange:ue,item:re})})}),(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.extract-fields-transformer-editor.label-format","Format"),labelWidth:16,children:(0,I.jsx)(Se.l6,{value:rt.current[0],options:rt.options,onChange:ge,width:24,placeholder:(0,d.t)("transformers.extract-fields-transformer-editor.placeholder-auto","Auto")})})}),G.format===gs.RegExp&&(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:"RegExp",labelWidth:16,interactive:!0,tooltip:(0,d.t)("transformers.extract-fields-transformer-editor.tooltip-regexp","Example: {{regexExample}}",{regexExample:"/(?<NewField>.*)/"}),children:(0,I.jsx)(tn.p,{placeholder:"/(?<NewField>.*)/",value:G.regExp,onChange:Ae})})}),G.format===gs.JSON&&(0,I.jsx)(ai,{options:G.jsonPaths??[],onChange:Pe}),G.format===gs.Delimiter&&(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.extract-fields-transformer-editor.label-delimiter","Delimiter"),labelWidth:16,children:(0,I.jsx)(So.G,{value:G.delimiter,options:[{value:","},{value:";"},{value:"|"}],onChange:We,placeholder:(0,d.t)("transformers.extract-fields-transformer-editor.placeholder-select-delimiter","Select delimiter..."),width:24})})}),(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.extract-fields-transformer-editor.label-replace-all-fields","Replace all fields"),labelWidth:16,children:(0,I.jsx)(bt.K,{value:G.replace??!1,onChange:qe})})}),G.replace&&(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.extract-fields-transformer-editor.label-keep-time","Keep time"),labelWidth:16,children:(0,I.jsx)(bt.K,{value:G.keepTime??!1,onChange:et})})})]})},dl={id:oe.F.extractFields,editor:cl,transformation:Xr,name:Xr.name,description:"Parse fields from content (JSON, labels, etc).",categories:new Set([v.m.Reformat]),help:Ee(oe.F.extractFields).helperDocs};var ul=e(59695);const Lr={id:oe.F.joinByLabels,name:"Join by labels",description:"Flatten labeled results into a table joined by labels.",defaultOptions:{},operator:(F,G)=>k=>k.pipe((0,oa.T)(re=>Lr.transformer(F,G)(re))),transformer:F=>G=>!G||!G.length?G:[Dc(F,G)]};function Dc(F,G){if(!F.value?.length)return ri("No value label configured");const k=(0,He.aG)(G);if(k.size<1)return ri("No labels in result");if(!k.has(F.value))return ri("Value label not found");let re=F.join?.length?F.join:Array.from(k);re=re.filter(rt=>rt!==F.value);const ue=new Set,ge=new Map,Pe={};for(const rt of G)for(const lt of rt.fields)if(lt.labels&&lt.type!==ee.PU.time){const pt=re.map(vn=>lt.labels[vn]),ht=pt.join(",");let Ct=ge.get(ht);Ct||(Ct={keys:pt,values:{}},ge.set(ht,Ct));const Wt=lt.labels[F.value],en=lt.values,on=Ct.values[Wt];on?Ct.values[Wt]=on.concat(en):Ct.values[Wt]=en,Pe[Wt]||(Pe[Wt]=lt),ue.add(Wt)}const Ae=Array.from(ue),We=re.map(()=>[]),qe=Ae.map(()=>[]);for(const rt of ge.values()){let lt=-1,pt=!1;for(;!pt;){lt++,pt=!0;for(let ht=0;ht<re.length;ht++)We[ht].push(rt.keys[ht]);for(let ht=0;ht<Ae.length;ht++){const Ct=Ae[ht],Wt=rt.values[Ct]??[];qe[ht].push(Wt[lt]),Wt.length>lt+1&&(pt=!1)}}}const et={fields:[],length:qe[0].length,refId:`${oe.F.joinByLabels}-${G.map(rt=>rt.refId).join("-")}`};for(let rt=0;rt<re.length;rt++)et.fields.push({name:re[rt],config:{},type:ee.PU.string,values:We[rt]});for(let rt=0;rt<Ae.length;rt++){const lt=Pe[Ae[rt]];et.fields.push({name:Ae[rt],config:{},type:lt.type??ee.PU.number,values:qe[rt]})}return et}function ri(F){return{meta:{notices:[{severity:"error",text:F}]},fields:[{name:"Error",type:ee.PU.string,config:{},values:[F]}],length:0}}function Cc({input:F,options:G,onChange:k}){const re=(0,l.useMemo)(()=>{let We;const qe=(0,He.aG)(F),et=Array.from(qe).map(Wt=>({label:Wt,value:Wt}));let rt=et.find(Wt=>Wt.value===G.value);!rt&&G.value&&(rt={label:`${G.value} (not found)`,value:G.value},et.push(rt)),F.length?qe.size===0&&(We=(0,I.jsx)(za.F,{title:(0,d.t)("transformers.join-by-labels-transformer-editor.info.title-no-labels-found","No labels found"),children:(0,I.jsx)(d.x6,{i18nKey:"transformers.join-by-labels-transformer-editor.info.input-contain-labels",children:"The input does not contain any labels"})})):We=(0,I.jsx)(za.F,{title:(0,d.t)("transformers.join-by-labels-transformer-editor.info.title-no-input-found","No input found"),children:(0,I.jsx)(d.x6,{i18nKey:"transformers.join-by-labels-transformer-editor.info.no-input-or-labels-found",children:"No input (or labels) found"})}),qe.delete(G.value);const lt=Array.from(qe).map(Wt=>({label:Wt,value:Wt}));let pt=lt;const ht=!!G.join?.length;let Ct="Join";return ht?pt=lt.filter(Wt=>!G.join.includes(Wt.value)):Ct=lt.map(Wt=>Wt.value).join(", "),{warn:We,valueOptions:et,valueOption:rt,joinOptions:lt,addOptions:pt,addText:Ct,hasJoin:ht,key:Date.now()}},[G,F]),ue=(We,qe)=>{if(!G.join)return;const et=G.join.slice();if(qe)et[We]=qe;else if(et.splice(We,1),!et.length){k({...G,join:void 0});return}const rt=new Set(et);G.value&&rt.delete(G.value),k({...G,join:Array.from(rt)})},ge=We=>{const qe=We?.value;if(!qe)return;const et=G.join?G.join.slice():[];et.push(qe),k({...G,join:et})},Pe=10,Ae="No labels found";return(0,I.jsxs)("div",{children:[re.warn,(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{error:"required",invalid:!G.value?.length,label:(0,d.t)("transformers.join-by-labels-transformer-editor.label-value","Value"),labelWidth:Pe,tooltip:(0,d.t)("transformers.join-by-labels-transformer-editor.tooltip-select-label-indicating-values","Select the label indicating the values name"),children:(0,I.jsx)(Se.l6,{options:re.valueOptions,value:re.valueOption,onChange:We=>k({...G,value:We.value}),noOptionsMessage:Ae})})}),re.hasJoin?G.join.map((We,qe)=>(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.join-by-labels-transformer-editor.label-join","Join"),labelWidth:Pe,error:"Unable to join by the value label",invalid:We===G.value,children:(0,I.jsxs)(Ya.Gy,{children:[(0,I.jsx)(Se.l6,{options:re.joinOptions,value:re.joinOptions.find(et=>et.value===We),isClearable:!0,onChange:et=>ue(qe,et?.value),noOptionsMessage:Ae}),!!(re.addOptions.length&&qe===G.join.length-1)&&(0,I.jsx)(ul.i,{icon:"plus",label:"",options:re.addOptions,onChange:ge,variant:"secondary"})]})})},We+qe)):(0,I.jsx)(I.Fragment,{children:!!re.addOptions.length&&(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.join-by-labels-transformer-editor.label-join","Join"),labelWidth:Pe,children:(0,I.jsx)(Se.l6,{options:re.addOptions,placeholder:re.addText,onChange:ge,noOptionsMessage:Ae})})})})]})}const Zr={id:Lr.id,editor:Cc,transformation:Lr,name:Lr.name,description:Lr.description,state:Ve.pn.beta,categories:new Set([v.m.Combine]),help:Ee(Lr.id).helperDocs};var Tc=e(93139),qr=e(69862),Pr=e(65474),eo=e(46189);const hl={id:oe.F.fieldLookup,name:"Lookup fields from resource",description:"Retrieve matching data based on specified field",defaultOptions:{},operator:F=>G=>G.pipe((0,qr.Z)(k=>(0,Pr.H)(fl(k,F))))};async function fl(F,G){const k=q.sJ.get(ne.Ct.byName).get(G?.lookupField),re=await(0,eo.q3)(G?.gazetteer??eo.fx);return re.frame?Ro(F,re,k):Promise.reject("missing frame in gazetteer")}function Ro(F,G,k){const re=G.frame()?.fields;return re?F.map(ue=>{const ge=ue.length,Pe=[];for(const Ae of ue.fields)if(Pe.push(Ae),k(Ae,ue,F)){const We=Ae.values,qe=[];for(const et of re){const rt=new Array(ge);qe.push(rt),Pe.push({...et,values:rt})}for(let et=0;et<G.count;et++){const rt=G.find(We[et]);if(rt?.index!=null)for(let lt=0;lt<re.length;lt++)qe[lt][et]=re[lt].values[rt.index]}}return{...ue,fields:Pe}}):F}const Fs={settings:{}},pl=({input:F,options:G,onChange:k})=>{const re={settings:{width:30,filter:Pe=>Pe.type===ee.PU.string,placeholderText:(0,d.t)("transformers.field-lookup-transformer-editor.field-name-picker-settings.placeholderText.select-text-field","Select text field"),noFieldsMessage:(0,d.t)("transformers.field-lookup-transformer-editor.field-name-picker-settings.noFieldsMessage.no-text-fields-found","No text fields found")},name:"",id:"",editor:()=>null},ue=(0,l.useCallback)(Pe=>{k({...G,lookupField:Pe})},[k,G]),ge=(0,l.useCallback)(Pe=>{k({...G,gazetteer:Pe})},[k,G]);return(0,I.jsxs)("div",{children:[(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.field-lookup-transformer-editor.label-field","Field"),labelWidth:12,children:(0,I.jsx)(ma.O,{context:{data:F},value:G?.lookupField??"",onChange:ue,item:re})})}),(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.field-lookup-transformer-editor.label-lookup","Lookup"),labelWidth:12,children:(0,I.jsx)(Tc.G,{value:G?.gazetteer??"",context:{data:F},item:Fs,onChange:ge})})})]})},gl={id:oe.F.fieldLookup,editor:pl,transformation:hl,name:hl.name,description:"Use a field value to lookup additional fields from an external source. This currently supports spatial data, but will eventually support more formats.",state:Ve.pn.alpha,categories:new Set([v.m.PerformSpatialOperations]),help:Ee(oe.F.fieldLookup).helperDocs};var ml=e(359),Mc=e(1027);const vl=(F,G,k=[])=>(G===0?k.push(F):F.forEach(re=>{vl(re,G-1,k)}),k);function yl(F){const G=F[0].length,k=F.length,re=new Map;for(let ue=0;ue<G;ue++){let ge=re;for(let Pe=0;Pe<k;Pe++){let Ae=F[Pe][ue],We=ge.get(Ae);We==null&&(We=Pe===k-1?[]:new Map,ge.set(Ae,We)),ge=We}ge.push(ue)}return vl(re,k)}const Sc={asLabels:!0,append:!1,withNames:!1,separator1:"=",separator2:" "};function Oc(F,G,k){return G.map((re,ue)=>F.withNames?`${re}${F.separator1}${k[ue]}`:k[ue]).join(F.separator2)}function Ic(F,G){const k={};return F.forEach((re,ue)=>{k[re]=String(G[ue])}),k}const to={id:oe.F.partitionByValues,name:"Partition by values",description:"Splits a one-frame dataset into multiple series discriminated by unique/enum values in one or more fields.",defaultOptions:{keepFields:!1},operator:(F,G)=>k=>k.pipe((0,oa.T)(re=>to.transformer(F,G)(re))),transformer:(F,G)=>{const k=(0,ml.R)({names:F.fields});if(!k)return Mc.W.transformer({},G);const re=(0,q.NS)(k);return ue=>ue.length?oi(ue[0],re,F):ue}};function oi(F,G,k){const re=F.fields.filter(Ae=>G(Ae,F,[F]));if(!re.length)return[F];const ue=re.map(Ae=>Ae.values),ge=re.map(Ae=>Ae.name),Pe={...Sc,...k?.naming};return yl(ue).map(Ae=>{let We=F.name,qe={};if(Pe.asLabels)qe=Ic(ge,re.map((rt,lt)=>ue[lt][Ae[0]]));else{let rt=Oc(Pe,ge,re.map((lt,pt)=>ue[pt][Ae[0]]));Pe?.append&&F.name&&(rt=`${F.name} ${rt}`),We=rt}let et=F.fields;if(!k?.keepFields){const rt=new Set(ge);et=F.fields.filter(lt=>!rt.has(lt.name))}return{name:We,meta:F.meta,length:Ae.length,fields:et.map(rt=>{const lt=rt.values,pt=Array(Ae.length);for(let ht=0;ht<Ae.length;ht++)pt[ht]=lt[Ae[ht]];return{name:rt.name,type:rt.type,config:rt.config,labels:{...rt.labels,...qe},values:pt}})}})}function ii({input:F,options:G,onChange:k}){const re=(0,bo.sE)(F),ue=(0,bo.m3)(re),ge=(0,l.useMemo)(()=>{const lt=new Set(G.fields);return lt.size<1?ue:ue.filter(pt=>!lt.has(pt.value))},[ue,G]),Pe=(0,l.useCallback)(lt=>{if(!lt.value)return;const pt=new Set(G.fields);pt.add(lt.value),k({...G,fields:[...pt]})},[k,G]);let Ae;(lt=>{lt[lt.asLabels=0]="asLabels",lt[lt.frameName=1]="frameName"})(Ae||(Ae={}));const We=[{label:(0,d.t)("transformers.partition-by-values-editor.naming-modes-options.label.as-label","As label"),value:0},{label:(0,d.t)("transformers.partition-by-values-editor.naming-modes-options.label.as-frame-name","As frame name"),value:1}],qe=[{label:(0,d.t)("transformers.partition-by-values-editor.keep-fields-options.label.yes","Yes"),value:!0},{label:(0,d.t)("transformers.partition-by-values-editor.keep-fields-options.label.no","No"),value:!1}],et=(0,l.useCallback)(lt=>{if(!lt)return;const pt=new Set(G.fields);pt.delete(lt),k({...G,fields:[...pt]})},[k,G]);if(F.length>1)return(0,I.jsx)(Ns.P,{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.partition-by-values-editor.partition-values-works-single-frame",children:"Partition by values only works with a single frame."})});const rt=[...new Set(G.fields)];return(0,I.jsxs)("div",{children:[(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.partition-by-values-editor.label-field","Field"),labelWidth:10,grow:!0,children:(0,I.jsxs)(Ya.Gy,{children:[rt.map(lt=>(0,I.jsx)(ve.$n,{icon:"times",variant:"secondary",size:"md",onClick:()=>et(lt),children:lt},lt)),ge.length&&(0,I.jsx)(ul.i,{variant:"secondary",size:"md",options:ge,onChange:Pe,label:(0,d.t)("transformers.partition-by-values-editor.label-select-field","Select field"),icon:"plus"})]})})}),(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{tooltip:(0,d.t)("transformers.partion-by-values-editor.tooltip-naming","Sets how the names of the selected fields are displayed. As frame name is usually better for tabular data"),label:(0,d.t)("transformers.partition-by-values-editor.label-naming","Naming"),labelWidth:10,children:(0,I.jsx)(ce.z,{options:We,value:G.naming?.asLabels===void 0||G.naming.asLabels?0:1,onChange:lt=>k({...G,naming:{...G.naming,asLabels:lt===0}})})})}),(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{tooltip:(0,d.t)("transformers.partition-by-values-editor.tooltip-keeps-partition-fields-frames","Keeps the partition fields in the frames"),label:(0,d.t)("transformers.partition-by-values-editor.label-keep-fields","Keep fields"),labelWidth:16,children:(0,I.jsx)(ce.z,{options:qe,value:G.keepFields,onChange:lt=>k({...G,keepFields:lt})})})})]})}const no={id:oe.F.partitionByValues,editor:ii,transformation:to,name:to.name,description:to.description,state:Ve.pn.alpha,categories:new Set([v.m.Reformat]),help:Ee(oe.F.partitionByValues).helperDocs};var Vs=e(39443),xl=e(18700),Mn=e(8721),na=(F=>(F.TimeSeriesWide="wide",F.TimeSeriesLong="long",F.TimeSeriesMulti="multi",F.TimeSeriesMany="many",F))(na||{});function li(F){if(!Array.isArray(F)||F.length===0)return F;const G=[];for(const k of ci(F)){const re=k.fields[0];if(!re||re.type!==ee.PU.time)continue;const ue=[],ge=[];for(const Pe of k.fields)switch(Pe.type){case ee.PU.number:case ee.PU.boolean:ue.push(Pe);break;case ee.PU.string:ge.push(Pe);break}for(const Pe of ue)if(ge.length){const Ae=new Map;for(let We=0;We<k.length;We++){const qe=re.values[We],et=Pe.values[We];if(et===void 0||qe==null)continue;const rt=ge.map(pt=>pt.values[We]).join("/");let lt=Ae.get(rt);if(!lt){lt={key:rt,time:[],value:[],labels:{}};for(const pt of ge)lt.labels[pt.name]=pt.values[We];Ae.set(rt,lt)}lt.time.push(qe),lt.value.push(et)}for(const We of Ae.values())G.push({name:k.name,refId:k.refId,meta:{...k.meta,type:Vs.m.TimeSeriesMulti},fields:[{...re,values:We.time},{...Pe,values:We.value,labels:We.labels}],length:We.time.length})}else G.push({name:k.name,refId:k.refId,meta:{...k.meta,type:Vs.m.TimeSeriesMulti},fields:[re,Pe],length:k.length})}return G}function ci(F){if(!Array.isArray(F)||F.length===0)return F;const G=[];for(const k of F){let re;const ue=[],ge={},Pe={},Ae={},We={};for(let ht=0;ht<k.fields.length;ht++){const Ct=k.fields[ht];switch(Ct.type){case ee.PU.string:case ee.PU.boolean:Ct.name in We||(We[Ct.name]=ht,Pe[Ct.name]=!0);break;case ee.PU.time:if(!re){re=Ct;break}default:if(Ct.name in ge){const on=ge[Ct.name];if(Ct.type!==on)continue}else ge[Ct.name]=Ct.type,ue.push(Ct.name);const Wt=JSON.stringify(Ct.labels),en=Ae[Wt];if(en!==void 0?en.push(ht):Ae[Wt]=[ht],Ct.labels!=null)for(const on in Ct.labels)Pe[on]=!0}}if(!re)continue;const qe=[],et=[],rt=[],lt=[];for(let ht=0;ht<k.length;ht++)qe.push({time:re.values[ht],wideRowIndex:ht});for(const ht in Ae)et.push(ht);for(const ht in Pe)rt.push(ht);for(const ht in We)lt.push(ht);qe.sort((ht,Ct)=>ht.time-Ct.time),et.sort(),rt.sort(),ue.sort();const pt=new xl.k({...k,meta:{...k.meta,type:Vs.m.TimeSeriesLong},fields:[{name:re.name,type:re.type}]});for(const ht of ue)pt.addField({name:ht,type:ge[ht]});for(const ht of rt)pt.addField({name:ht,type:ee.PU.string});for(const ht of qe){const{time:Ct,wideRowIndex:Wt}=ht;for(const en of et){const on={};for(const an of lt)on[an]=k.fields[We[an]].values[Wt];let vn=0;for(const an of Ae[en]){const gn=k.fields[an];if(vn++===0&&gn.labels!=null)for(const $n in gn.labels)on[$n]=gn.labels[$n];on[gn.name]=gn.values[Wt]}on[re.name]=Ct,pt.add(on)}}G.push(pt)}return G}function El(F){return oi(F,k=>k.type===ee.PU.string).map(k=>(k.meta||(k.meta={}),k.meta.type=Vs.m.TimeSeriesMulti,k))}const Br={id:oe.F.prepareTimeSeries,name:"Prepare time series",description:"Will stretch data frames from the wide format into the long format. This is really helpful to be able to keep backwards compatibility for panels not supporting the new wide format.",defaultOptions:{},operator:(F,G)=>k=>k.pipe((0,oa.T)(re=>Br.transformer(F,G)(re))),transformer:F=>{const G=F?.format??"wide";if(G==="many"||G==="multi")return li;if(G==="long")return ci;const k=q.sJ.get(ne.Ct.firstTimeField).get({});return re=>{if(!re.length)return[];const ue=[];for(const Pe of re)Pe.meta?.type===Vs.m.TimeSeriesLong?El(Pe).forEach(Ae=>ue.push(Ae)):ue.push(Pe);const ge=(0,Mn.Fd)({frames:ue,joinBy:k,keepOriginIndices:!0});return ge?(ge.meta||(ge.meta={}),ge.meta.type=Vs.m.TimeSeriesWide,[ge]):[]}}},Pl={label:"Wide time series",value:na.TimeSeriesWide,description:"Creates a single frame joined by time",info:(0,I.jsxs)("ul",{children:[(0,I.jsx)("li",{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.wide-info.single-frame",children:"Single frame"})}),(0,I.jsx)("li",{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.wide-info.st-field-is-shared-time",children:"1st field is shared time field"})}),(0,I.jsx)("li",{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.wide-info.time-in-ascending-order",children:"Time in ascending order"})}),(0,I.jsx)("li",{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.wide-info.multiple-value-fields-of-any-type",children:"Multiple value fields of any type"})})]})},di={label:"Multi-frame time series",value:na.TimeSeriesMulti,description:"Creates a new frame for each time/number pair",info:(0,I.jsxs)("ul",{children:[(0,I.jsx)("li",{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.multi-info.multiple-frames",children:"Multiple frames"})}),(0,I.jsx)("li",{children:(0,I.jsxs)(d.x6,{i18nKey:"transformers.multi-info.frame-fields-value",values:{field1:"time",field2:"value"},children:["Each frame has two fields: ","{{field1}}",", ","{{field2}}"]})}),(0,I.jsx)("li",{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.multi-info.time-in-ascending-order",children:"Time in ascending order"})}),(0,I.jsx)("li",{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.multi-info.string-values-are-represented-as-labels",children:"String values are represented as labels"})}),(0,I.jsx)("li",{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.multi-info.all-values-are-numeric",children:"All values are numeric"})})]})},Rc={label:"Long time series",value:na.TimeSeriesLong,description:"Convert each frame to long format",info:(0,I.jsxs)("ul",{children:[(0,I.jsx)("li",{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.long-info.single-frame",children:"Single frame"})}),(0,I.jsx)("li",{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.long-info.st-field-is-time",children:"1st field is time field"})}),(0,I.jsx)("li",{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.long-info.ascending-order-duplicates",children:"Time in ascending order, but may have duplicates"})}),(0,I.jsx)("li",{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.long-info.string-values-separate",children:"String values are represented as separate fields rather than as labels"})}),(0,I.jsx)("li",{children:(0,I.jsx)(d.x6,{i18nKey:"transformers.long-info.multiple-value-fields-may-exist",children:"Multiple value fields may exist"})})]})},Ur=[Pl,di,Rc];function Vd(F){const{options:G,onChange:k}=F,re=(0,mt.of)(Wa),ue=(0,l.useCallback)(ge=>{k({...G,format:ge.value})},[k,G]);return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.prepare-time-series-editor.label-format","Format"),labelWidth:12,children:(0,I.jsx)(Se.l6,{width:35,options:Ur,value:Ur.find(ge=>ge.value===na.TimeSeriesMulti&&G.format===na.TimeSeriesMany?!0:ge.value===G.format)||Ur[0],onChange:ue,className:"flex-grow-1"})})}),(0,I.jsx)(Oe.C,{children:(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.prepare-time-series-editor.label-info","Info"),labelWidth:12,children:(0,I.jsx)("div",{className:re.info,children:(Ur.find(ge=>ge.value===G.format)||Ur[0]).info})})})]})}const Wa=F=>({info:(0,Ye.css)({marginLeft:"20px"})}),bl={id:Br.id,editor:Vd,transformation:Br,name:Br.name,description:Br.description,categories:new Set([v.m.Reformat]),help:Ee(Br.id).helperDocs};var Ac=e(66648),jc=e(48817),Wr=(F=>(F.linear="linear",F.polynomial="polynomial",F))(Wr||{});const $s={predictionCount:100,modelType:"linear",degree:2},Dl=[{label:()=>(0,d.t)("transformers.regression-transformer-editor.label.quadratic","Quadratic"),value:2},{label:()=>(0,d.t)("transformers.regression-transformer-editor.label.cubic","Cubic"),value:3},{label:()=>(0,d.t)("transformers.regression-transformer-editor.label.quartic","Quartic"),value:4},{label:()=>(0,d.t)("transformers.regression-transformer-editor.label.quintic","Quintic"),value:5}],Ao={id:oe.F.regression,name:"Regression analysis",description:"Create a new data frame containing values predicted by a statistical model.",operator:(F,G)=>k=>k.pipe((0,oa.T)(re=>Ao.transformer(F,G)(re))),transformer:(F,G)=>k=>{const{predictionCount:re,modelType:ue,degree:ge}={...$s,...F};if(k.length===0)return k;const Pe=q.sJ.get(ne.Ct.byName).get(F.yFieldName),Ae=q.sJ.get(ne.Ct.byName).get(F.xFieldName);let We,qe,et;for(const gn of k){const $n=gn.fields.find(Ea=>Pe(Ea,gn,k));if($n){qe=$n;const Ea=gn.fields.find(Rr=>Ae(Rr,gn,k));if(Ea){We=Ea,et=gn;break}else throw"X and Y fields must be part of the same frame"}}if(!We||!qe)return k;let rt=We.values[0],lt=We.values[0];for(let gn=1;gn<We.values.length;gn++)We.values[gn]<rt&&(rt=We.values[gn]),We.values[gn]>lt&&(lt=We.values[gn]);const pt=(lt-rt)/(re-1),ht=[...[...Array(re-1).keys()].map((gn,$n)=>$n*pt+rt),lt],Ct=We.type===ee.PU.time?rt:0,Wt=[],en=[];for(let gn=0;gn<We.values.length;gn++)qe.values[gn]!==null&&!isNaN(qe.values[gn])&&(en.push(We.values[gn]-Ct),Wt.push(qe.values[gn]));let on;switch(ue){case"linear":on=new jc.X(en,Wt);break;case"polynomial":on=new Ac.Y(en,Wt,ge);break;default:return k}let vn=`${(0,d.t)("transformers.regression-transformer-editor.model-type-options.label.linear","Linear")} ${(0,d.t)("transformers.regression-transformer-editor.regression","regression")}`;ue==="polynomial"&&(vn=`${Dl.find($n=>$n.value===ge)?.label()} ${(0,d.t)("transformers.regression-transformer-editor.model-type-options.label.polynomial","Polynomial").toLocaleLowerCase()} ${(0,d.t)("transformers.regression-transformer-editor.regression","regression")}`);const an={name:`${vn}`,length:ht.length,fields:[{name:We.name,type:We.type,values:ht,config:{}},{name:`${(0,se.Ct)(qe,et,k)} predicted`,type:qe.type,values:ht.map(gn=>on.predict(gn-Ct)),config:{}}]};return[...k,an]}},Cl={editor:ma.O,id:"",name:"",settings:{width:24,isClearable:!1}},ao=20,ui=({input:F,options:G,onChange:k})=>{const re=[{label:(0,d.t)("transformers.regression-transformer-editor.model-type-options.label.linear","Linear"),value:Wr.linear},{label:(0,d.t)("transformers.regression-transformer-editor.model-type-options.label.polynomial","Polynomial"),value:Wr.polynomial}];return(0,l.useEffect)(()=>{let ue,ge;if(!G.xFieldName){const Pe=q.sJ.get(ne.Ct.firstTimeField).get({});for(const Ae of F)if(ue=Ae.fields.find(We=>Pe(We,Ae,F)),ue)break;if(!ue){const Ae=q.sJ.get(ne.Ct.numeric).get({});for(const We of F)if(ue=We.fields.find(qe=>Ae(qe,We,F)),ue)break}}if(!G.yFieldName){const Pe=q.sJ.get(ne.Ct.numeric).get({});for(const Ae of F)if(ge=Ae.fields.find(We=>Pe(We,Ae,F)&&We!==ue),ge)break}ue&&ge&&k({...G,xFieldName:ue.name,yFieldName:ge.name})}),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(ae.I,{labelWidth:ao,label:(0,d.t)("transformers.regression-transformer-editor.label-x-field","X field"),children:(0,I.jsx)(ma.O,{context:{data:F},value:G.xFieldName??"",item:Cl,onChange:ue=>{k({...G,xFieldName:ue})}})}),(0,I.jsx)(ae.I,{labelWidth:ao,label:(0,d.t)("transformers.regression-transformer-editor.label-y-field","Y field"),children:(0,I.jsx)(ma.O,{context:{data:F},value:G.yFieldName??"",item:Cl,onChange:ue=>{k({...G,yFieldName:ue})}})}),(0,I.jsx)(ae.I,{labelWidth:ao,label:(0,d.t)("transformers.regression-transformer-editor.label-model-type","Model type"),children:(0,I.jsx)(Se.l6,{value:G.modelType??$s.modelType,onChange:ue=>{k({...G,modelType:ue.value??$s.modelType})},options:re})}),(0,I.jsx)(ae.I,{labelWidth:ao,label:(0,d.t)("transformers.regression-transformer-editor.label-predicted-points","Predicted points"),tooltip:(0,d.t)("transformers.regression-transformer-editor.tooltip-number-of-xy-points-to-predict","Number of X,Y points to predict"),children:(0,I.jsx)(It.Q,{value:G.predictionCount??$s.predictionCount,onChange:ue=>{k({...G,predictionCount:ue})}})}),G.modelType===Wr.polynomial&&(0,I.jsx)(ae.I,{labelWidth:ao,label:(0,d.t)("transformers.regression-transformer-editor.label-degree","Degree"),children:(0,I.jsx)(Se.l6,{value:G.degree??$s.degree,options:Dl.map(ue=>({label:ue.label(),value:ue.value})),onChange:ue=>{k({...G,degree:ue.value})}})})]})},Tl={id:oe.F.regression,editor:ui,transformation:Ao,name:Ao.name,description:Ao.description,categories:new Set([v.m.CalculateNewFields]),help:Ee(oe.F.regression).helperDocs},so={id:oe.F.rowsToFields,name:"Rows to fields",description:"Convert each row into a field with dynamic config.",defaultOptions:{},operator:F=>G=>G.pipe((0,oa.T)(k=>k.map(re=>Lc(F,re))))};function Lc(F,G){const k=_t(G,F.mappings??[],!0),{nameField:re,valueField:ue}=k;if(!re||!ue)return G;const ge=[];for(let Pe=0;Pe<re.values.length;Pe++){const Ae=re.values[Pe],We=ue.values[Pe],qe=wn(G,Pe,k),et=zs(G,Pe,k),rt={name:`${Ae}`,type:ue.type,values:[We],config:qe,labels:et};ge.push(rt)}return{fields:ge,length:1,refId:`${oe.F.rowsToFields}-${G.refId}`}}function zs(F,G,k){const re={...k.nameField.labels};for(let ue=0;ue<F.fields.length;ue++){const ge=F.fields[ue],Pe=(0,se.Ct)(ge,F),Ae=k.index[Pe];if(Ae.handler&&Ae.handler.key!==jn.Label)continue;const We=ge.values[G];We!=null&&(re[Pe]=We)}return re}function Ml({input:F,options:G,onChange:k}){return F.length===0?null:(0,I.jsx)("div",{children:(0,I.jsx)(ia,{frame:F[0],mappings:G.mappings??[],onChange:re=>k({...G,mappings:re}),withNameAndValue:!0})})}const Bc={id:so.id,editor:Ml,transformation:so,name:so.name,description:so.description,state:Ve.pn.beta,categories:new Set([v.m.Reformat]),help:Ee(so.id).helperDocs};var Sl=e(739),ro=e(90267),_a=e(90176),hi=e(98643),_s=e(87039),oo=e(78089);const jo={id:oe.F.spatial,name:"Spatial operations",description:"Apply spatial operations to query results.",defaultOptions:{},operator:F=>G=>G.pipe((0,qr.Z)(k=>(0,Pr.H)(Uc(k,F))))};function Ol(F){return F.action===_a.dy.Modify&&F.modify?.op===_a.YD.LineBuilder}async function Uc(F,G){const k=await(0,_s.nE)(G.source);if(Ol(G)){const re=await(0,_s.nE)(G.modify?.target);return F.map(ue=>{const ge=(0,_s.FM)(ue,k),Pe=(0,_s.FM)(ue,re);if(ge.field&&Pe.field){const Ae=[...ue.fields],We=(0,hi.XR)(ge.field,Pe.field),qe=Ae[0];return qe.type===ee.PU.geo&&qe!==ge.field&&qe!==Pe.field?Ae[0]=(0,hi.RA)(qe,We):Ae.unshift(We),{...ue,fields:Ae}}return ue})}return F.map(re=>{let ue=(0,_s.FM)(re,k);if(ue.field){if(G.action===_a.dy.Modify){switch(G.modify?.op){case _a.YD.AsLine:let Pe=ue.field.name;return(!Pe||Pe==="Point")&&(Pe="Line"),{...re,length:1,fields:[{...ue.field,name:Pe,type:ee.PU.geo,values:[(0,oo.tt)(ue.field)]}]}}return re}const ge=ue.derived?[ue.field,...re.fields]:re.fields.slice(0);if(G.action===_a.dy.Calculate&&(ge.push((0,oo.pp)(ue.field,G.calculate??{})),ue.derived=!0),ue.derived)return{...re,fields:ge}}return re})}const fi=(F,G)=>{const k=G.options??{};F.addSelect({path:"action",name:"Action",description:"",defaultValue:_a.dy.Prepare,settings:{options:[{value:_a.dy.Prepare,label:(0,d.t)("transformers.supplier.label.prepare-spatial-field","Prepare spatial field"),description:"Set a geometry field based on the results of other fields"},{value:_a.dy.Calculate,label:(0,d.t)("transformers.supplier.label.calculate-value","Calculate value"),description:(0,d.t)("transformers.supplier.description.geometry-define-field-headingdistancearea","Use the geometry to define a new field (heading/distance/area)")},{value:_a.dy.Modify,label:(0,d.t)("transformers.supplier.label.transform","Transform"),description:(0,d.t)("transformers.supplier.description.apply-spatial-operations-to-the-geometry","Apply spatial operations to the geometry")}]}}),k.action===_a.dy.Calculate?F.addSelect({path:"calculate.calc",name:"Function",description:"",defaultValue:_a.kD.Heading,settings:{options:[{value:_a.kD.Heading,label:(0,d.t)("transformers.supplier.label.heading","Heading")},{value:_a.kD.Area,label:(0,d.t)("transformers.supplier.label.area","Area")},{value:_a.kD.Distance,label:(0,d.t)("transformers.supplier.label.distance","Distance")}]}}):k.action===_a.dy.Modify&&F.addSelect({path:"modify.op",name:"Operation",description:"",defaultValue:_a.YD.AsLine,settings:{options:[{value:_a.YD.AsLine,label:(0,d.t)("transformers.supplier.label.as-line","As line"),description:"Create a single line feature with a vertex at each row"},{value:_a.YD.LineBuilder,label:(0,d.t)("transformers.supplier.label.line-builder","Line builder"),description:(0,d.t)("transformers.supplier.description.create-a-line-between-two-points","Create a line between two points")}]}}),Ol(k)?(F.addNestedOptions({category:["Source"],path:"source",build:(re,ue)=>{const ge=k.source??{mode:Sl.aG.Auto};(0,ro.G)("Point","",re,ge)}}),F.addNestedOptions({category:["Target"],path:"modify",build:(re,ue)=>{const ge=k.modify?.target??{mode:Sl.aG.Auto};(0,ro.G)("Point","target.",re,ge)}})):(0,ro.G)("Location","source.",F,k.source)},Wc=F=>{(0,l.useEffect)(()=>{if(!F.options.source?.mode){const re=ct(fi);F.onChange({...re,...F.options}),console.log("geometry useEffect",re)}},[]);const G=Lo((0,mt.$j)()),k=at(F,fi);return(0,I.jsxs)("div",{children:[(0,I.jsx)("div",{children:k.items.map(re=>re.render())}),(0,I.jsx)("div",{children:k.categories.map(re=>(0,I.jsxs)("div",{className:G.wrap,children:[(0,I.jsx)("h5",{children:re.props.title}),(0,I.jsx)("div",{className:G.item,children:re.items.map(ue=>ue.render())})]},re.props.id))})]})},Lo=F=>({wrap:(0,Ye.css)({marginBottom:"20px"}),item:(0,Ye.css)({borderLeft:`4px solid ${F.colors.border.strong}`,paddingLeft:"10px"})}),Il={id:oe.F.spatial,editor:Wc,transformation:jo,name:jo.name,description:jo.description,state:Ve.pn.alpha,categories:new Set([v.m.PerformSpatialOperations]),help:Ee(oe.F.spatial).helperDocs};var Bo=e(17503);const Nr={id:oe.F.timeSeriesTable,name:"Time series to table",description:"Convert time series data to table rows so that they can be viewed in tabular or sparkline format.",defaultOptions:{},isApplicable:F=>{for(const G of F)if((0,Bo.aH)(G))return qs.M.Applicable;return qs.M.NotApplicable},isApplicableDescription:"The Time series to table transformation requires at least one time series frame to function. You currently have none.",operator:F=>G=>G.pipe((0,oa.T)(k=>Nc(F,k)))};function Nc(F,G){const k={},re={},ue=[];let ge=Rl(G);for(const Pe of Object.keys(ge)){const Ae=G.filter(qe=>qe.refId===Pe);k[Pe]={},re[Pe]={};const We=[];Ae.forEach(qe=>{qe.fields.forEach(et=>{et.type===ee.PU.number&&et.labels&&Object.keys(et.labels).forEach(rt=>{We.includes(rt)||(re[Pe][rt]=Uo(rt,ee.PU.string),We.push(rt))})})});for(let qe=0;qe<Ae.length;qe++){const et=Ae[qe];let rt=null,lt=F[Pe]?.timeField;if(lt&&lt.length>0?rt=et.fields.find(pt=>pt.name===lt):rt=et.fields.find(pt=>(0,Bo.hF)(pt)),!(0,Bo.aH)(et)){ue.push(et);continue}for(const pt of et.fields){if(pt.type!==ee.PU.number)continue;const ht=F[Pe]?.stat??Jt.gy.lastNotNull,Ct=(0,Jt.Nw)({field:pt,reducers:[ht]})[ht]??null,Wt=new xl.k;rt!==void 0&&(Wt.addField(rt),Wt.addField(pt),k[Pe][`Trend #${Pe}`]===void 0&&(k[Pe][`Trend #${Pe}`]=Uo(`Trend #${Pe}`,ee.PU.frame)),k[Pe][`Trend #${Pe}`].values.push({...Wt,value:Ct,length:pt.values.length})),We.forEach(en=>{re[Pe][en].values.push(pt.labels?.[en]??"")})}}}for(const Pe of Object.keys(ge)){const Ae={},We=new xl.k;We.refId=Pe;const qe=re[Pe];if(qe!==void 0)for(const[rt,lt]of Object.entries(qe))Ae[rt]===void 0&&(Ae[rt]=lt);for(const rt of Object.values(Ae))We.addField(rt);const et=k[Pe];for(const rt of Object.values(et))We.addField(rt);We.fields.length>0&&ue.push(We)}return ue}function Uo(F,G){return{name:F,type:G,config:{},values:[]}}function Rl(F){let G={};for(const k of F)k.refId!==void 0&&(G[k.refId]===void 0?G[k.refId]=1:G[k.refId]++);return G}function pi({input:F,options:G,onChange:k}){const re=Rl(F),ue=(0,l.useCallback)((Ae,We)=>{const qe=We?.value!==void 0?We.value:"";k({...G,[Ae]:{...G[Ae],timeField:qe}})},[k,G]),ge=(0,l.useCallback)((Ae,We)=>{const qe=We[0];qe&&(0,Jt.Em)(qe)&&k({...G,[Ae]:{...G[Ae],stat:qe}})},[k,G]);let Pe=[];for(const Ae of Object.keys(re)){const We={},qe=[];for(const et of F)if(et.refId===Ae)for(const rt of et.fields)(0,Bo.hF)(rt)&&(We[rt.name]=rt);for(const et of Object.values(We)){const{name:rt}=et;qe.push({label:rt,value:rt})}Pe.push((0,I.jsxs)(Oe.C,{children:[(0,I.jsx)(ae.I,{children:(0,I.jsx)(Fe.c,{children:`Trend #${Ae}`})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.time-series-table-transform-editor.label-time-field","Time field"),tooltip:(0,d.t)("transformers.time-series-table-transform-editor.tooltip-time-field","The time field that will be used for the time series. If not selected the first found will be used."),children:(0,I.jsx)(Se.l6,{onChange:ue.bind(null,Ae),options:qe,value:G[Ae]?.timeField,isClearable:!0})}),(0,I.jsx)(ae.I,{label:(0,d.t)("transformers.time-series-table-transform-editor.label-stat","Stat"),tooltip:(0,d.t)("transformers.time-series-table-transform-editor.tooltip-statistic-should-calculated-series","The statistic that should be calculated for this time series."),children:(0,I.jsx)(Xt.S,{stats:[G[Ae]?.stat??Jt.gy.lastNotNull],onChange:ge.bind(null,Ae),filterOptions:et=>et.id!==Jt.gy.allValues&&et.id!==Jt.gy.uniqueValues})})]},Ae))}return(0,I.jsx)(I.Fragment,{children:Pe})}const Al={id:Nr.id,editor:pi,transformation:Nr,name:Nr.name,description:Nr.description,state:Ve.pn.beta,help:Ee(Nr.id).helperDocs},Kc=()=>[nl,ts,ti,Zs,De,qo,ko,To,aa,Wn,gc,lr,jr,mc,qi,Bc,Xn,bl,_i,Il,gl,dl,Dt,Po,Yo,Zr,Tl,no,...X.$.featureToggles.formatString?[Hi]:[],...X.$.featureToggles.groupToNestedTableTransformation?[Xi]:[],fc,Al,ni];var wc=e(26305),Ra=e(1503),Fc=e(35254),hr=e(71468),Pa=e(54148),ja=e(27489),jl=e(72296),gi=e(36303),Vc=e(15245),La=e(28105),br=e(13791),Ll=e(45776),Bl=e(21234);function Os({navId:F,header:G}){const{node:k}=(0,Ll.C)(F),re=(0,mt.of)($c),ue=k.children?.filter(ge=>!ge.hideFromTabs);return(0,I.jsx)(br.Y,{navId:k.id,children:(0,I.jsx)(br.Y.Contents,{children:(0,I.jsxs)("div",{className:re.content,children:[G,ue&&ue.length>0&&(0,I.jsx)("section",{className:re.grid,children:ue?.map(ge=>(0,I.jsx)(Bl.I,{description:ge.subTitle,text:ge.text,url:ge.url??""},ge.id))})]})})})}const $c=F=>({content:(0,Ye.css)({display:"flex",flexDirection:"column",gap:F.spacing(2)}),grid:(0,Ye.css)({display:"grid",gap:F.spacing(3),gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gridAutoRows:"138px",padding:F.spacing(2,0)})});var zc=e(86678),Gn=e(15130),er=e(49785),_c=e(62061),Gs=e(73427),yn=e(11257),io=e(96221),lo=e(74267),Kr=e(45967),fr=e(27594);const Ul=({ldapConnectionInfo:F})=>{const G=(0,l.useMemo)(()=>[{id:"host",header:"Host",disableGrow:!0},{id:"port",header:"Port",disableGrow:!0},{id:"available",cell:re=>re.cell.value?(0,I.jsx)(kt.B,{justifyContent:"end",children:(0,I.jsx)(Kr.m,{content:(0,d.t)("admin.ldap-connection-status.columns.content-connection-is-available","Connection is available"),children:(0,I.jsx)(_n.I,{name:"check"})})}):(0,I.jsx)(kt.B,{justifyContent:"end",children:(0,I.jsx)(Kr.m,{content:(0,d.t)("admin.ldap-connection-status.columns.content-connection-is-not-available","Connection is not available"),children:(0,I.jsx)(_n.I,{name:"exclamation-triangle"})})})}],[]),k=(0,l.useMemo)(()=>F,[F]);return(0,I.jsx)("section",{children:(0,I.jsxs)(kt.B,{direction:"column",gap:2,children:[(0,I.jsx)(Ta.E,{color:"primary",element:"h3",children:(0,I.jsx)(d.x6,{i18nKey:"admin.ldap-status.title",children:"LDAP Connection"})}),(0,I.jsx)(fr.j,{data:k,columns:G,getRowId:re=>re.host+re.port}),(0,I.jsx)(mi,{ldapConnectionInfo:F})]})})},mi=({ldapConnectionInfo:F})=>{if(!F.some(ue=>ue.error))return null;const k=[];F.forEach(ue=>{ue.error&&k.push(ue)});const re=k.map((ue,ge)=>(0,I.jsxs)("div",{children:[(0,I.jsxs)("span",{style:{fontWeight:500},children:[`${ue.host}:${ue.port}`,(0,I.jsx)("br",{})]}),(0,I.jsx)("span",{children:ue.error}),ge!==k.length-1&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("br",{}),(0,I.jsx)("br",{})]})]},ge));return(0,I.jsx)(za.F,{title:(0,d.t)("admin.ldap-error-box.title-connection-error","Connection error"),severity:io.Qd.Error,children:re})};var Wl=e(80011);const Gc="dddd YYYY-MM-DD HH:mm zz",Nl=({ldapSyncInfo:F})=>{const G=(0,Wl.LE)(F.nextSync,{format:Gc}),k=[{id:"syncAttribute"},{id:"syncValue"}],re=[{syncAttribute:"Active synchronization",syncValue:F.enabled?"Enabled":"Disabled"},{syncAttribute:"Scheduled",syncValue:F.schedule},{syncAttribute:"Next synchronization",syncValue:G}];return(0,I.jsxs)("section",{children:[(0,I.jsx)(Ta.E,{element:"h3",children:(0,I.jsx)(d.x6,{i18nKey:"admin.ldap-sync-info.title",children:"LDAP Synchronization"})}),(0,I.jsx)(fr.j,{data:re,columns:k,getRowId:ue=>ue.syncAttribute})]})},Kl=({groups:F})=>{const G=(0,l.useMemo)(()=>F,[F]),k=(0,l.useMemo)(()=>[{id:"groupDN",header:"LDAP Group"},{id:"orgName",header:"Organization",cell:re=>re.value&&re.row.original.orgRole?re.value:""},{id:"orgRole",header:"Role",cell:re=>re.value||(0,I.jsxs)(kt.B,{alignItems:"center",wrap:!0,children:[(0,I.jsx)(d.x6,{i18nKey:"admin.ldap-user-groups.no-org-found",children:"No match"}),(0,I.jsx)(Kr.m,{content:(0,d.t)("admin.ldap-user-groups.columns.content-no-matching-organizations-found","No matching organizations found"),children:(0,I.jsx)(_n.I,{name:"info-circle"})})]})}],[]);return(0,I.jsx)(fr.j,{headerTooltips:{orgName:{content:"Only the first match for an Organization will be used",iconName:"info-circle"}},columns:k,data:G,getRowId:re=>re.orgId+re.orgRole+re.groupDN})},wl=({info:F})=>{const G=(0,l.useMemo)(()=>[{id:"userInfo",header:"User Information",disableGrow:!0},{id:"ldapValue"},{id:"cfgAttrValue",header:"LDAP attribute"}],[]),k=(0,l.useMemo)(()=>[{userInfo:"First name",ldapValue:F.name.ldapValue,cfgAttrValue:F.name.cfgAttrValue},{userInfo:"Surname",ldapValue:F.surname.ldapValue,cfgAttrValue:F.surname.cfgAttrValue},{userInfo:"Username",ldapValue:F.login.ldapValue,cfgAttrValue:F.login.cfgAttrValue},{userInfo:"Email",ldapValue:F.email.ldapValue,cfgAttrValue:F.email.cfgAttrValue}],[F]);return(0,I.jsx)(fr.j,{columns:G,data:k,getRowId:re=>re.userInfo})},Hc=({permissions:F})=>{const G=(0,l.useMemo)(()=>[{id:"permission",header:"Permissions",disableGrow:!0},{id:"value"}],[]),k=(0,l.useMemo)(()=>[{permission:"Grafana admin",value:F.isGrafanaAdmin?(0,I.jsxs)(d.x6,{i18nKey:"admin.ldap-permissions.admin",children:[(0,I.jsx)(_n.I,{name:"shield"})," Yes"]}):"No"},{permission:"Status",value:F.isDisabled?(0,I.jsxs)(d.x6,{i18nKey:"admin.ldap-permissions.inactive",children:[(0,I.jsx)(_n.I,{name:"times"})," Inactive"]}):(0,I.jsxs)(d.x6,{i18nKey:"admin.ldap-permissions.active",children:[(0,I.jsx)(_n.I,{name:"check"})," Active"]})}],[F]);return(0,I.jsx)(fr.j,{data:k,columns:G,getRowId:re=>re.permission})},vi=({teams:F})=>{const G=(0,l.useMemo)(()=>[{id:"groupDN",header:"LDAP Group"},{id:"orgName",header:"Organization",cell:({row:{original:{orgName:k}}})=>(0,I.jsx)(I.Fragment,{children:k||"No matching teams found"})},{id:"teamName",header:"Team",cell:({row:{original:{teamName:k,orgName:re}}})=>k&&re?k:""}],[]);return(0,I.jsx)(fr.j,{data:F,columns:G,getRowId:k=>k.teamName})},Qc=({ldapUser:F})=>(0,I.jsxs)(kt.B,{direction:"column",gap:4,children:[(0,I.jsx)(wl,{info:F.info}),(0,I.jsx)(Hc,{permissions:F.permissions}),F.roles&&F.roles.length>0&&(0,I.jsx)(Kl,{groups:F.roles}),F.teams&&F.teams.length>0?(0,I.jsx)(vi,{teams:F.teams}):(0,I.jsx)(ie.a,{children:(0,I.jsx)(Ta.E,{children:(0,I.jsx)(d.x6,{i18nKey:"admin.ldap-user-info.no-team",children:"No teams found via LDAP"})})})]}),Fl={text:"LDAP",subTitle:"Verify your LDAP and user mapping configuration.",icon:"book",id:"LDAP"},Vl=({clearUserMappingInfo:F,queryParams:G,loadLdapState:k,loadLdapSyncStatus:re,loadUserMapping:ue,clearUserError:ge,ldapUser:Pe,userError:Ae,ldapError:We,ldapSyncInfo:qe,ldapConnectionInfo:et})=>{const[rt,lt]=(0,l.useState)(!0),{register:pt,handleSubmit:ht}=(0,er.mN)(),Ct=(0,l.useCallback)(async vn=>ue(vn),[ue]);(0,l.useEffect)(()=>{const vn=async()=>Promise.all([k(),re()]);async function an(){await F(),await vn(),G.username&&await Ct(G.username),lt(!1)}an()},[F,Ct,k,re,G]);const Wt=({username:vn})=>{vn&&Ct(vn)},en=()=>{ge()},on=Gs.TP.hasPermission(yn.w.LDAPUsersRead);return(0,I.jsx)(br.Y,{navId:"authentication",pageNav:Fl,children:(0,I.jsx)(br.Y.Contents,{isLoading:rt,children:(0,I.jsxs)(kt.B,{direction:"column",gap:4,children:[We&&We.title&&(0,I.jsx)(za.F,{title:We.title,severity:io.Qd.Error,children:We.body}),(0,I.jsx)(Ul,{ldapConnectionInfo:et}),(0,_c.a)("ldapsync")&&qe&&(0,I.jsx)(Nl,{ldapSyncInfo:qe}),on&&(0,I.jsxs)("section",{children:[(0,I.jsx)("h3",{children:(0,I.jsx)(d.x6,{i18nKey:"admin.ldap.test-mapping-heading",children:"Test user mapping"})}),(0,I.jsx)("form",{onSubmit:ht(Wt),children:(0,I.jsx)(Yi.D,{label:(0,d.t)("admin.ldap-page.label-username","Username"),children:(0,I.jsx)(tn.p,{...pt("username",{required:!0}),width:34,id:"username",type:"text",defaultValue:G.username,addonAfter:(0,I.jsx)(ve.$n,{variant:"primary",type:"submit",children:(0,I.jsx)(d.x6,{i18nKey:"admin.ldap.test-mapping-run-button",children:"Run"})})})})}),Ae&&Ae.title&&(0,I.jsx)(za.F,{title:Ae.title,severity:io.Qd.Error,onRemove:en,children:Ae.body}),Pe&&(0,I.jsx)(Qc,{ldapUser:Pe})]})]})})})},yi=F=>({ldapConnectionInfo:F.ldap.connectionInfo,ldapUser:F.ldap.user,ldapSyncInfo:F.ldap.syncInfo,userError:F.ldap.userError,ldapError:F.ldap.ldapError}),kc={loadLdapState:lo.JI,loadLdapSyncStatus:lo.pm,loadUserMapping:lo.Kg,clearUserError:lo.DX,clearUserMappingInfo:lo.Jc},pe=(0,hr.connect)(yi,kc)(Vl),Ce=F=>(0,l.lazy)(F);var ke=e(76070),ut=e(66513),vt=e(88114),At=e(17349),jt=e(74869),$t=e(54);function Yt(F=Y.$W){return[{path:"/alerting",component:qt(()=>Promise.all([e.e(7848),e.e(3236)]).then(e.bind(e,27848)))},{path:"/alerting/home",component:qt(()=>Promise.all([e.e(7848),e.e(3236)]).then(e.bind(e,27848)))},{path:"/alerting/list",roles:(0,$t.C0)([yn.w.AlertingRuleRead,yn.w.AlertingRuleExternalRead]),component:qt(()=>Promise.all([e.e(1851),e.e(3511)]).then(e.bind(e,91851)))},{path:"/alerting/routes",roles:(0,$t.C0)([yn.w.AlertingNotificationsRead,yn.w.AlertingNotificationsExternalRead,...vt.rw,...vt.nv,...ut.xK,...ut.Zr]),component:qt(()=>Promise.all([e.e(9360),e.e(1909)]).then(e.bind(e,19726)))},{path:"/alerting/routes/mute-timing/new",roles:(0,$t.C0)([yn.w.AlertingNotificationsWrite,yn.w.AlertingNotificationsExternalWrite,...ut.Zr]),component:qt(()=>Promise.all([e.e(3192),e.e(8302)]).then(e.bind(e,35388)))},{path:"/alerting/routes/mute-timing/edit",roles:(0,$t.C0)([yn.w.AlertingNotificationsWrite,yn.w.AlertingNotificationsExternalWrite,...ut.xK,...ut.Zr]),component:qt(()=>Promise.all([e.e(3192),e.e(558)]).then(e.bind(e,9334)))},{path:"/alerting/silences",roles:(0,$t.C0)([yn.w.AlertingInstanceRead,yn.w.AlertingInstancesExternalRead,yn.w.AlertingSilenceRead]),component:qt(()=>e.e(1668).then(e.bind(e,46627)))},{path:"/alerting/silence/new",roles:(0,$t.C0)([yn.w.AlertingInstanceCreate,yn.w.AlertingInstancesExternalWrite,yn.w.AlertingSilenceCreate,yn.w.AlertingSilenceUpdate]),component:qt(()=>e.e(1649).then(e.bind(e,29668)))},{path:"/alerting/silence/:id/edit",component:qt(()=>Promise.resolve().then(e.bind(e,24158)))},{path:"/alerting/notifications",roles:(0,$t.C0)([yn.w.AlertingNotificationsRead,yn.w.AlertingNotificationsExternalRead,...ke.w6,...At.X]),component:qt(()=>e.e(4312).then(e.bind(e,46787)))},{path:"/alerting/notifications/receivers/new",roles:(0,$t.C0)([yn.w.AlertingNotificationsRead,yn.w.AlertingNotificationsExternalRead,...ke.w6]),component:qt(()=>Promise.all([e.e(4312),e.e(9668),e.e(4666),e.e(6315),e.e(8622),e.e(3167)]).then(e.bind(e,15274)))},{path:"/alerting/notifications/receivers/:name/edit",roles:(0,$t.C0)([yn.w.AlertingNotificationsWrite,yn.w.AlertingNotificationsExternalWrite,yn.w.AlertingNotificationsRead,yn.w.AlertingNotificationsExternalRead,...ke.w6]),component:qt(()=>Promise.all([e.e(4312),e.e(9668),e.e(4666),e.e(6315),e.e(8622),e.e(6877)]).then(e.bind(e,29617)))},{path:"/alerting/notifications/templates/*",roles:(0,$t.C0)([yn.w.AlertingNotificationsRead,yn.w.AlertingNotificationsExternalRead,...At.X]),component:qt(()=>Promise.all([e.e(4312),e.e(9668),e.e(4666),e.e(9224)]).then(e.bind(e,7070)))},{path:"/alerting/notifications/global-config",roles:(0,$t.C0)([yn.w.AlertingNotificationsWrite,yn.w.AlertingNotificationsExternalWrite]),component:qt(()=>Promise.all([e.e(4312),e.e(9668),e.e(4666),e.e(6315),e.e(8504)]).then(e.bind(e,19644)))},{path:"/alerting/groups/",roles:(0,$t.C0)([yn.w.AlertingInstanceRead,yn.w.AlertingInstancesExternalRead]),component:qt(()=>e.e(8427).then(e.bind(e,13549)))},{path:"/alerting/history/",roles:(0,$t.C0)([yn.w.AlertingRuleRead]),component:qt(()=>Promise.all([e.e(8706),e.e(4302),e.e(44)]).then(e.bind(e,56102)))},{path:"/alerting/recently-deleted/",roles:()=>["Admin"],component:(0,jt.f2)()?qt(()=>e.e(3734).then(e.bind(e,75174))):()=>(0,I.jsx)(Pa.C5,{replace:!0,to:"/alerting/list"})},{path:"/alerting/import-datasource-managed-rules",roles:()=>["Admin"],component:Y.$W.featureToggles.alertingMigrationUI?qt(()=>e.e(9886).then(e.bind(e,45097))):()=>(0,I.jsx)(Pa.C5,{replace:!0,to:"/alerting/list"})},{path:"/alerting/new/:type?",pageClass:"page-alerting",roles:(0,$t.C0)([yn.w.AlertingRuleCreate,yn.w.AlertingRuleExternalWrite]),component:qt(()=>Promise.all([e.e(9668),e.e(4656),e.e(9360),e.e(4009)]).then(e.bind(e,23878)))},{path:"/alerting/:id/edit",pageClass:"page-alerting",roles:(0,$t.C0)([yn.w.AlertingRuleUpdate,yn.w.AlertingRuleExternalWrite]),component:qt(()=>Promise.all([e.e(9668),e.e(4656),e.e(9360),e.e(4009)]).then(e.bind(e,23878)))},{path:"/alerting/:id/modify-export",pageClass:"page-alerting",roles:(0,$t.C0)([yn.w.AlertingRuleRead]),component:qt(()=>Promise.all([e.e(9668),e.e(4656),e.e(9360),e.e(4009)]).then(e.bind(e,28124)))},{path:"/alerting/export-new-rule",pageClass:"page-alerting",roles:(0,$t.C0)([yn.w.AlertingRuleRead]),component:qt(()=>Promise.all([e.e(9668),e.e(4656),e.e(9360),e.e(4009)]).then(e.bind(e,87144)))},{path:"/alerting/:sourceName/:id/view",pageClass:"page-alerting",roles:(0,$t.C0)([yn.w.AlertingRuleRead,yn.w.AlertingRuleExternalRead]),component:qt(()=>Promise.resolve().then(e.bind(e,28390)))},{path:"/alerting/:sourceName/:name/find",pageClass:"page-alerting",roles:(0,$t.C0)([yn.w.AlertingRuleRead,yn.w.AlertingRuleExternalRead]),component:qt(()=>e.e(5516).then(e.bind(e,15102)))},{path:"/alerting/:dataSourceUid/namespaces/:namespaceId/groups/:groupName/view",pageClass:"page-alerting",roles:(0,$t.C0)([yn.w.AlertingRuleRead,yn.w.AlertingRuleExternalRead]),component:qt(()=>Promise.all([e.e(4162),e.e(3196)]).then(e.bind(e,12003)))},{path:"/alerting/:dataSourceUid/namespaces/:namespaceId/groups/:groupName/edit",pageClass:"page-alerting",roles:(0,$t.C0)([yn.w.AlertingRuleRead,yn.w.AlertingRuleExternalRead]),component:qt(()=>Promise.all([e.e(4656),e.e(6102)]).then(e.bind(e,56638)))},{path:"/alerting/admin",roles:()=>["Admin"],component:()=>(0,I.jsx)(Pa.C5,{replace:!0,to:"/alerting/admin/alertmanager"})},{path:"/alerting/admin/alertmanager",roles:()=>["Admin"],component:qt(()=>e.e(9438).then(e.bind(e,95627)))}]}function qt(F){const G=()=>e.e(9029).then(e.bind(e,31642));return Ce(Y.$W.unifiedAlertingEnabled?F:G)}var hn=e(77256),Cn=e(26437);const Nn=F=>({alertContent:(0,Ye.css)({display:"flex",flexDirection:"row",padding:0,justifyContent:"space-between",alignItems:"center"}),alertParagraph:(0,Ye.css)({margin:F.spacing(0,1,0,0),lineHeight:F.spacing(F.components.height.sm)})});function In(){const F=(0,mt.of)(Nn),G=Gs.TP.hasPermission(yn.w.DataSourcesCreate)||Gs.TP.hasPermission(yn.w.DataSourcesWrite),[k,re]=(0,l.useState)(G);return k?(0,I.jsx)(za.F,{severity:"info",title:"",onRemove:()=>re(!1),children:(0,I.jsxs)("div",{className:F.alertContent,children:[(0,I.jsx)("p",{className:F.alertParagraph,children:(0,I.jsx)(d.x6,{i18nKey:"connections.connections-redirect-notice.body",children:"Data sources have a new home! You can discover new data sources or manage existing ones in the Connections page, accessible from the main menu."})}),(0,I.jsx)(ve.z9,{"aria-label":(0,d.t)("connections.connections-redirect-notice.aria-label-link-to-connections","Link to Connections"),icon:"arrow-right",href:Cn.b.DataSources,fill:"text",children:(0,I.jsx)(d.x6,{i18nKey:"connections.connections-redirect-notice.go-to-connections",children:"Go to connections"})})]})}):(0,I.jsx)(I.Fragment,{})}function un(){return[{path:`/${Cn.q}/*`,component:Ce(()=>Promise.all([e.e(362),e.e(6436),e.e(3324),e.e(3658),e.e(2154)]).then(e.bind(e,63658)))}]}var Sn=e(37946),fa=e(20962),zn=e(52161),sa=(F=>(F.ViewIRMMainPage="grafana_irm_configuration_tracker_main_page_view",F.OpenEssentials="grafana_irm_configuration_tracker_essentials_open",F.CloseEssentials="grafana_irm_configuration_tracker_essentials_closed",F.ClickDataSources="grafana_irm_configuration_tracker_data_sources_clicked",F))(sa||{});function Bn(F,G){(0,ja.rR)(F,{...G})}var qn=e(97507),pa=e(46202),Un=e(182),cs=e(92367),wr=e(70327),Dr=e(6135),ms=e(44109);function Is(){const[F,{data:G,isLoading:k}]=wr.hK.endpoints.rulerRules.useLazyQuery({refetchOnFocus:!0,refetchOnReconnect:!0}),{dsFeatures:re,isLoadingDsFeatures:ue}=(0,ms.O3)(zn.hY),ge=re?.rulerConfig;return(0,l.useEffect)(()=>{ge&&F({rulerConfig:ge})},[ge,F]),{isDone:(G?Object.entries(G).flatMap(([We,qe])=>qe.flatMap(et=>et.rules)):[]).length>0,isLoading:k||ue}}function pr(F){return F.some(G=>G.grafana_managed_receiver_configs?.some(k=>k.type===Dr.J4.OnCall))}const tr="<example@email.com>";function Rs(F,G){const k=G.find(re=>re.name===F);return k?k.grafana_managed_receiver_configs?.some(re=>re.type==="email"?re.settings?.addresses!==tr:!0):!1}var ns=e(5709);const xs=F=>`/api/plugins/${(0,Un.Wx)()}/resources${F}`,xi=ns.H.injectEndpoints({endpoints:F=>({getIncidentsPluginConfig:F.query({query:()=>({url:xs("/api/ConfigurationTrackerService.GetConfigurationTracker"),data:{},method:"POST",showErrorAlert:!1})})})});var Fr=e(3986);function Wo(){const{installed:F,loading:G}=(0,Fr._)((0,Un.Wx)()),{data:k,isLoading:re}=xi.endpoints.getIncidentsPluginConfig.useQuery();return{isInstalled:F??!1,isChatOpsInstalled:k?.isChatOpsInstalled??!1,isIncidentCreated:k?.isIncidentCreated??!1,isLoading:G||re}}var Vr=e(77788);function $d(){const{installed:F}=(0,Fr._)((0,Un.BO)()),{data:G}=Vr.WG.endpoints.grafanaOnCallIntegrations.useQuery(void 0,{skip:!F,refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return G??[]}function Bh(){const{data:F,isLoading:G}=Vr.WG.endpoints.onCallConfigChecks.useQuery(void 0,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{isLoading:G,onCallConfigChecks:F??{is_chatops_connected:!1,is_integration_chatops_connected:!1}}}function zd(){return $d().map(G=>({label:G.display_name,value:G.value}))}function Uh(){const{onCallConfigChecks:{is_chatops_connected:F,is_integration_chatops_connected:G},isLoading:k}=Bh();return{is_chatops_connected:F,is_integration_chatops_connected:G,isLoading:k}}var _d=e(2869);const Gd=`/api/plugins/${_d.W.Slo}/resources/v1`,Wh=ns.H.injectEndpoints({endpoints:F=>({getSlos:F.query({query:()=>({url:`${Gd}/slo`,showErrorAlert:!1}),providesTags:["GrafanaSlo"]})})});function Yc(){const{installed:F}=(0,Fr._)(_d.W.Slo),{data:G,isLoading:k}=Wh.endpoints.getSlos.useQuery(void 0,{skip:!F,refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{isLoading:k,hasSlo:!!G?.slos.length,hasSloWithAlert:!!G?.slos?.some(re=>re.alerting)}}function Nh(){const{contactPoints:F,isLoading:G}=(0,qn.Z3)(),{data:k,isLoading:re}=(0,pa.yV)({alertmanager:zn.hY}),ue=k?.[0].receiver||"",{isDone:ge,isLoading:Pe}=Is(),{isChatOpsInstalled:Ae,isInstalled:We,isLoading:qe}=Wo(),et=zd(),{is_chatops_connected:rt,is_integration_chatops_connected:lt,isLoading:pt}=Uh(),{hasSlo:ht,hasSloWithAlert:Ct,isLoading:Wt}=Yc();return{alerting:{contactPoints:F,defaultContactpoint:ue,isCreateAlertRuleDone:ge},incidents:{isChatOpsInstalled:Ae,isIncidentsInstalled:We},onCall:{onCallOptions:et,is_chatops_connected:rt,is_integration_chatops_connected:lt},slo:{hasSlo:ht,hasSloWithAlert:Ct},isLoading:G||re||Pe||qe||pt||Wt}}function Kh(){const{alerting:{contactPoints:F,defaultContactpoint:G,isCreateAlertRuleDone:k},incidents:{isChatOpsInstalled:re,isIncidentsInstalled:ue},onCall:{onCallOptions:ge,is_chatops_connected:Pe,is_integration_chatops_connected:Ae},slo:{hasSlo:We,hasSloWithAlert:qe},isLoading:et}=Nh();function rt(Wt,en){const on=(0,cs.G)(`${en} + ${Wt}`,{returnTo:window.location.pathname+window.location.search});C.Ny.push(on)}function lt(){let Wt=[{title:(0,d.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.steps.title.update-default-contact-point","Update default contact point"),description:"Update the default contact point to a method other than the example email address.",button:{type:"openLink",urlLink:{url:"/alerting/notifications",queryParams:{search:G,alertmanager:"grafana"}},label:(0,d.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.steps.label.edit","Edit"),labelOnDone:"View",urlLinkOnDone:{url:"/alerting/notifications"}},done:Rs(G,F)}];return(0,Un.ZP)()||(Wt=[...Wt,{title:(0,d.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.title.connect-alerting-to-on-call","Connect alerting to OnCall"),description:(0,d.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.description.create-on-call-integration-alerting-contact-point","Create an OnCall integration for an alerting contact point."),button:{type:"openLink",urlLink:{url:"/alerting/notifications/receivers/new"},label:(0,d.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.label.connect","Connect"),urlLinkOnDone:{url:"/alerting/notifications"},labelOnDone:"View"},done:pr(F)}]),Wt=[...Wt,{title:(0,d.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.title.create-alert-rule","Create alert rule"),description:(0,d.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.description.create-alert-monitor-system","Create an alert rule to monitor your system."),button:{type:"openLink",urlLink:{url:"/alerting/new"},label:(0,d.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.label.create","Create"),urlLinkOnDone:{url:"/alerting/list"},labelOnDone:"View"},done:k},{title:(0,d.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.title.create-slo","Create SLO"),description:(0,d.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.description.create-slos-to-monitor-your-service","Create SLOs to monitor your service."),button:{type:"openLink",urlLink:{url:"/a/grafana-slo-app/wizard/new"},label:(0,d.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.label.create","Create"),urlLinkOnDone:{url:"/a/grafana-slo-app/manage-slos"},labelOnDone:"View"},done:We},{title:(0,d.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.title.enable-slo-alerting","Enable SLO alerting"),description:"Configure SLO alerting to receive notifications when your SLOs are breached.",button:{type:"openLink",urlLink:{queryParams:{alertsEnabled:"disabled"},url:"/a/grafana-slo-app/manage-slos"},label:(0,d.t)("gops.use-get-essentials-configuration.get-grafana-alerting-config-steps.label.enable","Enable"),urlLinkOnDone:{queryParams:{alertsEnabled:"enabled"},url:"/a/grafana-slo-app/manage-slos"},labelOnDone:"View"},done:qe}],Wt}const pt={sections:[{title:(0,d.t)("gops.use-get-essentials-configuration.essential-content.title.detect","Detect"),description:(0,d.t)("gops.use-get-essentials-configuration.essential-content.description.configure-grafana-alerting","Configure Grafana Alerting"),steps:lt()},{title:(0,d.t)("gops.use-get-essentials-configuration.essential-content.title.respond","Respond"),description:(0,Un.ZP)()?"Configure IRM":"Configure OnCall and Incident",steps:(0,Un.ZP)()?[{title:(0,d.t)("gops.use-get-essentials-configuration.essential-content.title.connect-alerting-to-irm","Connect alerting to IRM"),description:(0,d.t)("gops.use-get-essentials-configuration.essential-content.description.create-integration-alerting-contact-point","Create an IRM integration for an alerting contact point."),button:{type:"openLink",urlLink:{url:"/alerting/notifications/receivers/new"},label:(0,d.t)("gops.use-get-essentials-configuration.essential-content.label.connect","Connect"),urlLinkOnDone:{url:"/alerting/notifications"},labelOnDone:"View"},done:pr(F)},{title:(0,d.t)("gops.use-get-essentials-configuration.essential-content.title.connect-irm-to-your-slack-workspace","Connect IRM to your Slack workspace"),description:"Receive alerts and oncall notifications, or automatically create an incident channel and manage incidents directly within your chat environment.",button:{type:"openLink",urlLink:{url:`/a/${(0,Un.Wx)()}/integrations/apps/grate.irm.slack`},label:(0,d.t)("gops.use-get-essentials-configuration.essential-content.label.connect","Connect"),urlLinkOnDone:{url:`/a/${(0,Un.Wx)()}/integrations`}},done:re},{title:(0,d.t)("gops.use-get-essentials-configuration.essential-content.title.add-slack-notifications-to-irm-integrations","Add Slack notifications to IRM integrations"),description:(0,d.t)("gops.use-get-essentials-configuration.essential-content.description.select-chat-ops-channels-to-route-notifications","Select ChatOps channels to route notifications"),button:{type:"openLink",urlLink:{url:`/a/${(0,Un.BO)()}/integrations/`},label:(0,d.t)("gops.use-get-essentials-configuration.essential-content.label.add","Add"),urlLinkOnDone:{url:`/a/${(0,Un.BO)()}/integrations/`},labelOnDone:"View"},done:Ae}]:[{title:(0,d.t)("gops.use-get-essentials-configuration.essential-content.title.initialize-incident-plugin","Initialize Incident plugin"),description:(0,d.t)("gops.use-get-essentials-configuration.essential-content.description.initialize-incident-plugin-declare-manage-incidents","Initialize the Incident plugin to declare and manage incidents."),button:{type:"openLink",urlLink:{url:`/a/${(0,Un.Wx)()}/walkthrough/generate-key`},label:(0,d.t)("gops.use-get-essentials-configuration.essential-content.label.initialize","Initialize"),urlLinkOnDone:{url:`/a/${(0,Un.Wx)()}`},labelOnDone:"View"},done:ue},{title:(0,d.t)("gops.use-get-essentials-configuration.essential-content.title.connect-your-messaging-workspace-to-on-call","Connect your Messaging workspace to OnCall"),description:(0,d.t)("gops.use-get-essentials-configuration.essential-content.description.receive-alerts-oncall-notifications-within-environment","Receive alerts and oncall notifications within your chat environment."),button:{type:"openLink",urlLink:{url:`/a/${(0,Un.BO)()}/settings`,queryParams:{tab:"ChatOps",chatOpsTab:"Slack"}},label:(0,d.t)("gops.use-get-essentials-configuration.essential-content.label.connect","Connect"),urlLinkOnDone:{url:`/a/${(0,Un.BO)()}/settings`,queryParams:{tab:"ChatOps"}},labelOnDone:"View"},done:Pe},{title:(0,d.t)("gops.use-get-essentials-configuration.essential-content.title.connect-your-messaging-workspace-to-incident","Connect your Messaging workspace to Incident"),description:"Automatically create an incident channel and manage incidents directly within your chat environment.",button:{type:"openLink",urlLink:{url:`/a/${(0,Un.Wx)()}/integrations/grate.slack`},label:(0,d.t)("gops.use-get-essentials-configuration.essential-content.label.connect","Connect"),urlLinkOnDone:{url:`/a/${(0,Un.Wx)()}/integrations`}},done:re},{title:(0,d.t)("gops.use-get-essentials-configuration.essential-content.title.messaging-workspace-channel-on-call-integration","Add Messaging workspace channel to OnCall Integration"),description:(0,d.t)("gops.use-get-essentials-configuration.essential-content.description.select-chat-ops-channels-to-route-notifications","Select ChatOps channels to route notifications"),button:{type:"openLink",urlLink:{url:`/a/${(0,Un.BO)()}/integrations/`},label:(0,d.t)("gops.use-get-essentials-configuration.essential-content.label.add","Add"),urlLinkOnDone:{url:`/a/${(0,Un.BO)()}/integrations/`},labelOnDone:"View"},done:Ae}]},{title:(0,d.t)("gops.use-get-essentials-configuration.essential-content.title.test-your-configuration","Test your configuration"),description:"",steps:[{title:(0,Un.ZP)()?"Send test alert":"Send OnCall demo alert via Alerting integration",description:"In the integration page, click Send demo alert, to review your notification",button:{type:"dropDown",label:(0,d.t)("gops.use-get-essentials-configuration.essential-content.label.select-integration","Select integration"),options:ge,onClickOption:Wt=>rt(Wt,`/a/${(0,Un.BO)()}/integrations/`),stepNotAvailableText:"No integrations available"}},{title:(0,d.t)("gops.use-get-essentials-configuration.essential-content.title.create-incident-drill","Create Incident drill"),description:(0,d.t)("gops.use-get-essentials-configuration.essential-content.description.practice-solving-an-incident","Practice solving an Incident"),button:{type:"openLink",urlLink:{url:`/a/${(0,Un.Wx)()}`,queryParams:{declare:"new",drill:"1"}},label:(0,d.t)("gops.use-get-essentials-configuration.essential-content.label.start-drill","Start drill")}}]}]},{stepsDone:ht,totalStepsToDo:Ct}=pt.sections.reduce((Wt,en)=>{const on=en.steps.filter(an=>an.done).length,vn=en.steps.reduce((an,gn)=>gn.done!==void 0?an+1:an,0);return{stepsDone:Wt.stepsDone+on,totalStepsToDo:Wt.totalStepsToDo+vn}},{stepsDone:0,totalStepsToDo:0});return{essentialContent:pt,stepsDone:ht,totalStepsToDo:Ct,isLoading:et}}const wh=({dataSourceConfigurationData:{dataSourceCompatibleWithAlerting:F},essentialsConfigurationData:{stepsDone:G,totalStepsToDo:k}})=>(0,l.useMemo)(()=>{function re(){const ue=F?"You have connected a datasource.":"Connect at least one data source to start receiving data",ge=F?"View":"Connect";return{id:Jc.CONNECT_DATASOURCE,title:(0,d.t)("gops.use-get-configuration-for-ui.get-connect-data-source-configuration.title.connect-data-source","Connect data source"),description:ue,actionButtonTitle:ge,isDone:F}}return[re(),{id:Jc.ESSENTIALS,title:(0,d.t)("gops.use-get-configuration-for-ui.title.essentials","Essentials"),titleIcon:"star",description:"Set up the necessary features to start using Grafana IRM workflows",actionButtonTitle:G===k?"View":"Configure",stepsDone:G,totalStepsToDo:k}]},[F,G,k]);var Hd=e(6975);function $l({stepsDone:F,totalStepsToDo:G}){const k=(0,mt.of)(kd);return G===0?null:(0,I.jsx)("div",{className:k.containerStyles,role:"progressbar","aria-valuenow":F,"aria-valuemax":G,children:(0,I.jsx)("div",{className:k.fillerStyles(F/G*100)})})}function Qd({stepsDone:F,totalStepsToDo:G}){return(0,I.jsx)("span",{children:(0,I.jsxs)(d.x6,{i18nKey:"gops.progress-bar.steps-status",values:{stepsDone:F},children:[(0,I.jsx)(Ta.E,{color:"success",children:"{{stepsDone}}"})," of ",{totalStepsToDo:G}]})})}function kd(F){return{containerStyles:(0,Ye.css)({height:F.spacing(2),borderRadius:F.shape.radius.pill,backgroundColor:F.colors.border.weak,flex:"auto"}),fillerStyles:G=>(0,Ye.css)({height:"100%",width:`${G}%`,backgroundColor:F.colors.success.main,borderRadius:F.shape.radius.pill,textAlign:"right"})}}function Fh({config:F,handleActionClick:G,isLoading:k=!1}){const re=(0,mt.of)(Yd);return(0,I.jsx)(kt.B,{direction:"column",gap:1,justifyContent:"space-around",children:(0,I.jsxs)("div",{className:re.cardContent,children:[(0,I.jsxs)(kt.B,{direction:"column",gap:1,children:[(0,I.jsxs)(kt.B,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:1,children:[(0,I.jsx)("div",{className:"fs-unmask",children:(0,I.jsxs)(kt.B,{direction:"row",gap:1,alignItems:"center",children:[F.title,F.titleIcon&&(0,I.jsx)(_n.I,{name:F.titleIcon}),F.isDone&&!k&&(0,I.jsx)(_n.I,{name:"check-circle",color:"green",size:"lg"})]})}),F.stepsDone&&F.totalStepsToDo&&!k&&(0,I.jsx)("div",{className:"fs-unmask",children:(0,I.jsxs)(kt.B,{direction:"row",gap:.5,children:[(0,I.jsx)(Qd,{stepsDone:F.stepsDone,totalStepsToDo:F.totalStepsToDo}),(0,I.jsx)(d.x6,{i18nKey:"configuration-tracker.config-card.complete",children:"complete"})]})})]}),(0,I.jsxs)(kt.B,{direction:"column",children:[k?(0,I.jsx)(Hd._,{text:(0,d.t)("gops.config-card.text-loading-configuration","Loading configuration....")}):F.description,!k&&F.stepsDone&&F.totalStepsToDo&&(0,I.jsx)($l,{stepsDone:F.stepsDone,totalStepsToDo:F.totalStepsToDo})]})]}),(0,I.jsx)(kt.B,{direction:"row",gap:1,justifyContent:"flex-start",alignItems:"flex-end",children:(0,I.jsx)(ve.$n,{variant:"secondary",onClick:()=>G(F.id,F.isDone),className:"fs-unmask",children:F.actionButtonTitle})})]})})}const Yd=F=>({cardTitle:(0,Ye.css)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"}),cardContent:(0,Ye.css)({background:F.colors.background.secondary,padding:F.spacing(2),borderRadius:F.shape.radius.default,height:"100%",gap:F.spacing(1),display:"flex",flexDirection:"column",justifyContent:"space-between"})});var No=e(8207),Ei=e(88559),gr=e(87063);function Vh({onClose:F,essentialsConfig:G,stepsDone:k,totalStepsToDo:re}){return(0,I.jsx)(No._,{title:(0,d.t)("gops.essentials.title-essentials","Essentials"),subtitle:"Complete the following configuration tasks",onClose:F,children:(0,I.jsx)($h,{essentialContent:G,stepsDone:k,totalStepsToDo:re})})}function $h({essentialContent:F,stepsDone:G,totalStepsToDo:k}){return(0,I.jsxs)(kt.B,{direction:"column",gap:1,children:[(0,I.jsx)(_h,{stepsDone:G,totalStepsToDo:k}),F.sections.map(re=>(0,I.jsx)(zh,{section:re},re.title))]})}function zh({section:F}){const G=(0,mt.of)(Gh);return(0,I.jsxs)("div",{className:G.wrapper,children:[(0,I.jsx)(Ta.E,{element:"h4",children:(0,I.jsx)("span",{className:"fs-unmask",children:F.title})}),(0,I.jsx)(Ta.E,{color:"secondary",children:(0,I.jsx)("span",{className:"fs-unmask",children:F.description})}),(0,I.jsx)(kt.B,{direction:"column",gap:2,children:F.steps.map((k,re)=>(0,I.jsx)(Xd,{step:k},re))})]})}function Jd({done:F}){return F?(0,I.jsx)(_n.I,{name:"check-circle",color:"green","data-testid":"checked-step",className:"fs-unmask"}):(0,I.jsx)(_n.I,{name:"circle","data-testid":"unckecked-step",className:"fs-unmask"})}function Xd({step:F}){return(0,I.jsxs)(kt.B,{direction:"row",justifyContent:"space-between","data-testid":"step",children:[(0,I.jsxs)(kt.B,{direction:"row",alignItems:"center",children:[F.done!==void 0&&(0,I.jsx)(Jd,{done:F.done}),(0,I.jsx)(Ta.E,{variant:"body",children:(0,I.jsx)("span",{className:"fs-unmask",children:F.title})}),(0,I.jsx)(Kr.m,{content:F.description,placement:"right",children:(0,I.jsx)(_n.I,{name:"question-circle"})})]}),(0,I.jsx)(qd,{...F.button,done:F.done,"data-testid":"step-button"})]})}function Zd(F){const{urlLink:G,label:k,urlLinkOnDone:re,labelOnDone:ue,done:ge}=F,Pe=G?.url?(0,cs.G)(G.url,{returnTo:window.location.pathname+window.location.search,...G.queryParams}):"",Ae=re?.url?(0,cs.G)(re.url,{returnTo:window.location.pathname+window.location.search,...re.queryParams}):"",We=ge?Ae:Pe;return(0,I.jsx)(ve.z9,{href:We,variant:"secondary",className:"fs-unmask",children:ge?ue??k:k})}function qd({type:F,urlLink:G,urlLinkOnDone:k,label:re,labelOnDone:ue,options:ge,onClickOption:Pe,done:Ae,stepNotAvailableText:We}){switch(F){case"openLink":return(0,I.jsx)(Zd,{urlLink:G,label:re,urlLinkOnDone:k,labelOnDone:ue,done:Ae});case"dropDown":return ge?.length?(0,I.jsx)(Ei.m,{overlay:(0,I.jsx)(gr.W,{className:"fs-unmask",children:ge?.map(qe=>(0,I.jsx)(gr.W.Item,{label:qe.label,className:"fs-unmask",onClick:()=>{Pe?.(qe.value)}},qe.value))}),children:(0,I.jsxs)(ve.$n,{variant:"secondary",size:"md",className:"fs-unmask",children:[re,(0,I.jsx)(_n.I,{name:"angle-down"})]})}):(0,I.jsxs)(Ta.E,{children:[We??"No options available"," "]})}}function _h({stepsDone:F,totalStepsToDo:G}){return(0,I.jsxs)(kt.B,{direction:"row",gap:1,alignItems:"center",children:[(0,I.jsx)(d.x6,{i18nKey:"gops.progress-status.your-progress",children:"Your progress"}),(0,I.jsx)($l,{stepsDone:F,totalStepsToDo:G}),(0,I.jsx)(Qd,{stepsDone:F,totalStepsToDo:G})]})}const Gh=F=>({wrapper:(0,Ye.css)({margin:F.spacing(2,0),padding:F.spacing(2),border:`1px solid ${F.colors.border.medium}`,borderRadius:F.shape.radius.default,display:"flex",flexDirection:"column",gap:F.spacing(2)})});var Jc=(F=>(F[F.CONNECT_DATASOURCE=0]="CONNECT_DATASOURCE",F[F.ESSENTIALS=1]="ESSENTIALS",F))(Jc||{});function Xc(){return{dataSourceCompatibleWithAlerting:!!(0,zn.k5)()}}function Hh(){const F=(0,mt.of)(Qh),G=(0,Pa.Zp)(),k=Xc(),re=Kh(),ue=wh({dataSourceConfigurationData:k,essentialsConfigurationData:re});(0,l.useEffect)(()=>{Bn(sa.ViewIRMMainPage,{essentialStepsDone:0,essentialStepsToDo:0,dataSourceCompatibleWithAlerting:k.dataSourceCompatibleWithAlerting})},[k.dataSourceCompatibleWithAlerting]);const[ge,Pe]=(0,fa.l)(),Ae=ge.get("essentials")==="open",We=(et,rt)=>{switch(Bn(sa.ClickDataSources,{essentialStepsDone:re.stepsDone,essentialStepsToDo:re.totalStepsToDo,dataSourceCompatibleWithAlerting:k.dataSourceCompatibleWithAlerting}),et){case 0:G(rt?Sn.I.List:Sn.I.New);break;case 1:Pe({essentials:"open"}),Bn(sa.OpenEssentials,{essentialStepsDone:re.stepsDone,essentialStepsToDo:re.totalStepsToDo,dataSourceCompatibleWithAlerting:k.dataSourceCompatibleWithAlerting});break;default:return}};function qe(){Pe({essentials:void 0}),Bn(sa.CloseEssentials,{essentialStepsDone:re.stepsDone,essentialStepsToDo:re.totalStepsToDo,dataSourceCompatibleWithAlerting:k.dataSourceCompatibleWithAlerting})}return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(Ta.E,{element:"h4",variant:"h4",children:(0,I.jsx)(d.x6,{i18nKey:"gops.configure-irm.configure",children:"Configure"})}),(0,I.jsxs)("section",{className:F.container,children:[ue.map(et=>(0,I.jsx)(Fh,{config:et,handleActionClick:We,isLoading:re.isLoading},et.id)),Ae&&(0,I.jsx)(Vh,{onClose:qe,essentialsConfig:re.essentialContent,stepsDone:re.stepsDone,totalStepsToDo:re.totalStepsToDo})]}),(0,I.jsx)(Ta.E,{element:"h4",variant:"h4",children:(0,I.jsx)(d.x6,{i18nKey:"gops.configure-irm.irm-apps",children:"IRM apps"})})]})}const Qh=F=>({container:(0,Ye.css)({marginBottom:0,display:"grid",gap:F.spacing(3),gridTemplateColumns:" 1fr 1fr"})});var Zc=e(13660);const qc=[{path:"/plugins",navId:"plugins",roles:zl([yn.w.PluginsInstall,yn.w.PluginsWrite],["Admin","ServerAdmin"]),routeName:Zc.vk.Home,component:Ce(()=>e.e(4519).then(e.bind(e,37761)))},{path:"/plugins/browse",navId:"plugins",roles:zl([yn.w.PluginsInstall,yn.w.PluginsWrite],["Admin","ServerAdmin"]),routeName:Zc.vk.Browse,component:Ce(()=>e.e(4519).then(e.bind(e,37761)))},{path:"/plugins/:pluginId/",navId:"plugins",roles:zl([yn.w.PluginsInstall,yn.w.PluginsWrite],["Admin","ServerAdmin"]),routeName:Zc.vk.Details,component:Ce(()=>Promise.all([e.e(362),e.e(6436),e.e(3324),e.e(7891)]).then(e.bind(e,31879)))}];function zl(F,G){return()=>F.some(k=>Gs.TP.hasPermission(k))?[]:G}function kh(){return qc}var Yh=e(37168);const eu=[{path:"/profile",component:Ce(()=>Promise.all([e.e(3126),e.e(2472)]).then(e.bind(e,67521)))},{path:"/profile/password",component:Ce(()=>e.e(9996).then(e.bind(e,9996)))},{path:"/profile/select-org",component:Ce(()=>e.e(7430).then(e.bind(e,31830)))},{path:"/profile/notifications",component:Ce(()=>e.e(4140).then(e.bind(e,30946)))}];function Jh(F=Y.$W){return F.profileEnabled?eu:(0,J.uniq)(eu.map(k=>k.path)).map(k=>({path:k,component:Ce(()=>e.e(5173).then(e.bind(e,77267)))}))}var As=e(6262);const Xh=()=>Y.$W.publicDashboardsEnabled?[{path:"/dashboard/public",pageClass:"page-dashboard",routeName:As.Z4.Public,component:Ce(()=>e.e(5761).then(e.bind(e,69579)))},{path:"/public-dashboards/:accessToken",pageClass:"page-dashboard",routeName:As.Z4.Public,chromeless:!0,component:Ce(()=>Promise.all([e.e(6088),e.e(9609),e.e(7197)]).then(e.bind(e,27787)))}]:[];var Zh=e(53247),Cr=e(91555);function qh(){return(0,Zh.Hv)()?[{path:Cr.mL,component:Ce(()=>Promise.all([e.e(886),e.e(2182)]).then(e.bind(e,15134)))},{path:Cr.zM,component:Ce(()=>Promise.all([e.e(886),e.e(1037)]).then(e.bind(e,90886)))},{path:`${Cr.pd}/:type`,component:Ce(()=>e.e(252).then(e.bind(e,13833)))},{path:Cr.mL+"/:name",component:Ce(()=>e.e(6092).then(e.bind(e,6299)))},{path:Cr.mL+"/:name/edit",component:Ce(()=>e.e(8758).then(e.bind(e,33580)))},{path:Cr.mL+"/:name/file/*",component:Ce(()=>e.e(1954).then(e.bind(e,28682)))},{path:Cr.mL+"/:name/history/*",component:Ce(()=>e.e(9898).then(e.bind(e,22192)))},{path:Cr.mL+"/:slug/dashboard/preview/*",pageClass:"page-dashboard",routeName:As.Z4.Provisioning,component:Ce(()=>e.e(8638).then(e.bind(e,21819)))}]:[{path:Cr.mL,component:Ce(()=>Promise.all([e.e(886),e.e(1037)]).then(e.bind(e,90886)))}]}const ef=Y.Ay.buildInfo.env==="development",tf=[];function nf(){return[...(0,Yh.X)(),{path:"/",pageClass:"page-dashboard",routeName:As.Z4.Home,component:Ce(()=>Promise.all([e.e(6088),e.e(7051),e.e(9609),e.e(2603),e.e(9136)]).then(e.bind(e,92603)))},{path:"/d/:uid/:slug?",pageClass:"page-dashboard",routeName:As.Z4.Normal,component:Ce(()=>Promise.all([e.e(6088),e.e(7051),e.e(9609),e.e(2603),e.e(9136)]).then(e.bind(e,92603)))},{path:"/dashboard/new",roles:()=>Gn.TP.evaluatePermission([yn.w.DashboardsCreate]),pageClass:"page-dashboard",routeName:As.Z4.New,component:Ce(()=>Promise.all([e.e(6088),e.e(7051),e.e(9609),e.e(2603),e.e(2976)]).then(e.bind(e,92603)))},{path:"/dashboard/new-with-ds/:datasourceUid",roles:()=>Gn.TP.evaluatePermission([yn.w.DashboardsCreate]),component:Ce(()=>Promise.all([e.e(6088),e.e(7051),e.e(9609),e.e(2603),e.e(2976)]).then(e.bind(e,22754)))},{path:"/dashboard/:type/:slug",pageClass:"page-dashboard",routeName:As.Z4.Normal,component:Ce(()=>Promise.all([e.e(6088),e.e(7051),e.e(9609),e.e(2603),e.e(2976)]).then(e.bind(e,92603)))},{path:"/dashboards/embedding-test",component:Ce(()=>Promise.all([e.e(6088),e.e(7051),e.e(9609),e.e(2603),e.e(2976)]).then(e.bind(e,77437)))},{path:"/d-solo/:uid/:slug?",routeName:As.Z4.Normal,chromeless:!0,component:Ce(()=>Y.Ay.featureToggles.dashboardSceneSolo?e.e(7849).then(e.bind(e,35463)):Promise.all([e.e(6088),e.e(4492)]).then(e.bind(e,49286)))},{path:"/dashboard-solo/:type/:slug",routeName:As.Z4.Normal,chromeless:!0,component:Ce(()=>Y.Ay.featureToggles.dashboardSceneSolo?e.e(7849).then(e.bind(e,35463)):Promise.all([e.e(6088),e.e(4492)]).then(e.bind(e,49286)))},{path:"/dashboard/import",component:Ce(()=>e.e(2550).then(e.bind(e,25650)))},{path:Sn.I.List,component:()=>(0,I.jsx)(Pa.C5,{replace:!0,to:Cn.b.DataSources})},{path:Sn.I.Edit,component:rf},{path:Sn.I.Dashboards,component:sf},{path:Sn.I.New,component:()=>(0,I.jsx)(Pa.C5,{replace:!0,to:Cn.b.DataSourcesNew})},{path:"/datasources/correlations",component:Ce(()=>Y.Ay.featureToggles.correlations?e.e(9981).then(e.bind(e,45185)):e.e(8014).then(e.bind(e,29181)))},{path:"/dashboards",component:Ce(()=>Promise.all([e.e(362),e.e(6436),e.e(152)]).then(e.bind(e,45546)))},{path:"/dashboards/f/:uid/:slug",component:Ce(()=>Promise.all([e.e(362),e.e(6436),e.e(152)]).then(e.bind(e,45546)))},{path:"/dashboards/f/:uid",component:Ce(()=>Promise.all([e.e(362),e.e(6436),e.e(152)]).then(e.bind(e,45546)))},{path:"/explore",pageClass:"page-explore",roles:()=>Gn.TP.evaluatePermission([yn.w.DataSourcesExplore]),component:Ce(()=>Y.Ay.exploreEnabled?Promise.all([e.e(407),e.e(5995),e.e(2516),e.e(20),e.e(7051),e.e(3474),e.e(1213),e.e(9147),e.e(2792),e.e(9604)]).then(e.bind(e,30411)):e.e(4422).then(e.bind(e,89153)))},{path:"/drilldown",component:()=>(0,I.jsx)(Os,{navId:"drilldown"})},{path:"/apps",component:()=>(0,I.jsx)(Os,{navId:"apps"})},{path:"/alerts-and-incidents",component:()=>(0,I.jsx)(Os,{navId:"alerts-and-incidents",header:!(0,hn.y$)()&&(0,hn.qc)()||(0,hn.ES)()?(0,I.jsx)(Hh,{}):void 0})},{path:"/testing-and-synthetics",component:()=>(0,I.jsx)(Os,{navId:"testing-and-synthetics"})},{path:"/monitoring",component:()=>(0,I.jsx)(Pa.C5,{replace:!0,to:"/observability"})},{path:"/observability",component:()=>(0,I.jsx)(Os,{navId:"observability"})},{path:"/infrastructure",component:()=>(0,I.jsx)(Os,{navId:"infrastructure"})},{path:"/frontend",component:()=>(0,I.jsx)(Os,{navId:"frontend"})},{path:"/admin/general",component:()=>(0,I.jsx)(Os,{navId:"cfg/general"})},{path:"/admin/plugins",component:()=>(0,I.jsx)(Os,{navId:"cfg/plugins"})},{path:"/admin/extensions",navId:"extensions",roles:()=>Gn.TP.evaluatePermission([yn.w.PluginsInstall,yn.w.PluginsWrite]),component:ef||Y.Ay.featureToggles.enableExtensionsAdminPage?Ce(()=>e.e(5902).then(e.bind(e,79682))):()=>(0,I.jsx)(Pa.C5,{replace:!0,to:"/admin"})},{path:"/admin/access",component:()=>(0,I.jsx)(Os,{navId:"cfg/access"})},{path:"/org",component:Ce(()=>Promise.all([e.e(3126),e.e(1510)]).then(e.bind(e,73318)))},{path:"/org/new",component:Ce(()=>e.e(7930).then(e.bind(e,45408)))},{path:"/org/users",component:()=>(0,I.jsx)(Pa.C5,{replace:!0,to:"/admin/users"})},{path:"/org/users/invite",component:Ce(()=>e.e(7720).then(e.bind(e,65914)))},{path:"/org/serviceaccounts",roles:()=>Gn.TP.evaluatePermission([yn.w.ServiceAccountsRead,yn.w.ServiceAccountsCreate]),component:Ce(()=>Promise.all([e.e(265),e.e(6777)]).then(e.bind(e,75955)))},{path:"/org/serviceaccounts/create",component:Ce(()=>Promise.all([e.e(265),e.e(4176)]).then(e.bind(e,41150)))},{path:"/org/serviceaccounts/:id",component:Ce(()=>Promise.all([e.e(265),e.e(6576)]).then(e.bind(e,88468)))},{path:"/org/teams",roles:()=>Gn.TP.evaluatePermission([yn.w.ActionTeamsRead,yn.w.ActionTeamsCreate]),component:Ce(()=>Promise.all([e.e(265),e.e(1036)]).then(e.bind(e,34314)))},{path:"/org/teams/new",roles:()=>Gn.TP.evaluatePermission([yn.w.ActionTeamsCreate]),component:Ce(()=>Promise.all([e.e(265),e.e(5436)]).then(e.bind(e,84974)))},{path:"/org/teams/edit/:uid/:page?",roles:()=>Gn.TP.evaluatePermission([yn.w.ActionTeamsRead,yn.w.ActionTeamsCreate]),component:Ce(()=>Promise.all([e.e(265),e.e(3126),e.e(2212)]).then(e.bind(e,76172)))},{path:"/admin",component:()=>(0,I.jsx)(Os,{navId:"cfg",header:(0,I.jsx)(In,{})})},{path:"/admin/authentication",roles:()=>Gn.TP.evaluatePermission([yn.w.SettingsWrite]),component:Y.Ay.licenseInfo.enabledFeatures?.saml||Y.Ay.ldapEnabled?Ce(()=>e.e(5592).then(e.bind(e,53953))):()=>(0,I.jsx)(Pa.C5,{replace:!0,to:"/admin"})},{path:"/admin/authentication/ldap",component:Y.Ay.featureToggles.ssoSettingsLDAP?Ce(()=>e.e(4582).then(e.bind(e,43124))):pe},{path:"/admin/authentication/:provider",roles:()=>Gn.TP.evaluatePermission([yn.w.SettingsWrite]),component:Ce(()=>e.e(5592).then(e.bind(e,81172)))},{path:"/admin/settings",component:Ce(()=>e.e(7659).then(e.bind(e,29154)))},{path:"/admin/upgrading",component:Ce(()=>e.e(6759).then(e.bind(e,12715)))},{path:"/admin/users",component:Ce(()=>Promise.all([e.e(265),e.e(1743)]).then(e.bind(e,12074)))},{path:"/admin/users/create",component:Ce(()=>e.e(9239).then(e.bind(e,62648)))},{path:"/admin/users/edit/:id",component:Ce(()=>Promise.all([e.e(265),e.e(8054)]).then(e.bind(e,698)))},{path:"/admin/orgs",component:Ce(()=>e.e(9736).then(e.bind(e,55026)))},{path:"/admin/orgs/edit/:id",component:Ce(()=>Promise.all([e.e(265),e.e(9119)]).then(e.bind(e,88947)))},{path:"/admin/featuretoggles",component:Y.Ay.featureToggles.featureToggleAdminPage?Ce(()=>e.e(7024).then(e.bind(e,75180))):()=>(0,I.jsx)(Pa.C5,{replace:!0,to:"/admin"})},{path:"/admin/stats",component:Ce(()=>e.e(9299).then(e.bind(e,32882)))},Y.Ay.featureToggles.onPremToCloudMigrations&&{path:"/admin/migrate-to-cloud",roles:()=>Gn.TP.evaluatePermission([yn.w.MigrationAssistantMigrate]),component:Ce(()=>e.e(3704).then(e.bind(e,2681)))},{path:"/login",component:Ce(()=>Promise.all([e.e(7651),e.e(3883)]).then(e.bind(e,798))),pageClass:"login-page",chromeless:!0},{path:"/invite/:code",component:Ce(()=>e.e(8576).then(e.bind(e,68620))),chromeless:!0},{path:"/verify",component:Y.Ay.verifyEmailEnabled?Ce(()=>e.e(2018).then(e.bind(e,62018))):()=>(0,I.jsx)(Pa.C5,{replace:!0,to:"/signup"}),pageClass:"login-page",chromeless:!0},{path:"/signup",component:Y.Ay.disableUserSignUp?()=>(0,I.jsx)(Pa.C5,{replace:!0,to:"/login"}):Ce(()=>e.e(8347).then(e.bind(e,98347))),pageClass:"login-page",chromeless:!0},{path:"/user/password/send-reset-email",chromeless:!0,component:Ce(()=>e.e(3818).then(e.bind(e,81545)))},{path:"/user/password/reset",component:Ce(()=>Promise.all([e.e(7651),e.e(641)]).then(e.bind(e,1711))),pageClass:"login-page",chromeless:!0},{path:"/dashboard/snapshots",roles:()=>Gn.TP.evaluatePermission([yn.w.SnapshotsRead]),component:Ce(()=>e.e(6590).then(e.bind(e,3839)))},{path:"/playlists",component:Ce(()=>e.e(1168).then(e.bind(e,22129)))},{path:"/playlists/play/:uid",component:Ce(()=>e.e(1374).then(e.bind(e,57304)))},{path:"/playlists/new",component:Ce(()=>e.e(7616).then(e.bind(e,95594)))},{path:"/playlists/edit/:uid",component:Ce(()=>e.e(7620).then(e.bind(e,33876)))},{path:"/sandbox/benchmarks",component:Ce(()=>e.e(9354).then(e.bind(e,13591)))},{path:"/sandbox/test",component:Ce(()=>e.e(5354).then(e.bind(e,12057)))},{path:"/dashboards/f/:uid/:slug/library-panels",component:Ce(()=>e.e(5804).then(e.bind(e,95576)))},{path:"/dashboards/f/:uid/:slug/alerting",roles:()=>Gn.TP.evaluatePermission([yn.w.AlertingRuleRead]),component:Ce(()=>e.e(4333).then(e.bind(e,85185)))},{path:"/library-panels",component:Ce(()=>e.e(8516).then(e.bind(e,21155)))},{path:"/notifications",component:Ce(()=>e.e(4140).then(e.bind(e,30946)))},{path:"/explore/metrics/*",roles:()=>Gn.TP.evaluatePermission([yn.w.DataSourcesExplore]),component:Ce(()=>e.e(8513).then(e.bind(e,24227)))},{path:"/bookmarks",component:Ce(()=>e.e(7759).then(e.bind(e,27906)))},Y.Ay.featureToggles.restoreDashboards&&{path:"/dashboard/recently-deleted",roles:()=>["Admin","ServerAdmin"],component:Ce(()=>Promise.all([e.e(362),e.e(6436),e.e(6299)]).then(e.bind(e,3853)))},{path:"/femt",component:()=>(0,I.jsx)(Pa.C5,{replace:!0,to:"/"})},...kh(),...af(),...Yt(),...Jh(),...tf,...Xh(),...un(),...qh(),{path:"/goto/*",component:_l},{path:"/*",component:zc.H}].filter(La.zz)}function af(F=Y.Ay){return F.supportBundlesEnabled?[{path:"/support-bundles",component:Ce(()=>e.e(123).then(e.bind(e,236)))},{path:"/support-bundles/create",component:Ce(()=>e.e(1515).then(e.bind(e,26484)))}]:[]}function sf(){const{uid:F=""}=(0,Pa.g)();return(0,I.jsx)(Pa.C5,{replace:!0,to:Cn.b.DataSourcesDashboards.replace(":uid",F)})}function rf(){const{uid:F=""}=(0,Pa.g)();return(0,I.jsx)(Pa.C5,{replace:!0,to:Cn.b.DataSourcesEdit.replace(":uid",F)})}function _l(){const{pathname:F}=(0,Pa.zy)();return(0,l.useEffect)(()=>{window.location.href=F},[F]),null}var Ba=e(8535),$r=e(58449),lf=e(77345);const cf=()=>{const{isOpen:F}=(0,$r.sA)();return(0,I.jsx)(lf.k,{isExtensionSidebarOpen:F})};var mr=e(27963),ed=e(75683),tu=e(56297);function df({error:F,errorInfo:G}){const k=(0,Pa.zy)(),re=F?.name==="ChunkLoadError",ue=(0,mt.of)(uf);return(0,l.useEffect)(()=>{re&&k.search.indexOf("chunkNotFound")===-1&&(window.location.href=y.I.getUrlForPartial(k,{chunkNotFound:!0}))},[k,re]),(0,I.jsx)(br.Y,{navId:"error",layout:ed.k.Canvas,children:(0,I.jsxs)("div",{className:ue.container,children:[re&&(0,I.jsxs)("div",{children:[(0,I.jsx)("h2",{children:(0,I.jsx)(d.x6,{i18nKey:"route-error.title",children:"Unable to find application file"})}),(0,I.jsx)("br",{}),(0,I.jsx)("h2",{className:"page-heading",children:(0,I.jsx)(d.x6,{i18nKey:"route-error.description",children:"Grafana has likely been updated. Please try reloading the page."})}),(0,I.jsx)("br",{}),(0,I.jsx)(ve.$n,{size:"md",variant:"secondary",icon:"repeat",onClick:()=>window.location.reload(),children:(0,I.jsx)(d.x6,{i18nKey:"route-error.reload-button",children:"Reload"})}),(0,I.jsx)(tu.D,{title:(0,d.t)("route-error.error-title","Error details"),error:F,errorInfo:G})]}),!re&&(0,I.jsx)(tu.D,{title:(0,d.t)("route-error.error-unexpected-title","An unexpected error happened"),error:F,errorInfo:G})]})})}const uf=F=>({container:(0,Ye.css)({width:"500px",margin:F.spacing(8,"auto")})});var hf=e(42581);function ff(){const F=(0,mt.of)(mf);return(0,I.jsx)("div",{className:F.container,"aria-live":"polite",role:"status","aria-label":(0,d.t)("bouncing-loader.label","Loading"),children:(0,I.jsx)("div",{className:F.bounce,children:(0,I.jsx)("img",{alt:"",src:hf,className:F.logo})})})}const pf=(0,Ye.keyframes)({"0%":{opacity:0,animationTimingFunction:"cubic-bezier(0, 0, 0.5, 1)"},"100%":{opacity:1}}),gf=(0,Ye.keyframes)({"0%":{opacity:0},"50%":{opacity:1},"100%":{opacity:0}}),nu=(0,Ye.keyframes)({"from, to":{transform:"translateY(0px)",animationTimingFunction:"cubic-bezier(0.3, 0, 0.1, 1)"},"50%":{transform:"translateY(-50px)",animationTimingFunction:"cubic-bezier(0.9, 0, 0.7, 1)"}}),au=(0,Ye.keyframes)({"0%":{transform:"scaleX(1.3) scaleY(0.8)",animationTimingFunction:"cubic-bezier(0.3, 0, 0.1, 1)"},"15%":{transform:"scaleX(0.75) scaleY(1.25)",animationTimingFunction:"cubic-bezier(0, 0, 0.7, 0.75)"},"55%":{transform:"scaleX(1.05) scaleY(0.95)",animationTimingFunction:"cubic-bezier(0.9, 0, 1, 1)"},"95%":{transform:"scaleX(0.75) scaleY(1.25)",animationTimingFunction:"cubic-bezier(0, 0, 0, 1)"},"100%":{transform:"scaleX(1.3) scaleY(0.8)",animationTimingFunction:"cubic-bezier(0, 0, 0.7, 1)"}}),mf=F=>({container:(0,Ye.css)({opacity:0,[F.transitions.handleMotion("no-preference")]:{animationName:pf,animationIterationCount:1,animationDuration:"0.9s",animationDelay:"0.5s",animationFillMode:"forwards"},[F.transitions.handleMotion("reduce")]:{animationName:gf,animationIterationCount:"infinite",animationDuration:"4s",animationDelay:"0.5s"}}),bounce:(0,Ye.css)({textAlign:"center",[F.transitions.handleMotion("no-preference")]:{animationName:nu,animationDuration:"0.9s",animationIterationCount:"infinite"}}),logo:(0,Ye.css)({display:"inline-block",[F.transitions.handleMotion("no-preference")]:{animationName:au,animationDuration:"0.9s",animationIterationCount:"infinite"},width:"60px",height:"60px"})});function vf(){const F=(0,mt.of)(yf);return(0,I.jsx)("div",{className:F.loadingPage,children:(0,I.jsx)(ff,{})})}const yf=F=>({loadingPage:(0,Ye.css)({backgroundColor:F.colors.background.primary,flex:1,flexDrection:"column",display:"flex",justifyContent:"center",alignItems:"center"})});function xf(F){const{chrome:G,keybindings:k}=(0,mr.Il)();return G.setMatchedRoute(F.route),(0,l.useLayoutEffect)(()=>{k.clearAndInitGlobalBindings(F.route)},[k,F.route]),(0,l.useEffect)(()=>(su(F.route),ru(),(0,C.Lc)("GrafanaRoute",!1,"Mounted",F.route),()=>{(0,C.Lc)("GrafanaRoute",!1,"Unmounted",F.route),su(F.route,!0)}),[]),(0,l.useEffect)(()=>{ru(),(0,ja.Jy)(),(0,C.Lc)("GrafanaRoute",!1,"Updated",F)}),(0,C.Lc)("GrafanaRoute",!1,"Rendered",F.route),(0,I.jsx)(gi.tH,{dependencies:[F.route],children:({error:re,errorInfo:ue})=>re?(0,I.jsx)(df,{error:re,errorInfo:ue}):(0,I.jsx)(l.Suspense,{fallback:(0,I.jsx)(vf,{}),children:(0,I.jsx)(F.route.component,{...F,queryParams:(0,C.SE)(F.location.search)})})})}function Ef({route:F}){const G=(0,Pa.zy)(),k=F.roles?F.roles():[];return k?.length&&!k.some(re=>Gn.TP.hasRole(re))?(0,I.jsx)(Pa.C5,{replace:!0,to:"/"}):(0,I.jsx)(xf,{route:F,location:G})}function Pf(F){return F.pageClass?F.pageClass.split(" "):[]}function su(F,G=!1){for(const k of Pf(F))G?document.body.classList.remove(k):document.body.classList.add(k)}function ru(){document.body.classList.remove("sidemenu-open--xs");const F=document.getElementById("tooltip");F?.parentElement?.removeChild(F);const G=document.querySelectorAll(".tooltip");for(let k=0;k<G.length;k++){const re=G[k];re.parentElement?.removeChild(re)}}var bf=e(6007),Df=e(90382),td=e(33184),ou=e(65240);class co extends l.PureComponent{constructor(){super(...arguments),this.styles=Cf(X.$.theme2),this.state={},this.initListener=()=>{const G=(0,td.oF)();G&&(this.subscription=G.getConnectionState().subscribe({next:k=>{this.setState({show:!k})}}))}}componentDidMount(){}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}render(){const{show:G}=this.state;return G?!Gn.TP.isSignedIn||!X.$.liveEnabled||Gn.TP.user.orgRole===Df.X.None?null:(0,I.jsx)(za.F,{severity:"warning",className:this.styles.warn,title:(0,d.t)("live.live-connection-warning.title-connection-to-server-is-lost","Connection to server is lost...")}):null}}const Cf=(0,ou.N)(F=>({warn:(0,Ye.css)({position:"fixed",bottom:0,left:"50%",transform:"translate(-50%)",maxWidth:"400px",zIndex:F.zIndex.portal,cursor:"wait"})}));var Pi=e(28337),Tf=e(63629),Gl=e(69896),ds=e(85618);const Mf="scope.grafana.app",Sf="v0alpha1",Of=(0,ds.Ge)(),Hl=`/apis/${Mf}/${Sf}/namespaces/${Of}`;class nd{constructor(){this.fetchDashboards=async G=>{try{return(await(0,E.AI)().get(Hl+"/find/scope_dashboard_bindings",{scope:G}))?.items??[]}catch{return[]}},this.fetchScopeNavigations=async G=>{try{return(await(0,E.AI)().get(Hl+"/find/scope_navigations",{scope:G}))?.items??[]}catch{return[]}}}async fetchScope(G){try{return await(0,E.AI)().get(Hl+`/scopes/${G}`)}catch(k){console.error(k);return}}async fetchMultipleScopes(G){return(await Promise.all(G.map(re=>this.fetchScope(re)))).filter(re=>re!==void 0)}async fetchNodes(G){const k=G.limit??1e3;if(!(0<k&&k<=1e4))throw new Error("Limit must be between 1 and 10000");try{return(await(0,E.AI)().get(Hl+"/find/scope_node_children",{parent:G.parent,query:G.query,limit:k}))?.items??[]}catch{return[]}}}var bi=e(49426),If=e(49510),ad=e(41900);class Rf{constructor(G,k,re){this.selectorService=G,this.dashboardsService=k,this.locationService=re,this.subscriptions=[],this.updateState=ge=>{this._state.next({...this._state.getValue(),...ge})},this.changeScopes=ge=>this.selectorService.changeScopes(ge),this.setReadOnly=ge=>{this.state.readOnly!==ge&&this.updateState({readOnly:ge}),ge&&this.selectorService.state.opened&&this.selectorService.closeAndReset()},this.setEnabled=ge=>{this.state.enabled!==ge&&(this.updateState({enabled:ge}),ge&&this.locationService.partial({scopes:this.selectorService.state.appliedScopes.map(Pe=>Pe.scopeId)},!0))},this._state=new bi.t({enabled:!1,readOnly:!1}),this._stateObservable=new bi.t({...this._state.getValue(),value:this.selectorService.state.appliedScopes.map(ge=>this.selectorService.state.scopes[ge.scopeId]).filter(ge=>ge),loading:this.selectorService.state.loading,drawerOpened:this.dashboardsService.state.drawerOpened}),this.subscriptions.push((0,If.z)([this._state.asObservable(),this.getSelectorServiceStateObservable(),this.getDashboardsServiceStateObservable()]).pipe((0,oa.T)(([ge,Pe,Ae])=>({...ge,value:Pe.selectedScopes,loading:Pe.loading,drawerOpened:Ae.drawerOpened}))).subscribe(this._stateObservable));const ue=new URLSearchParams(re.getLocation().search);this.changeScopes(ue.getAll("scopes")),this.subscriptions.push(re.getLocationObservable().subscribe(ge=>{if(!this.state.enabled)return;const Ae=new URLSearchParams(ge.search).getAll("scopes");Ae.length&&this.changeScopes(Ae)})),this.subscriptions.push(G.subscribeToState((ge,Pe)=>{const Ae=Pe.appliedScopes.map(qe=>qe.scopeId),We=ge.appliedScopes.map(qe=>qe.scopeId);(0,J.isEqual)(Ae,We)||this.locationService.partial({scopes:We},!0)}))}get state(){return this._stateObservable.value}get stateObservable(){return this._stateObservable}getSelectorServiceStateObservable(){return this.selectorService.stateObservable.pipe((0,oa.T)(G=>({selectedScopes:G.appliedScopes.map(k=>G.scopes[k.scopeId]).filter(k=>k),loading:G.loading})),(0,ad.F)((G,k)=>G.loading===k.loading&&(0,J.isEqual)(G.selectedScopes,k.selectedScopes)))}getDashboardsServiceStateObservable(){return this.dashboardsService.stateObservable.pipe((0,ad.F)((G,k)=>G.drawerOpened===k.drawerOpened))}cleanUp(){for(const G of this.subscriptions)G.unsubscribe()}}var sd=e(97256);class Ko{constructor(G){this.subscribeToState=k=>this._state.pipe((0,sd.J)()).subscribe(([re,ue])=>k(ue,re)),this.updateState=k=>{this._state.next(Object.freeze({...this.state,...k}))},this._state=new bi.t(Object.freeze(G))}get state(){return this._state.getValue()}get stateObservable(){return this._state.asObservable()}}class Af extends Ko{constructor(G){super({drawerOpened:!1,dashboards:[],scopeNavigations:[],filteredFolders:{},folders:{},forScopeNames:[],loading:!1,searchQuery:""}),this.apiClient=G,this.updateFolder=(k,re)=>{let ue={...this.state.folders},ge={...this.state.filteredFolders},Pe=ue,Ae=ge;for(let rt=0;rt<k.length-1;rt++)Pe=Pe[k[rt]].folders,Ae=Ae[k[rt]].folders;const We=k[k.length-1],qe=Pe[We],et=Ae[We];qe.expanded=re,et.expanded=re,this.updateState({folders:ue,filteredFolders:ge})},this.changeSearchQuery=k=>{k=k??"";const re=this.filterFolders(this.state.folders,k);this.updateState({filteredFolders:re,searchQuery:k})},this.clearSearchQuery=()=>{this.changeSearchQuery("")},this.fetchDashboards=async k=>{if((0,J.isEqual)(this.state.forScopeNames,k))return;if(k.length===0){this.updateState({dashboards:[],filteredFolders:{},folders:{},forScopeNames:[],loading:!1,drawerOpened:!1});return}this.updateState({forScopeNames:k,loading:!0});const ue=await(X.$.featureToggles.useScopesNavigationEndpoint?this.apiClient.fetchScopeNavigations:this.apiClient.fetchDashboards)(k);if((0,J.isEqual)(this.state.forScopeNames,k)){const ge=this.groupSuggestedItems(ue),Pe=this.filterFolders(ge,this.state.searchQuery);this.updateState({scopeNavigations:ue,filteredFolders:Pe,folders:ge,loading:!1,drawerOpened:ue.length>0})}},this.groupSuggestedItems=k=>{const re=C.Ny.getLocation().pathname,ue=re.startsWith("/d/"),ge={"":{title:"",expanded:!0,folders:{},suggestedNavigations:{}}};return k.forEach(Pe=>{const Ae=ge[""],We=Pe.status.groups??[];let qe=!1;if(ue&&"dashboard"in Pe.spec){const rt=re.split("/")[2];qe=Pe.spec.dashboard===rt}"url"in Pe.spec&&(qe=re.startsWith(Pe.spec.url)),We.forEach(rt=>{const lt=!!Ae.folders[rt],pt=lt&&Ae.folders[rt].expanded;rt&&!lt&&(Ae.folders[rt]={title:rt,expanded:qe,folders:{},suggestedNavigations:{}}),rt&&qe&&!pt&&(Ae.folders[rt].expanded=!0)}),(We.length>0?We.map(rt=>rt===""?Ae.suggestedNavigations:Ae.folders[rt].suggestedNavigations):[Ae.suggestedNavigations]).forEach(rt=>{"dashboard"in Pe.spec&&"dashboardTitle"in Pe.status&&!rt[Pe.spec.dashboard]?rt[Pe.spec.dashboard]={url:"/d/"+Pe.spec.dashboard,title:Pe.status.dashboardTitle,id:Pe.spec.dashboard}:"url"in Pe.spec&&"title"in Pe.status&&!rt[Pe.spec.url]&&(rt[Pe.spec.url]={title:Pe.status.title||Pe.metadata.name,url:Pe.spec.url,id:Pe.metadata.name})})}),ge},this.filterFolders=(k,re)=>(re=(re??"").toLowerCase(),Object.entries(k).reduce((ue,[ge,Pe])=>{if(Pe.title.toLowerCase().includes(re))return ue[ge]={...Pe,expanded:!0},ue;const Ae=this.filterFolders(Pe.folders,re),We=Object.entries(Pe.suggestedNavigations).filter(([qe,et])=>et.title.toLowerCase().includes(re));return(Object.keys(Ae).length>0||We.length>0)&&(ue[ge]={...Pe,expanded:!0,folders:Ae,suggestedNavigations:Object.fromEntries(We)}),ue},{})),this.toggleDrawer=()=>this.updateState({drawerOpened:!this.state.drawerOpened})}}var zr=e(78012);function iu(F){const G={...F};if(G.expanded=!1,G.children){G.children={...G.children};for(const k of Object.keys(G.children))G.children[k]=iu(G.children[k])}return G}function lu(F,G){let k={...F},re=k;re.expanded=!0;const ue=G.slice(1);for(const ge of ue){const Pe=re.children?.[ge];if(!Pe)throw new Error(`Node ${ge} not found in tree`);const Ae={...Pe};re.children={...re.children},re.children[ge]=Ae,Ae.expanded=!0,re=Ae}return k}function cu(F){return F.spec.nodeType==="container"}function rd(F){return F.spec.linkType==="scope"}function Ql(F,G){if(F==="")return[""];const k=[F];let re=G[F]?.spec.parentName;for(;re;)k.unshift(re),re=G[re]?.spec.parentName;return k.unshift(""),k}function od(F,G,k){if(G.length<1)return F;const re={...F};let ue=re;if(G.length===1&&G[0]==="")return k(ue),re;for(const ge of G.slice(1)){if(!ue.children?.[ge])return re;ue.children={...ue.children},ue.children[ge]={...ue.children[ge]},ue=ue.children[ge]}return k(ue),re}function du(F,G){if(G.length<1)return;if(G.length===1&&G[0]==="")return F;let k=F;for(const re of G.slice(1))if(k=k.children?.[re],!k)return;return k}const uu="grafana.scopes.recent";class kl extends Ko{constructor(G,k,re=zr.M){super({loading:!1,opened:!1,loadingNodeName:void 0,nodes:{},scopes:{},selectedScopes:[],appliedScopes:[],tree:{expanded:!1,scopeNodeId:"",query:"",children:void 0}}),this.apiClient=G,this.dashboardsService=k,this.store=re,this.expandOrFilterNode=async(ue,ge)=>{const Pe=Ql(ue,this.state.nodes),Ae=du(this.state.tree,Pe);if(Ae)if(Ae.scopeNodeId===""||cu(this.state.nodes[Ae.scopeNodeId])){if(!Ae.expanded||Ae.query!==ge){const We=od(this.state.tree,Pe,qe=>{qe.expanded=!0,qe.query=ge||""});this.updateState({tree:We}),await this.loadNodeChildren(Pe,Ae,ge)}}else throw new Error(`Trying to expand node at id ${ue} that is not expandable`);else throw new Error(`Trying to expand node at id ${ue} not found`)},this.collapseNode=async ue=>{const ge=Ql(ue,this.state.nodes);if(du(this.state.tree,ge)){const Ae=od(this.state.tree,ge,We=>{We.expanded=!1,We.query=""});this.updateState({tree:Ae})}else throw new Error(`Trying to collapse node at path or id ${ue} not found`)},this.loadNodeChildren=async(ue,ge,Pe)=>{this.updateState({loadingNodeName:ge.scopeNodeId});const Ae=await this.apiClient.fetchNodes({parent:ge.scopeNodeId,query:Pe}),We={...this.state.nodes};for(const et of Ae)We[et.metadata.name]=et;const qe=od(this.state.tree,ue,et=>{et.children={};for(const rt of Ae)et.children[rt.metadata.name]={expanded:!1,scopeNodeId:rt.metadata.name,query:"",children:void 0}});this.updateState({tree:qe,nodes:We,loadingNodeName:void 0})},this.selectScope=async ue=>{let ge=this.state.nodes[ue];if(!rd(ge))throw new Error(`Trying to select node with id ${ue} that is not selectable`);if(!ge.spec.linkId)throw new Error(`Trying to select node id ${ue} that does not have a linkId`);this.apiClient.fetchScope(ge.spec.linkId).then(qe=>{qe&&this.updateState({scopes:{...this.state.scopes,[qe.metadata.name]:qe}})});const Pe=this.state.nodes[ge.spec.parentName],Ae={scopeId:ge.spec.linkId,scopeNodeId:ge.metadata.name};!(this.state.selectedScopes[0]?.scopeNodeId&&this.state.nodes[this.state.selectedScopes[0].scopeNodeId].spec.parentName===ge.spec.parentName)||Pe?.spec.disableMultiSelect||this.state.selectedScopes.length===0?this.updateState({selectedScopes:[Ae]}):this.updateState({selectedScopes:[...this.state.selectedScopes,Ae]})},this.deselectScope=async ue=>{const ge=this.state.nodes[ue],Pe=ge?We=>We.scopeNodeId!==ge.metadata.name&&We.scopeId!==ge.spec.linkId:We=>We.scopeNodeId!==ue&&We.scopeId!==ue;let Ae=this.state.selectedScopes.filter(Pe);this.updateState({selectedScopes:Ae})},this.updateNode=async(ue,ge,Pe)=>ge?this.expandOrFilterNode(ue,Pe):this.collapseNode(ue),this.changeScopes=ue=>this.applyScopes(ue.map(ge=>({scopeId:ge}))),this.applyScopes=async ue=>{if(!(this.state.appliedScopes.length===ue.length&&this.state.appliedScopes.every(ge=>ue.find(Pe=>ge.scopeId===Pe.scopeId)))&&(this.updateState({appliedScopes:ue,selectedScopes:ue,loading:ue.length>0}),this.dashboardsService.fetchDashboards(ue.map(ge=>ge.scopeId)),ue.length>0)){const ge=await this.apiClient.fetchMultipleScopes(ue.map(Ae=>Ae.scopeId)),Pe={...this.state.scopes};for(const Ae of ge)Pe[Ae.metadata.name]=Ae;this.addRecentScopes(ge),this.updateState({scopes:Pe,loading:!1})}},this.removeAllScopes=()=>this.applyScopes([]),this.addRecentScopes=ue=>{if(ue.length===0)return;const ge=5,Pe=this.getRecentScopes();Pe.unshift(ue),this.store.set(uu,JSON.stringify(Pe.slice(0,ge-1)))},this.getRecentScopes=()=>{const ue=this.store.get(uu);return Lf(ue).filter(Pe=>{if(Pe.length!==this.state.appliedScopes.length)return!0;const Ae=new Set(Pe.map(We=>We.metadata.name));return!this.state.appliedScopes.every(We=>Ae.has(We.scopeId))})},this.open=async()=>{(!this.state.tree?.children||Object.keys(this.state.tree?.children).length===0)&&await this.expandOrFilterNode("");let ue=iu(this.state.tree);if(this.state.selectedScopes.length&&this.state.selectedScopes[0].scopeNodeId){let ge=Ql(this.state.selectedScopes[0].scopeNodeId,this.state.nodes);ge=ge.slice(0,ge.length-1),ue=lu(ue,ge)}this.resetSelection(),this.updateState({tree:ue,opened:!0})},this.closeAndReset=()=>{this.updateState({opened:!1}),this.resetSelection()},this.closeAndApply=()=>(this.updateState({opened:!1}),this.apply()),this.apply=()=>this.applyScopes(this.state.selectedScopes),this.resetSelection=()=>{this.updateState({selectedScopes:[...this.state.appliedScopes]})},this.searchAllNodes=async(ue,ge)=>{const Pe=await this.apiClient.fetchNodes({query:ue,limit:ge}),Ae={...this.state.nodes};for(const We of Pe)Ae[We.metadata.name]=We;return this.updateState({nodes:Ae}),Pe}}}function jf(F){return typeof F=="object"&&F!==null&&"scope"in F&&hu(F.scope)}function hu(F){return typeof F=="object"&&F!==null&&"metadata"in F&&typeof F.metadata=="object"&&F.metadata!==null&&"name"in F.metadata&&"spec"in F}function Lf(F){let G;try{G=JSON.parse(F||"[]")}catch(k){return console.error("Failed to parse recent scopes",k,F),[]}if(!(Array.isArray(G)&&Array.isArray(G[0])))return[];if(jf(G[0]?.[0]))G=G.map(k=>k.map(re=>re.scope));else if(!hu(G[0]?.[0]))return[];return G}const fu=(0,l.createContext)(void 0);function Yl(){return(0,l.useContext)(fu)}function Bf(){const F=new nd,G=new Af(F),k=new kl(F,G);return{scopesService:new Rf(k,G,C.Ny),scopesSelectorService:k,scopesDashboardsService:G,client:F}}const Uf=({children:F,services:G})=>{const k=(0,l.useMemo)(()=>G??Bf(),[G]);return(0,l.useEffect)(()=>()=>{k.scopesService.cleanUp()},[k]),(0,I.jsx)(Gl.j.Provider,{value:X.$.featureToggles.scopeFilters?k.scopesService:void 0,children:(0,I.jsx)(fu.Provider,{value:X.$.featureToggles.scopeFilters?k:void 0,children:F})})};var pu=e(96014),gu=e(35557),mu=e(8515),vu=e(46942),Wf=e.n(vu),Nf=e(33149),Kf=e(45897),Jl=e(51702),vr=e(29043),id=e(18828),yu=e(42211),xu=e(93225),wf=e(47327),ld=e(50201),Eu=e(65178),Ff=e(35822);const Xl=0,Vf=F=>{const G=l.useRef(null),k=l.useRef(null),re=l.useRef(F.items);re.current=F.items;const ue=(0,Ff.useVirtual)({size:re.current.length,parentRef:k}),{query:ge,search:Pe,currentRootActionId:Ae,activeIndex:We,options:qe}=(0,Ra.useKBar)(pt=>({search:pt.searchQuery,currentRootActionId:pt.currentRootActionId,activeIndex:pt.activeIndex}));l.useEffect(()=>{const pt=ht=>{ht.key==="ArrowUp"||ht.ctrlKey&&ht.key==="p"?(ht.preventDefault(),ge.setActiveIndex(Ct=>{let Wt=Ct>Xl?Ct-1:Ct;if(typeof re.current[Wt]=="string"){if(Wt===0)return Ct;Wt-=1}return Wt})):ht.key==="ArrowDown"||ht.ctrlKey&&ht.key==="n"?(ht.preventDefault(),ge.setActiveIndex(Ct=>{let Wt=Ct<re.current.length-1?Ct+1:Ct;if(typeof re.current[Wt]=="string"){if(Wt===re.current.length-1)return Ct;Wt+=1}return Wt})):ht.key==="Enter"&&(ht.metaKey||ht.ctrlKey)?(ht.preventDefault(),G.current instanceof HTMLAnchorElement?(window.open(G.current.href,"_blank","noopener,noreferrer"),ge.toggle()):G.current?.click()):ht.key==="Enter"&&!ht.metaKey&&!ht.ctrlKey&&(ht.preventDefault(),G.current?.click())};return window.addEventListener("keydown",pt),()=>window.removeEventListener("keydown",pt)},[ge]);const{scrollToIndex:et}=ue;l.useEffect(()=>{et(We,{align:We<=1?"end":"auto"})},[We,et]),l.useEffect(()=>{ge.setActiveIndex(typeof F.items[Xl]=="string"?Xl+1:Xl)},[Pe,Ae,F.items,ge]);const rt=l.useCallback((pt,ht)=>{if(typeof ht=="string")return;const Ct=ht.url;ht.command?(ht.command.perform(ht),(!ht.id.startsWith("scopes/")||ht.id==="scopes/apply")&&ge.toggle()):Ct?pt.ctrlKey||pt.metaKey||pt.shiftKey||ge.toggle():(ge.setSearch(""),ge.setCurrentRootAction(ht.id)),qe.callbacks?.onSelectAction?.(ht)},[ge,qe]),lt=(0,Eu.usePointerMovedSinceMount)();return(0,I.jsx)("div",{ref:k,style:{maxHeight:F.maxHeight||400,position:"relative",overflow:"auto"},children:(0,I.jsx)("div",{role:"listbox",id:Ra.KBAR_LISTBOX,style:{height:`${ue.totalSize}px`,width:"100%"},children:ue.virtualItems.map(pt=>{const ht=re.current[pt.index],{target:Ct,url:Wt}=ht,en=typeof ht!="string"&&{onPointerMove:()=>lt&&We!==pt.index&&ge.setActiveIndex(pt.index),onPointerDown:()=>ge.setActiveIndex(pt.index),onClick:gn=>rt(gn,ht)},on=pt.index===We,vn={id:(0,Ra.getListboxItemId)(pt.index),role:"option","aria-selected":on,style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${pt.start}px)`},...en},an=l.cloneElement(F.onRender({item:ht,active:on}),{ref:pt.measureRef});return Wt?(0,I.jsx)("a",{href:typeof Wt=="function"?Wt(Pe):Wt,target:Ct,ref:on?G:null,...vn,children:an},pt.index):(0,I.jsx)("div",{ref:on?G:null,...vn,children:an},pt.index)})})})},$f="kbar-listbox",zf=F=>`kbar-listbox-item-${F}`;function _f(F){const{query:G,search:k,actions:re,currentRootActionId:ue,activeIndex:ge,showing:Pe,options:Ae}=(0,Ra.useKBar)(ht=>({search:ht.searchQuery,currentRootActionId:ht.currentRootActionId,actions:ht.actions,activeIndex:ht.activeIndex,showing:ht.visualState===Ra.VisualState.showing})),[We,qe]=l.useState(k);l.useEffect(()=>{G.setSearch(We)},[We,G]);const{defaultPlaceholder:et,...rt}=F;l.useEffect(()=>(G.setSearch(""),G.getInput().focus(),qe(""),()=>G.setSearch("")),[ue,G]);const lt=et??"Type a command or search\u2026",pt=(0,mt.of)(Pu);return(0,I.jsx)("input",{...rt,className:pt.input,ref:G.inputRefSetter,autoFocus:!0,autoComplete:"off",role:"combobox",spellCheck:"false","aria-expanded":Pe,"aria-controls":$f,"aria-activedescendant":zf(ge),value:We,placeholder:lt,onChange:ht=>{F.onChange?.(ht),qe(ht.target.value),Ae?.callbacks?.onQueryChange?.(ht.target.value)},onKeyDown:ht=>{if(F.onKeyDown?.(ht),ue&&!k&&ht.key==="Backspace"){const Ct=re[ue].parent;G.setCurrentRootAction(Ct)}}})}const Pu=F=>({input:(0,Ye.css)({label:"kbar-search-input",fontSize:F.typography.body.fontSize,fontWeight:F.typography.fontWeightMedium,lineHeight:F.typography.body.lineHeight,color:F.colors.text.secondary,width:"100%",outline:"none",paddingLeft:0})}),cd=l.forwardRef(({action:F,active:G,currentRootActionId:k},re)=>{const ue=l.useMemo(()=>{if(!k)return F.ancestors;const We=F.ancestors.findIndex(qe=>qe.id===k);return F.ancestors.slice(We+1)},[F.ancestors,k]),ge=(0,mt.of)(Gf);let Pe=F.name;const Ae=We=>!!(We.command?.perform||We.url);return F.children.length&&!Ae(F)&&!Pe.endsWith("...")&&(Pe+="..."),(0,I.jsx)("div",{ref:re,className:(0,Ye.cx)(ge.row,G&&ge.activeRow),children:(0,I.jsxs)("div",{className:ge.actionContainer,children:[F.icon,(0,I.jsxs)("div",{className:ge.textContainer,children:[ue.map(We=>(0,I.jsx)(l.Fragment,{children:!Ae(We)&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("span",{className:ge.breadcrumbAncestor,children:We.name}),(0,I.jsx)("span",{className:ge.breadcrumbSeparator,children:"\u203A"})]})},We.id)),(0,I.jsx)("span",{children:Pe})]}),F.subtitle&&(0,I.jsx)("span",{className:ge.subtitleText,children:F.subtitle})]})})});cd.displayName="ResultItem";const Gf=F=>({row:(0,Ye.css)({padding:F.spacing(1,2),display:"flex",alightItems:"center",justifyContent:"space-between",cursor:"pointer",position:"relative",borderRadius:F.shape.radius.default,margin:F.spacing(0,1)}),activeRow:(0,Ye.css)({color:F.colors.text.maxContrast,background:F.colors.emphasize(F.colors.background.primary,.03),"&:before":{display:"block",content:'" "',position:"absolute",left:0,top:0,bottom:0,width:F.spacing(.5),borderRadius:F.shape.radius.default,backgroundImage:F.colors.gradients.brandVertical}}),actionContainer:(0,Ye.css)({display:"flex",gap:F.spacing(1),alignItems:"baseline",fontSize:F.typography.fontSize,width:"100%"}),textContainer:(0,Ye.css)({display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),breadcrumbAncestor:(0,Ye.css)({color:F.colors.text.secondary}),breadcrumbSeparator:(0,Ye.css)({color:F.colors.text.secondary,marginLeft:F.spacing(1),marginRight:F.spacing(1)}),subtitleText:(0,Ye.css)({...F.typography.bodySmall,color:F.colors.text.secondary,display:"block",flexBasis:"20%",flexGrow:1,flexShrink:0,maxWidth:"fit-content",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})});var bu=e(76459),dd=e.n(bu),Hf=e(67020),Du=e(55860);const ud=8,Qf=7,kf=6,Cu=5,Tu=4,hd=3,Yf=2,Jf=1,Mu=100,fd=5,Xf=dd()(qf,200);async function Zf(){if(!Gn.TP.user.isSignedIn)return[];const F=(await Hf.A.getDashboardOpened()).slice(0,fd),k=(await(0,Du.S)().search({kind:["dashboard"],limit:fd,uid:F})).view.toArray();return k.sort((ue,ge)=>{const Pe=F.indexOf(ue.uid),Ae=F.indexOf(ge.uid);return Pe-Ae}),k.map(ue=>{const{url:ge,name:Pe}=ue;return{id:`recent-dashboards${ge}`,name:`${Pe}`,section:(0,d.t)("command-palette.section.recent-dashboards","Recent dashboards"),priority:kf,url:ge}})}async function qf(F){if(F.length===0||!Gn.TP.user.isSignedIn&&!X.$.bootData.settings.anonymousEnabled)return[];const G=await(0,Du.S)().search({kind:["dashboard","folder"],query:F,limit:Mu});return G.view.map(re=>{const{url:ue,name:ge,kind:Pe,location:Ae}=re;return{id:`go/${Pe}${ue}`,name:`${ge}`,section:Pe==="dashboard"?(0,d.t)("command-palette.section.dashboard-search-results","Dashboards"):(0,d.t)("command-palette.section.folder-search-results","Folders"),priority:Jf,url:ue,subtitle:G.view.dataFrame.meta?.custom?.locationInfo[Ae]?.name}})}function Su({searchQuery:F,show:G}){const[k,re]=(0,l.useState)([]),[ue,ge]=(0,l.useState)(!1),Pe=(0,l.useRef)(0);return(0,l.useEffect)(()=>{const Ae=Date.now();G&&F.length>0?(ge(!0),Xf(F).then(We=>{Ae>Pe.current&&(re(We),ge(!1),Pe.current=Ae)})):(re([]),ge(!1),Pe.current=Ae)},[G,F]),{searchResults:k,isFetchingSearchResults:ue}}var pd=e(9628);function Ou({selectedScopes:F,isDirty:G,apply:k,deselectScope:re,scopes:ue,nodes:ge}){const Pe=(0,mt.of)(Iu);return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(kt.B,{alignItems:"center",children:[(0,I.jsx)("span",{className:Pe.scopesText,children:(0,I.jsx)(d.x6,{i18nKey:"command-palette.scopes.selected-scopes-label",children:"Scopes: "})}),(0,I.jsx)(kt.B,{wrap:"wrap",children:F?.map(Ae=>{const We=ue[Ae.scopeId]?.spec.title||Ae.scopeNodeId&&ge[Ae.scopeNodeId]?.spec.title||Ae.scopeId;return(0,I.jsx)(bn.m,{selected:!0,icon:"times",label:We,onClick:()=>{re(Ae.scopeNodeId||Ae.scopeId)}},Ae.scopeId)})})]}),G&&(0,I.jsxs)(ve.$n,{onClick:()=>{k()},children:[(0,I.jsx)(d.x6,{i18nKey:"command-palette.scopes.apply-selected-scopes",children:"Apply"}),"\xA0",(0,I.jsx)(Ta.E,{variant:"bodySmall",children:`${(0,pd.gn)()}+\u21B5`})]})]})}const Iu=F=>({scopesText:(0,Ye.css)({label:"scopesText",fontSize:F.typography.bodySmall.fontSize,fontWeight:F.typography.fontWeightMedium,lineHeight:F.typography.bodySmall.lineHeight,color:F.colors.text.secondary}),selectedScope:(0,Ye.css)({background:F.colors.background.secondary,borderRadius:F.shape.radius.default,padding:F.spacing(0,.5),fontSize:F.typography.bodySmall.fontSize,fontWeight:F.typography.fontWeightMedium,lineHeight:F.typography.bodySmall.lineHeight,color:F.colors.text.secondary,display:"inline-flex",alignItems:"center",position:"relative",border:`1px solid ${F.colors.background.secondary}`,whiteSpace:"nowrap",marginRight:F.spacing(.5)})});function Ru(){const F=Yl();if(!(X.$.featureToggles.scopeFilters&&F))return[];const{scopesSelectorService:G}=F;return G.getRecentScopes().map(re=>({id:re.map(ue=>ue.spec.title).join(", "),name:re.map(ue=>ue.spec.title).join(", "),section:(0,d.t)("command-palette.section.recent-scopes","Recent scopes"),priority:Qf,perform:()=>{G.changeScopes(re.map(ue=>ue.metadata.name))}}))}var Tr=e(24120),Di=e(88483);function gd(){const F=Yl();if(!F)return{updateNode:()=>{},selectScope:()=>{},resetSelection:()=>{},searchAllNodes:()=>Promise.resolve([]),apply:()=>{},deselectScope:()=>{},nodes:{},scopes:{},selectedScopes:[],appliedScopes:[],tree:{scopeNodeId:"",expanded:!1,query:""}};const{updateNode:G,selectScope:k,resetSelection:re,searchAllNodes:ue,deselectScope:ge,apply:Pe}=F.scopesSelectorService,Ae=(0,Tr.A)(F.scopesSelectorService.stateObservable??new Di.c,F.scopesSelectorService.state);return{updateNode:G,selectScope:k,resetSelection:re,searchAllNodes:ue,apply:Pe,deselectScope:ge,...Ae}}function Au(){return{id:"scopes",section:(0,d.t)("command-palette.action.scopes","Scopes"),name:(0,d.t)("command-palette.action.scopes","Scopes"),keywords:"scopes filters",priority:ud}}function ep(F,G,k,re){const ue=[Au()],ge=(Pe,Ae)=>{if(!(!Pe.children||Object.keys(Pe.children).length===0))for(const We of Object.keys(Pe.children)){const qe=Pe.children[We],et=F[We],rt=k.some(pt=>pt.scopeNodeId?pt.scopeNodeId===et.metadata.name:pt.scopeId===et.spec.linkId);if(et.spec.nodeType==="leaf"&&rt)continue;let lt=ju(et,re,Ae);ue.push(lt),ge(qe,lt.id)}};return ge(G,"scopes"),ue}function ju(F,G,k){let re;return k?(re={id:`${k}/${F.metadata.name}`,name:F.spec.title,keywords:`${F.spec.title} ${F.metadata.name}`,priority:ud,parent:k},F.spec.nodeType==="leaf"&&(re.perform=()=>{G(F.metadata.name)})):re={id:`scopes/${F.metadata.name}`,name:F.spec.title,keywords:`${F.spec.title} ${F.metadata.name}`,priority:ud,section:(0,d.t)("command-palette.action.scopes","Scopes"),subtitle:F.spec.parentName,perform:()=>{G(F.metadata.name)}},re}function tp(){const F=Ru();(0,Ra.useRegisterActions)(F,[F])}function md(F,G,k){if(!X.$.featureToggles.scopeFilters)return{scopesRow:void 0};const re=ap(F,k),ue=_r(F,k),ge=re||ue;return(0,Ra.useRegisterActions)(ge,[ge]),np(G)}function _r(F,G){const{updateNode:k,selectScope:re,resetSelection:ue,nodes:ge,tree:Pe,selectedScopes:Ae}=gd();return(0,l.useEffect)(()=>(k("",!0,""),ue(),()=>{ue()}),[k,ue]),(0,l.useEffect)(()=>{const We=!G||G==="scopes"?"":(0,J.last)(G.split("/"));k(We,!0,F)},[k,F,G]),(0,l.useMemo)(()=>ep(ge,Pe,Ae,re),[ge,Pe,Ae,re])}function np(F){const{nodes:G,scopes:k,selectedScopes:re,appliedScopes:ue,deselectScope:ge,apply:Pe}=gd(),Ae=ue.map(qe=>qe.scopeId).sort().join("")!==re.map(qe=>qe.scopeId).sort().join(""),We=(0,l.useCallback)(()=>{Pe(),F()},[Pe,F]);return(0,l.useEffect)(()=>{function qe(et){Ae&&et.key==="Enter"&&et.metaKey&&(et.preventDefault(),We())}return window.addEventListener("keydown",qe),()=>window.removeEventListener("keydown",qe)},[Ae,We]),{scopesRow:Ae||re?.length?(0,I.jsx)(Ou,{nodes:G,scopes:k,deselectScope:ge,selectedScopes:re,apply:We,isDirty:Ae}):null}}function ap(F,G){const{selectScope:k,searchAllNodes:re}=gd(),[ue,ge]=(0,l.useState)(void 0),Pe=(0,l.useRef)();return(0,l.useEffect)(()=>{(!G||G==="scopes")&&F&&X.$.featureToggles.scopeSearchAllLevels?(Pe.current=F,re(F,10).then(Ae=>{if(Pe.current===F){const We=Ae.filter(et=>et.spec.nodeType==="leaf"),qe=[Au()];for(const et of We)qe.push(ju(et,k,G||void 0));ge(qe)}})):(Pe.current=void 0,ge(void 0))},[re,F,G,k]),ue}var yr=e(30362),Lu=e(79776);const uo=Y.$W.featureToggles.inviteUserExperimental&&Y.$W.externalUserMngLinkUrl&&Gn.TP.hasPermission(yn.w.OrgUsersAdd),Zl=(F,G)=>{(0,ja.rR)("invite_user_button_clicked",{placement:F});const k=(0,Lu.o)(G);window.open(k.toString(),"_blank")};var Ci=e(44410),Ti=e(64762),sp=e(69738);const Bu="grafana.dev.mockApi",Uu=()=>vr.A.getBool(Bu,!1),rp=()=>{const F=Uu();store.set(Bu,String(!F));const G=F?"Disabling":"Enabling";sendAppNotification(`${G} Mock API`,"Reloading...",AppNotificationSeverity.Info),setTimeout(()=>{window.location.reload()},200)},Wu=async()=>{const F=Uu()},op=()=>{},Yg=async()=>{const F=new PreferencesService("user"),G=await F.load(),k=G.language===PSEUDO_LOCALE,re=k?"Disabling":"Enabling";sendAppNotification(`${re} pseudo locale`,"Reloading...",AppNotificationSeverity.Info),await F.update({...G,language:k?DEFAULT_LANGUAGE:PSEUDO_LOCALE}),setTimeout(()=>{window.location.reload()},200)};var nr=e(52763);function Nu(F){return"navModel."+(F.id??F.url??F.text??F.subTitle)}function Ku(F,G=[]){const k=[];for(let re of F){re.id==="help"&&(re=(0,yr.CS)({...re}),delete re.url);const{url:ue,target:ge,text:Pe,isCreateAction:Ae,children:We,onClick:qe,keywords:et}=re,rt=!!We?.length;if(!(ue||qe||rt))continue;let lt=ue;ue&&(re.id==="connections-add-new-connection"||re.id==="standalone-plugin-page-/connections/add-new-connection")&&(lt=en=>{const on=et?.find(vn=>vn.toLowerCase().includes(en.toLowerCase()));return on?`${ue}?search=${on}`:ue});const pt=Ae?(0,d.t)("command-palette.section.actions","Actions"):(0,d.t)("command-palette.section.pages","Pages"),ht=Ae?Cu:Tu,Ct=G.map(en=>en.text).join(" > "),Wt={id:Nu(re),name:Pe,section:pt,url:lt,target:ge,parent:G.length>0&&!Ae?Nu(G[G.length-1]):void 0,perform:qe,keywords:et?.join(" "),priority:ht,subtitle:Ae?void 0:Ct};if(k.push(Wt),We?.length){const en=Ku(We,[...G,re]);k.push(...en)}}return k}function ip(){return[{id:"preferences/theme",name:(0,d.t)("command-palette.action.change-theme","Change theme"),keywords:"interface color dark light",section:(0,d.t)("command-palette.section.preferences","Preferences"),priority:hd},{id:"preferences/dark-theme",name:(0,d.t)("command-palette.action.dark-theme","Dark"),keywords:"dark theme",perform:()=>(0,Ci.K)("dark"),parent:"preferences/theme",priority:hd},{id:"preferences/light-theme",name:(0,d.t)("command-palette.action.light-theme","Light"),keywords:"light theme",perform:()=>(0,Ci.K)("light"),parent:"preferences/theme",priority:hd}]}function wu(){const F=(0,nr.d4)(G=>G.navBarTree);return(0,l.useMemo)(()=>{const G=Ku(F);return uo&&G.push({id:"invite-user",name:(0,d.t)("navigation.invite-user.invite-new-member-button","Invite new member"),section:(0,d.t)("command-palette.section.actions","Actions"),priority:Cu,perform:()=>{Zl("command_palette_actions","invite-user-command-palette")}}),[...ip(),...G]},[F])}var Mi=e(54092);const lp={};function Fu(){const{links:F}=(0,S.U)({extensionPointId:Mi.S.CommandPalette,context:lp,limitPerPlugin:3});return(0,l.useMemo)(()=>F.map(G=>({section:G.category??"Extensions",priority:Yf,id:G.id,name:G.title,target:G.path,perform:()=>G.onClick&&G.onClick()})),[F])}function cp(){const F=Fu(),G=wu(),k=(0,l.useMemo)(()=>[...G,...F],[G,F]);(0,Ra.useRegisterActions)(k,[k])}function dp(){const[F,G]=(0,l.useState)([]);(0,l.useEffect)(()=>{Zf().then(k=>G(k)).catch(k=>{console.error("Error loading recent dashboard actions",k)})},[]),(0,Ra.useRegisterActions)(F,[F])}var Vu=e(84139);const ql={name:"none",priority:Ra.Priority.NORMAL};function vd(F,G){return G.priority-F.priority}function up(){const{search:F,actions:G,rootActionId:k}=(0,Ra.useKBar)(et=>({search:et.searchQuery,actions:et.actions,rootActionId:et.currentRootActionId})),re=l.useMemo(()=>Object.keys(G).reduce((et,rt)=>{const lt=G[rt];if(!lt.parent&&!k&&et.push(lt),lt.id===k)for(let pt=0;pt<lt.children.length;pt++)et.push(lt.children[pt]);return et},[]).sort(vd),[G,k]),ue=l.useCallback(et=>{let rt=[];for(let lt=0;lt<et.length;lt++)rt.push(et[lt]);return function lt(pt,ht=rt){for(let Ct=0;Ct<pt.length;Ct++)if(pt[Ct].children.length>0){let Wt=pt[Ct].children;for(let en=0;en<Wt.length;en++)ht.push(Wt[en]);lt(pt[Ct].children,ht)}return ht}(et)},[]),ge=!F,Pe=l.useMemo(()=>ge?re:ue(re),[ue,re,ge]),Ae=$u(Pe,F),We=l.useMemo(()=>{let et={},rt=[],lt=[];for(let ht=0;ht<Ae.length;ht++){const Ct=Ae[ht],Wt=Ct.action,en=Ct.score||Ra.Priority.NORMAL,on={name:typeof Wt.section=="string"?Wt.section:Wt.section?.name||ql.name,priority:typeof Wt.section=="string"?en:Wt.section?.priority||0+en};et[on.name]||(et[on.name]=[],rt.push(on)),et[on.name].push({priority:Wt.priority+en,action:Wt})}lt=rt.sort(vd).map(ht=>({name:ht.name,actions:et[ht.name].sort(vd).map(Ct=>Ct.action)}));let pt=[];for(let ht=0;ht<lt.length;ht++){let Ct=lt[ht];Ct.name!==ql.name&&pt.push(Ct.name);for(let Wt=0;Wt<Ct.actions.length;Wt++)pt.push(Ct.actions[Wt])}return pt},[Ae]),qe=l.useMemo(()=>k,[We]);return l.useMemo(()=>({results:We,rootActionId:qe}),[qe,We])}function $u(F,G){const k=fp(),re=l.useMemo(()=>({filtered:F,search:G}),[F,G]),{filtered:ue,search:ge}=(0,Eu.useThrottledValue)(re);return l.useMemo(()=>{if(ge.trim()==="")return ue.map(We=>({score:0,action:We}));const Pe=ue.map(({name:We,keywords:qe})=>`${We} ${qe??""}`.toLowerCase()),Ae=[];if(ge.length>hp){const We=ge.toLowerCase();for(let qe=0;qe<Pe.length;qe++){const rt=Pe[qe].indexOf(We);if(rt>-1){const lt=rt*-1,pt=ue[qe];Ae.push({score:lt,action:pt})}}}else{const We=k.split(ge).length,qe=1/0,et=We<5?4:0,[,rt,lt]=k.search(Pe,ge,et,qe);if(rt&&lt)for(let pt=0;pt<lt.length;pt++){const ht=lt[pt],Ct=lt.length-pt,Wt=ue[rt.idx[ht]];Ae.push({score:Ct,action:Wt})}}return Ae},[ue,ge,k])}const hp=25;function fp(){const F=l.useRef();return F.current||(F.current=new Vu.A({intraMode:0,intraIns:0})),F.current}function pp(){return cp(),(0,I.jsx)(Ra.KBarPortal,{children:(0,I.jsx)(gp,{})})}function gp(){const F=wo(),G=(0,mt.of)(Hs,F),{query:k,searchQuery:re,currentRootActionId:ue}=(0,Ra.useKBar)(lt=>({showing:lt.visualState===Ra.VisualState.showing,searchQuery:lt.searchQuery,currentRootActionId:lt.currentRootActionId}));dp(),tp();const ge=(0,l.useCallback)(()=>k.toggle(),[k]),{scopesRow:Pe}=md(re,ge,ue),{searchResults:Ae,isFetchingSearchResults:We}=Su({searchQuery:re,show:!ue}),qe=(0,l.useRef)(null),{overlayProps:et}=(0,xu.e)({isOpen:!0,onClose:()=>k.setVisualState(Ra.VisualState.animatingOut)},qe),{dialogProps:rt}=(0,id.s)({},qe);return(0,l.useEffect)(()=>{(0,ja.rR)("command_palette_opened")},[]),(0,I.jsx)(Ra.KBarPositioner,{className:G.positioner,children:(0,I.jsx)(Ra.KBarAnimator,{className:G.animator,children:(0,I.jsx)(yu.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,I.jsxs)("div",{...et,...rt,children:[(0,I.jsxs)("div",{className:G.searchContainer,children:[(0,I.jsx)(_n.I,{name:"search",size:"md",className:G.searchIcon}),(0,I.jsx)(zu,{}),(0,I.jsx)(_f,{defaultPlaceholder:(0,d.t)("command-palette.search-box.placeholder","Search or jump to..."),className:G.search}),(0,I.jsx)("div",{className:G.loadingBarContainer,children:We&&(0,I.jsx)(wf.G,{width:500,delay:0})})]}),Pe?(0,I.jsx)("div",{className:G.searchContainer,children:Pe}):null,(0,I.jsx)("div",{className:G.resultsContainer,children:(0,I.jsx)(mp,{isFetchingSearchResults:We,searchResults:Ae})})]})})})})}function zu(){const F=wo(),G=(0,mt.of)(Hs,F),{actions:k,currentRootActionId:re}=(0,Ra.useKBar)(ge=>({actions:ge.actions,currentRootActionId:ge.currentRootActionId})),ue=re?[...k[re].ancestors,k[re]]:[];return ue.length>0&&(0,I.jsx)("span",{className:G.breadcrumbs,children:ue.map((ge,Pe)=>(0,I.jsxs)(l.Fragment,{children:[ge.name,"\xA0/\xA0"]},ge.id||Pe))})}const mp=({isFetchingSearchResults:F,searchResults:G})=>{const{results:k,rootActionId:re}=up(),ue=wo(),ge=(0,mt.of)(Hs,ue),Pe=(0,d.t)("command-palette.section.dashboard-search-results","Dashboards"),Ae=(0,d.t)("command-palette.section.folder-search-results","Folders"),We=(0,l.useMemo)(()=>G.filter(lt=>lt.id.startsWith("go/dashboard")).map(lt=>new Ra.ActionImpl(lt,{store:{}})),[G]),qe=(0,l.useMemo)(()=>G.filter(lt=>lt.id.startsWith("go/folder")).map(lt=>new Ra.ActionImpl(lt,{store:{}})),[G]),et=(0,l.useMemo)(()=>{const lt=[...k];return qe.length>0&&(lt.push(Ae),lt.push(...qe)),We.length>0&&(lt.push(Pe),lt.push(...We)),lt},[k,Pe,We,Ae,qe]),rt=!F&&et.length===0;return(0,l.useEffect)(()=>{rt&&(0,ja.rR)("grafana_empty_state_shown",{source:"command_palette"})},[rt]),rt?(0,I.jsx)(ld.p,{variant:"not-found",role:"alert",message:(0,d.t)("command-palette.empty-state.message","No results found")}):(0,I.jsx)(Vf,{items:et,maxHeight:650,onRender:({item:lt,active:pt})=>{const ht=et[0]===lt;return typeof lt=="string"?(0,I.jsx)("div",{className:(0,Ye.cx)(ge.sectionHeader,ht&&ge.sectionHeaderFirst),children:lt}):(0,I.jsx)(cd,{action:lt,active:pt,currentRootActionId:re})}})},wo=()=>{const G=document.querySelector(`[data-testid="${Sa.Tp.components.NavToolbar.commandPaletteTrigger}"]`)?.getBoundingClientRect().right??0;return document.body.clientWidth-G},Hs=(F,G)=>({positioner:(0,Ye.css)({zIndex:F.zIndex.portal,marginTop:"0px",paddingTop:"4px !important","&::before":{content:'""',position:"fixed",top:0,right:0,bottom:0,left:0,background:F.components.overlay.background}}),animator:(0,Ye.css)({width:"100%",maxWidth:F.breakpoints.values.md,background:F.colors.background.primary,color:F.colors.text.primary,borderRadius:F.shape.radius.default,border:`1px solid ${F.colors.border.weak}`,overflow:"hidden",boxShadow:F.shadows.z3,[F.breakpoints.up("lg")]:{position:"fixed",right:G,left:G,maxWidth:"unset",width:"unset"}}),loadingBarContainer:(0,Ye.css)({position:"absolute",left:0,right:0,bottom:0}),searchContainer:(0,Ye.css)({alignItems:"center",background:F.components.input.background,borderBottom:`1px solid ${F.colors.border.weak}`,display:"flex",padding:F.spacing(1,2),position:"relative",justifyContent:"space-between"}),search:(0,Ye.css)({fontSize:F.typography.fontSize,width:"100%",boxSizing:"border-box",outline:"none",border:"none",color:F.components.input.text}),spinner:(0,Ye.css)({height:"22px"}),resultsContainer:(0,Ye.css)({paddingBottom:F.spacing(1)}),sectionHeader:(0,Ye.css)({padding:F.spacing(1.5,2,2,2),fontSize:F.typography.bodySmall.fontSize,fontWeight:F.typography.fontWeightMedium,color:F.colors.text.secondary,borderTop:`1px solid ${F.colors.border.weak}`,marginTop:F.spacing(1)}),sectionHeaderFirst:(0,Ye.css)({paddingBottom:F.spacing(1),borderTop:"none",marginTop:0}),breadcrumbs:(0,Ye.css)({label:"breadcrumbs",fontSize:F.typography.body.fontSize,fontWeight:F.typography.fontWeightMedium,lineHeight:F.typography.body.lineHeight,color:F.colors.text.primary,display:"flex",alignItems:"center",whiteSpace:"nowrap"}),scopesText:(0,Ye.css)({label:"scopesText",fontSize:F.typography.bodySmall.fontSize,fontWeight:F.typography.fontWeightMedium,lineHeight:F.typography.bodySmall.lineHeight,color:F.colors.text.secondary}),searchIcon:(0,Ye.css)({marginRight:F.spacing(1)}),selectedScope:(0,Ye.css)({background:F.colors.background.secondary,borderRadius:F.shape.radius.default,padding:F.spacing(0,.5),fontSize:F.typography.bodySmall.fontSize,fontWeight:F.typography.fontWeightMedium,lineHeight:F.typography.bodySmall.lineHeight,color:F.colors.text.secondary,display:"inline-flex",alignItems:"center",position:"relative",border:`1px solid ${F.colors.background.secondary}`,whiteSpace:"nowrap",marginRight:F.spacing(.5)})});var Fo=e(92807),ec=e(83175),vp=e(70958);function yd({folder:F,folderPath:G,folders:k,onFolderUpdate:re}){const ue=(0,mt.of)(Si);return(0,I.jsxs)("div",{className:ue.container,role:"treeitem","aria-selected":F.expanded,children:[(0,I.jsxs)("button",{className:ue.expand,"data-testid":`scopes-dashboards-${F.title}-expand`,"aria-label":F.expanded?(0,d.t)("scopes.dashboards.collapse","Collapse"):(0,d.t)("scopes.dashboards.expand","Expand"),onClick:()=>{re(G,!F.expanded)},children:[(0,I.jsx)(_n.I,{name:F.expanded?"angle-down":"angle-right",className:ue.icon}),F.title]}),F.expanded&&(0,I.jsx)("div",{className:ue.children,children:(0,I.jsx)(Gu,{folders:k,folderPath:G,onFolderUpdate:re})})]})}const Si=F=>({container:(0,Ye.css)({display:"flex",flexDirection:"column",padding:F.spacing(.5,0)}),expand:(0,Ye.css)({alignItems:"flex-start",background:"none",border:0,display:"flex",gap:F.spacing(1),margin:0,padding:0,textAlign:"left",wordBreak:"break-word"}),icon:(0,Ye.css)({marginTop:F.spacing(.25)}),children:(0,Ye.css)({paddingLeft:F.spacing(3)})});function yp(F){return F.split("/").slice(0,3).join("/")}function xp({to:F,title:G,id:k}){const re=(0,mt.of)(Pp),ue=(0,l.useMemo)(()=>_u(F),[F]),ge=F.startsWith("/d/"),Pe=(0,Pa.zy)().pathname,Ae=ge?yp(Pe):Pe,We=F.split("?")[0]===Ae;return(0,I.jsxs)(gu.Link,{to:F,"aria-current":We?"page":void 0,className:(0,Ye.cx)(re.container,We&&re.current),"data-testid":`scopes-dashboards-${k}`,role:"treeitem",children:[(0,I.jsx)(_n.I,{name:ue})," ",G]},k)}function _u(F){const G=y.I.stripBaseFromUrl(F);for(const[k,re]of Ep.entries())if(G.startsWith(k))return re;return"link"}const Ep=new Map([["http","external-link-alt"],["/d","apps"],["/explore/metrics","drilldown"],["/a/grafana-metricsdrilldown-app/","drilldown"],["/a/grafana-lokiexplore-app/","drilldown"],["/a/grafana-exploretraces-app/","drilldown"],["/a/grafana-pyroscope-app/","drilldown"]]),Pp=F=>({container:(0,Ye.css)({display:"flex",alignItems:"center",gap:F.spacing(1),padding:F.spacing(.75,0),textAlign:"left",paddingLeft:F.spacing(1),wordBreak:"break-word","&:hover, &:focus":(0,Ye.css)({textDecoration:"underline"})}),current:(0,Ye.css)({position:"relative",background:F.colors.action.selected,borderRadius:`0 ${F.shape.radius.default} ${F.shape.radius.default} 0`,"&::before":{backgroundImage:F.colors.gradients.brandVertical,borderRadius:F.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",width:F.spacing(.5),top:0,left:0}})});function Gu({folders:F,folderPath:G,onFolderUpdate:k}){const[re]=(0,vp.s)(),ue=G[G.length-1],ge=F[ue];return(0,I.jsxs)("div",{role:"tree",children:[Object.entries(ge.folders).map(([Pe,Ae])=>(0,I.jsx)(yd,{folder:Ae,folders:ge.folders,folderPath:[...G,Pe],onFolderUpdate:k},Pe)),Object.values(ge.suggestedNavigations).map(Pe=>(0,I.jsx)(xp,{to:ec.kM.renderUrl(Pe.url,re),title:Pe.title,id:Pe.id},Pe.id+Pe.title))]})}var Hu=e(40996),xd=e(12737);function bp({disabled:F,query:G,onChange:k}){const re=(0,mt.of)(Dp),[ue,ge]=(0,l.useState)({value:G,dirty:!1}),[Pe]=(0,Hu.A)(()=>{ue.dirty&&k(ue.value)},500,[ue.dirty,ue.value]);return(0,l.useEffect)(()=>{(Pe()||!ue.dirty)&&ue.value!==G&&ge({value:G,dirty:!1})},[Pe,ue,G]),(0,I.jsx)("div",{className:re.container,children:(0,I.jsx)(xd.Z,{disabled:F,placeholder:(0,d.t)("scopes.dashboards.search","Search"),value:ue.value,"data-testid":"scopes-dashboards-search",onChange:Ae=>ge({value:Ae,dirty:!0})})})}const Dp=F=>({container:(0,Ye.css)({flex:"0 1 auto"})});function tc(){const F=(0,mt.of)(Cp),G=(0,Gl.b)(),k=Yl();if((0,Tr.A)(k?.scopesDashboardsService.stateObservable??new Di.c,k?.scopesDashboardsService.state),!k||!G||!G.state.enabled||!G.state.drawerOpened||G.state.readOnly)return null;const{scopesDashboardsService:re}=k,{loading:ue,forScopeNames:ge,dashboards:Pe,scopeNavigations:Ae,searchQuery:We,filteredFolders:qe}=re.state,{changeSearchQuery:et,updateFolder:rt,clearSearchQuery:lt}=re;if(!ue){if(ge.length===0)return(0,I.jsx)("div",{className:(0,Ye.cx)(F.container,F.noResultsContainer),"data-testid":"scopes-dashboards-notFoundNoScopes",children:(0,I.jsx)(d.x6,{i18nKey:"scopes.dashboards.noResultsNoScopes",children:"No scopes selected"})});if(Pe.length===0&&Ae.length===0)return(0,I.jsx)("div",{className:(0,Ye.cx)(F.container,F.noResultsContainer),"data-testid":"scopes-dashboards-notFoundForScope",children:(0,I.jsx)(d.x6,{i18nKey:"scopes.dashboards.noResultsForScopes",children:"No dashboards or links found for the selected scopes"})})}return(0,I.jsxs)("div",{className:F.container,"data-testid":"scopes-dashboards-container",children:[(0,I.jsx)(bp,{disabled:ue,query:We,onChange:et}),ue?(0,I.jsx)(Hd._,{className:F.loadingIndicator,text:(0,d.t)("scopes.dashboards.loading","Loading dashboards"),"data-testid":"scopes-dashboards-loading"}):qe[""]?(0,I.jsx)(Fo.P,{children:(0,I.jsx)(Gu,{folders:qe,folderPath:[""],onFolderUpdate:rt})}):(0,I.jsxs)("p",{className:F.noResultsContainer,"data-testid":"scopes-dashboards-notFoundForFilter",children:[(0,I.jsx)(d.x6,{i18nKey:"scopes.dashboards.noResultsForFilter",children:"No results found for your query"}),(0,I.jsx)(ve.$n,{variant:"secondary",onClick:lt,"data-testid":"scopes-dashboards-notFoundForFilter-clear",children:(0,I.jsx)(d.x6,{i18nKey:"scopes.dashboards.noResultsForFilterClear",children:"Clear search"})})]})]})}const Cp=F=>({container:(0,Ye.css)({backgroundColor:F.colors.background.primary,borderRight:`1px solid ${F.colors.border.weak}`,display:"flex",flexDirection:"column",height:"100%",gap:F.spacing(1),padding:F.spacing(2),width:F.spacing(37.5)}),noResultsContainer:(0,Ye.css)({alignItems:"center",display:"flex",flexDirection:"column",gap:F.spacing(1),height:"100%",justifyContent:"center",margin:0,textAlign:"center"}),loadingIndicator:(0,Ye.css)({alignSelf:"center"})});var Tp=e(51182),Qu=e(66588),ku=e(38206),Gr=e(1492);function Ed(){return(0,I.jsx)(ve.$n,{icon:"add-user",size:"sm",variant:"secondary",fill:"solid",fullWidth:!0,onClick:()=>{Zl("bottom_mega_menu","invite-user-bottom-mega-menu")},children:(0,d.t)("navigation.invite-user.invite-new-member-button","Invite new member")})}var Mp=e(89409),Sp=e(78685),Op=e(30360),nc=e(1906),Yu=e(991),Ip=e(90666);const Rp=({children:F})=>{const G=(0,mt.of)(Ap);return(0,I.jsxs)(I.Fragment,{children:[F,(0,I.jsx)("span",{className:G.highlight})]})},Ap=F=>({highlight:(0,Ye.css)({backgroundColor:F.colors.success.main,borderRadius:F.shape.radius.circle,width:"6px",height:"6px",display:"inline-block;",position:"absolute",top:"50%",transform:"translateY(-50%)"})});var jp=e(20941);function Ju({children:F,isActive:G,onClick:k,target:re,url:ue,onPin:ge,isPinned:Pe}){const Ae=(0,mt.$j)(),We=Lp(Ae,G),qe=!re&&ue.startsWith("/")?jp.N:"a",et=(0,I.jsxs)("div",{className:We.linkContent,children:[F,re==="_blank"&&(0,I.jsx)(_n.I,{"data-testid":"external-link-icon",name:"external-link-alt"})]});return(0,I.jsxs)("div",{className:(0,Ye.cx)(We.wrapper,{[We.wrapperActive]:G,[We.wrapperBookmark]:X.$.featureToggles.pinNavItems}),children:[(0,I.jsx)(qe,{"data-testid":Sa.Tp.components.NavMenu.item,className:We.container,href:ue,target:re,onClick:k,...G&&{"aria-current":"page"},children:et}),X.$.featureToggles.pinNavItems&&Gn.TP.isSignedIn&&ue&&ue!=="/bookmarks"&&(0,I.jsx)(is.K,{name:"bookmark",className:"pin-icon",iconType:Pe?"solid":"default",onClick:()=>ge(ue),"aria-label":Pe?(0,d.t)("navigation.item.remove-bookmark","Remove from Bookmarks"):(0,d.t)("navigation.item.add-bookmark","Add to Bookmarks")})]})}Ju.displayName="MegaMenuItemText";const Lp=(F,G)=>({wrapper:(0,Ye.css)({display:"flex",justifyContent:"space-between",width:"100%",height:"100%"}),wrapperBookmark:(0,Ye.css)({".pin-icon":{visibility:"hidden"},"&:hover, &:focus-within":{a:{width:"calc(100% - 20px)"},".pin-icon":{visibility:"visible"}}}),wrapperActive:(0,Ye.css)({backgroundColor:F.colors.action.selected,borderTopRightRadius:F.shape.radius.default,borderBottomRightRadius:F.shape.radius.default,position:"relative","&::before":{backgroundImage:F.colors.gradients.brandVertical,borderRadius:F.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",transform:"translateX(-50%)",width:F.spacing(.5)}}),container:(0,Ye.css)({alignItems:"center",color:G?F.colors.text.primary:F.colors.text.secondary,height:"100%",position:"relative",width:"100%","&:hover span, &:focus-visible span":{color:F.colors.text.primary,textDecoration:"underline"},"&:focus-visible":{boxShadow:"none",outline:`2px solid ${F.colors.primary.main}`,outlineOffset:"-2px",transition:"none"}}),linkContent:(0,Ye.css)({alignItems:"center",display:"flex",gap:"0.5rem",height:"100%",width:"100%",justifyContent:"space-between"})}),ac=2;function Oi({link:F,activeItem:G,level:k=0,onClick:re,onPin:ue,isPinned:ge}){const{chrome:Pe}=(0,mr.Il)(),We=Pe.useState().megaMenuDocked,qe=(0,Pa.zy)(),et=F.highlightText?Rp:l.Fragment,rt=(0,yr.m0)(F,G),lt=F===G||k===ac&&rt,[pt,ht]=(0,Sp.A)(`grafana.navigation.expanded[${F.text}]`,!!rt),Ct=k<ac&&!!(Zu(F)||F.emptyMessage),Wt=(0,l.useRef)(null),en=(0,mt.of)(Xu);if((0,l.useEffect)(()=>{rt&&ht(!0)},[rt,qe,We,ht]),(0,l.useEffect)(()=>{lt&&Wt.current&&qu(Wt.current)&&Wt.current.scrollIntoView({block:"center"})},[lt]),!F.url)return null;let on=null;F.icon?on=(0,I.jsx)(_n.I,{className:en.icon,name:(0,Op.Uo)(F.icon)??"link",size:"lg"}):F.img&&(on=(0,I.jsx)(kt.B,{width:3,justifyContent:"center",children:(0,I.jsx)("img",{className:en.img,src:F.img,alt:""})}));function vn(an){return an?"angle-up":"angle-down"}return(0,I.jsxs)("li",{ref:Wt,className:en.listItem,children:[(0,I.jsxs)("div",{className:(0,Ye.cx)(en.menuItem,{[en.menuItemWithIcon]:!!(k===0&&on)}),children:[k!==0&&(0,I.jsx)(Ip.T,{level:k===ac?k-1:k,spacing:3}),k===ac&&(0,I.jsx)("div",{className:en.itemConnector}),(0,I.jsx)("div",{className:en.collapsibleSectionWrapper,children:(0,I.jsx)(Ju,{isActive:lt,onClick:()=>{F.onClick?.(),re?.()},target:F.target,url:F.url,onPin:()=>ue(F),isPinned:ge(F.url),children:(0,I.jsxs)("div",{className:(0,Ye.cx)(en.labelWrapper,{[en.hasActiveChild]:rt,[en.labelWrapperWithIcon]:!!(k===0&&on)}),children:[k===0&&on&&(0,I.jsx)(et,{children:on}),(0,I.jsx)(Ta.E,{truncate:!0,children:F.text}),F.isNew&&(0,I.jsx)(Yu.y,{featureState:nc.Ay.new})]})})}),(0,I.jsx)("div",{className:en.collapseButtonWrapper,children:Ct&&(0,I.jsx)(is.K,{"aria-label":pt?(0,d.t)("navigation.megamenu-item.collapse-aria-label","Collapse section: {{sectionName}}",{sectionName:F.text}):(0,d.t)("navigation.megamenu-item.expand-aria-label","Expand section: {{sectionName}}",{sectionName:F.text}),className:en.collapseButton,onClick:()=>ht(!pt),name:vn(!!pt),size:"md",variant:"secondary"})})]}),Ct&&pt&&(0,I.jsx)("ul",{className:en.children,children:Zu(F)?F.children.filter(an=>!an.isCreateAction).map(an=>(0,I.jsx)(Oi,{link:an,activeItem:G,onClick:re,level:k+1,onPin:ue,isPinned:ge},`${F.text}-${an.text}`)):(0,I.jsx)("div",{className:en.emptyMessage,"aria-live":"polite",children:F.emptyMessage})})]})}const Xu=F=>({icon:(0,Ye.css)({width:F.spacing(3)}),img:(0,Ye.css)({height:F.spacing(2),width:F.spacing(2)}),listItem:(0,Ye.css)({flex:1,maxWidth:"100%"}),menuItem:(0,Ye.css)({display:"flex",alignItems:"center",gap:F.spacing(1),height:F.spacing(4),paddingLeft:F.spacing(.5),position:"relative"}),menuItemWithIcon:(0,Ye.css)({paddingLeft:F.spacing(0)}),collapseButtonWrapper:(0,Ye.css)({display:"flex",justifyContent:"center",width:F.spacing(3),flexShrink:0}),itemConnector:(0,Ye.css)({position:"relative",height:"100%",width:F.spacing(1.5),"&::before":{borderLeft:`1px solid ${F.colors.border.medium}`,content:'""',height:"100%",right:0,position:"absolute",transform:"translateX(50%)"}}),collapseButton:(0,Ye.css)({margin:0}),collapsibleSectionWrapper:(0,Ye.css)({alignItems:"center",display:"flex",flex:1,height:"100%",minWidth:0}),labelWrapper:(0,Ye.css)({display:"flex",alignItems:"center",gap:F.spacing(2),minWidth:0,paddingLeft:F.spacing(1)}),labelWrapperWithIcon:(0,Ye.css)({paddingLeft:F.spacing(.5)}),hasActiveChild:(0,Ye.css)({color:F.colors.text.primary}),children:(0,Ye.css)({display:"flex",listStyleType:"none",flexDirection:"column"}),emptyMessage:(0,Ye.css)({color:F.colors.text.secondary,fontStyle:"italic",padding:F.spacing(1,1.5,1,7)})});function Zu(F){return!!(F.children&&F.children.length>0)}function qu(F){const G=F.getBoundingClientRect();return G.bottom<0||G.top>=window.innerHeight}var Bp=e(5071);const ho="300px",Pd=(0,l.memo)((0,l.forwardRef)(({onClose:F,...G},k)=>{const re=(0,nr.d4)(en=>en.navBarTree),ue=(0,mt.of)(Up),ge=(0,Pa.zy)(),{chrome:Pe}=(0,mr.Il)(),Ae=(0,nr.wA)(),We=Pe.useState(),[qe]=(0,Gr.o)(),et=(0,Bp.s)(),rt=re.filter(en=>en.id!=="profile"&&en.id!=="help").map(en=>(0,yr.J0)(en,We.megaMenuDocked));if(X.$.featureToggles.pinNavItems){const en=rt.find(on=>on.id==="bookmarks");en&&(en.children=et.reduce((on,vn)=>{const an=(0,yr.Wk)(rt,vn);if(!an)return on;const gn={id:an.id,text:an.text,url:an.url,parentItem:{id:"bookmarks",text:"Bookmarks"}};return on.push((0,yr.J0)(gn,We.megaMenuDocked)),on},[]))}const lt=(0,yr.A6)(rt,We.sectionNav.node,ge.pathname),pt=()=>{Pe.setMegaMenuOpen(!We.megaMenuOpen)},ht=()=>{Pe.setMegaMenuDocked(!We.megaMenuDocked),We.megaMenuDocked&&Pe.setMegaMenuOpen(!1)},Ct=(0,l.useCallback)(en=>!en||!et?.length?!1:et?.includes(en),[et]),Wt=en=>{const on=en.url;if(on&&X.$.featureToggles.pinNavItems){const vn=Ct(on),an=vn?et.filter($n=>on!==$n):[...et,on],gn=vn?"grafana_nav_item_unpinned":"grafana_nav_item_pinned";(0,ja.rR)(gn,{path:on}),qe({patchPrefsCmd:{navbar:{bookmarkUrls:an}}}).then($n=>{$n.error||Ae((0,ku.ve)({item:en,isSaved:!vn}))})}};return(0,I.jsxs)("div",{"data-testid":Sa.Tp.components.NavMenu.Menu,ref:k,...G,children:[(0,I.jsx)(Mp.fn,{handleDockedMenu:ht,handleMegaMenu:pt,onClose:F}),(0,I.jsxs)("nav",{className:ue.content,children:[(0,I.jsx)(Fo.P,{height:"100%",overflowX:"hidden",showScrollIndicators:!0,children:(0,I.jsx)("ul",{className:ue.itemList,"aria-label":(0,d.t)("navigation.megamenu.list-label","Navigation"),children:rt.map((en,on)=>(0,I.jsx)(Oi,{link:en,isPinned:Ct,onClick:We.megaMenuDocked?void 0:F,activeItem:lt,onPin:Wt},en.text))})}),uo&&(0,I.jsx)("div",{className:ue.inviteNewMemberButton,children:(0,I.jsx)(Ed,{})})]})]})}));Pd.displayName="MegaMenu";const Up=F=>({content:(0,Ye.css)({display:"flex",flexDirection:"column",minHeight:0,flexGrow:1,position:"relative"}),mobileHeader:(0,Ye.css)({display:"flex",justifyContent:"space-between",padding:F.spacing(1,1,1,2),borderBottom:`1px solid ${F.colors.border.weak}`,[F.breakpoints.up("md")]:{display:"none"}}),itemList:(0,Ye.css)({boxSizing:"border-box",display:"flex",flexDirection:"column",listStyleType:"none",padding:F.spacing(1,1,2,1),[F.breakpoints.up("md")]:{width:ho}}),inviteNewMemberButton:(0,Ye.css)({display:"flex",padding:F.spacing(1.5,1,1.5,1),borderTop:`1px solid ${F.colors.border.weak}`}),dockMenuButton:(0,Ye.css)({display:"none",position:"relative",top:F.spacing(1),[F.breakpoints.up("xl")]:{display:"inline-flex"}})});function Wp({}){const F=(0,mt.$j)(),{chrome:G}=(0,mr.Il)(),k=G.useState(),re=(0,l.useRef)(null),ue=(0,l.useRef)(null),ge=F.transitions.duration.shortest,Pe=(0,mt.of)(Kp,ge),Ae=k.megaMenuOpen&&!k.megaMenuDocked,We=()=>G.setMegaMenuOpen(!1),{overlayProps:qe,underlayProps:et}=(0,xu.e)({isDismissable:!0,isOpen:!0,onClose:We,shouldCloseOnInteractOutside:pt=>!document.querySelector(`[data-testid="${Sa.Tp.components.Select.menu}"]`)?.contains(pt)},re),{dialogProps:rt}=(0,id.s)({},re),lt=(0,mt.of)(Np);return(0,I.jsx)("div",{className:lt.wrapper,children:(0,I.jsxs)(Tp.Sf,{children:[(0,I.jsx)(Qu.A,{nodeRef:re,in:Ae,unmountOnExit:!0,classNames:Pe.overlay,timeout:{enter:ge,exit:0},children:(0,I.jsx)(I.Fragment,{children:Ae&&(0,I.jsx)(yu.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,I.jsx)(Pd,{className:lt.menu,onClose:We,ref:re,...qe,...rt})})})}),(0,I.jsx)(Qu.A,{nodeRef:ue,in:Ae,unmountOnExit:!0,classNames:Pe.backdrop,timeout:{enter:ge,exit:0},children:(0,I.jsx)("div",{ref:ue,className:lt.backdrop,...et})})]})})}const Np=F=>({backdrop:(0,Ye.css)({backgroundColor:F.components.overlay.background,bottom:0,left:0,position:"fixed",right:0,top:0,zIndex:F.zIndex.modalBackdrop}),menu:(0,Ye.css)({display:"flex",bottom:0,flexDirection:"column",left:0,right:0,zIndex:F.zIndex.modal,position:"fixed",top:0,backgroundColor:F.colors.background.primary,flex:"1 1 0",[F.breakpoints.up("md")]:{right:"unset"}}),wrapper:(0,Ye.css)({position:"fixed",display:"grid",gridAutoFlow:"column",height:"100%",zIndex:F.zIndex.sidemenu})}),Kp=(F,G)=>{const k={[F.transitions.handleMotion("no-preference")]:{transitionDuration:`${G}ms`,transitionTimingFunction:F.transitions.easing.easeInOut},[F.breakpoints.down("md")]:{overflow:"hidden"}},re={...k,transitionProperty:"box-shadow, width",".scrollbar-view":{overflow:"hidden !important"}},ue={...k,transitionProperty:"opacity"},ge={width:"100%",[F.breakpoints.up("md")]:{borderRight:`1px solid ${F.colors.border.weak}`,boxShadow:F.shadows.z3,width:ho}},Pe={boxShadow:"none",width:0},Ae={opacity:1},We={opacity:0};return{backdrop:{enter:(0,Ye.css)(We),enterActive:(0,Ye.css)(ue,Ae),enterDone:(0,Ye.css)(Ae)},overlay:{enter:(0,Ye.css)(Pe),enterActive:(0,Ye.css)(re,ge),enterDone:(0,Ye.css)(ge)}}};var Vo=e(32899),$a=e(45229);function Ii(F,G){if(F===G)return!0;if(!(F instanceof Object)||!(G instanceof Object))return!1;const k=Object.keys(F),re=k.length;for(let ue=0;ue<re;ue++)if(!(k[ue]in G))return!1;for(let ue=0;ue<re;ue++)if(F[k[ue]]!==G[k[ue]])return!1;return re===Object.keys(G).length}var eh=e(18607);const wp="grafana_unified_history_entry_clicked",Ri="grafana_unified_history_duplicated_entry_rendered",sc="grafana_unified_history_drawer_interaction",th="grafana_unified_history_show_more",nh=({entryURL:F,subEntry:G})=>{(0,ja.rR)(wp,{entryURL:F,subEntry:G})},Fp=({entryName:F,lastEntryURL:G,newEntryURL:k})=>{(0,ja.rR)(Ri,{entryName:F,lastEntryURL:G,newEntryURL:k})},Ai=({type:F})=>{(0,ja.rR)(sc,{type:F})},bd=()=>{(0,ja.rR)(th)},Dd="grafana.navigation.docked",ah="grafana.navigation.open",ji="grafana.navigation.history";class Vp{constructor(){this.searchBarStorageKey="SearchBar_Hidden",this.routeChangeHandled=!0,this.megaMenuDocked=!!(window.innerWidth>=X.$.theme2.breakpoints.values.xl&&vr.A.getBool(Dd,window.innerWidth>=X.$.theme2.breakpoints.values.xl)),this.sessionStorageData=window.sessionStorage.getItem("returnToPrevious"),this.returnToPreviousData=this.sessionStorageData?JSON.parse(this.sessionStorageData):void 0,this.state=new bi.t({chromeless:!0,sectionNav:{node:{text:(0,d.t)("nav.home.title","Home")},main:{text:""}},megaMenuOpen:this.megaMenuDocked&&vr.A.getBool(ah,!0),megaMenuDocked:this.megaMenuDocked,kioskMode:null,layout:ed.k.Canvas,returnToPrevious:this.returnToPreviousData}),this.setReturnToPrevious=G=>{const k=this.state.getValue().returnToPrevious;(0,ja.rR)("grafana_return_to_previous_button_created",{page:G.href,previousPage:k?.href}),this.update({returnToPrevious:G}),window.sessionStorage.setItem("returnToPrevious",JSON.stringify(G))},this.clearReturnToPrevious=G=>{const k=this.state.getValue().returnToPrevious;k&&(0,ja.rR)("grafana_return_to_previous_button_dismissed",{action:G,page:k.href}),this.update({returnToPrevious:void 0}),window.sessionStorage.removeItem("returnToPrevious")},this.setMegaMenuOpen=G=>{const{megaMenuDocked:k}=this.state.getValue();k&&vr.A.set(ah,G),(0,ja.rR)("grafana_mega_menu_open",{state:G}),this.update({megaMenuOpen:G})},this.setMegaMenuDocked=(G,k=!0)=>{k&&vr.A.set(Dd,G),(0,ja.rR)("grafana_mega_menu_docked",{state:G}),this.update({megaMenuDocked:G})},this.onToggleKioskMode=()=>{const G=this.getNextKioskMode();this.update({kioskMode:G}),C.Ny.partial({kiosk:this.getKioskUrlValue(G)}),(0,ja.rR)("grafana_kiosk_mode",{action:"toggle",mode:G})}}setMatchedRoute(G){this.currentRoute!==G&&(this.currentRoute=G,this.routeChangeHandled=!1)}update(G){const k=this.state.getValue(),re={...k};this.routeChangeHandled||(re.actions=void 0,re.pageNav=void 0,re.sectionNav={node:{text:(0,d.t)("nav.home.title","Home")},main:{text:""}},re.chromeless=this.currentRoute?.chromeless,re.layout=ed.k.Standard,this.routeChangeHandled=!0),Object.assign(re,G),re.chromeless=re.kioskMode===As.d9.Full||this.currentRoute?.chromeless,this.ignoreStateUpdate(re,k)||(X.$.featureToggles.unifiedHistory&&vr.A.setObject(ji,this.getUpdatedHistory(re)),this.state.next(re))}getUpdatedHistory(G){const k=(0,eh.Z)(G.sectionNav.node,G.pageNav,{text:"Home",url:"/"},!0),re=G.pageNav||G.sectionNav.node;let ue=vr.A.getObject(ji,[]);if(vr.A.getObject("CLICKING_HISTORY"))return vr.A.setObject("CLICKING_HISTORY",!1),ue;if(!re)return ue;const Pe=ue[0],Ae={name:re.text,views:[],breadcrumbs:k,time:Date.now(),url:window.location.href};return Pe&&Ae.url.split("?")[0]===Pe.url.split("?")[0]?ue[0]=Ae:(Pe&&Pe.name===Ae.name&&Fp({entryName:Ae.name,lastEntryURL:Pe.url,newEntryURL:Ae.url}),ue=[Ae,...ue]),ue}ignoreStateUpdate(G,k){return!!(Ii(G,k)||(G.sectionNav!==k.sectionNav||G.pageNav!==k.pageNav)&&G.actions===k.actions&&G.layout===k.layout&&Cd(G.sectionNav.node,k.sectionNav.node)&&Cd(G.pageNav,k.pageNav))}useState(){return(0,Tr.A)(this.state,this.state.getValue())}exitKioskMode(){this.update({kioskMode:void 0}),C.Ny.partial({kiosk:null}),(0,ja.rR)("grafana_kiosk_mode",{action:"exit"})}setKioskModeFromUrl(G){let k;switch(G){case"1":case!0:k=As.d9.Full}k&&k!==this.state.getValue().kioskMode&&this.update({kioskMode:k})}getKioskUrlValue(G){switch(G){case As.d9.Full:return!0;default:return null}}getNextKioskMode(){return $a.A.emit(Vo.r1.alertInfo,[(0,d.t)("navigation.kiosk.tv-alert","Press ESC to exit kiosk mode")]),As.d9.Full}}function Cd(F,G){if(F===G)return!0;const k=F?.children?.find(ue=>ue.active),re=G?.children?.find(ue=>ue.active);return F?.text===G?.text&&F?.url===G?.url&&k?.url===re?.url&&Cd(F?.parentItem,G?.parentItem)}var Td=e(92270),$p=e(93256);const sh=({label:F,onClick:G,onDismiss:k})=>{const re=(0,mt.of)(zp);return(0,I.jsxs)($p.e,{className:re.buttonGroup,children:[(0,I.jsx)(ve.$n,{icon:"angle-left",size:"sm",variant:"primary",fill:"outline",onClick:G,title:F,className:re.mainDismissableButton,"data-testid":Sa.Tp.components.ReturnToPrevious.backButton,children:F}),(0,I.jsx)(ve.$n,{icon:"times","aria-label":(0,d.t)("return-to-previous.dismissable-button","Close"),variant:"primary",fill:"outline",size:"sm",onClick:k,"data-testid":Sa.Tp.components.ReturnToPrevious.dismissButton})]})},zp=F=>({mainDismissableButton:(0,Ye.css)({width:"100%","> span":{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"270px",display:"inline-block"}}),buttonGroup:(0,Ye.css)({width:"fit-content",backgroundColor:F.colors.background.secondary})});sh.displayName="DismissableButton";const rh=({href:F,title:G})=>{const k=(0,mt.of)(oh),{chrome:re}=(0,mr.Il)(),ue=(0,l.useCallback)(()=>{C.Ny.push(F),re.clearReturnToPrevious("clicked")},[F,re]),ge=(0,l.useCallback)(()=>{re.clearReturnToPrevious("dismissed")},[re]);return(0,I.jsx)("div",{className:k.returnToPrevious,"data-testid":Sa.Tp.components.ReturnToPrevious.buttonGroup,children:(0,I.jsx)(sh,{label:(0,d.t)("return-to-previous.button.label","Back to {{title}}",{title:G}),onClick:ue,onDismiss:ge})})},oh=F=>({returnToPrevious:(0,Ye.css)({label:"return-to-previous",display:"flex",justifyContent:"center",left:"50%",transform:"translateX(-50%)",zIndex:F.zIndex.tooltip,position:"fixed",bottom:F.spacing.x4,boxShadow:F.shadows.z3})});rh.displayName="ReturnToPrevious";var Mr=e(7895),_p=e(95943),Md=e(43550),ih=e(92948);function Hr({href:F,isCurrent:G,text:k,index:re,flexGrow:ue}){const ge=(0,mt.of)(Sd),Pe=()=>{(0,ja.rR)("grafana_breadcrumb_clicked",{url:F})};return(0,I.jsx)("li",{className:ge.breadcrumbWrapper,style:{flexGrow:ue},children:G?(0,I.jsx)("span",{"data-testid":Sa.XF.Breadcrumbs.breadcrumb(k),className:ge.breadcrumb,"aria-current":"page",title:k,children:k}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("a",{onClick:Pe,"data-testid":Sa.XF.Breadcrumbs.breadcrumb(k),className:(0,Ye.cx)(ge.breadcrumb,ge.breadcrumbLink),title:k,href:F,children:k}),(0,I.jsx)("div",{className:ge.separator,"aria-hidden":!0,children:(0,I.jsx)(_n.I,{name:"angle-right"})})]})})}const Sd=F=>({breadcrumb:(0,Ye.css)({display:"block",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",color:F.colors.text.secondary}),breadcrumbLink:(0,Ye.css)({color:F.colors.text.primary,"&:hover":{textDecoration:"underline"}}),breadcrumbWrapper:(0,Ye.css)({alignItems:"center",color:F.colors.text.primary,display:"flex",flex:1,gap:F.spacing(.5),minWidth:0,maxWidth:"max-content",padding:F.spacing(.5,0,.5,.5),[F.breakpoints.down("sm")]:{display:"none","&:nth-last-child(2)":{display:"flex",minWidth:"40px"},"&:last-child":{display:"flex"}}}),separator:(0,Ye.css)({color:F.colors.text.secondary})});function Gp({breadcrumbs:F,className:G}){const k=(0,mt.of)(Qp);return(0,I.jsx)("nav",{"aria-label":(0,d.t)("navigation.breadcrumbs.aria-label","Breadcrumbs"),className:G,children:(0,I.jsx)("ol",{className:k.breadcrumbs,children:F.map((re,ue)=>(0,l.createElement)(Hr,{...re,isCurrent:ue===F.length-1,key:ue,index:ue,flexGrow:Hp(ue,F.length)}))})})}function Hp(F,G){return G<5&&F>0&&F<G-2||G>6&&F>1&&F<G-3?4:10}const Qp=F=>({breadcrumbs:(0,Ye.css)({display:"flex",alignItems:"center",flexWrap:"nowrap",overflow:"hidden"})});var $o=e(5423);function Od(F){switch(F){case"grafana-grafanadocsplugin-app":return"book";default:return"ai-sparkle"}}function kp({isOpen:F,title:G,onClick:k,pluginId:re},ue){const ge=(0,mt.of)(Li),Pe=Od(re);if(F)return(0,I.jsx)(Mr.I,{ref:ue,className:(0,Ye.cx)(ge.button,ge.buttonActive),icon:Pe,"data-testid":"extension-toolbar-button-close",variant:"default",onClick:k,tooltip:(0,d.t)("navigation.extension-sidebar.button-tooltip.close","Close {{title}}",{title:G})});let Ae=(0,d.t)("navigation.extension-sidebar.button-tooltip.open-all","Open AI assistants and sidebar apps");return G&&(Ae=(0,d.t)("navigation.extension-sidebar.button-tooltip.open","Open {{title}}",{title:G})),(0,I.jsx)(Mr.I,{ref:ue,className:(0,Ye.cx)(ge.button),icon:Pe,"data-testid":"extension-toolbar-button-open",variant:"default",onClick:k,tooltip:Ae})}const Ts=l.forwardRef(kp);function Li(F){return{button:(0,Ye.css)({aspectRatio:"1 / 1 !important",width:"28px",height:"28px",padding:0,justifyContent:"center",borderRadius:F.shape.radius.circle,margin:F.spacing(0,.25)}),buttonActive:(0,Ye.css)({borderRadius:F.shape.radius.circle,backgroundColor:F.colors.primary.transparent,border:`1px solid ${F.colors.primary.borderTransparent}`,color:F.colors.text.primary})}}function lh(){const{availableComponents:F,dockedComponentId:G,setDockedComponentId:k,isOpen:re,isEnabled:ue}=(0,$r.sA)();let ge="",Pe="";if(G){const qe=(0,$r.rS)(G);qe&&(ge=qe.componentTitle,Pe=qe.pluginId)}if(!ue||F.size===0)return null;const Ae=Array.from(F.entries()).flatMap(([qe,{addedComponents:et}])=>et.map(rt=>({...rt,pluginId:qe})));if(Ae.length===0)return null;if(Ae.length===1)return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(Ts,{isOpen:re,title:Ae[0].title,onClick:()=>{k(re?void 0:(0,$r.pF)(Ae[0].pluginId,Ae[0]))},pluginId:Ae[0].pluginId}),(0,I.jsx)($o.K,{})]});const We=(0,I.jsx)(gr.W,{children:Ae.map(qe=>{const et=(0,$r.pF)(qe.pluginId,qe);return(0,I.jsx)(gr.W.Item,{active:G===et,label:qe.title,onClick:()=>{k(re&&G===et?void 0:et)}},et)})});return(0,I.jsxs)(I.Fragment,{children:[re?(0,I.jsx)(Ts,{isOpen:!0,title:ge,onClick:()=>{re&&k(void 0)},pluginId:Pe}):(0,I.jsx)(Ei.m,{overlay:We,placement:"bottom-end",children:(0,I.jsx)(Ts,{isOpen:!1})}),(0,I.jsx)($o.K,{})]})}var Id=e(42941),as=e(87745),Rd=e(95093),Qs=e.n(Rd),Yp=e(35137),ch=e(8073),Jp=e(53431),Ad=e(12810);function dh({onClose:F}){const G=zr.M.getObject(ji,[]).filter(Ae=>Qs()(Ae.time).isAfter(Qs()().subtract(2,"day").startOf("day"))),[k,re]=(0,l.useState)(5),ue=G.find(Ae=>Ae.url===window.location.href||Ae.views.some(We=>We.url===window.location.href))?.time,ge=G.slice(0,k).reduce((Ae,We)=>{const qe=Qs()(We.time);let et="";return qe.isSame(Qs()(),"day")?et=(0,d.t)("nav.history-wrapper.today","Today"):qe.isSame(Qs()().subtract(1,"day"),"day")?et=(0,d.t)("nav.history-wrapper.yesterday","Yesterday"):et=qe.format("YYYY-MM-DD"),Ae[et]=[...Ae[et]||[],We],Ae},{}),Pe=(0,mt.of)(uh);return(0,I.jsxs)(kt.B,{direction:"column",alignItems:"flex-start",children:[(0,I.jsx)(ie.a,{width:"100%",children:Object.keys(ge).map((Ae,We)=>(0,I.jsxs)(kt.B,{direction:"column",gap:1,children:[(0,I.jsx)(ie.a,{paddingLeft:2,children:(0,I.jsx)(Ta.E,{color:"secondary",children:Ae})}),(0,I.jsx)("div",{className:Pe.timeline,children:ge[Ae].map((qe,et)=>(0,I.jsx)(Xp,{entry:qe,isSelected:qe.time===ue,onClick:()=>F()},et))})]},We))}),G.length>k&&(0,I.jsx)(ie.a,{paddingLeft:2,children:(0,I.jsx)(ve.$n,{variant:"secondary",fill:"text",onClick:()=>{re(k+5),bd()},children:(0,d.t)("nav.history-wrapper.show-more","Show more")})})]})}function Xp({entry:F,isSelected:G,onClick:k}){const re=(0,mt.of)(uh),ue=(0,mt.$j)(),[ge,Pe]=(0,l.useState)(G&&F.views.length>0),{breadcrumbs:Ae,views:We,time:qe,url:et,sparklineData:rt}=F,lt=ge?(0,d.t)("nav.history-wrapper.collapse","Collapse"):(0,d.t)("nav.history-wrapper.expand","Expand"),pt=ge?(0,d.t)("nav.history-wrapper.icon-selected","Selected Entry"):(0,d.t)("nav.history-wrapper.icon-unselected","Normal Entry"),ht=G&&F.views.find(Ct=>Ct.url===window.location.href)?.time;return(0,I.jsx)(ie.a,{marginBottom:1,children:(0,I.jsxs)(kt.B,{direction:"column",gap:1,children:[(0,I.jsxs)(kt.B,{alignItems:"baseline",children:[We.length>0?(0,I.jsx)(is.K,{name:ge?"angle-down":"angle-right",onClick:()=>Pe(!ge),"aria-label":lt,className:re.iconButton}):(0,I.jsx)(Yp.$,{h:2}),(0,I.jsx)(_n.I,{size:"sm",name:G?"circle-mono":"circle","aria-label":pt,className:ge?re.iconButtonDot:re.iconButtonCircle}),(0,I.jsx)(ch.Z,{onClick:()=>{zr.M.setObject("CLICKING_HISTORY",!0),k(),nh({entryURL:et})},href:et,isCompact:!0,className:G?re.card:(0,Ye.cx)(re.card,re.cardSelected),children:(0,I.jsxs)(kt.B,{direction:"column",children:[(0,I.jsx)("div",{children:Ae.map((Ct,Wt)=>(0,I.jsxs)(Ta.E,{children:[Ct.text," ",Wt!==Ae.length-1?"> ":""]},Wt))}),(0,I.jsx)(Ta.E,{variant:"bodySmall",color:"secondary",children:(0,Ad.Y)(qe,{timeStyle:"short"})}),rt&&(0,I.jsx)(Jp.O,{theme:ue,width:240,height:40,config:{custom:{fillColor:"rgba(130, 181, 216, 0.1)",lineColor:"#82B5D8"}},sparkline:{y:{type:ee.PU.number,name:"test",config:{},values:rt.values,state:{range:{...rt.range}}}}})]})})]}),ge&&(0,I.jsx)("div",{className:re.expanded,children:We.map((Ct,Wt)=>(0,I.jsx)(ch.Z,{href:Ct.url,onClick:()=>{zr.M.setObject("CLICKING_HISTORY",!0),k(),nh({entryURL:Ct.url,subEntry:"timeRange"})},isCompact:!0,className:Ct.time===ht?void 0:re.subCard,children:(0,I.jsxs)(kt.B,{direction:"column",gap:0,children:[(0,I.jsx)(Ta.E,{variant:"bodySmall",children:Ct.name}),Ct.description&&(0,I.jsx)(Ta.E,{color:"secondary",variant:"bodySmall",children:Ct.description})]})},Wt))})]})})}const uh=F=>({card:(0,Ye.css)({label:"card",background:"none",margin:F.spacing(.5,0)}),cardSelected:(0,Ye.css)({label:"card-selected",background:"none"}),subCard:(0,Ye.css)({label:"subcard",background:"none",margin:0}),iconButton:(0,Ye.css)({label:"expand-button",margin:0}),iconButtonCircle:(0,Ye.css)({label:"blue-circle-icon",margin:0,background:F.colors.background.primary,fill:F.colors.primary.main,cursor:"default","&:hover:before":{background:"none"},zIndex:0}),iconButtonDot:(0,Ye.css)({label:"blue-dot-icon",margin:0,color:F.colors.primary.main,border:F.shape.radius.circle,cursor:"default","&:hover:before":{background:"none"},zIndex:0}),expanded:(0,Ye.css)({label:"expanded",display:"flex",flexDirection:"column",marginLeft:F.spacing(6),gap:F.spacing(1),position:"relative","&:before":{content:'""',position:"absolute",left:0,top:0,height:"100%",width:"1px",background:F.colors.border.weak}}),timeline:(0,Ye.css)({label:"timeline",position:"relative",height:"100%",width:"100%",paddingLeft:F.spacing(2),"&:before":{content:'""',position:"absolute",left:F.spacing(5.75),top:0,height:"100%",width:"1px",borderLeft:`1px dashed ${F.colors.border.strong}`}})});function Zp(){const[F,G]=(0,Id.A)(!1),k=(0,mt.of)(ks);return(0,l.useEffect)(()=>{const re=$a.l.subscribe(as.sj,ue=>{if(zr.M.getObject("CLICKING_HISTORY")){zr.M.setObject("CLICKING_HISTORY",!1);return}const Pe=zr.M.getObject(ji,[]);let Ae=Pe[0];const We=ue.payload.url;return Ae.views[0]?.url!==We&&(Ae.views=[{name:ue.payload.name,description:ue.payload.description,url:We,time:Date.now()},...Ae.views],zr.M.setObject(ji,[...Pe])),()=>{re.unsubscribe()}})},[]),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(Mr.I,{onClick:()=>{G(),Ai({type:"open"})},iconOnly:!0,icon:"history","aria-label":(0,d.t)("nav.history-container.drawer-tittle","History")}),(0,I.jsx)($o.K,{className:k.separator}),F&&(0,I.jsx)(No._,{title:(0,d.t)("nav.history-container.drawer-tittle","History"),onClose:()=>{G(),Ai({type:"close"})},size:"sm",children:(0,I.jsx)(dh,{onClose:()=>G(!1)})})]})}const ks=F=>({separator:(0,Ye.css)({[F.breakpoints.down("sm")]:{display:"none"}})});function qp(F){const G=[];for(const k of F)k.isCreateAction&&G.push(k),k.children&&G.push(...qp(k.children));return G}const hh=({})=>{const F=(0,nr.d4)(Pe=>Pe.navBarTree),[G,k]=(0,l.useState)(!1),re=(0,l.useMemo)(()=>{const Pe=qp(F);return uo&&Pe.push({text:(0,d.t)("navigation.invite-user.invite-new-member-button","Invite new member"),url:(0,Lu.o)("invite-user-top-bar"),target:"_blank",isCreateAction:!0,onClick:()=>{Zl("quick_add_button","invite-user-quick-add-button")}}),Pe},[F]),ue=re.length>0;if(!ue)return null;const ge=()=>(0,I.jsx)(gr.W,{children:re.map((Pe,Ae)=>(0,I.jsxs)("div",{children:[uo&&Ae===re.length-1&&(0,I.jsx)(gr.W.Divider,{}),(0,I.jsx)(gr.W.Item,{url:Pe.url,label:Pe.text,target:Pe.target,onClick:()=>{(0,ja.rR)("grafana_menu_item_clicked",{url:Pe.url,from:"quickadd"}),Pe.onClick?.()}})]},Ae))});return ue?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(Ei.m,{overlay:ge,placement:"bottom-end",onVisibleChange:k,children:(0,I.jsx)(Mr.I,{iconOnly:!0,icon:"plus",isOpen:G,"aria-label":(0,d.t)("navigation.quick-add.aria-label","New")})}),(0,I.jsx)($o.K,{})]}):null};var Bi=e(94535),fh=e(45450),eg=e(35555),Es=e(3271);function ph({theme:F}){return(0,I.jsx)(eg.D.Provider,{value:F,children:(0,I.jsx)(tg,{})})}function tg(){const F=(0,mt.of)(rc);return(0,I.jsx)(ie.a,{backgroundColor:"canvas",display:"flex",direction:"column",grow:1,children:(0,I.jsxs)(kt.B,{gap:0,direction:"column",children:[(0,I.jsxs)(ie.a,{display:"flex",justifyContent:"space-between",alignItems:"center",gap:.5,backgroundColor:"primary",height:3,paddingY:.5,paddingX:1,children:[(0,I.jsxs)(kt.B,{alignItems:"center",gap:.5,children:[(0,I.jsx)(ih.M.MenuLogo,{className:F.img}),(0,I.jsxs)("div",{className:F.breadcrumbs,children:[(0,I.jsx)(d.x6,{i18nKey:"theme-preview.breadcrumbs.home",children:"Home"}),(0,I.jsx)(_n.I,{className:F.breadcrumbSeparator,name:"angle-right"}),(0,I.jsx)(d.x6,{i18nKey:"theme-preview.breadcrumbs.dashboards",children:"Dashboards"})]})]}),(0,I.jsxs)(kt.B,{alignItems:"center",gap:.5,children:[(0,I.jsx)("div",{className:F.formInput}),(0,I.jsx)(ie.a,{borderStyle:"solid",borderColor:"medium",borderRadius:"circle",height:1,width:1,backgroundColor:"secondary",marginLeft:.5})]})]}),(0,I.jsx)(Es.c,{spacing:0}),(0,I.jsx)(ie.a,{padding:2.5,display:"flex",direction:"column",flex:1,children:(0,I.jsxs)("div",{className:F.panel,children:[(0,I.jsx)("div",{className:F.panelHeader,children:(0,I.jsx)(d.x6,{i18nKey:"theme-preview.panel.title",children:"Panel"})}),(0,I.jsxs)(ie.a,{padding:.5,display:"flex",direction:"column",gap:.5,grow:1,children:[(0,I.jsx)("div",{className:F.formLabel,children:(0,I.jsx)(d.x6,{i18nKey:"theme-preview.panel.form-label",children:"Form label"})}),(0,I.jsx)("div",{className:F.formInput})]}),(0,I.jsxs)(ie.a,{display:"flex",gap:.5,padding:1,justifyContent:"flex-end",children:[(0,I.jsx)("div",{className:(0,Ye.cx)(F.action,F.actionSecondary)}),(0,I.jsx)("div",{className:(0,Ye.cx)(F.action,F.actionDanger)}),(0,I.jsx)("div",{className:(0,Ye.cx)(F.action,F.actionPrimary)})]})]})})]})})}const rc=F=>({breadcrumbs:(0,Ye.css)({alignItems:"center",color:F.colors.text.primary,display:"flex",fontSize:Math.round(F.typography.fontSize/3),gap:F.spacing(.25),lineHeight:Math.round(F.typography.body.lineHeight/3),paddingLeft:F.spacing(.5)}),breadcrumbSeparator:(0,Ye.css)({height:F.spacing(.75),width:F.spacing(.75)}),img:(0,Ye.css)({height:F.spacing(1),width:F.spacing(1)}),panel:(0,Ye.css)({background:F.components.panel.background,border:`1px solid ${F.components.panel.borderColor}`,borderRadius:F.shape.radius.default,display:"flex",flexDirection:"column",flexGrow:1}),panelHeader:(0,Ye.css)({alignItems:"center",color:F.colors.text.primary,display:"flex",fontSize:Math.round(F.typography.fontSize/3),height:F.spacing(2),lineHeight:Math.round(F.typography.body.lineHeight/3),padding:F.spacing(.5)}),formLabel:(0,Ye.css)({color:F.colors.text.primary,fontSize:Math.round(F.typography.fontSize/3),lineHeight:Math.round(F.typography.body.lineHeight/3)}),formInput:(0,Ye.css)({background:F.components.input.background,border:`1px solid ${F.colors.border.medium}`,borderRadius:F.shape.radius.default,height:F.spacing(1),width:F.spacing(6)}),action:(0,Ye.css)({borderRadius:F.shape.radius.default,height:F.spacing(1),width:F.spacing(2.5)}),actionSecondary:(0,Ye.css)({background:F.colors.secondary.main}),actionDanger:(0,Ye.css)({background:F.colors.error.main}),actionPrimary:(0,Ye.css)({background:F.colors.primary.main})});function ng({themeOption:F,isExperimental:G,isSelected:k,onSelect:re}){const ue=F.build(),ge=sg(F),Pe=(0,mt.of)(ag);return(0,I.jsxs)("div",{className:Pe.card,onClick:re,children:[(0,I.jsxs)("div",{className:Pe.header,children:[(0,I.jsx)(fh.J,{id:`theme-${ue.name}`,name:"theme",label:ge,onClick:Ae=>{Ae.stopPropagation()},onChange:re,checked:k}),G&&(0,I.jsx)(Yu.y,{featureState:nc.Ay.experimental})]}),(0,I.jsx)(ph,{theme:ue})]})}const ag=F=>({card:(0,Ye.css)({border:`1px solid ${F.colors.border.weak}`,borderRadius:F.shape.radius.default,display:"flex",flexDirection:"column",overflow:"hidden",cursor:"pointer","&:hover":{border:`1px solid ${F.colors.border.medium}`}}),header:(0,Ye.css)({alignItems:"center",borderBottom:`1px solid ${F.colors.border.weak}`,display:"flex",justifyContent:"space-between",padding:F.spacing(1),"> label":{cursor:"pointer"}})});function sg(F){switch(F.id){case"dark":return(0,d.t)("shared.preferences.theme.dark-label","Dark");case"light":return(0,d.t)("shared.preferences.theme.light-label","Light");case"system":return(0,d.t)("shared.preferences.theme.system-label","System preference");default:return F.name}}var rg=e(61074);function og({onClose:F}){const G=(0,mt.of)(ig),k=(0,rg.F)(),re=(0,mt.$j)(),ue=Pe=>{(0,ja.rR)("grafana_preferences_theme_changed",{toTheme:Pe.id,preferenceType:"theme_drawer"}),(0,Ci.K)(Pe.id,!1)},ge=(0,I.jsxs)(d.x6,{i18nKey:"shared-preferences.fields.theme-description",children:["Enjoying the experimental themes? Tell us what you'd like to see"," ",(0,I.jsx)(Qi.Y,{variant:"bodySmall",external:!0,href:"https://docs.google.com/forms/d/e/1FAIpQLSeRKAY8nUMEVIKSYJ99uOO-dimF6Y69_If1Q1jTLOZRWqK1cw/viewform?usp=dialog",children:"here."})]});return(0,I.jsx)(No._,{title:(0,d.t)("profile.change-theme","Change theme"),onClose:F,size:"md",subtitle:X.$.feedbackLinksEnabled?ge:void 0,children:(0,I.jsx)("div",{className:G.grid,role:"radiogroup",children:k.map(Pe=>(0,I.jsx)(ng,{themeOption:Pe,isExperimental:Pe.isExtra,onSelect:()=>ue(Pe),isSelected:re.name===Pe.name},Pe.id))})})}const ig=F=>({grid:(0,Ye.css)({display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gridAutoRows:"250px",gap:F.spacing(2)})});var lg=e(73745),gh=e(49229),cg=e(49185),fo=e(46831),dg=e(30054);function ug({feedUrl:F}){const G=(0,mt.of)(hg),{state:k,getNews:re}=(0,dg.n)(F),[ue,ge]=(0,cg.A)();return(0,l.useEffect)(()=>{re()},[re]),k.error?(0,I.jsx)("div",{className:G.innerWrapper,children:k.error&&k.error.message}):(0,I.jsxs)("div",{ref:ue,children:[k.loading?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(fo.K.Skeleton,{showImage:!0,width:ge.width}),(0,I.jsx)(fo.K.Skeleton,{showImage:!0,width:ge.width}),(0,I.jsx)(fo.K.Skeleton,{showImage:!0,width:ge.width}),(0,I.jsx)(fo.K.Skeleton,{showImage:!0,width:ge.width}),(0,I.jsx)(fo.K.Skeleton,{showImage:!0,width:ge.width})]}):(0,I.jsx)(I.Fragment,{children:ge.width>0&&k.value?.map((Pe,Ae)=>(0,I.jsx)(fo.K,{index:Ae,showImage:!0,width:ge.width,data:k.value},Ae))}),(0,I.jsx)("div",{className:G.grot,children:(0,I.jsx)("a",{href:"https://grafana.com/blog/",target:"_blank",rel:"noreferrer",title:(0,d.t)("news.link-title","Go to Grafana labs blog"),children:(0,I.jsx)("img",{src:gh,alt:"Grot reading news"})})})]})}const hg=F=>({innerWrapper:(0,Ye.css)({width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}),grot:(0,Ye.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:F.spacing(5,0),img:{width:"186px",height:"186px"}})});function fg({onClose:F}){const G=(0,mt.of)(zo);return(0,I.jsx)(No._,{title:(0,I.jsxs)("div",{className:G.title,children:[(0,I.jsx)(Ta.E,{element:"h2",children:(0,d.t)("news.title","Latest from the blog")}),(0,I.jsx)("a",{href:"https://grafana.com/blog/",target:"_blank",rel:"noreferrer",title:(0,d.t)("news.link-title","Go to Grafana labs blog"),className:G.grot,children:(0,I.jsx)("img",{src:gh,alt:"Grot reading news"})})]}),onClose:F,size:"md",children:(0,I.jsx)(ug,{feedUrl:lg.$})})}const zo=F=>({title:(0,Ye.css)({display:"flex",alignItems:"center",justifyContent:"center",gap:F.spacing(2)}),grot:(0,Ye.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:F.spacing(2,0),img:{width:"75px",height:"75px"}})});function oc({node:F,children:G}){const k=(0,mt.of)(mh),re=(0,yr.J0)((0,J.cloneDeep)(F),!1);return re?(0,I.jsxs)(gr.W,{header:(0,I.jsxs)("div",{onClick:ue=>ue.stopPropagation(),className:k.header,children:[(0,I.jsx)("div",{children:re.text}),re.subTitle&&(0,I.jsx)("div",{className:k.subTitle,children:re.subTitle})]}),children:[re.children?.map(ue=>ue.url?(0,I.jsx)(Bi.D,{url:ue.url,label:ue.text,icon:ue.icon,target:ue.target},ue.id):(0,I.jsx)(Bi.D,{icon:ue.icon,onClick:ue.onClick,label:ue.text},ue.id)),G]}):null}const mh=F=>({header:(0,Ye.css)({fontSize:F.typography.h5.fontSize,fontWeight:F.typography.h5.fontWeight,padding:F.spacing(.5,1),whiteSpace:"nowrap"}),subTitle:(0,Ye.css)({color:F.colors.text.secondary,fontSize:F.typography.bodySmall.fontSize})});function pg({profileNode:F,onToggleKioskMode:G}){const k=(0,mt.of)(gg),re=(0,yr.J0)((0,J.cloneDeep)(F),!1),[ue,ge]=(0,Id.A)(!1),[Pe,Ae]=(0,Id.A)(!1);if(!re)return null;const We=()=>(0,I.jsx)(oc,{node:F,children:(0,I.jsxs)(I.Fragment,{children:[X.$.featureToggles.grafanaconThemes&&(0,I.jsx)(Bi.D,{icon:"palette",onClick:Ae,label:(0,d.t)("profile.change-theme","Change theme")}),(0,I.jsx)(gr.W.Item,{icon:"monitor",onClick:G,label:(0,d.t)("profile.enable-kiosk-mode","Enable kiosk mode")}),X.$.newsFeedEnabled&&(0,I.jsx)(Bi.D,{icon:"rss",onClick:ge,label:(0,d.t)("navigation.rss-button","Latest from the blog")}),(0,I.jsx)(gr.W.Divider,{}),!X.$.auth.disableSignoutMenu&&(0,I.jsx)(Bi.D,{url:`${X.$.appSubUrl}/logout`,label:(0,d.t)("nav.sign-out.title","Sign out"),icon:"arrow-from-right",target:"_self"})]})});return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(Ei.m,{overlay:We,placement:"bottom-end",children:(0,I.jsx)(Mr.I,{className:k.profileButton,imgSrc:Gs.TP.user.gravatarUrl,imgAlt:"User avatar","aria-label":(0,d.t)("navigation.profile.aria-label","Profile")})}),ue&&(0,I.jsx)(fg,{onClose:ge}),Pe&&(0,I.jsx)(og,{onClose:Ae})]})}const gg=F=>({profileButton:(0,Ye.css)({padding:F.spacing(0,.5),img:{borderRadius:F.shape.radius.circle,height:"24px",marginRight:0,width:"24px"}})});var vh=e(63704);function mg(){const F=(0,Pa.zy)(),G=(0,mt.of)(vg);let k=vh.sQ.sanitizeUrl(y.I.getUrlForPartial(F,{forceLogin:"true"}));return k.startsWith("//")&&(k=k.replace(/\/+/g,"/")),(0,I.jsx)("a",{className:G.link,href:k,target:"_self",children:(0,I.jsx)(d.x6,{i18nKey:"app-chrome.top-bar.sign-in",children:"Sign in"})})}const vg=F=>({link:(0,Ye.css)({paddingLeft:F.spacing(1),paddingRight:F.spacing(1),whiteSpace:"nowrap","&:hover":{textDecoration:"underline"}})});var yh=e(68079);function Jg({nodes:F,scopes:G,appliedScopes:k,disabled:re,loading:ue,onInputClick:ge,onRemoveAllClick:Pe}){const[Ae,We]=(0,l.useState)(!1);(0,l.useEffect)(()=>{We(!1)},[k]);const qe=k.length>0?(0,I.jsx)(yg,{nodes:F,scopes:G,appliedScopes:k}):(0,I.jsx)(I.Fragment,{}),et=(0,l.useMemo)(()=>k.map(lt=>G[lt.scopeId]?.spec.title||lt.scopeId).join(", "),[k,G]),rt=(0,l.useMemo)(()=>(0,I.jsx)(tn.p,{readOnly:!0,placeholder:(0,d.t)("scopes.selector.input.placeholder","Select scopes..."),disabled:re,loading:ue,value:et,"aria-label":(0,d.t)("scopes.selector.input.placeholder","Select scopes..."),"data-testid":"scopes-selector-input",suffix:k.length>0&&!re?(0,I.jsx)(is.K,{"aria-label":(0,d.t)("scopes.selector.input.removeAll","Remove all scopes"),name:"times","data-testid":"scopes-selector-input-clear",onClick:()=>Pe()}):void 0,onMouseOver:()=>We(!0),onMouseOut:()=>We(!1),onClick:()=>{re||ge()}}),[re,ue,ge,Pe,k,et]);return(0,I.jsx)(Kr.m,{content:qe,show:k.length===0?!1:Ae,children:rt})}function yg({nodes:F,scopes:G,appliedScopes:k}){const re=(0,mt.of)(xg);let ue;if(k[0].scopeNodeId){let Pe=Ql(k[0].scopeNodeId,F);Pe=Pe.slice(1,-1),ue=Pe.map(Ae=>F[Ae]?.spec.title).filter(Ae=>Ae)}const ge=k.map(Pe=>Pe.scopeNodeId?F[Pe.scopeNodeId]?.spec.title||Pe.scopeNodeId:G[Pe.scopeId]?.spec.title||Pe.scopeId);return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("p",{className:re.scopePath,children:(ue&&ue.length>0?ue.join(" > ")+" > ":"")+ge.join(", ")})})}const xg=F=>({scopePath:(0,Ye.css)({color:F.colors.text.primary,fontSize:F.typography.pxToRem(12),margin:F.spacing(0,0)})});var Eg=e(70255);const Pg=({recentScopes:F,onSelect:G})=>{const k=(0,mt.of)(bg),[re,ue]=(0,l.useState)(!1),ge=(0,l.useId)();return(0,I.jsxs)("fieldset",{children:[(0,I.jsx)("legend",{className:k.legend,children:(0,I.jsxs)("button",{className:k.expandButton,"aria-expanded":re,"aria-controls":ge,onClick:()=>ue(!re),"data-testid":"scopes-selector-recent-scopes-section",children:[(0,I.jsx)(_n.I,{name:re?"angle-down":"angle-right"}),(0,I.jsx)(Ta.E,{variant:"body",children:(0,I.jsx)(d.x6,{i18nKey:"command-palette.section.recent-scopes"})})]})}),(0,I.jsx)(ie.a,{paddingLeft:3,paddingTop:re?1:0,paddingBottom:re?1:0,children:(0,I.jsx)(kt.B,{direction:"column",gap:1,id:ge,children:re&&F.map(Pe=>(0,I.jsx)("button",{className:k.recentScopeButton,onClick:()=>{G(Pe.map(Ae=>Ae.metadata.name))},children:(0,I.jsx)(Ta.E,{children:Pe.map(Ae=>Ae.spec.title).join(", ")})},Pe.map(Ae=>Ae.metadata.name).join(",")))})})]})},bg=F=>({recentScopeButton:(0,Ye.css)({textAlign:"left",background:"none",border:"none",padding:0,cursor:"pointer",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}),expandButton:(0,Ye.css)({display:"flex",alignItems:"center",gap:F.spacing(1),background:"none",border:"none",padding:0,cursor:"pointer"}),legend:(0,Ye.css)({marginBottom:0})});function Dg({anyChildExpanded:F,query:G,resultsNodes:k,scopeNodes:re}){const ue=(0,mt.of)(Sr);return F||k.some(ge=>re[ge.scopeNodeId].spec.nodeType==="container")&&!G?null:(0,I.jsx)("h6",{className:ue.container,"data-testid":"scopes-tree-headline",children:G?k.length===0?(0,I.jsx)(d.x6,{i18nKey:"scopes.tree.headline.noResults",children:"No results found for your query"}):(0,I.jsx)(d.x6,{i18nKey:"scopes.tree.headline.results",children:"Results"}):(0,I.jsx)(d.x6,{i18nKey:"scopes.tree.headline.recommended",children:"Recommended"})})}const Sr=F=>({container:(0,Ye.css)({color:F.colors.text.secondary,margin:F.spacing(1,0)})});var Cg=e(32635);function Tg({anyChildExpanded:F,loadingNodeName:G,treeNode:k,onNodeUpdate:re,scopeNodes:ue,selected:ge,selectedScopes:Pe,selectScope:Ae,deselectScope:We}){const qe=(0,mt.of)(Mg);if(F&&!k.expanded)return null;const et=ue[k.scopeNodeId];if(!et)return null;const lt=(et.spec.parentName?ue[et.spec.parentName]:void 0)?.spec.disableMultiSelect??!1,pt=rd(et),ht=cu(et);return(0,I.jsxs)("div",{role:"treeitem","aria-selected":k.expanded,className:F?qe.expandedContainer:void 0,children:[(0,I.jsxs)("div",{className:(0,Ye.cx)(qe.title,pt&&!k.expanded&&qe.titlePadding),children:[pt&&!k.expanded?lt?(0,I.jsx)(fh.J,{id:k.scopeNodeId,name:k.scopeNodeId,checked:ge,label:"","data-testid":`scopes-tree-${k.scopeNodeId}-radio`,onClick:()=>{ge?We(k.scopeNodeId):Ae(k.scopeNodeId)}}):(0,I.jsx)(Cg.S,{checked:ge,"data-testid":`scopes-tree-${k.scopeNodeId}-checkbox`,onChange:()=>{ge?We(k.scopeNodeId):Ae(k.scopeNodeId)}}):null,ht?(0,I.jsxs)("button",{className:qe.expand,"data-testid":`scopes-tree-${k.scopeNodeId}-expand`,"aria-label":k.expanded?(0,d.t)("scopes.tree.collapse","Collapse"):(0,d.t)("scopes.tree.expand","Expand"),onClick:()=>{re(k.scopeNodeId,!k.expanded,k.query)},children:[(0,I.jsx)(_n.I,{name:k.expanded?"angle-down":"angle-right"}),et.spec.title]}):(0,I.jsx)("span",{"data-testid":`scopes-tree-${k.scopeNodeId}-title`,children:et.spec.title})]}),(0,I.jsx)("div",{className:qe.children,children:k.expanded&&(0,I.jsx)(xh,{tree:k,loadingNodeName:G,onNodeUpdate:re,scopeNodes:ue,selectedScopes:Pe,selectScope:Ae,deselectScope:We})})]},k.scopeNodeId)}const Mg=F=>({expandedContainer:(0,Ye.css)({display:"flex",flexDirection:"column",maxHeight:"100%"}),title:(0,Ye.css)({alignItems:"center",display:"flex",gap:F.spacing(1),fontSize:F.typography.pxToRem(14),lineHeight:F.typography.pxToRem(22),padding:F.spacing(.5,0),"& > label":(0,Ye.css)({gap:0})}),titlePadding:(0,Ye.css)({paddingLeft:F.spacing(.5)}),expand:(0,Ye.css)({alignItems:"center",background:"none",border:0,display:"flex",gap:F.spacing(1),margin:0,padding:0}),children:(0,Ye.css)({display:"flex",flexDirection:"column",overflowY:"hidden",maxHeight:"100%",paddingLeft:F.spacing(4)})});function ic({items:F,anyChildExpanded:G,lastExpandedNode:k,maxHeight:re,selectedScopes:ue,scopeNodes:ge,loadingNodeName:Pe,onNodeUpdate:Ae,selectScope:We,deselectScope:qe}){const et=(0,mt.of)(Sg);if(F.length===0)return null;const rt=(0,I.jsx)("div",{role:"tree",className:G?et.expandedContainer:void 0,children:F.map(lt=>{const pt=rd(ge[lt.scopeNodeId])&&ue.some(ht=>ht.scopeNodeId?ht.scopeNodeId===lt.scopeNodeId:ht.scopeId===ge[lt.scopeNodeId]?.spec.linkId);return(0,I.jsx)(Tg,{treeNode:lt,selected:pt,selectedScopes:ue,scopeNodes:ge,loadingNodeName:Pe,anyChildExpanded:G,onNodeUpdate:Ae,selectScope:We,deselectScope:qe},lt.scopeNodeId)})});return k?(0,I.jsx)(Fo.P,{minHeight:`${Math.min(5,F.length)*30}px`,maxHeight:re,children:rt}):rt}const Sg=F=>({expandedContainer:(0,Ye.css)({display:"flex",flexDirection:"column",maxHeight:"100%"})});function jd({anyChildExpanded:F,treeNode:G,onNodeUpdate:k}){const re=(0,mt.of)(Og),[ue,ge]=(0,l.useState)({value:G.query,dirty:!1});return(0,l.useEffect)(()=>{!ue.dirty&&ue.value!==G.query&&ge({value:G.query,dirty:!1})},[ue,G.query]),(0,Hu.A)(()=>{ue.dirty&&k(G.scopeNodeId,!0,ue.value)},500,[ue.dirty,ue.value]),F?null:(0,I.jsx)(xd.Z,{placeholder:(0,d.t)("scopes.tree.search","Search"),value:ue.value,className:re.input,"data-testid":"scopes-tree-search",escapeRegex:!1,onChange:Pe=>{ge({value:Pe,dirty:!0})}})}const Og=F=>({input:(0,Ye.css)({margin:F.spacing(1,0),minHeight:F.spacing(4),height:F.spacing(4),maxHeight:F.spacing(4),width:`calc(100% - ${F.spacing(.5)})`})});function xh({tree:F,loadingNodeName:G,selectedScopes:k,recentScopes:re,onRecentScopesSelect:ue,onNodeUpdate:ge,scopeNodes:Pe,selectScope:Ae,deselectScope:We}){const qe=(0,mt.of)(Ig),et=G===F.scopeNodeId,rt=F.children;let lt=Object.values(rt||{});const pt=lt.some(({expanded:Wt})=>Wt);let ht=[];k.length>0&&k[0].scopeNodeId&&F.scopeNodeId===Pe[k[0].scopeNodeId]?.spec.parentName&&(ht=k.filter(Wt=>!lt.map(en=>en.scopeNodeId).includes(Wt.scopeNodeId)).map(Wt=>({scopeNodeId:Wt.scopeNodeId,query:"",expanded:!1})));const Ct=!pt&&F.expanded;return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(jd,{anyChildExpanded:pt,onNodeUpdate:ge,treeNode:F}),F.scopeNodeId===""&&!pt&&re&&re.length>0&&ue&&!F.query&&(0,I.jsx)(Pg,{recentScopes:re,onSelect:ue}),et?(0,I.jsx)(Eg.A,{count:5,className:qe.loader}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(ic,{items:ht,anyChildExpanded:pt,lastExpandedNode:Ct,loadingNodeName:G,onNodeUpdate:ge,selectedScopes:k,scopeNodes:Pe,selectScope:Ae,deselectScope:We,maxHeight:`${Math.min(5,ht.length)*30}px`}),(0,I.jsx)(Dg,{anyChildExpanded:pt,query:F.query,resultsNodes:lt,scopeNodes:Pe}),(0,I.jsx)(ic,{items:lt,anyChildExpanded:pt,lastExpandedNode:Ct,loadingNodeName:G,onNodeUpdate:ge,selectedScopes:k,scopeNodes:Pe,selectScope:Ae,deselectScope:We,maxHeight:"100%"})]})]})}const Ig=F=>({loader:(0,Ye.css)({margin:F.spacing(.5,0)})}),be=()=>{const{chrome:F}=(0,mr.Il)(),G=F.useState(),k=!G.chromeless&&G.megaMenuDocked&&G.megaMenuOpen,re=(0,mt.of)(Ne,k),ue=(0,Gl.b)(),ge=Yl(),Pe=(0,Tr.A)(ge?.scopesSelectorService.stateObservable??new Di.c,ge?.scopesSelectorService.state);if(!ge||!ue||!ue.state.enabled||!Pe)return null;const{nodes:Ae,loadingNodeName:We,opened:qe,selectedScopes:et,appliedScopes:rt,tree:lt,scopes:pt}=Pe,{scopesService:ht,scopesSelectorService:Ct,scopesDashboardsService:Wt}=ge,{readOnly:en,drawerOpened:on,loading:vn}=ue.state,{open:an,removeAllScopes:gn,closeAndApply:$n,closeAndReset:Ea,updateNode:Rr,selectScope:uc,deselectScope:uE,getRecentScopes:hE}=Ct,fE=hE(),$m=en?(0,d.t)("scopes.dashboards.toggle.disabled","Suggested dashboards list is disabled due to read only mode"):on?(0,d.t)("scopes.dashboards.toggle.collapse","Collapse suggested dashboards list"):(0,d.t)("scopes.dashboards.toggle.expand","Expand suggested dashboards list");return(0,I.jsxs)("div",{className:re.container,children:[(0,I.jsx)(is.K,{name:"web-section-alt",className:re.dashboards,"aria-label":$m,tooltip:$m,"data-testid":"scopes-dashboards-expand",disabled:en,onClick:Wt.toggleDrawer}),(0,I.jsx)(Jg,{nodes:Ae,scopes:pt,appliedScopes:rt,disabled:en,loading:vn,onInputClick:()=>{ht.state.readOnly||an()},onRemoveAllClick:gn}),qe&&(0,I.jsx)(No._,{title:(0,d.t)("scopes.selector.title","Select scopes"),size:"sm",onClose:Ea,children:(0,I.jsxs)("div",{className:re.drawerContainer,children:[(0,I.jsx)("div",{className:re.treeContainer,children:vn||!lt?(0,I.jsx)(yh.y,{"data-testid":"scopes-selector-loading"}):(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(xh,{tree:lt,loadingNodeName:We,onNodeUpdate:Rr,recentScopes:fE,selectedScopes:et,scopeNodes:Ae,selectScope:uc,deselectScope:uE,onRecentScopesSelect:pE=>{Ct.changeScopes(pE),Ct.closeAndReset()}})})}),(0,I.jsxs)("div",{className:re.buttonsContainer,children:[(0,I.jsx)(ve.$n,{variant:"primary","data-testid":"scopes-selector-apply",onClick:$n,children:(0,I.jsx)(d.x6,{i18nKey:"scopes.selector.apply",children:"Apply"})}),(0,I.jsx)(ve.$n,{variant:"secondary","data-testid":"scopes-selector-cancel",onClick:Ea,children:(0,I.jsx)(d.x6,{i18nKey:"scopes.selector.cancel",children:"Cancel"})})]})]})})]})},Ne=(F,G)=>({container:(0,Ye.css)({display:"flex",flexDirection:"row",paddingLeft:G?F.spacing(2):"unset"}),dashboards:(0,Ye.css)({color:F.colors.text.secondary,marginRight:F.spacing(2),"&:hover":(0,Ye.css)({color:F.colors.text.primary})}),drawerContainer:(0,Ye.css)({display:"flex",flexDirection:"column",height:"100%"}),treeContainer:(0,Ye.css)({display:"flex",flexDirection:"column",maxHeight:"100%",overflowY:"hidden",paddingLeft:F.spacing(.5)}),buttonsContainer:(0,Ye.css)({display:"flex",gap:F.spacing(1),marginTop:F.spacing(8)})});var Qe=e(31937);function st({actions:F,breadcrumbActions:G,scopes:k}){const re=(0,mt.of)(ot);return(0,I.jsx)("div",{"data-testid":Sa.XF.NavToolbar.container,className:re.actionsBar,children:(0,I.jsxs)(kt.B,{alignItems:"center",justifyContent:"flex-start",flex:1,wrap:"nowrap",minWidth:0,children:[k?.state.enabled?(0,I.jsx)(be,{}):void 0,(0,I.jsxs)(kt.B,{alignItems:"center",justifyContent:"flex-end",flex:1,wrap:"nowrap",minWidth:0,children:[G,G&&F&&(0,I.jsx)($o.K,{}),F]})]})})}const ot=F=>({actionsBar:(0,Ye.css)({alignItems:"center",backgroundColor:F.colors.background.primary,borderBottom:`1px solid ${F.colors.border.weak}`,display:"flex",height:(0,Qe.vn)(),padding:F.spacing(0,1,0,2)})});var it=e(35484);const Ot=l.memo(()=>{const{query:F}=(0,Ra.useKBar)(re=>({kbarSearchQuery:re.searchQuery,kbarIsOpen:re.visualState===Ra.VisualState.showing})),G=(0,Jl.i)("lg"),k=()=>{F.toggle()};return G?(0,I.jsx)(Tt,{onClick:k}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(Mr.I,{iconOnly:!0,icon:"search","aria-label":(0,d.t)("nav.search.placeholderCommandPalette","Search..."),onClick:k}),(0,I.jsx)($o.K,{})]})});function Tt({onClick:F}){const G=(0,mt.of)(Nt),k=(0,l.useMemo)(()=>(0,pd.gn)(),[]);return(0,I.jsx)("div",{className:G.wrapper,"data-testid":Sa.Tp.components.NavToolbar.commandPaletteTrigger,children:(0,I.jsxs)("div",{className:G.inputWrapper,children:[(0,I.jsx)("div",{className:G.prefix,children:(0,I.jsx)(_n.I,{name:"search"})}),(0,I.jsx)("button",{className:G.fakeInput,onClick:F,children:(0,d.t)("nav.search.placeholderCommandPalette","Search...")}),(0,I.jsx)("div",{className:G.suffix,children:(0,I.jsx)(Ta.E,{variant:"bodySmall",children:`${k}+k`})})]})})}const Nt=F=>{const G=(0,tn.n)({theme:F});return{wrapper:(0,Ye.cx)(G.wrapper,(0,Ye.css)({width:"auto",minWidth:140,maxWidth:350,flexGrow:1})),inputWrapper:G.inputWrapper,prefix:G.prefix,suffix:(0,Ye.css)([G.suffix,{display:"flex",gap:F.spacing(.5)}]),fakeInput:(0,Ye.css)([G.input,{textAlign:"left",paddingLeft:28,color:F.colors.text.disabled,"&:focus":{outline:"unset",boxShadow:"unset"},"&:focus-visible":(0,it.getFocusStyles)(F)}]),button:(0,Ye.css)({width:"100%",textAlign:"center","> *":{width:"100%",textAlign:"center",justifyContent:"center",gap:"1ch"}})}},wt=(0,l.memo)(function({onToggleMegaMenu:G,onToggleKioskMode:k,pageNav:re,sectionNav:ue,scopes:ge,actions:Pe,breadcrumbActions:Ae,showToolbarLevel:We}){const{chrome:qe}=(0,mr.Il)(),et=qe.useState(),rt=!et.chromeless&&et.megaMenuDocked&&et.megaMenuOpen,lt=(0,mt.of)(Ht,rt),pt=(0,nr.d4)(gn=>gn.navIndex),ht=(0,J.cloneDeep)(pt.help),Ct=ht?(0,yr.CS)(ht):void 0,Wt=pt.profile,en=(0,nr.d4)(gn=>gn.navIndex)[Md.Id],on=(0,eh.Z)(ue,re,en),vn=Y.$W.featureToggles.unifiedHistory,an=!(0,Jl.i)("sm");return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)("div",{className:lt.layout,children:[(0,I.jsxs)(kt.B,{minWidth:0,gap:.5,alignItems:"center",flex:{xs:2,lg:1},children:[!rt&&(0,I.jsx)(Mr.I,{narrow:!0,id:_p.Ut,onClick:G,tooltip:(0,d.t)("navigation.megamenu.open","Open menu"),children:(0,I.jsxs)(kt.B,{gap:0,alignItems:"center",children:[(0,I.jsx)(ih.M.MenuLogo,{className:lt.img}),(0,I.jsx)(_n.I,{size:"sm",name:"angle-down"})]})}),(0,I.jsx)(Gp,{breadcrumbs:on,className:lt.breadcrumbsWrapper}),!We&&Ae]}),(0,I.jsxs)(kt.B,{gap:.5,alignItems:"center",justifyContent:"flex-end",flex:1,"data-testid":We?void 0:Sa.XF.NavToolbar.container,minWidth:{xs:"unset",lg:0},children:[(0,I.jsx)(Ot,{}),vn&&!an&&(0,I.jsx)(Zp,{}),!an&&(0,I.jsx)(hh,{}),Ct&&(0,I.jsx)(Ei.m,{overlay:()=>(0,I.jsx)(oc,{node:Ct}),placement:"bottom-end",children:(0,I.jsx)(Mr.I,{iconOnly:!0,icon:"question-circle","aria-label":(0,d.t)("navigation.help.aria-label","Help")})}),(0,I.jsx)($o.K,{}),Y.$W.featureToggles.extensionSidebar&&!an&&(0,I.jsx)(lh,{}),!We&&Pe,!Gs.TP.user.isSignedIn&&(0,I.jsx)(mg,{}),Wt&&(0,I.jsx)(pg,{profileNode:Wt,onToggleKioskMode:k})]})]}),We&&(0,I.jsx)(st,{scopes:ge,actions:Pe,breadcrumbActions:Ae})]})}),Ht=(F,G)=>({layout:(0,Ye.css)({height:(0,Qe.vn)(),display:"flex",gap:F.spacing(2),alignItems:"center",padding:F.spacing(0,1),paddingLeft:G?F.spacing(3.5):F.spacing(.75),borderBottom:`1px solid ${F.colors.border.weak}`,justifyContent:"space-between"}),breadcrumbsWrapper:(0,Ye.css)({display:"flex",overflow:"hidden",[F.breakpoints.down("sm")]:{minWidth:"40%"}}),img:(0,Ye.css)({alignSelf:"center",height:F.spacing(3),width:F.spacing(3)}),kioskToggle:(0,Ye.css)({[F.breakpoints.down("lg")]:{display:"none"}})});function rn({children:F}){const{chrome:G}=(0,mr.Il)(),{isOpen:k,isEnabled:re,extensionSidebarWidth:ue,setExtensionSidebarWidth:ge}=(0,$r.sA)(),Pe=G.useState(),Ae=(0,Gl.b)(),We=!Pe.chromeless&&Pe.megaMenuDocked&&Pe.megaMenuOpen,qe=!!(Ae?.state.enabled&&Ae?.state.drawerOpened&&!Ae?.state.readOnly),et=(0,Qe.UH)(),rt=et*(0,Qe.vn)(),lt=(0,mt.of)(pn,rt),pt=(0,mt.of)(Vn,ue),ht=(0,mt.of)(Kf.l);sn(G),(0,yr.n0)(Pe.megaMenuOpen,Pe.megaMenuDocked);const Ct=(0,Ye.cx)({[lt.content]:!0,[lt.contentChromeless]:Pe.chromeless,[lt.contentWithSidebar]:k&&!Pe.chromeless}),Wt=()=>{G.setMegaMenuOpen(!Pe.megaMenuOpen)},{pathname:en,search:on}=C.Ny.getLocation(),vn=en+on,an=Pe.returnToPrevious&&vn!==Pe.returnToPrevious.href;return(0,l.useEffect)(()=>{Pe.returnToPrevious&&vn===Pe.returnToPrevious.href&&G.clearReturnToPrevious("auto_dismissed")},[G,vn]),(0,l.useEffect)(()=>{const gn=(0,C.SE)(on);G.setKioskModeFromUrl(gn.kiosk)},[G,on]),(0,I.jsxs)("div",{className:Wf()("main-view",{"main-view--chrome-hidden":Pe.chromeless}),children:[!Pe.chromeless&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(ve.z9,{className:lt.skipLink,href:"#pageContent",children:(0,I.jsx)(d.x6,{i18nKey:"app-chrome.skip-content-button",children:"Skip to main content"})}),We&&(0,I.jsx)(Pd,{className:lt.dockedMegaMenu,onClose:()=>G.setMegaMenuOpen(!1)}),(0,I.jsx)("header",{className:(0,Ye.cx)(lt.topNav,We&&lt.topNavMenuDocked),children:(0,I.jsx)(wt,{sectionNav:Pe.sectionNav.node,pageNav:Pe.pageNav,onToggleMegaMenu:Wt,onToggleKioskMode:G.onToggleKioskMode,actions:Pe.actions,breadcrumbActions:Pe.breadcrumbActions,scopes:Ae,showToolbarLevel:et===2})})]}),(0,I.jsx)("div",{className:Ct,children:(0,I.jsxs)("div",{className:(0,Ye.cx)(lt.panes,{[lt.panesWithSidebar]:k}),children:[!Pe.chromeless&&(0,I.jsx)("div",{className:(0,Ye.cx)(lt.scopesDashboardsContainer,{[lt.scopesDashboardsContainerDocked]:We}),children:(0,I.jsx)(gi.Xw,{children:(0,I.jsx)(tc,{})})}),(0,I.jsx)("main",{className:(0,Ye.cx)(lt.pageContainer,{[lt.pageContainerMenuDocked]:We||qe,[lt.pageContainerMenuDockedScopes]:We&&qe,[lt.pageContainerWithSidebar]:!Pe.chromeless&&k,[pt.contentWidth]:!Pe.chromeless&&k}),id:"pageContent",children:F}),!Pe.chromeless&&re&&k&&(0,I.jsx)(Nf.c,{className:lt.sidebarContainer,defaultSize:{width:ue},enable:{left:!0},onResize:(gn,$n,Ea)=>ge(Ea.getBoundingClientRect().width),handleClasses:{left:ht.dragHandleBaseVertical},minWidth:Td.nf,maxWidth:Td.T0,children:(0,I.jsx)(Td.EE,{})})]})}),!Pe.chromeless&&!Pe.megaMenuDocked&&(0,I.jsx)(Wp,{}),!Pe.chromeless&&(0,I.jsx)(pp,{}),an&&Pe.returnToPrevious&&(0,I.jsx)(rh,{href:Pe.returnToPrevious.href,title:Pe.returnToPrevious.title})]})}function sn(F){const G=vr.A.getBool(Dd,!0),k=(0,Jl.i)("xl");(0,l.useEffect)(()=>{if(!G)return;const re=F.state.getValue();k&&!re.megaMenuDocked?(F.setMegaMenuDocked(!0,!1),F.setMegaMenuOpen(!0)):!k&&re.megaMenuDocked&&(F.setMegaMenuDocked(!1,!1),F.setMegaMenuOpen(!1))},[k,F,G])}const pn=(F,G)=>({content:(0,Ye.css)({label:"page-content",display:"flex",flexDirection:"column",paddingTop:G,flexGrow:1,height:"auto"}),contentWithSidebar:(0,Ye.css)({height:"100vh",overflow:"hidden"}),contentChromeless:(0,Ye.css)({paddingTop:0}),dockedMegaMenu:(0,Ye.css)({background:F.colors.background.primary,borderRight:`1px solid ${F.colors.border.weak}`,display:"none",height:"100%",position:"fixed",top:0,width:ho,zIndex:2,[F.breakpoints.up("xl")]:{display:"flex",flexDirection:"column"}}),scopesDashboardsContainer:(0,Ye.css)({position:"fixed",height:`calc(100% - ${G}px)`,zIndex:1}),scopesDashboardsContainerDocked:(0,Ye.css)({left:ho}),topNav:(0,Ye.css)({display:"flex",position:"fixed",zIndex:F.zIndex.navbarFixed,left:0,right:0,background:F.colors.background.primary,flexDirection:"column"}),topNavMenuDocked:(0,Ye.css)({left:ho}),panes:(0,Ye.css)({display:"flex",flexDirection:"column",flexGrow:1,label:"page-panes"}),panesWithSidebar:(0,Ye.css)({height:"100%",overflow:"hidden",position:"relative"}),pageContainerMenuDocked:(0,Ye.css)({paddingLeft:ho}),pageContainerMenuDockedScopes:(0,Ye.css)({paddingLeft:`calc(${ho} * 2)`}),pageContainer:(0,Ye.css)({label:"page-container",display:"flex",flexDirection:"column",flexGrow:1}),pageContainerWithSidebar:(0,Ye.css)({overflow:"auto",height:"100%",minHeight:0}),skipLink:(0,Ye.css)({position:"fixed",top:-1e3,":focus":{left:F.spacing(1),top:F.spacing(1),zIndex:F.zIndex.portal}}),sidebarContainer:(0,Ye.css)({position:"fixed !important",top:G,bottom:0,zIndex:2,right:0})}),Vn=(F,G=0)=>({contentWidth:(0,Ye.css)({maxWidth:`calc(100% - ${G}px) !important`})});var va=e(22099);const Qn={"/login":!0,"/signup":!0,"/verify":!0,"/user/password/send-reset-email":!0,"/user/password/reset":!0,"/sandbox/benchmarks":!0};function ss(){const F=(0,pu.zy)();return X.$.featureToggles.enableAppChromeExtensions!==!0||Qn[F.pathname]?null:(0,I.jsx)(Ga,{})}function Ga(){const{components:F,isLoading:G}=(0,K.f)({extensionPointId:Mi.S.AppChrome});return G?null:(0,va.RC)({props:{},components:F,pluginId:"grafana-setupguide-app"})}var Ha=e(6890),Na=e(12066),Ps=e(94701);function On({appNotification:F,onClearNotification:G}){const k=(0,mt.of)(dn);(0,Ps.A)(()=>{setTimeout(()=>{G(F.id)},io.g2[F.severity])});const re=F.component||F.text||F.traceId,ue=F.traceId;return(0,I.jsx)(za.F,{severity:F.severity,title:F.title,onRemove:()=>G(F.id),elevated:!0,children:re&&(0,I.jsxs)("div",{className:k.wrapper,children:[(0,I.jsx)("span",{children:F.component||F.text}),ue&&(0,I.jsx)("span",{className:k.trace,children:(0,I.jsxs)(d.x6,{i18nKey:"app-notification.item.trace-id",children:["Trace ID: ",{traceId:ue}]})})]})})}function dn(F){return{wrapper:(0,Ye.css)({display:"flex",flexDirection:"column"}),trace:(0,Ye.css)({fontSize:F.typography.pxToRem(10)})}}function ra(){const F=(0,nr.d4)(ue=>(0,Na.fX)(ue.appNotifications)),G=(0,nr.wA)(),k=(0,mt.of)(Tn);(0,l.useEffect)(()=>{$a.A.on(Vo.r1.alertWarning,ue=>G((0,Ha.dx)((0,Ti.q8)(...ue)))),$a.A.on(Vo.r1.alertSuccess,ue=>G((0,Ha.dx)((0,Ti.tZ)(...ue)))),$a.A.on(Vo.r1.alertError,ue=>G((0,Ha.dx)((0,Ti.gi)(...ue)))),$a.A.on(Vo.r1.alertInfo,ue=>G((0,Ha.dx)((0,Ti.Cf)(...ue))))},[G]);const re=ue=>{G((0,Ha.Do)(ue))};return(0,I.jsx)("div",{className:k.wrapper,children:(0,I.jsx)(kt.B,{direction:"column",children:F.map((ue,ge)=>(0,I.jsx)(On,{appNotification:ue,onClearNotification:re},`${ue.id}-${ge}`))})})}function Tn(F){return{wrapper:(0,Ye.css)({label:"app-notifications-list",zIndex:F.zIndex.portal,minWidth:400,maxWidth:600,position:"fixed",right:6,top:88})}}var da=e(71599);function ua(F){const[G,k]=(0,l.useState)({component:null,props:{}}),re=(0,l.useMemo)(()=>{function ue(Pe,Ae){k({component:Pe,props:Ae})}function ge(){k({component:null,props:{}})}return{component:G.component,props:{...G.props,isOpen:!0,onDismiss:ge},showModal:ue,hideModal:ge}},[G]);return(0,l.useEffect)(()=>{$a.A.subscribe(as.S8,({payload:ge})=>{k({component:ge.component,props:ge.props})}),$a.A.subscribe(as.bY,ge=>{ga(ge,k)});let ue="";C.Ny.getHistory().listen(ge=>{ge.pathname!==ue&&k({component:null,props:{}}),ue=ge.pathname})},[]),(0,I.jsx)(mu.wE.Provider,{value:re,children:F.children})}function ga({payload:F},G){const{confirmText:k,onConfirm:re=()=>{},onDismiss:ue,text2:ge,altActionText:Pe,onAltAction:Ae,noText:We,text:qe,text2htmlBind:et,yesText:rt="Yes",icon:lt,title:pt="Confirm",yesButtonVariant:ht}=F,Ct=()=>G({component:null,props:{}}),Wt={confirmText:rt,confirmButtonVariant:ht,confirmationText:k,icon:lt,title:pt,body:qe,description:ge&&et?vh.sQ.sanitize(ge):ge,isOpen:!0,dismissText:We,onConfirm:()=>{re(),Ct()},onDismiss:()=>{ue?.(),Ct()},onAlternative:Ae?()=>{Ae(),Ct()}:void 0,alternativeText:Pe};G({component:da.u,props:Wt})}var ha=e(52830);function Oa(F){return F.providers.reduce((G,k)=>(0,I.jsx)(k,{children:G}),F.children)}function Va(F){return(0,I.jsx)(pu.Ix,{history:C.Ny.getHistory(),children:(0,I.jsx)(C._K,{service:C.Ny,children:(0,I.jsx)(gu.CompatRouter,{children:(0,I.jsx)(ha.YZ,{children:(0,I.jsx)(Oa,{providers:F.providers,children:(0,I.jsxs)(ua,{children:[(0,I.jsxs)(rn,{children:[(0,I.jsx)(ra,{}),(0,I.jsxs)(kt.B,{gap:0,grow:1,direction:"column",children:[F.pageBanners.map((G,k)=>(0,I.jsx)(G,{},k.toString())),F.routes]}),F.bodyRenderHooks.map((G,k)=>(0,I.jsx)(G,{},k.toString())),(0,I.jsx)(ss,{})]}),(0,I.jsx)(mu.EO,{})]})})})})})})}let vs=[],rs=[];const js=[];function os(F){js.push(F)}function Ui(F){vs.push(F)}function Qa(F){rs.push(F)}class Ls extends l.Component{constructor(G){super(G),this.iconCacheID=`grafana-icon-cache-${X.$.buildInfo.commit}`,this.renderRoute=k=>(0,I.jsx)(Pa.qh,{caseSensitive:k.sensitive===void 0?!1:k.sensitive,path:k.path,element:(0,I.jsx)(Ef,{route:k})},k.path),this.state={}}async componentDidMount(){this.setState({ready:!0}),$(".preloader").remove();const G=await window.caches?.keys()??[];for(const k of G)k.startsWith("grafana-icon-cache")&&k!==this.iconCacheID&&window.caches.delete(k)}renderRoutes(){return(0,I.jsx)(Pa.BV,{children:nf().map(G=>this.renderRoute(G))})}render(){const{app:G}=this.props,{ready:k}=this.state;(0,C.Lc)("AppWrapper",!1,"rendering");const re=Ae=>{(0,ja.rR)("command_palette_action_selected",{actionId:Ae.id,actionName:Ae.name})},ue={routes:k&&this.renderRoutes(),pageBanners:rs,bodyRenderHooks:vs,providers:js},ge=X.$.featureToggles.timeRangeProvider?jl.A:l.Fragment,Pe=X.$.featureToggles.extensionSidebar?$r.kn:l.Fragment;return(0,I.jsx)(hr.Provider,{store:Ba.M_,children:(0,I.jsx)(gi.Xw,{style:"page",children:(0,I.jsx)(mr.YE.Provider,{value:G.context,children:(0,I.jsx)(bf.N,{value:X.$.theme2,children:(0,I.jsx)(Fc.A,{name:this.iconCacheID,children:(0,I.jsx)(Ra.KBarProvider,{actions:[],options:{enableHistory:!0,callbacks:{onSelectAction:re}},children:(0,I.jsx)(ge,{children:(0,I.jsx)(Uf,{children:(0,I.jsx)(Pi.AZ,{registries:Tf.qm,children:(0,I.jsxs)(Pe,{children:[(0,I.jsx)(cf,{}),(0,I.jsxs)("div",{className:"grafana-app",children:[(0,I.jsx)(Va,{...ue}),(0,I.jsx)(co,{}),(0,I.jsx)(Vc.qB,{})]})]})})})})})})})})})})}}var Ms=e(35222);const Xa=(0,l.lazy)(()=>Promise.resolve().then(e.bind(e,3208)).then(F=>({default:F.NestedFolderPicker}))),bs=F=>(0,I.jsx)(l.Suspense,{fallback:(0,I.jsx)(Ms.A,{}),children:(0,I.jsx)(Xa,{...F})});var us=e(83162),Bs=e(70715);function Za({actions:F,children:G,info:k,pageNav:re,layout:ue,renderTitle:ge,subTitle:Pe}){const Ae=(0,l.useContext)(Bs.A);return(0,I.jsx)(br.Y,{navModel:Ae.sectionNav,pageNav:re,layout:ue,actions:F,renderTitle:ge,info:k,subTitle:Pe,children:(0,I.jsx)(br.Y.Contents,{children:G})})}var Or=e(45928),Qr=e(43561),Wi=e(25992),ya=e(81041);function wa(){return typeof window.SharedWorker<"u"}class Us{constructor(G,k){if(!wa())throw new Error("SharedWorker is not supported");const re=G.toString(),ue=new URL(".",G).toString(),ge=`importScripts('${re}');`,Pe=URL.createObjectURL(new Blob([`__webpack_worker_public_path__ = '${ue}'; ${ge}`],{type:"application/javascript"})),Ae=new SharedWorker(Pe,k);return URL.revokeObjectURL(Pe),Ae}}function Ws(F){return!F||typeof F!="object"?!1:"totalJSHeapSize"in F&&"usedJSHeapSize"in F&&"jsHeapSizeLimit"in F}function ar(F){return!F||typeof F!="object"?!1:"memory"in F&&Ws(F.memory)}function sr(F){const G={};function k(re,ue){if(typeof re=="object"&&re!==null){if(Array.isArray(re))throw new Error("Array values are not supported.");for(const ge in re)re.hasOwnProperty(ge)&&k(re[ge],ue?`${ue}_${ge}`:ge)}else typeof re=="string"?G[ue]=re:typeof re=="number"&&(Number.isInteger(re)?G[ue]=re.toString():G[ue]=re.toFixed(4))}return k(F,"crash"),G}const Eh=(0,Wi.DW)("core.crash-detection");function Ld(){if(!wa())return;let F=Date.now();document.body.addEventListener("click",()=>F=Date.now(),!0),document.body.addEventListener("keypress",()=>F=Date.now(),!0),(0,Or.initCrashDetection)({id:(0,Qr.Ak)(5),dbName:"grafana.crashes",createClientWorker(){return new ya.c(new URL(e.p+e.u(7235),e.b))},createDetectorWorker(){return new Us(new URL(e.p+e.u(8220),e.b))},reportCrash:async G=>{const k=sr(G);return Eh.logWarning("browser crash detected",k),!0},reportStaleTab:async G=>{const k=sr(G);return Eh.logWarning("stale browser tab detected",k),!0},updateInfo:G=>{G.app={version:X.$.buildInfo.version,url:window.location.href},G.user={email:Gn.TP.user.email,login:Gn.TP.user.login,name:Gn.TP.user.name,lastInteraction:F},ar(performance)&&(G.memory={heapUtilization:performance.memory.usedJSHeapSize/performance.memory.totalJSHeapSize,limitUtilization:performance.memory.totalJSHeapSize/performance.memory.jsHeapSizeLimit,usedJSHeapSize:performance.memory.usedJSHeapSize,totalJSHeapSize:performance.memory.totalJSHeapSize,jsHeapSizeLimit:performance.memory.jsHeapSizeLimit})}})}var Ph=e(29662);const Xg=F=>F.split("-")[0].toLowerCase(),zm={type:"backend",init(){},async read(F,G,k){let re=Ph.Yj.find(Pe=>Pe.code===F);if(re||(re=Ph.Yj.find(Pe=>Xg(Pe.code)===Xg(F))),!re)return k(new Error(`No message loader available for ${F}`),null);const ue=re.loader[G];if(!ue)return k(new Error(`No message loader available for ${F} with namespace ${G}`),null);const ge=await ue();k(null,ge)}};async function _m(){if(window.location.search.indexOf("why-render")!==-1){const{default:F}=await e.e(3718).then(e.t.bind(e,13718,23));F(g,{trackAllPureComponents:!0})}await Wu()}async function Gm(){await _m()}async function Hm(){op()}var Qm=e(17016);function km(F){const G=F.target instanceof Element&&Ym(F.target);if(!(F.ctrlKey||F.metaKey||F.defaultPrevented)&&G){let k=G.getAttribute("href");const re=G.getAttribute("target");if(k&&!re){const ue=ec.kM.parseKeyValue(k.split("?")[1]),ge=ue.orgId&&Number(ue.orgId)!==Y.$W.bootData.user.orgId;if((0,C.Lc)("utils",!1,"intercepting link click",F),F.preventDefault(),k=y.I.stripBaseFromUrl(k),k[0]!=="/"||ge)if(k.indexOf("://")>0||k.indexOf("mailto:")===0||ge){window.location.href=k;return}else if(k.indexOf("#")===0){window.location.hash=k;return}else k=`/${k}`;C.Ny.push(k)}}}function Ym(F){for(;F!==null&&F.tagName;){if(F.tagName.toUpperCase()==="A")return F;F=F.parentElement}return null}var Zg=e(6219),Jm=e(78529);class Xm{attachCorrelationsToDataFrames(G,k,re){return(0,Zg.cA)(G,k,re)}correlationsDataLinkPostProcessorFactory(G){return(0,Jm.YV)(void 0,G)}getCorrelationsBySourceUIDs(G){return(0,Zg.J6)(G)}}var Zm=e(4590);class qm{constructor(G){this.hasUpdates=!1,this.checked=Date.now(),this.prevLocationPath="",this.interval=G??1e3*60*5}start(){const G=(0,td.oF)();G&&G.getConnectionState().subscribe(k=>{k&&this._checkForUpdates()}),C.Ny.getHistory().listen(this.locationUpdated.bind(this)),this.prevLocationPath=C.Ny.getLocation().pathname}locationUpdated(G){if(this.prevLocationPath===G.pathname)return;const k=G.pathname.split("/");k[1]==="/"&&this.prevLocationPath!=="/"?this.reloadIfUpdateDetected():k[1]==="d"&&!Zm._o.state.isPlaying?this.reloadIfUpdateDetected():this.hasUpdates&&(0,ja.rR)("new_frontend_assets_reload_ignored",{newLocation:G.pathname,prevLocation:this.prevLocationPath}),this.prevLocationPath=G.pathname}async _checkForUpdates(){if(this.hasUpdates||Date.now()-this.checked<this.interval)return;this.checked=Date.now();const G=this.previous,k=await(0,E.AI)().get("/api/frontend/assets");G&&!(0,J.isEqual)(G,k)&&(this.hasUpdates=!0,(0,ja.rR)("new_frontend_assets_detected",{assets:G.assets!==k.assets,plugins:G.plugins!==k.plugins,version:G.version!==k.version,flags:G.flags!==k.flags})),this.previous=k}reloadIfUpdateDetected(){this.hasUpdates&&((0,ja.rR)("new_frontend_assets_reload",{}),window.location.reload()),this._checkForUpdates()}}var qg=e(83873),em=e(25240);class e0{constructor(G){this.config={flushInterval:1e4,debug:!1},this.backends=[],this.flush=()=>{for(const k of this.backends)k.flush()},this.addBackend=k=>{(0,em.S5)("Adding backend",!1,k),this.backends.push(k)},this.addEvent=(k,re)=>{const ue=this.getMeta(),ge={...k,meta:{...ue,...re}};for(const Pe of this.backends)(Pe.supportedEvents.length===0||Pe.supportedEvents.indexOf(ge.type)>-1)&&Pe.addEvent(ge);(0,em.S5)(`${k.type} event`,!1,{...k.payload,meta:ge.meta})},this.getMeta=()=>({sessionId:"",userId:Gn.TP.user.id,userLogin:Gn.TP.user.login,userSignedIn:Gn.TP.user.isSignedIn,orgRole:Gn.TP.user.orgRole,orgId:Gn.TP.user.orgId,screenSize:{width:window.innerWidth,height:window.innerHeight},windowSize:{width:window.screen.width,height:window.screen.height},userAgent:window.navigator.userAgent,ts:new Date().getTime(),timeSinceNavigationStart:performance.now(),path:window.location.pathname,url:window.location.href}),this.config={...this.config,...G},setInterval(this.flush,this.config.flushInterval)}}var t0=e(78731),n0=e(57852),a0=e(62635),s0=e(37010),r0=e(23753),Ni=e(75421),o0=e(47981),bh=e(12469);class i0{constructor(G,k){this.locationService=G,this.chromeService=k,this.panelId=null,$a.A.subscribe(n0.Tp,re=>{this.panelId=re.payload.panelId})}clearAndInitGlobalBindings(G){bh.R.reset(),G.chromeless||(this.bind("?",this.showHelpModal),this.bind("g h",this.goToHome),this.bind("g d",this.goToDashboards),this.bind("g e",this.goToExplore),this.bind("g a",this.openAlerting),this.bind("g p",this.goToProfile),this.bind("esc",this.exit),this.bindGlobalEsc()),this.bind("c t",()=>(0,Ci.O)(!1)),this.bind("c r",()=>(0,Ci.O)(!0))}bindGlobalEsc(){this.bindGlobal("esc",this.globalEsc)}globalEsc(){const k=document.activeElement;if(!(document.querySelectorAll(".slate-typeahead--open").length>0)){if(k&&k instanceof HTMLElement&&(k.nodeName==="INPUT"||k.nodeName==="TEXTAREA"||k.hasAttribute("data-slate-editor"))){k.blur();return}this.exit()}}openAlerting(){this.locationService.push("/alerting")}goToDashboards(){this.locationService.push("/dashboards")}goToHome(){this.locationService.push("/")}goToProfile(){this.locationService.push("/profile")}goToExplore(){this.locationService.push("/explore")}showHelpModal(){$a.A.publish(new as.S8({component:o0.N}))}exit(){const G=this.locationService.getSearchObject();if(G.editview){this.locationService.partial({editview:null,editIndex:null});return}if(G.inspect){this.locationService.partial({inspect:null,inspectTab:null});return}if(G.editPanel){this.locationService.partial({editPanel:null,tab:null});return}if(G.viewPanel){this.locationService.partial({viewPanel:null,tab:null});return}const{kioskMode:k}=this.chromeService.state.getValue();k&&this.chromeService.exitKioskMode()}showDashEditView(){this.locationService.partial({editview:"settings"})}bind(G,k){bh.R.bind(G,re=>{re.preventDefault(),re.stopPropagation(),re.returnValue=!1,k.call(this)},"keydown")}bindGlobal(G,k){bh.R.bindGlobal(G,re=>{re.preventDefault(),re.stopPropagation(),re.returnValue=!1,k.call(this)},"keydown")}unbind(G,k){bh.R.unbind(G,k)}bindWithPanelId(G,k){this.bind(G,this.withFocusedPanel(k))}withFocusedPanel(G){return()=>{if(typeof this.panelId=="number"){G(this.panelId);return}}}setupTimeRangeBindings(G=!0){this.bind("t a",()=>{$a.A.publish(new as.Rh({updateUrl:G}))}),this.bind("t z",()=>{$a.A.publish(new as.U0({scale:2,updateUrl:G}))}),this.bind("ctrl+z",()=>{$a.A.publish(new as.U0({scale:2,updateUrl:G}))}),this.bind("t left",()=>{$a.A.publish(new as.Io({direction:as.xL.Left,updateUrl:G}))}),this.bind("t right",()=>{$a.A.publish(new as.Io({direction:as.xL.Right,updateUrl:G}))}),this.bind("t c",()=>{$a.A.publish(new as.Bt)}),this.bind("t v",()=>{$a.A.publish(new as.VZ({updateUrl:G}))})}setupDashboardBindings(G){this.bind("mod+o",()=>{G.graphTooltip=(G.graphTooltip+1)%3,G.events.publish(new Vo.Tq),G.startRefresh()}),this.bind("mod+s",()=>{G.meta.canSave&&$a.A.publish(new as.S8({component:s0.$,props:{dashboard:G}}))}),this.setupTimeRangeBindings(),this.bindWithPanelId("e",k=>{if(G.canEditPanelById(k)){const re=this.locationService.getSearchObject().editPanel!==void 0;this.locationService.partial({editPanel:re?null:k})}}),this.bindWithPanelId("v",k=>{const re=this.locationService.getSearchObject().viewPanel!==void 0;this.locationService.partial({viewPanel:re?null:k})}),this.bindWithPanelId("p l",k=>{const re=G.getPanelById(k),ue={...re.options};ue.legend.showLegend?ue.legend.showLegend=!1:ue.legend.showLegend=!0,re.updateOptions(ue)}),this.bindWithPanelId("i",k=>{this.locationService.partial({inspect:k})}),Gs.TP.hasAccessToExplore()&&this.bindWithPanelId("p x",async k=>{const re=G.getPanelById(k),ue=await(0,a0.Xe)({queries:re.targets,dsRef:re.datasource,scopedVars:re.scopedVars,timeRange:(0,Ni.jG)().timeRange()});if(ue){const ge=y.I.stripBaseFromUrl(ue);ge&&this.locationService.push(ge)}}),this.bindWithPanelId("p r",k=>{G.canEditPanelById(k)&&!(G.panelInView||G.panelInEdit)&&$a.A.publish(new as.Vz(k))}),this.bindWithPanelId("p d",k=>{if(G.canEditPanelById(k)){const re=G.getPanelInfoById(k).index;G.duplicatePanel(G.panels[re])}}),this.bindWithPanelId("p s",k=>{const re=G.getPanelInfoById(k);$a.A.publish(new as.S8({component:r0.Zy,props:{dashboard:G,panel:re?.panel}}))}),this.bind("d l",()=>{G.toggleLegendsForAll()}),this.bind("d x",()=>{G.toggleExemplarsForAll()}),this.bind("d shift+c",()=>{G.collapseRows()}),this.bind("d shift+e",()=>{G.expandRows()}),this.bind("d n",()=>{this.locationService.push("/dashboard/new")}),this.bind("d r",()=>{G.startRefresh()}),this.bind("d s",()=>{this.showDashEditView()}),this.bind("d k",()=>{this.chromeService.onToggleKioskMode()}),this.bind("d a",()=>{const re=this.locationService.getSearchObject().autofitpanels?"":"&autofitpanels";window.location.href=window.location.href+re})}}var tm=e(60017),l0=e(25157);const c0=(0,l.lazy)(()=>e.e(192).then(e.bind(e,48278)));function d0(){const F=(0,$t.Wd)(zn.hY),G=X.$.unifiedAlertingEnabled;Gn.TP.hasPermission(F.read)&&(0,l0.fP)({show:()=>G,component:({dashboard:k})=>G?(0,I.jsx)(l.Suspense,{fallback:null,children:k&&(0,I.jsx)(c0,{dashboardUid:k.uid})},"alert-rules-button"):null,index:-2})}var u0=e(69874);function h0(F){return(0,I.jsx)(f0,{...F})}const f0=(0,l.lazy)(async()=>{const{EmbeddedDashboard:F}=await e.e(2859).then(e.bind(e,72340));return{default:F}});var p0=e(4405),g0=e(65556),Bd=e(35392),m0=e(1005),v0=e(96222),hs=e(38619),lc=e(51388),nm=e(39741),Rg=e(97534),po=e(46383);const y0=F=>G=>new Di.c(k=>{let re=[],ue=!0;const ge=()=>{k.next(re),re=[]},Pe=F.subscribe({next:We=>{ue=We,ue&&re.length&&ge()}}),Ae=G.subscribe({next(We){ue?re.length?ge():k.next([We]):re.push(We)},error(We){k.error(We)},complete(){k.complete()}});return()=>{Ae.unsubscribe(),Pe.unsubscribe()}});var x0=(F=>(F[F.Error=0]="Error",F[F.NewValuesSameSchema=1]="NewValuesSameSchema",F[F.ChangedSchema=2]="ChangedSchema",F))(x0||{});const E0=F=>({values:F.reduce((G,{values:k})=>{for(let re=0;re<k.length;re++){G[re]||(G[re]=[]);for(let ue=0;ue<k[re].length;ue++)G[re].push(k[re][ue])}return G},[]),type:1}),am=(F,G)=>F.filter(k=>k.type===G);class P0{constructor(G){this.deps=G,this.stream=new nm.m(1),this.shutdown=()=>{this.stream.complete(),this.liveEventsSubscription.unsubscribe(),this.deps.onShutdown()},this.shutdownIfNoSubscribers=()=>{this.stream.observed||this.shutdown()},this.onError=k=>{console.log("LiveQuery [error]",{err:k},this.deps.channelId),this.stream.next({type:0,error:(0,Rg.u)(k)}),this.shutdown()},this.onComplete=()=>{console.log("LiveQuery [complete]",this.deps.channelId),this.shutdown()},this.onNext=k=>{if((0,hs.Z7)(k)){this.process(k.message);return}const re=(0,hs.ew)(k);if(re&&k.error){const ue=(0,Rg.u)(k.error);this.stream.next({type:0,error:{...ue,message:`Streaming channel error: ${ue.message}`}})}re&&(k.state===hs.ZF.Connected||k.state===hs.ZF.Pending)&&k.message&&this.process(k.message)},this.process=k=>{this.frameBuffer.push(k).schemaChanged?this.stream.next({type:2}):this.stream.next({type:1,values:this.frameBuffer.getValuesFromLastPacket()})},this.resizeBuffer=k=>{k&&this.frameBuffer.needsResizing(k)&&this.frameBuffer.resize(k)},this.prepareInternalStreamForNewSubscription=k=>{!this.frameBuffer.hasAtLeastOnePacket()&&k.frame&&this.process(k.frame)},this.clearShutdownTimeout=()=>{this.shutdownTimeoutId&&(clearTimeout(this.shutdownTimeoutId),this.shutdownTimeoutId=void 0)},this.get=(k,re)=>{this.clearShutdownTimeout();const ue=(0,lc.m8)(k.buffer);this.resizeBuffer(ue),this.prepareInternalStreamForNewSubscription(k);const ge=k?.buffer?.action===lc.Kh.Replace,Pe=k.filter?.fields,We=Pe?.length?({name:ht})=>Pe.includes(ht):void 0;let qe;const et=(ht,Ct)=>(qe=We?this.frameBuffer.getMatchingFieldIndexes(We):void 0,ge?Ct?{key:re,state:La.Gu.Error,data:[{type:po._w.FullFrame,frame:this.frameBuffer.serialize(We,ue,{maxLength:0})}],error:Ct}:ht.length?{key:re,state:La.Gu.Streaming,data:[{type:po._w.FullFrame,frame:this.frameBuffer.serialize(We,ue,{maxLength:this.frameBuffer.packetInfo.length})}],error:Ct}:(console.warn(`expected to find at least one non error message ${ht.map(({type:Wt})=>Wt)}`),{key:re,state:La.Gu.Streaming,data:[{type:po._w.FullFrame,frame:this.frameBuffer.serialize(We,ue,{maxLength:0})}],error:Ct}):{key:re,state:Ct?La.Gu.Error:La.Gu.Streaming,data:[{type:po._w.FullFrame,frame:this.frameBuffer.serialize(We,ue)}],error:Ct}),rt=ht=>{const Ct=ht.length?ht[ht.length-1]:void 0,Wt=ge&&Ct?Ct.values:E0(ht).values,en=qe?Wt.filter((on,vn)=>qe?.includes(vn)):Wt;return{key:re,state:La.Gu.Streaming,data:[{type:po._w.NewValuesSameSchema,values:en}]}};let lt=!0;const pt=this.stream.pipe(y0(this.deps.subscriberReadiness),(0,oa.T)((ht,Ct)=>{const Wt=am(ht,0),en=Wt.length?Wt[Wt.length-1].error:void 0;if(lt)return lt=!1,et(ht,en);if(Wt.length)return et(ht,en);if(ht.some(an=>an.type===2))return et(ht,void 0);const vn=am(ht,1);return vn.length!==ht.length&&console.warn(`unsupported message type ${ht.map(({type:an})=>an)}`),rt(vn)}));return new Di.c(ht=>{const Ct=pt.subscribe({next:Wt=>{ht.next(Wt)},error:Wt=>{ht.error(Wt)},complete:()=>{ht.complete()}});return()=>{Ct.unsubscribe(),this.stream.observed||(this.clearShutdownTimeout(),this.shutdownTimeoutId=setTimeout(this.shutdownIfNoSubscribers,this.deps.shutdownDelayInMs))}})},this.frameBuffer=lc.k9.empty(G.defaultStreamingFrameOptions),this.liveEventsSubscription=G.liveEventsObservable.subscribe({error:this.onError,complete:this.onComplete,next:this.onNext})}}var Dh=e(13752);class b0{constructor(G,k){this.opened=Date.now(),this.stream=new Dh.B,this.disconnectIfNoListeners=()=>{this.stream.observers.length===0&&this.disconnect()},this.publish=re=>this.subscription?.publish(re),this.id=G,this.addr=k,this.currentStatus={type:hs.o4.Status,id:G,timestamp:this.opened,state:hs.ZF.Pending},(0,hs.aj)(k)||(this.currentStatus.state=hs.ZF.Invalid,this.currentStatus.error="invalid channel address")}initalize(){if(this.initalized)throw new Error("Channel already initalized: "+this.id);this.initalized=!0,this.subscription.on("publication",G=>{try{G.data&&(G.data.schema&&(this.lastMessageWithSchema=G.data),this.stream.next({type:hs.o4.Message,message:G.data})),this.currentStatus.error&&(this.currentStatus.timestamp=Date.now(),delete this.currentStatus.error,this.sendStatus())}catch(k){console.log("publish error",this.addr,k),this.currentStatus.error=k,this.currentStatus.timestamp=Date.now(),this.sendStatus()}}).on("error",G=>{this.currentStatus.timestamp=Date.now(),this.currentStatus.error=G.error.message,this.sendStatus()}).on("subscribed",G=>{this.currentStatus.timestamp=Date.now(),this.currentStatus.state=hs.ZF.Connected,delete this.currentStatus.error,G.data?.schema&&(this.lastMessageWithSchema=G.data),this.sendStatus(G.data)}).on("unsubscribed",()=>{this.currentStatus.timestamp=Date.now(),this.currentStatus.state=hs.ZF.Disconnected,this.sendStatus()}).on("subscribing",()=>{this.currentStatus.timestamp=Date.now(),this.currentStatus.state=hs.ZF.Connecting,this.sendStatus()}).on("join",G=>{this.stream.next({type:hs.o4.Join,user:G.info.user})}).on("leave",G=>{this.stream.next({type:hs.o4.Leave,user:G.info.user})})}sendStatus(G){const k={...this.currentStatus};G&&(k.message=G),this.stream.next(k)}getStream(){return new Di.c(G=>{const k={...this.currentStatus};this.lastMessageWithSchema?.schema&&(k.message={schema:this.lastMessageWithSchema?.schema}),G.next({...this.currentStatus,message:this.lastMessageWithSchema});const re=this.stream.subscribe(G);return()=>{re.unsubscribe(),this.stream.observers.length===0&&setTimeout(this.disconnectIfNoListeners,250)}})}async getPresence(){return this.subscription?this.subscription.presence().then(G=>({users:Object.keys(G.clients)})):Promise.reject("not subscribed")}disconnect(){this.currentStatus.state=hs.ZF.Shutdown,this.currentStatus.timestamp=Date.now(),this.subscription&&(this.subscription.unsubscribe(),this.subscription.removeAllListeners(),this.subscription=void 0),this.stream.complete(),this.stream.next({...this.currentStatus}),this.stream.complete(),this.shutdownCallback&&this.shutdownCallback()}shutdownWithError(G){this.currentStatus.error=G,this.sendStatus(),this.disconnect()}}function gE(F,G,k){return{id:G,opened:Date.now(),addr:k,getStream:()=>of({type:LiveChannelEventType.Status,id:G,timestamp:Date.now(),state:LiveChannelConnectionState.Invalid,error:F}),disconnect:()=>{}}}const D0={maxLength:100,maxDelta:1/0,action:lc.Kh.Append},C0=5e3;class T0{constructor(G){this.deps=G,this.open=new Map,this.liveDataStreamByChannelId={},this.onConnect=ue=>{this.connectionState.next(!0)},this.onDisconnect=ue=>{this.connectionState.next(!1)},this.onServerSideMessage=ue=>{console.log("Publication from server-side channel",ue)},this.getConnectionState=()=>this.connectionState.asObservable(),this.getStream=ue=>this.getChannel(ue).getStream(),this.createSubscriptionKey=ue=>ue.key??`xstr/${M0++}`,this.getLiveDataStream=ue=>{const ge=(0,hs.Qp)(ue.addr),Pe=this.liveDataStreamByChannelId[ge];if(Pe)return Pe;const Ae=this.getChannel(ue.addr);return this.liveDataStreamByChannelId[ge]=new P0({channelId:ge,onShutdown:()=>{delete this.liveDataStreamByChannelId[ge]},liveEventsObservable:Ae.getStream(),subscriberReadiness:this.dataStreamSubscriberReadiness,defaultStreamingFrameOptions:D0,shutdownDelayInMs:C0}),this.liveDataStreamByChannelId[ge]},this.getDataStream=ue=>{const ge=this.createSubscriptionKey(ue);return this.getLiveDataStream(ue).get(ue,ge)},this.getQueryData=async ue=>(this.centrifuge.state!==Bd.Uw.Connected&&await this.connectionBlocker,this.centrifuge.rpc("grafana.query",ue.body)),this.getPresence=ue=>this.getChannel(ue).getPresence(),this.publish=async(ue,ge,Pe)=>this.getChannel(ue).publish(ge),this.dataStreamSubscriberReadiness=G.dataStreamSubscriberReadiness.pipe((0,m0.u)(),(0,v0.Z)(!0));let k=`${G.appUrl.replace(/^http/,"ws")}/api/live/ws`;const re=G.grafanaAuthToken;re!==null&&re!==""&&(k+="?auth_token="+re),this.centrifuge=new Bd.Ft(k,{timeout:3e4}),G.liveEnabled&&G.orgRole!==""&&this.centrifuge.connect(),this.connectionState=new bi.t(this.centrifuge.state===Bd.Uw.Connected),this.connectionBlocker=new Promise(ue=>{if(this.centrifuge.state===Bd.Uw.Connected)return ue();const ge=()=>{ue(),this.centrifuge.removeListener("connected",ge)};this.centrifuge.addListener("connected",ge)}),this.centrifuge.on("connected",this.onConnect),this.centrifuge.on("connecting",this.onDisconnect),this.centrifuge.on("disconnected",this.onDisconnect),this.centrifuge.on("publication",this.onServerSideMessage)}getChannel(G){const k=`${this.deps.orgId}/${G.scope}/${G.namespace}/${G.path}`;let re=this.open.get(k);return re!=null||(re=new b0(k,G),re.currentStatus.state===hs.ZF.Invalid)||(re.shutdownCallback=()=>{this.open.delete(k),this.centrifuge.removeSubscription(this.centrifuge.getSubscription(k))},this.open.set(k,re),this.initChannel(re).catch(ue=>{re&&(re.currentStatus.state=hs.ZF.Invalid,re.shutdownWithError(ue)),this.open.delete(k)})),re}async initChannel(G){this.centrifuge.state!==Bd.Uw.Connected&&await this.connectionBlocker;const k=this.centrifuge.newSubscription(G.id,{data:G.addr.data});G.subscription=k,G.initalize(),k.subscribe()}}let M0=0;class S0{constructor(G){this.deps=G,this.getConnectionState=()=>this.deps.centrifugeSrv.getConnectionState(),this.getDataStream=k=>{let re;const ue=ge=>{const Pe=ge.data[0];if(!re&&!(0,po.ot)(Pe,po._w.FullFrame)){console.warn(`expected first packet to contain a full frame, received ${Pe?.type}`);return}switch(Pe.type){case po._w.FullFrame:{re=lc.k9.deserialize(Pe.frame);return}case po._w.NewValuesSameSchema:{re.pushNewValues(Pe.values);return}}};return this.deps.centrifugeSrv.getDataStream(k).pipe((0,oa.T)(ge=>(ue(ge),{...ge,data:[re??lc.k9.empty()]})))},this.getStream=k=>this.deps.centrifugeSrv.getStream(k),this.publish=async(k,re,ue)=>ue?.useSocket?this.deps.centrifugeSrv.publish(k,re):this.deps.backendSrv.post("api/live/publish",{channel:(0,hs.Qp)(k),data:re}),this.getPresence=k=>this.deps.centrifugeSrv.getPresence(k)}}function O0(){const F={appUrl:`${window.location.origin}${X.$.appSubUrl}`,orgId:Gn.TP.user.orgId,orgRole:Gn.TP.user.orgRole,liveEnabled:X.$.liveEnabled,dataStreamSubscriberReadiness:p0.a.ok.asObservable(),grafanaAuthToken:(0,g0.r)()},G=new T0(F);(0,td.S8)(new S0({centrifugeSrv:G,backendSrv:(0,E.AI)()}))}function mE(){return getGrafanaLiveSrv()}var I0=e(88642),R0=e(35307),cc=e(28998),sm=e(8001),Ch=e(31595),Ki=e(4745),Th=e(96016),A0=e(16817),j0=e(95027),L0=e(59922);const Mh=new Map,vE=()=>{Mh.clear()};async function Ag(F=[]){const G=F.map(k=>(Mh.has(k.id)||Mh.set(k.id,B0(k)),Mh.get(k.id)));await Promise.all(G)}async function B0(F){try{const G=await(0,j0.x)(F.id,{showErrorAlert:Gn.TP.user.orgRole!==""});await(0,L0.ui)(G)}catch(G){console.error(`[Plugins] Failed to preload plugin: ${F.path} (version: ${F.version})`,G)}}var fs=e(3260);function Sh(F=[]){const{loading:G}=(0,A0.A)(async()=>{const k=(0,fs.uS)(F);k.length&&await Ag(k)});return{isLoading:G}}var wi=e(9453);function U0(F){const G=(0,Pi.ZV)(),k=(0,Tr.A)(G.asObservable()),re=(0,Ch.Q)(),{isLoading:ue}=Sh((0,fs.Uy)(F));return(0,l.useMemo)(()=>{const ge=(0,fs.V2)()&&re;if(ue)return{isLoading:!0,component:null};if(!k?.[F])return{isLoading:!1,component:null};const Pe=k[F],Ae=Th.R.child({title:Pe.title,description:Pe.description??"",pluginId:Pe.pluginId});return ge&&(0,wi.xM)(F,re)?(Ae.error(Ki.ij),{isLoading:!1,component:null}):{isLoading:!1,component:(0,fs.nv)({pluginId:Pe.pluginId,extensionTitle:Pe.title,Component:Pe.component,log:Ae})}},[F,re,k,ue])}function W0({limitPerPlugin:F,extensionPointId:G}){const k=(0,Pi.TX)(),re=(0,Tr.A)(k.asObservable()),ue=(0,Ch.Q)(),{isLoading:ge}=Sh((0,fs.Ce)(G));return(0,l.useMemo)(()=>{const Pe=(0,fs.V2)()&&ue,Ae=[],We={},qe=ue?.meta.id??"",et=Th.R.child({pluginId:qe,extensionPointId:G});if(Pe&&!(0,wi.Fe)({extensionPointId:G,pluginId:qe})&&et.error(Ki.Bs),Pe&&(0,wi.PW)(G,ue))return et.error(Ki.Ri),{isLoading:!1,components:[]};if(ge)return{isLoading:!0,components:[]};for(const rt of re?.[G]??[]){const{pluginId:lt}=rt;if(F&&We[lt]>=F)continue;We[lt]===void 0&&(We[lt]=0);const pt=N0(rt,G);Ae.push(pt),We[lt]+=1}return{isLoading:!1,components:Ae}},[G,F,ue,re,ge])}function N0(F,G){const{component:k,...re}=F;function ue(ge){return(0,I.jsx)(k,{...ge})}return ue.displayName=k.displayName,ue.defaultProps=k.defaultProps,ue.propTypes=k.propTypes,ue.contextTypes=k.contextTypes,ue.meta={pluginId:re.pluginId,title:re.title??"",description:re.description??"",id:(0,fs.yt)(re.pluginId,G,re.title),type:Mi.u.component},ue}function K0({limitPerPlugin:F,extensionPointId:G}){const k=(0,Pi.ov)(),re=(0,Tr.A)(k.asObservable()),ue=(0,Ch.Q)(),ge=(0,fs.Ce)(G),{isLoading:Pe}=Sh(ge);return(0,l.useMemo)(()=>{const Ae=(0,fs.V2)()&&ue,We=[],qe={},et=ue?.meta.id??"",rt=Th.R.child({pluginId:et,extensionPointId:G});if(Ae&&!(0,wi.Fe)({extensionPointId:G,pluginId:et})&&rt.error(Ki.Bs),Ae&&(0,wi.PW)(G,ue))return rt.error(Ki.Ri),{isLoading:!1,functions:[]};if(Pe)return{isLoading:!0,functions:[]};for(const lt of re?.[G]??[]){const{pluginId:pt}=lt;F&&qe[pt]>=F||(qe[pt]===void 0&&(qe[pt]=0),We.push({id:(0,fs.yt)(pt,G,lt.title),type:Mi.u.function,title:lt.title,description:lt.description??"",pluginId:pt,fn:lt.fn}),qe[pt]+=1)}return{isLoading:!1,functions:We}},[G,F,ue,re,Pe])}function w0({limitPerPlugin:F,extensionPointId:G,context:k}){const re=(0,Pi.OG)(),ue=(0,Ch.Q)(),ge=(0,Tr.A)(re.asObservable()),{isLoading:Pe}=Sh((0,fs.Ce)(G));return(0,l.useMemo)(()=>{const Ae=(0,fs.V2)()&&ue!==null,We=ue?.meta.id??"",qe=Th.R.child({pluginId:We,extensionPointId:G});if(Ae&&!(0,wi.Fe)({extensionPointId:G,pluginId:We}))return qe.error(Ki.Bs),{isLoading:!1,links:[]};if(Ae&&(0,wi.PW)(G,ue))return qe.error(Ki.Ri),{isLoading:!1,links:[]};if(Pe)return{isLoading:!0,links:[]};if(!ge||!ge[G])return{isLoading:!1,links:[]};const et=k?(0,fs.$Y)(k):{},rt=[],lt={};for(const pt of ge[G]??[]){const{pluginId:ht}=pt,Ct=qe.child({path:pt.path??"",title:pt.title,description:pt.description??"",onClick:typeof pt.onClick});if(F&&lt[ht]>=F){Ct.debug(`Skipping link extension from plugin "${ht}". Reason: Limit reached.`);continue}lt[ht]===void 0&&(lt[ht]=0);const Wt=(0,fs.hS)(ht,pt,Ct,et);if(pt.configure&&Wt===void 0)continue;const en=Wt?.path||pt.path,on={id:(0,fs.yt)(ht,G,pt.title),type:Mi.u.link,pluginId:ht,onClick:(0,fs.dx)(ht,G,pt,Ct,et),icon:Wt?.icon||pt.icon,title:Wt?.title||pt.title,description:Wt?.description||pt.description||"",path:(0,J.isString)(en)?(0,fs.YS)(ht,en,G):void 0,category:Wt?.category||pt.category};rt.push(on),lt[ht]+=1}return{isLoading:!1,links:rt}},[k,G,F,ge,ue,Pe])}var rm=e(92391),F0=e(57532),om=e(17548),V0=e(96215),$0=e(39050),jg=e(71393);class z0{constructor(){this.subject=new nm.m(1)}get(){return this.subject.asObservable()}run(G){const{queries:k,timezone:re,datasource:ue,panelId:ge,app:Pe,dashboardUID:Ae,timeRange:We,timeInfo:qe,cacheTimeout:et,queryCachingTTL:rt,maxDataPoints:lt,scopedVars:pt,minInterval:ht}=G;this.subscription&&this.subscription.unsubscribe();const Ct={app:Pe??nc.Jk.Unknown,requestId:(0,V0.S)(),timezone:re,panelId:ge,dashboardUID:Ae,range:We,timeInfo:qe,interval:"",intervalMs:0,targets:(0,J.cloneDeep)(k),maxDataPoints:lt,scopedVars:pt||{},cacheTimeout:et,queryCachingTTL:rt,startTime:Date.now()};Ct.rangeRaw=We.raw,(0,Pr.H)(_0(ue,Ct.scopedVars)).pipe((0,F0.$)()).subscribe({next:Wt=>{Ct.targets=Ct.targets.map(vn=>(vn.datasource||(vn.datasource=Wt.getRef()),vn));const en=ht?(0,dt.w)().replace(ht,Ct.scopedVars):Wt.interval,on=om.calculateInterval(We,lt,en);Ct.scopedVars=Object.assign({},Ct.scopedVars,{__interval:{text:on.interval,value:on.interval},__interval_ms:{text:on.intervalMs.toString(),value:on.intervalMs}}),Ct.interval=on.interval,Ct.intervalMs=on.intervalMs,this.subscription=(0,jg.BN)(Wt,Ct).subscribe({next:vn=>{const an=(0,ws.N$)(vn,this.lastResult);this.lastResult=(0,$0.B)(an,this.lastResult),this.subject.next(this.lastResult)}})},error:Wt=>console.error("PanelQueryRunner Error",Wt)})}cancel(){this.subscription&&(this.subscription.unsubscribe(),this.lastResult&&this.lastResult.state===La.Gu.Loading&&this.subject.next({...this.lastResult,state:La.Gu.Done}))}destroy(){this.subject&&this.subject.complete(),this.subscription&&this.subscription.unsubscribe()}}async function _0(F,G){return F&&"query"in F?F:(0,cc.tR)().get(F,G)}var im=e(22429);function G0(){window.grafanaRuntime={getDashboardSaveModel:()=>{const F=(0,im.UA)().getCurrent();if(F)return F.getSaveModelCloneOld()},getDashboardTimeRange:()=>{const F=(0,Ni.jG)().timeRange();return{from:F.from.valueOf(),to:F.to.valueOf(),raw:F.raw}},getPanelData:()=>{const F=(0,im.UA)().getCurrent();if(F)return F.panels.reduce((G,k)=>(G[k.id]=k.getQueryRunner().getLastResult(),G),{})}}}var H0=e(35886),Ud=e(54742),Rn=e(99305),lm=e(48480),Q0=e(99584),go=e(17752);function cm(F){return F.extended&&"infoText"in F.extended?F.extended:null}function dm(F){return F.extended&&"dataSourceTypes"in F.extended?F.extended:null}function Lg(F){return F.extended&&"dataSource"in F.extended?F.extended:null}var xa=e(93612),Wd=e(48421);const k0=(F,G)=>{const{rootStateKey:k}=G.variable;if(!k)return console.error("AdHocVariableEditor: variable has no rootStateKey"),{extended:cm(go.nS)};const{editor:re}=(0,xa.nx)(k,F);return{extended:cm(re)}},Y0={changeVariableDatasource:Wd.Iv},J0=(0,hr.connect)(k0,Y0);class X0 extends l.PureComponent{constructor(){super(...arguments),this.onDatasourceChanged=G=>{this.props.changeVariableDatasource((0,Rn.jX)(this.props.variable),(0,lm.p$)(G))}}componentDidMount(){const{rootStateKey:G}=this.props.variable;if(!G){console.error("AdHocVariableEditor: variable has no rootStateKey");return}}render(){const{variable:G,extended:k}=this.props;return(0,I.jsx)(Q0.Q,{datasource:G.datasource??void 0,onDataSourceChange:this.onDatasourceChanged,infoText:k?.infoText,datasourceSupported:G.datasource!==void 0})}}const Z0=J0(X0);var um=e(61875),Bg=e(76671);const hm=90,fm=({datasource:F,onChange:G,disabled:k,filterKey:re,allFilters:ue})=>{const ge=()=>pm(F,re,ue),Pe=()=>ev(F,re,ue),Ae=(0,I.jsx)("span",{className:"gf-form-label query-part","aria-label":(0,d.t)("variables.ad-hoc-filter-key.plus-segment.aria-label-add-filter","Add Filter"),children:(0,I.jsx)(_n.I,{name:"plus"})});return re===null?(0,I.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterKey-add-key-wrapper",children:(0,I.jsx)(Bg.s,{disabled:k,className:"query-segment-key",Component:Ae,value:re,onChange:G,loadOptions:ge,inputMinWidth:hm})}):(0,I.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterKey-key-wrapper",children:(0,I.jsx)(Bg.s,{disabled:k,className:"query-segment-key",value:re,onChange:G,loadOptions:Pe,inputMinWidth:hm})})},Oh="-- remove filter --",q0={label:Oh,value:Oh},pm=async(F,G,k)=>{const re=await(0,cc.tR)().get(F);if(!re||!re.getTagKeys)return[];const ue=k.filter(Ae=>Ae.key!==G),ge=await re.getTagKeys({filters:ue});return(Array.isArray(ge)?ge:ge.data).map(Ae=>({label:Ae.text,value:Ae.text}))},ev=async(F,G,k)=>{const re=await pm(F,G,k);return[q0,...re]},tv=({datasource:F,disabled:G,onChange:k,filterKey:re,filterValue:ue,placeHolder:ge,allFilters:Pe})=>{const Ae=(0,mt.of)(av),We=()=>nv(F,re,Pe);return(0,I.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterValue-value-wrapper",children:(0,I.jsx)(Bg.s,{className:Ae.segment,disabled:G,placeholder:ge,value:ue,onChange:k,loadOptions:We})})},nv=async(F,G,k)=>{const re=await(0,cc.tR)().get(F);if(!re||!re.getTagValues)return[];const ue=(0,Ni.jG)().timeRange(),ge=k.filter(We=>We.key!==G),Pe=await re.getTagValues({key:G,filters:ge,timeRange:ue});return(Array.isArray(Pe)?Pe:Pe.data).map(We=>({label:We.text,value:We.text}))};function av(){return{segment:(0,Ye.css)({display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"500px"})}}const sv=["=","!=","<",">","=~","!~"].map(F=>({label:F,value:F})),rv=({value:F,disabled:G,onChange:k})=>(0,I.jsx)(um.Y,{className:"query-segment-operator",value:F,disabled:G,options:sv,onChange:k}),gm=({datasource:F,filter:{key:G,operator:k,value:re},onKeyChange:ue,onOperatorChange:ge,onValueChange:Pe,placeHolder:Ae,allFilters:We,disabled:qe})=>(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(fm,{disabled:qe,datasource:F,filterKey:G,onChange:ue,allFilters:We}),(0,I.jsx)("div",{className:"gf-form",children:(0,I.jsx)(rv,{disabled:qe,value:k,onChange:ge})}),(0,I.jsx)(tv,{disabled:qe,datasource:F,filterKey:G,filterValue:re,allFilters:We,onChange:Pe,placeHolder:Ae})]}),ov=({datasource:F,appendBefore:G,onCompleted:k,allFilters:re})=>{const[ue,ge]=(0,l.useState)(null),[Pe,Ae]=(0,l.useState)("="),We=(0,l.useCallback)(rt=>{if(rt.value!==Oh){ge(rt.value??"");return}ge(null)},[ge]),qe=(0,l.useCallback)(rt=>Ae(rt.value??""),[Ae]),et=(0,l.useCallback)(rt=>{k({value:rt.value??"",operator:Pe,key:ue}),ge(null),Ae("=")},[k,Pe,ue]);return ue===null?(0,I.jsx)(fm,{datasource:F,filterKey:ue,onChange:We,allFilters:re}):(0,I.jsxs)(l.Fragment,{children:[G,(0,I.jsx)(gm,{datasource:F,filter:{key:ue,value:"",operator:Pe},placeHolder:(0,d.t)("variable.adhoc.placeholder","Select value"),onKeyChange:We,onOperatorChange:qe,onValueChange:et,allFilters:re})]},"filter-builder")},mm=({label:F})=>(0,I.jsx)("div",{className:"gf-form",children:(0,I.jsx)("span",{className:"gf-form-label query-keyword",children:F})});class iv extends l.PureComponent{constructor(){super(...arguments),this.connectorLabel=(0,d.t)("variables.ad-hoc-filter.label-and","AND"),this.onChange=(G,k)=>re=>{const{filters:ue}=this.props,{value:ge}=re;return re.value===Oh?this.props.removeFilter(G):this.props.changeFilter(G,{...ue[G],[k]:ge})},this.appendFilterToVariable=G=>{this.props.addFilter(G)}}render(){const{filters:G,disabled:k}=this.props;return(0,I.jsxs)("div",{className:"gf-form-inline",children:[this.renderFilters(G,k),!k&&(0,I.jsx)(ov,{datasource:this.props.datasource,appendBefore:G.length>0?(0,I.jsx)(mm,{label:this.connectorLabel}):null,onCompleted:this.appendFilterToVariable,allFilters:this.getAllFilters()})]})}getAllFilters(){return this.props.baseFilters?this.props.baseFilters.concat(this.props.filters):this.props.filters}renderFilters(G,k){return G.length===0&&k?(0,I.jsx)(um.Y,{disabled:k,value:"No filters",options:[],onChange:()=>{}}):G.reduce((re,ue,ge)=>(re.length>0&&re.push((0,I.jsx)(mm,{label:this.connectorLabel},`condition-${ge}`)),re.push(this.renderFilterSegments(ue,ge,k)),re),[])}renderFilterSegments(G,k,re){return(0,I.jsx)(l.Fragment,{children:(0,I.jsx)(gm,{disabled:re,datasource:this.props.datasource,filter:G,onKeyChange:this.onChange(k,"key"),onOperatorChange:this.onChange(k,"operator"),onValueChange:this.onChange(k,"value"),allFilters:this.getAllFilters()})},`filter-${k}`)}}const lv={addFilter:Wd.U2,removeFilter:Wd.VT,changeFilter:Wd.$u},cv=(0,hr.connect)(null,lv);class dv extends l.PureComponent{constructor(){super(...arguments),this.addFilter=G=>{this.props.addFilter((0,Rn.jX)(this.props.variable),G)},this.removeFilter=G=>{this.props.removeFilter((0,Rn.jX)(this.props.variable),G)},this.changeFilter=(G,k)=>{this.props.changeFilter((0,Rn.jX)(this.props.variable),{index:G,filter:k})}}render(){const{filters:G,datasource:k,baseFilters:re}=this.props.variable;return(0,I.jsx)(iv,{datasource:k,filters:G,baseFilters:re,disabled:this.props.readOnly,addFilter:this.addFilter,removeFilter:this.removeFilter,changeFilter:this.changeFilter})}}const vm=cv(dv);vm.displayName="AdHocPicker";var ym=e(25206);const uv=F=>F.map(G=>gv(G).map(fv).join("|")),hv=F=>{if((0,J.isArray)(F))return F.map(xm).filter(mv);const G=xm(F);return G===null?[]:[G]};function fv(F){return F==null?"":/\|/g[Symbol.replace](F,"__gfp__")}function pv(F){return F==null?"":/__gfp__/g[Symbol.replace](F,"|")}function gv(F){return[F.key,F.operator,F.value]}function xm(F){if(!(0,J.isString)(F)||F.length===0)return null;const G=F.split("|").map(pv);return{key:G[0],operator:G[1],value:G[2]}}function mv(F){return F!==null&&(0,J.isString)(F.value)}const Em=async()=>{},vv=()=>({id:"adhoc",description:(0,d.t)("variables.create-ad-hoc-variable-adapter.description.add-keyvalue-filters-on-the-fly","Add key/value filters on the fly."),name:"Ad hoc filters",initialState:ym.MK,reducer:ym.AA,picker:vm,editor:Z0,dependsOn:()=>!1,setValue:Em,setValueFromUrl:async(F,G)=>{const k=hv(G);await(0,Ba.JD)((0,Wd.D4)((0,Rn.jX)(F),k))},updateOptions:Em,getSaveModel:F=>{const{index:G,id:k,state:re,global:ue,rootStateKey:ge,...Pe}=(0,J.cloneDeep)(F);return Pe},getValueForUrl:F=>{const G=F?.filters??[];return uv(G)}});var Ug=e(14644),yv=e(8135),Ds=e(8921),ys=e(67933),Pm=e(13288),xv=e(44240),Ih=e(16126),Ev=e(38975),Pv=e(67791),bv=e(66847),Dv=e(69850),Cv=e(24726),qa=e(39167),Ma=e(74887),mo=e(65307),Fi=e(7389),Nd=e(96120),dc=e(88813);const Tv={...dc.Vg,type:"query",datasource:null,query:"",regex:"",sort:Fi.ZG.disabled,refresh:Fi.CO.onDashboardLoad,multi:!1,includeAll:!1,allValue:null,options:[],current:{},definition:""},Mv=(F,G)=>{if(G===Fi.ZG.disabled)return F;const k=Math.ceil(G/2),re=G%2===0;return k===1?F=(0,J.sortBy)(F,"text"):k===2?F=(0,J.sortBy)(F,ue=>{if(!ue.text)return-1;const ge=ue.text.match(/.*?(\d+).*/);return!ge||ge.length<2?-1:parseInt(ge[1],10)}):k===3?F=(0,J.sortBy)(F,ue=>(0,J.toLower)(ue.text)):k===4&&F.sort((ue,ge)=>ue.text?ge.text?ue.text.localeCompare(ge.text,void 0,{numeric:!0}):1:-1),re&&(F=F.reverse()),F},Sv=(F,G)=>{const k=[];let re=null;G.lastIndex=0;do re=G.exec(F),re&&k.push(re);while(G.global&&re&&re[0]!==""&&re[0]!==void 0);return k},Ov=(F,G,k)=>{let re,ue=[];F&&(re=(0,Ua.dO)(F));for(let ge=0;ge<k.length;ge++){const Pe=k[ge];let Ae=Pe.text===void 0||Pe.text===null?Pe.value:Pe.text,We=Pe.value===void 0||Pe.value===null?Pe.text:Pe.value;if((0,J.isNumber)(We)&&(We=We.toString()),(0,J.isNumber)(Ae)&&(Ae=Ae.toString()),re){const qe=Sv(We,re);if(!qe.length)continue;const et=qe.find(ht=>ht.groups&&ht.groups.value),rt=qe.find(ht=>ht.groups&&ht.groups.text),lt=qe.find(ht=>ht.length>1),pt=qe.length>1&&lt;if(et||rt)We=et?.groups?.value??rt?.groups?.text,Ae=rt?.groups?.text??et?.groups?.value;else if(pt){for(let ht=0;ht<qe.length;ht++){const Ct=qe[ht];ue.push({text:Ct[1],value:Ct[1],selected:!1})}continue}else lt&&(Ae=lt[1],We=lt[1])}ue.push({text:Ae,value:We,selected:!1})}return ue=(0,J.uniqBy)(ue,"value"),Mv(ue,G)},bm=(0,mo.Z0)({name:"templating/query",initialState:Nd.j,reducers:{updateVariableOptions:(F,G)=>{const{results:k,templatedRegex:re}=G.payload.data,ue=(0,xa.Fs)(F,G.payload.id);if(ue.type!=="query")return;const{includeAll:ge,sort:Pe}=ue,Ae=Ov(re,Pe,k);ge&&Ae.unshift({text:Ds.Zm,value:Ds.To,selected:!1}),Ae.length||Ae.push({text:Ds.ou,value:Ds.Ek,isNone:!0,selected:!1}),ue.options=Ae}}}),Iv=bm.reducer,{updateVariableOptions:Rv}=bm.actions;function Av(){return F=>F.pipe((0,oa.T)(jv))}function jv(F){const G=F.series;if(!G||!G.length)return[];if(Uv(G))return G;const k=(0,ws.Bt)(G),re=[];let ue=-1,ge=-1,Pe=-1,Ae=-1;for(const We of k)for(let qe=0;qe<We.fields.length;qe++){const et=We.fields[qe],rt=(0,se.Ct)(et,We,G).toLowerCase();et.type===ee.PU.string&&Pe===-1&&(Pe=qe),rt==="text"&&et.type===ee.PU.string&&ge===-1&&(ge=qe),rt==="value"&&et.type===ee.PU.string&&ue===-1&&(ue=qe),rt==="expandable"&&(et.type===ee.PU.boolean||et.type===ee.PU.number)&&Ae===-1&&(Ae=qe)}if(Pe===-1)throw new Error("Couldn't find any field of type string in the results.");for(const We of k)for(let qe=0;qe<We.length;qe++){const et=Ae!==-1?We.fields[Ae].values[qe]:void 0,rt=We.fields[Pe].values[qe],lt=ge!==-1?We.fields[ge].values[qe]:null,pt=ue!==-1?We.fields[ue].values[qe]:null;if(ue===-1&&ge===-1){re.push({text:rt,value:rt,expandable:et});continue}if(ue===-1&&ge!==-1){re.push({text:lt,value:lt,expandable:et});continue}if(ue!==-1&&ge===-1){re.push({text:pt,value:pt,expandable:et});continue}re.push({text:lt,value:pt,expandable:et})}return re}function Lv(F){return G=>G.pipe((0,oa.T)(k=>{const{variable:re,dispatch:ue,getTemplatedRegexFunc:ge}=F;if(!re.rootStateKey){console.error("updateOptionsState: variable.rootStateKey is not defined");return}const Pe=ge(re),Ae=(0,Rn.qD)(re,{results:k,templatedRegex:Pe});ue((0,Ma.kb)(re.rootStateKey,Rv(Ae)))}))}function Bv(F){return G=>G.pipe((0,qr.Z)(()=>{const{dispatch:k,variable:re,searchFilter:ue}=F;return ue?(0,Aa.of)():(0,Pr.H)(k((0,qa.kl)((0,Rn.jX)(re))))}))}function Uv(F){if(!F)return!1;if(!F.length)return!0;const G=F[0];if((0,ws.ci)(G))return!1;for(const k in G){if(!G.hasOwnProperty(k)||G[k]!==null&&typeof G[k]!="string"&&typeof G[k]!="number")continue;const re=k.toLowerCase();if(re==="text"||re==="value")return!0}return!1}var Rh=e(48592),Wv=e(22592);class Nv{constructor(){this.runners=[new Kv,new wv,new Fv,new $v]}getRunnerForDatasource(G){const k=this.runners.find(re=>re.canRun(G));if(k)return k;throw new Error("Couldn't find a query runner that matches supplied arguments.")}isQueryRunnerAvailableForDatasource(G){return this.runners.some(k=>k.canRun(G))}}class Kv{constructor(){this.type=Rh.Qz.Legacy}canRun(G){return(0,ys.d5)(G)}getTarget({datasource:G,variable:k}){if((0,ys.d5)(G))return k.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:G,variable:k,searchFilter:re,timeSrv:ue},ge){if(!(0,ys.d5)(G))return Kd();const Pe=(0,Rn.iP)(k,re,ue,ge.scopedVars);return(0,Pr.H)(G.metricFindQuery(k.query,Pe)).pipe((0,qr.Z)(Ae=>{if(!Ae||!Ae.length)return Kd();const We=Ae;return(0,Aa.of)({series:We,state:La.Gu.Done,timeRange:Pe.range})}))}}class wv{constructor(){this.type=Rh.Qz.Standard}canRun(G){return(0,ys.Hf)(G)}getTarget({datasource:G,variable:k}){if((0,ys.Hf)(G))return G.variables.toDataQuery(k.query);throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:G,runRequest:k},re){return(0,ys.Hf)(G)?G.variables.query?k(G,re,G.variables.query.bind(G.variables)):k(G,re):Kd()}}class Fv{constructor(){this.type=Rh.Qz.Custom}canRun(G){return(0,ys.zs)(G)}getTarget({datasource:G,variable:k}){if((0,ys.zs)(G))return k.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:G,runRequest:k},re){return(0,ys.zs)(G)?k(G,re,G.variables.query.bind(G.variables)):Kd()}}const Vv="variable-query";class $v{constructor(){this.type=Rh.Qz.Datasource}canRun(G){return(0,ys.X3)(G)}getTarget({datasource:G,variable:k}){if((0,ys.X3)(G))return{...k.query,refId:k.query.refId??Vv};throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:G,runRequest:k},re){return(0,ys.X3)(G)?k(G,re):Kd()}}function Kd(){return(0,Aa.of)({state:La.Gu.Done,series:[],timeRange:(0,Wv.E2)()})}class zv{constructor(G={dispatch:Ba.JD,getState:Ba.Gu,getVariable:xa.dn,getTemplatedRegex:Rn.u7,getTimeSrv:Ni.jG,queryRunners:new Nv,runRequest:jg.BN}){this.dependencies=G,this.updateOptionsRequests=new Dh.B,this.updateOptionsResults=new Dh.B,this.cancelRequests=new Dh.B,this.onNewRequest=this.onNewRequest.bind(this),this.subscription=this.updateOptionsRequests.subscribe(this.onNewRequest)}queueRequest(G){this.updateOptionsRequests.next(G)}getResponse(G){return this.updateOptionsResults.asObservable().pipe((0,Ih.p)(k=>k.identifier===G))}cancelRequest(G){this.cancelRequests.next({identifier:G})}destroy(){this.subscription.unsubscribe()}onNewRequest(G){const{datasource:k,identifier:re,searchFilter:ue}=G;try{const{dispatch:ge,runRequest:Pe,getTemplatedRegex:Ae,getVariable:We,queryRunners:qe,getTimeSrv:et,getState:rt}=this.dependencies,lt=(0,xa.y7)(rt());this.updateOptionsResults.next({identifier:re,state:La.Gu.Loading});const pt=We(re,rt());if(pt.type!=="query")return;const ht=et(),Ct={variable:pt,datasource:k,searchFilter:ue,timeSrv:ht,runRequest:Pe};if(!qe.isQueryRunnerAvailableForDatasource(k)){const vn=new Error("Query Runner is not available for datasource.");this.updateOptionsResults.next({identifier:re,state:La.Gu.Error,error:vn});return}const Wt=qe.getRunnerForDatasource(k),en=Wt.getTarget({datasource:k,variable:pt}),on=this.getRequest(pt,G,en);Wt.runRequest(Ct,on).pipe((0,Ih.p)(()=>{const vn=(0,xa.y7)(rt());return lt===vn}),(0,Ih.p)(vn=>vn.state===La.Gu.Done||vn.state===La.Gu.Error),(0,Ev.s)(1),(0,qr.Z)(vn=>vn.state===La.Gu.Error?(0,Pm.$)(()=>vn.error):(0,Aa.of)(vn)),Av(),Lv({variable:pt,dispatch:ge,getTemplatedRegexFunc:Ae}),Bv({variable:pt,dispatch:ge,searchFilter:ue}),(0,Pv.Q)((0,xv.h)(this.updateOptionsRequests,this.cancelRequests).pipe((0,Ih.p)(vn=>{let an=!1;return vn.identifier.id===re.id&&(an=!0,this.updateOptionsResults.next({identifier:re,state:La.Gu.Loading,cancelled:an})),an}))),(0,bv.W)(vn=>vn.cancelled?(0,Aa.of)({}):(this.updateOptionsResults.next({identifier:re,state:La.Gu.Error,error:vn}),(0,Pm.$)(()=>vn))),(0,Dv.j)(()=>{this.updateOptionsResults.next({identifier:re,state:La.Gu.Done})})).subscribe()}catch(ge){this.updateOptionsResults.next({identifier:re,state:La.Gu.Error,error:ge})}}getRequest(G,k,re){const{searchFilter:ue}=k,ge={variable:{text:G.current.text,value:G.current.value}},We={...ue?{searchFilter:{text:ue,value:ue}}:{},...ge},qe=this.dependencies.getTimeSrv().timeRange();return{app:nc.Jk.Dashboard,requestId:(0,Cv.A)(),timezone:"",range:qe,interval:"",intervalMs:0,targets:[re],scopedVars:We,startTime:Date.now()}}}let Dm;function _v(F){Dm=F}function Wg(){return Dm}const Gv=F=>{if(!Hv(F))return F.name;const{current:G}=F;return Array.isArray(G.text)?G.text.join(" + "):G.text},Hv=F=>Array.isArray(F?.options)||typeof F?.current=="object";var _o=(F=>(F[F.moveUp=38]="moveUp",F[F.moveDown=40]="moveDown",F[F.select=32]="select",F[F.cancel=27]="cancel",F[F.selectAndClose=13]="selectAndClose",F))(_o||{});class Qv extends l.PureComponent{constructor(){super(...arguments),this.onKeyDown=G=>{if(_o[G.keyCode]&&G.keyCode!==_o.select){const k=G.ctrlKey||G.metaKey||G.shiftKey;this.props.onNavigate(G.keyCode,k),G.preventDefault()}},this.onChange=G=>{this.props.onChange(G.target.value)}}render(){const{value:G,id:k,onNavigate:re,...ue}=this.props;return(0,I.jsx)("input",{...ue,ref:ge=>{ge&&(ge.focus(),ge.setAttribute("style",`width:${Math.max(ge.width,150)}px`))},id:k,type:"text",className:"gf-form-input",value:G??"",onChange:this.onChange,onKeyDown:this.onKeyDown,placeholder:(0,d.t)("variable.dropdown.placeholder","Enter variable value")})}}var kv=e(39884),Yv=e(11297);const Jv=({loading:F,disabled:G,onClick:k,text:re,onCancel:ue,id:ge})=>{const Pe=(0,mt.of)(Tm),Ae=(0,l.useCallback)(We=>{We.stopPropagation(),We.preventDefault(),k()},[k]);return F?(0,I.jsxs)("div",{className:Pe.container,"data-testid":Sa.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${re}`),title:re,id:ge,children:[(0,I.jsx)(Cm,{text:re}),(0,I.jsx)(kv.I,{loading:!0,onCancel:ue})]}):(0,I.jsxs)("button",{onClick:Ae,className:Pe.container,"data-testid":Sa.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${re}`),"aria-expanded":!1,"aria-controls":`options-${ge}`,id:ge,title:re,disabled:G,children:[(0,I.jsx)(Cm,{text:re}),(0,I.jsx)(_n.I,{"aria-hidden":!0,name:"angle-down",size:"sm"})]})},Cm=({text:F})=>{const G=(0,mt.of)(Tm);return(0,I.jsx)("span",{className:G.textAndTags,children:F===Ds.Zm?(0,d.t)("variable.picker.link-all","All"):F})},Tm=F=>{const G=(0,Yv.$)(F);return{container:(0,Ye.css)({maxWidth:"500px",paddingRight:"10px",padding:F.spacing(0,1),backgroundColor:F.components.input.background,border:`1px solid ${F.components.input.borderColor}`,borderRadius:F.shape.radius.default,display:"flex",alignItems:"center",color:F.colors.text.primary,height:F.spacing(F.components.height.md),[`.${G.badge}`]:{margin:"0 5px"},"&:disabled":{backgroundColor:F.colors.action.disabledBackground,color:F.colors.action.disabledText,border:`1px solid ${F.colors.action.disabledBackground}`}}),textAndTags:(0,Ye.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginRight:F.spacing(.25),userSelect:"none"})}};var Xv=e(45893),Zv=e(70427);class qv extends l.PureComponent{constructor(){super(...arguments),this.onToggle=G=>k=>{const re=k.shiftKey||k.ctrlKey||k.metaKey;this.handleEvent(k),this.props.onToggle(G,re)},this.onToggleAll=G=>{this.handleEvent(G),this.props.onToggleAll()}}handleEvent(G){G.preventDefault(),G.stopPropagation()}render(){const{multi:G,values:k,highlightIndex:re,selectedValues:ue,onToggle:ge,onToggleAll:Pe,theme:Ae,...We}=this.props,qe=Ng(Ae);return(0,I.jsx)("div",{className:qe.variableValueDropdown,children:(0,I.jsx)("div",{className:qe.variableOptionsWrapper,children:(0,I.jsxs)("ul",{className:qe.variableOptionsColumn,"aria-label":Sa.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownDropDown,...We,children:[this.renderMultiToggle(),k.map((et,rt)=>this.renderOption(et,rt))]})})})}renderOption(G,k){const{highlightIndex:re,multi:ue,theme:ge}=this.props,Pe=Ng(ge),Ae=G.value===Ds.To;return(0,I.jsx)("li",{children:(0,I.jsxs)("button",{"data-testid":Sa.Tp.components.Variables.variableOption,role:"checkbox",type:"button","aria-checked":G.selected,className:(0,Ye.cx)((0,ve.my)(ge),Pe.variableOption,{[Pe.highlighted]:k===re,[Pe.variableAllOption]:Ae},Pe.noStyledButton),onClick:this.onToggle(G),children:[(0,I.jsx)("span",{className:(0,Ye.cx)(Pe.variableOptionIcon,{[Pe.variableOptionIconSelected]:G.selected,[Pe.hideVariableOptionIcon]:!ue})}),(0,I.jsx)("span",{"data-testid":Sa.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownOptionTexts(`${G.text}`),children:Ae?(0,d.t)("variable.picker.option-all","All"):G.text})]})},`${G.value}`)}renderMultiToggle(){const{multi:G,selectedValues:k,theme:re,values:ue}=this.props,ge=Ng(re),Pe=ue.some(We=>We.value===Ds.To);if(!G)return null;const Ae=()=>(0,I.jsx)(d.x6,{i18nKey:"variable.picker.option-tooltip",children:"Clear selections"});return(0,I.jsx)(Kr.m,{content:Ae,placement:"top",children:(0,I.jsxs)("button",{className:(0,Ye.cx)((0,ve.my)(re),ge.variableOption,ge.variableOptionColumnHeader,ge.noStyledButton,{[ge.noPaddingBotton]:Pe}),role:"checkbox","aria-checked":k.length>1?"mixed":"false",onClick:this.onToggleAll,"aria-label":(0,d.t)("variables.variable-options.aria-label-toggle-all-values","Toggle all values"),"data-placement":"top",children:[(0,I.jsx)("span",{className:(0,Ye.cx)(ge.variableOptionIcon,{[ge.variableOptionIconManySelected]:k.length>1})}),(0,I.jsxs)(d.x6,{i18nKey:"variable.picker.option-selected-values",values:{numSelected:k.length},children:["Selected (","{{numSelected}}",")"]})]})})}}const Ng=(0,ou.N)(F=>{const G=F.isDark?Xv:Zv;return{hideVariableOptionIcon:(0,Ye.css)({display:"none"}),highlighted:(0,Ye.css)({backgroundColor:F.colors.action.hover}),noStyledButton:(0,Ye.css)({width:"100%",textAlign:"left"}),variableOption:(0,Ye.css)({display:"block",padding:"2px 27px 0 8px",position:"relative",whiteSpace:"nowrap",minWidth:"115px","&:hover":{backgroundColor:F.colors.action.hover}}),variableOptionColumnHeader:(0,Ye.css)({paddingTop:"5px",paddingBottom:"5px",marginBottom:"5px"}),variableOptionIcon:(0,Ye.css)({display:"inline-block",width:"24px",height:"18px",position:"relative",top:"4px",background:`url(${G}) left top no-repeat`}),variableOptionIconManySelected:(0,Ye.css)({background:`url(${G}) 0px -36px no-repeat`}),variableOptionIconSelected:(0,Ye.css)({background:`url(${G}) 0px -18px no-repeat`}),variableValueDropdown:(0,Ye.css)({backgroundColor:F.colors.background.primary,border:`1px solid ${F.colors.border.weak}`,borderRadius:F.shape.borderRadius(2),boxShadow:F.shadows.z2,position:"absolute",top:F.spacing(F.components.height.md),maxHeight:"400px",minHeight:"150px",minWidth:"150px",overflowY:"auto",overflowX:"hidden",zIndex:F.zIndex.typeahead}),variableOptionsColumn:(0,Ye.css)({maxHeight:"350px",display:"table-cell",lineHeight:"26px",listStyleType:"none"}),variableOptionsWrapper:(0,Ye.css)({display:"table",width:"100%"}),variableAllOption:(0,Ye.css)({borderBottom:`1px solid ${F.colors.border.weak}`,paddingBottom:F.spacing(1)}),noPaddingBotton:(0,Ye.css)({paddingBottom:0})}}),ey=(0,mt.cV)(qv);var ty=e(94452),Mm=e(3594),Go=e(88681),Ir=e(99598);const ny=(F,G,k)=>async(re,ue)=>{if(G===_o.cancel)return await re(Ah(F));if(G===_o.select)return re(Kg(F,k));if(G===_o.selectAndClose)return(0,xa.nx)(F,ue()).optionsPicker.multi?re(Kg(F,k)):(re(Kg(F,k,!0)),re(Ah(F)));if(G===_o.moveDown)return re((0,Ma.kb)(F,(0,Ir.O$)(1)));if(G===_o.moveUp)return re((0,Ma.kb)(F,(0,Ir.O$)(-1)))},ay=(F,G="")=>async(k,re)=>{const{rootStateKey:ue}=F,{id:ge,queryValue:Pe}=(0,xa.nx)(ue,re()).optionsPicker,Ae={id:ge,rootStateKey:ue,type:"query"},We=(0,xa.dn)(Ae,re());if(!("options"in We)||(k((0,Ma.kb)(ue,(0,Ir.S8)(G))),(0,J.trim)(Pe)===(0,J.trim)(G)))return;const{query:qe,options:et}=We,rt=typeof qe=="string"?qe:qe.target;return(0,ty.E)(rt)?iy(k,re,G,ue):k((0,Ma.kb)(ue,(0,Ir.fx)(et)))},sy=async F=>{if((0,Mm.R)(F.current))return;await Ud.B.get(F.type).setValue(F,F.current,!0)},Ah=(F,G)=>async(k,re)=>{const ue=(0,xa.nx)(F,re()).optionsPicker,ge={id:ue.id,rootStateKey:F,type:"query"},Pe=(0,xa.dn)(ge,re());if(!(0,ys.SP)(Pe))return;const Ae={option:ly(ue)},We={propName:"queryValue",propValue:ue.queryValue};k((0,Ma.kb)(F,(0,Go.dE)((0,Rn.qD)(Pe,Ae)))),k((0,Ma.kb)(F,(0,Go.QP)((0,Rn.qD)(Pe,We))));const qe=(0,xa.dn)(ge,re());if((0,ys.SP)(qe)&&(k((0,Ma.kb)(F,(0,Ir.Fu)())),(0,Rn.Lz)(Pe)!==(0,Rn.Lz)(qe)))return G?G(qe):await sy(qe)},ry=(F,G)=>async(k,re)=>{const{id:ue,rootStateKey:ge}=F,Pe=(0,xa.nx)(ge,re()).optionsPicker;Pe.id&&Pe.id!==ue&&await k(Ah(ge,G));const Ae=(0,xa.dn)(F,re());(0,ys.SP)(Ae)&&k((0,Ma.kb)(ge,(0,Ir.MO)(Ae)))},Kg=(F,G,k=!1)=>(re,ue)=>{const{highlightIndex:ge,options:Pe}=(0,xa.nx)(F,ue()).optionsPicker,Ae=Pe[ge];re((0,Ma.kb)(F,(0,Ir.U9)({option:Ae,forceSelect:k,clearOthers:G})))},oy=async(F,G,k,re)=>{try{const{id:ue}=(0,xa.nx)(re,G()).optionsPicker,ge={id:ue,rootStateKey:re,type:"query"},Pe=(0,xa.dn)(ge,G());if(!(0,ys.SP)(Pe))return;await Ud.B.get(Pe.type).updateOptions(Pe,k);const We=(0,xa.dn)(ge,G());if(!(0,ys.SP)(We))return;F((0,Ma.kb)(re,(0,Ir.qh)(We.options)))}catch(ue){console.error(ue)}},iy=(0,J.debounce)(oy,500);function ly(F){const{options:G,selectedValues:k,queryValue:re,multi:ue}=F;if(G.length===0&&re&&re.length>0)return{text:re,value:re,selected:!1};if(!ue)return k.find(Ae=>Ae.selected);const ge=[],Pe=[];for(const Ae of k)Ae.selected&&(ge.push(Ae.text.toString()),Pe.push(Ae.value.toString()));return{value:Pe,text:ge,selected:!0}}const wd=()=>{const F=ge=>({...(0,Ug.bindActionCreators)({openOptions:ry,commitChangesToVariable:Ah,navigateOptions:ny},ge),filterOrSearchOptions:(Pe,Ae="")=>{ge(ay(Pe,Ae))},toggleAllOptions:Pe=>ge((0,Ma.kb)(Pe.rootStateKey,(0,Ir.an)())),toggleOption:(Pe,Ae,We,qe)=>ge((0,Ma.kb)(Pe.rootStateKey,(0,Ir.U9)({option:Ae,clearOthers:We,forceSelect:qe})))}),G=(ge,Pe)=>{const{rootStateKey:Ae}=Pe.variable;return Ae?{picker:(0,xa.nx)(Ae,ge).optionsPicker}:(console.error("OptionPickerFactory: variable has no rootStateKey"),{picker:Ir.$z})},k=(0,hr.connect)(G,F);class re extends l.PureComponent{constructor(){super(...arguments),this.onShowOptions=()=>this.props.openOptions((0,Rn.jX)(this.props.variable),this.props.onVariableChange),this.onHideOptions=()=>{if(!this.props.variable.rootStateKey){console.error("Variable has no rootStateKey");return}this.props.commitChangesToVariable(this.props.variable.rootStateKey,this.props.onVariableChange)},this.onToggleOption=(Pe,Ae)=>{((0,ys.iv)(this.props.variable)&&this.props.variable.multi?this.onToggleMultiValueVariable:this.onToggleSingleValueVariable)(Pe,Ae)},this.onToggleSingleValueVariable=(Pe,Ae)=>{this.props.toggleOption((0,Rn.jX)(this.props.variable),Pe,Ae,!1),this.onHideOptions()},this.onToggleMultiValueVariable=(Pe,Ae)=>{this.props.toggleOption((0,Rn.jX)(this.props.variable),Pe,Ae,!1)},this.onToggleAllOptions=()=>{this.props.toggleAllOptions((0,Rn.jX)(this.props.variable))},this.onFilterOrSearchOptions=Pe=>{this.props.filterOrSearchOptions((0,Rn.jX)(this.props.variable),Pe)},this.onNavigate=(Pe,Ae)=>{if(!this.props.variable.rootStateKey){console.error("Variable has no rootStateKey");return}this.props.navigateOptions(this.props.variable.rootStateKey,Pe,Ae)},this.onCancel=()=>{Wg().cancelRequest((0,Rn.jX)(this.props.variable))}}render(){const{variable:Pe,picker:Ae}=this.props,We=Ae.id===Pe.id,qe=cy();return(0,I.jsx)("div",{className:qe.variableLinkWrapper,"data-testid":Sa.Tp.components.Variables.variableLinkWrapper,children:We?this.renderOptions(Ae):this.renderLink(Pe)})}renderLink(Pe){const Ae=Gv(Pe),We=Pe.state===La.Gu.Loading;return(0,I.jsx)(Jv,{id:Ds.qz+Pe.id,text:Ae,onClick:this.onShowOptions,loading:We,onCancel:this.onCancel,disabled:this.props.readOnly})}renderOptions(Pe){const{id:Ae}=this.props.variable;return(0,I.jsxs)(yv.N,{onClick:this.onHideOptions,children:[(0,I.jsx)(Qv,{id:Ds.qz+Ae,value:Pe.queryValue,onChange:this.onFilterOrSearchOptions,onNavigate:this.onNavigate,"aria-expanded":!0,"aria-controls":`options-${Ae}`}),(0,I.jsx)(ey,{values:Pe.options,onToggle:this.onToggleOption,onToggleAll:this.onToggleAllOptions,highlightIndex:Pe.highlightIndex,multi:Pe.multi,selectedValues:Pe.selectedValues,id:`options-${Ae}`})]})}}const ue=k(re);return ue.displayName="OptionsPicker",ue},cy=()=>({variableLinkWrapper:(0,Ye.css)({display:"inline-block",position:"relative"})});var dy=e(23675);class uy extends l.PureComponent{constructor(){super(...arguments),this.onChange=G=>{this.props.onPropChange({propName:"query",propValue:G.currentTarget.value,updateOptions:!0})}}render(){return(0,I.jsx)(dy.d,{constantValue:this.props.variable.query,onChange:this.onChange})}}const hy={...dc.Vg,type:"constant",hide:Fi.zL.hideVariable,query:"",current:{},options:[]},Sm=(0,mo.Z0)({name:"templating/constant",initialState:Nd.j,reducers:{createConstantOptionsFromQuery:(F,G)=>{const k=(0,xa.Fs)(F,G.payload.id);k.type==="constant"&&(k.options=[{text:k.query.trim(),value:k.query.trim(),selected:!1}])}}}),fy=Sm.reducer,{createConstantOptionsFromQuery:py}=Sm.actions,gy=F=>async G=>{const{rootStateKey:k}=F;await G((0,Ma.kb)(k,py((0,Rn.qD)(F)))),await G((0,qa.kl)(F))},my=()=>({id:"constant",description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share.",name:"Constant",initialState:hy,reducer:fy,picker:wd(),editor:uy,dependsOn:()=>!1,setValue:async(F,G,k=!1)=>{await(0,Ba.JD)((0,qa.t9)((0,Rn.jX)(F),G,k))},setValueFromUrl:async(F,G)=>{await(0,Ba.JD)((0,qa.x7)((0,Rn.jX)(F),G))},updateOptions:async F=>{await(0,Ba.JD)(gy((0,Rn.jX)(F)))},getSaveModel:F=>{const{index:G,id:k,state:re,global:ue,current:ge,options:Pe,rootStateKey:Ae,...We}=(0,J.cloneDeep)(F);return We},getValueForUrl:F=>F.current.value,beforeAdding:F=>{const{current:G,options:k,query:re,...ue}=(0,J.cloneDeep)(F),ge={selected:!0,text:re,value:re};return{...ue,current:ge,options:[ge],query:re}}});function vy(F,...G){const k=(0,hr.connect)(...G)(F);return re=>(0,I.jsx)(k,{...re,store:Ba.M_})}function yE(F,...G){const k=connect(...G)(F);return re=>jsx(Provider,{store,children:jsx(k,{...re,store})})}var yy=e(70430);class xy extends l.PureComponent{constructor(){super(...arguments),this.onSelectionOptionsChange=async({propName:G,propValue:k})=>{this.props.onPropChange({propName:G,propValue:k,updateOptions:!0})},this.onQueryChange=G=>{this.props.onPropChange({propName:"query",propValue:G.currentTarget.value,updateOptions:!0})}}render(){return(0,I.jsx)(yy.w,{query:this.props.variable.query,multi:this.props.variable.multi,allValue:this.props.variable.allValue,includeAll:this.props.variable.includeAll,onQueryChange:this.onQueryChange,onMultiChange:G=>this.onSelectionOptionsChange({propName:"multi",propValue:G.currentTarget.checked}),onIncludeAllChange:G=>this.onSelectionOptionsChange({propName:"includeAll",propValue:G.currentTarget.checked}),onAllValueChange:G=>this.onSelectionOptionsChange({propName:"allValue",propValue:G.currentTarget.value})})}}const Ey=(F,G)=>({}),Py={changeVariableMultiValue:qa.TI},by=vy(xy,Ey,Py),Dy={...dc.Vg,type:"custom",multi:!1,includeAll:!1,allValue:null,query:"",options:[],current:{}},Om=(0,mo.Z0)({name:"templating/custom",initialState:Nd.j,reducers:{createCustomOptionsFromQuery:(F,G)=>{const k=(0,xa.Fs)(F,G.payload.id);if(k.type!=="custom")return;const{includeAll:re}=k,Pe=(G.payload.data.match(/(?:\\,|[^,])+/g)??[]).map(Ae=>{Ae=Ae.replace(/\\,/g,",");const We=/^(.+)\s:\s(.+)$/g.exec(Ae)??[];if(We.length===3){const[,qe,et]=We;return{text:qe.trim(),value:et.trim(),selected:!1}}else return{text:Ae.trim(),value:Ae.trim(),selected:!1}});re&&Pe.unshift({text:Ds.Zm,value:Ds.To,selected:!1}),k.options=Pe}}}),Cy=Om.reducer,{createCustomOptionsFromQuery:Ty}=Om.actions,My=F=>async(G,k)=>{const{rootStateKey:re}=F,ue=(0,xa.dn)(F,k());if(ue.type!=="custom")return;const ge=(0,dt.w)().replace(ue.query);await G((0,Ma.kb)(re,Ty((0,Rn.qD)(F,ge)))),await G((0,qa.kl)(F))},Sy=()=>({id:"custom",description:(0,d.t)("variables.create-custom-variable-adapter.description.define-variable-values-manually","Define variable values manually"),name:"Custom",initialState:Dy,reducer:Cy,picker:wd(),editor:by,dependsOn:(F,G)=>(0,Rn.wJ)(F.query,G.name),setValue:async(F,G,k=!1)=>{await(0,Ba.JD)((0,qa.t9)((0,Rn.jX)(F),G,k))},setValueFromUrl:async(F,G)=>{await(0,Ba.JD)((0,qa.x7)((0,Rn.jX)(F),G))},updateOptions:async F=>{await(0,Ba.JD)(My((0,Rn.jX)(F)))},getSaveModel:F=>{const{index:G,id:k,state:re,global:ue,rootStateKey:ge,...Pe}=(0,J.cloneDeep)(F);return Pe},getValueForUrl:F=>(0,Rn.ML)(F)?Ds.Zm:F.current.value});var Oy=e(42272),Iy=e(8134);const Ry={...dc.Vg,type:"datasource",current:{},regex:"",options:[],query:"",multi:!1,includeAll:!1,refresh:Fi.CO.onDashboardLoad},Im=(0,mo.Z0)({name:"templating/datasource",initialState:Nd.j,reducers:{createDataSourceOptions:(F,G)=>{const{sources:k,regex:re}=G.payload.data,ue=[],ge=(0,xa.Fs)(F,G.payload.id);if(ge.type==="datasource"){for(let Pe=0;Pe<k.length;Pe++){const Ae=k[Pe];(0,Iy._)(ge.query,Ae.meta)&&(Ay(Ae,re)&&ue.push({text:Ae.name,value:Ae.uid,selected:!1}),jy(Ae,re)&&ue.push({text:(0,d.t)("variables.data-source-variable-slice.text.default","default"),value:"default",selected:!1}))}ue.length===0&&ue.push({text:(0,d.t)("variables.data-source-variable-slice.text.no-data-sources-found","No data sources found"),value:"",selected:!1}),ge.includeAll&&ue.unshift({text:Ds.Zm,value:Ds.To,selected:!1}),ge.options=ue}}}});function Ay(F,G){return G?G.exec(F.name):!0}function jy(F,G){return F.isDefault?G?G.exec("default"):!0:!1}const Ly=Im.reducer,{createDataSourceOptions:By}=Im.actions,Uy=(F,G={getDatasourceSrv:cc.tR})=>async(k,re)=>{const{rootStateKey:ue}=F,ge=G.getDatasourceSrv().getList({metrics:!0,variables:!1}),Pe=(0,xa.dn)(F,re());if(Pe.type!=="datasource")return;let Ae;Pe.regex&&(Ae=(0,dt.w)().replace(Pe.regex,void 0,"regex"),Ae=(0,Ua.dO)(Ae)),k((0,Ma.kb)(ue,By((0,Rn.qD)(F,{sources:ge,regex:Ae})))),await k((0,qa.kl)(F))},Wy=(F,G={getDatasourceSrv:cc.tR})=>k=>{const re=G.getDatasourceSrv().getList({metrics:!0,variables:!0}),ue=(0,J.chain)(re).uniqBy("meta.id").map(ge=>({text:ge.meta.name,value:ge.meta.id})).value();ue.unshift({text:"",value:""}),k((0,Ma.kb)(F,(0,go.BC)({dataSourceTypes:ue})))},Ny=(F,G)=>{const{variable:{rootStateKey:k}}=G;if(!k)return console.error("DataSourceVariableEditor: variable has no rootStateKey"),{extended:dm(go.nS)};const{editor:re}=(0,xa.nx)(k,F);return{extended:dm(re)}},Ky={initDataSourceVariableEditor:Wy,changeVariableMultiValue:qa.TI},wy=(0,hr.connect)(Ny,Ky);class Fy extends l.PureComponent{constructor(){super(...arguments),this.onRegExBlur=G=>{this.props.onPropChange({propName:"regex",propValue:G.currentTarget.value,updateOptions:!0})},this.onSelectionOptionsChange=async({propValue:G,propName:k})=>{this.props.onPropChange({propName:k,propValue:G,updateOptions:!0})},this.onMultiChanged=G=>{this.props.changeVariableMultiValue((0,Rn.jX)(this.props.variable),G.currentTarget.checked)},this.onIncludeAllChanged=G=>{this.onSelectionOptionsChange({propName:"includeAll",propValue:G.currentTarget.checked})},this.onAllValueChanged=G=>{this.onSelectionOptionsChange({propName:"allValue",propValue:G.currentTarget.value})},this.getSelectedDataSourceTypeValue=()=>{const{extended:G}=this.props;if(!G?.dataSourceTypes.length)return"";const k=G.dataSourceTypes.find(ue=>ue.value===this.props.variable.query);return(k?k.value:G.dataSourceTypes[0].value)??""},this.onDataSourceTypeChanged=G=>{this.props.onPropChange({propName:"query",propValue:G.value,updateOptions:!0})}}componentDidMount(){const{rootStateKey:G}=this.props.variable;if(!G){console.error("DataSourceVariableEditor: variable has no rootStateKey");return}this.props.initDataSourceVariableEditor(G)}render(){const{variable:G,extended:k}=this.props,re=k?.dataSourceTypes?.length?k.dataSourceTypes?.map(ue=>({value:ue.value??"",label:ue.text})):[];return(0,I.jsx)(Oy.y,{query:G.query,regex:G.regex,multi:G.multi,includeAll:G.includeAll,optionTypes:re,onChange:this.onDataSourceTypeChanged,onRegExBlur:this.onRegExBlur,onMultiChange:this.onMultiChanged,onIncludeAllChange:this.onIncludeAllChanged,onAllValueChange:this.onAllValueChanged})}}const Vy=wy(Fy),$y=()=>({id:"datasource",description:"Enables you to dynamically switch the data source for multiple panels.",name:"Data source",initialState:Ry,reducer:Ly,picker:wd(),editor:Vy,dependsOn:(F,G)=>F.regex?(0,Rn.wJ)(F.regex,G.name):!1,setValue:async(F,G,k=!1)=>{await(0,Ba.JD)((0,qa.t9)((0,Rn.jX)(F),G,k))},setValueFromUrl:async(F,G)=>{await(0,Ba.JD)((0,qa.x7)((0,Rn.jX)(F),G))},updateOptions:async F=>{await(0,Ba.JD)(Uy((0,Rn.jX)(F)))},getSaveModel:F=>{const{index:G,id:k,state:re,global:ue,rootStateKey:ge,...Pe}=(0,J.cloneDeep)(F);return{...Pe,options:[]}},getValueForUrl:F=>(0,Rn.ML)(F)?Ds.Zm:F.current.value});var zy=e(66223),_y=e(1096);const Rm=(0,l.memo)(({onPropChange:F,variable:G})=>{const k=Pe=>{F({propName:"auto",propValue:Pe.target.checked,updateOptions:!0})},re=Pe=>{F({propName:"query",propValue:Pe.currentTarget.value,updateOptions:!0})},ue=Pe=>{F({propName:"auto_count",propValue:Pe.value,updateOptions:!0})},ge=Pe=>{F({propName:"auto_min",propValue:Pe.currentTarget.value,updateOptions:!0})};return(0,I.jsx)(_y.s,{intervals:G.query,autoStepCount:G.auto_count,autoEnabled:G.auto,onAutoCountChanged:ue,onIntervalsChange:re,onAutoEnabledChange:k,onAutoMinIntervalChanged:ge,autoMinInterval:G.auto_min})});Rm.displayName="IntervalVariableEditor";var Gy=e(59373),wg=e(98732);const Hy=F=>async G=>{const{rootStateKey:k}=F;await G((0,Ma.kb)(k,(0,wg.mn)((0,Rn.qD)(F)))),await G(Fg(F)),await G((0,qa.kl)(F))},Fg=(F,G={calculateInterval:om.calculateInterval,getTimeSrv:Ni.jG,templateSrv:(0,Gy.w)()})=>(k,re)=>{const ue=(0,xa.dn)(F,re());if(ue.type==="interval"&&ue.auto){const ge=G.calculateInterval(G.getTimeSrv().timeRange(),ue.auto_count,ue.auto_min);G.templateSrv.setGrafanaVariable("$__auto_interval_"+ue.name,ge.interval),G.templateSrv.setGrafanaVariable("$__auto_interval",ge.interval)}},Qy=()=>({id:"interval",description:(0,d.t)("variables.create-interval-variable-adapter.description.define-timespan-interval","Define a timespan interval (for example: {{timeIntervals}})",{timeIntervals:"1m, 1h, 1d"}),name:"Interval",initialState:wg.Ez,reducer:wg.E5,picker:wd(),editor:Rm,dependsOn:()=>!1,setValue:async(F,G,k=!1)=>{await(0,Ba.JD)(Fg((0,Rn.jX)(F))),await(0,Ba.JD)((0,qa.t9)((0,Rn.jX)(F),G,k))},setValueFromUrl:async(F,G)=>{await(0,Ba.JD)(Fg((0,Rn.jX)(F))),await(0,Ba.JD)((0,qa.x7)((0,Rn.jX)(F),G))},updateOptions:async F=>{await(0,Ba.JD)(Hy((0,Rn.jX)(F)))},getSaveModel:F=>{const{index:G,id:k,state:re,global:ue,rootStateKey:ge,...Pe}=(0,J.cloneDeep)(F);return Pe},getValueForUrl:F=>F.current.value});var ky=e(28799),Yy=e(64423),Jy=e(38681);function Xy(F,G,k){return{next:ue=>{if(ue.state===La.Gu.Error){k.unsubscribe(),G(ue.error);return}if(ue.state===La.Gu.Done){k.unsubscribe(),F();return}},error:ue=>{k.unsubscribe(),G(ue)},complete:()=>{k.unsubscribe(),F()}}}const Zy=(F,G)=>async(k,re)=>{try{const{rootStateKey:ue}=F;if(!(0,Rn.sN)(ue,re()))return;const ge=(0,xa.dn)(F,re());if(ge.type!=="query")return;(0,xa.nx)(ue,re()).editor.id===ge.id&&k((0,Ma.kb)(ue,(0,go.Eo)({errorProp:"update"})));const Pe=await(0,B.l)().get(ge.datasource??"");await new Promise((Ae,We)=>{const qe=new Yy.yU,et=Xy(Ae,We,qe),rt=Wg().getResponse(F).subscribe(et);qe.add(rt),Wg().queueRequest({identifier:F,datasource:Pe,searchFilter:G})})}catch(ue){if(ue instanceof Error){const ge=(0,Rg.u)(ue),{rootStateKey:Pe}=F;throw(0,xa.nx)(Pe,re()).editor.id===F.id&&k((0,Ma.kb)(Pe,(0,go.NY)({errorProp:"update",errorText:ge.message??""}))),ge}}},qy=F=>async(G,k)=>{const re=(0,xa.dn)(F,k());re.type==="query"&&await G(Am((0,Rn.jX)(re),re.datasource))},Am=(F,G)=>async(k,re)=>{try{const{rootStateKey:ue}=F,{editor:ge}=(0,xa.nx)(ue,re()),Ae=Lg(ge)?.dataSource,We=await(0,B.l)().get(G??"");Ae&&Ae.type!==We?.type&&k((0,Ma.kb)(ue,(0,Go.QP)((0,Rn.qD)(F,{propName:"query",propValue:""}))));const qe=await(0,Jy.y)(We);k((0,Ma.kb)(ue,(0,go.BC)({dataSource:We,VariableQueryEditor:qe})))}catch(ue){console.error(ue)}},ex=(F,G,k)=>async(re,ue)=>{const{rootStateKey:ge}=F,Pe=(0,xa.dn)(F,ue());if(Pe.type==="query"){if(tx(Pe.name,G)){const Ae="Query cannot contain a reference to itself. Variable: $"+Pe.name;re((0,Ma.kb)(ge,(0,go.NY)({errorProp:"query",errorText:Ae})));return}re((0,Ma.kb)(ge,(0,go.Eo)({errorProp:"query"}))),re((0,Ma.kb)(ge,(0,Go.QP)((0,Rn.qD)(F,{propName:"query",propValue:G})))),k!==void 0?re((0,Ma.kb)(ge,(0,Go.QP)((0,Rn.qD)(F,{propName:"definition",propValue:k})))):typeof G=="string"&&re((0,Ma.kb)(ge,(0,Go.QP)((0,Rn.qD)(F,{propName:"definition",propValue:G})))),await re((0,qa.mZ)(F))}};function tx(F,G){if(typeof G=="string"&&G.match(new RegExp("\\$"+F+"(/| |$)")))return!0;const k=jm(G);for(let re in k)if(k.hasOwnProperty(re)){const ue=k[re];if(typeof ue=="string"&&ue.match(new RegExp("\\$"+F+"(/| |$)")))return!0}return!1}function jm(F){return typeof F!="object"||F===null?{query:F}:Object.keys(F).reduce((re,ue)=>{const ge=F[ue];if(typeof ge!="object"||ge===null)return re[ue]=ge,re;const Pe=jm(ge);for(let Ae in Pe)Pe.hasOwnProperty(Ae)&&(re[`${ue}_${Ae}`]=Pe[Ae]);return re},{})}const nx=(F,G)=>{const{rootStateKey:k}=G.variable;if(!k)return console.error("QueryVariableEditor: variable has no rootStateKey"),{extended:Lg(go.nS)};const{editor:re}=(0,xa.nx)(k,F);return{extended:Lg(re)}},ax={initQueryVariableEditor:qy,changeQueryVariableDataSource:Am,changeQueryVariableQuery:ex,changeVariableMultiValue:qa.TI},sx=(0,hr.connect)(nx,ax);class rx extends l.PureComponent{constructor(){super(...arguments),this.state={regex:null,tagsQuery:null,tagValuesQuery:null},this.onDataSourceChange=G=>{this.props.onPropChange({propName:"datasource",propValue:G.isDefault?null:(0,lm.p$)(G)})},this.onLegacyQueryChange=async(G,k)=>{this.props.variable.query!==G&&this.props.changeQueryVariableQuery((0,Rn.jX)(this.props.variable),G,k)},this.onQueryChange=async G=>{if(this.props.variable.query!==G){let k="";G&&G.hasOwnProperty("query")&&typeof G.query=="string"&&(k=G.query),this.props.changeQueryVariableQuery((0,Rn.jX)(this.props.variable),G,k)}},this.onRegExBlur=async G=>{const k=G.currentTarget.value;this.props.variable.regex!==k&&this.props.onPropChange({propName:"regex",propValue:k,updateOptions:!0})},this.onRefreshChange=G=>{this.props.onPropChange({propName:"refresh",propValue:G})},this.onSortChange=async G=>{this.props.onPropChange({propName:"sort",propValue:G.value,updateOptions:!0})},this.onMultiChange=G=>{this.props.onPropChange({propName:"multi",propValue:G.currentTarget.checked})},this.onIncludeAllChange=G=>{this.props.onPropChange({propName:"includeAll",propValue:G.currentTarget.checked})},this.onAllValueChange=G=>{this.props.onPropChange({propName:"allValue",propValue:G.currentTarget.value})}}async componentDidMount(){await this.props.initQueryVariableEditor((0,Rn.jX)(this.props.variable))}componentDidUpdate(G){G.variable.datasource!==this.props.variable.datasource&&this.props.changeQueryVariableDataSource((0,Rn.jX)(this.props.variable),this.props.variable.datasource)}render(){const{extended:G,variable:k}=this.props;if(!G||!G.dataSource)return null;const re=(0,Ni.jG)().timeRange();return(0,I.jsx)(ky.u,{datasource:k.datasource??void 0,onDataSourceChange:this.onDataSourceChange,query:k.query,onQueryChange:this.onQueryChange,onLegacyQueryChange:this.onLegacyQueryChange,timeRange:re,regex:k.regex,onRegExChange:this.onRegExBlur,sort:k.sort,onSortChange:this.onSortChange,refresh:k.refresh,onRefreshChange:this.onRefreshChange,isMulti:k.multi,includeAll:k.includeAll,allValue:k.allValue??"",onMultiChange:this.onMultiChange,onIncludeAllChange:this.onIncludeAllChange,onAllValueChange:this.onAllValueChange})}}const ox=sx(rx),ix=()=>({id:"query",description:(0,d.t)("variables.create-query-variable-adapter.description.variable-values-fetched-datasource-query","Variable values are fetched from a datasource query"),name:"Query",initialState:Tv,reducer:Iv,picker:wd(),editor:ox,dependsOn:(F,G)=>(0,Rn.wJ)(F.query,F.datasource?.uid,F.regex,G.name),setValue:async(F,G,k=!1)=>{await(0,Ba.JD)((0,qa.t9)((0,Rn.jX)(F),G,k))},setValueFromUrl:async(F,G)=>{await(0,Ba.JD)((0,qa.x7)((0,Rn.jX)(F),G))},updateOptions:async(F,G)=>{await(0,Ba.JD)(Zy((0,Rn.jX)(F),G))},getSaveModel:F=>{const{index:G,id:k,state:re,global:ue,queryValue:ge,rootStateKey:Pe,...Ae}=(0,J.cloneDeep)(F);return F.refresh!==Fi.CO.never?{...Ae,options:[]}:Ae},getValueForUrl:F=>(0,Rn.ML)(F)?Ds.Zm:F.current.value}),lx=()=>({id:"system",description:"",name:"system",initialState:{...dc.Vg,type:"system",hide:Fi.zL.hideVariable,skipUrlSync:!0,current:{value:{toString:()=>""}},state:La.Gu.Done},reducer:F=>F,picker:null,editor:null,dependsOn:()=>!1,setValue:async(F,G,k=!1)=>{},setValueFromUrl:async(F,G)=>{},updateOptions:async F=>{},getSaveModel:F=>({}),getValueForUrl:F=>""});var cx=e(32442),dx=e(49602);function ux({onPropChange:F,variable:{query:G}}){const k=(0,l.useCallback)((ge,Pe)=>{ge.preventDefault(),F({propName:"originalQuery",propValue:ge.currentTarget.value,updateOptions:!1}),F({propName:"query",propValue:ge.currentTarget.value,updateOptions:Pe})},[F]),re=(0,l.useCallback)(ge=>k(ge,!1),[k]),ue=(0,l.useCallback)(ge=>k(ge,!0),[k]);return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(cx.Y,{children:(0,I.jsx)(d.x6,{i18nKey:"variables.text-box-variable-editor.text-options",children:"Text options"})}),(0,I.jsx)(dx._,{value:G,name:(0,d.t)("variables.text-box-variable-editor.name-default-value","Default value"),placeholder:(0,d.t)("variables.text-box-variable-editor.placeholder-default-value-if-any","default value, if any"),onChange:re,onBlur:ue,width:30,testId:Sa.Tp.pages.Dashboard.Settings.Variables.Edit.TextBoxVariable.textBoxOptionsQueryInputV2})]})}function hx({variable:F,onVariableChange:G,readOnly:k}){const re=(0,nr.wA)(),[ue,ge]=(0,l.useState)(F.current.value);(0,l.useEffect)(()=>{ge(F.current.value)},[F]);const Pe=(0,l.useCallback)(()=>{if(!F.rootStateKey){console.error("Cannot update variable without rootStateKey");return}if(F.current.value!==ue){if(re((0,Ma.kb)(F.rootStateKey,(0,Go.QP)((0,Rn.qD)({id:F.id,type:F.type},{propName:"query",propValue:ue})))),G){G({...F,current:(0,Mm.R)(F.current)?{}:{...F.current,value:ue}});return}Ud.B.get(F.type).updateOptions(F)}},[F,ue,re,G]),Ae=(0,l.useCallback)(et=>ge(et.target.value),[ge]),We=et=>Pe(),qe=et=>{et.keyCode===13&&(et.preventDefault(),Pe())};return(0,I.jsx)(tn.p,{type:"text",value:ue,onChange:Ae,onBlur:We,disabled:k,onKeyDown:qe,placeholder:(0,d.t)("variable.textbox.placeholder","Enter variable value"),id:Ds.qz+F.id})}const fx={...dc.Vg,type:"textbox",query:"",current:{},options:[],originalQuery:null},Lm=(0,mo.Z0)({name:"templating/textbox",initialState:Nd.j,reducers:{createTextBoxOptions:(F,G)=>{const k=(0,xa.Fs)(F,G.payload.id);if(k.type!=="textbox")return;const re={text:k.query.trim(),value:k.query.trim(),selected:!1};k.options=[re],k.current=re}}}),px=Lm.reducer,{createTextBoxOptions:gx}=Lm.actions,mx=F=>async(G,k)=>{const{rootStateKey:re,type:ue}=F;G((0,Ma.kb)(re,gx((0,Rn.qD)(F))));const ge=(0,xa.dn)(F,k());ge.type==="textbox"&&await Ud.B.get(ue).setValue(ge,ge.options[0],!0)},vx=(F,G)=>async(k,re)=>{const{rootStateKey:ue}=F,ge=(0,xa.dn)(F,re());if(ge.type!=="textbox")return;const Pe=(0,Rn.QT)(G);k((0,Ma.kb)(ue,(0,Go.QP)((0,Rn.qD)(ge,{propName:"query",propValue:Pe})))),await k((0,qa.x7)((0,Rn.jX)(ge),Pe))},yx=()=>({id:"textbox",description:"Define a textbox variable, where users can enter any arbitrary string",name:"Text box",initialState:fx,reducer:px,picker:hx,editor:ux,dependsOn:(F,G)=>!1,setValue:async(F,G,k=!1)=>{await(0,Ba.JD)((0,qa.t9)((0,Rn.jX)(F),G,k))},setValueFromUrl:async(F,G)=>{await(0,Ba.JD)(vx((0,Rn.jX)(F),G))},updateOptions:async F=>{await(0,Ba.JD)(mx((0,Rn.jX)(F)))},getSaveModel:(F,G)=>{const{index:k,id:re,state:ue,global:ge,originalQuery:Pe,rootStateKey:Ae,...We}=(0,J.cloneDeep)(F);if(F.query!==Pe&&!G){const qe=Pe??"",et={selected:!1,text:qe,value:qe};return{...We,query:qe,current:et,options:[et]}}return We},getValueForUrl:F=>F.current.value,beforeAdding:F=>({...(0,J.cloneDeep)(F),originalQuery:F.query})});var xx=e(10378),Vg=e(1749),$g=e(18346),zg=e(62905),_g=e(2495),Bm=e(75816),Um=e(73892);const Ex=(0,ds.TP)("advisor.grafana.app","v0alpha1"),Px=(0,Bm.xP)({reducerPath:"advisorAPIv0alpha1",baseQuery:(0,Um.W)({baseURL:Ex}),endpoints:()=>({})}),bx=["API Discovery","Check","CheckType"],jh=Px.enhanceEndpoints({addTagTypes:bx}).injectEndpoints({endpoints:F=>({getApiResources:F.query({query:()=>({url:"/apis/advisor.grafana.app/v0alpha1/"}),providesTags:["API Discovery"]}),listCheck:F.query({query:G=>({url:"/checks",params:{pretty:G.pretty,allowWatchBookmarks:G.allowWatchBookmarks,continue:G.continue,fieldSelector:G.fieldSelector,labelSelector:G.labelSelector,limit:G.limit,resourceVersion:G.resourceVersion,resourceVersionMatch:G.resourceVersionMatch,sendInitialEvents:G.sendInitialEvents,timeoutSeconds:G.timeoutSeconds,watch:G.watch}}),providesTags:["Check"]}),createCheck:F.mutation({query:G=>({url:"/checks",method:"POST",body:G.check,params:{pretty:G.pretty,dryRun:G.dryRun,fieldManager:G.fieldManager,fieldValidation:G.fieldValidation}}),invalidatesTags:["Check"]}),deletecollectionCheck:F.mutation({query:G=>({url:"/checks",method:"DELETE",params:{pretty:G.pretty,continue:G.continue,dryRun:G.dryRun,fieldSelector:G.fieldSelector,gracePeriodSeconds:G.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:G.ignoreStoreReadErrorWithClusterBreakingPotential,labelSelector:G.labelSelector,limit:G.limit,orphanDependents:G.orphanDependents,propagationPolicy:G.propagationPolicy,resourceVersion:G.resourceVersion,resourceVersionMatch:G.resourceVersionMatch,sendInitialEvents:G.sendInitialEvents,timeoutSeconds:G.timeoutSeconds}}),invalidatesTags:["Check"]}),getCheck:F.query({query:G=>({url:`/checks/${G.name}`,params:{pretty:G.pretty}}),providesTags:["Check"]}),replaceCheck:F.mutation({query:G=>({url:`/checks/${G.name}`,method:"PUT",body:G.check,params:{pretty:G.pretty,dryRun:G.dryRun,fieldManager:G.fieldManager,fieldValidation:G.fieldValidation}}),invalidatesTags:["Check"]}),deleteCheck:F.mutation({query:G=>({url:`/checks/${G.name}`,method:"DELETE",params:{pretty:G.pretty,dryRun:G.dryRun,gracePeriodSeconds:G.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:G.ignoreStoreReadErrorWithClusterBreakingPotential,orphanDependents:G.orphanDependents,propagationPolicy:G.propagationPolicy}}),invalidatesTags:["Check"]}),updateCheck:F.mutation({query:G=>({url:`/checks/${G.name}`,method:"PATCH",body:G.patch,params:{pretty:G.pretty,dryRun:G.dryRun,fieldManager:G.fieldManager,fieldValidation:G.fieldValidation,force:G.force}}),invalidatesTags:["Check"]}),listCheckType:F.query({query:G=>({url:"/checktypes",params:{pretty:G.pretty,allowWatchBookmarks:G.allowWatchBookmarks,continue:G.continue,fieldSelector:G.fieldSelector,labelSelector:G.labelSelector,limit:G.limit,resourceVersion:G.resourceVersion,resourceVersionMatch:G.resourceVersionMatch,sendInitialEvents:G.sendInitialEvents,timeoutSeconds:G.timeoutSeconds,watch:G.watch}}),providesTags:["CheckType"]}),createCheckType:F.mutation({query:G=>({url:"/checktypes",method:"POST",body:G.checkType,params:{pretty:G.pretty,dryRun:G.dryRun,fieldManager:G.fieldManager,fieldValidation:G.fieldValidation}}),invalidatesTags:["CheckType"]}),deletecollectionCheckType:F.mutation({query:G=>({url:"/checktypes",method:"DELETE",params:{pretty:G.pretty,continue:G.continue,dryRun:G.dryRun,fieldSelector:G.fieldSelector,gracePeriodSeconds:G.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:G.ignoreStoreReadErrorWithClusterBreakingPotential,labelSelector:G.labelSelector,limit:G.limit,orphanDependents:G.orphanDependents,propagationPolicy:G.propagationPolicy,resourceVersion:G.resourceVersion,resourceVersionMatch:G.resourceVersionMatch,sendInitialEvents:G.sendInitialEvents,timeoutSeconds:G.timeoutSeconds}}),invalidatesTags:["CheckType"]}),getCheckType:F.query({query:G=>({url:`/checktypes/${G.name}`,params:{pretty:G.pretty}}),providesTags:["CheckType"]}),replaceCheckType:F.mutation({query:G=>({url:`/checktypes/${G.name}`,method:"PUT",body:G.checkType,params:{pretty:G.pretty,dryRun:G.dryRun,fieldManager:G.fieldManager,fieldValidation:G.fieldValidation}}),invalidatesTags:["CheckType"]}),deleteCheckType:F.mutation({query:G=>({url:`/checktypes/${G.name}`,method:"DELETE",params:{pretty:G.pretty,dryRun:G.dryRun,gracePeriodSeconds:G.gracePeriodSeconds,ignoreStoreReadErrorWithClusterBreakingPotential:G.ignoreStoreReadErrorWithClusterBreakingPotential,orphanDependents:G.orphanDependents,propagationPolicy:G.propagationPolicy}}),invalidatesTags:["CheckType"]}),updateCheckType:F.mutation({query:G=>({url:`/checktypes/${G.name}`,method:"PATCH",body:G.patch,params:{pretty:G.pretty,dryRun:G.dryRun,fieldManager:G.fieldManager,fieldValidation:G.fieldValidation,force:G.force}}),invalidatesTags:["CheckType"]})}),overrideExisting:!1}).enhanceEndpoints({endpoints:{updateCheck:F=>{const G=F.query;G&&(F.query=k=>({...G(k),headers:{"Content-Type":"application/json-patch+json"},body:JSON.stringify(k.patch)}))},updateCheckType:F=>{const G=F.query;G&&(F.query=k=>({...G(k),headers:{"Content-Type":"application/json-patch+json"},body:JSON.stringify(k.patch)}))}}}),{useGetCheckQuery:EE,useListCheckQuery:PE,useCreateCheckMutation:bE,useDeleteCheckMutation:DE,useUpdateCheckMutation:CE,useListCheckTypeQuery:TE,useUpdateCheckTypeMutation:ME}=jh;var Gg=e(87161);const Dx=(0,ds.TP)("iam.grafana.app","v0alpha1"),Cx=(0,Bm.xP)({baseQuery:(0,Um.W)({baseURL:Dx}),reducerPath:"iamAPIv0alpha1",endpoints:()=>({})}),Tx=["Display"],Wm=Cx.enhanceEndpoints({addTagTypes:Tx}).injectEndpoints({endpoints:F=>({getDisplayMapping:F.query({query:G=>({url:"/display",params:{key:G.key}}),providesTags:["Display"]})}),overrideExisting:!1}),Hg=Wm.enhanceEndpoints({}),{useGetDisplayMappingQuery:SE}=Wm;var Qg=e(58614),kg=e(33680);const Mx={navBarTree:ku.I_,navIndex:Md._h,appNotifications:Na.g5};var Sx=e(52695),Vi=e(36200),$i=e(11018);const Ox=(0,Ug.combineReducers)({promRules:(0,Vi.Xw)("promRules",$i.mB,({rulesSourceName:F})=>F).reducer,rulerRules:(0,Vi.Xw)("rulerRules",$i.eB,({rulesSourceName:F})=>F).reducer,saveAMConfig:(0,Vi.J7)("saveAMConfig",$i.RW).reducer,deleteAMConfig:(0,Vi.J7)("deleteAMConfig",$i.nO).reducer,amAlertGroups:(0,Vi.Xw)("amAlertGroups",$i.D3,F=>F).reducer,testReceivers:(0,Vi.J7)("testReceivers",$i.bO).reducer,managedAlertStateHistory:(0,Vi.J7)("managedAlertStateHistory",$i.JH).reducer});var Ix=e(2954);const Rx={items:[],searchQuery:"",isLoading:!1},Ax={notificationChannelTypes:[],notificationChannel:{},notifiers:[]};function jx(F,G){const k=Ix.A.getStateDisplayModel(G),re={...F,stateText:k.text,stateIcon:k.iconClass,stateClass:k.stateClass,stateAge:(0,p.KQ)(F.newStateDate).fromNow(!0)};return re.state!=="paused"&&(re.executionError&&(re.info="Execution Error: "+re.executionError),re.evalData&&re.evalData.noData&&(re.info="Query returned no data")),re}const Nm=(0,mo.Z0)({name:"alertRules",initialState:Rx,reducers:{loadAlertRules:F=>({...F,isLoading:!0}),loadedAlertRules:(F,G)=>{const re=G.payload.map(ue=>jx(ue,ue.state));return{...F,items:re,isLoading:!1}},setSearchQuery:(F,G)=>({...F,searchQuery:G.payload})}}),Km=(0,mo.Z0)({name:"notificationChannel",initialState:Ax,reducers:{setNotificationChannels:(F,G)=>({...F,notificationChannelTypes:Nx(G.payload),notifiers:G.payload}),notificationChannelLoaded:(F,G)=>{const k=G.payload,ue=F.notifiers.find(ge=>ge.type===k.type).options.filter(ge=>ge.secure);return ue.length>0&&ue.some(ge=>k.settings[ge.propertyName]!=="")?Wx(F,G.payload,ue):{...F,notificationChannel:k}},resetSecureField:(F,G)=>({...F,notificationChannel:{...F.notificationChannel,secureFields:{...F.notificationChannel.secureFields,[G.payload]:!1}}})}}),{loadAlertRules:IE,loadedAlertRules:RE,setSearchQuery:AE}=Nm.actions,{setNotificationChannels:jE,notificationChannelLoaded:LE,resetSecureField:BE}=Km.actions,Lx=Nm.reducer,Bx=Km.reducer,Ux={alertRules:Lx,notificationChannel:Bx,unifiedAlerting:Ox};function Wx(F,G,k){const re={},ue={};return k.forEach(ge=>{ue[ge.propertyName]=G.settings[ge.propertyName],re[ge.propertyName]=""}),{...F,notificationChannel:{...G,settings:{...G.settings,...re},secureSettings:{...ue}}}}function Nx(F){return F.map(G=>({value:G.type,label:G.name,...G,typeName:G.type})).sort((G,k)=>G.name>k.name?1:-1)}var Kx=e(21875),wx=e(87186),Fx=e(42795),Vx=e(37918),$x=e(18548),zx=e(35231),_x=e(17621),Gx=e(38748),Hx=e(2559),Qx=e(74396),kx=e(89224),Yx=e(54687),Jx=e(69289),Xx=e(91259),Zx=e(69807),qx=e(27104),eE=e(1302),tE=e(20018);const nE={...Mx,...Ux,...qx.Ay,..._x.Ay,...Vx.Ay,...zx.Ay,...$x.Ay,...eE.Ay,...Xx.Ay,...Jx.Ay,...Gx.Ay,...Qx.Ay,...wx.Ay,...Sx.Ay,...Hx.Ay,...Fx.Ay,...kx.Ay,...Ma.Ay,...Zx.Ay,...Kx.Ay,plugins:Yx.Ff,[ns.H.reducerPath]:ns.H.reducer,[Vg.P.reducerPath]:Vg.P.reducer,[zg.Sm.reducerPath]:zg.Sm.reducer,[$g.cU.reducerPath]:$g.cU.reducer,[_g.O5.reducerPath]:_g.O5.reducer,[Hg.reducerPath]:Hg.reducer,[Qg.o3.reducerPath]:Qg.o3.reducer,[Gr.Aj.reducerPath]:Gr.Aj.reducer,[kg.PP.reducerPath]:kg.PP.reducer,[Gg.Z.reducerPath]:Gg.Z.reducer,[jh.reducerPath]:jh.reducer},wm={},UE=F=>{Object.assign(wm,F)},aE=()=>{const F=(0,Ug.combineReducers)({...nE,...wm});return(G,k)=>{if(k.type!==tE.N.type)return F(G,k);const{cleanupAction:re}=k.payload;return re(G),F(G,k)}};function WE(F){addReducer(F)}const sE=(0,mo.Nc)(),Fm=[];function NE(F){Fm.push(F)}function rE(F){const G=(0,mo.U1)({reducer:aE(),middleware:k=>k({thunk:!0,serializableCheck:!1,immutableCheck:!1}).concat(sE.middleware,ns.H.middleware,Vg.P.middleware,zg.Sm.middleware,$g.cU.middleware,_g.O5.middleware,Gr.Aj.middleware,Hg.middleware,Qg.o3.middleware,kg.PP.middleware,Gg.Z.middleware,jh.middleware,...Fm),devTools:!1,preloadedState:{navIndex:(0,Md.s2)(),...F}});return(0,xx.$k)(G.dispatch),(0,Ba.k3)(G),G}const Vm=e(39572),Lh=Vm.keys().map(F=>Vm(F));class oE{async init(){try{await Gm(),window.parent.postMessage("GrafanaAppInit","*");const G=Y.Ay.featureToggles.localeFormatPreference?Y.Ay.regionalFormat:Y.Ay.bootData.user.language,k=(0,d.JL)({language:Y.Ay.bootData.user.language,ns:Ph.dK,module:zm},G);k.then(async({language:et})=>((0,Y._R)({language:et}),(0,d.fl)(Ph.VV,et??h.Nm,[Z._H]))),(0,E.u5)(qg.IB),await cE(),(0,tm.j)("frontend_app_init"),(0,p.xS)(Y.Ay.regionalFormat),(0,p.$D)(Y.Ay.bootData.user.weekStart),(0,V.Y)(R0.m),(0,z.l)(Za),(0,b.N)(bs),(0,w.e)(I0.a),(0,D.T)(C.Ny),(0,P.l)(new Xm),(0,M.p)(h0),(0,c.G)(()=>Y.Ay.bootData.user.timezone),O0(),(0,O.l)(Gn.TP.user),(0,u0.initAuthConfig)(),(0,j.H8)($a.A),await k,iE(),rE(),lE(),d0(),x.D.setInit(us.H),x.G.setInit(us.u),v.h.setInit(Kc),Ud.B.setInit(()=>[ix(),Sy(),yx(),my(),$y(),Qy(),vv(),lx()]),m.l.setInit(wc.A),(0,Qm.f)(),(0,U.HC)(()=>new z0),_v(new zv),(0,U.pC)(jg.BN),(0,W.se)({importPanelPlugin:rm.TV,getPanelPluginFromCache:rm.PY}),Y.Ay.featureToggles.useSessionStorageForRedirection&&dE(),y.I.initialize({config:Y.Ay,getTimeRangeForUrl:(0,Ni.jG)().timeRangeForUrl,getVariablesUrlParams:zy.z}),document.addEventListener("click",km);const re=new cc.xq;re.init(Y.Ay.datasources,Y.Ay.defaultDatasource),(0,B.h)(re),G0();const ue=Y.Ay.featureToggles.rendererDisableAppPluginsPreload&&Gn.TP.user.authenticatedBy==="render";if(Gn.TP.user.orgRole!==""&&!ue){const et=(0,fs.Xs)(),rt=(0,fs.mi)();Ag(rt),await Ag(et)}(0,S.q)(w0),(0,_.A)(U0),(0,K.R)(W0),(0,T.U)(K0),(0,H.C)(sm.m5),(0,Q.h)(sm.zN);const ge=C.Ny.getSearchObject(),Pe=new Vp,Ae=new i0(C.Ny,Pe),We=new qm;We.start(),Pe.setKioskModeFromUrl(ge.kiosk);try{(0,H0.W1)()}catch(et){console.warn("Failed to clean up old expanded folders",et)}this.context={backend:qg.IB,location:C.Ny,chrome:Pe,keybindings:Ae,newAssetsChecker:We,config:Y.Ay},(0,L._)(mr.ni),(0,A._)(Qe.k9),Y.Ay.featureToggles.crashDetection&&Ld(),(0,f.H)(document.getElementById("reactRoot")).render((0,l.createElement)(Ls,{app:this})),await Hm()}catch(G){console.error("Failed to start Grafana",G),window.__grafana_load_failed()}finally{(0,tm.z)("frontend_app_init")}}}function iE(){Lh.length>0&&Lh[0].addExtensionReducers()}function lE(){Lh.length>0&&Lh[0].init()}async function cE(){if((0,N.H2)(new e0({debug:!1})),window.addEventListener("load",F=>{const G="frontend_boot_load_time_seconds";performance&&(performance.mark(G),Fd("first-paint","frontend_boot_","_time_seconds"),Fd("first-contentful-paint","frontend_boot_","_time_seconds"),Fd(G),Fd("frontend_boot_js_done_time_seconds"),Fd("frontend_boot_css_time_seconds"))}),Gn.TP.user.orgRole!==""){const{PerformanceBackend:F}=await e.e(4857).then(e.bind(e,4857));(0,N.pl)(new F({}))}if(Y.Ay.grafanaJavascriptAgent.enabled){const F=[Y.Ay.rudderstackConfigUrl,Y.Ay.rudderstackDataPlaneUrl,Y.Ay.rudderstackIntegrationsUrl].filter(Boolean).map(k=>new RegExp(`${k}.*.`)),{GrafanaJavascriptAgentBackend:G}=await e.e(8826).then(e.bind(e,18826));(0,N.pl)(new G({...Y.Ay.grafanaJavascriptAgent,app:{version:Y.Ay.buildInfo.version,environment:Y.Ay.buildInfo.env},buildInfo:Y.Ay.buildInfo,user:{id:String(Y.Ay.bootData.user?.id),email:Y.Ay.bootData.user?.email},ignoreUrls:F}))}if(Y.Ay.googleAnalyticsId){const{GAEchoBackend:F}=await e.e(9820).then(e.bind(e,59820));(0,N.pl)(new F({googleAnalyticsId:Y.Ay.googleAnalyticsId}))}if(Y.Ay.googleAnalytics4Id){const{GA4EchoBackend:F}=await e.e(7018).then(e.bind(e,47018));(0,N.pl)(new F({googleAnalyticsId:Y.Ay.googleAnalytics4Id,googleAnalytics4SendManualPageViews:Y.Ay.googleAnalytics4SendManualPageViews}))}if(Y.Ay.rudderstackWriteKey&&Y.Ay.rudderstackDataPlaneUrl){const{RudderstackBackend:F}=await e.e(4564).then(e.bind(e,34564));(0,N.pl)(new F({writeKey:Y.Ay.rudderstackWriteKey,dataPlaneUrl:Y.Ay.rudderstackDataPlaneUrl,user:Y.Ay.bootData.user,sdkUrl:Y.Ay.rudderstackSdkUrl,configUrl:Y.Ay.rudderstackConfigUrl,integrationsUrl:Y.Ay.rudderstackIntegrationsUrl,buildInfo:Y.Ay.buildInfo}))}if(Y.Ay.applicationInsightsConnectionString){const{ApplicationInsightsBackend:F}=await e.e(2699).then(e.bind(e,2699));(0,N.pl)(new F({connectionString:Y.Ay.applicationInsightsConnectionString,endpointUrl:Y.Ay.applicationInsightsEndpointUrl}))}if(Y.Ay.analyticsConsoleReporting){const{BrowserConsoleBackend:F}=await e.e(5747).then(e.bind(e,75747));(0,N.pl)(new F)}}function Fd(F,G="",k=""){const re=performance.getEntriesByName(F).at(0);if(re){const ue=re.name.replace(/-/g,"_");(0,t0.n)(`${G}${ue}${k}`,Math.round(re.startTime)/1e3)}}function dE(){const F=C.Ny.getSearch(),G="redirectTo";if(F.has("auth_token")){window.sessionStorage.removeItem(Gn.OG);return}if(F.has(G)&&window.location.pathname!=="/"){const ue=F.get(G);window.sessionStorage.setItem(Gn.OG,encodeURIComponent(ue)),F.delete(G),window.history.replaceState({},"",`${window.location.pathname}${F.size>0?`?${F}`:""}`);return}if(!Gn.TP.user.isSignedIn)return;const k=window.sessionStorage.getItem(Gn.OG);if(!k)return;window.sessionStorage.removeItem(Gn.OG);const re=decodeURIComponent(k);re.startsWith("/goto/")?window.location.replace(re):C.Ny.replace(re)}new oE().init()},84266:(te,R,e)=>{"use strict";e.d(R,{Or:()=>s,Oz:()=>u,RC:()=>a,ho:()=>i,nA:()=>r,uz:()=>n});const n=Symbol("routes_metadata");var a=(o=>(o.Active="active",o.Expired="expired",o.Pending="pending",o))(a||{}),s=(o=>(o.Unprocessed="unprocessed",o.Active="active",o.Suppressed="suppressed",o))(s||{}),i=(o=>(o.equal="=",o.notEqual="!=",o.regex="=~",o.notRegex="!~",o))(i||{}),r=(o=>(o.Internal="internal",o.External="external",o.All="all",o))(r||{}),u=(o=>(o.cortex="cortex",o.mimir="mimir",o.prometheus="prometheus",o))(u||{})},38242:(te,R,e)=>{"use strict";e.d(R,{Dw:()=>u,Rx:()=>s,_M:()=>o,_W:()=>r,d$:()=>a});const n={statistics:[]};var a=(g=>(g[g.Insights=1]="Insights",g[g.Search=0]="Search",g))(a||{}),s=(g=>(g[g.Builder=0]="Builder",g[g.Code=1]="Code",g))(s||{});const i={parameters:[]};var r=(g=>(g.And="and",g.Function="function",g.FunctionParameter="functionParameter",g.GroupBy="groupBy",g.Operator="operator",g.Or="or",g.Property="property",g))(r||{}),u=(g=>(g.String="string",g))(u||{}),o=(g=>(g.CWLI="CWLI",g.PPL="PPL",g.SQL="SQL",g))(o||{});const l={logGroupNames:[],logGroups:[],statsGroups:[]}},51515:(te,R,e)=>{"use strict";e.d(R,{Rx:()=>n.Rx,YZ:()=>a,_M:()=>n._M,b4:()=>s,d$:()=>n.d$});var n=e(38242),a=(i=>(i.Scheduled="Scheduled",i.Running="Running",i.Complete="Complete",i.Failed="Failed",i.Cancelled="Cancelled",i.Timeout="Timeout",i))(a||{}),s=(i=>(i.Regions="regions",i.Namespaces="namespaces",i.Metrics="metrics",i.DimensionKeys="dimensionKeys",i.DimensionValues="dimensionValues",i.EBSVolumeIDs="ebsVolumeIDs",i.EC2InstanceAttributes="ec2InstanceAttributes",i.ResourceArns="resourceARNs",i.Statistics="statistics",i.LogGroups="logGroups",i.Accounts="accounts",i))(s||{})},9931:(te,R,e)=>{"use strict";e.d(R,{K:()=>n});const n="-- Dashboard --",a="dashboard"},73601:(te,R,e)=>{"use strict";e.d(R,{k:()=>l,m:()=>g});var n=e(88483),a=e(739),s=e(28105),i=e(22592),r=e(22429),u=e(82612),o=e(9931);function l(c){return c?typeof c=="string"?c===o.K:"meta"in c&&c.meta.name===o.K||c.uid===o.K:!1}function g(c,x){return new n.c(v=>{const m=(0,r.UA)().getCurrent(),y=f(c.queries);if(!y){v.next(p("Missing panel reference ID"));return}let h=m?.getPanelById(y,!0);if(h instanceof u.a9||(h=new u.a9(h)),!h){v.next(p("Unknown Panel: "+y));return}const d=h.getQueryRunner(),E=d.getData({withTransforms:!!x?.withTransforms,withFieldConfig:!1}).subscribe({next:b=>{x?.topic===a.QR.Annotations&&(b={...b,series:b.annotations??[],annotations:void 0}),v.next(b)}});if(!h.isInView&&h.refreshWhenInView||m?.otherPanelInFullscreen(h)){const{datasource:b,targets:D}=h,C={...c,datasource:b,panelId:y,queries:D};h.refreshWhenInView=!1,d.run(C)}return()=>{E.unsubscribe()}})}function f(c){if(!(!c||!c.length))return c[0].panelId}function p(c){return{state:s.Gu.Error,series:[],request:{},error:{message:c},timeRange:(0,i.E2)()}}},16310:(te,R,e)=>{"use strict";e.d(R,{i:()=>Oe,o:()=>Se});var n=e(2543),a=e(65474),s=e(62467),i=e(44240),r=e(81160),u=e(77154),o=e(28105),l=e(38619),g=e(18700),f=e(88673),p=e(41119),c=e(36580),x=e(2863),v=e(33184),m=e(68143),y=e(78282),h=e(65635),d=e(22429),E=e(74848),b=e(22803),D=e(96540),C=e(63142),P=e(16780),M=e(37386),O=e(18857),j=e(21285),U=e(93732),W=e(78767),B=e(8095),S=e(95093),_=e.n(S),K=e(62717),T=e(25229),L=e(92745),A=e(59310),N=e(45861),V=e(41654),z=e(11527),w=e(63527),H=e(27228),Q=e(44229);const Z=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map((Te,_e)=>({label:Te,value:_e+1})),Y=({value:Te,onChange:_e})=>{const He=(0,C.of)(X),tt=Date.now(),Je=(0,K.QZ)(Te.timezone??"utc",tt),Ge=(0,d.UA)().getCurrent()?.getTimezone()===Te.timezone,[je,Fe]=(0,D.useState)(!1),Be=()=>{Fe(!je)},Ke=Ze=>{if(!Ze)return;const Me=_()();if(Ze){const $e=Ze.split(":");Me.set("hour",parseInt($e[0],10)),Me.set("minute",parseInt($e[1],10))}return Me},Ue=()=>{let Ze="Everyday";return Te.fromDayOfWeek&&!Te.toDayOfWeek&&(Ze=Z[Te.fromDayOfWeek-1].label),Ze},we=()=>{const Ze=(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(H.U,{title:Je?.name}),(0,E.jsx)(Q.X,{timeZone:Te.timezone,timestamp:tt})]});return Ge?(0,E.jsxs)(E.Fragment,{children:["Dashboard timezone (",Ze,")"]}):Ze},Xe=(Ze,Me)=>{const $e=Ze?Ze.format("HH:mm"):void 0;_e(Me==="from"?{...Te,from:$e}:{...Te,to:$e})},nt=Ze=>{_e({...Te,timezone:Ze})},he=Ze=>{_e({...Te,mode:Ze})},xe=Ze=>{_e({...Te,cronExpr:Ze})},me=Ze=>{_e({...Te,duration:Ze})},ye=Ze=>{const Me=Ze?Ze.value:void 0,$e=Ze?Te.toDayOfWeek:void 0;_e({...Te,fromDayOfWeek:Me,toDayOfWeek:$e})},De=Ze=>{_e({...Te,toDayOfWeek:Ze?Ze.value:void 0})},Le=()=>je?(0,E.jsx)(A.U,{value:Te.timezone,includeInternal:!0,onChange:Ze=>nt(Ze),onBlur:()=>Fe(!1),openMenuOnFocus:!1,width:100,autoFocus:!0}):(0,E.jsxs)("div",{className:He.timezoneContainer,children:[(0,E.jsx)("div",{className:He.timezone,children:we()}),(0,E.jsx)(N.$n,{variant:"secondary",onClick:Be,size:"sm",children:"Change timezone"})]}),Ve=Ke(Te.from),ze=Ke(Te.to);return(0,E.jsxs)(P.n,{className:He.wrapper,children:[(0,E.jsx)(M.D,{label:(0,L.t)("dashboard-settings.time-regions.advanced-label","Advanced"),description:(0,E.jsxs)(E.Fragment,{children:[(0,L.t)("dashboard-settings.time-regions.advanced-description-use","Use "),(0,E.jsx)("a",{href:"https://crontab.run/",target:"_blank",children:(0,L.t)("dashboard-settings.time-regions.advanced-description-cron","Cron syntax")}),(0,L.t)("dashboard-settings.time-regions.advanced-description-rest"," to define a recurrence schedule and duration")]}),children:(0,E.jsx)(j.d,{id:"time-regions-adanced-mode-toggle",value:Te.mode==="cron",onChange:Ze=>he(Ze.currentTarget.checked?"cron":null)})}),Te.mode==null&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(M.D,{label:"From",children:(0,E.jsxs)(V.B,{gap:.5,children:[(0,E.jsx)(O.l6,{options:Z,isClearable:!0,placeholder:"Everyday",value:Te.fromDayOfWeek??null,onChange:Ze=>ye(Ze),width:20}),(0,E.jsx)(z.R,{value:(0,T.Ar)(Ve)?Ve:void 0,onChange:Ze=>Xe(Ze&&(0,T.AN)(Ze),"from"),allowEmpty:!0,placeholder:"HH:mm",size:"sm"})]})}),(0,E.jsx)(M.D,{label:"To",children:(0,E.jsxs)(V.B,{gap:.5,children:[(Te.fromDayOfWeek||Te.toDayOfWeek)&&(0,E.jsx)(O.l6,{options:Z,isClearable:!0,placeholder:Ue(),value:Te.toDayOfWeek??null,onChange:Ze=>De(Ze),width:20}),(0,E.jsx)(z.R,{value:(0,T.Ar)(ze)?ze:void 0,onChange:Ze=>Xe(Ze&&(0,T.AN)(Ze),"to"),allowEmpty:!0,placeholder:"HH:mm",size:"sm"})]})})]}),Te.mode==="cron"&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(M.D,{label:"Cron expression",children:(0,E.jsx)(w.p,{onChange:Ze=>xe(Ze.target.value),value:Te.cronExpr,placeholder:"0 9 * * 1-5",width:40})}),(0,E.jsx)(M.D,{label:"Duration",children:(0,E.jsx)(w.p,{onChange:Ze=>me(Ze.target.value),value:Te.duration,placeholder:"8h",width:40})})]}),(0,E.jsx)(M.D,{label:"Timezone",children:Le()})]})},X=Te=>({wrapper:(0,b.css)({maxWidth:Te.spacing(60),marginBottom:Te.spacing(2)}),timezoneContainer:(0,b.css)({padding:"5px",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:"12px"}),timezone:(0,b.css)({marginRight:"5px"})}),I="Enabling this returns annotations that match any of the tags specified below",J=(0,E.jsx)("div",{children:"Specify a list of tags to match. To specify a key and value tag use `key:value` syntax."}),ee=[{label:"Dashboard",value:B.St.Dashboard,description:"Query for events created on this dashboard and show them in the panels where they where created"},{label:"Tags",value:B.St.Tags,description:"This will fetch any annotation events that match the tags filter"}],q=[{label:"Annotations & Alerts",value:B.nj.Annotations,description:"Show annotations or alerts managed by grafana"},{label:"Time regions",value:B.nj.TimeRegions,description:"Configure a repeating time region"}],ne=[10,50,100,200,300,500,1e3,2e3].map(Te=>({label:String(Te),value:Te}));function se({query:Te,onChange:_e}){const He=Te,{limit:tt,matchAny:Je,tags:Ge,type:je,queryType:Fe}=He;let Be=Fe??B.nj.Annotations;const Ke=(0,D.useMemo)(()=>(0,d.UA)().dashboard?.getTimezone(),[]),Ue=(0,C.of)(oe),we=ye=>_e({...He,type:ye.value}),Xe=ye=>_e({...He,limit:ye.value}),nt=ye=>_e({...He,matchAny:ye.target.checked}),he=ye=>_e({...He,tags:ye}),xe=ye=>{const De={...He,queryType:ye.value};De.queryType===B.nj.TimeRegions?De.timeRegion||(De.timeRegion={timezone:Ke}):delete De.timeRegion,_e(De)},me=ye=>{_e({...He,timeRegion:ye})};return(0,E.jsxs)(P.n,{className:Ue.container,children:[(0,E.jsx)(M.D,{label:"Query type",children:(0,E.jsx)(O.l6,{inputId:"grafana-annotations__query-type",options:q,value:Be,onChange:xe})}),Be===B.nj.Annotations&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(M.D,{label:"Filter by",children:(0,E.jsx)(O.l6,{inputId:"grafana-annotations__filter-by",options:ee,value:je,onChange:we})}),(0,E.jsx)(M.D,{label:"Max limit",children:(0,E.jsx)(O.l6,{inputId:"grafana-annotations__limit",width:16,options:ne,value:tt,onChange:Xe})}),je===B.St.Tags&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(M.D,{label:"Match any",description:I,children:(0,E.jsx)(j.d,{id:"grafana-annotations__match-any",value:Je,onChange:nt})}),(0,E.jsx)(M.D,{label:"Tags",description:J,children:(0,E.jsx)(U.$,{allowCustomValue:!0,inputId:"grafana-annotations__tags",onChange:he,tagOptions:W.vy,tags:Ge??[]})})]})]}),Be===B.nj.TimeRegions&&He.timeRegion&&(0,E.jsx)(Y,{value:He.timeRegion,onChange:me})]})}const oe=Te=>({container:(0,b.css)({maxWidth:Te.spacing(60),marginBottom:Te.spacing(2)})});var de=e(95004),fe=e(14465),ae=e(74529);const ce=24*3600;function ie(Te,_e,He,tt,Je,Ge){let je=tt-Te;je<0&&(je+=7);let Fe=_e*3600+He*60,Be=Je*3600+Ge*60,Ke=0;return je===0&&Be<Fe?Ke=7*ce-(Fe-Be):Ke=je*ce-Fe+Be,Ke}function ve(Te,_e,He,tt){if(Te==null&&_e==null)return;const Je={cronExpr:"",duration:0},Ge=Te==null&&He==null,je=Te!=null&&_e==null&&tt==null;_e??="00:00";let[Fe,Be]=_e.split(":").map(nt=>+nt);Je.cronExpr=`${Be} ${Fe} * * ${Te??"*"}`,Te??=1,He??=Te,je&&(tt="00:00",He+=He===7?-6:1),tt??=_e;let[Ke,Ue]=tt.split(":").map(nt=>+nt),we=Fe*3600+Be*60,Xe=Ke*3600+Ue*60;return Ge&&Xe<we&&(He+=He===7?-6:1),Je.duration=ie(Te,Fe,Be,He,Ke,Ue),Je}function le(Te,_e){const He=[];let tt="",Je=0,{fromDayOfWeek:Ge,from:je,toDayOfWeek:Fe,to:Be,duration:Ke=""}=Te;if(Te.mode==="cron")tt=Te.cronExpr??"",Je=(0,ae.WT)((0,ae.E9)(Ke));else{je=je===""?void 0:je,Be=Be===""?void 0:Be;const Ue=ve(Ge,je,Fe,Be);Ue!=null&&(tt=Ue.cronExpr,Je=Ue.duration*1e3)}if(tt==="")return[];try{let Ue=Te.timezone==="browser"?void 0:Te.timezone==="utc"?"Etc/UTC":Te.timezone,we=new fe.l4(tt,{timezone:Ue}),Xe=new Date(_e.from.valueOf()-Je),nt=_e.to.valueOf(),he=we.nextRun(Xe);for(;he!=null;){let xe=+he;if(xe>nt)break;He.push({from:xe,to:xe+Je}),he=we.nextRun(he)}}catch(Ue){console.error(Ue)}return He}function Ee(Te,_e,He){const{mode:tt,duration:Je,cronExpr:Ge,from:je,fromDayOfWeek:Fe}=_e,Be=tt==null&&(Fe!=null||je!=null),Ke=tt==="cron"&&Ge!=null&&Je!=null;if(Be||Ke){const Ue=le(_e,He);if(Ue.length>0)return{fields:[{name:"time",type:de.PU.time,values:Ue.map(Xe=>Xe.from),config:{}},{name:"timeEnd",type:de.PU.time,values:Ue.map(Xe=>Xe.to),config:{}},{name:"text",type:de.PU.string,values:Array(Ue.length).fill(Te),config:{}}],length:Ue.length}}}let Re=100;class Oe extends c.iy{constructor(_e){super(_e),this.annotations={QueryEditor:se,prepareAnnotation(He){return He.target=He.target??{type:He.type??B.St.Dashboard,limit:He.limit??100,tags:He.tags??[],matchAny:He.matchAny??!1},He},prepareQuery(He){let tt;if((0,n.isString)(He.datasource)){const je=(0,h.og)(He.datasource,{returnDefaultAsNull:!1});je&&(tt=je)}else tt=He.datasource;const{filter:Je,...Ge}=He;return{...Ge,refId:He.name,queryType:B.nj.Annotations,datasource:tt}}}}getDefaultQuery(){return{queryType:B.nj.RandomWalk}}query(_e){const He=[],tt=[],Je=(0,x.w)();for(const Ge of _e.targets){if(Ge.queryType===B.nj.Annotations)return(0,a.H)(this.getAnnotations({range:_e.range,rangeRaw:_e.range.raw,annotation:Ge,dashboard:(0,d.UA)().getCurrent()}));if(!Ge.hide){if(Ge.queryType===B.nj.Snapshot){He.push((0,s.of)({data:(Ge.snapshot??[]).map(je=>(0,u.or)(je)),state:o.Gu.Done}));continue}if(Ge.queryType===B.nj.TimeRegions){const je=Ee("",Ge.timeRegion,_e.range);He.push((0,s.of)({data:je?[je]:[],state:o.Gu.Done}));continue}if(Ge.queryType===B.nj.LiveMeasurements){let je=Je.replace(Ge.channel,_e.scopedVars);const{filter:Fe}=Ge,Be=(0,l.DG)(je);if(!(0,l.aj)(Be))continue;const Ke={maxLength:_e.maxDataPoints??500};Ge.buffer?(Ke.maxDelta=Ge.buffer,Ke.maxLength=Ke.maxLength*2):_e.rangeRaw?.to==="now"&&(Ke.maxDelta=_e.range.to.valueOf()-_e.range.from.valueOf()),He.push((0,v.oF)().getDataStream({key:`${_e.requestId}.${Re++}`,addr:Be,filter:Fe,buffer:Ke}))}else Ge.queryType||(Ge.queryType=B.nj.RandomWalk),tt.push(Ge)}}return tt.length&&He.push(super.query({..._e,targets:tt})),He.length?He.length===1?He[0]:(0,i.h)(...He):(0,s.of)()}listFiles(_e,He){return this.query({targets:[{refId:"A",queryType:B.nj.List,path:_e}],maxDataPoints:He}).pipe((0,r.T)(tt=>{const Je=tt.data[0]??new g.k;return new f.R(Je)}))}metricFindQuery(){return Promise.resolve([])}async getAnnotations(_e){const He=_e.annotation.target;if(He?.queryType===B.nj.TimeRegions){const Fe=Ee(_e.annotation.name,He.timeRegion,_e.range);return Promise.resolve({data:Fe?[Fe]:[]})}const tt=_e.annotation,Je=tt.target,Ge={from:_e.range.from.valueOf(),to:_e.range.to.valueOf(),limit:Je.limit,tags:Je.tags,matchAny:Je.matchAny};if(Je.type===B.St.Dashboard){if(!_e.dashboard?.uid)return Promise.resolve({data:[]});Ge.dashboardUID=_e.dashboard.uid,delete Ge.tags}else{if(!Array.isArray(Je.tags)||Je.tags.length===0)return Promise.resolve({data:[]});const Fe=(0,x.w)(),Be="__delimiter__",Ke=[];for(const Ue of Ge.tags){const we=Fe.replace(Ue,{},Xe=>typeof Xe=="string"?Xe:Xe.join(Be));for(const Xe of we.split(Be))Ke.push(Xe)}Ge.tags=Ke}const je=await(0,m.AI)().get("/api/annotations",Ge,`grafana-data-source-annotations-${tt.name}-${_e.dashboard?.uid}`);return{data:[(0,p.Vc)(je)]}}testDatasource(){return Promise.resolve({message:"",status:""})}}async function Se(){return await(0,y.l)().get("-- Grafana --")}},8095:(te,R,e)=>{"use strict";e.d(R,{St:()=>i,dx:()=>s,nj:()=>n,uJ:()=>a});var n=(r=>(r.LiveMeasurements="measurements",r.Annotations="annotations",r.Snapshot="snapshot",r.TimeRegions="timeRegions",r.RandomWalk="randomWalk",r.List="list",r.Read="read",r.Search="search",r.SearchNext="searchNext",r))(n||{});const a={refId:"A",queryType:"randomWalk"},s={refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:"snapshot",snapshot:[]};var i=(r=>(r.Dashboard="dashboard",r.Tags="tags",r))(i||{})},22747:(te,R,e)=>{"use strict";e.d(R,{H:()=>o,j:()=>g});var n=e(77154),a=e(45229),s=e(52161),i=e(4735),r=e(87745),u=e(8095);function o(f,p){return new Promise(c=>{if(f.datasource?.uid===s.vv){l(p,f),c(!0);return}a.A.publish(new r.bY({title:"Change to panel embedded data",text:"If you want to change the data shown in this panel Grafana will need to remove the panels current query and replace it with a snapshot of the current data. This enables you to edit the data.",yesText:"Continue",icon:"pen",onConfirm:()=>{l(p,f),c(!0)},onDismiss:()=>{c(!1)}}))})}function l(f,p){const c=f.map(v=>(0,n.Nw)(v)),x={refId:"A",queryType:u.nj.Snapshot,snapshot:c,datasource:{uid:s.vv}};p.updateQueries({dataSource:{uid:s.vv},queries:[x]}),p.refresh()}function g(f){return(p,c,x)=>{(0,i.v)(p).subscribe(async v=>{const m=[];v.dataFrames.forEach(y=>{const h=(0,n.Nw)(y);m.push(h)}),f({...u.dx,snapshot:m,file:v.file},c)})}}},7795:(te,R,e)=>{"use strict";e.d(R,{Q$:()=>s,U3:()=>a,ti:()=>i});var n=(r=>(r.Builder="builder",r.Code="code",r))(n||{}),a=(r=>(r.Instant="instant",r.Range="range",r.Stream="stream",r))(a||{}),s=(r=>(r.DataSample="dataSample",r.InfiniteScroll="infiniteScroll",r.LogsSample="logsSample",r.LogsVolume="logsVolume",r))(s||{}),i=(r=>(r.Backward="backward",r.Forward="forward",r.Scan="scan",r))(i||{})},77236:(te,R,e)=>{"use strict";e.d(R,{AW:()=>u,Ay:()=>l,RQ:()=>i,dZ:()=>n,fV:()=>r,vB:()=>o});const n=[{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"}],a=[{label:"json",insertText:"json",documentation:"Extracting labels from the log line using json parser."},{label:"regexp",insertText:'regexp ""',documentation:"Extracting labels from the log line using regexp parser.",move:-1},{label:"logfmt",insertText:"logfmt",documentation:"Extracting labels from the log line using logfmt parser."},{label:"pattern",insertText:"pattern",documentation:"Extracting labels from the log line using pattern parser. Only available in Loki 2.3+."},{label:"unpack",insertText:"unpack",detail:"unpack identifier",documentation:'Parses a JSON log line, unpacking all embedded labels in the pack stage. A special property "_entry" will also be used to replace the original log line. Only available in Loki 2.2+.'}],s=[{label:"unwrap",insertText:"unwrap",detail:"unwrap identifier",documentation:"Take labels and use the values as sample data for metric aggregations."},{label:"label_format",insertText:"label_format",documentation:"Use to rename, modify or add labels. For example, | label_format foo=bar ."},{label:"line_format",insertText:"line_format",documentation:'Rewrites log line content. For example, | line_format "{{.query}} {{.duration}}" .'}],i=[{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average of all values in the specified interval."},{insertText:"bytes_over_time",label:"bytes_over_time",detail:"bytes_over_time(range-vector)",documentation:"Counts the amount of bytes used by each log stream for a given range"},{insertText:"bytes_rate",label:"bytes_rate",detail:"bytes_rate(range-vector)",documentation:"Calculates the number of bytes per second for each stream."},{insertText:"first_over_time",label:"first_over_time",detail:"first_over_time(range-vector)",documentation:"The first of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The last of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum of all values in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the number of entries per second."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."}],r=[{insertText:"vector",label:"vector",detail:"vector(scalar)",documentation:"Returns the scalar as a vector with no labels."}],u=[...n,...i,...r],o={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((without|by)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-zA-Z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},"context-pipe":{pattern:/\s\|[^=~]\s?\w*/i,inside:{"pipe-operator":{pattern:/\|/i,alias:"operator"},"pipe-operations":{pattern:new RegExp(`${[...a,...s].map(g=>g.label).join("|")}`,"i"),alias:"keyword"}}},function:new RegExp(`\\b(?:${u.map(g=>g.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=\])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],quote:{pattern:/"(?:\\.|[^\\"])*"/,alias:"string",greedy:!0},backticks:{pattern:/`(?:\\.|[^\\`])*`/,alias:"string",greedy:!0},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:/\s?(\|[=~]?|!=?|<(?:=>?|<|>)?|>[>=]?)\s?/i,punctuation:/[{}(),.]/},l=o},12282:(te,R,e)=>{"use strict";e.d(R,{HD:()=>s,Q$:()=>n.Q$,U3:()=>n.U3,ie:()=>i,ti:()=>n.ti});var n=e(7795),a=(r=>(r.Stream="streams",r.Vector="vector",r.Matrix="matrix",r))(a||{}),s=(r=>(r.Indexed="I",r.StructuredMetadata="S",r.Parsed="P",r))(s||{}),i=(r=>(r[r.LabelNames=0]="LabelNames",r[r.LabelValues=1]="LabelValues",r))(i||{})},18615:(te,R,e)=>{"use strict";e.d(R,{N8:()=>D,bG:()=>E,qM:()=>b,uv:()=>d});var n=e(2543),a=e.n(n),s=e(62467),i=e(65474),r=e(45650),u=e(69862),o=e(81160),l=e(9084),g=e(66847),f=e(93031),p=e(71030),c=e(94644),x=e(28105),v=e(2863),m=e(78282),y=e(97534),h=e(9931);const d="-- Mixed --",E="mixed-",b=(P,M)=>`${E}${P}-${M||""}`;class D extends c.mA{constructor(M){super(M)}query(M){const O=M.targets.filter(W=>W.datasource?.uid!==d);if(!O.length)return(0,s.of)({data:[]});const j=(0,n.groupBy)(O,"datasource.uid"),U=[];for(const W in j)W===h.K?j[W].forEach(B=>{U.push(...this.getBatchesForQueries([B],M))}):U.push(...this.getBatchesForQueries(j[W],M));return U.length?this.batchQueries(U,M):(0,s.of)({data:[]})}getBatchesForQueries(M,O){const j=M[0].datasource,U=[],W=(0,v.w)().replace(j?.uid,O.scopedVars,(B,S)=>{if(!Array.isArray(B))return B;for(const _ of B){if(_==="default")continue;const K=(0,m.l)().getInstanceSettings(_);U.push({datasource:(0,m.l)().get(_),queries:(0,n.cloneDeep)(M),scopedVars:{...O.scopedVars,[S.name]:{value:_,text:K?.name}}})}return""});return W!==""&&U.push({datasource:(0,m.l)().get(W),queries:(0,n.cloneDeep)(M),scopedVars:{...O.scopedVars}}),U}batchQueries(M,O){const j=M.filter(this.isQueryable).map((U,W)=>(0,i.H)(U.datasource).pipe((0,u.Z)(B=>{const S=(0,n.cloneDeep)(O);return S.requestId=b(W,S.requestId),S.targets=U.queries,S.scopedVars=U.scopedVars,(0,i.H)(B.query(S)).pipe((0,o.T)(_=>({..._,data:_.data||[],state:x.Gu.Loading,key:b(W,_.key)})),(0,l.$)(),(0,g.W)(_=>(_=(0,y.u)(_),_.message=`${B.name}: ${_.message}`,(0,s.of)([{data:[],state:x.Gu.Error,error:_,key:b(W,S.requestId)}]))))})));return(0,r.p)(j).pipe(C(),(0,o.T)(this.finalizeResponses),(0,f.U)())}testDatasource(){return Promise.resolve({message:"",status:""})}isQueryable(M){return M&&Array.isArray(M.queries)&&M.queries.length>0}finalizeResponses(M){const{length:O}=M;if(O===0)return M;const j=M.find(U=>U.state===x.Gu.Error);return j?M.push(j):M[O-1].state=x.Gu.Done,M}}function C(){return(0,p.T)((P,M)=>M.reduce((O,j)=>(O.push.apply(O,j),O),P),[])}},25192:(te,R,e)=>{"use strict";e.d(R,{cd:()=>C,xw:()=>m});var n=e(18700),a=e(95004);const s={filters:[],groupBy:[]};var i=(A=>(A.Instant="instant",A.Range="range",A))(i||{}),r=(A=>(A.Done="done",A.Error="error",A.Pending="pending",A.Streaming="streaming",A))(r||{}),u=(A=>(A.Raw="raw",A.Spans="spans",A.Traces="traces",A))(u||{}),o=(A=>(A.Event="event",A.Instrumentation="instrumentation",A.Intrinsic="intrinsic",A.Link="link",A.Resource="resource",A.Span="span",A.Unscoped="unscoped",A))(o||{});function l(A){if(A.stringValue)return A.stringValue;if(A.boolValue!==void 0)return!!A.boolValue;if(A.intValue!==void 0)return Number.parseInt(String(A.intValue),10);if(A.doubleValue)return Number.parseFloat(String(A.doubleValue));if(A.arrayValue){const N=[];for(const V of A.arrayValue.values)N.push(l(V));return N}return""}function g(A){const N=[];let V="OTLPResourceNoServiceName";if(!A)return{serviceName:V,serviceTags:N};for(const z of A.attributes)z.key===SemanticResourceAttributes.SERVICE_NAME&&(V=z.value.stringValue||V),N.push({key:z.key,value:l(z.value)});return{serviceName:V,serviceTags:N}}function f(A){const N=[];if(A.attributes)for(const V of A.attributes)N.push({key:V.key,value:l(V.value)});return N}function p(A){let N;if(A.kind){const V=A.kind.toString().toLowerCase().split("_");N=V.length?V[V.length-1]:A.kind.toString()}return N}function c(A){const N=[];if(A.links)for(const V of A.links){const{traceId:z,spanId:w}=V,H=[];if(V.attributes)for(const Q of V.attributes)H.push({key:Q.key,value:l(Q.value)});N.push({traceID:z,spanID:w,tags:H})}return N}function x(A){const N=[];if(A.events)for(const V of A.events){const z=[];if(V.attributes)for(const w of V.attributes)z.push({key:w.key,value:l(w.value)});N.push({fields:z,timestamp:V.timeUnixNano/1e6,name:V.name})}return N}function v(A,N=!1){const V=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,values:[]},{name:"spanID",type:FieldType.string,values:[]},{name:"parentSpanID",type:FieldType.string,values:[]},{name:"operationName",type:FieldType.string,values:[]},{name:"serviceName",type:FieldType.string,values:[]},{name:"kind",type:FieldType.string,values:[]},{name:"statusCode",type:FieldType.number,values:[]},{name:"statusMessage",type:FieldType.string,values:[]},{name:"instrumentationLibraryName",type:FieldType.string,values:[]},{name:"instrumentationLibraryVersion",type:FieldType.string,values:[]},{name:"traceState",type:FieldType.string,values:[]},{name:"serviceTags",type:FieldType.other,values:[]},{name:"startTime",type:FieldType.number,values:[]},{name:"duration",type:FieldType.number,values:[]},{name:"logs",type:FieldType.other,values:[]},{name:"references",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"otlp"}}});try{for(const w of A){const{serviceName:H,serviceTags:Q}=g(w.resource);for(const Z of w.instrumentationLibrarySpans)for(const Y of Z.spans)V.add({traceID:Y.traceId,spanID:Y.spanId,parentSpanID:Y.parentSpanId||"",operationName:Y.name||"",serviceName:H,kind:p(Y),statusCode:Y.status?.code,statusMessage:Y.status?.message,instrumentationLibraryName:Z.instrumentationLibrary?.name,instrumentationLibraryVersion:Z.instrumentationLibrary?.version,traceState:Y.traceState,serviceTags:Q,startTime:Y.startTimeUnixNano/1e6,duration:(Y.endTimeUnixNano-Y.startTimeUnixNano)/1e6,tags:f(Y),logs:x(Y),references:c(Y)})}}catch(w){return console.error(w),{error:{message:"JSON is not valid OpenTelemetry format: "+w},data:[]}}let z=[V];return N&&z.push(...createNodeGraphFrames(V)),{data:z}}function m(A){let N={batches:[]},V={};for(let z=0;z<A.length;z++){const w=A.get(z);V[w.serviceName]||(V[w.serviceName]=N.batches.length,N.batches.push({resource:{attributes:[],droppedAttributesCount:0},instrumentationLibrarySpans:[{spans:[]}]}));let H=V[w.serviceName];N.batches[H].resource.attributes.length===0&&(N.batches[H].resource.attributes=h(w.serviceTags)),N.batches[H].instrumentationLibrarySpans[0].instrumentationLibrary||w.instrumentationLibraryName&&(N.batches[H].instrumentationLibrarySpans[0].instrumentationLibrary={name:w.instrumentationLibraryName,version:w.instrumentationLibraryVersion?w.instrumentationLibraryVersion:""}),N.batches[H].instrumentationLibrarySpans[0].spans.push({traceId:w.traceID.padStart(32,"0"),spanId:w.spanID,parentSpanId:w.parentSpanID||"",traceState:w.traceState||"",name:w.operationName,kind:y(w.kind),startTimeUnixNano:w.startTime*1e6,endTimeUnixNano:(w.startTime+w.duration)*1e6,attributes:w.tags?h(w.tags):[],droppedAttributesCount:0,droppedEventsCount:0,droppedLinksCount:0,status:E(w),events:b(w.logs),links:D(w.references)})}return N}function y(A){let N;if(A)switch(A){case"server":N="SPAN_KIND_SERVER";break;case"client":N="SPAN_KIND_CLIENT";break;case"producer":N="SPAN_KIND_PRODUCER";break;case"consumer":N="SPAN_KIND_CONSUMER";break;case"internal":N="SPAN_KIND_INTERNAL";break}return N}function h(A){return A.reduce((N,V)=>[...N,{key:V.key,value:d(V)}],[])}function d(A){if(typeof A.value=="string")return{stringValue:A.value};if(typeof A.value=="boolean")return{boolValue:A.value};if(typeof A.value=="number")return A.value%1===0?{intValue:A.value}:{doubleValue:A.value};if(typeof A.value=="object"&&Array.isArray(A.value)){const N=[];for(const V of A.value)N.push(d(V));return{arrayValue:{values:N}}}return{stringValue:A.value}}function E(A){let N;return A.statusCode!==void 0&&(N={code:A.statusCode,message:A.statusMessage?A.statusMessage:""}),N}function b(A){if(!A||!A.length)return;let N=[];for(const V of A){let z={timeUnixNano:V.timestamp*1e6,attributes:[],droppedAttributesCount:0,name:V.name||""};for(const w of V.fields)z.attributes.push({key:w.key,value:d(w)});N.push(z)}return N}function D(A){if(!A||!A.length)return;let N=[];for(const V of A){let z={traceId:V.traceID,spanId:V.spanID,attributes:[],droppedAttributesCount:0};if(V.tags?.length)for(const w of V.tags)z.attributes?.push({key:w.key,value:d(w)});N.push(z)}return N}const C="Related profiles";function P(A,N,V=!1){const z=A.data[0];if(!z)return L;const H=N?.jsonData?.tracesToProfiles;let Q;if(H?.datasourceUid&&(Q=getDataSourceSrv().getInstanceSettings(H.datasourceUid)),H&&Q){const Y=H.customQuery?H.query:void 0,X={title:C,url:"",internal:{datasourceUid:Q.uid,datasourceName:Q.name,query:{labelSelector:Y||"{${__tags}}",groupBy:[],profileTypeId:H.profileTypeId??"",queryType:"profile",spanSelector:['${__span.tags["pyroscope.profile.id"]}'],refId:"profile"}},origin:DataLinkConfigOrigin.Datasource};z.fields.forEach(I=>{I.name==="tags"&&(I.config.links=[X])})}let Z=[...A.data];return V&&Z.push(...createNodeGraphFrames(toDataFrame(z))),{...A,data:Z}}function M(A){return{traceID:A.traceID,startTime:parseInt(A.startTimeUnixNano,10)/1e6,traceDuration:A.durationMs,traceService:A.rootServiceName||"",traceName:A.rootTraceName||""}}function O(A,N){return A.data?.filter(V=>V.name==="exemplar"&&V.meta?.dataTopic==="annotations").map(V=>{const z=V.fields.find(w=>w.name==="traceId");if(z){const w=j(N);z.config.links=z.config.links?.length?[...z.config.links,...w]:w}return V}),A}function j(A){const N=[];return A.uid&&N.push({title:"View trace",url:"",internal:{query:{query:"${__value.raw}",queryType:"traceql"},datasourceUid:A.uid,datasourceName:A?.name??"Data source not found"}}),N}function U(A,N,V){switch(V){case SearchTableType.Spans:return S(A,N);case SearchTableType.Raw:return W(A);default:return B(A,N)}}function W(A){return[createDataFrame({name:"Raw response",refId:"raw",fields:[{name:"response",type:FieldType.string,values:[JSON.stringify(A,null,2)]}]})]}function B(A,N){const V=createDataFrame({name:"Traces",refId:"traces",fields:[{name:"traceID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Trace ID",custom:{width:200},links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:N.uid,datasourceName:N.name,query:{query:"${__value.raw}",queryType:"traceql"}}}]}},{name:"startTime",type:FieldType.time,config:{displayNameFromDS:"Start time",custom:{width:200}}},{name:"traceService",type:FieldType.string,config:{displayNameFromDS:"Service"}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Name"}},{name:"traceDuration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"ms",custom:{width:120}}},{name:"nested",type:FieldType.nestedFrames}],meta:{preferredVisualisationType:"table",uniqueRowIdFields:[0]}});return A?.length?(V.length=A.length,A.sort((z,w)=>parseInt(w?.startTimeUnixNano,10)/1e6-parseInt(z?.startTimeUnixNano,10)/1e6).forEach(z=>{const w=M(z);V.fields[0].values.push(w.traceID),V.fields[1].values.push(w.startTime),V.fields[2].values.push(w.traceService),V.fields[3].values.push(w.traceName),V.fields[4].values.push(w.traceDuration?w.traceDuration:"<1ms"),z.spanSets?V.fields[5].values.push(z.spanSets.map(H=>K(z,H,N))):z.spanSet&&V.fields[5].values.push([K(z,z.spanSet,N)])}),[V]):[V]}function S(A,N){const V={};let z=!1;A?.forEach(H=>_(H).forEach(Q=>{Q.attributes?.forEach(Z=>{V[Z.key]={name:Z.key,type:FieldType.string,config:{displayNameFromDS:Z.key}}}),Q.spans.forEach(Z=>{Z.name&&(z=!0),Z.attributes?.forEach(Y=>{V[Y.key]={name:Y.key,type:FieldType.string,config:{displayNameFromDS:Y.key}}})})}));const w=new MutableDataFrame({name:"Spans",refId:"traces",fields:[{name:"traceIdHidden",type:FieldType.string,config:{custom:{hidden:!0}}},{name:"traceService",type:FieldType.string,config:{displayNameFromDS:"Trace Service",custom:{width:200}}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Trace Name",custom:{width:200}}},{name:"spanID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Span ID",custom:{width:200},links:[{title:"Span: ${__value.raw}",url:"",internal:{datasourceUid:N.uid,datasourceName:N.name,query:{query:"${__data.fields.traceIdHidden}",queryType:"traceql"},panelsState:{trace:{spanId:"${__value.raw}"}}}}]}},{name:"time",type:FieldType.time,config:{displayNameFromDS:"Start time"}},{name:"name",type:FieldType.string,config:{displayNameFromDS:"Name",custom:{hidden:!z}}},...Object.values(V).sort((H,Q)=>H.name.localeCompare(Q.name)),{name:"duration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"ns",custom:{width:120}}}],meta:{preferredVisualisationType:"table"}});return!A||!A.length?[w]:(A.sort((H,Q)=>parseInt(Q?.startTimeUnixNano,10)/1e6-parseInt(H?.startTimeUnixNano,10)/1e6).forEach(H=>{_(H).forEach(Q=>{Q.spans.forEach(Z=>{w.add(T(Z,Q,H))})})}),[w])}const _=A=>A.spanSets||(A.spanSet?[A.spanSet]:[]),K=(A,N,V)=>{const z={};let w=!1;N.attributes?.map(Z=>{z[Z.key]={name:Z.key,type:FieldType.string,config:{displayNameFromDS:Z.key},values:[]}}),N.spans.forEach(Z=>{Z.name&&(w=!0),Z.attributes?.forEach(Y=>{z[Y.key]={name:Y.key,type:FieldType.string,config:{displayNameFromDS:Y.key},values:[]}})});const H=new MutableDataFrame({fields:[{name:"traceIdHidden",type:FieldType.string,config:{custom:{hidden:!0}},values:[]},{name:"spanID",type:FieldType.string,values:[],config:{unit:"string",displayNameFromDS:"Span ID",custom:{width:200},links:[{title:"Span: ${__value.raw}",url:"",internal:{datasourceUid:V.uid,datasourceName:V.name,query:{query:"${__data.fields.traceIdHidden}",queryType:"traceql"},panelsState:{trace:{spanId:"${__value.raw}"}}}}]}},{name:"time",type:FieldType.time,config:{displayNameFromDS:"Start time",custom:{width:200}}},{name:"name",type:FieldType.string,values:[],config:{displayNameFromDS:"Name",custom:{hidden:!w}}},...Object.values(z).sort((Z,Y)=>Z.name.localeCompare(Y.name)),{name:"duration",type:FieldType.number,values:[],config:{displayNameFromDS:"Duration",unit:"ns",custom:{width:120}}}],meta:{preferredVisualisationType:"table"}}),Q=createTheme();for(const Z of H.fields)Z.display=getDisplayProcessor({field:Z,theme:Q});return N.spans.forEach(Z=>{H.add(T(Z,N,A))}),H};function T(A,N,V){const z=parseInt(A.startTimeUnixNano,10)/1e6,w={traceIdHidden:V.traceID,traceService:V.rootServiceName||"",traceName:V.rootTraceName||"",spanID:A.spanID,time:z,duration:parseInt(A.durationNanos,10),name:A.name};let H=[];return N.attributes&&(H=H.concat(N.attributes)),A.attributes&&(H=H.concat(A.attributes)),H.forEach(Q=>{(Q.value.boolValue||Q.value.Value?.bool_value)&&(w[Q.key]=Q.value.boolValue||Q.value.Value?.bool_value),(Q.value.doubleValue||Q.value.Value?.double_value)&&(w[Q.key]=Q.value.doubleValue||Q.value.Value?.double_value),(Q.value.intValue||Q.value.Value?.int_value)&&(w[Q.key]=Q.value.intValue||Q.value.Value?.int_value),(Q.value.stringValue||Q.value.Value?.string_value)&&(w[Q.key]=Q.value.stringValue||Q.value.Value?.string_value)}),w}const L={data:[new n.k({fields:[{name:"trace",type:a.PU.trace,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"otlp"}}})]}},21834:(te,R,e)=>{"use strict";e.d(R,{nE:()=>s,r6:()=>a,xB:()=>n});var n=(i=>(i[i.AlphaAsc=1]="AlphaAsc",i[i.AlphaDesc=2]="AlphaDesc",i[i.Importance=3]="Importance",i[i.TimeAsc=4]="TimeAsc",i[i.TimeDesc=5]="TimeDesc",i))(n||{}),a=(i=>(i.Default="default",i.Custom="custom",i))(a||{}),s=(i=>(i.List="list",i.Stat="stat",i))(s||{})},4598:(te,R,e)=>{"use strict";e.d(R,{d:()=>b,l:()=>D});var n=e(74848),a=e(2543),s=e(96540),i=e(38919),r=e(44232),u=e(739),o=e(98005),l=e(6399),g=e(54735),f=e(33352),p=e(65642),c=e(16515),x=e(95004),v=e(76637),m=e(63142),y=e(4268),h=e(36192);const d=(0,s.memo)(({data:C,placement:P,calcs:M,displayMode:O,...j})=>{const U=(0,m.$j)();let W=[];return(0,c.Fm)(C),C.forEach((B,S)=>{B.fields.forEach((_,K)=>{const T=K+1;if(_.type===x.PU.time||_.config.custom?.hideFrom?.legend)return;const L=_.state?.displayName??_.name,A=(0,v.lz)(_,U).color,N={label:L.toString(),color:A,yAxis:_.config.custom?.axisPlacement===u.vM.Right?2:1,disabled:_.state?.hideFrom?.viz,getDisplayValues:()=>(0,h.UO)(M,_,U),getItemKey:()=>`${L}-${S}-${T}`};W.push(N)})}),(0,n.jsx)(g.KU.Legend,{placement:P,...j,children:(0,n.jsx)(y.t,{placement:P,items:W,displayMode:O,sortBy:j.sortBy,sortDesc:j.sortDesc,isSortable:!0})})});d.displayName="BarGaugeLegend";var E=e(88879);class b extends s.PureComponent{constructor(){super(...arguments),this.renderComponent=(P,M)=>{const{options:O,fieldConfig:j}=this.props,{value:U,alignmentFactors:W,orientation:B,width:S,height:_,count:K}=P,{field:T,display:L,view:A,colIndex:N}=U,{openMenu:V,targetClassName:z}=M,w=this.getItemSpacing(),H=(_+w)*K-w>this.props.height;let Q;return A&&(0,a.isNumber)(N)&&(Q=A.getFieldDisplayProcessor(N)),(0,n.jsx)(o.xE,{value:D(K,j.defaults,L),width:S,height:_,orientation:B,field:T,text:O.text,display:Q,theme:p.$W.theme2,itemSpacing:w,displayMode:O.displayMode,onClick:V,className:z,alignmentFactors:K>1?W:void 0,showUnfilled:O.showUnfilled,valueDisplayMode:O.valueMode,namePlacement:O.namePlacement,isOverflow:H})},this.renderValue=P=>{const{value:M,orientation:O}=P,{hasLinks:j,getLinks:U}=M;return j&&U?(0,n.jsx)("div",{style:{width:"100%",display:O===i.wV.Vertical?"flex":"initial"},children:(0,n.jsx)(l.e,{style:{height:"100%"},links:U,children:W=>this.renderComponent(P,W)})}):this.renderComponent(P,{})},this.getValues=()=>{const{data:P,options:M,replaceVariables:O,fieldConfig:j,timeZone:U}=this.props;return(0,r.PI)({fieldConfig:j,reduceOptions:M.reduceOptions,replaceVariables:O,theme:p.$W.theme2,data:P.series,timeZone:U})}}getItemSpacing(){return this.props.options.displayMode==="lcd"?2:10}getOrientation(){const{options:P,width:M,height:O}=this.props,{orientation:j}=P;return j===i.wV.Auto?M>O?i.wV.Vertical:i.wV.Horizontal:j}calcBarSize(){const{options:P}=this.props,M=this.getOrientation(),O=P.sizing===u.T6.Manual,j=M===i.wV.Vertical,U=M===i.wV.Horizontal,W=O&&j?P.minVizWidth:E.K.minVizWidth,B=O&&U?P.minVizHeight:E.K.minVizHeight,S=O&&U?P.maxVizHeight:E.K.maxVizHeight;return{minVizWidth:W,minVizHeight:B,maxVizHeight:S}}getLegend(){const{options:P,data:M}=this.props,{legend:O}=P;return O.showLegend&&M&&M.series.length>0?(0,n.jsx)(d,{data:M.series,...O}):null}render(){const{height:P,width:M,options:O,data:j,renderCounter:U}=this.props,{minVizWidth:W,minVizHeight:B,maxVizHeight:S}=this.calcBarSize();return(0,n.jsx)(g.KU,{width:M,height:P,legend:this.getLegend(),children:(_,K)=>(0,n.jsx)(f.S,{source:j,getAlignmentFactors:r.XS,getValues:this.getValues,renderValue:this.renderValue,renderCounter:U,width:_,height:K,maxVizHeight:S,minVizWidth:W,minVizHeight:B,itemSpacing:this.getItemSpacing(),orientation:O.orientation})})}}function D(C,P,M){return C===1&&!P.displayName?{...M,title:void 0}:M}},88879:(te,R,e)=>{"use strict";e.d(R,{K:()=>a});var n=e(739);const a={displayMode:n.eX.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:n.TZ.Auto,showUnfilled:!0,sizing:n.T6.Auto,valueMode:n.$l.Color}},71843:(te,R,e)=>{"use strict";e.r(R),e.d(R,{plugin:()=>P});var n=e(16207),a=e(92745),s=e(739),i=e(14099),r=e(87252),u=e(59795);const o=M=>(0,u._$)(M),l=(M,O,j)=>{const U=(0,u.gl)(M,O,j);if(O==="singlestat"&&j.angular){const W=j.angular.gauge;W&&(U.showThresholdMarkers=W.thresholdMarkers,U.showThresholdLabels=W.thresholdLabels)}return U};var g=e(74848),f=e(96540),p=e(11576),c=e(44232),x=e(18627),v=e(6399),m=e(33352),y=e(65642),h=e(4598);const d={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:s.T6.Auto};class E extends f.PureComponent{constructor(){super(...arguments),this.renderComponent=(O,j)=>{const{options:U,fieldConfig:W}=this.props,{width:B,height:S,count:_,value:K}=O,{field:T,display:L}=K,{openMenu:A,targetClassName:N}=j;return(0,g.jsx)(x._,{value:(0,h.l)(_,W.defaults,L),width:B,height:S,field:T,text:U.text,showThresholdLabels:U.showThresholdLabels,showThresholdMarkers:U.showThresholdMarkers,theme:y.$W.theme2,onClick:A,className:N,orientation:U.orientation})},this.renderValue=O=>{const{value:j}=O,{getLinks:U,hasLinks:W}=j;return W&&U?(0,g.jsx)(v.e,{links:U,style:{flexGrow:1},children:B=>this.renderComponent(O,B)}):this.renderComponent(O,{})},this.getValues=()=>{const{data:O,options:j,replaceVariables:U,fieldConfig:W,timeZone:B}=this.props;for(let S of O.series)for(let _ of S.fields)if(_.config.unit==="percent"||_.config.unit==="percentunit"){const K=_.config.min??0,T=_.config.max??(_.config.unit==="percent"?100:1);_.state=_.state??{},_.state.range={min:K,max:T,delta:T-K},_.display=(0,p.J)({field:_,theme:y.$W.theme2})}return(0,c.PI)({fieldConfig:W,reduceOptions:j.reduceOptions,replaceVariables:U,theme:y.$W.theme2,data:O.series,timeZone:B})},this.calculateGaugeSize=()=>{const{options:O}=this.props,j=O.orientation,U=O.sizing===s.T6.Manual,W=j===s.wV.Vertical,B=j===s.wV.Horizontal,S=U&&W?O.minVizWidth:d.minVizWidth,_=U&&B?O.minVizHeight:d.minVizHeight;return{minVizWidth:S,minVizHeight:_}}}render(){const{height:O,width:j,data:U,renderCounter:W,options:B}=this.props,{minVizHeight:S,minVizWidth:_}=this.calculateGaugeSize();return(0,g.jsx)(m.S,{getValues:this.getValues,renderValue:this.renderValue,width:j,height:O,source:U,autoGrid:!0,renderCounter:W,orientation:B.orientation,minVizHeight:S,minVizWidth:_})}}var b=e(33553),D=e(73495);class C{getSuggestionsForData(O){const{dataSummary:j}=O;if(!j.hasData||!j.hasNumberField||j.numberFieldCount>=50)return;const U=O.getListAppender({name:D.m.Gauge,pluginId:"gauge",options:{},fieldConfig:{defaults:{thresholds:{steps:[{value:-1/0,color:"green"},{value:70,color:"orange"},{value:85,color:"red"}],mode:b.O.Percentage},custom:{}},overrides:[]},cardOptions:{previewModifier:W=>{W.options.reduceOptions.values&&(W.options.reduceOptions.limit=2)}}});j.hasStringField&&j.frameCount===1&&j.rowCountTotal<10?(U.append({name:D.m.Gauge,options:{reduceOptions:{values:!0,calcs:[]}}}),U.append({name:D.m.GaugeNoThresholds,options:{reduceOptions:{values:!0,calcs:[]},showThresholdMarkers:!1}})):(U.append({name:D.m.Gauge,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]}}}),U.append({name:D.m.GaugeNoThresholds,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},showThresholdMarkers:!1}}))}}const P=new n.m(E).useFieldConfig({useCustomConfig:M=>{M.addNumberInput({path:"neutral",name:(0,a.t)("gauge.name-neutral","Neutral"),description:(0,a.t)("gauge.description-neutral","Leave empty to use Min as neutral point"),category:[(0,a.t)("gauge.category-gauge","Gauge")],settings:{placeholder:(0,a.t)("gauge.placeholder-neutral","auto")}})}}).setPanelOptions(M=>{const O=[(0,a.t)("gauge.category-gauge","Gauge")];(0,r.L)(M),(0,r.h)(M,O),M.addBooleanSwitch({path:"showThresholdLabels",name:(0,a.t)("gauge.name-show-threshold-labels","Show threshold labels"),description:(0,a.t)("gauge.description-show-threshold-labels","Render the threshold values around the gauge bar"),category:O,defaultValue:d.showThresholdLabels}).addBooleanSwitch({path:"showThresholdMarkers",name:(0,a.t)("gauge.name-show-threshold-markers","Show threshold markers"),description:(0,a.t)("gauge.description-show-threshold-markers","Renders the thresholds as an outer bar"),category:O,defaultValue:d.showThresholdMarkers}).addRadio({path:"sizing",name:(0,a.t)("gauge.name-gauge-size","Gauge size"),settings:{options:[{value:s.T6.Auto,label:(0,a.t)("gauge.gauge-size-options.label-auto","Auto")},{value:s.T6.Manual,label:(0,a.t)("gauge.gauge-size-options.label-manual","Manual")}]},category:O,defaultValue:d.sizing,showIf:j=>j.orientation!==s.wV.Auto}).addSliderInput({path:"minVizWidth",name:(0,a.t)("gauge.name-min-width","Min width"),description:(0,a.t)("gauge.description-min-width","Minimum column width (vertical orientation)"),defaultValue:d.minVizWidth,settings:{min:0,max:600,step:1},category:O,showIf:j=>j.sizing===s.T6.Manual&&j.orientation===s.wV.Vertical}).addSliderInput({path:"minVizHeight",name:(0,a.t)("gauge.name-min-height","Min height"),description:(0,a.t)("gauge.description-min-height","Minimum row height (horizontal orientation)"),defaultValue:d.minVizHeight,category:O,settings:{min:0,max:600,step:1},showIf:j=>j.sizing===s.T6.Manual&&j.orientation===s.wV.Horizontal}),i.I(M)}).setPanelChangeHandler(l).setSuggestionsSupplier(new C).setMigrationHandler(o)},42240:(te,R,e)=>{"use strict";e.d(R,{M:()=>o,x:()=>u});var n=e(74848),a=e(96540),s=e(57866),i=e(92745),r=e(88531);const u=({value:l,context:g,onChange:f})=>{const p=(0,a.useCallback)(c=>{f(c?.length?{id:s.jR.byRefId,options:c}:void 0)},[f]);return(0,n.jsx)(r.XL,{value:l?.options,onChange:p,data:g.data,placeholder:(0,i.t)("geomap.frame-selection-editor.placeholder-change-filter","Change filter")})},o=({value:l,context:g,onChange:f})=>{const p=(0,a.useCallback)(c=>{f(c?.length?{id:s.jR.byRefId,options:(0,r.h)(c)}:void 0)},[f]);return(0,n.jsx)(r.gK,{value:l?.options,onChange:p,data:g.data,placeholder:(0,i.t)("geomap.frame-multi-selection-editor.placeholder-change-filter","Change filter")})}},46831:(te,R,e)=>{"use strict";e.d(R,{K:()=>f});var n=e(74848),a=e(22803),s=e(70255),i=e(63704),r=e(80011),u=e(63142),o=e(21348);function l({width:c,showImage:x,data:v,index:m}){const y=(0,u.of)(p),h=c>600,d=v.get(m),E=encodeURI(d.title);return(0,n.jsxs)("article",{"aria-labelledby":E,className:(0,a.cx)(y.item,h&&y.itemWide),children:[x&&d.ogImage&&(0,n.jsx)("a",{tabIndex:-1,href:i.sQ.sanitizeUrl(d.link),target:"_blank",rel:"noopener noreferrer",className:(0,a.cx)(y.socialImage,h&&y.socialImageWide),"aria-hidden":!0,children:(0,n.jsx)("img",{src:d.ogImage,alt:d.title})}),(0,n.jsxs)("div",{className:y.body,children:[(0,n.jsxs)("time",{className:y.date,dateTime:(0,r.LE)(d.date,{format:"MMM DD"}),children:[(0,r.LE)(d.date,{format:"MMM DD"})," "]}),(0,n.jsx)("a",{className:y.link,href:i.sQ.sanitizeUrl(d.link),target:"_blank",rel:"noopener noreferrer",children:(0,n.jsx)("h3",{className:y.title,id:E,children:d.title})}),(0,n.jsx)("div",{className:y.content,dangerouslySetInnerHTML:{__html:i.sQ.sanitize(d.content)}})]})]})}const g=({width:c,showImage:x,rootProps:v})=>{const m=(0,u.of)(p),y=c>600;return(0,n.jsxs)("div",{className:(0,a.cx)(m.item,y&&m.itemWide),...v,children:[x&&(0,n.jsx)(s.A,{containerClassName:(0,a.cx)(m.socialImage,y&&m.socialImageWide),width:y?"250px":"100%",height:y?"150px":c*.5}),(0,n.jsxs)("div",{className:m.body,children:[(0,n.jsx)(s.A,{containerClassName:m.date,width:60}),(0,n.jsx)(s.A,{containerClassName:m.title,width:250}),(0,n.jsx)(s.A,{containerClassName:m.content,width:"100%",count:6})]})]})},f=(0,o.j)(l,g),p=c=>({container:(0,a.css)({height:"100%"}),item:(0,a.css)({display:"flex",padding:c.spacing(1),position:"relative",marginBottom:c.spacing(.5),marginRight:c.spacing(1),borderBottom:`2px solid ${c.colors.border.weak}`,background:c.colors.background.primary,flexDirection:"column",flexShrink:0}),itemWide:(0,a.css)({flexDirection:"row"}),body:(0,a.css)({display:"flex",flexDirection:"column",flex:1}),socialImage:(0,a.css)({display:"flex",alignItems:"center",marginBottom:c.spacing(1),"> img":{width:"100%",borderRadius:`${c.shape.radius.default} ${c.shape.radius.default} 0 0`}}),socialImageWide:(0,a.css)({marginRight:c.spacing(2),marginBottom:0,"> img":{width:"250px",borderRadius:c.shape.radius.default}}),link:(0,a.css)({color:c.colors.text.link,display:"inline-block","&:hover":{color:c.colors.text.link,textDecoration:"underline"}}),title:(0,a.css)({fontSize:"16px",marginBottom:c.spacing(.5)}),content:(0,a.css)({p:{marginBottom:c.spacing(.5),color:c.colors.text.primary}}),date:(0,a.css)({marginBottom:c.spacing(.5),fontWeight:500,borderRadius:`0 0 0 ${c.shape.radius.default}`,color:c.colors.text.secondary})})},73745:(te,R,e)=>{"use strict";e.d(R,{$:()=>n});const n="https://grafana.com/blog/news.xml"},30054:(te,R,e)=>{"use strict";e.d(R,{n:()=>c});var n=e(41053),a=e(88673);function s(x){const m=new DOMParser().parseFromString(x,"text/xml");return{items:Array.from(m.querySelectorAll("entry")).map(h=>({title:o(h,"title"),link:h.querySelector("link")?.getAttribute("href")??"",content:o(h,"content"),pubDate:o(h,"published"),ogImage:h.querySelector("meta[property='og:image']")?.getAttribute("content")}))}}function i(x){const m=new DOMParser().parseFromString(x,"text/xml");return{items:Array.from(m.querySelectorAll("item")).map(h=>({title:o(h,"title"),link:o(h,"link"),content:o(h,"description"),pubDate:o(h,"pubDate"),ogImage:h.querySelector("meta[property='og:image']")?.getAttribute("content")}))}}async function r(x){return await(await fetch(x)).text()}function u(x){return new DOMParser().parseFromString(x,"text/xml").querySelector("feed")!==null}function o(x,v){return x.querySelector(v)?.textContent??""}async function l(x){const v=await r(x);return u(v)?s(v):i(v)}var g=e(25229),f=e(95004);function p(x){const v=[],m=[],y=[],h=[],d=[];for(const E of x.items){const b=(0,g.KQ)(E.pubDate);try{if(v.push(b.valueOf()),m.push(E.title),y.push(E.link),d.push(E.ogImage),E.content){const D=E.content.replace(/<\/?[^>]+(>|$)/g,"");h.push(D)}}catch(D){console.warn("Error reading news item:",D,E)}}return{fields:[{name:"date",type:f.PU.time,config:{displayName:"Date"},values:v},{name:"title",type:f.PU.string,config:{},values:m},{name:"link",type:f.PU.string,config:{},values:y},{name:"content",type:f.PU.string,config:{},values:h},{name:"ogImage",type:f.PU.string,config:{},values:d}],length:v.length}}function c(x){const[v,m]=(0,n.A)(async()=>{const y=await l(x),h=p(y);return new a.R(h)},[x],{loading:!0});return{state:v,getNews:m}}},87252:(te,R,e)=>{"use strict";e.d(R,{L:()=>o,h:()=>l});var n=e(53543),a=e(46644),s=e(16515),i=e(8934),r=e(92745),u=e(739);function o(g,f=!0){const p=[(0,r.t)("stat.add-standard-data-reduce-options.category-value-options","Value options")];g.addRadio({path:"reduceOptions.values",name:(0,r.t)("stat.add-standard-data-reduce-options.name-show","Show"),description:(0,r.t)("stat.add-standard-data-reduce-options.description-show","Calculate a single value per column or series or show each row"),settings:{options:[{value:!1,label:(0,r.t)("stat.add-standard-data-reduce-options.show-options.label-calculate","Calculate")},{value:!0,label:(0,r.t)("stat.add-standard-data-reduce-options.show-options.label-all-values","All values")}]},category:p,defaultValue:!1}),g.addNumberInput({path:"reduceOptions.limit",name:(0,r.t)("stat.add-standard-data-reduce-options.name-limit","Limit"),description:(0,r.t)("stat.add-standard-data-reduce-options.description-limit","Max number of rows to display"),category:p,settings:{placeholder:"25",integer:!0,min:1,max:5e3},showIf:c=>c.reduceOptions.values===!0}),g.addCustomEditor({id:"reduceOptions.calcs",path:"reduceOptions.calcs",name:(0,r.t)("stat.add-standard-data-reduce-options.name-calculation","Calculation"),description:(0,r.t)("stat.add-standard-data-reduce-options.description-calculation","Choose a reducer function / calculation"),category:p,editor:n.D.get("stats-picker").editor,defaultValue:[a.gy.lastNotNull],showIf:c=>c.reduceOptions.values===!1}),f&&g.addSelect({path:"reduceOptions.fields",name:(0,r.t)("stat.add-standard-data-reduce-options.name-fields","Fields"),description:(0,r.t)("stat.add-standard-data-reduce-options.description-fields","Select the fields that should be included in the panel"),category:p,settings:{allowCustomValue:!0,options:[],getOptions:async c=>{const x=[{value:"",label:(0,r.t)("stat.add-standard-data-reduce-options.fields-options.label-numeric-fields","Numeric Fields")},{value:"/.*/",label:(0,r.t)("stat.add-standard-data-reduce-options.fields-options.label-all-fields","All Fields")}];if(c&&c.data)for(const v of c.data)for(const m of v.fields){const y=(0,s.Ct)(m,v,c.data),h=`/^${(0,i.jD)(y)}$/`;x.push({value:h,label:y})}return Promise.resolve(x)}},defaultValue:""})}function l(g,f){g.addRadio({path:"orientation",name:(0,r.t)("stat.add-orientation-option.name-orientation","Orientation"),description:(0,r.t)("stat.add-orientation-option.description-orientation","Layout orientation"),category:f,settings:{options:[{value:u.wV.Auto,label:(0,r.t)("stat.add-orientation-option.orientation-options.label-auto","Auto")},{value:u.wV.Horizontal,label:(0,r.t)("stat.add-orientation-option.orientation-options.label-horizontal","Horizontal")},{value:u.wV.Vertical,label:(0,r.t)("stat.add-orientation-option.orientation-options.label-vertical","Vertical")}]},defaultValue:u.wV.Auto})}},75663:(te,R,e)=>{"use strict";e.r(R),e.d(R,{plugin:()=>P});var n=e(16207),a=e(92745),s=e(739),i=e(14099),r=e(59795),u=e(64394);const o=(M,O,j)=>{const U=(0,r.gl)(M,O,j);if(j.angular&&(O==="singlestat"||O==="grafana-singlestat-panel")){const W=j.angular;if(U.graphMode=s.$p.None,W.sparkline&&W.sparkline.show&&(U.graphMode=s.$p.Area),W.colorBackground)U.colorMode=s.yp.Background;else if(W.colorValue)U.colorMode=s.yp.Value;else if(U.colorMode=s.yp.None,W.sparkline?.lineColor&&U.graphMode===s.$p.Area){const B=M.fieldConfig??{};B.defaults.color={mode:u.Y.Fixed,fixedColor:W.sparkline.lineColor},M.fieldConfig=B}W.valueName==="name"&&(U.textMode=s.SV.Name)}return U};var l=e(74848),g=e(2543),f=e(96540),p=e(95004),c=e(44232),x=e(60519),v=e(97611),m=e(6399),y=e(33352),h=e(65642);class d extends f.PureComponent{constructor(){super(...arguments),this.renderComponent=(O,j)=>{const{timeRange:U,options:W}=this.props,{value:B,alignmentFactors:S,width:_,height:K,count:T}=O,{openMenu:L,targetClassName:A}=j;let N=B.sparkline;return N&&(N.timeRange=U),(0,l.jsx)(v.yV,{value:B.display,count:T,sparkline:N,colorMode:W.colorMode,graphMode:W.graphMode,justifyMode:W.justifyMode,textMode:this.getTextMode(),alignmentFactors:S,text:W.text,width:_,height:K,theme:h.$W.theme2,onClick:L,className:A,disableWideLayout:!W.wideLayout,percentChangeColorMode:W.percentChangeColorMode})},this.renderValue=O=>{const{value:j}=O,{getLinks:U,hasLinks:W}=j;return W&&U?(0,l.jsx)(m.e,{links:U,children:B=>this.renderComponent(O,B)}):this.renderComponent(O,{})},this.getValues=()=>{const{data:O,options:j,replaceVariables:U,fieldConfig:W,timeZone:B}=this.props;let S;for(let _ of O.series)for(let K of _.fields){let{config:T}=K;if(K.type===p.PU.number){if(K.state?.range)continue;!S&&(!(0,g.isNumber)(T.min)||!(0,g.isNumber)(T.max))&&(S=(0,x.nJ)(O.series));const L=T.min??S.min,A=T.max??S.max;K.state=K.state??{},K.state.range={min:L,max:A,delta:A-L}}}return(0,c.PI)({fieldConfig:W,reduceOptions:j.reduceOptions,replaceVariables:U,theme:h.$W.theme2,data:O.series,sparkline:j.graphMode!==s.$p.None,percentChange:j.showPercentChange,timeZone:B})}}getTextMode(){const{options:O,fieldConfig:j,title:U}=this.props;return O.textMode===s.SV.Auto&&(j.defaults.displayName||!U)?s.SV.ValueAndName:O.textMode}render(){const{height:O,options:j,width:U,data:W,renderCounter:B}=this.props;return(0,l.jsx)(y.S,{getValues:this.getValues,getAlignmentFactors:c.XS,renderValue:this.renderValue,width:U,height:O,source:W,itemSpacing:3,renderCounter:B,autoGrid:!0,orientation:j.orientation})}}var E=e(87252);const b={colorMode:s.yp.Value,graphMode:s.$p.Area,justifyMode:s.F8.Auto,percentChangeColorMode:s.CD.Standard,showPercentChange:!1,textMode:s.SV.Auto,wideLayout:!0};var D=e(73495);class C{getSuggestionsForData(O){const{dataSummary:j}=O;if(!j.hasData)return;const U=O.getListAppender({name:D.m.Stat,pluginId:"stat",options:{},fieldConfig:{defaults:{unit:"short",custom:{}},overrides:[]},cardOptions:{previewModifier:W=>{W.options.reduceOptions.values&&(W.options.reduceOptions.limit=1)}}});j.hasStringField&&j.hasNumberField&&j.frameCount===1&&j.rowCountTotal<10&&(U.append({name:D.m.Stat,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"}}}),U.append({name:D.m.StatColoredBackground,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"},colorMode:s.yp.Background}})),j.stringFieldCount===1&&j.frameCount===1&&j.rowCountTotal<10&&j.fieldCount===1&&U.append({name:D.m.Stat,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"},colorMode:s.yp.None}}),j.hasNumberField&&j.hasTimeField&&(U.append({options:{reduceOptions:{values:!1,calcs:["lastNotNull"]}}}),U.append({name:D.m.StatColoredBackground,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},graphMode:s.$p.None,colorMode:s.yp.Background}}))}}const P=new n.m(d).useFieldConfig().setPanelOptions(M=>{const O=[(0,a.t)("stat.category-stat-styles","Stat styles")];(0,E.L)(M),(0,E.h)(M,O),i.I(M),M.addSelect({path:"textMode",name:(0,a.t)("stat.name-text-mode","Text mode"),description:(0,a.t)("stat.description-text-mode","Control if name and value is displayed or just name"),category:O,settings:{options:[{value:s.SV.Auto,label:(0,a.t)("stat.text-mode-options.label-auto","Auto")},{value:s.SV.Value,label:(0,a.t)("stat.text-mode-options.label-value","Value")},{value:s.SV.ValueAndName,label:(0,a.t)("stat.text-mode-options.label-value-and-name","Value and name")},{value:s.SV.Name,label:(0,a.t)("stat.text-mode-options.label-name","Name")},{value:s.SV.None,label:(0,a.t)("stat.text-mode-options.label-none","None")}]},defaultValue:b.textMode}).addRadio({path:"wideLayout",name:(0,a.t)("stat.name-wide-layout","Wide layout"),category:O,settings:{options:[{value:!0,label:(0,a.t)("stat.wide-layout-options.label-on","On")},{value:!1,label:(0,a.t)("stat.wide-layout-options.label-off","Off")}]},defaultValue:b.wideLayout,showIf:j=>j.textMode===s.SV.ValueAndName}),M.addSelect({path:"colorMode",name:(0,a.t)("stat.name-color-modcolor-mode-options.label","Color mode"),defaultValue:s.yp.Value,category:O,settings:{options:[{value:s.yp.None,label:(0,a.t)("stat.color-mode-options.label-none","None")},{value:s.yp.Value,label:(0,a.t)("stat.color-mode-options.label-value","Value")},{value:s.yp.Background,label:(0,a.t)("stat.color-mode-options.label-background-gradient","Background Gradient")},{value:s.yp.BackgroundSolid,label:(0,a.t)("stat.color-mode-options.label-background-solid","Background Solid")}]}}).addRadio({path:"graphMode",name:(0,a.t)("stat.name-graph-mode","Graph mode"),description:(0,a.t)("stat.description-graph-mode","Stat panel graph / sparkline mode"),category:O,defaultValue:b.graphMode,settings:{options:[{value:s.$p.None,label:(0,a.t)("stat.graph-mode.options.label-none","None")},{value:s.$p.Area,label:(0,a.t)("stat.graph-mode.options.label-area","Area")}]}}).addRadio({path:"justifyMode",name:(0,a.t)("stat.name-text-alignment","Text alignment"),defaultValue:b.justifyMode,category:O,settings:{options:[{value:s.F8.Auto,label:(0,a.t)("stat.text-alignment-options.label-auto","Auto")},{value:s.F8.Center,label:(0,a.t)("stat.text-alignment-options.label-center","Center")}]}}).addBooleanSwitch({path:"showPercentChange",name:(0,a.t)("stat.name-show-percent-change","Show percent change"),defaultValue:b.showPercentChange,category:O,showIf:j=>!j.reduceOptions.values}).addSelect({path:"percentChangeColorMode",name:(0,a.t)("stat.percent-change-color-mode","Percent change color mode"),defaultValue:b.percentChangeColorMode,category:O,settings:{options:[{value:s.CD.Standard,label:(0,a.t)("stat.percent-change-color-mode-options.label-standard","Standard")},{value:s.CD.Inverted,label:(0,a.t)("stat.percent-change-color-mode-options.label-inverted","Inverted")},{value:s.CD.SameAsValue,label:(0,a.t)("stat.percent-change-color-mode-options.label-same-as-value","Same as Value")}]},showIf:j=>j.showPercentChange})}).setNoPadding().setPanelChangeHandler(o).setSuggestionsSupplier(new C).setMigrationHandler(r._$)},17914:(te,R,e)=>{"use strict";e.d(R,{Z:()=>u});var n=e(74848),a=e(92745),s=e(32881),i=e(77824),r=e(44580);const u=({value:o,onChange:l,item:g})=>{const f=[{label:(0,a.t)("timeseries.insert-nulls-editor.disconnect-options.label-never","Never"),value:!1},{label:(0,a.t)("timeseries.insert-nulls-editor.disconnect-options.label-threshold","Threshold"),value:36e5}],p=typeof o=="number";return f[1].value=p?o:36e5,(0,n.jsxs)(s.Gy,{children:[(0,n.jsx)(i.z,{value:o,options:f,onChange:l}),p&&(0,n.jsx)(r.g,{value:o,onChange:l,inputPrefix:r.F.GreaterThan,isTime:g.settings?.isTime??!1})]})}},32471:(te,R,e)=>{"use strict";e.d(R,{F:()=>f});var n=e(74848),a=e(96540),s=e(92745),i=e(32881),r=e(77824),u=e(18857),o=e(76319);const l=["10, 10","10, 15","10, 20","10, 25","10, 30","10, 40","15, 10","20, 10","25, 10","30, 10","40, 10","50, 10","5, 10","30, 3, 3"].map(c=>({label:c,value:c})),g=["0, 10","0, 20","0, 30","0, 40","0, 3, 3"].map(c=>({label:c,value:c})),f=({value:c,onChange:x})=>{const v=[{label:(0,s.t)("timeseries.line-style-editor.line-fill-options.label-solid","Solid"),value:"solid"},{label:(0,s.t)("timeseries.line-style-editor.line-fill-options.label-dash","Dash"),value:"dash"},{label:(0,s.t)("timeseries.line-style-editor.line-fill-options.label-dots","Dots"),value:"dot"}],m=(0,a.useMemo)(()=>c?.fill==="dash"?l:g,[c]),y=(0,a.useMemo)(()=>{if(!c?.dash?.length)return m[0];const h=c.dash?.join(", "),d=m.find(E=>E.value===h);return d||{label:h,value:h}},[c,m]);return(0,n.jsxs)(i.Gy,{children:[(0,n.jsx)(r.z,{value:c?.fill||"solid",options:v,onChange:h=>{let d;h==="dot"?d=p(g[0].value):h==="dash"&&(d=p(l[0].value)),x({...c,fill:h,dash:d})}}),c?.fill&&c?.fill!=="solid"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.l6,{allowCustomValue:!0,options:m,value:y,width:20,onChange:h=>{x({...c,dash:p(h.value??"")})},formatCreateLabel:h=>`Segments: ${p(h).join(", ")}`}),(0,n.jsxs)("div",{children:["\xA0",(0,n.jsx)("a",{title:(0,s.t)("timeseries.line-style-editor.title-the-input-expects-a-segment-list","The input expects a segment list"),href:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setLineDash#Parameters",target:"_blank",rel:"noreferrer",children:(0,n.jsx)(o.K,{name:"question-circle",tooltip:(0,s.t)("timeseries.line-style-editor.tooltip-help","Help")})})]})]})]})};function p(c){const x=[];for(const v of c.split(/(?:,| )+/)){const m=Number.parseInt(v,10);isNaN(m)||x.push(m)}return x}},44580:(te,R,e)=>{"use strict";e.d(R,{F:()=>r,g:()=>u});var n=e(74848),a=e(17548),s=e(92745),i=e(63527),r=(o=>(o.LessThan="lessthan",o.GreaterThan="greaterthan",o))(r||{});const u=({value:o,onChange:l,inputPrefix:g,isTime:f})=>{let p=a.secondsToHms(o/1e3);f||(p="10");const c=y=>{let h=!1;if(y)try{f&&a.isValidTimeSpan(y)?h=a.intervalToMs(y):h=Number(y)}catch(d){console.warn("ERROR",d)}l(h)},x=y=>{y.key==="Enter"&&c(y.currentTarget.value)},v=y=>{c(y.currentTarget.value)},m=g==="greaterthan"?(0,n.jsx)("div",{children:">"}):g==="lessthan"?(0,n.jsx)("div",{children:"<"}):null;return(0,n.jsx)(i.p,{autoFocus:!1,placeholder:(0,s.t)("timeseries.nulls-threshold-input.placeholder-never","Never"),width:10,defaultValue:p,onKeyDown:x,onBlur:v,prefix:m,spellCheck:!1})}},76548:(te,R,e)=>{"use strict";e.d(R,{e:()=>u});var n=e(74848),a=e(92745),s=e(32881),i=e(77824),r=e(44580);const u=({value:o,onChange:l,item:g})=>{const f=[{label:(0,a.t)("timeseries.span-nulls-editor.gaps-options.label-never","Never"),value:!1},{label:(0,a.t)("timeseries.span-nulls-editor.gaps-options.label-always","Always"),value:!0},{label:(0,a.t)("timeseries.span-nulls-editor.gaps-options.label-threshold","Threshold"),value:36e5}],p=typeof o=="number";return f[2].value=p?o:36e5,(0,n.jsxs)(s.Gy,{children:[(0,n.jsx)(i.z,{value:o,options:f,onChange:l}),p&&(0,n.jsx)(r.g,{value:o,onChange:l,inputPrefix:r.F.LessThan,isTime:g.settings?.isTime??!1})]})}},99709:(te,R,e)=>{"use strict";e.d(R,{D:()=>i});var n=e(74848),a=e(96540),s=e(18857);const i=({item:r,value:u,onChange:o,id:l})=>{const g=(0,a.useCallback)(f=>{o({mode:f.value})},[o]);return(0,n.jsx)(s.l6,{inputId:l,value:u.mode,options:r.settings?.options??[],onChange:g})}},12241:(te,R,e)=>{"use strict";e.d(R,{S:()=>m,V:()=>y});var n=e(83340),a=e(64394),s=e(95004),i=e(38809),r=e(92745),u=e(739),o=e(99555),l=e(81082),g=e(44017),f=e(45013),p=e(17914),c=e(32471),x=e(76548),v=e(99709);const m={drawStyle:u.GR.Line,lineInterpolation:u.dx.Linear,lineWidth:1,fillOpacity:0,gradientMode:u.on.None,barAlignment:u.Nj.Center,barWidthFactor:.6,stacking:{mode:u.gs.None,group:"A"},axisGridShow:!0,axisCenteredZero:!1,axisBorderShow:!1};function y(h,d=!0){const E=(0,o.P)(),b=[(0,r.t)("timeseries.config.get-graph-field-config.category-graph-styles","Graph styles")];return{standardOptions:{[n.uo.Color]:{settings:{byValueSupport:!0,bySeriesSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:a.Y.PaletteClassic}},[n.uo.Links]:{settings:{showOneClick:!0}},[n.uo.Actions]:{hideFromDefaults:!1}},useCustomConfig:D=>{D.addRadio({path:"drawStyle",name:(0,r.t)("timeseries.config.get-graph-field-config.name-style","Style"),category:b,defaultValue:h.drawStyle,settings:{options:E.drawStyle}}).addRadio({path:"lineInterpolation",name:(0,r.t)("timeseries.config.get-graph-field-config.name-line-interpolation","Line interpolation"),category:b,defaultValue:h.lineInterpolation,settings:{options:E.lineInterpolation},showIf:C=>C.drawStyle===u.GR.Line}).addRadio({path:"barAlignment",name:(0,r.t)("timeseries.config.get-graph-field-config.name-bar-alignment","Bar alignment"),category:b,defaultValue:h.barAlignment,settings:{options:E.barAlignment},showIf:C=>C.drawStyle===u.GR.Bars}).addSliderInput({path:"barWidthFactor",name:(0,r.t)("timeseries.config.get-graph-field-config.name-bar-width-factor","Bar width factor"),category:b,defaultValue:h.barWidthFactor,settings:{min:.1,max:1,step:.1,ariaLabelForHandle:(0,r.t)("timeseries.config.get-graph-field-config.aria-label-bar-width-factor","Bar width factor")},showIf:C=>C.drawStyle===u.GR.Bars}).addSliderInput({path:"lineWidth",name:(0,r.t)("timeseries.config.get-graph-field-config.name-line-width","Line width"),category:b,defaultValue:h.lineWidth,settings:{min:0,max:10,step:1,ariaLabelForHandle:(0,r.t)("timeseries.config.get-graph-field-config.aria-label-line-width","Line width")},showIf:C=>C.drawStyle!==u.GR.Points}).addSliderInput({path:"fillOpacity",name:(0,r.t)("timeseries.config.get-graph-field-config.name-fill-opacity","Fill opacity"),category:b,defaultValue:h.fillOpacity,settings:{min:0,max:100,step:1,ariaLabelForHandle:(0,r.t)("timeseries.config.get-graph-field-config.aria-label-fill-opacity","Fill opacity")},showIf:C=>C.drawStyle!==u.GR.Points}).addRadio({path:"gradientMode",name:(0,r.t)("timeseries.config.get-graph-field-config.name-gradient-mode","Gradient mode"),category:b,defaultValue:E.fillGradient[0].value,settings:{options:E.fillGradient},showIf:C=>C.drawStyle!==u.GR.Points}).addFieldNamePicker({path:"fillBelowTo",name:(0,r.t)("timeseries.config.get-graph-field-config.name-fill-below-to","Fill below to"),category:b,hideFromDefaults:!0,settings:{filter:C=>C.type===s.PU.number}}).addCustomEditor({id:"lineStyle",path:"lineStyle",name:(0,r.t)("timeseries.config.get-graph-field-config.name-line-style","Line style"),category:b,showIf:C=>C.drawStyle===u.GR.Line,editor:c.F,override:c.F,process:i.hS,shouldApply:C=>C.type===s.PU.number}).addCustomEditor({id:"spanNulls",path:"spanNulls",name:(0,r.t)("timeseries.config.get-graph-field-config.name-connect-nulls","Connect null values"),category:b,defaultValue:!1,editor:x.e,override:x.e,showIf:C=>C.drawStyle===u.GR.Line,shouldApply:C=>C.type!==s.PU.time,process:i.hS,settings:{isTime:d}}).addCustomEditor({id:"insertNulls",path:"insertNulls",name:(0,r.t)("timeseries.config.get-graph-field-config.name-disconnect-values","Disconnect values"),category:b,defaultValue:!1,editor:p.Z,override:p.Z,showIf:C=>C.drawStyle===u.GR.Line,shouldApply:C=>C.type!==s.PU.time,process:i.hS,settings:{isTime:d}}).addRadio({path:"showPoints",name:(0,r.t)("timeseries.config.get-graph-field-config.name-show-points","Show points"),category:b,defaultValue:E.showPoints[0].value,settings:{options:E.showPoints},showIf:C=>C.drawStyle!==u.GR.Points}).addSliderInput({path:"pointSize",name:(0,r.t)("timeseries.config.get-graph-field-config.name-point-size","Point size"),category:b,defaultValue:5,settings:{min:1,max:40,step:1,ariaLabelForHandle:(0,r.t)("timeseries.config.get-graph-field-config.aria-label-point-size","Point size")},showIf:C=>C.showPoints!==u.yL.Never||C.drawStyle===u.GR.Points}),l.I(D,h.stacking,b),D.addSelect({category:b,name:(0,r.t)("timeseries.config.get-graph-field-config.name-transform","Transform"),path:"transform",settings:{options:[{label:(0,r.t)("timeseries.config.get-graph-field-config.transform-options.label-constant","Constant"),value:u.NU.Constant,description:(0,r.t)("timeseries.config.get-graph-field-config.transform-options.description-constant","The first value will be shown as a constant line")},{label:(0,r.t)("timeseries.config.get-graph-field-config.transform-options.label-style","Negative Y"),value:u.NU.NegativeY,description:(0,r.t)("timeseries.config.get-graph-field-config.transform-options.description-style","Flip the results to negative values on the y axis")}],isClearable:!0},hideFromDefaults:!0}),g.rg(D,h),f.e(D),D.addCustomEditor({id:"thresholdsStyle",path:"thresholdsStyle",name:(0,r.t)("timeseries.config.get-graph-field-config.name-show-thresholds","Show thresholds"),category:[(0,r.t)("timeseries.config.get-graph-field-config.category-thresholds","Thresholds")],defaultValue:{mode:u.Ly.Off},settings:{options:E.thresholdsDisplayModes},editor:v.D,override:v.D,process:i.hS,shouldApply:()=>!0})}}}},8535:(te,R,e)=>{"use strict";e.d(R,{Gu:()=>i,JD:()=>r,M_:()=>a,k3:()=>s});var n=e(74887);let a;function s(u){a=u}function i(){return!a||!a.getState?{templating:{...n.L1,lastKey:"key"}}:a.getState()}function r(u){if(!(!a||!a.getState))return a.dispatch(u)}},70590:(te,R,e)=>{"use strict";e.d(R,{RG:()=>a,Xe:()=>n});var n=(i=>(i[i.Admin=4]="Admin",i[i.Member=0]="Member",i))(n||{}),a=(i=>(i.View="View",i.Edit="Edit",i.Admin="Admin",i))(a||{}),s=(i=>(i.Folder="dash-folder",i.Dashboard="dash-db",i))(s||{})},96221:(te,R,e)=>{"use strict";e.d(R,{Qd:()=>n,g2:()=>s});var n=(i=>(i.Success="success",i.Warning="warning",i.Error="error",i.Info="info",i))(n||{}),a=(i=>(i[i.Success=3e3]="Success",i[i.Warning=5e3]="Warning",i[i.Error=7e3]="Error",i))(a||{});const s={success:3e3,warning:5e3,error:7e3,info:3e3}},6262:(te,R,e)=>{"use strict";e.d(R,{U:()=>r,Z4:()=>n,_g:()=>a,d9:()=>s,us:()=>i});var n=(u=>(u.Home="home-dashboard",u.New="new-dashboard",u.Normal="normal-dashboard",u.Provisioning="provisioning-dashboard",u.Scripted="scripted-dashboard",u.Public="public-dashboard",u.Embedded="embedded-dashboard",u.Report="report-dashboard",u))(n||{}),a=(u=>(u.NotStarted="Not started",u.Fetching="Fetching",u.Services="Services",u.Failed="Failed",u.Completed="Completed",u))(a||{}),s=(u=>(u.Full="full",u))(s||{});const i="DASHBOARD_FROM_LS_KEY";function r(u){return"redirectUri"in u}},87745:(te,R,e)=>{"use strict";e.d(R,{Am:()=>P,Bt:()=>y,Cf:()=>f,Eu:()=>O,Io:()=>m,JI:()=>o,PR:()=>l,Q$:()=>g,Rh:()=>d,S8:()=>C,U0:()=>x,VZ:()=>h,Vz:()=>E,XM:()=>c,bG:()=>s,bY:()=>D,i0:()=>B,sL:()=>W,sj:()=>S,xL:()=>v,xc:()=>j,yj:()=>U,zq:()=>u});var n=e(36819),a=e(68388);const s=(0,n.R)("template-variable-value-updated"),i=(0,n.R)("graph-click"),r=(0,n.R)("threshold-changed");class u extends a.a{static{this.type="panel-queries-changed"}}class o extends a.a{static{this.type="panel-transformations-changed"}}class l extends a.a{static{this.type="panels-options-changed"}}class g extends a.a{static{this.type="dashboard-panels-changed"}}class f extends a.a{static{this.type="dashboard-meta-changed"}}class p extends a.a{static{this.type="panel-directive-ready"}}class c extends a.a{static{this.type="render"}}class x extends a.x{static{this.type="zoom-out"}}var v=(_=>(_[_.Left=-1]="Left",_[_.Right=1]="Right",_))(v||{});class m extends a.x{static{this.type="shift-time"}}class y extends a.a{static{this.type="copy-time"}}class h extends a.x{static{this.type="paste-time"}}class d extends a.x{static{this.type="absolute-time"}}class E extends a.x{static{this.type="remove-panel"}}class b extends a.x{static{this.type="show-modal"}}class D extends a.x{static{this.type="show-confirm-modal"}}class C extends a.x{static{this.type="show-react-modal"}}class P extends a.x{static{this.type="open-extension-sidebar"}}class M extends a.a{static{this.type="hide-modal"}}class O extends a.a{static{this.type="dashboard-saved"}}class j extends a.x{static{this.type="annotation-query-started"}}class U extends a.x{static{this.type="annotation-query-finished"}}class W extends a.x{static{this.type="panel-edit-started"}}class B extends a.x{static{this.type="panel-edit-finished"}}class S extends a.x{static{this.type="record-history-entry"}}},72265:(te,R,e)=>{"use strict";e.d(R,{IW:()=>n,aA:()=>s,jH:()=>i,sG:()=>a});var n=(r=>(r[r.CLOSE_PANE=0]="CLOSE_PANE",r[r.CHANGE_DATASOURCE=1]="CHANGE_DATASOURCE",r[r.CLOSE_EDITOR=2]="CLOSE_EDITOR",r))(n||{});const a=["lines","bars","points","stacked_lines","stacked_bars"];var s=(r=>(r.table="table",r.raw="raw",r))(s||{});const i=["table","raw"]},92654:(te,R,e)=>{"use strict";e.d(R,{i:()=>n});var n=(a=>(a.All="All",a.WithExpiredTokens="WithExpiredTokens",a.External="External",a.Disabled="Disabled",a))(n||{})},52763:(te,R,e)=>{"use strict";e.d(R,{ch:()=>u,d4:()=>i,wA:()=>s,zD:()=>r});var n=e(65307),a=e(71468);const s=a.useDispatch,i=a.useSelector,r=(o,l,g)=>(0,n.zD)(o,l,g),u=n.ch},73495:(te,R,e)=>{"use strict";e.d(R,{m:()=>n});var n=(a=>(a.LineChart="Line chart",a.LineChartSmooth="Line chart smooth",a.LineChartGradientColorScheme="Line chart with gradient color scheme",a.AreaChart="Area chart",a.AreaChartStacked="Area chart stacked",a.AreaChartStackedPercent="Area chart 100% stacked",a.BarChart="Bar chart",a.BarChartGradientColorScheme="Bar chart with gradient color scheme",a.BarChartStacked="Bar chart stacked",a.BarChartStackedPercent="Bar chart 100% stacked",a.BarChartHorizontal="Bar chart horizontal",a.BarChartHorizontalStacked="Bar chart horizontal stacked",a.BarChartHorizontalStackedPercent="Bar chart horizontal 100% stacked",a.Candlestick="Candlestick",a.PieChart="Pie chart",a.PieChartDonut="Pie chart donut",a.Stat="Stat",a.StatColoredBackground="Stat colored background",a.Gauge="Gauge",a.GaugeNoThresholds="Gauge no thresholds",a.BarGaugeBasic="Bar gauge basic",a.BarGaugeLCD="Bar gauge LCD",a.Table="Table",a.StateTimeline="State timeline",a.StatusHistory="Status history",a.TextPanel="Text",a.DashboardList="Dashboard list",a.Logs="Logs",a.FlameGraph="Flame graph",a.Trace="Trace",a.NodeGraph="Node graph",a))(n||{})},24619:(te,R,e)=>{"use strict";e.d(R,{$k:()=>u,Gi:()=>a,JS:()=>l,N1:()=>g,Q8:()=>f,Si:()=>s,cF:()=>n,lh:()=>o,qr:()=>r,s1:()=>i});var n=(p=>(p.Firing="firing",p.Inactive="inactive",p.Pending="pending",p.Recovering="recovering",p.Unknown="unknown",p))(n||{}),a=(p=>(p.Normal="Normal",p.Alerting="Alerting",p.Pending="Pending",p.Recovering="Recovering",p.NoData="NoData",p.Error="Error",p))(a||{});function s(p){return Object.values(n).includes(p)}function i(p){return Object.values(a).some(c=>c===p)}function r(p){const c=Object.values(n);return p!=null&&!c.includes(p)}function u(p){const c=p.match(/\((.*?)\)/);return c?c[1]:""}function o(p){return r(p)?p.split(" ")[0]:p}var l=(p=>(p.Alerting="alerting",p.Recording="recording",p))(l||{}),g=(p=>(p.Cortex="Cortex",p.Mimir="Mimir",p.Prometheus="Prometheus",p.Thanos="Thanos",p))(g||{}),f=(p=>(p.Alerting="Alerting",p.NoData="NoData",p.KeepLast="KeepLast",p.OK="OK",p.Error="Error",p))(f||{})},86791:(te,R,e)=>{"use strict";e.d(R,{$7:()=>i,SA:()=>a,l$:()=>r});var n=e(24619);function a(u,o){return(0,n.lh)(u.state)===o}var s=(u=>(u.Firing="firing",u))(s||{}),i=(u=>(u.Alerting="alerting",u.Pending="pending",u.Recovering="recovering",u.Normal="inactive",u.NoData="nodata",u.Error="error",u))(i||{});const r=Symbol("grafana")},82013:()=>{(function(te){var R={crosshair:{mode:null,color:"rgba(170, 0, 0, 0.80)",lineWidth:1}};function e(n){var a={x:-1,y:-1,locked:!1};n.setCrosshair=function(u){if(!u)a.x=-1;else{var o=n.p2c(u);a.x=Math.max(0,Math.min(o.left,n.width())),a.y=Math.max(0,Math.min(o.top,n.height()))}n.triggerRedrawOverlay()},n.clearCrosshair=n.setCrosshair,n.lockCrosshair=function(u){u&&n.setCrosshair(u),a.locked=!0},n.unlockCrosshair=function(){a.locked=!1};function s(r){a.locked||a.x!=-1&&(a.x=-1,n.triggerRedrawOverlay())}function i(r){if(!a.locked){if(n.getSelection&&n.getSelection()){a.x=-1;return}var u=n.offset();a.x=Math.max(0,Math.min(r.pageX-u.left,n.width())),a.y=Math.max(0,Math.min(r.pageY-u.top,n.height())),n.triggerRedrawOverlay()}}n.hooks.bindEvents.push(function(r,u){r.getOptions().crosshair.mode&&(u.mouseout(s),u.mousemove(i))}),n.hooks.drawOverlay.push(function(r,u){var o=r.getOptions().crosshair;if(o.mode){var l=r.getPlotOffset();if(u.save(),u.translate(l.left,l.top),a.x!=-1){var g=r.getOptions().crosshair.lineWidth%2?.5:0;if(u.strokeStyle=o.color,u.lineWidth=o.lineWidth,u.lineJoin="round",u.beginPath(),o.mode.indexOf("x")!=-1){var f=Math.floor(a.x)+g;u.moveTo(f,0),u.lineTo(f,r.height())}if(o.mode.indexOf("y")!=-1){var p=Math.floor(a.y)+g;u.moveTo(0,p),u.lineTo(r.width(),p)}u.stroke()}u.restore()}}),n.hooks.shutdown.push(function(r,u){u.unbind("mouseout",s),u.unbind("mousemove",i)})}te.plot.plugins.push({init:e,options:R,name:"crosshair",version:"1.0"})})(jQuery)},2341:()=>{(function(te){function R(e){e.hooks.processDatapoints.push(function(n,a,s){a.dashes.show&&n.hooks.draw.push(function(i,r){var u=i.getPlotOffset(),o=a.xaxis,l=a.yaxis;function g(x,v){var m=s.points,y=s.pointsize,h=null,d=null,E=0,b=!0,D,C;a.dashes.dashLength[0]?(D=a.dashes.dashLength[0],a.dashes.dashLength[1]?C=a.dashes.dashLength[1]:C=D):C=D=a.dashes.dashLength,r.beginPath();for(var P=y;P<m.length;P+=y){let L=function(A){var N=Math.sqrt(Math.pow(S-W,2)+Math.pow(_-B,2));if(N<=A)return{deltaX:S-W,deltaY:_-B,distance:N,remainder:A-N};var V=S>W?1:-1,z=_>B?1:-1;return{deltaX:V*Math.sqrt(Math.pow(A,2)/(1+Math.pow((_-B)/(S-W),2))),deltaY:z*Math.sqrt(Math.pow(A,2)-Math.pow(A,2)/(1+Math.pow((_-B)/(S-W),2))),distance:A,remainder:0}};var T=L,M=m[P-y],O=m[P-y+1],j=m[P],U=m[P+1];if(!(M==null||j==null)){if(O<=U&&O<l.min){if(U<l.min)continue;M=(l.min-O)/(U-O)*(j-M)+M,O=l.min}else if(U<=O&&U<l.min){if(O<l.min)continue;j=(l.min-O)/(U-O)*(j-M)+M,U=l.min}if(O>=U&&O>l.max){if(U>l.max)continue;M=(l.max-O)/(U-O)*(j-M)+M,O=l.max}else if(U>=O&&U>l.max){if(O>l.max)continue;j=(l.max-O)/(U-O)*(j-M)+M,U=l.max}if(M<=j&&M<o.min){if(j<o.min)continue;O=(o.min-M)/(j-M)*(U-O)+O,M=o.min}else if(j<=M&&j<o.min){if(M<o.min)continue;U=(o.min-M)/(j-M)*(U-O)+O,j=o.min}if(M>=j&&M>o.max){if(j>o.max)continue;O=(o.max-M)/(j-M)*(U-O)+O,M=o.max}else if(j>=M&&j>o.max){if(M>o.max)continue;U=(o.max-M)/(j-M)*(U-O)+O,j=o.max}(M!=h||O!=d)&&r.moveTo(o.p2c(M)+x,l.p2c(O)+v);var W=o.p2c(M)+x,B=l.p2c(O)+v,S=o.p2c(j)+x,_=l.p2c(U)+v,K;do K=L(E>0?E:b?D:C),(K.deltaX!=0||K.deltaY!=0)&&(b?r.lineTo(W+K.deltaX,B+K.deltaY):r.moveTo(W+K.deltaX,B+K.deltaY)),b=!b,E=K.remainder,W+=K.deltaX,B+=K.deltaY;while(K.distance>0);h=j,d=U}}r.stroke()}r.save(),r.translate(u.left,u.top),r.lineJoin="round";var f=a.dashes.lineWidth,p=a.shadowSize;if(f>0&&p>0){r.lineWidth=p,r.strokeStyle="rgba(0,0,0,0.1)";var c=Math.PI/18;g(Math.sin(c)*(f/2+p/2),Math.cos(c)*(f/2+p/2)),r.lineWidth=p/2,g(Math.sin(c)*(f/2+p/4),Math.cos(c)*(f/2+p/4))}r.lineWidth=f,r.strokeStyle=a.color,f>0&&g(0,0),r.restore()})})}te.plot.plugins.push({init:R,options:{series:{dashes:{show:!1,lineWidth:2,dashLength:10}}},name:"dashes",version:"0.1"})})(jQuery)},92275:()=>{(function(te){"use strict";var R={series:{fillBelowTo:null}};function e(n){function a(r,u){var o;for(o=0;o<u.length;++o)if(u[o].id===r.fillBelowTo)return u[o];return null}function s(r,u,o,l,g,f,p,c){var x,v,m,y,h,d;return x=o-r,v=l-u,m=p-g,y=c-f,h=(-v*(r-g)+x*(u-f))/(-m*v+x*y),d=(m*(u-f)-y*(r-g))/(-m*v+x*y),h>=0&&h<=1&&d>=0&&d<=1?[r+d*x,u+d*v]:null}function i(r,u,o){if(o.fillBelowTo===null)return;var l,g,f,p,c,x,v;function m(C,P){u.beginPath(),u.moveTo(o.xaxis.p2c(C)+x.left,o.yaxis.p2c(P)+x.top)}function y(){u.closePath(),u.fill()}function h(){if(f.length/g!==c.length/p)return console.error("Refusing to graph inconsistent number of points"),!1;var C;for(C=0;C<f.length/g;C++)if(f[C*g]!==null&&c[C*p]!==null&&f[C*g]!==c[C*p])return console.error("Refusing to graph points without matching value"),!1;return!0}function d(C,P){console.assert(P>C,"expects the end index to be greater than the start index");var M=C===0||f[C-1]===null||c[C-1]===null,O=!1,j,U;for(j=C;j<P;j++)if(f[j*g+1]===null||c[j*g+1]===null)O=!1,M=!0;else if(f[j*g+1]===c[j*p+1])O=!0,M=!1;else if(f[j*g+1]>c[j*p+1]){M?m(f[j*g],f[j*g+1]):O?m(f[(j-1)*g],f[(j-1)*g+1]):(U=E(j),m(U[0],U[1])),D(j,P);return}else M=!1,O=!1}function E(C){console.assert(C>0,"expects the second point in the series line segment");var P,M;for(P=1;P<c.length/p;P++)if(M=s(f[(C-1)*g],f[(C-1)*g+1],f[C*g],f[C*g+1],c[(P-1)*p],c[(P-1)*p+1],c[P*p],c[P*p+1]),M!==null)return M;console.error("intersectionPoint() should only be called when an intersection happens")}function b(C,P){console.assert(C>=P,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var M;for(M=C;M>=P;M--)u.lineTo(l.xaxis.p2c(c[M*p])+x.left,l.yaxis.p2c(c[M*p+1])+x.top);y()}function D(C,P){console.assert(C<=P,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var M,O;for(M=C;M<P;M++)if(f[M*g+1]===null&&M>C){b(M-1,C),d(M,P);return}else if(f[M*g+1]===c[M*p+1]){b(M,C),d(M,P);return}else if(f[M*g+1]<c[M*p+1]){O=E(M),u.lineTo(o.xaxis.p2c(O[0])+x.left,o.yaxis.p2c(O[1])+x.top),b(M,C),d(M,P);return}else u.lineTo(o.xaxis.p2c(f[M*g])+x.left,o.yaxis.p2c(f[M*g+1])+x.top);b(P,C)}l=a(o,r.getData()),l&&(g=o.datapoints.pointsize,f=o.datapoints.points,p=l.datapoints.pointsize,c=l.datapoints.points,x=r.getPlotOffset(),h()&&(v=te.color.parse(o.color),v.a=.4,v.normalize(),u.fillStyle=v.toString(),d(0,f.length/g)))}n.hooks.drawSeries.push(i)}te.plot.plugins.push({init:e,options:R,name:"fillbelow",version:"0.1.0"})})(jQuery)},19538:()=>{/*!
 * jquery.flot.gauge v1.1.0 *
 *
 * Flot plugin for rendering gauge charts.
 *
 * Copyright (c) 2015 @toyoty99.
 * Licensed under the MIT license.
 */(function(te){var R=function(){var o,l,g,f,p,c,x=function(C,P){o=P,l=C.getPlaceholder(),g=C.getOptions(),f=g.series.gauges,p=C.getData(),c=e(f.debug)};x.prototype.calculateLayout=function(){var C=l.width(),P=l.height(),M=Math.min(p.length,f.layout.columns),O=Math.ceil(p.length/M),j=f.layout.margin,U=f.layout.hMargin,W=f.layout.vMargin,B=(C-j*2-U*(M-1))/M,S=(P-j*2-W*(O-1))/O;if(f.layout.square){var _=Math.min(B,S);B=_,S=_}v(f,B);var K=f.cell.margin,T=0,L=0;f.label.show&&(T=f.label.margin,L=f.label.font.size);var A=0,N=0;f.value.show&&(A=f.value.margin,N=f.value.font.size);var V=0;f.threshold.show&&(V=f.threshold.width);var z=0,w=0;f.threshold.label.show&&(z=f.threshold.label.margin,w=f.threshold.label.font.size);for(var H=B/2-K-V-z*2-w,Q=f.gauge.startAngle,Z=f.gauge.endAngle,Y=(Z-Q)/100,X=-1,I=Q;I<Z;I+=Y)X=Math.max(X,Math.sin(s(I)));X=Math.max(X,Math.sin(s(Z)));var J=(S-K*2-T*2-L)/(1+X);J*X<A+N/2&&(J=S-K*2-T*2-L-A-N/2);var ee=J-z*2-w-V,q=Math.min(H,ee),ne=f.gauge.width;ne>=q&&(ne=Math.max(3,q/3));var se=z*2+w+V+q,oe=Math.max(se*(1+X),se+A+N/2);return{canvasWidth:C,canvasHeight:P,margin:j,hMargin:U,vMargin:W,columns:M,rows:O,cellWidth:B,cellHeight:S,cellMargin:K,labelMargin:T,labelFontSize:L,valueMargin:A,valueFontSize:N,width:ne,radius:q,thresholdWidth:V,thresholdLabelMargin:z,thresholdLabelFontSize:w,gaugeOuterHeight:oe}};function v(C,P){C.gauge.width==="auto"&&(C.gauge.width=Math.max(5,P/8)),C.label.margin==="auto"&&(C.label.margin=Math.max(1,P/20)),C.label.font.size==="auto"&&(C.label.font.size=Math.max(5,P/8)),C.value.margin==="auto"&&(C.value.margin=Math.max(1,P/30)),C.value.font.size==="auto"&&(C.value.font.size=Math.max(5,P/9)),C.threshold.width==="auto"&&(C.threshold.width=Math.max(3,P/100)),C.threshold.label.margin==="auto"&&(C.threshold.label.margin=Math.max(3,P/40)),C.threshold.label.font.size==="auto"&&(C.threshold.label.font.size=Math.max(5,P/15))}x.prototype.calculateAutoValues=v,x.prototype.calculateCellLayout=function(C,P,M){var O=n(P.columns,M),j=a(P.columns,M),U=P.margin+(P.cellWidth+P.hMargin)*O,W=P.margin+(P.cellHeight+P.vMargin)*j,B=U+P.cellWidth/2,S=W+P.cellMargin+P.labelMargin*2+P.labelFontSize+P.thresholdWidth+P.thresholdLabelFontSize+P.thresholdLabelMargin*2+P.radius,_=P.cellHeight-P.cellMargin*2-P.labelMargin*2-P.labelFontSize-P.gaugeOuterHeight,K=0;return C.cell.vAlign==="middle"?K=_/2:C.cell.vAlign==="bottom"&&(K=_),S+=K,{col:O,row:j,x:U,y:W,offsetY:K,cellWidth:P.cellWidth,cellHeight:P.cellHeight,cellMargin:P.cellMargin,cx:B,cy:S}},x.prototype.drawBackground=function(C){f.frame.show&&(o.save(),o.strokeStyle=g.grid.borderColor,o.lineWidth=g.grid.borderWidth,o.strokeRect(0,0,C.canvasWidth,C.canvasHeight),g.grid.backgroundColor&&(o.fillStyle=g.grid.backgroundColor,o.fillRect(0,0,C.canvasWidth,C.canvasHeight)),o.restore())},x.prototype.drawCellBackground=function(C,P){o.save(),C.cell.border&&C.cell.border.show&&C.cell.border.color&&C.cell.border.width&&(o.strokeStyle=C.cell.border.color,o.lineWidth=C.cell.border.width,o.strokeRect(P.x,P.y,P.cellWidth,P.cellHeight)),C.cell.background&&C.cell.background.color&&(o.fillStyle=C.cell.background.color,o.fillRect(P.x,P.y,P.cellWidth,P.cellHeight)),o.restore()},x.prototype.drawGauge=function(C,P,M,O,j){var U=C.gauge.shadow.show?C.gauge.shadow.blur:0,W=h(C,j),B=m(C,P,j);E(M.cx,M.cy,P.radius,P.width,s(C.gauge.startAngle),s(C.gauge.endAngle),C.gauge.border.color,C.gauge.border.width,C.gauge.background.color,U),E(M.cx,M.cy,P.radius-1,P.width-2,s(B.a1),s(B.a2),W,1,W,U),C.gauge.neutralValue!=null&&y(C,P,M,W)};function m(C,P,M){let O={};var j=C.gauge.neutralValue;return j!=null?M<j?(O.a1=d(C,P,M),O.a2=d(C,P,j)):(O.a1=d(C,P,j),O.a2=d(C,P,M)):(O.a1=C.gauge.startAngle,O.a2=d(C,P,M)),O}function y(C,P,M,O){var j=(C.gauge.max-C.gauge.min)/600;i(o,M.cx,M.cy,P.radius-2,P.width-4,s(d(C,P,C.gauge.neutralValue-j)),s(d(C,P,C.gauge.neutralValue+j)),O,2,C.gauge.background.color)}function h(C,P){for(var M,O=0;O<C.threshold.values.length;O++){var j=C.threshold.values[O];if(M=j.color,P<j.value)break}return M}function d(C,P,M){var O=C.gauge.startAngle+(C.gauge.endAngle-C.gauge.startAngle)*((M-C.gauge.min)/(C.gauge.max-C.gauge.min));return O<C.gauge.startAngle?O=C.gauge.startAngle:O>C.gauge.endAngle&&(O=C.gauge.endAngle),O}x.prototype.drawThreshold=function(C,P,M){for(var O=C.gauge.startAngle,j=0;j<C.threshold.values.length;j++){var U=C.threshold.values[j];c1=U.color,a2=d(C,P,U.value),i(o,M.cx,M.cy,P.radius+P.thresholdWidth,P.thresholdWidth-2,s(O),s(a2),c1,1,c1),O=a2}};function E(C,P,M,O,j,U,W,B,S,_){j!==U&&(o.save(),i(o,C,P,M,O,j,U,W,B,S),_&&(i(o,C,P,M,O,j,U),o.clip(),o.shadowOffsetX=0,o.shadowOffsetY=0,o.shadowBlur=10,o.shadowColor="gray",i(o,C,P,M+1,O+2,j,U,W,1)),o.restore())}x.prototype.drawLable=function(C,P,M,O,j){D(M.cx,M.y+M.cellMargin+P.labelMargin+M.offsetY,"flotGaugeLabel"+O,C.label.formatter?C.label.formatter(j.label,j.data[0][1]):text,C.label)},x.prototype.drawValue=function(C,P,M,O,j){D(M.cx,M.cy-C.value.font.size/2,"flotGaugeValue"+O,C.value.formatter?C.value.formatter(j.label,j.data[0][1]):text,C.value)},x.prototype.drawThresholdValues=function(C,P,M,O){b(C,P,M,"Min"+O,C.gauge.min,C.gauge.startAngle),b(C,P,M,"Max"+O,C.gauge.max,C.gauge.endAngle);for(var j=0;j<C.threshold.values.length;j++){var U=C.threshold.values[j];if(U.value>C.gauge.min&&U.value<C.gauge.max){var W=d(C,P,U.value);b(C,P,M,O+"_"+j,U.value,W)}}var B=C.gauge.neutralValue;B!=null&&B>C.gauge.min&&B<C.gauge.max&&b(C,P,M,"Neutral"+O,B,d(C,P,B))};function b(C,P,M,O,j,U){D(M.cx+(P.thresholdLabelMargin+P.thresholdLabelFontSize/2+P.radius)*Math.cos(s(U)),M.cy+(P.thresholdLabelMargin+P.thresholdLabelFontSize/2+P.radius)*Math.sin(s(U)),"flotGaugeThresholdValue"+O,C.threshold.label.formatter?C.threshold.label.formatter(j):j,C.threshold.label,U)}function D(C,P,M,O,j,U){var W=te(l).find("#"+M),B=W.length;B||(W=te("<span></span>"),W.attr("id",M),W.attr("class","flot-temp-elem"),l.append(W)),W.css("position","absolute"),W.css("top",P+"px"),W.css("white-space","nowrap"),j.font.size&&W.css("font-size",j.font.size+"px"),j.font.family&&W.css("font-family",j.font.family),j.color&&W.css("color",j.color),j.background.color&&W.css("background-color",j.background.color),j.background.opacity&&W.css("opacity",j.background.opacity),W.text(O),W.css("left",C+"px"),W.css("left",parseInt(W.css("left"))-W.width()/2+"px"),!B&&U&&(W.css("top",parseInt(W.css("top"))-W.height()/2+"px"),W.css("transform","rotate("+(180*U+90)+"deg)"))}return x}();function e(o){return typeof Logger<"u"?new Logger(o):null}function n(o,l){return l%o}function a(o,l){return Math.floor(l/o)}function s(o){return o*Math.PI}function i(o,l,g,f,p,c,x,v,m,y){if(c!==x){var h=!1;o.save(),o.beginPath(),o.arc(l,g,f,c,x,h),o.lineTo(l+(f-p)*Math.cos(x),g+(f-p)*Math.sin(x)),o.arc(l,g,f-p,x,c,!h),o.closePath(),m&&(o.lineWidth=m),v&&(o.strokeStyle=v,o.stroke()),y&&(o.fillStyle=y,o.fill()),o.restore()}}function r(o){o.hooks.processOptions.push(function(l,g){var f=e(g.series.gauges.debug);g.series.gauges.show&&(g.grid.show=!1,g.legend.show=!1);var p=g.series.gauges.threshold.values;p.sort(function(c,x){return c.value<x.value?-1:c.value>x.value?1:0})}),o.hooks.draw.push(function(l,g){var f=l.getOptions(),p=f.series.gauges,c=e(p.debug);if(p.show){var x=l.getData();if(!(!x||!x.length)){var v=new R(l,g),m=v.calculateLayout();p.debug.layout,v.drawBackground(m);for(var y=0;y<x.length;y++){var h=x[y],d=te.extend({},p,h.gauges);h.gauges&&v.calculateAutoValues(d,m.cellWidth);var E=v.calculateCellLayout(d,m,y);v.drawCellBackground(d,E),d.debug.layout,d.label.show&&v.drawLable(d,m,E,y,h),v.drawGauge(d,m,E,h.label,h.data[0][1]),d.threshold.show&&v.drawThreshold(d,m,E),d.threshold.label.show&&v.drawThresholdValues(d,m,E,y),d.value.show&&v.drawValue(d,m,E,y,h)}}}})}var u={series:{gauges:{debug:{log:!1,layout:!1,alert:!1},show:!1,layout:{margin:5,columns:3,hMargin:5,vMargin:5,square:!1},frame:{show:!0},cell:{background:{color:null},border:{show:!0,color:"black",width:1},margin:5,vAlign:"middle"},gauge:{width:"auto",startAngle:.9,endAngle:2.1,min:0,max:100,background:{color:"white"},border:{color:"lightgray",width:2},shadow:{show:!0,blur:5}},label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(o,l){return o}},value:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(o,l){return parseInt(l)}},threshold:{show:!0,width:"auto",label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:",sans-serif"},color:null,formatter:function(o){return o}},values:[]}}}};te.plot.plugins.push({init:r,options:u,name:"gauge",version:"1.1.0"})})(jQuery)},54087:()=>{(function(te){te.color={},te.color.make=function(e,n,a,s){var i={};return i.r=e||0,i.g=n||0,i.b=a||0,i.a=s??1,i.add=function(r,u){for(var o=0;o<r.length;++o)i[r.charAt(o)]+=u;return i.normalize()},i.scale=function(r,u){for(var o=0;o<r.length;++o)i[r.charAt(o)]*=u;return i.normalize()},i.toString=function(){return i.a>=1?"rgb("+[i.r,i.g,i.b].join(",")+")":"rgba("+[i.r,i.g,i.b,i.a].join(",")+")"},i.normalize=function(){function r(u,o,l){return o<u?u:o>l?l:o}return i.r=r(0,parseInt(i.r),255),i.g=r(0,parseInt(i.g),255),i.b=r(0,parseInt(i.b),255),i.a=r(0,i.a,1),i},i.clone=function(){return te.color.make(i.r,i.b,i.g,i.a)},i.normalize()},te.color.extract=function(e,n){var a;do{if(a=e.css(n).toLowerCase(),a!=""&&a!="transparent")break;e=e.parent()}while(e.length&&!te.nodeName(e.get(0),"body"));return a=="rgba(0, 0, 0, 0)"&&(a="transparent"),te.color.parse(a)},te.color.parse=function(e){var n,a=te.color.make;if(n=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e))return a(parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10));if(n=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return a(parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10),parseFloat(n[4]));if(n=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(e))return a(parseFloat(n[1])*2.55,parseFloat(n[2])*2.55,parseFloat(n[3])*2.55);if(n=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return a(parseFloat(n[1])*2.55,parseFloat(n[2])*2.55,parseFloat(n[3])*2.55,parseFloat(n[4]));if(n=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(e))return a(parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16));if(n=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(e))return a(parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16));var s=te.trim(e).toLowerCase();return s=="transparent"?a(255,255,255,0):(n=R[s]||[0,0,0],a(n[0],n[1],n[2]))};var R={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery),function(te){var R=Object.prototype.hasOwnProperty;te.fn.detach||(te.fn.detach=function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})});function e(s,i){var r=i.children("."+s)[0];if(r==null&&(r=document.createElement("canvas"),r.className=s,te(r).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(i),!r.getContext))if(window.G_vmlCanvasManager)r=window.G_vmlCanvasManager.initElement(r);else throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");this.element=r;var u=this.context=r.getContext("2d"),o=window.devicePixelRatio||1,l=u.webkitBackingStorePixelRatio||u.mozBackingStorePixelRatio||u.msBackingStorePixelRatio||u.oBackingStorePixelRatio||u.backingStorePixelRatio||1;this.pixelRatio=o/l,this.resize(i.width(),i.height()),this.textContainer=null,this.text={},this._textCache={},this._textSizeCache=window.flotTextSizeCache=window.flotTextSizeCache||{}}e.prototype.resize=function(s,i){if(s<=0||i<=0)throw new Error("Invalid dimensions for plot, width = "+s+", height = "+i);var r=this.element,u=this.context,o=this.pixelRatio;this.width!=s&&(r.width=s*o,r.style.width=s+"px",this.width=s),this.height!=i&&(r.height=i*o,r.style.height=i+"px",this.height=i),u.restore(),u.save(),u.scale(o,o)},e.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.prototype.render=function(){var s=this._textCache;for(var i in s)if(R.call(s,i)){var r=this.getTextLayer(i),u=s[i];r.hide();for(var o in u)if(R.call(u,o)){var l=u[o];for(var g in l)if(R.call(l,g)){for(var f=l[g].positions,p=0,c;c=f[p];p++)c.active?c.rendered||(r.append(c.element),c.rendered=!0):(f.splice(p--,1),c.rendered&&c.element.detach());f.length==0&&delete l[g]}}r.show()}},e.prototype.getTextLayer=function(s){var i=this.text[s];return i==null&&(this.textContainer==null&&(this.textContainer=te("<div class='flot-text flot-temp-elem'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),i=this.text[s]=te("<div></div>").addClass(s).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),i},e.prototype.getTextInfo=function(s,i,r,u,o){var l,g,f,p;if(i=""+i,typeof r=="object"?l=r.style+" "+r.variant+" "+r.weight+" "+r.size+"px/"+r.lineHeight+"px "+r.family:l=r,g=this._textCache[s],g==null&&(g=this._textCache[s]={}),f=g[l],f==null&&(f=g[l]={}),p=f[i],p==null){var c=te("<div></div>").html(i).css({position:"absolute","max-width":o,top:-9999}).appendTo(this.getTextLayer(s));typeof r=="object"?c.css({font:l,color:r.color}):typeof r=="string"&&c.addClass(r),p=f[i]={element:c,positions:[]};var x=this._textSizeCache[i];x?(p.width=x.width,p.height=x.height):(p.width=c.outerWidth(!0),p.height=c.outerHeight(!0),this._textSizeCache[i]={width:p.width,height:p.height}),c.detach()}return p},e.prototype.addText=function(s,i,r,u,o,l,g,f,p){var c=this.getTextInfo(s,u,o,l,g),x=c.positions;f=="center"?i-=c.width/2:f=="right"&&(i-=c.width),p=="middle"?r-=c.height/2:p=="bottom"&&(r-=c.height);for(var v=0,m;m=x[v];v++)if(m.x==i&&m.y==r){m.active=!0;return}m={active:!0,rendered:!1,element:x.length?c.element.clone():c.element,x:i,y:r},x.push(m),m.element.css({top:Math.round(r),left:Math.round(i),"text-align":f})},e.prototype.removeText=function(s,i,r,u,o,l){if(u==null){var g=this._textCache[s];if(g!=null){for(var f in g)if(R.call(g,f)){var p=g[f];for(var c in p)if(R.call(p,c))for(var x=p[c].positions,v=0,m;m=x[v];v++)m.active=!1}}}else for(var x=this.getTextInfo(s,u,o,l).positions,v=0,m;m=x[v];v++)m.x==i&&m.y==r&&(m.active=!1)};function n(s,i,r,u){var o=[],l={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,eventSectionHeight:0,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:16.666666666666668},hooks:{}},g=null,f=null,p=null,c=null,x=null,v=[],m=[],y={left:0,right:0,top:0,bottom:0},h=0,d=0,E={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],processRange:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},b=this;b.setData=M,b.setupGrid=Q,b.draw=ee,b.getPlaceholder=function(){return s},b.getCanvas=function(){return g.element},b.getPlotOffset=function(){return y},b.width=function(){return h},b.height=function(){return d},b.offset=function(){var he=p.offset();return he.left+=y.left,he.top+=y.top,he},b.getData=function(){return o},b.getAxes=function(){var he={},xe;return te.each(v.concat(m),function(me,ye){ye&&(he[ye.direction+(ye.n!=1?ye.n:"")+"axis"]=ye)}),he},b.getXAxes=function(){return v},b.getYAxes=function(){return m},b.c2p=W,b.p2c=B,b.getOptions=function(){return l},b.highlight=Be,b.unhighlight=Ke,b.triggerRedrawOverlay=je,b.pointOffset=function(he){return{left:parseInt(v[j(he,"x")-1].p2c(+he.x)+y.left,10),top:parseInt(m[j(he,"y")-1].p2c(+he.y)+y.top,10)}},b.shutdown=A,b.destroy=function(){A(),s.removeData("plot").empty(),o=[],l=null,g=null,f=null,p=null,c=null,x=null,v=[],m=[],E=null,Re=[],b=null},b.resize=function(){var he=s.width(),xe=s.height();g.resize(he,xe),f.resize(he,xe)},b.hooks=E,C(b),P(r),T(),M(i),Q(),ee(),L();function D(he,xe){xe=[b].concat(xe);for(var me=0;me<he.length;++me)he[me].apply(this,xe)}function C(){for(var he={Canvas:e},xe=0;xe<u.length;++xe){var me=u[xe];me.init(b,he),me.options&&te.extend(!0,l,me.options)}}function P(he){te.extend(!0,l,he),he&&he.colors&&(l.colors=he.colors),l.xaxis.color==null&&(l.xaxis.color=te.color.parse(l.grid.color).scale("a",.22).toString()),l.yaxis.color==null&&(l.yaxis.color=te.color.parse(l.grid.color).scale("a",.22).toString()),l.xaxis.tickColor==null&&(l.xaxis.tickColor=l.grid.tickColor||l.xaxis.color),l.yaxis.tickColor==null&&(l.yaxis.tickColor=l.grid.tickColor||l.yaxis.color),l.grid.borderColor==null&&(l.grid.borderColor=l.grid.color),l.grid.tickColor==null&&(l.grid.tickColor=te.color.parse(l.grid.color).scale("a",.22).toString());var xe,me,ye,De=s.css("font-size"),Le=De?+De.replace("px",""):13,Ve={style:s.css("font-style"),size:Math.round(.8*Le),variant:s.css("font-variant"),weight:s.css("font-weight"),family:s.css("font-family")};for(ye=l.xaxes.length||1,xe=0;xe<ye;++xe)me=l.xaxes[xe],me&&!me.tickColor&&(me.tickColor=me.color),me=te.extend(!0,{},l.xaxis,me),l.xaxes[xe]=me,me.font&&(me.font=te.extend({},Ve,me.font),me.font.color||(me.font.color=me.color),me.font.lineHeight||(me.font.lineHeight=Math.round(me.font.size*1.15)));for(ye=l.yaxes.length||1,xe=0;xe<ye;++xe)me=l.yaxes[xe],me&&!me.tickColor&&(me.tickColor=me.color),me=te.extend(!0,{},l.yaxis,me),l.yaxes[xe]=me,me.font&&(me.font=te.extend({},Ve,me.font),me.font.color||(me.font.color=me.color),me.font.lineHeight||(me.font.lineHeight=Math.round(me.font.size*1.15)));for(l.xaxis.noTicks&&l.xaxis.ticks==null&&(l.xaxis.ticks=l.xaxis.noTicks),l.yaxis.noTicks&&l.yaxis.ticks==null&&(l.yaxis.ticks=l.yaxis.noTicks),l.x2axis&&(l.xaxes[1]=te.extend(!0,{},l.xaxis,l.x2axis),l.xaxes[1].position="top",l.x2axis.min==null&&(l.xaxes[1].min=null),l.x2axis.max==null&&(l.xaxes[1].max=null)),l.y2axis&&(l.yaxes[1]=te.extend(!0,{},l.yaxis,l.y2axis),l.yaxes[1].position="right",l.y2axis.min==null&&(l.yaxes[1].min=null),l.y2axis.max==null&&(l.yaxes[1].max=null)),l.grid.coloredAreas&&(l.grid.markings=l.grid.coloredAreas),l.grid.coloredAreasColor&&(l.grid.markingsColor=l.grid.coloredAreasColor),l.lines&&te.extend(!0,l.series.lines,l.lines),l.points&&te.extend(!0,l.series.points,l.points),l.bars&&te.extend(!0,l.series.bars,l.bars),l.shadowSize!=null&&(l.series.shadowSize=l.shadowSize),l.highlightColor!=null&&(l.series.highlightColor=l.highlightColor),xe=0;xe<l.xaxes.length;++xe)S(v,xe+1).options=l.xaxes[xe];for(xe=0;xe<l.yaxes.length;++xe)S(m,xe+1).options=l.yaxes[xe];for(var ze in E)l.hooks[ze]&&l.hooks[ze].length&&(E[ze]=E[ze].concat(l.hooks[ze]));D(E.processOptions,[l])}function M(he){o=O(he),_(),K()}function O(he){for(var xe=[],me=0;me<he.length;++me){var ye=te.extend(!0,{},l.series);he[me].data!=null?(ye.data=he[me].data,delete he[me].data,te.extend(!0,ye,he[me]),he[me].data=ye.data):ye.data=he[me],xe.push(ye)}return xe}function j(he,xe){var me=he[xe+"axis"];return typeof me=="object"&&(me=me.n),typeof me!="number"&&(me=1),me}function U(){return te.grep(v.concat(m),function(he){return he})}function W(he){var xe={},me,ye;for(me=0;me<v.length;++me)ye=v[me],ye&&(xe["x"+ye.n]=ye.c2p(he.left));for(me=0;me<m.length;++me)ye=m[me],ye&&(xe["y"+ye.n]=ye.c2p(he.top));return xe.x1!==void 0&&(xe.x=xe.x1),xe.y1!==void 0&&(xe.y=xe.y1),xe}function B(he){var xe={},me,ye,De;for(me=0;me<v.length;++me)if(ye=v[me],ye&&ye.used&&(De="x"+ye.n,he[De]==null&&ye.n==1&&(De="x"),he[De]!=null)){xe.left=ye.p2c(he[De]);break}for(me=0;me<m.length;++me)if(ye=m[me],ye&&ye.used&&(De="y"+ye.n,he[De]==null&&ye.n==1&&(De="y"),he[De]!=null)){xe.top=ye.p2c(he[De]);break}return xe}function S(he,xe){return he[xe-1]||(he[xe-1]={n:xe,direction:he==v?"x":"y",options:te.extend(!0,{},he==v?l.xaxis:l.yaxis)}),he[xe-1]}function _(){var he=o.length,xe=-1,me;for(me=0;me<o.length;++me){var ye=o[me].color;ye!=null&&(he--,typeof ye=="number"&&ye>xe&&(xe=ye))}he<=xe&&(he=xe+1);var De,Le=[],Ve=l.colors,ze=Ve.length,Ze=0;for(me=0;me<he;me++)De=te.color.parse(Ve[me%ze]||"#666"),me%ze==0&&me&&(Ze>=0?Ze<.5?Ze=-Ze-.2:Ze=0:Ze=-Ze),Le[me]=De.scale("rgb",1+Ze);var Me=0,$e;for(me=0;me<o.length;++me){if($e=o[me],$e.color==null?($e.color=Le[Me].toString(),++Me):typeof $e.color=="number"&&($e.color=Le[$e.color].toString()),$e.lines.show==null){var at,ct=!0;for(at in $e)if($e[at]&&$e[at].show){ct=!1;break}ct&&($e.lines.show=!0)}$e.lines.zero==null&&($e.lines.zero=!!$e.lines.fill),$e.xaxis=S(v,j($e,"x")),$e.yaxis=S(m,j($e,"y"))}}function K(){var he=Number.POSITIVE_INFINITY,xe=Number.NEGATIVE_INFINITY,me=Number.MAX_VALUE,ye,De,Le,Ve,ze,Ze,Me,$e,at,ct,ft,Et,St,Pt,Dt,Ye;function mt(jn,kn,gt){kn<jn.datamin&&kn!=-me&&(jn.datamin=kn),gt>jn.datamax&&gt!=me&&(jn.datamax=gt)}for(te.each(U(),function(jn,kn){kn.datamin=he,kn.datamax=xe,kn.used=!1}),ye=0;ye<o.length;++ye)Ze=o[ye],Ze.datapoints={points:[]},D(E.processRawData,[Ze,Ze.data,Ze.datapoints]);for(ye=0;ye<o.length;++ye){if(Ze=o[ye],Dt=Ze.data,Ye=Ze.datapoints.format,!Ye){if(Ye=[],Ye.push({x:!0,number:!0,required:!0}),Ye.push({y:!0,number:!0,required:!0}),Ze.stack||Ze.bars.show||Ze.lines.show&&Ze.lines.fill){var zt=!!(Ze.bars.show&&Ze.bars.zero||Ze.lines.show&&Ze.lines.zero);Ye.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:zt}),Ze.bars.horizontal&&(delete Ye[Ye.length-1].y,Ye[Ye.length-1].x=!0)}Ze.datapoints.format=Ye}if(Ze.datapoints.pointsize==null){Ze.datapoints.pointsize=Ye.length,$e=Ze.datapoints.pointsize,Me=Ze.datapoints.points;var Jt=Ze.lines.show&&Ze.lines.steps;for(Ze.xaxis.used=Ze.yaxis.used=!0,De=Le=0;De<Dt.length;++De,Le+=$e){Pt=Dt[De];var Xt=Pt==null;if(!Xt)for(Ve=0;Ve<$e;++Ve)Et=Pt[Ve],St=Ye[Ve],St&&(St.number&&Et!=null&&(Et=+Et,isNaN(Et)?Et=null:Et==1/0?Et=me:Et==-1/0&&(Et=-me)),Et==null&&(St.required&&(Xt=!0),St.defaultValue!=null&&(Et=St.defaultValue))),Me[Le+Ve]=Et;if(Xt)for(Ve=0;Ve<$e;++Ve)Et=Me[Le+Ve],Et!=null&&(St=Ye[Ve],St.autoscale!==!1&&(St.x&&mt(Ze.xaxis,Et,Et),St.y&&mt(Ze.yaxis,Et,Et))),Me[Le+Ve]=null;if(Jt&&Le>0&&(!Xt||Me[Le-$e]!=null)){for(Ve=0;Ve<$e;++Ve)Me[Le+$e+Ve]=Me[Le+Ve];Me[Le+1]=Me[Le-$e+1]||0,Xt&&(Me[Le]=Pt[0]),Le+=$e}}}}for(ye=0;ye<o.length;++ye){if(Ze=o[ye],Me=Ze.datapoints.points,$e=Ze.datapoints.pointsize,Ze.transform==="negative-Y")for(De=0;De<Me.length;De+=$e)Me[De]!=null&&(Et=Me[De+1],Me[De+1]=-Et);D(E.processDatapoints,[Ze,Ze.datapoints])}for(ye=0;ye<o.length;++ye){Ze=o[ye],Me=Ze.datapoints.points,$e=Ze.datapoints.pointsize,Ye=Ze.datapoints.format;var En=he,ln=he,cn=xe,Pn=xe;for(De=0;De<Me.length;De+=$e)if(Me[De]!=null)for(Ve=0;Ve<$e;++Ve)Et=Me[De+Ve],St=Ye[Ve],!(!St||St.autoscale===!1||Et==me||Et==-me)&&(St.x&&(Et<En&&(En=Et),Et>cn&&(cn=Et)),St.y&&(Et<ln&&(ln=Et),Et>Pn&&(Pn=Et)));if(Ze.bars.show){var wn;switch(Ze.bars.align){case"left":wn=0;break;case"right":wn=-Ze.bars.barWidth;break;default:wn=-Ze.bars.barWidth/2}Ze.bars.horizontal?(ln+=wn,Pn+=wn+Ze.bars.barWidth):(En+=wn,cn+=wn+Ze.bars.barWidth)}mt(Ze.xaxis,En,cn),mt(Ze.yaxis,ln,Pn)}te.each(U(),function(jn,kn){kn.datamin==he&&(kn.datamin=null),kn.datamax==xe&&(kn.datamax=null)})}function T(){s.find(".flot-temp-elem").remove(),s.css("position")=="static"&&s.css("position","relative"),g=new e("flot-base",s),f=new e("flot-overlay",s),c=g.context,x=f.context,p=te(f.element).unbind();var he=s.data("plot");he&&(he.shutdown(),f.clear()),s.data("plot",b)}function L(){l.grid.hoverable&&(p.mousemove(Te),p.bind("mouseleave",_e),te(document).bind("touchend",tt)),l.grid.clickable&&p.click(He),D(E.bindEvents,[p])}function A(){Oe&&clearTimeout(Oe),p.unbind("mousemove",Te),p.unbind("mouseleave",_e),p.unbind("click",He),te(document).unbind("touchend",tt),D(E.shutdown,[p])}function N(he){function xe(Ve){return Ve}var me,ye,De=he.options.transform||xe,Le=he.options.inverseTransform;he.direction=="x"?(me=he.scale=h/Math.abs(De(he.max)-De(he.min)),ye=Math.min(De(he.max),De(he.min))):(me=he.scale=d/Math.abs(De(he.max)-De(he.min)),me=-me,ye=Math.max(De(he.max),De(he.min))),De==xe?he.p2c=function(Ve){return(Ve-ye)*me}:he.p2c=function(Ve){return(De(Ve)-ye)*me},Le?he.c2p=function(Ve){return Le(ye+Ve/me)}:he.c2p=function(Ve){return ye+Ve/me}}function V(he){for(var xe=he.options,me=he.ticks||[],ye=xe.labelWidth||0,De=xe.labelHeight||0,Le=ye||(he.direction=="x"?Math.floor(g.width/(me.length||1)):null),Ve=he.direction+"Axis "+he.direction+he.n+"Axis",ze="flot-"+he.direction+"-axis flot-"+he.direction+he.n+"-axis "+Ve,Ze=xe.font||"flot-tick-label tickLabel",Me=0;Me<me.length;++Me){var $e=me[Me];if($e.label){var at=g.getTextInfo(ze,$e.label,Ze,null,Le);ye=Math.max(ye,at.width+1),De=Math.max(De,at.height)}}he.labelWidth=xe.labelWidth||ye,he.labelHeight=xe.labelHeight||De}function z(he){var xe=he.labelWidth,me=he.labelHeight,ye=he.options.position,De=he.direction==="x",Le=he.options.tickLength,Ve=l.grid.axisMargin,ze=l.grid.labelMargin,Ze=l.grid.eventSectionHeight,Me=!0,$e=!0,at=!0,ct=!1;te.each(De?v:m,function(ft,Et){Et&&(Et.show||Et.reserveSpace)&&(Et===he?ct=!0:Et.options.position===ye&&(ct?$e=!1:Me=!1),ct||(at=!1))}),$e&&(Ve=0),Le==null&&(Le=at?"full":5),isNaN(+Le)||(ze+=+Le),De?(me+=ze,me+=Ze,ye=="bottom"?(y.bottom+=me+Ve,he.box={top:g.height-y.bottom,height:me}):(he.box={top:y.top+Ve,height:me},y.top+=me+Ve)):(xe+=ze,ye=="left"?(he.box={left:y.left+Ve,width:xe},y.left+=xe+Ve):(y.right+=xe+Ve,he.box={left:g.width-y.right,width:xe})),he.position=ye,he.tickLength=Le,he.box.padding=ze,he.box.eventSectionPadding=Ze,he.innermost=Me}function w(he){he.direction=="x"?(he.box.left=y.left-he.labelWidth/2,he.box.width=g.width-y.left-y.right+he.labelWidth):(he.box.top=y.top-he.labelHeight/2,he.box.height=g.height-y.bottom-y.top+he.labelHeight)}function H(){var he=l.grid.minBorderMargin,xe,me;if(he==null)for(he=0,me=0;me<o.length;++me)he=Math.max(he,2*(o[me].points.radius+o[me].points.lineWidth/2));var ye={left:he,right:he,top:he,bottom:he};te.each(U(),function(De,Le){Le.reserveSpace&&Le.ticks&&Le.ticks.length&&(Le.direction==="x"?(ye.left=Math.max(ye.left,Le.labelWidth/2),ye.right=Math.max(ye.right,Le.labelWidth/2)):(ye.bottom=Math.max(ye.bottom,Le.labelHeight/2),ye.top=Math.max(ye.top,Le.labelHeight/2)))}),y.left=Math.ceil(Math.max(ye.left,y.left)),y.right=Math.ceil(Math.max(ye.right,y.right)),y.top=Math.ceil(Math.max(ye.top,y.top)),y.bottom=Math.ceil(Math.max(ye.bottom,y.bottom))}function Q(){var he,xe=U(),me=l.grid.show;for(var ye in y){var De=l.grid.margin||0;y[ye]=typeof De=="number"?De:De[ye]||0}D(E.processOffset,[y]);for(var ye in y)typeof l.grid.borderWidth=="object"?y[ye]+=me?l.grid.borderWidth[ye]:0:y[ye]+=me?l.grid.borderWidth:0;if(te.each(xe,function(ze,Ze){var Me=Ze.options;Ze.show=Me.show==null?Ze.used:Me.show,Ze.reserveSpace=Me.reserveSpace==null?Ze.show:Me.reserveSpace,Z(Ze)}),D(E.processRange,[]),me){for(var Le=te.grep(xe,function(ze){return ze.show||ze.reserveSpace}),Ve=!1,he=0;he<2&&(te.each(Le,function(Ze,Me){X(Me),I(Me),Ve=J(Me,Me.ticks)||Ve,V(Me)}),Ve&&E.processRange.length>0);he++)D(E.processRange,[]),Ve=!1;for(he=Le.length-1;he>=0;--he)z(Le[he]);H(),te.each(Le,function(ze,Ze){w(Ze)})}h=g.width-y.left-y.right,d=g.height-y.bottom-y.top,te.each(xe,function(ze,Ze){N(Ze)}),me&&oe(),Ee()}function Z(he){var xe=he.options,me=+(xe.min!=null?xe.min:he.datamin),ye=+(xe.max!=null?xe.max:he.datamax),De=ye-me;if(De==0){var Le=.25,Ve=Math.abs(ye==0?1:ye*Le);xe.min==null&&(me-=Ve),(xe.max==null||xe.min!=null)&&(ye+=Ve)}else{var ze=xe.autoscaleMargin;ze!=null&&(xe.min==null&&(me-=De*ze,me<0&&he.datamin!=null&&he.datamin>=0&&(me=0)),xe.max==null&&(ye+=De*ze,ye>0&&he.datamax!=null&&he.datamax<=0&&(ye=0)))}he.min=me,he.max=ye}function Y(he){if(he=Math.abs(String(he).replace(".","")),he==0)return 0;for(;he!=0&&he%10==0;)he/=10;return Math.floor(Math.log(he)/Math.LN10)+1}function X(he){var xe=he.options,me;typeof xe.ticks=="number"&&xe.ticks>0?me=xe.ticks:me=.3*Math.sqrt(he.direction=="x"?g.width:g.height);var ye=(he.max-he.min)/me,De=-Math.floor(Math.log(ye)/Math.LN10),Le=xe.tickDecimals;Le!=null&&De>Le&&(De=Le);var Ve=Math.pow(10,-De),ze=ye/Ve,Ze;if(ze<1.5?Ze=1:ze<3?(Ze=2,ze>2.25&&(Le==null||De+1<=Le)&&(Ze=2.5,++De)):ze<7.5?Ze=5:Ze=10,Ze*=Ve,xe.minTickSize!=null&&Ze<xe.minTickSize&&(Ze=xe.minTickSize),he.delta=ye,he.tickDecimals=Math.max(0,Le??De),he.tickSize=xe.tickSize||Ze,xe.mode=="time"&&!he.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(he.tickGenerator||(he.tickGenerator=function(ft){var Et=[],St=a(ft.min,ft.tickSize),Pt=0,Dt=Number.NaN,Ye;do Ye=Dt,Dt=St+Pt*ft.tickSize,Et.push(Dt),++Pt;while(Dt<ft.max&&Dt!=Ye);return Et},he.tickFormatter=function(ft,Et){var St=Et.tickDecimals?Math.pow(10,Et.tickDecimals):1,Pt=""+Math.round(ft*St)/St;if(Et.tickDecimals!=null){var Dt=Pt.indexOf("."),Ye=Dt==-1?0:Pt.length-Dt-1;if(Ye<Et.tickDecimals)return(Ye?Pt:Pt+".")+(""+St).substr(1,Et.tickDecimals-Ye)}return Pt}),te.isFunction(xe.tickFormatter)&&(he.tickFormatter=function(ft,Et){return""+xe.tickFormatter(ft,Et)}),xe.alignTicksWithAxis!=null){var Me=(he.direction=="x"?v:m)[xe.alignTicksWithAxis-1];if(Me&&Me.used&&Me!=he){var $e=he.tickGenerator(he);if($e.length>0&&(xe.min==null&&(he.min=Math.min(he.min,$e[0])),xe.max==null&&$e.length>1&&(he.max=Math.max(he.max,$e[$e.length-1]))),he.tickGenerator=function(ft){var Et=[],St,Pt;for(Pt=0;Pt<Me.ticks.length;++Pt)St=(Me.ticks[Pt].v-Me.min)/(Me.max-Me.min),St=ft.min+St*(ft.max-ft.min),Et.push(St);return Et},!he.mode&&xe.tickDecimals==null){var at=Math.max(0,-Math.floor(Math.log(he.delta)/Math.LN10)+1),ct=he.tickGenerator(he);ct.length>1&&/\..*0$/.test((ct[1]-ct[0]).toFixed(at))||(he.tickDecimals=at)}}}}function I(he){var xe=he.options.ticks,me=[];xe==null||typeof xe=="number"&&xe>0?me=he.tickGenerator(he):xe&&(te.isFunction(xe)?me=xe(he):me=xe);var ye,De;for(he.ticks=[],ye=0;ye<me.length;++ye){var Le=null,Ve=me[ye];typeof Ve=="object"?(De=+Ve[0],Ve.length>1&&(Le=Ve[1])):De=+Ve,Le==null&&(Le=he.tickFormatter(De,he)),isNaN(De)||he.ticks.push({v:De,label:Le})}}function J(he,xe){var me=!1;return he.options.autoscaleMargin&&xe.length>0&&(he.options.min==null&&(he.min=Math.min(he.min,xe[0].v),me=!0),he.options.max==null&&xe.length>1&&(he.max=Math.max(he.max,xe[xe.length-1].v),me=!0)),me}function ee(){g.clear(),D(E.drawBackground,[c]);var he=l.grid;he.show&&he.backgroundColor&&ne(),he.show&&!he.aboveData&&se();for(var xe=0;xe<o.length;++xe)D(E.drawSeries,[c,o[xe]]),fe(o[xe]);D(E.draw,[c]),he.show&&he.aboveData&&se(),g.render(),je()}function q(he,xe){for(var me,ye,De,Le,Ve=U(),ze=0;ze<Ve.length;++ze)if(me=Ve[ze],me.direction==xe&&(Le=xe+me.n+"axis",!he[Le]&&me.n==1&&(Le=xe+"axis"),he[Le])){ye=he[Le].from,De=he[Le].to;break}if(he[Le]||(me=xe=="x"?v[0]:m[0],ye=he[xe+"1"],De=he[xe+"2"]),ye!=null&&De!=null&&ye>De){var Ze=ye;ye=De,De=Ze}return{from:ye,to:De,axis:me}}function ne(){c.save(),c.translate(y.left,y.top),c.fillStyle=nt(l.grid.backgroundColor,d,0,"rgba(255, 255, 255, 0)"),c.fillRect(0,0,h,d),c.restore()}function se(){var he,xe,me,ye;c.save(),c.translate(y.left,y.top);var De=l.grid.markings;if(De)for(te.isFunction(De)&&(xe=b.getAxes(),xe.xmin=xe.xaxis.min,xe.xmax=xe.xaxis.max,xe.ymin=xe.yaxis.min,xe.ymax=xe.yaxis.max,De=De(xe)),he=0;he<De.length;++he){var Le=De[he],Ve=q(Le,"x"),ze=q(Le,"y");if(Ve.from==null&&(Ve.from=Ve.axis.min),Ve.to==null&&(Ve.to=Ve.axis.max),ze.from==null&&(ze.from=ze.axis.min),ze.to==null&&(ze.to=ze.axis.max),!(Ve.to<Ve.axis.min||Ve.from>Ve.axis.max||ze.to<ze.axis.min||ze.from>ze.axis.max)){Ve.from=Math.max(Ve.from,Ve.axis.min),Ve.to=Math.min(Ve.to,Ve.axis.max),ze.from=Math.max(ze.from,ze.axis.min),ze.to=Math.min(ze.to,ze.axis.max);var Ze=Ve.from===Ve.to,Me=ze.from===ze.to;if(!(Ze&&Me))if(Ve.from=Math.floor(Ve.axis.p2c(Ve.from)),Ve.to=Math.floor(Ve.axis.p2c(Ve.to)),ze.from=Math.floor(ze.axis.p2c(ze.from)),ze.to=Math.floor(ze.axis.p2c(ze.to)),Ze||Me){var $e=Le.lineWidth||l.grid.markingsLineWidth,at=$e%2?.5:0;c.beginPath(),c.strokeStyle=Le.color||l.grid.markingsColor,c.lineWidth=$e,Ze?(c.moveTo(Ve.to+at,ze.from),c.lineTo(Ve.to+at,ze.to)):(c.moveTo(Ve.from,ze.to+at),c.lineTo(Ve.to,ze.to+at)),c.stroke()}else c.fillStyle=Le.color||l.grid.markingsColor,c.fillRect(Ve.from,ze.to,Ve.to-Ve.from,ze.from-ze.to)}}xe=U(),me=l.grid.borderWidth;for(var ct=0;ct<xe.length;++ct){var ft=xe[ct],Et=ft.box,St=ft.tickLength,Pt,Dt,Ye,mt;if(!(!ft.show||ft.ticks.length==0)){for(c.lineWidth=1,ft.direction=="x"?(Pt=0,St=="full"?Dt=ft.position=="top"?0:d:Dt=Et.top-y.top+(ft.position=="top"?Et.height:0)):(Dt=0,St=="full"?Pt=ft.position=="left"?0:h:Pt=Et.left-y.left+(ft.position=="left"?Et.width:0)),ft.innermost||(c.strokeStyle=ft.options.color,c.beginPath(),Ye=mt=0,ft.direction=="x"?Ye=h+1:mt=d+1,c.lineWidth==1&&(ft.direction=="x"?Dt=Math.floor(Dt)+.5:Pt=Math.floor(Pt)+.5),c.moveTo(Pt,Dt),c.lineTo(Pt+Ye,Dt+mt),c.stroke()),c.strokeStyle=ft.options.tickColor,c.beginPath(),he=0;he<ft.ticks.length;++he){var zt=ft.ticks[he].v;Ye=mt=0,!(isNaN(zt)||zt<ft.min||zt>ft.max||St=="full"&&(typeof me=="object"&&me[ft.position]>0||me>0)&&(zt==ft.min||zt==ft.max))&&(ft.direction=="x"?(Pt=ft.p2c(zt),mt=St=="full"?-d:St,ft.position=="top"&&(mt=-mt)):(Dt=ft.p2c(zt),Ye=St=="full"?-h:St,ft.position=="left"&&(Ye=-Ye)),c.lineWidth==1&&(ft.direction=="x"?Pt=Math.floor(Pt)+.5:Dt=Math.floor(Dt)+.5),c.moveTo(Pt,Dt),c.lineTo(Pt+Ye,Dt+mt))}c.stroke()}}me&&(ye=l.grid.borderColor,typeof me=="object"||typeof ye=="object"?(typeof me!="object"&&(me={top:me,right:me,bottom:me,left:me}),typeof ye!="object"&&(ye={top:ye,right:ye,bottom:ye,left:ye}),me.top>0&&(c.strokeStyle=ye.top,c.lineWidth=me.top,c.beginPath(),c.moveTo(0-me.left,0-me.top/2),c.lineTo(h,0-me.top/2),c.stroke()),me.right>0&&(c.strokeStyle=ye.right,c.lineWidth=me.right,c.beginPath(),c.moveTo(h+me.right/2,0-me.top),c.lineTo(h+me.right/2,d),c.stroke()),me.bottom>0&&(c.strokeStyle=ye.bottom,c.lineWidth=me.bottom,c.beginPath(),c.moveTo(h+me.right,d+me.bottom/2),c.lineTo(0,d+me.bottom/2),c.stroke()),me.left>0&&(c.strokeStyle=ye.left,c.lineWidth=me.left,c.beginPath(),c.moveTo(0-me.left/2,d+me.bottom),c.lineTo(0-me.left/2,0),c.stroke())):(c.lineWidth=me,c.strokeStyle=l.grid.borderColor,c.strokeRect(-me/2,-me/2,h+me,d+me))),c.restore()}function oe(){te.each(U(),function(he,xe){var me=xe.box,ye=xe.direction+"Axis "+xe.direction+xe.n+"Axis",De="flot-"+xe.direction+"-axis flot-"+xe.direction+xe.n+"-axis "+ye,Le=xe.options.font||"flot-tick-label tickLabel",Ve,ze,Ze,Me,$e;if(g.removeText(De),!(!xe.show||xe.ticks.length==0))for(var at=0;at<xe.ticks.length;++at)Ve=xe.ticks[at],!(!Ve.label||Ve.v<xe.min||Ve.v>xe.max)&&(xe.direction=="x"?(Me="center",ze=y.left+xe.p2c(Ve.v),xe.position=="bottom"?Ze=me.top+me.padding+me.eventSectionPadding:(Ze=me.top+me.height-me.padding,$e="bottom")):($e="middle",Ze=y.top+xe.p2c(Ve.v),xe.position=="left"?(ze=me.left+me.width-me.padding,Me="right"):ze=me.left+me.padding),g.addText(De,ze,Ze,Ve.label,Le,null,null,Me,$e))})}function de(he){for(var xe=[],me=null,ye=null,De=he.datapoints,Le=[],Ve=0;Ve<De.pointsize-2;Ve++)Le.push(0);for(var ze=0;ze<De.points.length;ze+=De.pointsize){var Ze=De.points[ze],Me=De.points[ze+1];ze===De.points.length-De.pointsize?ye=null:ye=De.points[ze+De.pointsize],Ze!==null&&Me!==null&&me===null&&ye===null&&(xe.push(Ze),xe.push(Me),xe.push.apply(xe,Le)),me=Ze}var $e=De.points;De.points=xe,he.points.radius=he.lines.lineWidth/2,ce(he),De.points=$e}function fe(he){he.lines.show&&(ae(he),!he.points.show&&!he.bars.show&&de(he)),he.bars.show&&ve(he),he.points.show&&ce(he)}function ae(he){function xe(ze,Ze,Me,$e,at){var ct=ze.points,ft=ze.pointsize,Et=null,St=null;c.beginPath();for(var Pt=ft;Pt<ct.length;Pt+=ft){var Dt=ct[Pt-ft],Ye=ct[Pt-ft+1],mt=ct[Pt],zt=ct[Pt+1];if(!(Dt==null||mt==null)){if(Ye<=zt&&Ye<at.min){if(zt<at.min)continue;Dt=(at.min-Ye)/(zt-Ye)*(mt-Dt)+Dt,Ye=at.min}else if(zt<=Ye&&zt<at.min){if(Ye<at.min)continue;mt=(at.min-Ye)/(zt-Ye)*(mt-Dt)+Dt,zt=at.min}if(Ye>=zt&&Ye>at.max){if(zt>at.max)continue;Dt=(at.max-Ye)/(zt-Ye)*(mt-Dt)+Dt,Ye=at.max}else if(zt>=Ye&&zt>at.max){if(Ye>at.max)continue;mt=(at.max-Ye)/(zt-Ye)*(mt-Dt)+Dt,zt=at.max}if(Dt<=mt&&Dt<$e.min){if(mt<$e.min)continue;Ye=($e.min-Dt)/(mt-Dt)*(zt-Ye)+Ye,Dt=$e.min}else if(mt<=Dt&&mt<$e.min){if(Dt<$e.min)continue;zt=($e.min-Dt)/(mt-Dt)*(zt-Ye)+Ye,mt=$e.min}if(Dt>=mt&&Dt>$e.max){if(mt>$e.max)continue;Ye=($e.max-Dt)/(mt-Dt)*(zt-Ye)+Ye,Dt=$e.max}else if(mt>=Dt&&mt>$e.max){if(Dt>$e.max)continue;zt=($e.max-Dt)/(mt-Dt)*(zt-Ye)+Ye,mt=$e.max}(Dt!=Et||Ye!=St)&&c.moveTo($e.p2c(Dt)+Ze,at.p2c(Ye)+Me),Et=mt,St=zt,c.lineTo($e.p2c(mt)+Ze,at.p2c(zt)+Me)}}c.stroke()}function me(ze,Ze,Me){for(var $e=ze.points,at=ze.pointsize,ct=Math.min(Math.max(0,Me.min),Me.max),ft=0,Et,St=!1,Pt=1,Dt=0,Ye=0;!(at>0&&ft>$e.length+at);){ft+=at;var mt=$e[ft-at],zt=$e[ft-at+Pt],Jt=$e[ft],Xt=$e[ft+Pt];if(St){if(at>0&&mt!=null&&Jt==null){Ye=ft,at=-at,Pt=2;continue}if(at<0&&ft==Dt+at){c.fill(),St=!1,at=-at,Pt=1,ft=Dt=Ye+at;continue}}if(!(mt==null||Jt==null)){if(mt<=Jt&&mt<Ze.min){if(Jt<Ze.min)continue;zt=(Ze.min-mt)/(Jt-mt)*(Xt-zt)+zt,mt=Ze.min}else if(Jt<=mt&&Jt<Ze.min){if(mt<Ze.min)continue;Xt=(Ze.min-mt)/(Jt-mt)*(Xt-zt)+zt,Jt=Ze.min}if(mt>=Jt&&mt>Ze.max){if(Jt>Ze.max)continue;zt=(Ze.max-mt)/(Jt-mt)*(Xt-zt)+zt,mt=Ze.max}else if(Jt>=mt&&Jt>Ze.max){if(mt>Ze.max)continue;Xt=(Ze.max-mt)/(Jt-mt)*(Xt-zt)+zt,Jt=Ze.max}if(St||(c.beginPath(),c.moveTo(Ze.p2c(mt),Me.p2c(ct)),St=!0),zt>=Me.max&&Xt>=Me.max){c.lineTo(Ze.p2c(mt),Me.p2c(Me.max)),c.lineTo(Ze.p2c(Jt),Me.p2c(Me.max));continue}else if(zt<=Me.min&&Xt<=Me.min){c.lineTo(Ze.p2c(mt),Me.p2c(Me.min)),c.lineTo(Ze.p2c(Jt),Me.p2c(Me.min));continue}var En=mt,ln=Jt;zt<=Xt&&zt<Me.min&&Xt>=Me.min?(mt=(Me.min-zt)/(Xt-zt)*(Jt-mt)+mt,zt=Me.min):Xt<=zt&&Xt<Me.min&&zt>=Me.min&&(Jt=(Me.min-zt)/(Xt-zt)*(Jt-mt)+mt,Xt=Me.min),zt>=Xt&&zt>Me.max&&Xt<=Me.max?(mt=(Me.max-zt)/(Xt-zt)*(Jt-mt)+mt,zt=Me.max):Xt>=zt&&Xt>Me.max&&zt<=Me.max&&(Jt=(Me.max-zt)/(Xt-zt)*(Jt-mt)+mt,Xt=Me.max),mt!=En&&c.lineTo(Ze.p2c(En),Me.p2c(zt)),c.lineTo(Ze.p2c(mt),Me.p2c(zt)),c.lineTo(Ze.p2c(Jt),Me.p2c(Xt)),Jt!=ln&&(c.lineTo(Ze.p2c(Jt),Me.p2c(Xt)),c.lineTo(Ze.p2c(ln),Me.p2c(Xt)))}}}c.save(),c.translate(y.left,y.top),c.lineJoin="round";var ye=he.lines.lineWidth,De=he.shadowSize;if(ye>0&&De>0){c.lineWidth=De,c.strokeStyle="rgba(0,0,0,0.1)";var Le=Math.PI/18;xe(he.datapoints,Math.sin(Le)*(ye/2+De/2),Math.cos(Le)*(ye/2+De/2),he.xaxis,he.yaxis),c.lineWidth=De/2,xe(he.datapoints,Math.sin(Le)*(ye/2+De/4),Math.cos(Le)*(ye/2+De/4),he.xaxis,he.yaxis)}c.lineWidth=ye,c.strokeStyle=he.color;var Ve=le(he.lines,he.color,0,d);Ve&&(c.fillStyle=Ve,me(he.datapoints,he.xaxis,he.yaxis)),ye>0&&xe(he.datapoints,0,0,he.xaxis,he.yaxis),c.restore()}function ce(he){function xe(ze,Ze,Me,$e,at,ct,ft,Et){for(var St=ze.points,Pt=ze.pointsize,Dt=0;Dt<St.length;Dt+=Pt){var Ye=St[Dt],mt=St[Dt+1];Ye==null||Ye<ct.min||Ye>ct.max||mt<ft.min||mt>ft.max||(c.beginPath(),Ye=ct.p2c(Ye),mt=ft.p2c(mt)+$e,Et=="circle"?c.arc(Ye,mt,Ze,0,at?Math.PI:Math.PI*2,!1):Et(c,Ye,mt,Ze,at),c.closePath(),Me&&(c.fillStyle=Me,c.fill()),c.stroke())}}c.save(),c.translate(y.left,y.top);var me=he.points.lineWidth,ye=he.shadowSize,De=he.points.radius,Le=he.points.symbol;if(me==0&&(me=1e-4),me>0&&ye>0){var Ve=ye/2;c.lineWidth=Ve,c.strokeStyle="rgba(0,0,0,0.1)",xe(he.datapoints,De,null,Ve+Ve/2,!0,he.xaxis,he.yaxis,Le),c.strokeStyle="rgba(0,0,0,0.2)",xe(he.datapoints,De,null,Ve/2,!0,he.xaxis,he.yaxis,Le)}c.lineWidth=me,c.strokeStyle=he.color,xe(he.datapoints,De,le(he.points,he.color),0,!1,he.xaxis,he.yaxis,Le),c.restore()}function ie(he,xe,me,ye,De,Le,Ve,ze,Ze,Me,$e){var at,ct,ft,Et,St,Pt,Dt,Ye,mt;Me?(Ye=Pt=Dt=!0,St=!1,at=me,ct=he,Et=xe+ye,ft=xe+De,ct<at&&(mt=ct,ct=at,at=mt,St=!0,Pt=!1)):(St=Pt=Dt=!0,Ye=!1,at=he+ye,ct=he+De,ft=me,Et=xe,Et<ft&&(mt=Et,Et=ft,ft=mt,Ye=!0,Dt=!1)),!(ct<Ve.min||at>Ve.max||Et<ze.min||ft>ze.max)&&(at<Ve.min&&(at=Ve.min,St=!1),ct>Ve.max&&(ct=Ve.max,Pt=!1),ft<ze.min&&(ft=ze.min,Ye=!1),Et>ze.max&&(Et=ze.max,Dt=!1),at=Ve.p2c(at),ft=ze.p2c(ft),ct=Ve.p2c(ct),Et=ze.p2c(Et),Le&&(Ze.fillStyle=Le(ft,Et),Ze.fillRect(at,Et,ct-at,ft-Et)),$e>0&&(St||Pt||Dt||Ye)&&(Ze.beginPath(),Ze.moveTo(at,ft),St?Ze.lineTo(at,Et):Ze.moveTo(at,Et),Dt?Ze.lineTo(ct,Et):Ze.moveTo(ct,Et),Pt?Ze.lineTo(ct,ft):Ze.moveTo(ct,ft),Ye?Ze.lineTo(at,ft):Ze.moveTo(at,ft),Ze.stroke()))}function ve(he){function xe(De,Le,Ve,ze,Ze,Me){for(var $e=De.points,at=De.pointsize,ct=0;ct<$e.length;ct+=at)$e[ct]!=null&&ie($e[ct],$e[ct+1],$e[ct+2],Le,Ve,ze,Ze,Me,c,he.bars.horizontal,he.bars.lineWidth)}c.save(),c.translate(y.left,y.top),c.lineWidth=he.bars.lineWidth,c.strokeStyle=he.color;var me;switch(he.bars.align){case"left":me=0;break;case"right":me=-he.bars.barWidth;break;default:me=-he.bars.barWidth/2}var ye=he.bars.fill?function(De,Le){return le(he.bars,he.color,De,Le)}:null;xe(he.datapoints,me,me+he.bars.barWidth,ye,he.xaxis,he.yaxis),c.restore()}function le(he,xe,me,ye){var De=he.fill;if(!De)return null;if(he.fillColor)return nt(he.fillColor,me,ye,xe);var Le=te.color.parse(xe);return Le.a=typeof De=="number"?De:.4,Le.normalize(),Le.toString()}function Ee(){if(l.legend.container!=null?te.find(l.legend.container).html(""):s.find(".legend").remove(),!!l.legend.show){for(var he=[],xe=[],me=!1,ye=l.legend.labelFormatter,De,Le,Ve=0;Ve<o.length;++Ve)De=o[Ve],De.label&&(Le=ye?ye(De.label,De):De.label,Le&&xe.push({label:Le,color:De.color}));if(l.legend.sorted)if(te.isFunction(l.legend.sorted))xe.sort(l.legend.sorted);else if(l.legend.sorted=="reverse")xe.reverse();else{var ze=l.legend.sorted!="descending";xe.sort(function(Pt,Dt){return Pt.label==Dt.label?0:Pt.label<Dt.label!=ze?1:-1})}for(var Ve=0;Ve<xe.length;++Ve){var Ze=xe[Ve];Ve%l.legend.noColumns==0&&(me&&he.push("</tr>"),he.push("<tr>"),me=!0),he.push('<td class="legendColorBox"><div style="border:1px solid '+l.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+Ze.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+Ze.label+"</td>")}if(me&&he.push("</tr>"),he.length!=0){var Me='<table style="font-size:smaller;color:'+l.grid.color+'">'+he.join("")+"</table>";if(l.legend.container!=null)te(l.legend.container).html(Me);else{var $e="",at=l.legend.position,ct=l.legend.margin;ct[0]==null&&(ct=[ct,ct]),at.charAt(0)=="n"?$e+="top:"+(ct[1]+y.top)+"px;":at.charAt(0)=="s"&&($e+="bottom:"+(ct[1]+y.bottom)+"px;"),at.charAt(1)=="e"?$e+="right:"+(ct[0]+y.right)+"px;":at.charAt(1)=="w"&&($e+="left:"+(ct[0]+y.left)+"px;");var ft=te('<div class="legend">'+Me.replace('style="','style="position:absolute;'+$e+";")+"</div>").appendTo(s);if(l.legend.backgroundOpacity!=0){var Et=l.legend.backgroundColor;Et==null&&(Et=l.grid.backgroundColor,Et&&typeof Et=="string"?Et=te.color.parse(Et):Et=te.color.extract(ft,"background-color"),Et.a=1,Et=Et.toString());var St=ft.children();te('<div style="position:absolute;width:'+St.width()+"px;height:"+St.height()+"px;"+$e+"background-color:"+Et+';"> </div>').prependTo(ft).css("opacity",l.legend.backgroundOpacity)}}}}}var Re=[],Oe=null;function Se(he,xe,me){var ye=l.grid.mouseActiveRadius,De=ye*ye+1,Le=null,Ve=!1,ze,Ze,Me;for(ze=o.length-1;ze>=0;--ze)if(me(o[ze])){var $e=o[ze],at=$e.xaxis,ct=$e.yaxis,ft=$e.datapoints.points,Et=at.c2p(he),St=ct.c2p(xe),Pt=ye/at.scale,Dt=ye/ct.scale;if(Me=$e.datapoints.pointsize,at.options.inverseTransform&&(Pt=Number.MAX_VALUE),ct.options.inverseTransform&&(Dt=Number.MAX_VALUE),$e.lines.show||$e.points.show)for(Ze=0;Ze<ft.length;Ze+=Me){var Ye=ft[Ze],mt=ft[Ze+1];if(Ye!=null&&!(Ye-Et>Pt||Ye-Et<-Pt||mt-St>Dt||mt-St<-Dt)){var zt=Math.abs(at.p2c(Ye)-he),Jt=Math.abs(ct.p2c(mt)-xe),Xt=zt*zt+Jt*Jt;Xt<De&&(De=Xt,Le=[ze,Ze/Me])}}if($e.bars.show&&!Le){var En,ln;switch($e.bars.align){case"left":En=0;break;case"right":En=-$e.bars.barWidth;break;default:En=-$e.bars.barWidth/2}for(ln=En+$e.bars.barWidth,Ze=0;Ze<ft.length;Ze+=Me){var Ye=ft[Ze],mt=ft[Ze+1],cn=ft[Ze+2];Ye!=null&&(o[ze].bars.horizontal?Et<=Math.max(cn,Ye)&&Et>=Math.min(cn,Ye)&&St>=mt+En&&St<=mt+ln:Et>=Ye+En&&Et<=Ye+ln&&St>=Math.min(cn,mt)&&St<=Math.max(cn,mt))&&(Le=[ze,Ze/Me])}}}return Le?(ze=Le[0],Ze=Le[1],Me=o[ze].datapoints.pointsize,{datapoint:o[ze].datapoints.points.slice(Ze*Me,(Ze+1)*Me),dataIndex:Ze,series:o[ze],seriesIndex:ze}):null}function Te(he){l.grid.hoverable&&Ge("plothover",he,function(xe){return xe.hoverable!=!1})}function _e(he){l.grid.hoverable&&Ge("plothover",he,function(xe){return!1})}function He(he){b.isSelecting||Ge("plotclick",he,function(xe){return xe.clickable!=!1})}function tt(he){if(he.cancelable){if(!p.is(he.target)&&p.has(he.target).length===0){Ge("plotleave",he,function(xe){});return}Te(Je(he)),he.preventDefault()}}function Je(he){if(!he||!he.originalEvent||he.pageX&&he.pageY)return he;var xe=he.originalEvent;if(xe.changedTouches.length===0)return he;var me=xe.changedTouches[0];return he.pageX=me.pageX,he.pageY=me.pageY,he}function Ge(he,xe,me){var ye=p.offset(),De=xe.pageX-ye.left-y.left,Le=xe.pageY-ye.top-y.top,Ve=W({left:De,top:Le});Ve.pageX=xe.pageX,Ve.pageY=xe.pageY,Ve.ctrlKey=xe.ctrlKey,Ve.metaKey=xe.metaKey;var ze=Se(De,Le,me);if(ze&&(ze.pageX=parseInt(ze.series.xaxis.p2c(ze.datapoint[0])+ye.left+y.left,10),ze.pageY=parseInt(ze.series.yaxis.p2c(ze.datapoint[1])+ye.top+y.top,10)),l.grid.autoHighlight){for(var Ze=0;Ze<Re.length;++Ze){var Me=Re[Ze];Me.auto==he&&!(ze&&Me.series==ze.series&&Me.point[0]==ze.datapoint[0]&&Me.point[1]==ze.datapoint[1])&&Ke(Me.series,Me.point)}ze&&Be(ze.series,ze.datapoint,he)}s.trigger(he,[Ve,ze])}function je(){var he=l.interaction.redrawOverlayInterval;if(he==-1){Fe();return}Oe||(Oe=setTimeout(Fe,he))}function Fe(){Oe=null,x.save(),f.clear(),x.translate(y.left,y.top);var he,xe;for(he=0;he<Re.length;++he)xe=Re[he],xe.series.bars.show?Xe(xe.series,xe.point):we(xe.series,xe.point);x.restore(),D(E.drawOverlay,[x])}function Be(he,xe,me){if(typeof he=="number"&&(he=o[he]),typeof xe=="number"){var ye=he.datapoints.pointsize;xe=he.datapoints.points.slice(ye*xe,ye*(xe+1))}var De=Ue(he,xe);De==-1?(Re.push({series:he,point:xe,auto:me}),je()):me||(Re[De].auto=!1)}function Ke(he,xe){if(he==null&&xe==null){Re=[],je();return}if(typeof he=="number"&&(he=o[he]),typeof xe=="number"){var me=he.datapoints.pointsize;xe=he.datapoints.points.slice(me*xe,me*(xe+1))}var ye=Ue(he,xe);ye!=-1&&(Re.splice(ye,1),je())}function Ue(he,xe){for(var me=0;me<Re.length;++me){var ye=Re[me];if(ye.series==he&&ye.point[0]==xe[0]&&ye.point[1]==xe[1])return me}return-1}function we(he,xe){var me=xe[0],ye=xe[1],De=he.xaxis,Le=he.yaxis,Ve=typeof he.highlightColor=="string"?he.highlightColor:te.color.parse(he.color).scale("a",.5).toString();if(!(me<De.min||me>De.max||ye<Le.min||ye>Le.max)){var ze=he.points.radius+he.points.lineWidth/2;x.lineWidth=ze,x.strokeStyle=Ve;var Ze=1.5*ze;me=De.p2c(me),ye=Le.p2c(ye),x.beginPath(),he.points.symbol=="circle"?x.arc(me,ye,Ze,0,2*Math.PI,!1):he.points.symbol(x,me,ye,Ze,!1),x.closePath(),x.stroke()}}function Xe(he,xe){var me=typeof he.highlightColor=="string"?he.highlightColor:te.color.parse(he.color).scale("a",.5).toString(),ye=me,De;switch(he.bars.align){case"left":De=0;break;case"right":De=-he.bars.barWidth;break;default:De=-he.bars.barWidth/2}x.lineWidth=he.bars.lineWidth,x.strokeStyle=me,ie(xe[0],xe[1],xe[2]||0,De,De+he.bars.barWidth,function(){return ye},he.xaxis,he.yaxis,x,he.bars.horizontal,he.bars.lineWidth)}function nt(he,xe,me,ye){if(typeof he=="string")return he;for(var De=c.createLinearGradient(0,me,0,xe),Le=0,Ve=he.colors.length;Le<Ve;++Le){var ze=he.colors[Le];if(typeof ze!="string"){var Ze=te.color.parse(ye);ze.brightness!=null&&(Ze=Ze.scale("rgb",ze.brightness)),ze.opacity!=null&&(Ze.a*=ze.opacity),ze=Ze.toString()}De.addColorStop(Le/(Ve-1),ze)}return De}}te.plot=function(s,i,r){var u=new n(te(s),i,r,te.plot.plugins);return u},te.plot.version="0.8.3",te.plot.plugins=[],te.fn.plot=function(s,i){return this.each(function(){te.plot(this,s,i)})};function a(s,i){return i*Math.floor(s/i)}}(jQuery)},80851:()=>{(function(te){function R(e){var n={first:{x:-1,y:-1},second:{x:-1,y:-1},show:!1,active:!1},a={},s=null;function i(y){n.active&&(p(y),e.getPlaceholder().trigger("plotselecting",[o()]))}function r(y){y.which==1&&(document.body.focus(),document.onselectstart!==void 0&&a.onselectstart==null&&(a.onselectstart=document.onselectstart,document.onselectstart=function(){return!1}),document.ondrag!==void 0&&a.ondrag==null&&(a.ondrag=document.ondrag,document.ondrag=function(){return!1}),f(n.first,y),n.active=!0,s=function(h){u(h)},te(document).one("mouseup",s))}function u(y){return s=null,document.onselectstart!==void 0&&(document.onselectstart=a.onselectstart),document.ondrag!==void 0&&(document.ondrag=a.ondrag),n.active=!1,p(y),m()?l(y):(e.getPlaceholder().trigger("plotunselected",[]),e.getPlaceholder().trigger("plotselecting",[null])),setTimeout(function(){e.isSelecting=!1},10),!1}function o(){if(!m()||!n.show)return null;var y={},h=n.first,d=n.second,E=e.getAxes(),b=!0;return te.each(E,function(D,C){C.used&&(anyUsed=!1)}),te.each(E,function(D,C){if(C.used||b){var P=C.c2p(h[C.direction]),M=C.c2p(d[C.direction]);y[D]={from:Math.min(P,M),to:Math.max(P,M)}}}),y}function l(y){var h=o();h.ctrlKey=y.ctrlKey,h.metaKey=y.metaKey,e.getPlaceholder().trigger("plotselected",[h]),h.xaxis&&h.yaxis&&e.getPlaceholder().trigger("selected",[{x1:h.xaxis.from,y1:h.yaxis.from,x2:h.xaxis.to,y2:h.yaxis.to}])}function g(y,h,d){return h<y?y:h>d?d:h}function f(y,h){var d=e.getOptions(),E=e.getPlaceholder().offset(),b=e.getPlotOffset();y.x=g(0,h.pageX-E.left-b.left,e.width()),y.y=g(0,h.pageY-E.top-b.top,e.height()),d.selection.mode=="y"&&(y.x=y==n.first?0:e.width()),d.selection.mode=="x"&&(y.y=y==n.first?0:e.height())}function p(y){y.pageX!=null&&(f(n.second,y),m()?(e.isSelecting=!0,n.show=!0,e.triggerRedrawOverlay()):c(!0))}function c(y){n.show&&(n.show=!1,e.triggerRedrawOverlay(),y||e.getPlaceholder().trigger("plotunselected",[]))}function x(y,h){var d,E,b,D,C=e.getAxes();for(var P in C)if(d=C[P],d.direction==h&&(D=h+d.n+"axis",!y[D]&&d.n==1&&(D=h+"axis"),y[D])){E=y[D].from,b=y[D].to;break}if(y[D]||(d=h=="x"?e.getXAxes()[0]:e.getYAxes()[0],E=y[h+"1"],b=y[h+"2"]),E!=null&&b!=null&&E>b){var M=E;E=b,b=M}return{from:E,to:b,axis:d}}function v(y,h){var d,E,b=e.getOptions();b.selection.mode=="y"?(n.first.x=0,n.second.x=e.width()):(E=x(y,"x"),n.first.x=E.axis.p2c(E.from),n.second.x=E.axis.p2c(E.to)),b.selection.mode=="x"?(n.first.y=0,n.second.y=e.height()):(E=x(y,"y"),n.first.y=E.axis.p2c(E.from),n.second.y=E.axis.p2c(E.to)),n.show=!0,e.triggerRedrawOverlay(),!h&&m()&&l()}function m(){var y=e.getOptions().selection.minSize;return Math.abs(n.second.x-n.first.x)>=y&&Math.abs(n.second.y-n.first.y)>=y}e.clearSelection=c,e.setSelection=v,e.getSelection=o,e.hooks.bindEvents.push(function(y,h){var d=y.getOptions();d.selection.mode!=null&&(h.mousemove(i),h.mousedown(r))}),e.hooks.drawOverlay.push(function(y,h){if(n.show&&m()){var d=y.getPlotOffset(),E=y.getOptions();h.save(),h.translate(d.left,d.top);var b=te.color.parse(E.selection.color);h.strokeStyle=b.scale("a",.8).toString(),h.lineWidth=1,h.lineJoin=E.selection.shape,h.fillStyle=b.scale("a",.4).toString();var D=Math.min(n.first.x,n.second.x)+.5,C=Math.min(n.first.y,n.second.y)+.5,P=Math.abs(n.second.x-n.first.x)-1,M=Math.abs(n.second.y-n.first.y)-1;h.fillRect(D,C,P,M),h.strokeRect(D,C,P,M),h.restore()}}),e.hooks.shutdown.push(function(y,h){h.unbind("mousemove",i),h.unbind("mousedown",r),s&&(te(document).unbind("mouseup",s),document.onselectstart!==void 0&&(document.onselectstart=a.onselectstart),document.ondrag!==void 0&&(document.ondrag=a.ondrag))})}te.plot.plugins.push({init:R,options:{selection:{mode:null,color:"#e8cfac",shape:"round",minSize:5}},name:"selection",version:"1.1"})})(jQuery)},31221:()=>{(function(te){var R={series:{stack:null}};function e(n){function a(i,r){for(var u=null,o=0;o<r.length&&i!=r[o];++o)r[o].stack==i.stack&&(u=r[o]);return u}function s(i,r,u){if(!(r.stack==null||r.stack===!1)){var o=a(r,i.getData());if(o){for(var l=u.pointsize,g=u.points,f=o.datapoints.pointsize,p=o.datapoints.points,c=[],x,v,m,y,h,d,E=r.lines.show,b=r.bars.horizontal,D=l>2&&(b?u.format[2].x:u.format[2].y),C=E&&r.lines.steps,P=b?1:0,M=b?0:1,O=0,j=0,U,W;!(O>=g.length&&j>=p.length);){if(U=c.length,O<g.length&&g[O]==null){for(W=0;W<l;++W)c.push(g[O+W]);O+=l}else if(O>=g.length){for(W=0;W<l;++W)c.push(p[j+W]);D&&(c[U+2]=p[j+M]),j+=f}else if(j>=p.length){for(W=0;W<l;++W)c.push(g[O+W]);O+=l}else if(j<p.length&&p[j]==null)j+=f;else{if(x=g[O+P],v=g[O+M],y=p[j+P],h=p[j+M],d=0,x==y){for(W=0;W<l;++W)c.push(g[O+W]);c[U+M]+=h,d=h,O+=l,j+=f}else if(x>y){if(O==0){for(W=0;W<l;++W)c.push(p[j+W]);d=h}if(O>0&&g[O-l]!=null){for(m=0,c.push(y),c.push(m+h),W=2;W<l;++W)c.push(g[O+W]);d=h}j+=f}else{for(W=0;W<l;++W)c.push(g[O+W]);j>0&&p[j-f]!=null&&(d=0),c[U+M]+=d,O+=l}fromgap=!1,U!=c.length&&D&&(c[U+2]=d)}if(C&&U!=c.length&&U>0&&c[U]!=null&&c[U]!=c[U-l]&&c[U+1]!=c[U-l+1]){for(W=0;W<l;++W)c[U+l+W]=c[U+W];c[U+1]=c[U-l+1]}}u.points=c}}}n.hooks.processDatapoints.push(s)}te.plot.plugins.push({init:e,options:R,name:"stack",version:"1.2"})})(jQuery)},91520:()=>{(function(te){var R={series:{stackpercent:null}};function e(n){var a={},s=!1,i={};function r(l,g,f,p){if(s||(s=!0,i=u(l.getData())),g.stackpercent==!0){var c=f.length;g.percents=[];var x=0,v=1;g.bars&&g.bars.horizontal&&g.bars.horizontal===!0&&(x=1,v=0);for(var m=0;m<c;m++){var y=i[f[m][x]+""];y>0?g.percents.push(f[m][v]*100/y):g.percents.push(0)}}}function u(l){var g=l.length,f={};if(g>0){for(var p=0;p<g;p++)if(l[p].stackpercent){var c=0,x=1;l[p].bars&&l[p].bars.horizontal&&l[p].bars.horizontal===!0&&(c=1,x=0);for(var v=l[p].data.length,m=0;m<v;m++){var y=0;l[p].data[m][1]!=null&&(y=l[p].data[m][x]),f[l[p].data[m][c]+""]?f[l[p].data[m][c]+""]+=y:f[l[p].data[m][c]+""]=y}}}return f}function o(l,g,f){if(g.stackpercent){s||(i=u(l.getData()));var p=[],c=0,x=1;g.bars&&g.bars.horizontal&&g.bars.horizontal===!0&&(c=1,x=0);for(var v=0;v<f.points.length;v+=3)a[f.points[v+c]]||(a[f.points[v+c]]=0),p[v+c]=f.points[v+c],p[v+x]=f.points[v+x]+a[f.points[v+c]],p[v+2]=a[f.points[v+c]],a[f.points[v+c]]+=f.points[v+x],i[p[v+c]+""]>0?(p[v+x]=p[v+x]*100/i[p[v+c]+""],p[v+2]=p[v+2]*100/i[p[v+c]+""]):(p[v+x]=0,p[v+2]=0);f.points=p}}n.hooks.processRawData.push(r),n.hooks.processDatapoints.push(o)}te.plot.plugins.push({init:e,options:R,name:"stackpercent",version:"0.1"})})(jQuery)},32176:()=>{(function(te){var R={xaxis:{timezone:null,timeformat:null,twelveHourClock:!1,monthNames:null}};function e(g,f){return f*Math.floor(g/f)}function n(g,f,p,c){if(typeof g.strftime=="function")return g.strftime(f);var x=function(D,C){return D=""+D,C=""+(C??"0"),D.length==1?C+D:D},v=[],m=!1,y=g.getHours(),h=y<12;p==null&&(p=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),c==null&&(c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]);var d;y>12?d=y-12:y==0?d=12:d=y;for(var E=0;E<f.length;++E){var b=f.charAt(E);if(m){switch(b){case"a":b=""+c[g.getDay()];break;case"b":b=""+p[g.getMonth()];break;case"d":b=x(g.getDate(),"");break;case"e":b=x(g.getDate()," ");break;case"h":case"H":b=x(y);break;case"I":b=x(d);break;case"l":b=x(d," ");break;case"m":b=x(g.getMonth()+1,"");break;case"M":b=x(g.getMinutes());break;case"q":b=""+(Math.floor(g.getMonth()/3)+1);break;case"S":b=x(g.getSeconds());break;case"y":b=x(g.getFullYear()%100);break;case"Y":b=""+g.getFullYear();break;case"p":b=h?"am":"pm";break;case"P":b=h?"AM":"PM";break;case"w":b=""+g.getDay();break}v.push(b),m=!1}else b=="%"?m=!0:v.push(b)}return v.join("")}function a(g){function f(v,m,y,h){v[m]=function(){return y[h].apply(y,arguments)}}var p={date:g};g.strftime!=null&&f(p,"strftime",g,"strftime"),f(p,"getTime",g,"getTime"),f(p,"setTime",g,"setTime");for(var c=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds"],x=0;x<c.length;x++)f(p,"get"+c[x],g,"getUTC"+c[x]),f(p,"set"+c[x],g,"setUTC"+c[x]);return p}function s(g,f){if(f.timezone=="browser")return new Date(g);if(!f.timezone||f.timezone=="utc")return a(new Date(g));if(typeof timezoneJS<"u"&&typeof timezoneJS.Date<"u"){var p=new timezoneJS.Date;return p.setTimezone(f.timezone),p.setTime(g),p}else return a(new Date(g))}var i={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:30*24*60*60*1e3,quarter:3*30*24*60*60*1e3,year:365.2425*24*60*60*1e3},r=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"]],u=r.concat([[3,"month"],[6,"month"],[1,"year"]]),o=r.concat([[1,"quarter"],[2,"quarter"],[1,"year"]]);function l(g){g.hooks.processOptions.push(function(f,p){te.each(f.getAxes(),function(c,x){var v=x.options;v.mode=="time"&&(x.tickGenerator=function(m){var y=[],h=s(m.min,v),d=0,E=v.tickSize&&v.tickSize[1]==="quarter"||v.minTickSize&&v.minTickSize[1]==="quarter"?o:u;v.minTickSize!=null&&(typeof v.tickSize=="number"?d=v.tickSize:d=v.minTickSize[0]*i[v.minTickSize[1]]);for(var b=0;b<E.length-1&&!(m.delta<(E[b][0]*i[E[b][1]]+E[b+1][0]*i[E[b+1][1]])/2&&E[b][0]*i[E[b][1]]>=d);++b);var D=E[b][0],C=E[b][1];if(C=="year"){if(v.minTickSize!=null&&v.minTickSize[1]=="year")D=Math.floor(v.minTickSize[0]);else{var P=Math.pow(10,Math.floor(Math.log(m.delta/i.year)/Math.LN10)),M=m.delta/i.year/P;M<1.5?D=1:M<3?D=2:M<7.5?D=5:D=10,D*=P}D<1&&(D=1)}m.tickSize=v.tickSize||[D,C];var O=m.tickSize[0];C=m.tickSize[1];var j=O*i[C];C=="second"?h.setSeconds(e(h.getSeconds(),O)):C=="minute"?h.setMinutes(e(h.getMinutes(),O)):C=="hour"?h.setHours(e(h.getHours(),O)):C=="month"?h.setMonth(e(h.getMonth(),O)):C=="quarter"?h.setMonth(3*e(h.getMonth()/3,O)):C=="year"&&h.setFullYear(e(h.getFullYear(),O)),h.setMilliseconds(0),j>=i.minute&&h.setSeconds(0),j>=i.hour&&h.setMinutes(0),j>=i.day&&h.setHours(0),j>=i.day*4&&h.setDate(1),j>=i.month*2&&h.setMonth(e(h.getMonth(),3)),j>=i.quarter*2&&h.setMonth(e(h.getMonth(),6)),j>=i.year&&h.setMonth(0);var U=0,W=Number.NaN,B;do if(B=W,W=h.getTime(),y.push(W),C=="month"||C=="quarter")if(O<1){h.setDate(1);var S=h.getTime();h.setMonth(h.getMonth()+(C=="quarter"?3:1));var _=h.getTime();h.setTime(W+U*i.hour+(_-S)*O),U=h.getHours(),h.setHours(0)}else h.setMonth(h.getMonth()+O*(C=="quarter"?3:1));else C=="year"?h.setFullYear(h.getFullYear()+O):h.setTime(W+j);while(W<m.max&&W!=B);return y},x.tickFormatter=function(m,y){var h=s(m,y.options);if(v.timeformat!=null)return n(h,v.timeformat,v.monthNames,v.dayNames);var d=y.options.tickSize&&y.options.tickSize[1]=="quarter"||y.options.minTickSize&&y.options.minTickSize[1]=="quarter",E=y.tickSize[0]*i[y.tickSize[1]],b=y.max-y.min,D=v.twelveHourClock?" %p":"",C=v.twelveHourClock?"%I":"%H",P;E<i.minute?P=C+":%M:%S"+D:E<i.day?b<2*i.day?P=C+":%M"+D:P="%b %d "+C+":%M"+D:E<i.month?P="%b %d":d&&E<i.quarter||!d&&E<i.year?b<i.year?P="%b":P="%b %Y":d&&E<i.year?b<i.year?P="Q%q":P="Q%q %Y":P="%Y";var M=n(h,P,v.monthNames,v.dayNames);return M})})})}te.plot.plugins.push({init:l,options:R,name:"time",version:"1.0"}),te.plot.formatDate=n})(jQuery)}}]);

//# sourceMappingURL=9414.d49a4f34abb1bf9485cb.js.map